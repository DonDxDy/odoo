odoo.define('web_editor.jabberwock', function(require) {
// 'use strict';
var JWEditor =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./packages/build-odoo-integration/odoo-integration.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./bundles/BasicEditor.ts":
/*!********************************!*\
  !*** ./bundles/BasicEditor.ts ***!
  \********************************/
/*! exports provided: BasicEditor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BasicEditor", function() { return BasicEditor; });
/* harmony import */ var _packages_core_src_JWEditor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../packages/core/src/JWEditor */ "./packages/core/src/JWEditor.ts");
/* harmony import */ var _packages_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../packages/plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _packages_plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../packages/plugin-html/src/Html */ "./packages/plugin-html/src/Html.ts");
/* harmony import */ var _packages_plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../packages/plugin-char/src/Char */ "./packages/plugin-char/src/Char.ts");
/* harmony import */ var _packages_plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../packages/plugin-linebreak/src/LineBreak */ "./packages/plugin-linebreak/src/LineBreak.ts");
/* harmony import */ var _packages_plugin_heading_src_Heading__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../packages/plugin-heading/src/Heading */ "./packages/plugin-heading/src/Heading.ts");
/* harmony import */ var _packages_plugin_paragraph_src_Paragraph__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../packages/plugin-paragraph/src/Paragraph */ "./packages/plugin-paragraph/src/Paragraph.ts");
/* harmony import */ var _packages_plugin_list_src_List__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../packages/plugin-list/src/List */ "./packages/plugin-list/src/List.ts");
/* harmony import */ var _packages_plugin_indent_src_Indent__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../packages/plugin-indent/src/Indent */ "./packages/plugin-indent/src/Indent.ts");
/* harmony import */ var _packages_plugin_paragraph_src_ParagraphNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../packages/plugin-paragraph/src/ParagraphNode */ "./packages/plugin-paragraph/src/ParagraphNode.ts");
/* harmony import */ var _packages_plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../packages/plugin-linebreak/src/LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _packages_plugin_span_src_Span__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../packages/plugin-span/src/Span */ "./packages/plugin-span/src/Span.ts");
/* harmony import */ var _packages_plugin_bold_src_Bold__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../packages/plugin-bold/src/Bold */ "./packages/plugin-bold/src/Bold.ts");
/* harmony import */ var _packages_plugin_italic_src_Italic__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../packages/plugin-italic/src/Italic */ "./packages/plugin-italic/src/Italic.ts");
/* harmony import */ var _packages_plugin_underline_src_Underline__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../packages/plugin-underline/src/Underline */ "./packages/plugin-underline/src/Underline.ts");
/* harmony import */ var _packages_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../packages/plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _packages_plugin_link_src_Link__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../packages/plugin-link/src/Link */ "./packages/plugin-link/src/Link.ts");
/* harmony import */ var _packages_plugin_divider_src_Divider__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../packages/plugin-divider/src/Divider */ "./packages/plugin-divider/src/Divider.ts");
/* harmony import */ var _packages_plugin_image_src_Image__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../packages/plugin-image/src/Image */ "./packages/plugin-image/src/Image.ts");
/* harmony import */ var _packages_plugin_subscript_src_Subscript__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../packages/plugin-subscript/src/Subscript */ "./packages/plugin-subscript/src/Subscript.ts");
/* harmony import */ var _packages_plugin_superscript_src_Superscript__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../packages/plugin-superscript/src/Superscript */ "./packages/plugin-superscript/src/Superscript.ts");
/* harmony import */ var _packages_plugin_blockquote_src_Blockquote__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../packages/plugin-blockquote/src/Blockquote */ "./packages/plugin-blockquote/src/Blockquote.ts");
/* harmony import */ var _packages_plugin_youtube_src_Youtube__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../packages/plugin-youtube/src/Youtube */ "./packages/plugin-youtube/src/Youtube.ts");
/* harmony import */ var _packages_plugin_table_src_Table__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../packages/plugin-table/src/Table */ "./packages/plugin-table/src/Table.ts");
/* harmony import */ var _packages_plugin_metadata_src_Metadata__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../packages/plugin-metadata/src/Metadata */ "./packages/plugin-metadata/src/Metadata.ts");
/* harmony import */ var _packages_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../packages/plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _packages_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../packages/plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _packages_plugin_align_src_Align__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../packages/plugin-align/src/Align */ "./packages/plugin-align/src/Align.ts");
/* harmony import */ var _packages_plugin_pre_src_Pre__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../packages/plugin-pre/src/Pre */ "./packages/plugin-pre/src/Pre.ts");
/* harmony import */ var _packages_plugin_textcolor_src_TextColor__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../packages/plugin-textcolor/src/TextColor */ "./packages/plugin-textcolor/src/TextColor.ts");
/* harmony import */ var _packages_plugin_backgroundcolor_src_BackgroundColor__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../packages/plugin-backgroundcolor/src/BackgroundColor */ "./packages/plugin-backgroundcolor/src/BackgroundColor.ts");
/* harmony import */ var _packages_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../packages/plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _packages_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../packages/plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _packages_plugin_dom_editable_src_DomEditable__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../packages/plugin-dom-editable/src/DomEditable */ "./packages/plugin-dom-editable/src/DomEditable.ts");
/* harmony import */ var _packages_plugin_input_src_Input__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../packages/plugin-input/src/Input */ "./packages/plugin-input/src/Input.ts");
/* harmony import */ var _packages_plugin_dialog_src_Dialog__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../packages/plugin-dialog/src/Dialog */ "./packages/plugin-dialog/src/Dialog.ts");
/* harmony import */ var _basicLayout_xml__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ./basicLayout.xml */ "./bundles/basicLayout.xml");
/* harmony import */ var _basicLayout_xml__WEBPACK_IMPORTED_MODULE_36___default = /*#__PURE__*/__webpack_require__.n(_basicLayout_xml__WEBPACK_IMPORTED_MODULE_36__);
/* harmony import */ var _basicLayout_css__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ./basicLayout.css */ "./bundles/basicLayout.css");
/* harmony import */ var _basicLayout_css__WEBPACK_IMPORTED_MODULE_37___default = /*#__PURE__*/__webpack_require__.n(_basicLayout_css__WEBPACK_IMPORTED_MODULE_37__);






































class BasicEditor extends _packages_core_src_JWEditor__WEBPACK_IMPORTED_MODULE_0__["default"] {
    constructor() {
        super();
        this.configure({
            defaults: {
                Container: _packages_plugin_paragraph_src_ParagraphNode__WEBPACK_IMPORTED_MODULE_9__["ParagraphNode"],
                Separator: _packages_plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_10__["LineBreakNode"],
            },
            plugins: [
                [_packages_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"]],
                [_packages_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_25__["Renderer"]],
                [_packages_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_31__["Layout"]],
                [_packages_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_26__["Keymap"]],
                [_packages_plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_2__["Html"]],
                [_packages_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_32__["DomLayout"]],
                [_packages_plugin_dom_editable_src_DomEditable__WEBPACK_IMPORTED_MODULE_33__["DomEditable"]],
                // [
                //     Dom,
                //     {
                //         afterRender: (editable: HTMLElement) => console.log('afterRender'),
                //     },
                // ],
                [_packages_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_15__["Inline"]],
                [_packages_plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_3__["Char"]],
                [_packages_plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_4__["LineBreak"]],
                [_packages_plugin_heading_src_Heading__WEBPACK_IMPORTED_MODULE_5__["Heading"]],
                [_packages_plugin_paragraph_src_Paragraph__WEBPACK_IMPORTED_MODULE_6__["Paragraph"]],
                [_packages_plugin_list_src_List__WEBPACK_IMPORTED_MODULE_7__["List"]],
                [_packages_plugin_indent_src_Indent__WEBPACK_IMPORTED_MODULE_8__["Indent"]],
                [_packages_plugin_span_src_Span__WEBPACK_IMPORTED_MODULE_11__["Span"]],
                [_packages_plugin_bold_src_Bold__WEBPACK_IMPORTED_MODULE_12__["Bold"]],
                [_packages_plugin_italic_src_Italic__WEBPACK_IMPORTED_MODULE_13__["Italic"]],
                [_packages_plugin_underline_src_Underline__WEBPACK_IMPORTED_MODULE_14__["Underline"]],
                [_packages_plugin_link_src_Link__WEBPACK_IMPORTED_MODULE_16__["Link"]],
                [_packages_plugin_divider_src_Divider__WEBPACK_IMPORTED_MODULE_17__["Divider"]],
                [_packages_plugin_image_src_Image__WEBPACK_IMPORTED_MODULE_18__["Image"]],
                [_packages_plugin_subscript_src_Subscript__WEBPACK_IMPORTED_MODULE_19__["Subscript"]],
                [_packages_plugin_superscript_src_Superscript__WEBPACK_IMPORTED_MODULE_20__["Superscript"]],
                [_packages_plugin_blockquote_src_Blockquote__WEBPACK_IMPORTED_MODULE_21__["Blockquote"]],
                [_packages_plugin_youtube_src_Youtube__WEBPACK_IMPORTED_MODULE_22__["Youtube"]],
                [_packages_plugin_table_src_Table__WEBPACK_IMPORTED_MODULE_23__["Table"]],
                [_packages_plugin_metadata_src_Metadata__WEBPACK_IMPORTED_MODULE_24__["Metadata"]],
                [_packages_plugin_align_src_Align__WEBPACK_IMPORTED_MODULE_27__["Align"]],
                [_packages_plugin_pre_src_Pre__WEBPACK_IMPORTED_MODULE_28__["Pre"]],
                [_packages_plugin_textcolor_src_TextColor__WEBPACK_IMPORTED_MODULE_29__["TextColor"]],
                [_packages_plugin_backgroundcolor_src_BackgroundColor__WEBPACK_IMPORTED_MODULE_30__["BackgroundColor"]],
                [_packages_plugin_input_src_Input__WEBPACK_IMPORTED_MODULE_34__["Input"]],
                [_packages_plugin_dialog_src_Dialog__WEBPACK_IMPORTED_MODULE_35__["Dialog"]],
            ],
        });
        this.configure(_packages_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_32__["DomLayout"], {
            components: [
                {
                    id: 'editor',
                    render(editor) {
                        return editor.plugins.get(_packages_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"]).parse('text/html', _basicLayout_xml__WEBPACK_IMPORTED_MODULE_36___default.a);
                    },
                },
            ],
            componentZones: [['editor', 'root']],
        });
    }
}


/***/ }),

/***/ "./bundles/OdooWebsiteEditor.ts":
/*!**************************************!*\
  !*** ./bundles/OdooWebsiteEditor.ts ***!
  \**************************************/
/*! exports provided: OdooWebsiteEditor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooWebsiteEditor", function() { return OdooWebsiteEditor; });
/* harmony import */ var _packages_core_src_JWEditor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../packages/core/src/JWEditor */ "./packages/core/src/JWEditor.ts");
/* harmony import */ var _packages_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../packages/plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _packages_plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../packages/plugin-html/src/Html */ "./packages/plugin-html/src/Html.ts");
/* harmony import */ var _packages_plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../packages/plugin-char/src/Char */ "./packages/plugin-char/src/Char.ts");
/* harmony import */ var _packages_plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../packages/plugin-linebreak/src/LineBreak */ "./packages/plugin-linebreak/src/LineBreak.ts");
/* harmony import */ var _packages_plugin_heading_src_Heading__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../packages/plugin-heading/src/Heading */ "./packages/plugin-heading/src/Heading.ts");
/* harmony import */ var _packages_plugin_paragraph_src_Paragraph__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../packages/plugin-paragraph/src/Paragraph */ "./packages/plugin-paragraph/src/Paragraph.ts");
/* harmony import */ var _packages_plugin_list_src_List__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../packages/plugin-list/src/List */ "./packages/plugin-list/src/List.ts");
/* harmony import */ var _packages_plugin_indent_src_Indent__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../packages/plugin-indent/src/Indent */ "./packages/plugin-indent/src/Indent.ts");
/* harmony import */ var _packages_plugin_paragraph_src_ParagraphNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../packages/plugin-paragraph/src/ParagraphNode */ "./packages/plugin-paragraph/src/ParagraphNode.ts");
/* harmony import */ var _packages_plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../packages/plugin-linebreak/src/LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _packages_plugin_span_src_Span__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../packages/plugin-span/src/Span */ "./packages/plugin-span/src/Span.ts");
/* harmony import */ var _packages_plugin_bold_src_Bold__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../packages/plugin-bold/src/Bold */ "./packages/plugin-bold/src/Bold.ts");
/* harmony import */ var _packages_plugin_italic_src_Italic__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../packages/plugin-italic/src/Italic */ "./packages/plugin-italic/src/Italic.ts");
/* harmony import */ var _packages_plugin_underline_src_Underline__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../packages/plugin-underline/src/Underline */ "./packages/plugin-underline/src/Underline.ts");
/* harmony import */ var _packages_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../packages/plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _packages_plugin_link_src_Link__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../packages/plugin-link/src/Link */ "./packages/plugin-link/src/Link.ts");
/* harmony import */ var _packages_plugin_divider_src_Divider__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../packages/plugin-divider/src/Divider */ "./packages/plugin-divider/src/Divider.ts");
/* harmony import */ var _packages_plugin_image_src_Image__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../packages/plugin-image/src/Image */ "./packages/plugin-image/src/Image.ts");
/* harmony import */ var _packages_plugin_subscript_src_Subscript__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../packages/plugin-subscript/src/Subscript */ "./packages/plugin-subscript/src/Subscript.ts");
/* harmony import */ var _packages_plugin_superscript_src_Superscript__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../packages/plugin-superscript/src/Superscript */ "./packages/plugin-superscript/src/Superscript.ts");
/* harmony import */ var _packages_plugin_blockquote_src_Blockquote__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../packages/plugin-blockquote/src/Blockquote */ "./packages/plugin-blockquote/src/Blockquote.ts");
/* harmony import */ var _packages_plugin_youtube_src_Youtube__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../packages/plugin-youtube/src/Youtube */ "./packages/plugin-youtube/src/Youtube.ts");
/* harmony import */ var _packages_plugin_table_src_Table__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ../packages/plugin-table/src/Table */ "./packages/plugin-table/src/Table.ts");
/* harmony import */ var _packages_plugin_metadata_src_Metadata__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ../packages/plugin-metadata/src/Metadata */ "./packages/plugin-metadata/src/Metadata.ts");
/* harmony import */ var _packages_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../packages/plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _packages_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../packages/plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _packages_plugin_align_src_Align__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../packages/plugin-align/src/Align */ "./packages/plugin-align/src/Align.ts");
/* harmony import */ var _packages_plugin_pre_src_Pre__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../packages/plugin-pre/src/Pre */ "./packages/plugin-pre/src/Pre.ts");
/* harmony import */ var _packages_plugin_textcolor_src_TextColor__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../packages/plugin-textcolor/src/TextColor */ "./packages/plugin-textcolor/src/TextColor.ts");
/* harmony import */ var _packages_plugin_backgroundcolor_src_BackgroundColor__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../packages/plugin-backgroundcolor/src/BackgroundColor */ "./packages/plugin-backgroundcolor/src/BackgroundColor.ts");
/* harmony import */ var _packages_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../packages/plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _packages_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../packages/plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _packages_plugin_dom_editable_src_DomEditable__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../packages/plugin-dom-editable/src/DomEditable */ "./packages/plugin-dom-editable/src/DomEditable.ts");
/* harmony import */ var _basicLayout_css__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ./basicLayout.css */ "./bundles/basicLayout.css");
/* harmony import */ var _basicLayout_css__WEBPACK_IMPORTED_MODULE_34___default = /*#__PURE__*/__webpack_require__.n(_basicLayout_css__WEBPACK_IMPORTED_MODULE_34__);
/* harmony import */ var _packages_plugin_odoo_snippets_src_OdooSnippet__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../packages/plugin-odoo-snippets/src/OdooSnippet */ "./packages/plugin-odoo-snippets/src/OdooSnippet.ts");
/* harmony import */ var _packages_plugin_toolbar_src_Toolbar__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ../packages/plugin-toolbar/src/Toolbar */ "./packages/plugin-toolbar/src/Toolbar.ts");
/* harmony import */ var _packages_plugin_heading_src_HeadingButtons__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ../packages/plugin-heading/src/HeadingButtons */ "./packages/plugin-heading/src/HeadingButtons.ts");
/* harmony import */ var _packages_plugin_pre_src_PreButtons__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ../packages/plugin-pre/src/PreButtons */ "./packages/plugin-pre/src/PreButtons.ts");
/* harmony import */ var _packages_plugin_bold_src_BoldButtons__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ../packages/plugin-bold/src/BoldButtons */ "./packages/plugin-bold/src/BoldButtons.ts");
/* harmony import */ var _packages_plugin_italic_src_ItalicButtons__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ../packages/plugin-italic/src/ItalicButtons */ "./packages/plugin-italic/src/ItalicButtons.ts");
/* harmony import */ var _packages_plugin_underline_src_UnderlineButtons__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ../packages/plugin-underline/src/UnderlineButtons */ "./packages/plugin-underline/src/UnderlineButtons.ts");
/* harmony import */ var _packages_plugin_list_src_ListButtons__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ../packages/plugin-list/src/ListButtons */ "./packages/plugin-list/src/ListButtons.ts");
/* harmony import */ var _packages_plugin_indent_src_IndentButtons__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ../packages/plugin-indent/src/IndentButtons */ "./packages/plugin-indent/src/IndentButtons.ts");
/* harmony import */ var _packages_plugin_odoo_snippets_src_SaveButton__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ../packages/plugin-odoo-snippets/src/SaveButton */ "./packages/plugin-odoo-snippets/src/SaveButton.ts");
/* harmony import */ var _packages_plugin_html_src_HtmlNode__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ../packages/plugin-html/src/HtmlNode */ "./packages/plugin-html/src/HtmlNode.ts");
/* harmony import */ var _packages_plugin_odoo_snippets_src_MediaButton__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ../packages/plugin-odoo-snippets/src/MediaButton */ "./packages/plugin-odoo-snippets/src/MediaButton.ts");
/* harmony import */ var _packages_core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ../packages/core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _packages_plugin_video_src_OdooVideo__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ../packages/plugin-video/src/OdooVideo */ "./packages/plugin-video/src/OdooVideo.ts");
/* harmony import */ var _packages_plugin_odoo_snippets_src_LinkButton__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ../packages/plugin-odoo-snippets/src/LinkButton */ "./packages/plugin-odoo-snippets/src/LinkButton.ts");
/* harmony import */ var _packages_plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ../packages/plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _packages_plugin_align_src_AlignButtons__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ../packages/plugin-align/src/AlignButtons */ "./packages/plugin-align/src/AlignButtons.ts");




























































class OdooWebsiteEditor extends _packages_core_src_JWEditor__WEBPACK_IMPORTED_MODULE_0__["default"] {
    constructor(options) {
        super();
        class CustomPlugin extends _packages_core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_47__["JWPlugin"] {
            constructor() {
                super(...arguments);
                this.commands = options.customCommands;
            }
        }
        this.configure({
            defaults: {
                Container: _packages_plugin_paragraph_src_ParagraphNode__WEBPACK_IMPORTED_MODULE_9__["ParagraphNode"],
                Separator: _packages_plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_10__["LineBreakNode"],
            },
            plugins: [
                [_packages_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"]],
                [_packages_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_25__["Renderer"]],
                [_packages_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_31__["Layout"]],
                [_packages_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_26__["Keymap"]],
                [_packages_plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_2__["Html"]],
                [_packages_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_15__["Inline"]],
                [_packages_plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_3__["Char"]],
                [_packages_plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_4__["LineBreak"]],
                [_packages_plugin_heading_src_Heading__WEBPACK_IMPORTED_MODULE_5__["Heading"]],
                [_packages_plugin_paragraph_src_Paragraph__WEBPACK_IMPORTED_MODULE_6__["Paragraph"]],
                [_packages_plugin_list_src_List__WEBPACK_IMPORTED_MODULE_7__["List"]],
                [_packages_plugin_indent_src_Indent__WEBPACK_IMPORTED_MODULE_8__["Indent"]],
                [_packages_plugin_span_src_Span__WEBPACK_IMPORTED_MODULE_11__["Span"]],
                [_packages_plugin_bold_src_Bold__WEBPACK_IMPORTED_MODULE_12__["Bold"]],
                [_packages_plugin_italic_src_Italic__WEBPACK_IMPORTED_MODULE_13__["Italic"]],
                [_packages_plugin_underline_src_Underline__WEBPACK_IMPORTED_MODULE_14__["Underline"]],
                [_packages_plugin_link_src_Link__WEBPACK_IMPORTED_MODULE_16__["Link"]],
                [_packages_plugin_divider_src_Divider__WEBPACK_IMPORTED_MODULE_17__["Divider"]],
                [_packages_plugin_image_src_Image__WEBPACK_IMPORTED_MODULE_18__["Image"]],
                [_packages_plugin_subscript_src_Subscript__WEBPACK_IMPORTED_MODULE_19__["Subscript"]],
                [_packages_plugin_superscript_src_Superscript__WEBPACK_IMPORTED_MODULE_20__["Superscript"]],
                [_packages_plugin_blockquote_src_Blockquote__WEBPACK_IMPORTED_MODULE_21__["Blockquote"]],
                [_packages_plugin_youtube_src_Youtube__WEBPACK_IMPORTED_MODULE_22__["Youtube"]],
                [_packages_plugin_table_src_Table__WEBPACK_IMPORTED_MODULE_23__["Table"]],
                [_packages_plugin_metadata_src_Metadata__WEBPACK_IMPORTED_MODULE_24__["Metadata"]],
                [_packages_plugin_align_src_Align__WEBPACK_IMPORTED_MODULE_27__["Align"]],
                [_packages_plugin_pre_src_Pre__WEBPACK_IMPORTED_MODULE_28__["Pre"]],
                [_packages_plugin_textcolor_src_TextColor__WEBPACK_IMPORTED_MODULE_29__["TextColor"]],
                [_packages_plugin_backgroundcolor_src_BackgroundColor__WEBPACK_IMPORTED_MODULE_30__["BackgroundColor"]],
                [_packages_plugin_odoo_snippets_src_OdooSnippet__WEBPACK_IMPORTED_MODULE_35__["OdooSnippet"]],
                // [MediaDialog],
                [_packages_plugin_video_src_OdooVideo__WEBPACK_IMPORTED_MODULE_48__["OdooVideo"]],
                [CustomPlugin],
            ],
        });
        this.configure(_packages_plugin_toolbar_src_Toolbar__WEBPACK_IMPORTED_MODULE_36__["Toolbar"], {
            layout: [
                [
                    [
                        _packages_plugin_heading_src_HeadingButtons__WEBPACK_IMPORTED_MODULE_37__["ParagraphButton"],
                        _packages_plugin_heading_src_HeadingButtons__WEBPACK_IMPORTED_MODULE_37__["Heading1Button"],
                        _packages_plugin_heading_src_HeadingButtons__WEBPACK_IMPORTED_MODULE_37__["Heading2Button"],
                        _packages_plugin_heading_src_HeadingButtons__WEBPACK_IMPORTED_MODULE_37__["Heading3Button"],
                        _packages_plugin_heading_src_HeadingButtons__WEBPACK_IMPORTED_MODULE_37__["Heading4Button"],
                        _packages_plugin_heading_src_HeadingButtons__WEBPACK_IMPORTED_MODULE_37__["Heading5Button"],
                        _packages_plugin_heading_src_HeadingButtons__WEBPACK_IMPORTED_MODULE_37__["Heading6Button"],
                        _packages_plugin_pre_src_PreButtons__WEBPACK_IMPORTED_MODULE_38__["PreButton"],
                    ],
                ],
                [_packages_plugin_bold_src_BoldButtons__WEBPACK_IMPORTED_MODULE_39__["BoldButton"], _packages_plugin_italic_src_ItalicButtons__WEBPACK_IMPORTED_MODULE_40__["ItalicButton"], _packages_plugin_underline_src_UnderlineButtons__WEBPACK_IMPORTED_MODULE_41__["UnderlineButton"]],
                [_packages_plugin_align_src_AlignButtons__WEBPACK_IMPORTED_MODULE_51__["AlignLeftButton"], _packages_plugin_align_src_AlignButtons__WEBPACK_IMPORTED_MODULE_51__["AlignCenterButton"], _packages_plugin_align_src_AlignButtons__WEBPACK_IMPORTED_MODULE_51__["AlignRightButton"], _packages_plugin_align_src_AlignButtons__WEBPACK_IMPORTED_MODULE_51__["AlignJustifyButton"]],
                [_packages_plugin_list_src_ListButtons__WEBPACK_IMPORTED_MODULE_42__["OrderedListButton"], _packages_plugin_list_src_ListButtons__WEBPACK_IMPORTED_MODULE_42__["UnorderedListButton"]],
                [_packages_plugin_indent_src_IndentButtons__WEBPACK_IMPORTED_MODULE_43__["IndentButton"], _packages_plugin_indent_src_IndentButtons__WEBPACK_IMPORTED_MODULE_43__["OutdentButton"]],
                [_packages_plugin_odoo_snippets_src_LinkButton__WEBPACK_IMPORTED_MODULE_49__["LinkButton"]],
                [_packages_plugin_odoo_snippets_src_MediaButton__WEBPACK_IMPORTED_MODULE_46__["MediaButton"]],
                ...(options.saveButton ? [[_packages_plugin_odoo_snippets_src_SaveButton__WEBPACK_IMPORTED_MODULE_44__["SaveButton"]]] : []),
            ],
        });
        const defaultTemplate = `
        <t t-zone="float"/>
        <t t-zone="default"/>
        <div class="wrap_editor d-flex flex-column">
            <div class="d-flex flex-row overflow-auto">
                <t t-zone="main_sidebar"/>
                <div class="d-flex flex-column overflow-auto o_editor_center">
                    <div class="o_toolbar">
                        <t t-zone="tools"/>
                    </div>
                    <div class="d-flex overflow-auto">
                        <t t-zone="snippetManipulators"/>
                        <t t-zone="main"/>
                    </div>
                </div>
            </div>
            <div class="o_debug_zone">
                <t t-zone="debug"/>
            </div>
        </div>
    `;
        this.configure(_packages_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_32__["DomLayout"], {
            components: [
                {
                    id: 'main_template',
                    render(editor) {
                        return editor.plugins
                            .get(_packages_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"])
                            .parse('text/html', options.template || defaultTemplate);
                    },
                },
                {
                    id: 'snippet_menu',
                    render() {
                        const node = options.snippetMenuElement
                            ? new _packages_plugin_html_src_HtmlNode__WEBPACK_IMPORTED_MODULE_45__["HtmlNode"]({ domNode: options.snippetMenuElement })
                            : new _packages_plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_10__["LineBreakNode"]();
                        return Promise.resolve([node]);
                    },
                },
                {
                    id: 'snippetManipulators',
                    render() {
                        const node = options.snippetMenuElement
                            ? new _packages_plugin_html_src_HtmlNode__WEBPACK_IMPORTED_MODULE_45__["HtmlNode"]({ domNode: options.snippetManipulators })
                            : new _packages_plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_10__["LineBreakNode"]();
                        return Promise.resolve([node]);
                    },
                },
            ],
            componentZones: [
                ['main_template', 'root'],
                ['snippet_menu', 'main_sidebar'],
                ['snippetManipulators', 'snippetManipulators'],
            ],
            location: options.location,
            afterRender: options.afterRender,
        });
        this.configure(_packages_plugin_dom_editable_src_DomEditable__WEBPACK_IMPORTED_MODULE_33__["DomEditable"], {
            autoFocus: true,
            source: options.source.firstElementChild,
        });
    }
    /**
     * Get the value by rendering the "editable" component of the editor.
     */
    async getValue() {
        const renderer = this.plugins.get(_packages_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_25__["Renderer"]);
        const layout = this.plugins.get(_packages_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_31__["Layout"]);
        const domLayout = layout.engines.dom;
        const domRenderingEngine = renderer.engines[_packages_plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_50__["HtmlDomRenderingEngine"].id];
        const editable = domLayout.components.get('editable')[0];
        const nodes = await domRenderingEngine.render(editable);
        return nodes[0];
    }
}


/***/ }),

/***/ "./bundles/basicLayout.css":
/*!*********************************!*\
  !*** ./bundles/basicLayout.css ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../node_modules/css-loader/dist/cjs.js!./basicLayout.css */ "./node_modules/css-loader/dist/cjs.js!./bundles/basicLayout.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./bundles/basicLayout.xml":
/*!*********************************!*\
  !*** ./bundles/basicLayout.xml ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<jw-editor>\n    <t t-zone=\"range\"/>\n    <jw-header><t t-zone=\"tools\"/></jw-header>\n    <jw-body><t t-zone=\"main\"/></jw-body>\n    <jw-footer>\n        <t t-zone=\"status\"/>\n    </jw-footer>\n    <t-dialog>\n        <t t-zone=\"dialog\"/>\n        <t t-zone=\"default\"/>\n    </t-dialog>\n    <t t-zone=\"debug\"/>\n</jw-editor>\n"

/***/ }),

/***/ "./node_modules/@odoo/owl/dist/owl.js":
/*!********************************************!*\
  !*** ./node_modules/@odoo/owl/dist/owl.js ***!
  \********************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


Object.defineProperty(exports, '__esModule', { value: true });

/**
 * We define here a simple event bus: it can
 * - emit events
 * - add/remove listeners.
 *
 * This is a useful pattern of communication in many cases.  For OWL, each
 * components and stores are event buses.
 */
//------------------------------------------------------------------------------
// EventBus
//------------------------------------------------------------------------------
class EventBus {
    constructor() {
        this.subscriptions = {};
    }
    /**
     * Add a listener for the 'eventType' events.
     *
     * Note that the 'owner' of this event can be anything, but will more likely
     * be a component or a class. The idea is that the callback will be called with
     * the proper owner bound.
     *
     * Also, the owner should be kind of unique. This will be used to remove the
     * listener.
     */
    on(eventType, owner, callback) {
        if (!callback) {
            throw new Error("Missing callback");
        }
        if (!this.subscriptions[eventType]) {
            this.subscriptions[eventType] = [];
        }
        this.subscriptions[eventType].push({
            owner,
            callback
        });
    }
    /**
     * Remove a listener
     */
    off(eventType, owner) {
        const subs = this.subscriptions[eventType];
        if (subs) {
            this.subscriptions[eventType] = subs.filter(s => s.owner !== owner);
        }
    }
    /**
     * Emit an event of type 'eventType'.  Any extra arguments will be passed to
     * the listeners callback.
     */
    trigger(eventType, ...args) {
        const subs = this.subscriptions[eventType] || [];
        for (let i = 0, iLen = subs.length; i < iLen; i++) {
            const sub = subs[i];
            sub.callback.call(sub.owner, ...args);
        }
    }
    /**
     * Remove all subscriptions.
     */
    clear() {
        this.subscriptions = {};
    }
}

/**
 * Owl Observer
 *
 * This code contains the logic that allows Owl to observe and react to state
 * changes.
 *
 * This is a Observer class that can observe any JS values.  The way it works
 * can be summarized thusly:
 * - primitive values are not observed at all
 * - Objects and arrays are observed by replacing them with a Proxy
 * - each object/array metadata are tracked in a weakmap, and keep a revision
 *   number
 *
 * Note that this code is loosely inspired by Vue.
 */
//------------------------------------------------------------------------------
// Observer
//------------------------------------------------------------------------------
class Observer {
    constructor() {
        this.rev = 1;
        this.allowMutations = true;
        this.weakMap = new WeakMap();
    }
    notifyCB() { }
    observe(value, parent) {
        if (value === null || typeof value !== "object" || value instanceof Date) {
            // fun fact: typeof null === 'object'
            return value;
        }
        let metadata = this.weakMap.get(value) || this._observe(value, parent);
        return metadata.proxy;
    }
    revNumber(value) {
        const metadata = this.weakMap.get(value);
        return metadata ? metadata.rev : 0;
    }
    _observe(value, parent) {
        var self = this;
        const proxy = new Proxy(value, {
            get(target, k) {
                const targetValue = target[k];
                return self.observe(targetValue, value);
            },
            set(target, key, newVal) {
                const value = target[key];
                if (newVal !== value) {
                    if (!self.allowMutations) {
                        throw new Error(`Observed state cannot be changed here! (key: "${key}", val: "${newVal}")`);
                    }
                    self._updateRevNumber(target);
                    target[key] = newVal;
                    self.notifyCB();
                }
                return true;
            },
            deleteProperty(target, key) {
                if (key in target) {
                    delete target[key];
                    self._updateRevNumber(target);
                    self.notifyCB();
                }
                return true;
            }
        });
        const metadata = {
            value,
            proxy,
            rev: this.rev,
            parent
        };
        this.weakMap.set(value, metadata);
        this.weakMap.set(metadata.proxy, metadata);
        return metadata;
    }
    _updateRevNumber(target) {
        this.rev++;
        let metadata = this.weakMap.get(target);
        let parent = target;
        do {
            metadata = this.weakMap.get(parent);
            metadata.rev++;
        } while ((parent = metadata.parent) && parent !== target);
    }
}

//------------------------------------------------------------------------------
// module/props.ts
//------------------------------------------------------------------------------
function updateProps(oldVnode, vnode) {
    var key, cur, old, elm = vnode.elm, oldProps = oldVnode.data.props, props = vnode.data.props;
    if (!oldProps && !props)
        return;
    if (oldProps === props)
        return;
    oldProps = oldProps || {};
    props = props || {};
    for (key in oldProps) {
        if (!props[key]) {
            delete elm[key];
        }
    }
    for (key in props) {
        cur = props[key];
        old = oldProps[key];
        if (old !== cur && (key !== "value" || elm[key] !== cur)) {
            elm[key] = cur;
        }
    }
}
const propsModule = {
    create: updateProps,
    update: updateProps
};
//------------------------------------------------------------------------------
// module/eventlisteners.ts
//------------------------------------------------------------------------------
function invokeHandler(handler, vnode, event) {
    if (typeof handler === "function") {
        // call function handler
        handler.call(vnode, event, vnode);
    }
    else if (typeof handler === "object") {
        // call handler with arguments
        if (typeof handler[0] === "function") {
            // special case for single argument for performance
            if (handler.length === 2) {
                handler[0].call(vnode, handler[1], event, vnode);
            }
            else {
                var args = handler.slice(1);
                args.push(event);
                args.push(vnode);
                handler[0].apply(vnode, args);
            }
        }
        else {
            // call multiple handlers
            for (let i = 0, iLen = handler.length; i < iLen; i++) {
                invokeHandler(handler[i], vnode, event);
            }
        }
    }
}
function handleEvent(event, vnode) {
    var name = event.type, on = vnode.data.on;
    // call event handler(s) if exists
    if (on) {
        if (on[name]) {
            invokeHandler(on[name], vnode, event);
        }
        else if (on["!" + name]) {
            invokeHandler(on["!" + name], vnode, event);
        }
    }
}
function createListener() {
    return function handler(event) {
        handleEvent(event, handler.vnode);
    };
}
function updateEventListeners(oldVnode, vnode) {
    var oldOn = oldVnode.data.on, oldListener = oldVnode.listener, oldElm = oldVnode.elm, on = vnode && vnode.data.on, elm = (vnode && vnode.elm), name;
    // optimization for reused immutable handlers
    if (oldOn === on) {
        return;
    }
    // remove existing listeners which no longer used
    if (oldOn && oldListener) {
        // if element changed or deleted we remove all existing listeners unconditionally
        if (!on) {
            for (name in oldOn) {
                // remove listener if element was changed or existing listeners removed
                const capture = name.charAt(0) === "!";
                name = capture ? name.slice(1) : name;
                oldElm.removeEventListener(name, oldListener, capture);
            }
        }
        else {
            for (name in oldOn) {
                // remove listener if existing listener removed
                if (!on[name]) {
                    const capture = name.charAt(0) === "!";
                    name = capture ? name.slice(1) : name;
                    oldElm.removeEventListener(name, oldListener, capture);
                }
            }
        }
    }
    // add new listeners which has not already attached
    if (on) {
        // reuse existing listener or create new
        var listener = (vnode.listener = oldVnode.listener || createListener());
        // update vnode for listener
        listener.vnode = vnode;
        // if element changed or added we add all needed listeners unconditionally
        if (!oldOn) {
            for (name in on) {
                // add listener if element was changed or new listeners added
                const capture = name.charAt(0) === "!";
                name = capture ? name.slice(1) : name;
                elm.addEventListener(name, listener, capture);
            }
        }
        else {
            for (name in on) {
                // add listener if new listener added
                if (!oldOn[name]) {
                    const capture = name.charAt(0) === "!";
                    name = capture ? name.slice(1) : name;
                    elm.addEventListener(name, listener, capture);
                }
            }
        }
    }
}
const eventListenersModule = {
    create: updateEventListeners,
    update: updateEventListeners,
    destroy: updateEventListeners
};
//------------------------------------------------------------------------------
// attributes.ts
//------------------------------------------------------------------------------
const xlinkNS = "http://www.w3.org/1999/xlink";
const xmlNS = "http://www.w3.org/XML/1998/namespace";
const colonChar = 58;
const xChar = 120;
function updateAttrs(oldVnode, vnode) {
    var key, elm = vnode.elm, oldAttrs = oldVnode.data.attrs, attrs = vnode.data.attrs;
    if (!oldAttrs && !attrs)
        return;
    if (oldAttrs === attrs)
        return;
    oldAttrs = oldAttrs || {};
    attrs = attrs || {};
    // update modified attributes, add new attributes
    for (key in attrs) {
        const cur = attrs[key];
        const old = oldAttrs[key];
        if (old !== cur) {
            if (cur === true) {
                elm.setAttribute(key, "");
            }
            else if (cur === false) {
                elm.removeAttribute(key);
            }
            else {
                if (key.charCodeAt(0) !== xChar) {
                    elm.setAttribute(key, cur);
                }
                else if (key.charCodeAt(3) === colonChar) {
                    // Assume xml namespace
                    elm.setAttributeNS(xmlNS, key, cur);
                }
                else if (key.charCodeAt(5) === colonChar) {
                    // Assume xlink namespace
                    elm.setAttributeNS(xlinkNS, key, cur);
                }
                else {
                    elm.setAttribute(key, cur);
                }
            }
        }
    }
    // remove removed attributes
    // use `in` operator since the previous `for` iteration uses it (.i.e. add even attributes with undefined value)
    // the other option is to remove all attributes with value == undefined
    for (key in oldAttrs) {
        if (!(key in attrs)) {
            elm.removeAttribute(key);
        }
    }
}
const attrsModule = {
    create: updateAttrs,
    update: updateAttrs
};
//------------------------------------------------------------------------------
// class.ts
//------------------------------------------------------------------------------
function updateClass(oldVnode, vnode) {
    var cur, name, elm, oldClass = oldVnode.data.class, klass = vnode.data.class;
    if (!oldClass && !klass)
        return;
    if (oldClass === klass)
        return;
    oldClass = oldClass || {};
    klass = klass || {};
    elm = vnode.elm;
    for (name in oldClass) {
        if (name && !klass[name]) {
            elm.classList.remove(name);
        }
    }
    for (name in klass) {
        cur = klass[name];
        if (cur !== oldClass[name]) {
            elm.classList[cur ? "add" : "remove"](name);
        }
    }
}
const classModule = { create: updateClass, update: updateClass };

/**
 * Owl VDOM
 *
 * This file contains an implementation of a virtual DOM, which is a system that
 * can generate in-memory representations of a DOM tree, compare them, and
 * eventually change a concrete DOM tree to match its representation, in an
 * hopefully efficient way.
 *
 * Note that this code is a fork of Snabbdom, slightly tweaked/optimized for our
 * needs (see https://github.com/snabbdom/snabbdom).
 *
 * The main exported values are:
 * - interface VNode
 * - h function (a helper function to generate a vnode)
 * - patch function (to apply a vnode to an actual DOM node)
 */
function vnode(sel, data, children, text, elm) {
    let key = data === undefined ? undefined : data.key;
    return { sel, data, children, text, elm, key };
}
//------------------------------------------------------------------------------
// snabbdom.ts
//------------------------------------------------------------------------------
function isUndef(s) {
    return s === undefined;
}
function isDef(s) {
    return s !== undefined;
}
const emptyNode = vnode("", {}, [], undefined, undefined);
function sameVnode(vnode1, vnode2) {
    return vnode1.key === vnode2.key && vnode1.sel === vnode2.sel;
}
function isVnode(vnode) {
    return vnode.sel !== undefined;
}
function createKeyToOldIdx(children, beginIdx, endIdx) {
    let i, map = {}, key, ch;
    for (i = beginIdx; i <= endIdx; ++i) {
        ch = children[i];
        if (ch != null) {
            key = ch.key;
            if (key !== undefined)
                map[key] = i;
        }
    }
    return map;
}
const hooks = ["create", "update", "remove", "destroy", "pre", "post"];
function init(modules, domApi) {
    let i, j, cbs = {};
    const api = domApi !== undefined ? domApi : htmlDomApi;
    for (i = 0; i < hooks.length; ++i) {
        cbs[hooks[i]] = [];
        for (j = 0; j < modules.length; ++j) {
            const hook = modules[j][hooks[i]];
            if (hook !== undefined) {
                cbs[hooks[i]].push(hook);
            }
        }
    }
    function emptyNodeAt(elm) {
        const id = elm.id ? "#" + elm.id : "";
        const c = elm.className ? "." + elm.className.split(" ").join(".") : "";
        return vnode(api.tagName(elm).toLowerCase() + id + c, {}, [], undefined, elm);
    }
    function createRmCb(childElm, listeners) {
        return function rmCb() {
            if (--listeners === 0) {
                const parent = api.parentNode(childElm);
                api.removeChild(parent, childElm);
            }
        };
    }
    function createElm(vnode, insertedVnodeQueue) {
        let i, iLen, data = vnode.data;
        if (data !== undefined) {
            if (isDef((i = data.hook)) && isDef((i = i.init))) {
                i(vnode);
                data = vnode.data;
            }
        }
        let children = vnode.children, sel = vnode.sel;
        if (sel === "!") {
            if (isUndef(vnode.text)) {
                vnode.text = "";
            }
            vnode.elm = api.createComment(vnode.text);
        }
        else if (sel !== undefined) {
            const elm = vnode.elm ||
                (vnode.elm =
                    isDef(data) && isDef((i = data.ns))
                        ? api.createElementNS(i, sel)
                        : api.createElement(sel));
            for (i = 0, iLen = cbs.create.length; i < iLen; ++i)
                cbs.create[i](emptyNode, vnode);
            if (array(children)) {
                for (i = 0, iLen = children.length; i < iLen; ++i) {
                    const ch = children[i];
                    if (ch != null) {
                        api.appendChild(elm, createElm(ch, insertedVnodeQueue));
                    }
                }
            }
            else if (primitive(vnode.text)) {
                api.appendChild(elm, api.createTextNode(vnode.text));
            }
            i = vnode.data.hook; // Reuse variable
            if (isDef(i)) {
                if (i.create)
                    i.create(emptyNode, vnode);
                if (i.insert)
                    insertedVnodeQueue.push(vnode);
            }
        }
        else {
            vnode.elm = api.createTextNode(vnode.text);
        }
        return vnode.elm;
    }
    function addVnodes(parentElm, before, vnodes, startIdx, endIdx, insertedVnodeQueue) {
        for (; startIdx <= endIdx; ++startIdx) {
            const ch = vnodes[startIdx];
            if (ch != null) {
                api.insertBefore(parentElm, createElm(ch, insertedVnodeQueue), before);
            }
        }
    }
    function invokeDestroyHook(vnode) {
        let i, iLen, j, jLen, data = vnode.data;
        if (data !== undefined) {
            if (isDef((i = data.hook)) && isDef((i = i.destroy)))
                i(vnode);
            for (i = 0, iLen = cbs.destroy.length; i < iLen; ++i)
                cbs.destroy[i](vnode);
            if (vnode.children !== undefined) {
                for (j = 0, jLen = vnode.children.length; j < jLen; ++j) {
                    i = vnode.children[j];
                    if (i != null && typeof i !== "string") {
                        invokeDestroyHook(i);
                    }
                }
            }
        }
    }
    function removeVnodes(parentElm, vnodes, startIdx, endIdx) {
        for (; startIdx <= endIdx; ++startIdx) {
            let i, iLen, listeners, rm, ch = vnodes[startIdx];
            if (ch != null) {
                if (isDef(ch.sel)) {
                    invokeDestroyHook(ch);
                    listeners = cbs.remove.length + 1;
                    rm = createRmCb(ch.elm, listeners);
                    for (i = 0, iLen = cbs.remove.length; i < iLen; ++i)
                        cbs.remove[i](ch, rm);
                    if (isDef((i = ch.data)) && isDef((i = i.hook)) && isDef((i = i.remove))) {
                        i(ch, rm);
                    }
                    else {
                        rm();
                    }
                }
                else {
                    // Text node
                    api.removeChild(parentElm, ch.elm);
                }
            }
        }
    }
    function updateChildren(parentElm, oldCh, newCh, insertedVnodeQueue) {
        let oldStartIdx = 0, newStartIdx = 0;
        let oldEndIdx = oldCh.length - 1;
        let oldStartVnode = oldCh[0];
        let oldEndVnode = oldCh[oldEndIdx];
        let newEndIdx = newCh.length - 1;
        let newStartVnode = newCh[0];
        let newEndVnode = newCh[newEndIdx];
        let oldKeyToIdx;
        let idxInOld;
        let elmToMove;
        let before;
        while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {
            if (oldStartVnode == null) {
                oldStartVnode = oldCh[++oldStartIdx]; // Vnode might have been moved left
            }
            else if (oldEndVnode == null) {
                oldEndVnode = oldCh[--oldEndIdx];
            }
            else if (newStartVnode == null) {
                newStartVnode = newCh[++newStartIdx];
            }
            else if (newEndVnode == null) {
                newEndVnode = newCh[--newEndIdx];
            }
            else if (sameVnode(oldStartVnode, newStartVnode)) {
                patchVnode(oldStartVnode, newStartVnode, insertedVnodeQueue);
                oldStartVnode = oldCh[++oldStartIdx];
                newStartVnode = newCh[++newStartIdx];
            }
            else if (sameVnode(oldEndVnode, newEndVnode)) {
                patchVnode(oldEndVnode, newEndVnode, insertedVnodeQueue);
                oldEndVnode = oldCh[--oldEndIdx];
                newEndVnode = newCh[--newEndIdx];
            }
            else if (sameVnode(oldStartVnode, newEndVnode)) {
                // Vnode moved right
                patchVnode(oldStartVnode, newEndVnode, insertedVnodeQueue);
                api.insertBefore(parentElm, oldStartVnode.elm, api.nextSibling(oldEndVnode.elm));
                oldStartVnode = oldCh[++oldStartIdx];
                newEndVnode = newCh[--newEndIdx];
            }
            else if (sameVnode(oldEndVnode, newStartVnode)) {
                // Vnode moved left
                patchVnode(oldEndVnode, newStartVnode, insertedVnodeQueue);
                api.insertBefore(parentElm, oldEndVnode.elm, oldStartVnode.elm);
                oldEndVnode = oldCh[--oldEndIdx];
                newStartVnode = newCh[++newStartIdx];
            }
            else {
                if (oldKeyToIdx === undefined) {
                    oldKeyToIdx = createKeyToOldIdx(oldCh, oldStartIdx, oldEndIdx);
                }
                idxInOld = oldKeyToIdx[newStartVnode.key];
                if (isUndef(idxInOld)) {
                    // New element
                    api.insertBefore(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);
                    newStartVnode = newCh[++newStartIdx];
                }
                else {
                    elmToMove = oldCh[idxInOld];
                    if (elmToMove.sel !== newStartVnode.sel) {
                        api.insertBefore(parentElm, createElm(newStartVnode, insertedVnodeQueue), oldStartVnode.elm);
                    }
                    else {
                        patchVnode(elmToMove, newStartVnode, insertedVnodeQueue);
                        oldCh[idxInOld] = undefined;
                        api.insertBefore(parentElm, elmToMove.elm, oldStartVnode.elm);
                    }
                    newStartVnode = newCh[++newStartIdx];
                }
            }
        }
        if (oldStartIdx <= oldEndIdx || newStartIdx <= newEndIdx) {
            if (oldStartIdx > oldEndIdx) {
                before = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].elm;
                addVnodes(parentElm, before, newCh, newStartIdx, newEndIdx, insertedVnodeQueue);
            }
            else {
                removeVnodes(parentElm, oldCh, oldStartIdx, oldEndIdx);
            }
        }
    }
    function patchVnode(oldVnode, vnode, insertedVnodeQueue) {
        let i, iLen, hook;
        if (isDef((i = vnode.data)) && isDef((hook = i.hook)) && isDef((i = hook.prepatch))) {
            i(oldVnode, vnode);
        }
        const elm = (vnode.elm = oldVnode.elm);
        let oldCh = oldVnode.children;
        let ch = vnode.children;
        if (oldVnode === vnode)
            return;
        if (vnode.data !== undefined) {
            for (i = 0, iLen = cbs.update.length; i < iLen; ++i)
                cbs.update[i](oldVnode, vnode);
            i = vnode.data.hook;
            if (isDef(i) && isDef((i = i.update)))
                i(oldVnode, vnode);
        }
        if (isUndef(vnode.text)) {
            if (isDef(oldCh) && isDef(ch)) {
                if (oldCh !== ch)
                    updateChildren(elm, oldCh, ch, insertedVnodeQueue);
            }
            else if (isDef(ch)) {
                if (isDef(oldVnode.text))
                    api.setTextContent(elm, "");
                addVnodes(elm, null, ch, 0, ch.length - 1, insertedVnodeQueue);
            }
            else if (isDef(oldCh)) {
                removeVnodes(elm, oldCh, 0, oldCh.length - 1);
            }
            else if (isDef(oldVnode.text)) {
                api.setTextContent(elm, "");
            }
        }
        else if (oldVnode.text !== vnode.text) {
            if (isDef(oldCh)) {
                removeVnodes(elm, oldCh, 0, oldCh.length - 1);
            }
            api.setTextContent(elm, vnode.text);
        }
        if (isDef(hook) && isDef((i = hook.postpatch))) {
            i(oldVnode, vnode);
        }
    }
    return function patch(oldVnode, vnode) {
        let i, iLen, elm, parent;
        const insertedVnodeQueue = [];
        for (i = 0, iLen = cbs.pre.length; i < iLen; ++i)
            cbs.pre[i]();
        if (!isVnode(oldVnode)) {
            oldVnode = emptyNodeAt(oldVnode);
        }
        if (sameVnode(oldVnode, vnode)) {
            patchVnode(oldVnode, vnode, insertedVnodeQueue);
        }
        else {
            elm = oldVnode.elm;
            parent = api.parentNode(elm);
            createElm(vnode, insertedVnodeQueue);
            if (parent !== null) {
                api.insertBefore(parent, vnode.elm, api.nextSibling(elm));
                removeVnodes(parent, [oldVnode], 0, 0);
            }
        }
        for (i = 0, iLen = insertedVnodeQueue.length; i < iLen; ++i) {
            insertedVnodeQueue[i].data.hook.insert(insertedVnodeQueue[i]);
        }
        for (i = 0, iLen = cbs.post.length; i < iLen; ++i)
            cbs.post[i]();
        return vnode;
    };
}
//------------------------------------------------------------------------------
// is.ts
//------------------------------------------------------------------------------
const array = Array.isArray;
function primitive(s) {
    return typeof s === "string" || typeof s === "number";
}
function createElement(tagName) {
    return document.createElement(tagName);
}
function createElementNS(namespaceURI, qualifiedName) {
    return document.createElementNS(namespaceURI, qualifiedName);
}
function createTextNode(text) {
    return document.createTextNode(text);
}
function createComment(text) {
    return document.createComment(text);
}
function insertBefore(parentNode, newNode, referenceNode) {
    parentNode.insertBefore(newNode, referenceNode);
}
function removeChild(node, child) {
    node.removeChild(child);
}
function appendChild(node, child) {
    node.appendChild(child);
}
function parentNode(node) {
    return node.parentNode;
}
function nextSibling(node) {
    return node.nextSibling;
}
function tagName(elm) {
    return elm.tagName;
}
function setTextContent(node, text) {
    node.textContent = text;
}
const htmlDomApi = {
    createElement,
    createElementNS,
    createTextNode,
    createComment,
    insertBefore,
    removeChild,
    appendChild,
    parentNode,
    nextSibling,
    tagName,
    setTextContent
};
function addNS(data, children, sel) {
    if (sel === "dummy") {
        // we do not need to add the namespace on dummy elements, they come from a
        // subcomponent, which will handle the namespace itself
        return;
    }
    data.ns = "http://www.w3.org/2000/svg";
    if (sel !== "foreignObject" && children !== undefined) {
        for (let i = 0, iLen = children.length; i < iLen; ++i) {
            const child = children[i];
            let childData = child.data;
            if (childData !== undefined) {
                addNS(childData, child.children, child.sel);
            }
        }
    }
}
function h(sel, b, c) {
    var data = {}, children, text, i, iLen;
    if (c !== undefined) {
        data = b;
        if (array(c)) {
            children = c;
        }
        else if (primitive(c)) {
            text = c;
        }
        else if (c && c.sel) {
            children = [c];
        }
    }
    else if (b !== undefined) {
        if (array(b)) {
            children = b;
        }
        else if (primitive(b)) {
            text = b;
        }
        else if (b && b.sel) {
            children = [b];
        }
        else {
            data = b;
        }
    }
    if (children !== undefined) {
        for (i = 0, iLen = children.length; i < iLen; ++i) {
            if (primitive(children[i]))
                children[i] = vnode(undefined, undefined, undefined, children[i], undefined);
        }
    }
    return vnode(sel, data, children, text, undefined);
}

const patch = init([eventListenersModule, attrsModule, propsModule, classModule]);

/**
 * Owl QWeb Expression Parser
 *
 * Owl needs in various contexts to be able to understand the structure of a
 * string representing a javascript expression.  The usual goal is to be able
 * to rewrite some variables.  For example, if a template has
 *
 *  ```xml
 *  <t t-if="computeSomething({val: state.val})">...</t>
 * ```
 *
 * this needs to be translated in something like this:
 *
 * ```js
 *   if (context["computeSomething"]({val: context["state"].val})) { ... }
 * ```
 *
 * This file contains the implementation of an extremely naive tokenizer/parser
 * and evaluator for javascript expressions.  The supported grammar is basically
 * only expressive enough to understand the shape of objects, of arrays, and
 * various operators.
 */
//------------------------------------------------------------------------------
// Misc types, constants and helpers
//------------------------------------------------------------------------------
const RESERVED_WORDS = "true,false,NaN,null,undefined,debugger,console,window,in,instanceof,new,function,return,this,eval,void,Math,RegExp,Array,Object,Date".split(",");
const WORD_REPLACEMENT = {
    and: "&&",
    or: "||",
    gt: ">",
    gte: ">=",
    lt: "<",
    lte: "<="
};
const STATIC_TOKEN_MAP = {
    "{": "LEFT_BRACE",
    "}": "RIGHT_BRACE",
    "[": "LEFT_BRACKET",
    "]": "RIGHT_BRACKET",
    ":": "COLON",
    ",": "COMMA",
    "(": "LEFT_PAREN",
    ")": "RIGHT_PAREN"
};
// note that the space after typeof is relevant. It makes sure that the formatted
// expression has a space after typeof
const OPERATORS = "...,.,===,==,+,!==,!=,!,||,&&,>=,>,<=,<,?,-,*,/,%,typeof ,=>,=,;,in ".split(",");
let tokenizeString = function (expr) {
    let s = expr[0];
    let start = s;
    if (s !== "'" && s !== '"') {
        return false;
    }
    let i = 1;
    let cur;
    while (expr[i] && expr[i] !== start) {
        cur = expr[i];
        s += cur;
        if (cur === "\\") {
            i++;
            cur = expr[i];
            if (!cur) {
                throw new Error("Invalid expression");
            }
            s += cur;
        }
        i++;
    }
    if (expr[i] !== start) {
        throw new Error("Invalid expression");
    }
    s += start;
    return { type: "VALUE", value: s };
};
let tokenizeNumber = function (expr) {
    let s = expr[0];
    if (s && s.match(/[0-9]/)) {
        let i = 1;
        while (expr[i] && expr[i].match(/[0-9]|\./)) {
            s += expr[i];
            i++;
        }
        return { type: "VALUE", value: s };
    }
    else {
        return false;
    }
};
let tokenizeSymbol = function (expr) {
    let s = expr[0];
    if (s && s.match(/[a-zA-Z_\$]/)) {
        let i = 1;
        while (expr[i] && expr[i].match(/\w/)) {
            s += expr[i];
            i++;
        }
        if (s in WORD_REPLACEMENT) {
            return { type: "OPERATOR", value: WORD_REPLACEMENT[s], size: s.length };
        }
        return { type: "SYMBOL", value: s };
    }
    else {
        return false;
    }
};
const tokenizeStatic = function (expr) {
    const char = expr[0];
    if (char && char in STATIC_TOKEN_MAP) {
        return { type: STATIC_TOKEN_MAP[char], value: char };
    }
    return false;
};
const tokenizeOperator = function (expr) {
    for (let op of OPERATORS) {
        if (expr.startsWith(op)) {
            return { type: "OPERATOR", value: op };
        }
    }
    return false;
};
const TOKENIZERS = [
    tokenizeString,
    tokenizeNumber,
    tokenizeOperator,
    tokenizeSymbol,
    tokenizeStatic
];
/**
 * Convert a javascript expression (as a string) into a list of tokens. For
 * example: `tokenize("1 + b")` will return:
 * ```js
 *  [
 *   {type: "VALUE", value: "1"},
 *   {type: "OPERATOR", value: "+"},
 *   {type: "SYMBOL", value: "b"}
 * ]
 * ```
 */
function tokenize(expr) {
    const result = [];
    let token = true;
    while (token) {
        expr = expr.trim();
        if (expr) {
            for (let tokenizer of TOKENIZERS) {
                token = tokenizer(expr);
                if (token) {
                    result.push(token);
                    expr = expr.slice(token.size || token.value.length);
                    break;
                }
            }
        }
        else {
            token = false;
        }
    }
    if (expr.length) {
        throw new Error(`Tokenizer error: could not tokenize "${expr}"`);
    }
    return result;
}
//------------------------------------------------------------------------------
// Expression "evaluator"
//------------------------------------------------------------------------------
/**
 * This is the main function exported by this file. This is the code that will
 * process an expression (given as a string) and returns another expression with
 * proper lookups in the context.
 *
 * Usually, this kind of code would be very simple to do if we had an AST (so,
 * if we had a javascript parser), since then, we would only need to find the
 * variables and replace them.  However, a parser is more complicated, and there
 * are no standard builtin parser API.
 *
 * Since this method is applied to simple javasript expressions, and the work to
 * be done is actually quite simple, we actually can get away with not using a
 * parser, which helps with the code size.
 *
 * Here is the heuristic used by this method to determine if a token is a
 * variable:
 * - by default, all symbols are considered a variable
 * - unless the previous token is a dot (in that case, this is a property: `a.b`)
 * - or if the previous token is a left brace or a comma, and the next token is
 *   a colon (in that case, this is an object key: `{a: b}`)
 *
 * Some specific code is also required to support arrow functions. If we detect
 * the arrow operator, then we add the current (or some previous tokens) token to
 * the list of variables so it does not get replaced by a lookup in the context
 */
function compileExprToArray(expr, scope) {
    scope = Object.create(scope);
    const tokens = tokenize(expr);
    for (let i = 0; i < tokens.length; i++) {
        let token = tokens[i];
        let prevToken = tokens[i - 1];
        let nextToken = tokens[i + 1];
        let isVar = token.type === "SYMBOL" && !RESERVED_WORDS.includes(token.value);
        if (token.type === "SYMBOL" && !RESERVED_WORDS.includes(token.value)) {
            if (prevToken) {
                if (prevToken.type === "OPERATOR" && prevToken.value === ".") {
                    isVar = false;
                }
                else if (prevToken.type === "LEFT_BRACE" || prevToken.type === "COMMA") {
                    if (nextToken && nextToken.type === "COLON") {
                        isVar = false;
                    }
                }
            }
        }
        if (nextToken && nextToken.type === "OPERATOR" && nextToken.value === "=>") {
            if (token.type === "RIGHT_PAREN") {
                let j = i - 1;
                while (j > 0 && tokens[j].type !== "LEFT_PAREN") {
                    if (tokens[j].type === "SYMBOL" && tokens[j].originalValue) {
                        tokens[j].value = tokens[j].originalValue;
                        scope[tokens[j].value] = { id: tokens[j].value, expr: tokens[j].value };
                    }
                    j--;
                }
            }
            else {
                scope[token.value] = { id: token.value, expr: token.value };
            }
        }
        if (isVar) {
            token.varName = token.value;
            if (token.value in scope && "id" in scope[token.value]) {
                token.value = scope[token.value].expr;
            }
            else {
                token.originalValue = token.value;
                token.value = `scope['${token.value}']`;
            }
        }
    }
    return tokens;
}
function compileExpr(expr, scope) {
    return compileExprToArray(expr, scope)
        .map(t => t.value)
        .join("");
}

const INTERP_REGEXP = /\{\{.*?\}\}/g;
//------------------------------------------------------------------------------
// Compilation Context
//------------------------------------------------------------------------------
class CompilationContext {
    constructor(name) {
        this.code = [];
        this.variables = {};
        this.escaping = false;
        this.parentNode = null;
        this.parentTextNode = null;
        this.rootNode = null;
        this.indentLevel = 0;
        this.shouldDefineParent = false;
        this.shouldDefineScope = false;
        this.protectedScopeNumber = 0;
        this.shouldDefineQWeb = false;
        this.shouldDefineUtils = false;
        this.shouldDefineRefs = false;
        this.shouldDefineResult = true;
        this.loopNumber = 0;
        this.inPreTag = false;
        this.allowMultipleRoots = false;
        this.hasParentWidget = false;
        this.hasKey0 = false;
        this.keyStack = [];
        this.rootContext = this;
        this.templateName = name || "noname";
        this.addLine("let h = this.h;");
    }
    generateID() {
        return CompilationContext.nextID++;
    }
    /**
     * This method generates a "template key", which is basically a unique key
     * which depends on the currently set keys, and on the iteration numbers (if
     * we are in a loop).
     *
     * Such a key is necessary when we need to associate an id to some element
     * generated by a template (for example, a component)
     */
    generateTemplateKey(prefix = "") {
        const id = this.generateID();
        if (this.loopNumber === 0 && !this.hasKey0) {
            return `'${prefix}__${id}__'`;
        }
        let key = `\`${prefix}__${id}__`;
        let start = this.hasKey0 ? 0 : 1;
        for (let i = start; i < this.loopNumber + 1; i++) {
            key += `\${key${i}}__`;
        }
        this.addLine(`let k${id} = ${key}\`;`);
        return `k${id}`;
    }
    generateCode() {
        if (this.shouldDefineResult) {
            this.code.unshift("    let result;");
        }
        if (this.shouldDefineScope) {
            this.code.unshift("    let scope = Object.create(context);");
        }
        if (this.shouldDefineRefs) {
            this.code.unshift("    context.__owl__.refs = context.__owl__.refs || {};");
        }
        if (this.shouldDefineParent) {
            if (this.hasParentWidget) {
                this.code.unshift("    let parent = extra.parent;");
            }
            else {
                this.code.unshift("    let parent = context;");
            }
        }
        if (this.shouldDefineQWeb) {
            this.code.unshift("    let QWeb = this.constructor;");
        }
        if (this.shouldDefineUtils) {
            this.code.unshift("    let utils = this.constructor.utils;");
        }
        return this.code;
    }
    withParent(node) {
        if (!this.allowMultipleRoots &&
            this === this.rootContext &&
            (this.parentNode || this.parentTextNode)) {
            throw new Error("A template should not have more than one root node");
        }
        if (!this.rootContext.rootNode) {
            this.rootContext.rootNode = node;
        }
        if (!this.parentNode && this.rootContext.shouldDefineResult) {
            this.addLine(`result = vn${node};`);
        }
        return this.subContext("parentNode", node);
    }
    subContext(key, value) {
        const newContext = Object.create(this);
        newContext[key] = value;
        return newContext;
    }
    indent() {
        this.rootContext.indentLevel++;
    }
    dedent() {
        this.rootContext.indentLevel--;
    }
    addLine(line) {
        const prefix = new Array(this.indentLevel + 2).join("    ");
        this.code.push(prefix + line);
        return this.code.length - 1;
    }
    addIf(condition) {
        this.addLine(`if (${condition}) {`);
        this.indent();
    }
    addElse() {
        this.dedent();
        this.addLine("} else {");
        this.indent();
    }
    closeIf() {
        this.dedent();
        this.addLine("}");
    }
    getValue(val) {
        return val in this.variables ? this.getValue(this.variables[val]) : val;
    }
    /**
     * Prepare an expression for being consumed at render time.  Its main job
     * is to
     * - replace unknown variables by a lookup in the context
     * - replace already defined variables by their internal name
     */
    formatExpression(expr) {
        this.rootContext.shouldDefineScope = true;
        return compileExpr(expr, this.variables);
    }
    captureExpression(expr) {
        this.rootContext.shouldDefineScope = true;
        const argId = this.generateID();
        const tokens = compileExprToArray(expr, this.variables);
        const done = new Set();
        return tokens
            .map(tok => {
            if (tok.varName) {
                if (!done.has(tok.varName)) {
                    done.add(tok.varName);
                    this.addLine(`const ${tok.varName}_${argId} = ${tok.value};`);
                }
                tok.value = `${tok.varName}_${argId}`;
            }
            return tok.value;
        })
            .join("");
    }
    /**
     * Perform string interpolation on the given string. Note that if the whole
     * string is an expression, it simply returns it (formatted and enclosed in
     * parentheses).
     * For instance:
     *   'Hello {{x}}!' -> `Hello ${x}`
     *   '{{x ? 'a': 'b'}}' -> (x ? 'a' : 'b')
     */
    interpolate(s) {
        let matches = s.match(INTERP_REGEXP);
        if (matches && matches[0].length === s.length) {
            return `(${this.formatExpression(s.slice(2, -2))})`;
        }
        let r = s.replace(/\{\{.*?\}\}/g, s => "${" + this.formatExpression(s.slice(2, -2)) + "}");
        return "`" + r + "`";
    }
    startProtectScope(codeBlock) {
        const protectID = this.generateID();
        this.rootContext.protectedScopeNumber++;
        this.rootContext.shouldDefineScope = true;
        const scopeExpr = `Object.create(scope);`;
        this.addLine(`let _origScope${protectID} = scope;`);
        this.addLine(`scope = ${scopeExpr}`);
        if (!codeBlock) {
            this.addLine(`scope.__access_mode__ = 'ro';`);
        }
        return protectID;
    }
    stopProtectScope(protectID) {
        this.rootContext.protectedScopeNumber--;
        this.addLine(`scope = _origScope${protectID};`);
    }
}
CompilationContext.nextID = 1;

const browser = {
    setTimeout: window.setTimeout.bind(window),
    clearTimeout: window.clearTimeout.bind(window),
    setInterval: window.setInterval.bind(window),
    clearInterval: window.clearInterval.bind(window),
    requestAnimationFrame: window.requestAnimationFrame.bind(window),
    random: Math.random,
    Date: window.Date,
    fetch: (window.fetch || (() => { })).bind(window),
    localStorage: window.localStorage
};

/**
 * Owl Utils
 *
 * We have here a small collection of utility functions:
 *
 * - whenReady
 * - loadJS
 * - loadFile
 * - escape
 * - debounce
 */
function whenReady(fn) {
    return new Promise(function (resolve) {
        if (document.readyState !== "loading") {
            resolve();
        }
        else {
            document.addEventListener("DOMContentLoaded", resolve, false);
        }
    }).then(fn || function () { });
}
const loadedScripts = {};
function loadJS(url) {
    if (url in loadedScripts) {
        return loadedScripts[url];
    }
    const promise = new Promise(function (resolve, reject) {
        const script = document.createElement("script");
        script.type = "text/javascript";
        script.src = url;
        script.onload = function () {
            resolve();
        };
        script.onerror = function () {
            reject(`Error loading file '${url}'`);
        };
        const head = document.head || document.getElementsByTagName("head")[0];
        head.appendChild(script);
    });
    loadedScripts[url] = promise;
    return promise;
}
async function loadFile(url) {
    const result = await browser.fetch(url);
    if (!result.ok) {
        throw new Error("Error while fetching xml templates");
    }
    return await result.text();
}
function escape(str) {
    if (str === undefined) {
        return "";
    }
    if (typeof str === "number") {
        return String(str);
    }
    const p = document.createElement("p");
    p.textContent = str;
    return p.innerHTML;
}
/**
 * Returns a function, that, as long as it continues to be invoked, will not
 * be triggered. The function will be called after it stops being called for
 * N milliseconds. If `immediate` is passed, trigger the function on the
 * leading edge, instead of the trailing.
 *
 * Inspired by https://davidwalsh.name/javascript-debounce-function
 */
function debounce(func, wait, immediate) {
    let timeout;
    return function () {
        const context = this;
        const args = arguments;
        function later() {
            timeout = null;
            if (!immediate) {
                func.apply(context, args);
            }
        }
        const callNow = immediate && !timeout;
        browser.clearTimeout(timeout);
        timeout = browser.setTimeout(later, wait);
        if (callNow) {
            func.apply(context, args);
        }
    };
}
function shallowEqual(p1, p2) {
    for (let k in p1) {
        if (p1[k] !== p2[k]) {
            return false;
        }
    }
    return true;
}

var _utils = /*#__PURE__*/Object.freeze({
    __proto__: null,
    whenReady: whenReady,
    loadJS: loadJS,
    loadFile: loadFile,
    escape: escape,
    debounce: debounce,
    shallowEqual: shallowEqual
});

//------------------------------------------------------------------------------
// Const/global stuff/helpers
//------------------------------------------------------------------------------
const DISABLED_TAGS = ["input", "textarea", "button", "select", "option", "optgroup"];
const TRANSLATABLE_ATTRS = ["label", "title", "placeholder", "alt"];
const lineBreakRE = /[\r\n]/;
const whitespaceRE = /\s+/g;
const NODE_HOOKS_PARAMS = {
    create: "(_, n)",
    insert: "vn",
    remove: "(vn, rm)",
    destroy: "()"
};
function isComponent(obj) {
    return obj && obj.hasOwnProperty("__owl__");
}
const UTILS = {
    zero: Symbol("zero"),
    toObj(expr) {
        if (typeof expr === "string") {
            expr = expr.trim();
            if (!expr) {
                return {};
            }
            let words = expr.split(/\s+/);
            let result = {};
            for (let i = 0; i < words.length; i++) {
                result[words[i]] = true;
            }
            return result;
        }
        return expr;
    },
    shallowEqual,
    addNameSpace(vnode) {
        addNS(vnode.data, vnode.children, vnode.sel);
    },
    VDomArray: class VDomArray extends Array {
    },
    vDomToString: function (vdom) {
        return vdom
            .map(vnode => {
            if (vnode.sel) {
                const node = document.createElement(vnode.sel);
                const result = patch(node, vnode);
                return result.elm.outerHTML;
            }
            else {
                return vnode.text;
            }
        })
            .join("");
    },
    getComponent(obj) {
        while (obj && !isComponent(obj)) {
            obj = obj.__proto__;
        }
        return obj;
    },
    getScope(obj, property) {
        const obj0 = obj;
        while (obj &&
            !obj.hasOwnProperty(property) &&
            !(obj.hasOwnProperty("__access_mode__") && obj.__access_mode__ === "ro")) {
            const newObj = obj.__proto__;
            if (!newObj || isComponent(newObj)) {
                return obj0;
            }
            obj = newObj;
        }
        return obj;
    }
};
function parseXML(xml) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(xml, "text/xml");
    if (doc.getElementsByTagName("parsererror").length) {
        let msg = "Invalid XML in template.";
        const parsererrorText = doc.getElementsByTagName("parsererror")[0].textContent;
        if (parsererrorText) {
            msg += "\nThe parser has produced the following error message:\n" + parsererrorText;
            const re = /\d+/g;
            const firstMatch = re.exec(parsererrorText);
            if (firstMatch) {
                const lineNumber = Number(firstMatch[0]);
                const line = xml.split("\n")[lineNumber - 1];
                const secondMatch = re.exec(parsererrorText);
                if (line && secondMatch) {
                    const columnIndex = Number(secondMatch[0]) - 1;
                    if (line[columnIndex]) {
                        msg +=
                            `\nThe error might be located at xml line ${lineNumber} column ${columnIndex}\n` +
                                `${line}\n${"-".repeat(columnIndex - 1)}^`;
                    }
                }
            }
        }
        throw new Error(msg);
    }
    return doc;
}
function escapeQuotes(str) {
    return str.replace(/\'/g, "\\'");
}
//------------------------------------------------------------------------------
// QWeb rendering engine
//------------------------------------------------------------------------------
class QWeb extends EventBus {
    constructor(config = {}) {
        super();
        this.h = h;
        // recursiveTemplates contains sub templates called with t-call, but which
        // ends up in recursive situations.  This is very similar to the slot situation,
        // as in we need to propagate the scope.
        this.subTemplates = {};
        this.isUpdating = false;
        this.templates = Object.create(QWeb.TEMPLATES);
        if (config.templates) {
            this.addTemplates(config.templates);
        }
        if (config.translateFn) {
            this.translateFn = config.translateFn;
        }
    }
    static addDirective(directive) {
        if (directive.name in QWeb.DIRECTIVE_NAMES) {
            throw new Error(`Directive "${directive.name} already registered`);
        }
        QWeb.DIRECTIVES.push(directive);
        QWeb.DIRECTIVE_NAMES[directive.name] = 1;
        QWeb.DIRECTIVES.sort((d1, d2) => d1.priority - d2.priority);
        if (directive.extraNames) {
            directive.extraNames.forEach(n => (QWeb.DIRECTIVE_NAMES[n] = 1));
        }
    }
    static registerComponent(name, Component) {
        if (QWeb.components[name]) {
            throw new Error(`Component '${name}' has already been registered`);
        }
        QWeb.components[name] = Component;
    }
    /**
     * Register globally a template.  All QWeb instances will obtain their
     * templates from their own template map, and then, from the global static
     * TEMPLATES property.
     */
    static registerTemplate(name, template) {
        if (QWeb.TEMPLATES[name]) {
            throw new Error(`Template '${name}' has already been registered`);
        }
        const qweb = new QWeb();
        qweb.addTemplate(name, template);
        QWeb.TEMPLATES[name] = qweb.templates[name];
    }
    /**
     * Add a template to the internal template map.  Note that it is not
     * immediately compiled.
     */
    addTemplate(name, xmlString, allowDuplicate) {
        if (allowDuplicate && name in this.templates) {
            return;
        }
        const doc = parseXML(xmlString);
        if (!doc.firstChild) {
            throw new Error("Invalid template (should not be empty)");
        }
        this._addTemplate(name, doc.firstChild);
    }
    /**
     * Load templates from a xml (as a string or xml document).  This will look up
     * for the first <templates> tag, and will consider each child of this as a
     * template, with the name given by the t-name attribute.
     */
    addTemplates(xmlstr) {
        const doc = typeof xmlstr === "string" ? parseXML(xmlstr) : xmlstr;
        const templates = doc.getElementsByTagName("templates")[0];
        if (!templates) {
            return;
        }
        for (let elem of templates.children) {
            const name = elem.getAttribute("t-name");
            this._addTemplate(name, elem);
        }
    }
    _addTemplate(name, elem) {
        if (name in this.templates) {
            throw new Error(`Template ${name} already defined`);
        }
        this._processTemplate(elem);
        const template = {
            elem,
            fn: function (context, extra) {
                const compiledFunction = this._compile(name, elem);
                template.fn = compiledFunction;
                return compiledFunction.call(this, context, extra);
            }
        };
        this.templates[name] = template;
    }
    _processTemplate(elem) {
        let tbranch = elem.querySelectorAll("[t-elif], [t-else]");
        for (let i = 0, ilen = tbranch.length; i < ilen; i++) {
            let node = tbranch[i];
            let prevElem = node.previousElementSibling;
            let pattr = function (name) {
                return prevElem.getAttribute(name);
            };
            let nattr = function (name) {
                return +!!node.getAttribute(name);
            };
            if (prevElem && (pattr("t-if") || pattr("t-elif"))) {
                if (pattr("t-foreach")) {
                    throw new Error("t-if cannot stay at the same level as t-foreach when using t-elif or t-else");
                }
                if (["t-if", "t-elif", "t-else"].map(nattr).reduce(function (a, b) {
                    return a + b;
                }) > 1) {
                    throw new Error("Only one conditional branching directive is allowed per node");
                }
                // All text (with only spaces) and comment nodes (nodeType 8) between
                // branch nodes are removed
                let textNode;
                while ((textNode = node.previousSibling) !== prevElem) {
                    if (textNode.nodeValue.trim().length && textNode.nodeType !== 8) {
                        throw new Error("text is not allowed between branching directives");
                    }
                    textNode.remove();
                }
            }
            else {
                throw new Error("t-elif and t-else directives must be preceded by a t-if or t-elif directive");
            }
        }
    }
    /**
     * Render a template
     *
     * @param {string} name the template should already have been added
     */
    render(name, context = {}, extra = null) {
        const template = this.templates[name];
        if (!template) {
            throw new Error(`Template ${name} does not exist`);
        }
        return template.fn.call(this, context, extra);
    }
    /**
     * Render a template to a html string.
     *
     * Note that this is more limited than the `render` method: it is not suitable
     * to render a full component tree, since this is an asynchronous operation.
     * This method can only render templates without components.
     */
    renderToString(name, context = {}, extra) {
        const vnode = this.render(name, context, extra);
        if (vnode.sel === undefined) {
            return vnode.text;
        }
        const node = document.createElement(vnode.sel);
        const elem = patch(node, vnode).elm;
        function escapeTextNodes(node) {
            if (node.nodeType === 3) {
                node.textContent = escape(node.textContent);
            }
            for (let n of node.childNodes) {
                escapeTextNodes(n);
            }
        }
        escapeTextNodes(elem);
        return elem.outerHTML;
    }
    /**
     * Force all widgets connected to this QWeb instance to rerender themselves.
     *
     * This method is mostly useful for external code that want to modify the
     * application in some cases.  For example, a router plugin.
     */
    forceUpdate() {
        this.isUpdating = true;
        Promise.resolve().then(() => {
            if (this.isUpdating) {
                this.isUpdating = false;
                this.trigger("update");
            }
        });
    }
    _compile(name, elem, parentContext, defineKey) {
        const isDebug = elem.attributes.hasOwnProperty("t-debug");
        const ctx = new CompilationContext(name);
        if (elem.tagName !== "t") {
            ctx.shouldDefineResult = false;
        }
        if (parentContext) {
            ctx.variables = Object.create(parentContext.variables);
            ctx.parentNode = parentContext.parentNode || ctx.generateID();
            ctx.allowMultipleRoots = true;
            ctx.hasParentWidget = true;
            ctx.shouldDefineResult = false;
            ctx.addLine(`let c${ctx.parentNode} = extra.parentNode;`);
            if (defineKey) {
                ctx.addLine(`let key0 = extra.key || "";`);
                ctx.hasKey0 = true;
            }
        }
        this._compileNode(elem, ctx);
        if (!parentContext) {
            if (ctx.shouldDefineResult) {
                ctx.addLine(`return result;`);
            }
            else {
                if (!ctx.rootNode) {
                    throw new Error(`A template should have one root node (${ctx.templateName})`);
                }
                ctx.addLine(`return vn${ctx.rootNode};`);
            }
        }
        let code = ctx.generateCode();
        const templateName = ctx.templateName.replace(/`/g, "'").slice(0, 200);
        code.unshift(`    // Template name: "${templateName}"`);
        let template;
        try {
            template = new Function("context, extra", code.join("\n"));
        }
        catch (e) {
            console.groupCollapsed(`Invalid Code generated by ${templateName}`);
            console.warn(code.join("\n"));
            console.groupEnd();
            throw new Error(`Invalid generated code while compiling template '${templateName}': ${e.message}`);
        }
        if (isDebug) {
            const tpl = this.templates[name];
            if (tpl) {
                const msg = `Template: ${tpl.elem.outerHTML}\nCompiled code:\n${template.toString()}`;
                console.log(msg);
            }
        }
        return template;
    }
    /**
     * Generate code from an xml node
     *
     */
    _compileNode(node, ctx) {
        if (!(node instanceof Element)) {
            // this is a text node, there are no directive to apply
            let text = node.textContent;
            if (!ctx.inPreTag) {
                if (lineBreakRE.test(text) && !text.trim()) {
                    return;
                }
                text = text.replace(whitespaceRE, " ");
            }
            if (this.translateFn) {
                if (node.parentNode.getAttribute("t-translation") !== "off") {
                    text = this.translateFn(text);
                }
            }
            if (ctx.parentNode) {
                if (node.nodeType === 3) {
                    ctx.addLine(`c${ctx.parentNode}.push({text: \`${text}\`});`);
                }
                else if (node.nodeType === 8) {
                    ctx.addLine(`c${ctx.parentNode}.push(h('!', \`${text}\`));`);
                }
            }
            else if (ctx.parentTextNode) {
                ctx.addLine(`vn${ctx.parentTextNode}.text += \`${text}\`;`);
            }
            else {
                // this is an unusual situation: this text node is the result of the
                // template rendering.
                let nodeID = ctx.generateID();
                ctx.addLine(`let vn${nodeID} = {text: \`${text}\`};`);
                ctx.addLine(`result = vn${nodeID};`);
                ctx.rootContext.rootNode = nodeID;
                ctx.rootContext.parentTextNode = nodeID;
            }
            return;
        }
        const firstLetter = node.tagName[0];
        if (firstLetter === firstLetter.toUpperCase()) {
            // this is a component, we modify in place the xml document to change
            // <SomeComponent ... /> to <t t-component="SomeComponent" ... />
            node.setAttribute("t-component", node.tagName);
        }
        else if (node.tagName !== "t" && node.hasAttribute("t-component")) {
            throw new Error(`Directive 't-component' can only be used on <t> nodes (used on a <${node.tagName}>)`);
        }
        const attributes = node.attributes;
        const validDirectives = [];
        const finalizers = [];
        // maybe this is not optimal: we iterate on all attributes here, and again
        // just after for each directive.
        for (let i = 0; i < attributes.length; i++) {
            let attrName = attributes[i].name;
            if (attrName.startsWith("t-")) {
                let dName = attrName.slice(2).split(/-|\./)[0];
                if (!(dName in QWeb.DIRECTIVE_NAMES)) {
                    throw new Error(`Unknown QWeb directive: '${attrName}'`);
                }
                if (node.tagName !== "t" && (attrName === "t-esc" || attrName === "t-raw")) {
                    const tNode = document.createElement("t");
                    tNode.setAttribute(attrName, node.getAttribute(attrName));
                    for (let child of Array.from(node.childNodes)) {
                        tNode.appendChild(child);
                    }
                    node.appendChild(tNode);
                    node.removeAttribute(attrName);
                }
            }
        }
        const DIR_N = QWeb.DIRECTIVES.length;
        const ATTR_N = attributes.length;
        let withHandlers = false;
        for (let i = 0; i < DIR_N; i++) {
            let directive = QWeb.DIRECTIVES[i];
            let fullName;
            let value;
            for (let j = 0; j < ATTR_N; j++) {
                const name = attributes[j].name;
                if (name === "t-" + directive.name ||
                    name.startsWith("t-" + directive.name + "-") ||
                    name.startsWith("t-" + directive.name + ".")) {
                    fullName = name;
                    value = attributes[j].textContent;
                    validDirectives.push({ directive, value, fullName });
                    if (directive.name === "on" || directive.name === "model") {
                        withHandlers = true;
                    }
                }
            }
        }
        for (let { directive, value, fullName } of validDirectives) {
            if (directive.finalize) {
                finalizers.push({ directive, value, fullName });
            }
            if (directive.atNodeEncounter) {
                const isDone = directive.atNodeEncounter({
                    node,
                    qweb: this,
                    ctx,
                    fullName,
                    value
                });
                if (isDone) {
                    for (let { directive, value, fullName } of finalizers) {
                        directive.finalize({ node, qweb: this, ctx, fullName, value });
                    }
                    return;
                }
            }
        }
        if (node.nodeName !== "t") {
            let nodeID = this._compileGenericNode(node, ctx, withHandlers);
            ctx = ctx.withParent(nodeID);
            let nodeHooks = {};
            let addNodeHook = function (hook, handler) {
                nodeHooks[hook] = nodeHooks[hook] || [];
                nodeHooks[hook].push(handler);
            };
            for (let { directive, value, fullName } of validDirectives) {
                if (directive.atNodeCreation) {
                    directive.atNodeCreation({
                        node,
                        qweb: this,
                        ctx,
                        fullName,
                        value,
                        nodeID,
                        addNodeHook
                    });
                }
            }
            if (Object.keys(nodeHooks).length) {
                ctx.addLine(`p${nodeID}.hook = {`);
                for (let hook in nodeHooks) {
                    ctx.addLine(`  ${hook}: ${NODE_HOOKS_PARAMS[hook]} => {`);
                    for (let handler of nodeHooks[hook]) {
                        ctx.addLine(`    ${handler}`);
                    }
                    ctx.addLine(`  },`);
                }
                ctx.addLine(`};`);
            }
        }
        if (node.nodeName === "pre") {
            ctx = ctx.subContext("inPreTag", true);
        }
        this._compileChildren(node, ctx);
        // svg support
        // we hadd svg namespace if it is a svg or if it is a g, but only if it is
        // the root node.  This is the easiest way to support svg sub components:
        // they need to have a g tag as root. Otherwise, we would need a complete
        // list of allowed svg tags.
        const shouldAddNS = node.nodeName === "svg" || (node.nodeName === "g" && ctx.rootNode === ctx.parentNode);
        if (shouldAddNS) {
            ctx.rootContext.shouldDefineUtils = true;
            ctx.addLine(`utils.addNameSpace(vn${ctx.parentNode});`);
        }
        for (let { directive, value, fullName } of finalizers) {
            directive.finalize({ node, qweb: this, ctx, fullName, value });
        }
    }
    _compileGenericNode(node, ctx, withHandlers = true) {
        // nodeType 1 is generic tag
        if (node.nodeType !== 1) {
            throw new Error("unsupported node type");
        }
        const attributes = node.attributes;
        const attrs = [];
        const props = [];
        const tattrs = [];
        function handleBooleanProps(key, val) {
            let isProp = false;
            if (node.nodeName === "input" && key === "checked") {
                let type = node.getAttribute("type");
                if (type === "checkbox" || type === "radio") {
                    isProp = true;
                }
            }
            if (node.nodeName === "option" && key === "selected") {
                isProp = true;
            }
            if (key === "disabled" && DISABLED_TAGS.indexOf(node.nodeName) > -1) {
                isProp = true;
            }
            if ((key === "readonly" && node.nodeName === "input") || node.nodeName === "textarea") {
                isProp = true;
            }
            if (isProp) {
                props.push(`${key}: _${val}`);
            }
        }
        let classObj = "";
        for (let i = 0; i < attributes.length; i++) {
            let name = attributes[i].name;
            let value = attributes[i].textContent;
            if (this.translateFn && TRANSLATABLE_ATTRS.includes(name)) {
                value = this.translateFn(value);
            }
            // regular attributes
            if (!name.startsWith("t-") && !node.getAttribute("t-attf-" + name)) {
                const attID = ctx.generateID();
                if (name === "class") {
                    if ((value = value.trim())) {
                        let classDef = value
                            .split(/\s+/)
                            .map(a => `'${escapeQuotes(a)}':true`)
                            .join(",");
                        classObj = `_${ctx.generateID()}`;
                        ctx.addLine(`let ${classObj} = {${classDef}};`);
                    }
                }
                else {
                    ctx.addLine(`let _${attID} = '${escapeQuotes(value)}';`);
                    if (!name.match(/^[a-zA-Z]+$/)) {
                        // attribute contains 'non letters' => we want to quote it
                        name = '"' + name + '"';
                    }
                    attrs.push(`${name}: _${attID}`);
                    handleBooleanProps(name, attID);
                }
            }
            // dynamic attributes
            if (name.startsWith("t-att-")) {
                let attName = name.slice(6);
                const v = ctx.getValue(value);
                let formattedValue = typeof v === "string" ? ctx.formatExpression(v) : `scope.${v.id}`;
                if (attName === "class") {
                    ctx.rootContext.shouldDefineUtils = true;
                    formattedValue = `utils.toObj(${formattedValue})`;
                    if (classObj) {
                        ctx.addLine(`Object.assign(${classObj}, ${formattedValue})`);
                    }
                    else {
                        classObj = `_${ctx.generateID()}`;
                        ctx.addLine(`let ${classObj} = ${formattedValue};`);
                    }
                }
                else {
                    const attID = ctx.generateID();
                    if (!attName.match(/^[a-zA-Z]+$/)) {
                        // attribute contains 'non letters' => we want to quote it
                        attName = '"' + attName + '"';
                    }
                    // we need to combine dynamic with non dynamic attributes:
                    // class="a" t-att-class="'yop'" should be rendered as class="a yop"
                    const attValue = node.getAttribute(attName);
                    if (attValue) {
                        const attValueID = ctx.generateID();
                        ctx.addLine(`let _${attValueID} = ${formattedValue};`);
                        formattedValue = `'${attValue}' + (_${attValueID} ? ' ' + _${attValueID} : '')`;
                        const attrIndex = attrs.findIndex(att => att.startsWith(attName + ":"));
                        attrs.splice(attrIndex, 1);
                    }
                    ctx.addLine(`let _${attID} = ${formattedValue};`);
                    attrs.push(`${attName}: _${attID}`);
                    handleBooleanProps(attName, attID);
                }
            }
            if (name.startsWith("t-attf-")) {
                let attName = name.slice(7);
                if (!attName.match(/^[a-zA-Z]+$/)) {
                    // attribute contains 'non letters' => we want to quote it
                    attName = '"' + attName + '"';
                }
                const formattedExpr = ctx.interpolate(value);
                const attID = ctx.generateID();
                let staticVal = node.getAttribute(attName);
                if (staticVal) {
                    ctx.addLine(`let _${attID} = '${staticVal} ' + ${formattedExpr};`);
                }
                else {
                    ctx.addLine(`let _${attID} = ${formattedExpr};`);
                }
                attrs.push(`${attName}: _${attID}`);
            }
            // t-att= attributes
            if (name === "t-att") {
                let id = ctx.generateID();
                ctx.addLine(`let _${id} = ${ctx.formatExpression(value)};`);
                tattrs.push(id);
            }
        }
        let nodeID = ctx.generateID();
        let key = ctx.loopNumber || ctx.hasKey0 ? `\`\${key${ctx.loopNumber}}_${nodeID}\`` : nodeID;
        const parts = [`key:${key}`];
        if (attrs.length + tattrs.length > 0) {
            parts.push(`attrs:{${attrs.join(",")}}`);
        }
        if (props.length > 0) {
            parts.push(`props:{${props.join(",")}}`);
        }
        if (classObj) {
            parts.push(`class:${classObj}`);
        }
        if (withHandlers) {
            parts.push(`on:{}`);
        }
        ctx.addLine(`let c${nodeID} = [], p${nodeID} = {${parts.join(",")}};`);
        for (let id of tattrs) {
            ctx.addIf(`_${id} instanceof Array`);
            ctx.addLine(`p${nodeID}.attrs[_${id}[0]] = _${id}[1];`);
            ctx.addElse();
            ctx.addLine(`for (let key in _${id}) {`);
            ctx.indent();
            ctx.addLine(`p${nodeID}.attrs[key] = _${id}[key];`);
            ctx.dedent();
            ctx.addLine(`}`);
            ctx.closeIf();
        }
        ctx.addLine(`let vn${nodeID} = h('${node.nodeName}', p${nodeID}, c${nodeID});`);
        if (ctx.parentNode) {
            ctx.addLine(`c${ctx.parentNode}.push(vn${nodeID});`);
        }
        else if (ctx.loopNumber || ctx.hasKey0) {
            ctx.rootContext.shouldDefineResult = true;
            ctx.addLine(`result = vn${nodeID};`);
        }
        return nodeID;
    }
    _compileChildren(node, ctx) {
        if (node.childNodes.length > 0) {
            for (let child of Array.from(node.childNodes)) {
                this._compileNode(child, ctx);
            }
        }
    }
}
QWeb.utils = UTILS;
QWeb.components = Object.create(null);
QWeb.DIRECTIVE_NAMES = {
    name: 1,
    att: 1,
    attf: 1,
    translation: 1
};
QWeb.DIRECTIVES = [];
QWeb.TEMPLATES = {};
QWeb.nextId = 1;
// dev mode enables better error messages or more costly validations
QWeb.dev = false;
// slots contains sub templates defined with t-set inside t-component nodes, and
// are meant to be used by the t-slot directive.
QWeb.slots = {};
QWeb.nextSlotId = 1;

const parser = new DOMParser();
function htmlToVDOM(html) {
    const doc = parser.parseFromString(html, "text/html");
    const result = [];
    for (let child of doc.body.childNodes) {
        result.push(htmlToVNode(child));
    }
    return result;
}
function htmlToVNode(node) {
    if (!(node instanceof Element)) {
        return { text: node.textContent };
    }
    const attrs = {};
    for (let attr of node.attributes) {
        attrs[attr.name] = attr.textContent;
    }
    const children = [];
    for (let c of node.childNodes) {
        children.push(htmlToVNode(c));
    }
    return h(node.tagName, { attrs }, children);
}

/**
 * Owl QWeb Directives
 *
 * This file contains the implementation of most standard QWeb directives:
 * - t-esc
 * - t-raw
 * - t-set/t-value
 * - t-if/t-elif/t-else
 * - t-call
 * - t-foreach/t-as
 * - t-debug
 * - t-log
 */
//------------------------------------------------------------------------------
// t-esc and t-raw
//------------------------------------------------------------------------------
QWeb.utils.htmlToVDOM = htmlToVDOM;
function compileValueNode(value, node, qweb, ctx) {
    ctx.rootContext.shouldDefineScope = true;
    if (value === "0") {
        if (ctx.parentNode) {
            // the 'zero' magical symbol is where we can find the result of the rendering
            // of  the body of the t-call.
            ctx.rootContext.shouldDefineUtils = true;
            const zeroArgs = ctx.escaping
                ? `{text: utils.vDomToString(scope[utils.zero])}`
                : `...scope[utils.zero]`;
            ctx.addLine(`c${ctx.parentNode}.push(${zeroArgs});`);
        }
        return;
    }
    let exprID;
    if (typeof value === "string") {
        exprID = `_${ctx.generateID()}`;
        ctx.addLine(`let ${exprID} = ${ctx.formatExpression(value)};`);
    }
    else {
        exprID = `scope.${value.id}`;
    }
    ctx.addIf(`${exprID} != null`);
    if (ctx.escaping) {
        let protectID;
        if (value.hasBody) {
            protectID = ctx.startProtectScope();
            ctx.addLine(`${exprID} = ${exprID} instanceof utils.VDomArray ? utils.vDomToString(${exprID}) : ${exprID};`);
        }
        if (ctx.parentTextNode) {
            ctx.addLine(`vn${ctx.parentTextNode}.text += ${exprID};`);
        }
        else if (ctx.parentNode) {
            ctx.addLine(`c${ctx.parentNode}.push({text: ${exprID}});`);
        }
        else {
            let nodeID = ctx.generateID();
            ctx.rootContext.rootNode = nodeID;
            ctx.rootContext.parentTextNode = nodeID;
            ctx.addLine(`let vn${nodeID} = {text: ${exprID}};`);
            if (ctx.rootContext.shouldDefineResult) {
                ctx.addLine(`result = vn${nodeID}`);
            }
        }
        if (value.hasBody) {
            ctx.stopProtectScope(protectID);
        }
    }
    else {
        ctx.rootContext.shouldDefineUtils = true;
        if (value.hasBody) {
            ctx.addLine(`const vnodeArray = ${exprID} instanceof utils.VDomArray ? ${exprID} : utils.htmlToVDOM(${exprID});`);
            ctx.addLine(`c${ctx.parentNode}.push(...vnodeArray);`);
        }
        else {
            ctx.addLine(`c${ctx.parentNode}.push(...utils.htmlToVDOM(${exprID}));`);
        }
    }
    if (node.childNodes.length) {
        ctx.addElse();
        qweb._compileChildren(node, ctx);
    }
    ctx.closeIf();
}
QWeb.addDirective({
    name: "esc",
    priority: 70,
    atNodeEncounter({ node, qweb, ctx }) {
        let value = ctx.getValue(node.getAttribute("t-esc"));
        compileValueNode(value, node, qweb, ctx.subContext("escaping", true));
        return true;
    }
});
QWeb.addDirective({
    name: "raw",
    priority: 80,
    atNodeEncounter({ node, qweb, ctx }) {
        let value = ctx.getValue(node.getAttribute("t-raw"));
        compileValueNode(value, node, qweb, ctx);
        return true;
    }
});
//------------------------------------------------------------------------------
// t-set
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "set",
    extraNames: ["value"],
    priority: 60,
    atNodeEncounter({ node, qweb, ctx }) {
        ctx.rootContext.shouldDefineScope = true;
        const variable = node.getAttribute("t-set");
        let value = node.getAttribute("t-value");
        ctx.variables[variable] = ctx.variables[variable] || {};
        let qwebvar = ctx.variables[variable];
        const hasBody = node.hasChildNodes();
        qwebvar.id = variable;
        qwebvar.expr = `scope.${variable}`;
        if (value) {
            const formattedValue = ctx.formatExpression(value);
            let scopeExpr = `scope`;
            if (ctx.protectedScopeNumber) {
                ctx.rootContext.shouldDefineUtils = true;
                scopeExpr = `utils.getScope(scope, '${variable}')`;
            }
            ctx.addLine(`${scopeExpr}.${variable} = ${formattedValue};`);
            qwebvar.value = formattedValue;
        }
        if (hasBody) {
            ctx.rootContext.shouldDefineUtils = true;
            if (value) {
                ctx.addIf(`!(${qwebvar.expr})`);
            }
            const tempParentNodeID = ctx.generateID();
            const _parentNode = ctx.parentNode;
            ctx.parentNode = tempParentNodeID;
            ctx.addLine(`let c${tempParentNodeID} = new utils.VDomArray();`);
            const nodeCopy = node.cloneNode(true);
            for (let attr of ["t-set", "t-value", "t-if", "t-else", "t-elif"]) {
                nodeCopy.removeAttribute(attr);
            }
            qweb._compileNode(nodeCopy, ctx);
            ctx.addLine(`${qwebvar.expr} = c${tempParentNodeID}`);
            qwebvar.value = `c${tempParentNodeID}`;
            qwebvar.hasBody = true;
            ctx.parentNode = _parentNode;
            if (value) {
                ctx.closeIf();
            }
        }
        return true;
    }
});
//------------------------------------------------------------------------------
// t-if, t-elif, t-else
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "if",
    priority: 20,
    atNodeEncounter({ node, ctx }) {
        let cond = ctx.getValue(node.getAttribute("t-if"));
        ctx.addIf(typeof cond === "string" ? ctx.formatExpression(cond) : `scope.${cond.id}`);
        return false;
    },
    finalize({ ctx }) {
        ctx.closeIf();
    }
});
QWeb.addDirective({
    name: "elif",
    priority: 30,
    atNodeEncounter({ node, ctx }) {
        let cond = ctx.getValue(node.getAttribute("t-elif"));
        ctx.addLine(`else if (${typeof cond === "string" ? ctx.formatExpression(cond) : `scope.${cond.id}`}) {`);
        ctx.indent();
        return false;
    },
    finalize({ ctx }) {
        ctx.closeIf();
    }
});
QWeb.addDirective({
    name: "else",
    priority: 40,
    atNodeEncounter({ ctx }) {
        ctx.addLine(`else {`);
        ctx.indent();
        return false;
    },
    finalize({ ctx }) {
        ctx.closeIf();
    }
});
//------------------------------------------------------------------------------
// t-call
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "call",
    priority: 50,
    atNodeEncounter({ node, qweb, ctx }) {
        // Step 1: sanity checks
        // ------------------------------------------------
        ctx.rootContext.shouldDefineScope = true;
        ctx.rootContext.shouldDefineUtils = true;
        if (node.nodeName !== "t") {
            throw new Error("Invalid tag for t-call directive (should be 't')");
        }
        const subTemplate = node.getAttribute("t-call");
        const nodeTemplate = qweb.templates[subTemplate];
        if (!nodeTemplate) {
            throw new Error(`Cannot find template "${subTemplate}" (t-call)`);
        }
        // Step 2: compile target template in sub templates
        // ------------------------------------------------
        if (!qweb.subTemplates[subTemplate]) {
            qweb.subTemplates[subTemplate] = true;
            const subTemplateFn = qweb._compile(subTemplate, nodeTemplate.elem, ctx, true);
            qweb.subTemplates[subTemplate] = subTemplateFn;
        }
        // Step 3: compile t-call body if necessary
        // ------------------------------------------------
        let hasBody = node.hasChildNodes();
        let protectID;
        if (hasBody) {
            // we add a sub scope to protect the ambient scope
            ctx.addLine(`{`);
            ctx.indent();
            protectID = ctx.startProtectScope();
            const nodeCopy = node.cloneNode(true);
            for (let attr of ["t-if", "t-else", "t-elif", "t-call"]) {
                nodeCopy.removeAttribute(attr);
            }
            const parentNode = ctx.parentNode;
            ctx.parentNode = "__0";
            // this local scope is intended to trap c__0
            ctx.addLine(`{`);
            ctx.indent();
            ctx.addLine("let c__0 = [];");
            qweb._compileNode(nodeCopy, ctx);
            ctx.rootContext.shouldDefineUtils = true;
            ctx.addLine("scope[utils.zero] = c__0;");
            ctx.parentNode = parentNode;
            ctx.dedent();
            ctx.addLine(`}`);
        }
        // Step 4: add the appropriate function call to current component
        // ------------------------------------------------
        const callingScope = hasBody ? "scope" : "Object.assign(Object.create(context), scope)";
        const parentComponent = `utils.getComponent(context)`;
        const key = ctx.generateTemplateKey();
        const parentNode = ctx.parentNode ? `c${ctx.parentNode}` : "result";
        const extra = `Object.assign({}, extra, {parentNode: ${parentNode}, parent: ${parentComponent}, key: ${key}})`;
        if (ctx.parentNode) {
            ctx.addLine(`this.subTemplates['${subTemplate}'].call(this, ${callingScope}, ${extra});`);
        }
        else {
            // this is a t-call with no parentnode, we need to extract the result
            ctx.rootContext.shouldDefineResult = true;
            ctx.addLine(`result = []`);
            ctx.addLine(`this.subTemplates['${subTemplate}'].call(this, ${callingScope}, ${extra});`);
            ctx.addLine(`result = result[0]`);
        }
        // Step 5: restore previous scope
        // ------------------------------------------------
        if (hasBody) {
            ctx.stopProtectScope(protectID);
            ctx.dedent();
            ctx.addLine(`}`);
        }
        return true;
    }
});
//------------------------------------------------------------------------------
// t-foreach
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "foreach",
    extraNames: ["as"],
    priority: 10,
    atNodeEncounter({ node, qweb, ctx }) {
        ctx.rootContext.shouldDefineScope = true;
        ctx = ctx.subContext("loopNumber", ctx.loopNumber + 1);
        const elems = node.getAttribute("t-foreach");
        const name = node.getAttribute("t-as");
        let arrayID = ctx.generateID();
        ctx.addLine(`let _${arrayID} = ${ctx.formatExpression(elems)};`);
        ctx.addLine(`if (!_${arrayID}) { throw new Error('QWeb error: Invalid loop expression')}`);
        let keysID = ctx.generateID();
        let valuesID = ctx.generateID();
        ctx.addLine(`let _${keysID} = _${valuesID} = _${arrayID};`);
        ctx.addIf(`!(_${arrayID} instanceof Array)`);
        ctx.addLine(`_${keysID} = Object.keys(_${arrayID});`);
        ctx.addLine(`_${valuesID} = Object.values(_${arrayID});`);
        ctx.closeIf();
        ctx.addLine(`let _length${keysID} = _${keysID}.length;`);
        let varsID = ctx.startProtectScope(true);
        const loopVar = `i${ctx.loopNumber}`;
        ctx.addLine(`for (let ${loopVar} = 0; ${loopVar} < _length${keysID}; ${loopVar}++) {`);
        ctx.indent();
        ctx.addLine(`scope.${name}_first = ${loopVar} === 0`);
        ctx.addLine(`scope.${name}_last = ${loopVar} === _length${keysID} - 1`);
        ctx.addLine(`scope.${name}_index = ${loopVar}`);
        ctx.addLine(`scope.${name} = _${keysID}[${loopVar}]`);
        ctx.addLine(`scope.${name}_value = _${valuesID}[${loopVar}]`);
        const nodeCopy = node.cloneNode(true);
        let shouldWarn = !nodeCopy.hasAttribute("t-key") &&
            node.children.length === 1 &&
            node.children[0].tagName !== "t" &&
            !node.children[0].hasAttribute("t-key");
        if (shouldWarn) {
            console.warn(`Directive t-foreach should always be used with a t-key! (in template: '${ctx.templateName}')`);
        }
        if (nodeCopy.hasAttribute("t-key")) {
            const expr = ctx.formatExpression(nodeCopy.getAttribute("t-key"));
            ctx.addLine(`let key${ctx.loopNumber} = ${expr};`);
            nodeCopy.removeAttribute("t-key");
        }
        else {
            ctx.addLine(`let key${ctx.loopNumber} = i${ctx.loopNumber};`);
        }
        nodeCopy.removeAttribute("t-foreach");
        qweb._compileNode(nodeCopy, ctx);
        ctx.dedent();
        ctx.addLine("}");
        ctx.stopProtectScope(varsID);
        return true;
    }
});
//------------------------------------------------------------------------------
// t-debug
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "debug",
    priority: 1,
    atNodeEncounter({ ctx }) {
        ctx.addLine("debugger;");
    }
});
//------------------------------------------------------------------------------
// t-log
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "log",
    priority: 1,
    atNodeEncounter({ ctx, value }) {
        const expr = ctx.formatExpression(value);
        ctx.addLine(`console.log(${expr})`);
    }
});

/**
 * Owl QWeb Extensions
 *
 * This file contains the implementation of non standard QWeb directives, added
 * by Owl and that will only work on Owl projects:
 *
 * - t-on
 * - t-ref
 * - t-transition
 * - t-mounted
 * - t-slot
 * - t-model
 */
//------------------------------------------------------------------------------
// t-on
//------------------------------------------------------------------------------
// these are pieces of code that will be injected into the event handler if
// modifiers are specified
const MODS_CODE = {
    prevent: "e.preventDefault();",
    self: "if (e.target !== this.elm) {return}",
    stop: "e.stopPropagation();"
};
const FNAMEREGEXP = /^[$A-Z_][0-9A-Z_$]*$/i;
function makeHandlerCode(ctx, fullName, value, putInCache, modcodes = MODS_CODE) {
    let [event, ...mods] = fullName.slice(5).split(".");
    if (mods.includes("capture")) {
        event = "!" + event;
    }
    if (!event) {
        throw new Error("Missing event name with t-on directive");
    }
    let code;
    // check if it is a method with no args, a method with args or an expression
    let args = "";
    const name = value.replace(/\(.*\)/, function (_args) {
        args = _args.slice(1, -1);
        return "";
    });
    const isMethodCall = name.match(FNAMEREGEXP);
    // then generate code
    if (isMethodCall) {
        ctx.rootContext.shouldDefineUtils = true;
        const comp = `utils.getComponent(context)`;
        if (args) {
            const argId = ctx.generateID();
            ctx.addLine(`let args${argId} = [${ctx.formatExpression(args)}];`);
            code = `${comp}['${name}'](...args${argId}, e);`;
            putInCache = false;
        }
        else {
            code = `${comp}['${name}'](e);`;
        }
    }
    else {
        // if we get here, then it is an expression
        // we need to capture every variable in it
        putInCache = false;
        code = ctx.captureExpression(value);
    }
    const modCode = mods.map(mod => modcodes[mod]).join("");
    let handler = `function (e) {if (!context.__owl__.isMounted){return}${modCode}${code}}`;
    if (putInCache) {
        const key = ctx.generateTemplateKey(event);
        ctx.addLine(`extra.handlers[${key}] = extra.handlers[${key}] || ${handler};`);
        handler = `extra.handlers[${key}]`;
    }
    return { event, handler };
}
QWeb.addDirective({
    name: "on",
    priority: 90,
    atNodeCreation({ ctx, fullName, value, nodeID }) {
        const { event, handler } = makeHandlerCode(ctx, fullName, value, true);
        ctx.addLine(`p${nodeID}.on['${event}'] = ${handler};`);
    }
});
//------------------------------------------------------------------------------
// t-ref
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "ref",
    priority: 95,
    atNodeCreation({ ctx, value, addNodeHook }) {
        ctx.rootContext.shouldDefineRefs = true;
        const refKey = `ref${ctx.generateID()}`;
        ctx.addLine(`const ${refKey} = ${ctx.interpolate(value)};`);
        addNodeHook("create", `context.__owl__.refs[${refKey}] = n.elm;`);
        addNodeHook("destroy", `delete context.__owl__.refs[${refKey}];`);
    }
});
//------------------------------------------------------------------------------
// t-transition
//------------------------------------------------------------------------------
QWeb.utils.nextFrame = function (cb) {
    requestAnimationFrame(() => requestAnimationFrame(cb));
};
QWeb.utils.transitionInsert = function (vn, name) {
    const elm = vn.elm;
    // remove potential duplicated vnode that is currently being removed, to
    // prevent from having twice the same node in the DOM during an animation
    const dup = elm.parentElement && elm.parentElement.querySelector(`*[data-owl-key='${vn.key}']`);
    if (dup) {
        dup.remove();
    }
    elm.classList.add(name + "-enter");
    elm.classList.add(name + "-enter-active");
    elm.classList.remove(name + "-leave-active");
    elm.classList.remove(name + "-leave-to");
    const finalize = () => {
        elm.classList.remove(name + "-enter-active");
        elm.classList.remove(name + "-enter-to");
    };
    this.nextFrame(() => {
        elm.classList.remove(name + "-enter");
        elm.classList.add(name + "-enter-to");
        whenTransitionEnd(elm, finalize);
    });
};
QWeb.utils.transitionRemove = function (vn, name, rm) {
    const elm = vn.elm;
    elm.setAttribute("data-owl-key", vn.key);
    elm.classList.add(name + "-leave");
    elm.classList.add(name + "-leave-active");
    const finalize = () => {
        if (!elm.classList.contains(name + "-leave-active")) {
            return;
        }
        elm.classList.remove(name + "-leave-active");
        elm.classList.remove(name + "-leave-to");
        rm();
    };
    this.nextFrame(() => {
        elm.classList.remove(name + "-leave");
        elm.classList.add(name + "-leave-to");
        whenTransitionEnd(elm, finalize);
    });
};
function getTimeout(delays, durations) {
    /* istanbul ignore next */
    while (delays.length < durations.length) {
        delays = delays.concat(delays);
    }
    return Math.max.apply(null, durations.map((d, i) => {
        return toMs(d) + toMs(delays[i]);
    }));
}
// Old versions of Chromium (below 61.0.3163.100) formats floating pointer numbers
// in a locale-dependent way, using a comma instead of a dot.
// If comma is not replaced with a dot, the input will be rounded down (i.e. acting
// as a floor function) causing unexpected behaviors
function toMs(s) {
    return Number(s.slice(0, -1).replace(",", ".")) * 1000;
}
function whenTransitionEnd(elm, cb) {
    if (!elm.parentNode) {
        // if we get here, this means that the element was removed for some other
        // reasons, and in that case, we don't want to work on animation since nothing
        // will be displayed anyway.
        return;
    }
    const styles = window.getComputedStyle(elm);
    const delays = (styles.transitionDelay || "").split(", ");
    const durations = (styles.transitionDuration || "").split(", ");
    const timeout = getTimeout(delays, durations);
    if (timeout > 0) {
        elm.addEventListener("transitionend", cb, { once: true });
    }
    else {
        cb();
    }
}
QWeb.addDirective({
    name: "transition",
    priority: 96,
    atNodeCreation({ ctx, value, addNodeHook }) {
        ctx.rootContext.shouldDefineUtils = true;
        let name = value;
        const hooks = {
            insert: `utils.transitionInsert(vn, '${name}');`,
            remove: `utils.transitionRemove(vn, '${name}', rm);`
        };
        for (let hookName in hooks) {
            addNodeHook(hookName, hooks[hookName]);
        }
    }
});
//------------------------------------------------------------------------------
// t-slot
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "slot",
    priority: 80,
    atNodeEncounter({ ctx, value, node, qweb }) {
        const slotKey = ctx.generateID();
        ctx.addLine(`const slot${slotKey} = this.constructor.slots[context.__owl__.slotId + '_' + '${value}'];`);
        ctx.addIf(`slot${slotKey}`);
        let parentNode = `c${ctx.parentNode}`;
        if (!ctx.parentNode) {
            ctx.rootContext.shouldDefineResult = true;
            ctx.rootContext.shouldDefineUtils = true;
            parentNode = `children${ctx.generateID()}`;
            ctx.addLine(`let ${parentNode}= []`);
            ctx.addLine(`result = {}`);
        }
        ctx.addLine(`slot${slotKey}.call(this, context.__owl__.scope, Object.assign({}, extra, {parentNode: ${parentNode}, parent: extra.parent || context}));`);
        if (!ctx.parentNode) {
            ctx.addLine(`utils.defineProxy(result, ${parentNode}[0]);`);
        }
        if (node.hasChildNodes()) {
            ctx.addElse();
            const nodeCopy = node.cloneNode(true);
            nodeCopy.removeAttribute("t-slot");
            qweb._compileNode(nodeCopy, ctx);
        }
        ctx.closeIf();
        return true;
    }
});
//------------------------------------------------------------------------------
// t-model
//------------------------------------------------------------------------------
QWeb.utils.toNumber = function (val) {
    const n = parseFloat(val);
    return isNaN(n) ? val : n;
};
QWeb.addDirective({
    name: "model",
    priority: 42,
    atNodeCreation({ ctx, nodeID, value, node, fullName, addNodeHook }) {
        const type = node.getAttribute("type");
        let handler;
        let event = fullName.includes(".lazy") ? "change" : "input";
        // we keep here a reference to the "base expression" (if the expression
        // is `t-model="some.expr.value", then the base expression is "some.expr").
        // This is necessary so we can capture it in the handler closure.
        let expr = ctx.formatExpression(value);
        const index = expr.lastIndexOf(".");
        const baseExpr = expr.slice(0, index);
        ctx.addLine(`let expr${nodeID} = ${baseExpr};`);
        expr = `expr${nodeID}.${expr.slice(index + 1)}`;
        const key = ctx.generateTemplateKey();
        if (node.tagName === "select") {
            ctx.addLine(`p${nodeID}.props = {value: ${expr}};`);
            addNodeHook("create", `n.elm.value=${expr};`);
            event = "change";
            handler = `(ev) => {${expr} = ev.target.value}`;
        }
        else if (type === "checkbox") {
            ctx.addLine(`p${nodeID}.props = {checked: ${expr}};`);
            handler = `(ev) => {${expr} = ev.target.checked}`;
        }
        else if (type === "radio") {
            const nodeValue = node.getAttribute("value");
            ctx.addLine(`p${nodeID}.props = {checked:${expr} === '${nodeValue}'};`);
            handler = `(ev) => {${expr} = ev.target.value}`;
            event = "click";
        }
        else {
            ctx.addLine(`p${nodeID}.props = {value: ${expr}};`);
            const trimCode = fullName.includes(".trim") ? ".trim()" : "";
            let valueCode = `ev.target.value${trimCode}`;
            if (fullName.includes(".number")) {
                ctx.rootContext.shouldDefineUtils = true;
                valueCode = `utils.toNumber(${valueCode})`;
            }
            handler = `(ev) => {${expr} = ${valueCode}}`;
        }
        ctx.addLine(`extra.handlers[${key}] = extra.handlers[${key}] || (${handler});`);
        ctx.addLine(`p${nodeID}.on['${event}'] = extra.handlers[${key}];`);
    }
});
//------------------------------------------------------------------------------
// t-key
//------------------------------------------------------------------------------
QWeb.addDirective({
    name: "key",
    priority: 45,
    atNodeEncounter({ ctx, value, node }) {
        if (ctx.loopNumber === 0) {
            ctx.keyStack.push(ctx.rootContext.hasKey0);
            ctx.rootContext.hasKey0 = true;
        }
        ctx.addLine("{");
        ctx.indent();
        ctx.addLine(`let key${ctx.loopNumber} = ${ctx.formatExpression(value)};`);
    },
    finalize({ ctx }) {
        ctx.dedent();
        ctx.addLine("}");
        if (ctx.loopNumber === 0) {
            ctx.rootContext.hasKey0 = ctx.keyStack.pop();
        }
    }
});

const config = {};
Object.defineProperty(config, "mode", {
    get() {
        return QWeb.dev ? "dev" : "prod";
    },
    set(mode) {
        QWeb.dev = mode === "dev";
        if (QWeb.dev) {
            const url = `https://github.com/odoo/owl/blob/master/doc/reference/config.md#mode`;
            console.warn(`Owl is running in 'dev' mode.  This is not suitable for production use. See ${url} for more information.`);
        }
        else {
            console.log(`Owl is now running in 'prod' mode.`);
        }
    }
});

/**
 * We define here OwlEvent, a subclass of CustomEvent, with an additional
 * attribute:
 *  - originalComponent: the component that triggered the event
 */
class OwlEvent extends CustomEvent {
    constructor(component, eventType, options) {
        super(eventType, options);
        this.originalComponent = component;
    }
}

//------------------------------------------------------------------------------
// t-component
//------------------------------------------------------------------------------
const T_COMPONENT_MODS_CODE = Object.assign({}, MODS_CODE, {
    self: "if (e.target !== vn.elm) {return}"
});
QWeb.utils.defineProxy = function defineProxy(target, source) {
    for (let k in source) {
        Object.defineProperty(target, k, {
            get() {
                return source[k];
            },
            set(val) {
                source[k] = val;
            }
        });
    }
};
QWeb.utils.assignHooks = function assignHooks(dataObj, hooks) {
    if ("hook" in dataObj) {
        const hookObject = dataObj.hook;
        for (let name in hooks) {
            const current = hookObject[name];
            const fn = hooks[name];
            if (current) {
                hookObject[name] = (...args) => {
                    current(...args);
                    fn(...args);
                };
            }
            else {
                hookObject[name] = fn;
            }
        }
    }
    else {
        dataObj.hook = hooks;
    }
};
/**
 * The t-component directive is certainly a complicated and hard to maintain piece
 * of code.  To help you, fellow developer, if you have to maintain it, I offer
 * you this advice: Good luck...
 *
 * Since it is not 'direct' code, but rather code that generates other code, it
 * is not easy to understand.  To help you, here  is a detailed and commented
 * explanation of the code generated by the t-component directive for the following
 * situation:
 * ```xml
 *   <Child
 *      t-key="'somestring'"
 *      flag="state.flag"
 *      t-transition="fade"/>
 * ```
 *
 * ```js
 * // we assign utils on top of the function because it will be useful for
 * // each components
 * let utils = this.utils;
 *
 * // this is the virtual node representing the parent div
 * let c1 = [], p1 = { key: 1 };
 * var vn1 = h("div", p1, c1);
 *
 * // t-component directive: we start by evaluating the expression given by t-key:
 * let key5 = "somestring";
 *
 * // def3 is the promise that will contain later either the new component
 * // creation, or the props update...
 * let def3;
 *
 * // this is kind of tricky: we need here to find if the component was already
 * // created by a previous rendering.  This is done by checking the internal
 * // `cmap` (children map) of the parent component: it maps keys to component ids,
 * // and, then, if there is an id, we look into the children list to get the
 * // instance
 * let w4 =
 *   key5 in context.__owl__.cmap
 *   ? context.__owl__.children[context.__owl__.cmap[key5]]
 *   : false;
 *
 * // We keep the index of the position of the component in the closure.  We push
 * // null to reserve the slot, and will replace it later by the component vnode,
 * // when it will be ready (do not forget that preparing/rendering a component is
 * // asynchronous)
 * let _2_index = c1.length;
 * c1.push(null);
 *
 * // we evaluate here the props given to the component. It is done here to be
 * // able to easily reference it later, and also, it might be an expensive
 * // computation, so it is certainly better to do it only once
 * let props4 = { flag: context["state"].flag };
 *
 * // If we have a component, currently rendering, but not ready yet, we do not want
 * // to wait for it to be ready if we can avoid it
 * if (w4 && w4.__owl__.renderPromise && !w4.__owl__.vnode) {
 *   // we check if the props are the same.  In that case, we can simply reuse
 *   // the previous rendering and skip all useless work
 *   if (utils.shallowEqual(props4, w4.__owl__.renderProps)) {
 *     def3 = w4.__owl__.renderPromise;
 *   } else {
 *     // if the props are not the same, we destroy the component and starts anew.
 *     // this will be faster than waiting for its rendering, then updating it
 *     w4.destroy();
 *     w4 = false;
 *   }
 * }
 *
 * if (!w4) {
 *   // in this situation, we need to create a new component.  First step is
 *   // to get a reference to the class, then create an instance with
 *   // current context as parent, and the props.
 *   let W4 = context.component && context.components[componentKey4] || QWeb.component[componentKey4];

 *   if (!W4) {
 *     throw new Error("Cannot find the definition of component 'child'");
 *   }
 *   w4 = new W4(owner, props4);
 *
 *   // Whenever we rerender the parent component, we need to be sure that we
 *   // are able to find the component instance. To do that, we register it to
 *   // the parent cmap (children map).  Note that the 'template' key is
 *   // used here, since this is what identify the component from the template
 *   // perspective.
 *   context.__owl__.cmap[key5] = w4.__owl__.id;
 *
 *   // __prepare is called, to basically call willStart, then render the
 *   // component
 *   def3 = w4.__prepare();
 *
 *   def3 = def3.then(vnode => {
 *     // we create here a virtual node for the parent (NOT the component). This
 *     // means that the vdom of the parent will be stopped here, and from
 *     // the parent's perspective, it simply is a vnode with no children.
 *     // However, it shares the same dom element with the component root
 *     // vnode.
 *     let pvnode = h(vnode.sel, { key: key5 });
 *
 *     // we add hooks to the parent vnode so we can interact with the new
 *     // component at the proper time
 *     pvnode.data.hook = {
 *       insert(vn) {
 *         // the __mount method will patch the component vdom into the elm vn.elm,
 *         // then call the mounted hooks. However, suprisingly, the snabbdom
 *         // patch method actually replace the elm by a new elm, so we need
 *         // to synchronise the pvnode elm with the resulting elm
 *         let nvn = w4.__mount(vnode, vn.elm);
 *         pvnode.elm = nvn.elm;
 *         // what follows is only present if there are animations on the component
 *         utils.transitionInsert(vn, "fade");
 *       },
 *       remove() {
 *         // override with empty function to prevent from removing the node
 *         // directly. It will be removed when destroy is called anyway, which
 *         // delays the removal if there are animations.
 *       },
 *       destroy() {
 *         // if there are animations, we delay the call to destroy on the
 *         // component, if not, we call it directly.
 *         let finalize = () => {
 *           w4.destroy();
 *         };
 *         utils.transitionRemove(vn, "fade", finalize);
 *       }
 *     };
 *     // the pvnode is inserted at the correct position in the div's children
 *     c1[_2_index] = pvnode;
 *
 *     // we keep here a reference to the parent vnode (representing the
 *     // component, so we can reuse it later whenever we update the component
 *     w4.__owl__.pvnode = pvnode;
 *   });
 * } else {
 *   // this is the 'update' path of the directive.
 *   // the call to __updateProps is the actual component update
 *   // Note that we only update the props if we cannot reuse the previous
 *   // rendering work (in the case it was rendered with the same props)
 *   def3 = def3 || w4.__updateProps(props4, extra.forceUpdate, extra.patchQueue);
 *   def3 = def3.then(() => {
 *     // if component was destroyed in the meantime, we do nothing (so, this
 *     // means that the parent's element children list will have a null in
 *     // the component's position, which will cause the pvnode to be removed
 *     // when it is patched.
 *     if (w4.__owl__.isDestroyed) {
 *       return;
 *     }
 *     // like above, we register the pvnode to the children list, so it
 *     // will not be patched out of the dom.
 *     let pvnode = w4.__owl__.pvnode;
 *     c1[_2_index] = pvnode;
 *   });
 * }
 *
 * // we register the deferred here so the parent can coordinate its patch operation
 * // with all the children.
 * extra.promises.push(def3);
 * return vn1;
 * ```
 */
QWeb.addDirective({
    name: "component",
    extraNames: ["props"],
    priority: 100,
    atNodeEncounter({ ctx, value, node, qweb }) {
        ctx.addLine(`// Component '${value}'`);
        ctx.rootContext.shouldDefineQWeb = true;
        ctx.rootContext.shouldDefineParent = true;
        ctx.rootContext.shouldDefineUtils = true;
        ctx.rootContext.shouldDefineScope = true;
        let hasDynamicProps = node.getAttribute("t-props") ? true : false;
        // t-on- events and t-transition
        const events = [];
        let transition = "";
        const attributes = node.attributes;
        const props = {};
        for (let i = 0; i < attributes.length; i++) {
            const name = attributes[i].name;
            const value = attributes[i].textContent;
            if (name.startsWith("t-on-")) {
                events.push([name, value]);
            }
            else if (name === "t-transition") {
                transition = value;
            }
            else if (!name.startsWith("t-")) {
                if (name !== "class" && name !== "style") {
                    // this is a prop!
                    props[name] = ctx.formatExpression(value) || "undefined";
                }
            }
        }
        // computing the props string representing the props object
        let propStr = Object.keys(props)
            .map(k => k + ":" + props[k])
            .join(",");
        let componentID = ctx.generateID();
        const templateKey = ctx.generateTemplateKey();
        let ref = node.getAttribute("t-ref");
        let refExpr = "";
        let refKey = "";
        if (ref) {
            ctx.rootContext.shouldDefineRefs = true;
            refKey = `ref${ctx.generateID()}`;
            ctx.addLine(`const ${refKey} = ${ctx.interpolate(ref)};`);
            refExpr = `context.__owl__.refs[${refKey}] = w${componentID};`;
        }
        let finalizeComponentCode = `w${componentID}.destroy();`;
        if (ref) {
            finalizeComponentCode += `delete context.__owl__.refs[${refKey}];`;
        }
        if (transition) {
            finalizeComponentCode = `let finalize = () => {
          ${finalizeComponentCode}
        };
        delete w${componentID}.__owl__.transitionInserted;
        utils.transitionRemove(vn, '${transition}', finalize);`;
        }
        let createHook = "";
        let classAttr = node.getAttribute("class");
        let tattClass = node.getAttribute("t-att-class");
        let styleAttr = node.getAttribute("style");
        let tattStyle = node.getAttribute("t-att-style");
        if (tattStyle) {
            const attVar = `_${ctx.generateID()}`;
            ctx.addLine(`const ${attVar} = ${ctx.formatExpression(tattStyle)};`);
            tattStyle = attVar;
        }
        let classObj = "";
        if (classAttr || tattClass || styleAttr || tattStyle || events.length) {
            if (classAttr) {
                let classDef = classAttr
                    .trim()
                    .split(/\s+/)
                    .map(a => `'${a}':true`)
                    .join(",");
                classObj = `_${ctx.generateID()}`;
                ctx.addLine(`let ${classObj} = {${classDef}};`);
            }
            if (tattClass) {
                let tattExpr = ctx.formatExpression(tattClass);
                if (tattExpr[0] !== "{" || tattExpr[tattExpr.length - 1] !== "}") {
                    tattExpr = `utils.toObj(${tattExpr})`;
                }
                if (classAttr) {
                    ctx.addLine(`Object.assign(${classObj}, ${tattExpr})`);
                }
                else {
                    classObj = `_${ctx.generateID()}`;
                    ctx.addLine(`let ${classObj} = ${tattExpr};`);
                }
            }
            let eventsCode = events
                .map(function ([name, value]) {
                const capture = name.match(/\.capture/);
                name = capture ? name.replace(/\.capture/, "") : name;
                const { event, handler } = makeHandlerCode(ctx, name, value, false, T_COMPONENT_MODS_CODE);
                if (capture) {
                    return `vn.elm.addEventListener('${event}', ${handler}, true);`;
                }
                return `vn.elm.addEventListener('${event}', ${handler});`;
            })
                .join("");
            const styleExpr = tattStyle || (styleAttr ? `'${styleAttr}'` : false);
            const styleCode = styleExpr ? `vn.elm.style = ${styleExpr};` : "";
            createHook = `utils.assignHooks(vnode.data, {create(_, vn){${styleCode}${eventsCode}}});`;
        }
        ctx.addLine(`let w${componentID} = ${templateKey} in parent.__owl__.cmap ? parent.__owl__.children[parent.__owl__.cmap[${templateKey}]] : false;`);
        let shouldProxy = !ctx.parentNode;
        if (shouldProxy) {
            let id = ctx.generateID();
            ctx.rootContext.rootNode = id;
            shouldProxy = true;
            ctx.rootContext.shouldDefineResult = true;
            ctx.addLine(`let vn${id} = {};`);
            ctx.addLine(`result = vn${id};`);
        }
        if (hasDynamicProps) {
            const dynamicProp = ctx.formatExpression(node.getAttribute("t-props"));
            ctx.addLine(`let props${componentID} = Object.assign({${propStr}}, ${dynamicProp});`);
        }
        else {
            ctx.addLine(`let props${componentID} = {${propStr}};`);
        }
        ctx.addIf(`w${componentID} && w${componentID}.__owl__.currentFiber && !w${componentID}.__owl__.vnode`);
        ctx.addLine(`w${componentID}.destroy();`);
        ctx.addLine(`w${componentID} = false;`);
        ctx.closeIf();
        let registerCode = "";
        if (shouldProxy) {
            registerCode = `utils.defineProxy(vn${ctx.rootNode}, pvnode);`;
        }
        // SLOTS
        const hasSlots = node.childNodes.length;
        let scope = hasSlots ? `Object.assign(Object.create(context), scope)` : "undefined";
        ctx.addIf(`w${componentID}`);
        // need to update component
        let styleCode = "";
        if (tattStyle) {
            styleCode = `.then(()=>{if (w${componentID}.__owl__.isDestroyed) {return};w${componentID}.el.style=${tattStyle};});`;
        }
        ctx.addLine(`w${componentID}.__updateProps(props${componentID}, extra.fiber, ${scope})${styleCode};`);
        ctx.addLine(`let pvnode = w${componentID}.__owl__.pvnode;`);
        if (registerCode) {
            ctx.addLine(registerCode);
        }
        if (ctx.parentNode) {
            ctx.addLine(`c${ctx.parentNode}.push(pvnode);`);
        }
        ctx.addElse();
        // new component
        let dynamicFallback = "";
        if (!value.match(INTERP_REGEXP)) {
            dynamicFallback = `|| ${ctx.formatExpression(value)}`;
        }
        const interpValue = ctx.interpolate(value);
        ctx.addLine(`let componentKey${componentID} = ${interpValue};`);
        ctx.addLine(`let W${componentID} = context.constructor.components[componentKey${componentID}] || QWeb.components[componentKey${componentID}]${dynamicFallback};`);
        // maybe only do this in dev mode...
        ctx.addLine(`if (!W${componentID}) {throw new Error('Cannot find the definition of component "' + componentKey${componentID} + '"')}`);
        ctx.addLine(`w${componentID} = new W${componentID}(parent, props${componentID});`);
        if (transition) {
            ctx.addLine(`const __patch${componentID} = w${componentID}.__patch;`);
            ctx.addLine(`w${componentID}.__patch = (t, vn) => {__patch${componentID}.call(w${componentID}, t, vn); if(!w${componentID}.__owl__.transitionInserted){w${componentID}.__owl__.transitionInserted = true;utils.transitionInsert(w${componentID}.__owl__.vnode, '${transition}');}};`);
        }
        ctx.addLine(`parent.__owl__.cmap[${templateKey}] = w${componentID}.__owl__.id;`);
        if (hasSlots) {
            const clone = node.cloneNode(true);
            const slotNodes = Array.from(clone.querySelectorAll("[t-set-slot]"));
            // The next code is a fallback for compatibility reason. It accepts t-set
            // elements that are direct children with a non empty body as nodes defining
            // the content of a slot.
            //
            // This is wrong, but is necessary to prevent breaking all existing Owl
            // code using slots. This will be removed in v2.0 someday. Meanwhile,
            // please use t-set-slot everywhere you need to set the content of a
            // slot.
            for (let el of clone.children) {
                if (el.getAttribute("t-set") && el.hasChildNodes()) {
                    slotNodes.push(el);
                }
            }
            const slotId = QWeb.nextSlotId++;
            ctx.addLine(`w${componentID}.__owl__.slotId = ${slotId};`);
            if (slotNodes.length) {
                for (let i = 0, length = slotNodes.length; i < length; i++) {
                    const slotNode = slotNodes[i];
                    slotNode.parentElement.removeChild(slotNode);
                    let key = slotNode.getAttribute("t-set-slot");
                    slotNode.removeAttribute("t-set-slot");
                    // here again, this code should be removed when we stop supporting
                    // using t-set to define the content of named slots.
                    if (!key) {
                        key = slotNode.getAttribute("t-set");
                        slotNode.removeAttribute("t-set");
                    }
                    const slotFn = qweb._compile(`slot_${key}_template`, slotNode, ctx);
                    QWeb.slots[`${slotId}_${key}`] = slotFn;
                }
            }
            if (clone.childNodes.length) {
                const t = clone.ownerDocument.createElement("t");
                for (let child of Object.values(clone.childNodes)) {
                    t.appendChild(child);
                }
                const slotFn = qweb._compile(`slot_default_template`, t, ctx);
                QWeb.slots[`${slotId}_default`] = slotFn;
            }
        }
        ctx.addLine(`let fiber = w${componentID}.__prepare(extra.fiber, ${scope}, () => { const vnode = fiber.vnode; pvnode.sel = vnode.sel; ${createHook}});`);
        // hack: specify empty remove hook to prevent the node from being removed from the DOM
        const insertHook = refExpr ? `insert(vn) {${refExpr}},` : "";
        ctx.addLine(`let pvnode = h('dummy', {key: ${templateKey}, hook: {${insertHook}remove() {},destroy(vn) {${finalizeComponentCode}}}});`);
        if (registerCode) {
            ctx.addLine(registerCode);
        }
        if (ctx.parentNode) {
            ctx.addLine(`c${ctx.parentNode}.push(pvnode);`);
        }
        ctx.addLine(`w${componentID}.__owl__.pvnode = pvnode;`);
        ctx.closeIf();
        if (classObj) {
            ctx.addLine(`w${componentID}.__owl__.classObj=${classObj};`);
        }
        ctx.addLine(`w${componentID}.__owl__.parentLastFiberId = extra.fiber.id;`);
        return true;
    }
});

class Scheduler {
    constructor(requestAnimationFrame) {
        this.tasks = [];
        this.isRunning = false;
        this.requestAnimationFrame = requestAnimationFrame;
    }
    start() {
        this.isRunning = true;
        this.scheduleTasks();
    }
    stop() {
        this.isRunning = false;
    }
    addFiber(fiber) {
        // if the fiber was remapped into a larger rendering fiber, it may not be a
        // root fiber.  But we only want to register root fibers
        fiber = fiber.root;
        return new Promise((resolve, reject) => {
            if (fiber.error) {
                return reject(fiber.error);
            }
            this.tasks.push({
                fiber,
                callback: () => {
                    if (fiber.error) {
                        return reject(fiber.error);
                    }
                    resolve();
                }
            });
            if (!this.isRunning) {
                this.start();
            }
        });
    }
    rejectFiber(fiber, reason) {
        fiber = fiber.root;
        const index = this.tasks.findIndex(t => t.fiber === fiber);
        if (index >= 0) {
            const [task] = this.tasks.splice(index, 1);
            fiber.cancel();
            fiber.error = new Error(reason);
            task.callback();
        }
    }
    /**
     * Process all current tasks. This only applies to the fibers that are ready.
     * Other tasks are left unchanged.
     */
    flush() {
        let tasks = this.tasks;
        this.tasks = [];
        tasks = tasks.filter(task => {
            if (task.fiber.isCompleted) {
                task.callback();
                return false;
            }
            if (task.fiber.counter === 0) {
                if (!task.fiber.error) {
                    try {
                        task.fiber.complete();
                    }
                    catch (e) {
                        task.fiber.handleError(e);
                    }
                }
                task.callback();
                return false;
            }
            return true;
        });
        this.tasks = tasks.concat(this.tasks);
        if (this.tasks.length === 0) {
            this.stop();
        }
    }
    scheduleTasks() {
        this.requestAnimationFrame(() => {
            this.flush();
            if (this.isRunning) {
                this.scheduleTasks();
            }
        });
    }
}
const scheduler = new Scheduler(browser.requestAnimationFrame);

/**
 * Owl Fiber Class
 *
 * Fibers are small abstractions designed to contain all the internal state
 * associated with a "rendering work unit", relative to a specific component.
 *
 * A rendering will cause the creation of a fiber for each impacted components.
 *
 * Fibers capture all that necessary information, which is critical to owl
 * asynchronous rendering pipeline. Fibers can be cancelled, can be in different
 * states and in general determine the state of the rendering.
 */
class Fiber {
    constructor(parent, component, force, target, position) {
        this.id = Fiber.nextId++;
        // isCompleted means that the rendering corresponding to this fiber's work is
        // done, either because the component has been mounted or patched, or because
        // fiber has been cancelled.
        this.isCompleted = false;
        // the fibers corresponding to component updates (updateProps) need to call
        // the willPatch and patched hooks from the corresponding component. However,
        // fibers corresponding to a new component do not need to do that. So, the
        // shouldPatch hook is the boolean that we check whenever we need to apply
        // a patch.
        this.shouldPatch = true;
        // isRendered is the last state of a fiber. If true, this means that it has
        // been rendered and is inert (so, it should not be taken into account when
        // counting the number of active fibers).
        this.isRendered = false;
        // the counter number is a critical information. It is only necessary for a
        // root fiber.  For that fiber, this number counts the number of active sub
        // fibers.  When that number reaches 0, the fiber can be applied by the
        // scheduler.
        this.counter = 0;
        this.vnode = null;
        this.child = null;
        this.sibling = null;
        this.lastChild = null;
        this.parent = null;
        this.component = component;
        this.force = force;
        this.target = target;
        this.position = position;
        const __owl__ = component.__owl__;
        this.scope = __owl__.scope;
        this.root = parent ? parent.root : this;
        this.parent = parent;
        let oldFiber = __owl__.currentFiber;
        if (oldFiber && !oldFiber.isCompleted) {
            if (oldFiber.root === oldFiber && !parent) {
                // both oldFiber and this fiber are root fibers
                this._reuseFiber(oldFiber);
                return oldFiber;
            }
            else {
                this._remapFiber(oldFiber);
            }
        }
        this.root.counter++;
        __owl__.currentFiber = this;
    }
    /**
     * When the oldFiber is not completed yet, and both oldFiber and this fiber
     * are root fibers, we want to reuse the oldFiber instead of creating a new
     * one. Doing so will guarantee that the initiator(s) of those renderings will
     * be notified (the promise will resolve) when the last rendering will be done.
     *
     * This function thus assumes that oldFiber is a root fiber.
     */
    _reuseFiber(oldFiber) {
        oldFiber.cancel(); // cancel children fibers
        oldFiber.isCompleted = false; // keep the root fiber alive
        oldFiber.isRendered = false; // the fiber has to be re-rendered
        if (oldFiber.child) {
            // remove relation to children
            oldFiber.child.parent = null;
            oldFiber.child = null;
            oldFiber.lastChild = null;
        }
        oldFiber.counter = 1; // re-initialize counter
        oldFiber.id = Fiber.nextId++;
    }
    /**
     * In some cases, a rendering initiated at some component can detect that it
     * should be part of a larger rendering initiated somewhere up the component
     * tree.  In that case, it needs to cancel the previous rendering and
     * remap itself as a part of the current parent rendering.
     */
    _remapFiber(oldFiber) {
        oldFiber.cancel();
        this.shouldPatch = oldFiber.shouldPatch;
        if (oldFiber === oldFiber.root) {
            oldFiber.counter++;
        }
        if (oldFiber.parent && !this.parent) {
            // re-map links
            this.parent = oldFiber.parent;
            this.root = this.parent.root;
            this.sibling = oldFiber.sibling;
            if (this.parent.lastChild === oldFiber) {
                this.parent.lastChild = this;
            }
            if (this.parent.child === oldFiber) {
                this.parent.child = this;
            }
            else {
                let current = this.parent.child;
                while (true) {
                    if (current.sibling === oldFiber) {
                        current.sibling = this;
                        break;
                    }
                    current = current.sibling;
                }
            }
        }
    }
    /**
     * This function has been taken from
     * https://medium.com/react-in-depth/the-how-and-why-on-reacts-usage-of-linked-list-in-fiber-67f1014d0eb7
     */
    _walk(doWork) {
        let root = this;
        let current = this;
        while (true) {
            const child = doWork(current);
            if (child) {
                current = child;
                continue;
            }
            if (current === root) {
                return;
            }
            while (!current.sibling) {
                if (!current.parent || current.parent === root) {
                    return;
                }
                current = current.parent;
            }
            current = current.sibling;
        }
    }
    /**
     * Successfully complete the work of the fiber: call the mount or patch hooks
     * and patch the DOM. This function is called once the fiber and its children
     * are ready, and the scheduler decides to process it.
     */
    complete() {
        let component = this.component;
        this.isCompleted = true;
        if (!this.target && !component.__owl__.isMounted) {
            return;
        }
        // build patchQueue
        const patchQueue = [];
        const doWork = function (f) {
            patchQueue.push(f);
            return f.child;
        };
        this._walk(doWork);
        const patchLen = patchQueue.length;
        // call willPatch hook on each fiber of patchQueue
        for (let i = 0; i < patchLen; i++) {
            const fiber = patchQueue[i];
            if (fiber.shouldPatch) {
                component = fiber.component;
                if (component.__owl__.willPatchCB) {
                    component.__owl__.willPatchCB();
                }
                component.willPatch();
            }
        }
        // call __patch on each fiber of (reversed) patchQueue
        for (let i = patchLen - 1; i >= 0; i--) {
            const fiber = patchQueue[i];
            component = fiber.component;
            if (fiber.target && i === 0) {
                let target;
                if (fiber.position === "self") {
                    target = fiber.target;
                    if (target.tagName.toLowerCase() !== fiber.vnode.sel) {
                        throw new Error(`Cannot attach '${component.constructor.name}' to target node (not same tag name)`);
                    }
                    // In self mode, we *know* we are to take possession of the target
                    // Hence we manually create the corresponding VNode and copy the "key" in data
                    const selfVnodeData = fiber.vnode.data ? { key: fiber.vnode.data.key } : {};
                    const selfVnode = h(fiber.vnode.sel, selfVnodeData);
                    selfVnode.elm = target;
                    target = selfVnode;
                }
                else {
                    target = component.__owl__.vnode || document.createElement(fiber.vnode.sel);
                }
                component.__patch(target, fiber.vnode);
            }
            else {
                if (fiber.shouldPatch) {
                    component.__patch(component.__owl__.vnode, fiber.vnode);
                }
                else {
                    component.__patch(document.createElement(fiber.vnode.sel), fiber.vnode);
                    component.__owl__.pvnode.elm = component.__owl__.vnode.elm;
                }
            }
            component.__owl__.currentFiber = null;
        }
        // insert into the DOM (mount case)
        let inDOM = false;
        if (this.target) {
            switch (this.position) {
                case "first-child":
                    this.target.prepend(this.component.el);
                    break;
                case "last-child":
                    this.target.appendChild(this.component.el);
                    break;
            }
            inDOM = document.body.contains(this.component.el);
            this.component.env.qweb.trigger("dom-appended");
        }
        // call patched/mounted hook on each fiber of (reversed) patchQueue
        for (let i = patchLen - 1; i >= 0; i--) {
            const fiber = patchQueue[i];
            component = fiber.component;
            if (fiber.shouldPatch && !this.target) {
                component.patched();
                if (component.__owl__.patchedCB) {
                    component.__owl__.patchedCB();
                }
            }
            else if (this.target ? inDOM : true) {
                component.__callMounted();
            }
        }
    }
    /**
     * Cancel a fiber and all its children.
     */
    cancel() {
        this._walk(f => {
            if (!f.isRendered) {
                f.root.counter--;
            }
            f.isCompleted = true;
            return f.child;
        });
    }
    /**
     * This is the global error handler for errors occurring in Owl main lifecycle
     * methods.  Caught errors are triggered on the QWeb instance, and are
     * potentially given to some parent component which implements `catchError`.
     *
     * If there are no such component, we destroy everything. This is better than
     * being in a corrupted state.
     */
    handleError(error) {
        let component = this.component;
        this.vnode = component.__owl__.vnode || h("div");
        const qweb = component.env.qweb;
        let root = component;
        let canCatch = false;
        while (component && !(canCatch = !!component.catchError)) {
            root = component;
            component = component.__owl__.parent;
        }
        qweb.trigger("error", error);
        if (canCatch) {
            component.catchError(error);
        }
        else {
            // the 3 next lines aim to mark the root fiber as being in error, and
            // to force it to end, without waiting for its children
            this.root.counter = 0;
            this.root.error = error;
            scheduler.flush();
            root.destroy();
        }
    }
}
Fiber.nextId = 1;

//------------------------------------------------------------------------------
// Prop validation helper
//------------------------------------------------------------------------------
/**
 * Validate the component props (or next props) against the (static) props
 * description.  This is potentially an expensive operation: it may needs to
 * visit recursively the props and all the children to check if they are valid.
 * This is why it is only done in 'dev' mode.
 */
QWeb.utils.validateProps = function (Widget, props) {
    const propsDef = Widget.props;
    if (propsDef instanceof Array) {
        // list of strings (prop names)
        for (let i = 0, l = propsDef.length; i < l; i++) {
            const propName = propsDef[i];
            if (propName[propName.length - 1] === "?") {
                // optional prop
                break;
            }
            if (!(propName in props)) {
                throw new Error(`Missing props '${propsDef[i]}' (component '${Widget.name}')`);
            }
        }
        for (let key in props) {
            if (!propsDef.includes(key) && !propsDef.includes(key + "?")) {
                throw new Error(`Unknown prop '${key}' given to component '${Widget.name}'`);
            }
        }
    }
    else if (propsDef) {
        // propsDef is an object now
        for (let propName in propsDef) {
            if (props[propName] === undefined) {
                if (propsDef[propName] && !propsDef[propName].optional) {
                    throw new Error(`Missing props '${propName}' (component '${Widget.name}')`);
                }
                else {
                    break;
                }
            }
            let isValid;
            try {
                isValid = isValidProp(props[propName], propsDef[propName]);
            }
            catch (e) {
                e.message = `Invalid prop '${propName}' in component ${Widget.name} (${e.message})`;
                throw e;
            }
            if (!isValid) {
                throw new Error(`Invalid Prop '${propName}' in component '${Widget.name}'`);
            }
        }
        for (let propName in props) {
            if (!(propName in propsDef)) {
                throw new Error(`Unknown prop '${propName}' given to component '${Widget.name}'`);
            }
        }
    }
};
/**
 * Check if an invidual prop value matches its (static) prop definition
 */
function isValidProp(prop, propDef) {
    if (propDef === true) {
        return true;
    }
    if (typeof propDef === "function") {
        // Check if a value is constructed by some Constructor.  Note that there is a
        // slight abuse of language: we want to consider primitive values as well.
        //
        // So, even though 1 is not an instance of Number, we want to consider that
        // it is valid.
        if (typeof prop === "object") {
            return prop instanceof propDef;
        }
        return typeof prop === propDef.name.toLowerCase();
    }
    else if (propDef instanceof Array) {
        // If this code is executed, this means that we want to check if a prop
        // matches at least one of its descriptor.
        let result = false;
        for (let i = 0, iLen = propDef.length; i < iLen; i++) {
            result = result || isValidProp(prop, propDef[i]);
        }
        return result;
    }
    // propsDef is an object
    if (propDef.optional && prop === undefined) {
        return true;
    }
    let result = propDef.type ? isValidProp(prop, propDef.type) : true;
    if (propDef.validate) {
        result = result && propDef.validate(prop);
    }
    if (propDef.type === Array && propDef.element) {
        for (let i = 0, iLen = prop.length; i < iLen; i++) {
            result = result && isValidProp(prop[i], propDef.element);
        }
    }
    if (propDef.type === Object && propDef.shape) {
        const shape = propDef.shape;
        for (let key in shape) {
            result = result && isValidProp(prop[key], shape[key]);
        }
        if (result) {
            for (let propName in prop) {
                if (!(propName in shape)) {
                    throw new Error(`unknown prop '${propName}'`);
                }
            }
        }
    }
    return result;
}

/**
 * Owl Style System
 *
 * This files contains the Owl code related to processing (extended) css strings
 * and creating/adding <style> tags to the document head.
 */
const STYLESHEETS = {};
function processSheet(str) {
    const tokens = str.split(/(\{|\}|;)/).map(s => s.trim());
    const selectorStack = [];
    const parts = [];
    let rules = [];
    function generateSelector(stackIndex, parentSelector) {
        const parts = [];
        for (const selector of selectorStack[stackIndex]) {
            let part = (parentSelector && parentSelector + " " + selector) || selector;
            if (part.includes("&")) {
                part = selector.replace(/&/g, parentSelector || "");
            }
            if (stackIndex < selectorStack.length - 1) {
                part = generateSelector(stackIndex + 1, part);
            }
            parts.push(part);
        }
        return parts.join(", ");
    }
    function generateRules() {
        if (rules.length) {
            parts.push(generateSelector(0) + " {");
            parts.push(...rules);
            parts.push("}");
            rules = [];
        }
    }
    while (tokens.length) {
        let token = tokens.shift();
        if (token === "}") {
            generateRules();
            selectorStack.pop();
        }
        else {
            if (tokens[0] === "{") {
                generateRules();
                selectorStack.push(token.split(/\s*,\s*/));
                tokens.shift();
            }
            if (tokens[0] === ";") {
                rules.push("  " + token + ";");
            }
        }
    }
    return parts.join("\n");
}
function registerSheet(id, css) {
    const sheet = document.createElement("style");
    sheet.innerHTML = processSheet(css);
    STYLESHEETS[id] = sheet;
}
function activateSheet(id, name) {
    const sheet = STYLESHEETS[id];
    if (!sheet) {
        throw new Error(`Invalid css stylesheet for component '${name}'. Did you forget to use the 'css' tag helper?`);
    }
    sheet.setAttribute("component", name);
    document.head.appendChild(sheet);
}

const portalSymbol = Symbol("portal"); // FIXME
//------------------------------------------------------------------------------
// Component
//------------------------------------------------------------------------------
let nextId = 1;
class Component {
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Creates an instance of Component.
     *
     * Note that most of the time, only the root component needs to be created by
     * hand.  Other components should be created automatically by the framework (with
     * the t-component directive in a template)
     */
    constructor(parent, props) {
        Component.current = this;
        let constr = this.constructor;
        const defaultProps = constr.defaultProps;
        if (defaultProps) {
            props = props || {};
            this.__applyDefaultProps(props, defaultProps);
        }
        this.props = props;
        if (QWeb.dev) {
            QWeb.utils.validateProps(constr, this.props);
        }
        const id = nextId++;
        let depth;
        if (parent) {
            this.env = parent.env;
            const __powl__ = parent.__owl__;
            __powl__.children[id] = this;
            depth = __powl__.depth + 1;
        }
        else {
            // we are the root component
            this.env = this.constructor.env;
            if (!this.env.qweb) {
                this.env.qweb = new QWeb();
            }
            if (!this.env.browser) {
                this.env.browser = browser;
            }
            this.env.qweb.on("update", this, () => {
                if (this.__owl__.isMounted) {
                    this.render(true);
                }
                if (this.__owl__.isDestroyed) {
                    // this is unlikely to happen, but if a root widget is destroyed,
                    // we want to remove our subscription.  The usual way to do that
                    // would be to perform some check in the destroy method, but since
                    // it is very performance sensitive, and since this is a rare event,
                    // we simply do it lazily
                    this.env.qweb.off("update", this);
                }
            });
            depth = 0;
        }
        const qweb = this.env.qweb;
        const template = constr.template || this.__getTemplate(qweb);
        this.__owl__ = {
            id: id,
            depth: depth,
            vnode: null,
            pvnode: null,
            isMounted: false,
            isDestroyed: false,
            parent: parent || null,
            children: {},
            cmap: {},
            currentFiber: null,
            parentLastFiberId: 0,
            boundHandlers: {},
            mountedCB: null,
            willUnmountCB: null,
            willPatchCB: null,
            patchedCB: null,
            willStartCB: null,
            willUpdatePropsCB: null,
            observer: null,
            renderFn: qweb.render.bind(qweb, template),
            classObj: null,
            refs: null,
            scope: null
        };
        if (constr.style) {
            this.__applyStyles(constr);
        }
    }
    /**
     * The `el` is the root element of the component.  Note that it could be null:
     * this is the case if the component is not mounted yet, or is destroyed.
     */
    get el() {
        return this.__owl__.vnode ? this.__owl__.vnode.elm : null;
    }
    /**
     * willStart is an asynchronous hook that can be implemented to perform some
     * action before the initial rendering of a component.
     *
     * It will be called exactly once before the initial rendering. It is useful
     * in some cases, for example, to load external assets (such as a JS library)
     * before the component is rendered.
     *
     * Note that a slow willStart method will slow down the rendering of the user
     * interface.  Therefore, some effort should be made to make this method as
     * fast as possible.
     *
     * Note: this method should not be called manually.
     */
    async willStart() { }
    /**
     * mounted is a hook that is called each time a component is attached to the
     * DOM. This is a good place to add some listeners, or to interact with the
     * DOM, if the component needs to perform some measure for example.
     *
     * Note: this method should not be called manually.
     *
     * @see willUnmount
     */
    mounted() { }
    /**
     * The willUpdateProps is an asynchronous hook, called just before new props
     * are set. This is useful if the component needs some asynchronous task
     * performed, depending on the props (for example, assuming that the props are
     * some record Id, fetching the record data).
     *
     * This hook is not called during the first render (but willStart is called
     * and performs a similar job).
     */
    async willUpdateProps(nextProps) { }
    /**
     * The willPatch hook is called just before the DOM patching process starts.
     * It is not called on the initial render.  This is useful to get some
     * information which are in the DOM.  For example, the current position of the
     * scrollbar
     */
    willPatch() { }
    /**
     * This hook is called whenever a component did actually update its props,
     * state or env.
     *
     * This method is not called on the initial render. It is useful to interact
     * with the DOM (for example, through an external library) whenever the
     * component was updated.
     *
     * Updating the component state in this hook is possible, but not encouraged.
     * One need to be careful, because updates here will cause rerender, which in
     * turn will cause other calls to updated. So, we need to be particularly
     * careful at avoiding endless cycles.
     */
    patched() { }
    /**
     * willUnmount is a hook that is called each time just before a component is
     * unmounted from the DOM. This is a good place to remove some listeners, for
     * example.
     *
     * Note: this method should not be called manually.
     *
     * @see mounted
     */
    willUnmount() { }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Mount the component to a target element.
     *
     * This should only be done if the component was created manually. Components
     * created declaratively in templates are managed by the Owl system.
     *
     * Note that a component can be mounted an unmounted several times
     */
    async mount(target, options = {}) {
        const position = options.position || "last-child";
        const __owl__ = this.__owl__;
        if (__owl__.isMounted) {
            if (position !== "self" && this.el.parentNode !== target) {
                // in this situation, we are trying to mount a component on a different
                // target. In this case, we need to unmount first, otherwise it will
                // not work.
                this.unmount();
            }
            else {
                return Promise.resolve();
            }
        }
        if (__owl__.currentFiber) {
            const currentFiber = __owl__.currentFiber;
            if (currentFiber.target === target && currentFiber.position === position) {
                return scheduler.addFiber(currentFiber);
            }
            else {
                scheduler.rejectFiber(currentFiber, "Mounting operation cancelled");
            }
        }
        if (!(target instanceof HTMLElement || target instanceof DocumentFragment)) {
            let message = `Component '${this.constructor.name}' cannot be mounted: the target is not a valid DOM node.`;
            message += `\nMaybe the DOM is not ready yet? (in that case, you can use owl.utils.whenReady)`;
            throw new Error(message);
        }
        const fiber = new Fiber(null, this, false, target, position);
        fiber.shouldPatch = false;
        if (!__owl__.vnode) {
            this.__prepareAndRender(fiber, () => { });
        }
        else {
            this.__render(fiber);
        }
        return scheduler.addFiber(fiber);
    }
    /**
     * The unmount method is the opposite of the mount method.  It is useful
     * to call willUnmount calls and remove the component from the DOM.
     */
    unmount() {
        if (this.__owl__.isMounted) {
            this.__callWillUnmount();
            this.el.remove();
        }
    }
    /**
     * The render method is the main entry point to render a component (once it
     * is ready. This method is not initially called when the component is
     * rendered the first time).
     *
     * This method will cause all its sub components to potentially rerender
     * themselves.  Note that `render` is not called if a component is updated via
     * its props.
     */
    async render(force = false) {
        const __owl__ = this.__owl__;
        const currentFiber = __owl__.currentFiber;
        if (!__owl__.isMounted && !currentFiber) {
            // if we get here, this means that the component was either never mounted,
            // or was unmounted and some state change  triggered a render. Either way,
            // we do not want to actually render anything in this case.
            return;
        }
        if (currentFiber && !currentFiber.isRendered && !currentFiber.isCompleted) {
            return scheduler.addFiber(currentFiber.root);
        }
        // if we aren't mounted at this point, it implies that there is a
        // currentFiber that is already rendered (isRendered is true), so we are
        // about to be mounted
        const isMounted = __owl__.isMounted;
        const fiber = new Fiber(null, this, force, null, null);
        Promise.resolve().then(() => {
            if (__owl__.isMounted || !isMounted) {
                if (fiber.isCompleted) {
                    return;
                }
                // we are mounted (__owl__.isMounted), or if we are currently being
                // mounted (!isMounted), so we call __render
                this.__render(fiber);
            }
            else {
                // we were mounted when render was called, but we aren't anymore, so we
                // were actually about to be unmounted ; we can thus forget about this
                // fiber
                fiber.isCompleted = true;
                __owl__.currentFiber = null;
            }
        });
        return scheduler.addFiber(fiber);
    }
    /**
     * Destroy the component.  This operation is quite complex:
     *  - it recursively destroy all children
     *  - call the willUnmount hooks if necessary
     *  - remove the dom node from the dom
     *
     * This should only be called manually if you created the component.  Most
     * components will be automatically destroyed.
     */
    destroy() {
        const __owl__ = this.__owl__;
        if (!__owl__.isDestroyed) {
            const el = this.el;
            this.__destroy(__owl__.parent);
            if (el) {
                el.remove();
            }
        }
    }
    /**
     * This method is called by the component system whenever its props are
     * updated. If it returns true, then the component will be rendered.
     * Otherwise, it will skip the rendering (also, its props will not be updated)
     */
    shouldUpdate(nextProps) {
        return true;
    }
    /**
     * Emit a custom event of type 'eventType' with the given 'payload' on the
     * component's el, if it exists. However, note that the event will only bubble
     * up to the parent DOM nodes. Thus, it must be called between mounted() and
     * willUnmount().
     */
    trigger(eventType, payload) {
        this.__trigger(this, eventType, payload);
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Private helper to perform a full destroy, from the point of view of an Owl
     * component. It does not remove the el (this is done only once on the top
     * level destroyed component, for performance reasons).
     *
     * The job of this method is mostly to call willUnmount hooks, and to perform
     * all necessary internal cleanup.
     *
     * Note that it does not call the __callWillUnmount method to avoid visiting
     * all children many times.
     */
    __destroy(parent) {
        const __owl__ = this.__owl__;
        const isMounted = __owl__.isMounted;
        if (isMounted) {
            if (__owl__.willUnmountCB) {
                __owl__.willUnmountCB();
            }
            this.willUnmount();
            __owl__.isMounted = false;
        }
        const children = __owl__.children;
        for (let key in children) {
            children[key].__destroy(this);
        }
        if (parent) {
            let id = __owl__.id;
            delete parent.__owl__.children[id];
            __owl__.parent = null;
        }
        __owl__.isDestroyed = true;
        delete __owl__.vnode;
        if (__owl__.currentFiber) {
            __owl__.currentFiber.isCompleted = true;
        }
    }
    __callMounted() {
        const __owl__ = this.__owl__;
        __owl__.isMounted = true;
        __owl__.currentFiber = null;
        this.mounted();
        if (__owl__.mountedCB) {
            __owl__.mountedCB();
        }
    }
    __callWillUnmount() {
        const __owl__ = this.__owl__;
        if (__owl__.willUnmountCB) {
            __owl__.willUnmountCB();
        }
        this.willUnmount();
        __owl__.isMounted = false;
        if (this.__owl__.currentFiber) {
            this.__owl__.currentFiber.isCompleted = true;
            this.__owl__.currentFiber.root.counter = 0;
        }
        const children = __owl__.children;
        for (let id in children) {
            const comp = children[id];
            if (comp.__owl__.isMounted) {
                comp.__callWillUnmount();
            }
        }
    }
    /**
     * Private trigger method, allows to choose the component which triggered
     * the event in the first place
     */
    __trigger(component, eventType, payload) {
        if (this.el) {
            const ev = new OwlEvent(component, eventType, {
                bubbles: true,
                cancelable: true,
                detail: payload
            });
            const triggerHook = this.env[portalSymbol];
            if (triggerHook) {
                triggerHook(ev);
            }
            this.el.dispatchEvent(ev);
        }
    }
    /**
     * The __updateProps method is called by the t-component directive whenever
     * it updates a component (so, when the parent template is rerendered).
     */
    async __updateProps(nextProps, parentFiber, scope) {
        this.__owl__.scope = scope;
        const shouldUpdate = parentFiber.force || this.shouldUpdate(nextProps);
        if (shouldUpdate) {
            const __owl__ = this.__owl__;
            const fiber = new Fiber(parentFiber, this, parentFiber.force, null, null);
            if (!parentFiber.child) {
                parentFiber.child = fiber;
            }
            else {
                parentFiber.lastChild.sibling = fiber;
            }
            parentFiber.lastChild = fiber;
            const defaultProps = this.constructor.defaultProps;
            if (defaultProps) {
                this.__applyDefaultProps(nextProps, defaultProps);
            }
            if (QWeb.dev) {
                QWeb.utils.validateProps(this.constructor, nextProps);
            }
            await Promise.all([
                this.willUpdateProps(nextProps),
                __owl__.willUpdatePropsCB && __owl__.willUpdatePropsCB(nextProps)
            ]);
            if (fiber.isCompleted) {
                return;
            }
            this.props = nextProps;
            this.__render(fiber);
        }
    }
    /**
     * Main patching method. We call the virtual dom patch method here to convert
     * a virtual dom vnode into some actual dom.
     */
    __patch(target, vnode) {
        this.__owl__.vnode = patch(target, vnode);
    }
    /**
     * The __prepare method is only called by the t-component directive, when a
     * subcomponent is created. It gets its scope, if any, from the
     * parent template.
     */
    __prepare(parentFiber, scope, cb) {
        this.__owl__.scope = scope;
        const fiber = new Fiber(parentFiber, this, parentFiber.force, null, null);
        fiber.shouldPatch = false;
        if (!parentFiber.child) {
            parentFiber.child = fiber;
        }
        else {
            parentFiber.lastChild.sibling = fiber;
        }
        parentFiber.lastChild = fiber;
        this.__prepareAndRender(fiber, cb);
        return fiber;
    }
    /**
     * Apply the stylesheets defined by the component. Note that we need to make
     * sure all inherited stylesheets are applied as well.  We then delete the
     * `style` key from the constructor to make sure we do not apply it again.
     */
    __applyStyles(constr) {
        while (constr && constr.style) {
            if (constr.hasOwnProperty("style")) {
                activateSheet(constr.style, constr.name);
                delete constr.style;
            }
            constr = constr.__proto__;
        }
    }
    __getTemplate(qweb) {
        let p = this.constructor;
        if (!p.hasOwnProperty("_template")) {
            // here, the component and none of its superclasses defines a static `template`
            // key. So we fall back on looking for a template matching its name (or
            // one of its subclass).
            let template = p.name;
            while (!(template in qweb.templates) && p !== Component) {
                p = p.__proto__;
                template = p.name;
            }
            if (p === Component) {
                throw new Error(`Could not find template for component "${this.constructor.name}"`);
            }
            else {
                p._template = template;
            }
        }
        return p._template;
    }
    async __prepareAndRender(fiber, cb) {
        try {
            await Promise.all([this.willStart(), this.__owl__.willStartCB && this.__owl__.willStartCB()]);
        }
        catch (e) {
            fiber.handleError(e);
            return Promise.resolve();
        }
        if (this.__owl__.isDestroyed) {
            return Promise.resolve();
        }
        if (!fiber.isCompleted) {
            this.__render(fiber);
            cb();
        }
    }
    __render(fiber) {
        const __owl__ = this.__owl__;
        if (__owl__.observer) {
            __owl__.observer.allowMutations = false;
        }
        let error;
        try {
            let vnode = __owl__.renderFn(this, {
                handlers: __owl__.boundHandlers,
                fiber: fiber
            });
            // we iterate over the children to detect those that no longer belong to the
            // current rendering: those ones, if not mounted yet, can (and have to) be
            // destroyed right now, because they are not in the DOM, and thus we won't
            // be notified later on (when patching), that they are removed from the DOM
            for (let childKey in __owl__.children) {
                let child = __owl__.children[childKey];
                if (!child.__owl__.isMounted && child.__owl__.parentLastFiberId < fiber.id) {
                    child.destroy();
                }
            }
            if (!vnode) {
                throw new Error(`Rendering '${this.constructor.name}' did not return anything`);
            }
            fiber.vnode = vnode;
            // we apply here the class information described on the component by the
            // template (so, something like <MyComponent class="..."/>) to the actual
            // root vnode
            if (__owl__.classObj) {
                const data = vnode.data;
                data.class = Object.assign(data.class || {}, __owl__.classObj);
            }
        }
        catch (e) {
            error = e;
        }
        if (__owl__.observer) {
            __owl__.observer.allowMutations = true;
        }
        fiber.root.counter--;
        fiber.isRendered = true;
        if (error) {
            fiber.handleError(error);
        }
    }
    /**
     * Only called by qweb t-component directive (when t-keepalive is set)
     */
    __remount() {
        const __owl__ = this.__owl__;
        if (!__owl__.isMounted) {
            __owl__.isMounted = true;
            this.mounted();
        }
    }
    /**
     * Apply default props (only top level).
     *
     * Note that this method does modify in place the props
     */
    __applyDefaultProps(props, defaultProps) {
        for (let propName in defaultProps) {
            if (props[propName] === undefined) {
                props[propName] = defaultProps[propName];
            }
        }
    }
}
Component.template = null;
Component._template = null;
Component.current = null;
Component.components = {};
Component.env = {};
// expose scheduler s.t. it can be mocked for testing purposes
Component.scheduler = scheduler;

/**
 * The `Context` object provides a way to share data between an arbitrary number
 * of component. Usually, data is passed from a parent to its children component,
 * but when we have to deal with some mostly global information, this can be
 * annoying, since each component will need to pass the information to each
 * children, even though some or most of them will not use the information.
 *
 * With a `Context` object, each component can subscribe (with the `useContext`
 * hook) to its state, and will be updated whenever the context state is updated.
 */
function partitionBy(arr, fn) {
    let lastGroup = false;
    let lastValue;
    return arr.reduce((acc, cur) => {
        let curVal = fn(cur);
        if (lastGroup) {
            if (curVal === lastValue) {
                lastGroup.push(cur);
            }
            else {
                lastGroup = false;
            }
        }
        if (!lastGroup) {
            lastGroup = [cur];
            acc.push(lastGroup);
        }
        lastValue = curVal;
        return acc;
    }, []);
}
class Context extends EventBus {
    constructor(state = {}) {
        super();
        this.rev = 1;
        // mapping from component id to last observed context id
        this.mapping = {};
        this.observer = new Observer();
        this.observer.notifyCB = () => {
            // notify components in the next microtask tick to ensure that subscribers
            // are notified only once for all changes that occur in the same micro tick
            let rev = this.rev;
            return Promise.resolve().then(() => {
                if (rev === this.rev) {
                    this.__notifyComponents();
                }
            });
        };
        this.state = this.observer.observe(state);
        this.subscriptions.update = [];
    }
    /**
     * Instead of using trigger to emit an update event, we actually implement
     * our own function to do that.  The reason is that we need to be smarter than
     * a simple trigger function: we need to wait for parent components to be
     * done before doing children components.  More precisely, if an update
     * as an effect of destroying a children, we do not want to call any code
     * from the child, and certainly not render it.
     *
     * This method implements a simple grouping algorithm by depth. If we have
     * connected components of depths [2, 4,4,4,4, 3,8,8], the Context will notify
     * them in the following groups: [2], [4,4,4,4], [3], [8,8]. Each group will
     * be updated sequentially, but each components in a given group will be done in
     * parallel.
     *
     * This is a very simple algorithm, but it avoids checking if a given
     * component is a child of another.
     */
    async __notifyComponents() {
        const rev = ++this.rev;
        const subscriptions = this.subscriptions.update;
        const groups = partitionBy(subscriptions, s => (s.owner ? s.owner.__owl__.depth : -1));
        for (let group of groups) {
            const proms = group.map(sub => sub.callback.call(sub.owner, rev));
            // at this point, each component in the current group has registered a
            // top level fiber in the scheduler. It could happen that rendering these
            // components is done (if they have no children).  This is why we manually
            // flush the scheduler.  This will force the scheduler to check
            // immediately if they are done, which will cause their rendering
            // promise to resolve earlier, which means that there is a chance of
            // processing the next group in the same frame.
            scheduler.flush();
            await Promise.all(proms);
        }
    }
}
/**
 * The`useContext` hook is the normal way for a component to register themselve
 * to context state changes. The `useContext` method returns the context state
 */
function useContext(ctx) {
    const component = Component.current;
    return useContextWithCB(ctx, component, component.render.bind(component));
}
function useContextWithCB(ctx, component, method) {
    const __owl__ = component.__owl__;
    const id = __owl__.id;
    const mapping = ctx.mapping;
    if (id in mapping) {
        return ctx.state;
    }
    if (!__owl__.observer) {
        __owl__.observer = new Observer();
        __owl__.observer.notifyCB = component.render.bind(component);
    }
    const currentCB = __owl__.observer.notifyCB;
    __owl__.observer.notifyCB = function () {
        if (ctx.rev > mapping[id]) {
            // in this case, the context has been updated since we were rendering
            // last, and we do not need to render here with the observer. A
            // rendering is coming anyway, with the correct props.
            return;
        }
        currentCB();
    };
    mapping[id] = 0;
    const renderFn = __owl__.renderFn;
    __owl__.renderFn = function (comp, params) {
        mapping[id] = ctx.rev;
        return renderFn(comp, params);
    };
    ctx.on("update", component, async (contextRev) => {
        if (mapping[id] < contextRev) {
            mapping[id] = contextRev;
            await method();
        }
    });
    const __destroy = component.__destroy;
    component.__destroy = parent => {
        ctx.off("update", component);
        delete mapping[id];
        __destroy.call(component, parent);
    };
    return ctx.state;
}

/**
 * Owl Hook System
 *
 * This file introduces the concept of hooks, similar to React or Vue hooks.
 * We have currently an implementation of:
 * - useState (reactive state)
 * - onMounted
 * - onWillUnmount
 * - useRef
 */
// -----------------------------------------------------------------------------
// useState
// -----------------------------------------------------------------------------
/**
 * This is the main way a component can be made reactive.  The useState hook
 * will return an observed object (or array).  Changes to that value will then
 * trigger a rerendering of the current component.
 */
function useState(state) {
    const component = Component.current;
    const __owl__ = component.__owl__;
    if (!__owl__.observer) {
        __owl__.observer = new Observer();
        __owl__.observer.notifyCB = component.render.bind(component);
    }
    return __owl__.observer.observe(state);
}
// -----------------------------------------------------------------------------
// Life cycle hooks
// -----------------------------------------------------------------------------
function makeLifecycleHook(method, reverse = false) {
    if (reverse) {
        return function (cb) {
            const component = Component.current;
            if (component.__owl__[method]) {
                const current = component.__owl__[method];
                component.__owl__[method] = function () {
                    current.call(component);
                    cb.call(component);
                };
            }
            else {
                component.__owl__[method] = cb;
            }
        };
    }
    else {
        return function (cb) {
            const component = Component.current;
            if (component.__owl__[method]) {
                const current = component.__owl__[method];
                component.__owl__[method] = function () {
                    cb.call(component);
                    current.call(component);
                };
            }
            else {
                component.__owl__[method] = cb;
            }
        };
    }
}
function makeAsyncHook(method) {
    return function (cb) {
        const component = Component.current;
        if (component.__owl__[method]) {
            const current = component.__owl__[method];
            component.__owl__[method] = function (...args) {
                return Promise.all([current.call(component, ...args), cb.call(component, ...args)]);
            };
        }
        else {
            component.__owl__[method] = cb;
        }
    };
}
const onMounted = makeLifecycleHook("mountedCB", true);
const onWillUnmount = makeLifecycleHook("willUnmountCB");
const onWillPatch = makeLifecycleHook("willPatchCB");
const onPatched = makeLifecycleHook("patchedCB", true);
const onWillStart = makeAsyncHook("willStartCB");
const onWillUpdateProps = makeAsyncHook("willUpdatePropsCB");
function useRef(name) {
    const __owl__ = Component.current.__owl__;
    return {
        get el() {
            const val = __owl__.refs && __owl__.refs[name];
            if (val instanceof HTMLElement) {
                return val;
            }
            else if (val instanceof Component) {
                return val.el;
            }
            return null;
        },
        get comp() {
            const val = __owl__.refs && __owl__.refs[name];
            return val instanceof Component ? val : null;
        }
    };
}
// -----------------------------------------------------------------------------
// useSubEnv
// -----------------------------------------------------------------------------
/**
 * This hook is a simple way to let components use a sub environment.  Note that
 * like for all hooks, it is important that this is only called in the
 * constructor method.
 */
function useSubEnv(nextEnv) {
    const component = Component.current;
    component.env = Object.assign(Object.create(component.env), nextEnv);
}
// -----------------------------------------------------------------------------
// useExternalListener
// -----------------------------------------------------------------------------
/**
 * When a component needs to listen to DOM Events on element(s) that are not
 * part of his hierarchy, we can use the `useExternalListener` hook.
 * It will correctly add and remove the event listener, whenever the
 * component is mounted and unmounted.
 *
 * Example:
 *  a menu needs to listen to the click on window to be closed automatically
 *
 * Usage:
 *  in the constructor of the OWL component that needs to be notified,
 *  `useExternalListener(window, 'click', this._doSomething);`
 * */
function useExternalListener(target, eventName, handler, eventParams) {
    const boundHandler = handler.bind(Component.current);
    onMounted(() => target.addEventListener(eventName, boundHandler, eventParams));
    onWillUnmount(() => target.removeEventListener(eventName, boundHandler, eventParams));
}

var _hooks = /*#__PURE__*/Object.freeze({
    __proto__: null,
    useState: useState,
    onMounted: onMounted,
    onWillUnmount: onWillUnmount,
    onWillPatch: onWillPatch,
    onPatched: onPatched,
    onWillStart: onWillStart,
    onWillUpdateProps: onWillUpdateProps,
    useRef: useRef,
    useSubEnv: useSubEnv,
    useExternalListener: useExternalListener
});

class Store extends Context {
    constructor(config) {
        super(config.state);
        this.actions = config.actions;
        this.env = config.env;
        this.getters = {};
        this.updateFunctions = [];
        if (config.getters) {
            const firstArg = {
                state: this.state,
                getters: this.getters
            };
            for (let g in config.getters) {
                this.getters[g] = config.getters[g].bind(this, firstArg);
            }
        }
    }
    dispatch(action, ...payload) {
        if (!this.actions[action]) {
            throw new Error(`[Error] action ${action} is undefined`);
        }
        const result = this.actions[action]({
            dispatch: this.dispatch.bind(this),
            env: this.env,
            state: this.state,
            getters: this.getters
        }, ...payload);
        return result;
    }
}
const isStrictEqual = (a, b) => a === b;
function useStore(selector, options = {}) {
    const component = Component.current;
    const componentId = component.__owl__.id;
    const store = options.store || component.env.store;
    if (!(store instanceof Store)) {
        throw new Error(`No store found when connecting '${component.constructor.name}'`);
    }
    let result = selector(store.state, component.props);
    const hashFn = store.observer.revNumber.bind(store.observer);
    let revNumber = hashFn(result);
    const isEqual = options.isEqual || isStrictEqual;
    if (!store.updateFunctions[componentId]) {
        store.updateFunctions[componentId] = [];
    }
    function selectCompareUpdate(state, props) {
        const oldResult = result;
        result = selector(state, props);
        const newRevNumber = hashFn(result);
        if ((newRevNumber > 0 && revNumber !== newRevNumber) || !isEqual(oldResult, result)) {
            revNumber = newRevNumber;
            if (options.onUpdate) {
                options.onUpdate(result);
            }
            return true;
        }
        return false;
    }
    store.updateFunctions[componentId].push(function () {
        return selectCompareUpdate(store.state, component.props);
    });
    useContextWithCB(store, component, function () {
        let shouldRender = false;
        for (let fn of store.updateFunctions[componentId]) {
            shouldRender = fn() || shouldRender;
        }
        if (shouldRender) {
            return component.render();
        }
    });
    onWillUpdateProps(props => {
        selectCompareUpdate(store.state, props);
    });
    const __destroy = component.__destroy;
    component.__destroy = parent => {
        delete store.updateFunctions[componentId];
        __destroy.call(component, parent);
    };
    if (typeof result !== "object" || result === null) {
        return result;
    }
    return new Proxy(result, {
        get(target, k) {
            return result[k];
        },
        set(target, k, v) {
            throw new Error("Store state should only be modified through actions");
        },
        has(target, k) {
            return k in result;
        }
    });
}
function useDispatch(store) {
    store = store || Component.current.env.store;
    return store.dispatch.bind(store);
}
function useGetters(store) {
    store = store || Component.current.env.store;
    return store.getters;
}

/**
 * Owl Tags
 *
 * We have here a (very) small collection of tag functions:
 *
 * - xml
 *
 * The plan is to add a few other tags such as css, globalcss.
 */
/**
 * XML tag helper for defining templates.  With this, one can simply define
 * an inline template with just the template xml:
 * ```js
 *   class A extends Component {
 *     static template = xml`<div>some template</div>`;
 *   }
 * ```
 */
function xml(strings, ...args) {
    const name = `__template__${QWeb.nextId++}`;
    const value = String.raw(strings, ...args);
    QWeb.registerTemplate(name, value);
    return name;
}
/**
 * CSS tag helper for defining inline stylesheets.  With this, one can simply define
 * an inline stylesheet with just the following code:
 * ```js
 *   class A extends Component {
 *     static style = css`.component-a { color: red; }`;
 *   }
 * ```
 */
function css(strings, ...args) {
    const name = `__sheet__${QWeb.nextId++}`;
    const value = String.raw(strings, ...args);
    registerSheet(name, value);
    return name;
}

var _tags = /*#__PURE__*/Object.freeze({
    __proto__: null,
    xml: xml,
    css: css
});

/**
 * AsyncRoot
 *
 * Owl is by default asynchronous, and the user interface will wait for all its
 * subcomponents to be rendered before updating the DOM. This is most of the
 * time what we want, but in some cases, it makes sense to "detach" a component
 * from this coordination.  This is the goal of the AsyncRoot component.
 */
class AsyncRoot extends Component {
    async __updateProps(nextProps, parentFiber) {
        this.render(parentFiber.force);
    }
}
AsyncRoot.template = xml `<t t-slot="default"/>`;

class Portal extends Component {
    constructor(parent, props) {
        super(parent, props);
        // boolean to indicate whether or not we must listen to 'dom-appended' event
        // to hook on the moment when the target is inserted into the DOM (because it
        // is not when the portal is rendered)
        this.doTargetLookUp = true;
        // set of encountered events that need to be redirected
        this._handledEvents = new Set();
        // function that will be the event's tunnel (needs to be an arrow function to
        // avoid having to rebind `this`)
        this._handlerTunnel = (ev) => {
            ev.stopPropagation();
            this.__trigger(ev.originalComponent, ev.type, ev.detail);
        };
        // Storing the parent's env
        this.parentEnv = null;
        // represents the element that is moved somewhere else
        this.portal = null;
        // the target where we will move `portal`
        this.target = null;
        this.parentEnv = parent ? parent.env : {};
        // put a callback in the env that is propagated to children s.t. portal can
        // register an handler to those events just before children will trigger them
        useSubEnv({
            [portalSymbol]: ev => {
                if (!this._handledEvents.has(ev.type)) {
                    this.portal.elm.addEventListener(ev.type, this._handlerTunnel);
                    this._handledEvents.add(ev.type);
                }
            }
        });
    }
    /**
     * Override to revert back to a classic Component's structure
     *
     * @override
     */
    __callWillUnmount() {
        super.__callWillUnmount();
        this.el.appendChild(this.portal.elm);
        this.doTargetLookUp = true;
    }
    /**
     * At each DOM change, we must ensure that the portal contains exactly one
     * child
     */
    __checkVNodeStructure(vnode) {
        const children = vnode.children;
        let countRealNodes = 0;
        for (let child of children) {
            if (child.sel) {
                countRealNodes++;
            }
        }
        if (countRealNodes !== 1) {
            throw new Error(`Portal must have exactly one non-text child (has ${countRealNodes})`);
        }
    }
    /**
     * Ensure the target is still there at whichever time we render
     */
    __checkTargetPresence() {
        if (!this.target || !document.contains(this.target)) {
            throw new Error(`Could not find any match for "${this.props.target}"`);
        }
    }
    /**
     * Move the portal's element to the target
     */
    __deployPortal() {
        this.__checkTargetPresence();
        this.target.appendChild(this.portal.elm);
    }
    /**
     * Override to remove from the DOM the element we have teleported
     *
     * @override
     */
    __destroy(parent) {
        if (this.portal && this.portal.elm) {
            const displacedElm = this.portal.elm;
            const parent = displacedElm.parentNode;
            if (parent) {
                parent.removeChild(displacedElm);
            }
        }
        super.__destroy(parent);
    }
    /**
     * Override to patch the element that has been teleported
     *
     * @override
     */
    __patch(target, vnode) {
        if (this.doTargetLookUp) {
            const target = document.querySelector(this.props.target);
            if (!target) {
                this.env.qweb.on("dom-appended", this, () => {
                    this.doTargetLookUp = false;
                    this.env.qweb.off("dom-appended", this);
                    this.target = document.querySelector(this.props.target);
                    this.__deployPortal();
                });
            }
            else {
                this.doTargetLookUp = false;
                this.target = target;
            }
        }
        this.__checkVNodeStructure(vnode);
        const shouldDeploy = (!this.portal || this.el.contains(this.portal.elm)) && !this.doTargetLookUp;
        if (!this.doTargetLookUp && !shouldDeploy) {
            // Only on pure patching, provided the
            // this.target's parent has not been unmounted
            this.__checkTargetPresence();
        }
        const portalPatch = this.portal ? this.portal : document.createElement(vnode.children[0].sel);
        this.portal = patch(portalPatch, vnode.children[0]);
        vnode.children = [];
        super.__patch(target, vnode);
        if (shouldDeploy) {
            this.__deployPortal();
        }
    }
    /**
     * Override to set the env
     */
    __trigger(component, eventType, payload) {
        const env = this.env;
        this.env = this.parentEnv;
        super.__trigger(component, eventType, payload);
        this.env = env;
    }
}
Portal.template = xml `<portal><t t-slot="default"/></portal>`;
Portal.props = {
    target: {
        type: String
    }
};

class Link extends Component {
    constructor() {
        super(...arguments);
        this.href = this.env.router.destToPath(this.props);
    }
    async willUpdateProps(nextProps) {
        this.href = this.env.router.destToPath(nextProps);
    }
    get isActive() {
        if (this.env.router.mode === "hash") {
            return document.location.hash === this.href;
        }
        return document.location.pathname === this.href;
    }
    navigate(ev) {
        // don't redirect with control keys
        if (ev.metaKey || ev.altKey || ev.ctrlKey || ev.shiftKey) {
            return;
        }
        // don't redirect on right click
        if (ev.button !== undefined && ev.button !== 0) {
            return;
        }
        // don't redirect if `target="_blank"`
        if (ev.currentTarget && ev.currentTarget.getAttribute) {
            const target = ev.currentTarget.getAttribute("target");
            if (/\b_blank\b/i.test(target)) {
                return;
            }
        }
        ev.preventDefault();
        this.env.router.navigate(this.props);
    }
}
Link.template = xml `
    <a  t-att-class="{'router-link-active': isActive }"
        t-att-href="href"
        t-on-click="navigate">
        <t t-slot="default"/>
    </a>
  `;

class RouteComponent extends Component {
    get routeComponent() {
        return this.env.router.currentRoute && this.env.router.currentRoute.component;
    }
}
RouteComponent.template = xml `
    <t>
        <t
            t-if="routeComponent"
            t-component="routeComponent"
            t-key="env.router.currentRouteName"
            t-props="env.router.currentParams" />
    </t>
  `;

const paramRegexp = /\{\{(.*?)\}\}/;
class Router {
    constructor(env, routes, options = { mode: "history" }) {
        this.currentRoute = null;
        this.currentParams = null;
        env.router = this;
        this.mode = options.mode;
        this.env = env;
        this.routes = {};
        this.routeIds = [];
        let nextId = 1;
        for (let partialRoute of routes) {
            if (!partialRoute.name) {
                partialRoute.name = "__route__" + nextId++;
            }
            if (partialRoute.component) {
                QWeb.registerComponent("__component__" + partialRoute.name, partialRoute.component);
            }
            if (partialRoute.redirect) {
                this.validateDestination(partialRoute.redirect);
            }
            partialRoute.params = partialRoute.path ? findParams(partialRoute.path) : [];
            this.routes[partialRoute.name] = partialRoute;
            this.routeIds.push(partialRoute.name);
        }
    }
    //--------------------------------------------------------------------------
    // Public API
    //--------------------------------------------------------------------------
    async start() {
        this._listener = ev => this._navigate(this.currentPath(), ev);
        window.addEventListener("popstate", this._listener);
        if (this.mode === "hash") {
            window.addEventListener("hashchange", this._listener);
        }
        const result = await this.matchAndApplyRules(this.currentPath());
        if (result.type === "match") {
            this.currentRoute = result.route;
            this.currentParams = result.params;
            const currentPath = this.routeToPath(result.route, result.params);
            if (currentPath !== this.currentPath()) {
                this.setUrlFromPath(currentPath);
            }
        }
    }
    async navigate(to) {
        const path = this.destToPath(to);
        return this._navigate(path);
    }
    async _navigate(path, ev) {
        const initialName = this.currentRouteName;
        const initialParams = this.currentParams;
        const result = await this.matchAndApplyRules(path);
        if (result.type === "match") {
            const finalPath = this.routeToPath(result.route, result.params);
            const isPopStateEvent = ev && ev instanceof PopStateEvent;
            if (!isPopStateEvent) {
                this.setUrlFromPath(finalPath);
            }
            this.currentRoute = result.route;
            this.currentParams = result.params;
        }
        else if (result.type === "nomatch") {
            this.currentRoute = null;
            this.currentParams = null;
        }
        const didChange = this.currentRouteName !== initialName || !shallowEqual(this.currentParams, initialParams);
        if (didChange) {
            this.env.qweb.forceUpdate();
            return true;
        }
        return false;
    }
    destToPath(dest) {
        this.validateDestination(dest);
        return dest.path || this.routeToPath(this.routes[dest.to], dest.params);
    }
    get currentRouteName() {
        return this.currentRoute && this.currentRoute.name;
    }
    //--------------------------------------------------------------------------
    // Private helpers
    //--------------------------------------------------------------------------
    setUrlFromPath(path) {
        const separator = this.mode === "hash" ? location.pathname : "";
        const url = location.origin + separator + path;
        if (url !== window.location.href) {
            window.history.pushState({}, path, url);
        }
    }
    validateDestination(dest) {
        if ((!dest.path && !dest.to) || (dest.path && dest.to)) {
            throw new Error(`Invalid destination: ${JSON.stringify(dest)}`);
        }
    }
    routeToPath(route, params) {
        const path = route.path;
        const parts = path.split("/");
        const l = parts.length;
        for (let i = 0; i < l; i++) {
            const part = parts[i];
            const match = part.match(paramRegexp);
            if (match) {
                const key = match[1].split(".")[0];
                parts[i] = params[key];
            }
        }
        const prefix = this.mode === "hash" ? "#" : "";
        return prefix + parts.join("/");
    }
    currentPath() {
        let result = this.mode === "history" ? window.location.pathname : window.location.hash.slice(1);
        return result || "/";
    }
    match(path) {
        for (let routeId of this.routeIds) {
            let route = this.routes[routeId];
            let params = this.getRouteParams(route, path);
            if (params) {
                return {
                    type: "match",
                    route: route,
                    params: params
                };
            }
        }
        return { type: "nomatch" };
    }
    async matchAndApplyRules(path) {
        const result = this.match(path);
        if (result.type === "match") {
            return this.applyRules(result);
        }
        return result;
    }
    async applyRules(matchResult) {
        const route = matchResult.route;
        if (route.redirect) {
            const path = this.destToPath(route.redirect);
            return this.matchAndApplyRules(path);
        }
        if (route.beforeRouteEnter) {
            const result = await route.beforeRouteEnter({
                env: this.env,
                from: this.currentRoute,
                to: route
            });
            if (result === false) {
                return { type: "cancelled" };
            }
            else if (result !== true) {
                // we want to navigate to another destination
                const path = this.destToPath(result);
                return this.matchAndApplyRules(path);
            }
        }
        return matchResult;
    }
    getRouteParams(route, path) {
        if (route.path === "*") {
            return {};
        }
        if (path.startsWith("#")) {
            path = path.slice(1);
        }
        const descrParts = route.path.split("/");
        const targetParts = path.split("/");
        const l = descrParts.length;
        if (l !== targetParts.length) {
            return false;
        }
        const result = {};
        for (let i = 0; i < l; i++) {
            const descr = descrParts[i];
            let target = targetParts[i];
            const match = descr.match(paramRegexp);
            if (match) {
                const [key, suffix] = match[1].split(".");
                if (suffix === "number") {
                    target = parseInt(target, 10);
                }
                result[key] = target;
            }
            else if (descr !== target) {
                return false;
            }
        }
        return result;
    }
}
function findParams(str) {
    const globalParamRegexp = /\{\{(.*?)\}\}/g;
    const result = [];
    let m;
    do {
        m = globalParamRegexp.exec(str);
        if (m) {
            result.push(m[1].split(".")[0]);
        }
    } while (m);
    return result;
}

/**
 * This file is the main file packaged by rollup (see rollup.config.js).  From
 * this file, we export all public owl elements.
 *
 * Note that dynamic values, such as a date or a commit hash are added by rollup
 */
const Context$1 = Context;
const useState$1 = useState;
const core = { EventBus, Observer };
const router = { Router, RouteComponent, Link };
const Store$1 = Store;
const utils = _utils;
const tags = _tags;
const misc = { AsyncRoot, Portal };
const hooks$1 = Object.assign({}, _hooks, {
    useContext: useContext,
    useDispatch: useDispatch,
    useGetters: useGetters,
    useStore: useStore
});
const __info__ = {};

exports.Component = Component;
exports.Context = Context$1;
exports.QWeb = QWeb;
exports.Store = Store$1;
exports.__info__ = __info__;
exports.config = config;
exports.core = core;
exports.hooks = hooks$1;
exports.misc = misc;
exports.router = router;
exports.tags = tags;
exports.useState = useState$1;
exports.utils = utils;

exports.__info__.version = '1.0.7';
exports.__info__.date = '2020-04-17T13:53:57.507Z';
exports.__info__.hash = '23ce19e';
exports.__info__.url = 'https://github.com/odoo/owl';


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./bundles/basicLayout.css":
/*!***********************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./bundles/basicLayout.css ***!
  \***********************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "jw-editor {\n    display: flex;\n    flex-direction: column;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-devtools/assets/DevTools.css":
/*!********************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/plugin-devtools/assets/DevTools.css ***!
  \********************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "/* GLOBAL */\n\njw-devtools {\n    bottom: 0;\n    min-height: 30px;\n    max-height: 100%;\n    top: auto;\n    background-color: white;\n    border-top: 1px solid #d0d0d0;\n    box-sizing: border-box;\n    display: flex;\n    flex-direction: column;\n    align-items: stretch;\n    user-select: none;\n    outline: none;\n}\n\ndevtools-table {\n    display: table;\n}\ndevtools-tbody {\n    display: table-row-group;\n}\ndevtools-tr {\n    display: table-row;\n}\ndevtools-td {\n    display: table-cell;\n    padding-right: 25px;\n}\ndevtools-button {\n    display: inline;\n    text-align: center;\n    align-items: flex-start;\n    box-sizing: border-box;\n    line-height: 2em;\n    font-family: initial;\n}\ndevtools-list {\n    display: block;\n    list-style: none;\n}\ndevtools-listitem {\n    display: list-item;\n}\n\njw-devtools.closed {\n    max-height: 31px;\n}\n\njw-devtools .bold {\n    font-weight: bold;\n}\n\njw-devtools .italic {\n    font-style: italic;\n}\n\njw-devtools .underline {\n    text-decoration: underline;\n}\n\njw-devtools .link {\n    text-decoration: underline;\n    color: blue;\n}\n\njw-devtools .subscript {\n    vertical-align: sub;\n    font-size: 0.7em;\n}\n\njw-devtools .superscript {\n    vertical-align: super;\n    font-size: 0.7em;\n}\n\njw-devtools .marker-node {\n    color: red;\n}\n\ndevtools-panel {\n    display: flex;\n    overflow: auto;\n}\n\ndevtools-panel:not(.active) {\n    display: none;\n}\n\ndevtools-panel .selectable-line:hover {\n    background-color: rgba(118, 82, 108, 0.2);\n}\n\ndevtools-panel .selectable-line.selected {\n    background-color: rgba(118, 82, 108, 0.3);\n}\n\ndevtools-panel devtools-button.logger {\n    float: right;\n    border: none;\n    background-color: transparent;\n    color: #666666;\n    padding: 0;\n    margin: 0;\n    display: none;\n    line-height: 0.7em;\n}\n\ndevtools-panel devtools-about > devtools-button.logger {\n    display: inline;\n    margin-left: 1em;\n}\n\ndevtools-panel .selectable-line:hover devtools-button.logger, devtools-panel .selected devtools-button.logger {\n    display: inline;\n}\n\n/* NAVBAR */\n\njw-devtools:not(.closed) > devtools-navbar {\n    cursor: row-resize;\n}\n\ndevtools-navbar {\n    background-color: #f3f3f3;\n    position: relative;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    height: 30px;\n    min-height: 30px;\n    width: 100%;\n    align-items: center;\n    border: 0;\n    border-bottom: 1px solid #d0d0d0;\n    box-sizing: border-box;\n    vertical-align: baseline;\n}\n\ndevtools-navbar > devtools-button {\n    padding: 0 10px 0 10px;\n    background: none;\n    border: 0;\n    vertical-align: middle;\n    outline: none;\n    cursor: auto;\n}\n\ndevtools-navbar > devtools-button:hover {\n    background-color: #d6d6d6;\n}\n\ndevtools-navbar > devtools-button.selected {\n    border-bottom: solid 2px #76526c;\n}\n\n/* CONTENTS */\n\ndevtools-contents {\n    display: flex;\n    flex-direction: row;\n    flex: 1;\n    overflow: auto;\n    position: relative;\n    font-family: 'Courier New', Courier, monospace;\n}\n\n/* mainpane */\n\ndevtools-mainpane {\n    display: flex;\n    overflow: auto;\n    flex-direction: column;\n    width: 100%;\n}\n\nmainpane-contents {\n    overflow: auto;\n    flex: 1;\n    padding: 1em;\n}\n\nmainpane-contents > devtools-table devtools-td:nth-child(1)  {\n    width: 100px;\n}\n\ndevtools-command {\n    display: block;\n}\n\n/* tree */\n\ndevtools-tree {\n    display: block;\n    flex-grow: 1;\n    width: 100%;\n}\n\ndevtools-tree devtools-children {\n    display: block;\n    position: relative;\n    box-sizing: border-box;\n    padding: 1px 0 1px 1.5em;\n    border-left: 1px solid #d0d0d0;\n}\n\ndevtools-tree div {\n    width: 100%;\n}\n\ndevtools-tree > devtools-node.root > devtools-nodename {\n    background-color: #76526c;\n    color: white;\n    padding-left: 5px;\n    box-sizing: border-box;\n}\n\njw-devtools devtools-nodename.inline {\n    display: inline;\n}\n\ndevtools-tree devtools-nodename.block {\n    color: #76526c;\n    width: 100%;\n    display: inline-block;\n}\n\ndevtools-tree devtools-nodename.line-break:after {\n    content: '\\A';\n    white-space: pre;\n}\n\ndevtools-node {\n    outline: none;\n}\n\ndevtools-node:not(.folded):not(.self-closing):not(.root) > devtools-nodename.block:before {\n    content: '⌄ ';\n}\n\ndevtools-node.folded:not(.self-closing) > devtools-nodename.block:before {\n    content: '› ';\n}\n\ndevtools-node.folded devtools-children {\n    display: none;\n}\n\ndevtools-path {\n    display: block;\n    border-top: 1px solid #d0d0d0;\n    background-color: #dddddd;\n    /* position: fixed; */\n    bottom: 0;\n    left: 0;\n    right: 0;\n}\n\ndevtools-pathnode {\n    display: inline-block;\n    padding: .2em 1em .2em 1em;\n    color: #696969;\n    font-size: 13px;\n}\n\ndevtools-pathnode:hover {\n    background-color: #d6d6d6;\n}\n\ndevtools-pathnode.selected {\n    background-color: #d0d0d0;\n}\n\n/* sidepane */\n\ndevtools-sidepane {\n    position: relative;\n    overflow: auto;\n    display: block;\n    font-size: 15px;\n    box-sizing: border-box;\n    width: 30%;\n    background-color: white;\n    border-left: 1px solid #d0d0d0;\n}\n\ndevtools-sidepane devtools-about {\n    border-bottom: 1px solid #d0d0d0;\n    padding: 10px;\n}\n\ndevtools-sidepane devtools-about devtools-type {\n    font-family: initial;\n    font-style: italic;\n    font-size: smaller;\n    color: #76526c;\n    padding-right: .5em;\n}\n\ndevtools-sidepane devtools-properties {\n    font-size: 12px;\n    padding: 10px;\n    overflow: auto;\n    margin-bottom: 30px;\n}\n\ndevtools-infotitle {\n    display: block;\n}\n\ndevtools-sidepane devtools-properties devtools-infotitle {\n    padding: 1em;\n    font-family: initial;\n    font-size: larger;\n    color: #382034;\n}\n\ndevtools-sidepane devtools-properties devtools-infotitle:first-child {\n    padding-top: 0em;\n}\n\ndevtools-sidepane devtools-properties devtools-table {\n    width: 100%;\n    font-size: inherit;\n}\n\ndevtools-sidepane devtools-properties devtools-table devtools-tbody{\n    vertical-align: top;\n}\n\ndevtools-sidepane devtools-properties devtools-table devtools-td {\n    padding: 0.3em;\n}\n\ndevtools-sidepane devtools-properties devtools-table devtools-td:nth-child(1) {\n    width: 100px;\n}\n\ndevtools-sidepane devtools-properties devtools-table devtools-list {\n    list-style-position: inside;\n    padding-left: 0;\n    margin: 0;\n}\n\ndevtools-sidepane devtools-properties > devtools-table > devtools-tbody > devtools-tr:nth-child(even) {\n    background-color: #f4f4f4;\n}\n\ndevtools-info {\n    display: flex;\n    flex-direction: column;\n}\n\ndevtools-info devtools-about devtools-id {\n    float: right;\n    color: #76526c;\n    font-size: smaller;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-dialog/src/ui/Dialog.css":
/*!****************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/plugin-dialog/src/ui/Dialog.css ***!
  \****************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "jw-dialog-container {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\njw-dialog-container jw-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    opacity: 0.5;\n    background-color: #000000;\n}\njw-dialog-container jw-dialog {\n    position: absolute;\n    display: flex;\n    max-width: 80%;\n}\njw-dialog-container jw-dialog > jw-content {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    background-color: #F7F7F7;\n    padding: 10px;\n    border-radius: 10px;\n}\njw-dialog-container jw-dialog > jw-content > jw-button.close {\n    position: absolute;\n    right: 10px;\n    top: 4px;\n    cursor: pointer;\n}\njw-dialog-container jw-dialog table.form-table {\n    border: none;\n}\njw-dialog-container jw-dialog table.form-table td {\n    border: none;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-toolbar/assets/Toolbar.css":
/*!******************************************************************************************!*\
  !*** ./node_modules/css-loader/dist/cjs.js!./packages/plugin-toolbar/assets/Toolbar.css ***!
  \******************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// Imports
var ___CSS_LOADER_API_IMPORT___ = __webpack_require__(/*! ../../../node_modules/css-loader/dist/runtime/api.js */ "./node_modules/css-loader/dist/runtime/api.js");
exports = ___CSS_LOADER_API_IMPORT___(false);
// Module
exports.push([module.i, "jw-toolbar {\n    display: block;\n    min-height: 14px;\n    background-color: #875A7B;\n    border-bottom: 1px solid #68465f;\n    color: white;\n    overflow: hidden;\n    font-family: \"Montserrat\", sans-serif;\n    text-align: center;\n    width: 100%;\n}\n\n.jw-primary-button {\n    background-color: #00A09D;\n    color: white;\n}\n\njw-toolbar span {\n    font-weight: 600;\n    padding: 5px;\n}\n\njw-toolbar .pressed {\n    background-color: #9c8897;\n    color: white;\n}\n\njw-toolbar jw-separator {\n    display: inline-block;\n    background-color: #c1a8ba;\n    height: 30px;\n    width: 1px;\n    margin-left: 2px;\n    margin-right: 2px;\n    margin-top: 5px;\n    margin-bottom: 5px;\n    vertical-align: bottom;\n}\n\njw-toolbar toolbar-group jw-separator {\n    margin-top: 0;\n    margin-bottom: 0;\n}\n\njw-toolbar toolbar-group {\n    display: inline-block;\n    margin: 5px;\n}\n\njw-toolbar select, jw-toolbar option {\n    background-color: white;\n    border: 1px solid #68465f;\n    padding: 5px;\n    height: 30px !important;\n}\n\njw-toolbar option:disabled {\n    background-color: #875A7B;\n    color: white;\n    font-weight: bold;\n}\n\njw-toolbar button {\n    background-color: white;\n    border: 1px solid #68465f;\n    padding: 5px;\n    width: 30px !important;\n    height: 30px !important;\n}\n\njw-toolbar .h1 {\n    font-size: 2em;\n    font-weight: bold;\n}\njw-toolbar .h2 {\n    font-size: 1.5em;\n    font-weight: bold;\n}\njw-toolbar .h3 {\n    font-size: 1.17em;\n    font-weight: bold;\n}\njw-toolbar .h4 {\n    font-size: 1em;\n    font-weight: bold;\n}\njw-toolbar .h5 {\n    font-size: 0.83em;\n    font-weight: bold;\n}\njw-toolbar .h6 {\n    font-size: 0.67em;\n    font-weight: bold;\n}\n", ""]);
// Exports
module.exports = exports;


/***/ }),

/***/ "./node_modules/css-loader/dist/runtime/api.js":
/*!*****************************************************!*\
  !*** ./node_modules/css-loader/dist/runtime/api.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


/*
  MIT License http://www.opensource.org/licenses/mit-license.php
  Author Tobias Koppers @sokra
*/
// css base code, injected by the css-loader
// eslint-disable-next-line func-names
module.exports = function (useSourceMap) {
  var list = []; // return the list of modules as css string

  list.toString = function toString() {
    return this.map(function (item) {
      var content = cssWithMappingToString(item, useSourceMap);

      if (item[2]) {
        return "@media ".concat(item[2], " {").concat(content, "}");
      }

      return content;
    }).join('');
  }; // import a list of modules into the list
  // eslint-disable-next-line func-names


  list.i = function (modules, mediaQuery, dedupe) {
    if (typeof modules === 'string') {
      // eslint-disable-next-line no-param-reassign
      modules = [[null, modules, '']];
    }

    var alreadyImportedModules = {};

    if (dedupe) {
      for (var i = 0; i < this.length; i++) {
        // eslint-disable-next-line prefer-destructuring
        var id = this[i][0];

        if (id != null) {
          alreadyImportedModules[id] = true;
        }
      }
    }

    for (var _i = 0; _i < modules.length; _i++) {
      var item = [].concat(modules[_i]);

      if (dedupe && alreadyImportedModules[item[0]]) {
        // eslint-disable-next-line no-continue
        continue;
      }

      if (mediaQuery) {
        if (!item[2]) {
          item[2] = mediaQuery;
        } else {
          item[2] = "".concat(mediaQuery, " and ").concat(item[2]);
        }
      }

      list.push(item);
    }
  };

  return list;
};

function cssWithMappingToString(item, useSourceMap) {
  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring

  var cssMapping = item[3];

  if (!cssMapping) {
    return content;
  }

  if (useSourceMap && typeof btoa === 'function') {
    var sourceMapping = toComment(cssMapping);
    var sourceURLs = cssMapping.sources.map(function (source) {
      return "/*# sourceURL=".concat(cssMapping.sourceRoot || '').concat(source, " */");
    });
    return [content].concat(sourceURLs).concat([sourceMapping]).join('\n');
  }

  return [content].join('\n');
} // Adapted from convert-source-map (MIT)


function toComment(sourceMap) {
  // eslint-disable-next-line no-undef
  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));
  var data = "sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(base64);
  return "/*# ".concat(data, " */");
}

/***/ }),

/***/ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js":
/*!****************************************************************************!*\
  !*** ./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js ***!
  \****************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


var isOldIE = function isOldIE() {
  var memo;
  return function memorize() {
    if (typeof memo === 'undefined') {
      // Test for IE <= 9 as proposed by Browserhacks
      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805
      // Tests for existence of standard globals is to allow style-loader
      // to operate correctly into non-standard environments
      // @see https://github.com/webpack-contrib/style-loader/issues/177
      memo = Boolean(window && document && document.all && !window.atob);
    }

    return memo;
  };
}();

var getTarget = function getTarget() {
  var memo = {};
  return function memorize(target) {
    if (typeof memo[target] === 'undefined') {
      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself

      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {
        try {
          // This will throw an exception if access to iframe is blocked
          // due to cross-origin restrictions
          styleTarget = styleTarget.contentDocument.head;
        } catch (e) {
          // istanbul ignore next
          styleTarget = null;
        }
      }

      memo[target] = styleTarget;
    }

    return memo[target];
  };
}();

var stylesInDom = [];

function getIndexByIdentifier(identifier) {
  var result = -1;

  for (var i = 0; i < stylesInDom.length; i++) {
    if (stylesInDom[i].identifier === identifier) {
      result = i;
      break;
    }
  }

  return result;
}

function modulesToDom(list, options) {
  var idCountMap = {};
  var identifiers = [];

  for (var i = 0; i < list.length; i++) {
    var item = list[i];
    var id = options.base ? item[0] + options.base : item[0];
    var count = idCountMap[id] || 0;
    var identifier = "".concat(id, " ").concat(count);
    idCountMap[id] = count + 1;
    var index = getIndexByIdentifier(identifier);
    var obj = {
      css: item[1],
      media: item[2],
      sourceMap: item[3]
    };

    if (index !== -1) {
      stylesInDom[index].references++;
      stylesInDom[index].updater(obj);
    } else {
      stylesInDom.push({
        identifier: identifier,
        updater: addStyle(obj, options),
        references: 1
      });
    }

    identifiers.push(identifier);
  }

  return identifiers;
}

function insertStyleElement(options) {
  var style = document.createElement('style');
  var attributes = options.attributes || {};

  if (typeof attributes.nonce === 'undefined') {
    var nonce =  true ? __webpack_require__.nc : undefined;

    if (nonce) {
      attributes.nonce = nonce;
    }
  }

  Object.keys(attributes).forEach(function (key) {
    style.setAttribute(key, attributes[key]);
  });

  if (typeof options.insert === 'function') {
    options.insert(style);
  } else {
    var target = getTarget(options.insert || 'head');

    if (!target) {
      throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");
    }

    target.appendChild(style);
  }

  return style;
}

function removeStyleElement(style) {
  // istanbul ignore if
  if (style.parentNode === null) {
    return false;
  }

  style.parentNode.removeChild(style);
}
/* istanbul ignore next  */


var replaceText = function replaceText() {
  var textStore = [];
  return function replace(index, replacement) {
    textStore[index] = replacement;
    return textStore.filter(Boolean).join('\n');
  };
}();

function applyToSingletonTag(style, index, remove, obj) {
  var css = remove ? '' : obj.media ? "@media ".concat(obj.media, " {").concat(obj.css, "}") : obj.css; // For old IE

  /* istanbul ignore if  */

  if (style.styleSheet) {
    style.styleSheet.cssText = replaceText(index, css);
  } else {
    var cssNode = document.createTextNode(css);
    var childNodes = style.childNodes;

    if (childNodes[index]) {
      style.removeChild(childNodes[index]);
    }

    if (childNodes.length) {
      style.insertBefore(cssNode, childNodes[index]);
    } else {
      style.appendChild(cssNode);
    }
  }
}

function applyToTag(style, options, obj) {
  var css = obj.css;
  var media = obj.media;
  var sourceMap = obj.sourceMap;

  if (media) {
    style.setAttribute('media', media);
  } else {
    style.removeAttribute('media');
  }

  if (sourceMap && btoa) {
    css += "\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), " */");
  } // For old IE

  /* istanbul ignore if  */


  if (style.styleSheet) {
    style.styleSheet.cssText = css;
  } else {
    while (style.firstChild) {
      style.removeChild(style.firstChild);
    }

    style.appendChild(document.createTextNode(css));
  }
}

var singleton = null;
var singletonCounter = 0;

function addStyle(obj, options) {
  var style;
  var update;
  var remove;

  if (options.singleton) {
    var styleIndex = singletonCounter++;
    style = singleton || (singleton = insertStyleElement(options));
    update = applyToSingletonTag.bind(null, style, styleIndex, false);
    remove = applyToSingletonTag.bind(null, style, styleIndex, true);
  } else {
    style = insertStyleElement(options);
    update = applyToTag.bind(null, style, options);

    remove = function remove() {
      removeStyleElement(style);
    };
  }

  update(obj);
  return function updateStyle(newObj) {
    if (newObj) {
      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {
        return;
      }

      update(obj = newObj);
    } else {
      remove();
    }
  };
}

module.exports = function (list, options) {
  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>
  // tags it will allow on a page

  if (!options.singleton && typeof options.singleton !== 'boolean') {
    options.singleton = isOldIE();
  }

  list = list || [];
  var lastIdentifiers = modulesToDom(list, options);
  return function update(newList) {
    newList = newList || [];

    if (Object.prototype.toString.call(newList) !== '[object Array]') {
      return;
    }

    for (var i = 0; i < lastIdentifiers.length; i++) {
      var identifier = lastIdentifiers[i];
      var index = getIndexByIdentifier(identifier);
      stylesInDom[index].references--;
    }

    var newLastIdentifiers = modulesToDom(newList, options);

    for (var _i = 0; _i < lastIdentifiers.length; _i++) {
      var _identifier = lastIdentifiers[_i];

      var _index = getIndexByIdentifier(_identifier);

      if (stylesInDom[_index].references === 0) {
        stylesInDom[_index].updater();

        stylesInDom.splice(_index, 1);
      }
    }

    lastIdentifiers = newLastIdentifiers;
  };
};

/***/ }),

/***/ "./packages/build-odoo-integration/odoo-integration.ts":
/*!*************************************************************!*\
  !*** ./packages/build-odoo-integration/odoo-integration.ts ***!
  \*************************************************************/
/*! exports provided: OdooWebsiteEditor, BasicEditor, DevTools, Layout, DomLayoutEngine, Renderer, ImageNode, withRange, VRange, createExecCommandHelpersForOdoo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _bundles_BasicEditor__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../../bundles/BasicEditor */ "./bundles/BasicEditor.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "BasicEditor", function() { return _bundles_BasicEditor__WEBPACK_IMPORTED_MODULE_0__["BasicEditor"]; });

/* harmony import */ var _plugin_devtools_src_DevTools__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../plugin-devtools/src/DevTools */ "./packages/plugin-devtools/src/DevTools.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DevTools", function() { return _plugin_devtools_src_DevTools__WEBPACK_IMPORTED_MODULE_1__["DevTools"]; });

/* harmony import */ var _bundles_OdooWebsiteEditor__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../bundles/OdooWebsiteEditor */ "./bundles/OdooWebsiteEditor.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "OdooWebsiteEditor", function() { return _bundles_OdooWebsiteEditor__WEBPACK_IMPORTED_MODULE_2__["OdooWebsiteEditor"]; });

/* harmony import */ var _core_src_VRange__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../core/src/VRange */ "./packages/core/src/VRange.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "withRange", function() { return _core_src_VRange__WEBPACK_IMPORTED_MODULE_3__["withRange"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "VRange", function() { return _core_src_VRange__WEBPACK_IMPORTED_MODULE_3__["VRange"]; });

/* harmony import */ var _plugin_dom_layout_src_ui_DomLayoutEngine__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../plugin-dom-layout/src/ui/DomLayoutEngine */ "./packages/plugin-dom-layout/src/ui/DomLayoutEngine.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "DomLayoutEngine", function() { return _plugin_dom_layout_src_ui_DomLayoutEngine__WEBPACK_IMPORTED_MODULE_4__["DomLayoutEngine"]; });

/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Layout", function() { return _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_5__["Layout"]; });

/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "Renderer", function() { return _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_6__["Renderer"]; });

/* harmony import */ var _plugin_image_src_ImageNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../plugin-image/src/ImageNode */ "./packages/plugin-image/src/ImageNode.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "ImageNode", function() { return _plugin_image_src_ImageNode__WEBPACK_IMPORTED_MODULE_7__["ImageNode"]; });

/* harmony import */ var _plugin_odoo_snippets_src_OdooBindings__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../plugin-odoo-snippets/src/OdooBindings */ "./packages/plugin-odoo-snippets/src/OdooBindings.ts");
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "createExecCommandHelpersForOdoo", function() { return _plugin_odoo_snippets_src_OdooBindings__WEBPACK_IMPORTED_MODULE_8__["createExecCommandHelpersForOdoo"]; });













/***/ }),

/***/ "./packages/core/src/ContextManager.ts":
/*!*********************************************!*\
  !*** ./packages/core/src/ContextManager.ts ***!
  \*********************************************/
/*! exports provided: ContextManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContextManager", function() { return ContextManager; });
class ContextManager {
    constructor(editor) {
        this.editor = editor;
        this.defaultContext = {
            range: this.editor.selection.range,
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Match a command from the current context (the `vDocument` selection).
     *
     * Search through all command with `commandId` and return the last
     * `CommandImplementation` that match a particular context.
     *
     * Commands with more specificity will have priority.  If there is multiples
     * commands with the same specificity, the last defined will be retured.
     *
     * The context is the `editor.selection.range.start.ancestors()`.
     *
     * Specificity is defined with:
     * - `lvl2`: if the last predicate of a command "a"'s selector is deeper in
     *   the tree than the last predicate of a command "b"'s selector; command
     *   "a" have more specificity
     * - `lvl1`: if two or more commands have the same `lvl2` specificity; the
     *   command with the longest selector will have more specificity
     * - `lvl0`: if the command has no selector, there is no specificity
     *
     * For example:
     * ```typescript
     * const commandUlP: CommandImplementation = {
     *     selector: [isUl, isP],
     *     handler: () =>{},
     * }
     * const commandP: CommandImplementation = {
     *     selector: [isP],
     *     handler: () =>{},
     * }
     * const commandUl: CommandImplementation = {
     *     selector: [isUl],
     *     handler: () =>{},
     * }
     * const commandImage: CommandImplementation = {
     *     selector: [isImage],
     *     handler: () =>{},
     * }
     * const commandAny: CommandImplementation = {
     *     selector: [],
     *     handler: () =>{},
     * }
     * dispatcher.registerCommand('command', commandUlP)
     * dispatcher.registerCommand('command', commandP)
     * dispatcher.registerCommand('command', commandUl)
     * dispatcher.registerCommand('command', commandImage)
     * dispatcher.registerCommand('command', commandAny)
     * const result = dispatcher._mach('command')
     * ```
     *
     * If the document looks like:
     * ```html
     * <ul>
     *     <li>
     *         <!-- The char "[]" represent the collapsed selection -->
     *         <p>[]a</p>
     *     </li>
     * </ul>
     * ```
     *
     * The ancestors list is `['ul', 'li', 'p']`.
     *
     * The 4 command `commandUlP`, `commandP`, `commandUl`, `commandAny` could
     * match the `command` identifier but not `commandImage`.
     *
     * The priority is calculated with "`lvl2`,`lvl1`".
     * - `commandUlP` specificity: 2,2 `lvl2`: 2 means the last predicate
     *   (`isP`) is found at depth 2 in ancestors `lvl1`: 2 means there are 2
     *   predicates in `commandUlP`'s selector
     * - `commandP` specificity: 2,1 `lvl2`: 2 means the last predicate (`isP`)
     *   is found at depth 2 in ancestors `lvl1`: 1 means there is 1 predicate
     *   in `commandP`'s selector
     * - `commandUl` specificity: 0,1 `lvl0`: 0 means the last predicate
     *   (`isUl`) is found at depth 0 in ancestors `lvl1`: 1 means there is 1
     *   predicate in `commandP`'s selector
     * - `commandAny` specificity: -1,0 No selector means no specificity.
     *   `lvl0`: -1 means it has no depth.  `lvl1`: 0 means there is 0
     *   predicates in `commandAny`'s selector
     *
     * The result will be `commandUlP` because it has the highest specificity.
     *
     * @param items
     * @param paramsContext
     */
    match(items, paramsContext) {
        let maxFirstMatchDepth = -1;
        let maxSelectorLength = 0;
        let matchingItem;
        let matchingContext;
        for (const item of items) {
            const context = { ...this.defaultContext, ...item.context, ...paramsContext };
            let firstMatchDepth = -1;
            let index = 0;
            const selector = item.selector || [];
            const matches = [];
            const start = context.range.start;
            const nodes = start.ancestors();
            const node = start.previousSibling() || start.nextSibling();
            if (node) {
                nodes.unshift(node);
            }
            const maximumDepth = nodes.length - 1;
            for (const predicate of [...selector].reverse()) {
                let matchFound = false;
                while (!matchFound && index < nodes.length) {
                    if (nodes[index].test(predicate)) {
                        matchFound = true;
                        matches.unshift(nodes[index]);
                        if (firstMatchDepth === -1) {
                            // Deeper match has higher specificity. So lower
                            // index in ancestors, means higher specificity.
                            firstMatchDepth = maximumDepth - index;
                        }
                    }
                    index++;
                }
                // Stop checking the predicates of this particular command
                // since at least one of them don't match the context.
                if (!matchFound)
                    break;
            }
            if (matches.length === selector.length &&
                maxFirstMatchDepth <= firstMatchDepth &&
                maxSelectorLength <= selector.length &&
                (!item.check || item.check({ ...context, selector: matches }))) {
                maxFirstMatchDepth = firstMatchDepth;
                maxSelectorLength = selector.length;
                matchingItem = item;
                matchingContext = context;
            }
        }
        return [matchingItem, matchingContext];
    }
}


/***/ }),

/***/ "./packages/core/src/Core.ts":
/*!***********************************!*\
  !*** ./packages/core/src/Core.ts ***!
  \***********************************/
/*! exports provided: Core */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Core", function() { return Core; });
/* harmony import */ var _JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");


class Core extends _JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            insert: {
                handler: this.insert,
            },
            insertParagraphBreak: {
                handler: this.insertParagraphBreak,
            },
            setSelection: {
                handler: this.setSelection,
            },
            deleteBackward: {
                handler: this.deleteBackward,
            },
            deleteForward: {
                handler: this.deleteForward,
            },
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Insert a paragraph break.
     */
    insertParagraphBreak(params) {
        const range = params.context.range;
        // Remove the contents of the range if needed.
        if (!range.isCollapsed()) {
            range.empty();
        }
        if (range.startContainer.breakable) {
            range.startContainer.splitAt(range.start);
        }
        else {
            // Use a separator to break paragraphs in an unbreakable.
            const Separator = this.editor.configuration.defaults.Separator;
            range.start.before(new Separator());
        }
    }
    /**
     * Insert a VNode at the current position of the selection.
     *
     * @param params
     */
    insert(params) {
        // Remove the contents of the range if needed.
        if (!params.context.range.isCollapsed()) {
            params.context.range.empty();
        }
        params.context.range.start.before(params.node);
    }
    /**
     * Delete in the backward direction (backspace key expected behavior).
     */
    deleteBackward(params) {
        const range = params.context.range;
        if (range.isCollapsed()) {
            // Basic case: remove the node directly preceding the range.
            const previousSibling = range.start.previousSibling();
            if (previousSibling &&
                range.startContainer.breakable &&
                range.startContainer.editable) {
                previousSibling.removeBackward();
            }
            else if (range.startContainer.breakable && range.startContainer.editable) {
                // Otherwise set range start at previous valid leaf.
                let ancestor = range.start.parent;
                while ((ancestor === null || ancestor === void 0 ? void 0 : ancestor.breakable) && ancestor.editable && !ancestor.previousSibling()) {
                    ancestor = ancestor.parent;
                }
                if ((ancestor === null || ancestor === void 0 ? void 0 : ancestor.breakable) && ancestor.editable) {
                    const previous = ancestor.previousSibling().lastLeaf();
                    if (previous) {
                        range.setStart(previous, _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER);
                        range.empty();
                    }
                }
            }
        }
        else {
            range.empty();
        }
    }
    /**
     * Delete in the forward direction (delete key expected behavior).
     */
    deleteForward(params) {
        const range = params.context.range;
        if (range.isCollapsed()) {
            // Basic case: remove the node directly following the range.
            const nextSibling = range.end.nextSibling();
            if (nextSibling && range.endContainer.breakable && range.endContainer.editable) {
                nextSibling.removeForward();
            }
            else if (range.endContainer.breakable && range.endContainer.editable) {
                // Otherwise set range end at next valid leaf.
                let ancestor = range.end.parent;
                while ((ancestor === null || ancestor === void 0 ? void 0 : ancestor.breakable) && ancestor.editable && !ancestor.nextSibling()) {
                    ancestor = ancestor.parent;
                }
                if ((ancestor === null || ancestor === void 0 ? void 0 : ancestor.breakable) && ancestor.editable) {
                    const next = ancestor.nextSibling().firstLeaf();
                    if (next) {
                        range.setEnd(next, _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE);
                        range.empty();
                    }
                }
            }
        }
        else {
            range.empty();
        }
    }
    /**
     * Navigate to a given range.
     *
     * @param params
     */
    setSelection(params) {
        this.editor.selection.set(params.vSelection);
    }
}


/***/ }),

/***/ "./packages/core/src/Dispatcher.ts":
/*!*****************************************!*\
  !*** ./packages/core/src/Dispatcher.ts ***!
  \*****************************************/
/*! exports provided: Dispatcher */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Dispatcher", function() { return Dispatcher; });
class Dispatcher {
    constructor(editor) {
        this.__nextHandlerTokenID = 0;
        this.commands = {};
        this.commandHooks = {};
        this.editor = editor;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Call all hooks registred for the command `id`.
     *
     * @param commandId The identifier of the command.
     * @param params The parameters of the command.
     */
    async dispatch(commandId, params = {}) {
        const commands = this.commands[commandId];
        if (!commands) {
            console.warn(`Command '${commandId}' not found.`);
            return;
        }
        let result;
        const [command, context] = this.editor.contextManager.match(commands, params.context);
        if (command) {
            // Update command arguments with the computed execution context.
            const args = { ...params, context };
            // Call command handler.
            result = await command.handler(args);
            await this._dispatchHooks(commandId, args);
        }
        return result;
    }
    /**
     * Trigger the dispatcher for a custom command.
     */
    async dispatchCustom() {
        return this._dispatchHooks('@custom');
    }
    /**
     * Register all handlers declared in a plugin, and match them with their
     * corresponding command.
     *
     */
    registerCommand(id, impl) {
        if (!this.commands[id]) {
            this.commands[id] = [impl];
        }
        else {
            this.commands[id].push(impl);
        }
    }
    /**
     * Register a callback that will be executed for each `execCommand` call.
     *
     * @param id The identifier of the command to hook.
     * @param hook The callback that will be executed.
     */
    registerCommandHook(id, hook) {
        if (!this.commandHooks[id]) {
            this.commandHooks[id] = [];
        }
        this.commandHooks[id].push(hook);
    }
    /**
     * Dispatch to all registred `commandHooks`.
     */
    async _dispatchHooks(commandId, args) {
        const hooks = this.commandHooks[commandId] || [];
        const globalHooks = this.commandHooks['*'] || [];
        for (const hookCallback of [...hooks, ...globalHooks]) {
            await hookCallback(args, commandId);
        }
    }
}


/***/ }),

/***/ "./packages/core/src/JWEditor.ts":
/*!***************************************!*\
  !*** ./packages/core/src/JWEditor.ts ***!
  \***************************************/
/*! exports provided: Mode, JWEditor, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Mode", function() { return Mode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "JWEditor", function() { return JWEditor; });
/* harmony import */ var _Dispatcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Dispatcher */ "./packages/core/src/Dispatcher.ts");
/* harmony import */ var _JWPlugin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _Core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Core */ "./packages/core/src/Core.ts");
/* harmony import */ var _ContextManager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ContextManager */ "./packages/core/src/ContextManager.ts");
/* harmony import */ var _VSelection__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _utils_src_errors__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/src/errors */ "./packages/utils/src/errors.ts");
/* harmony import */ var _VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");
/* harmony import */ var _VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./VNodes/SeparatorNode */ "./packages/core/src/VNodes/SeparatorNode.ts");











var Mode;
(function (Mode) {
    Mode["CONFIGURATION"] = "configuration";
    Mode["EDITION"] = "edition";
})(Mode || (Mode = {}));
class JWEditor {
    constructor() {
        this._mode = Mode.CONFIGURATION;
        this.plugins = new Map();
        this.configuration = {
            defaults: {
                Container: _VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_8__["ContainerNode"],
                Atomic: _VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_9__["AtomicNode"],
                Separator: _VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_10__["SeparatorNode"],
            },
            plugins: [],
            loadables: {},
        };
        this.selection = new _VSelection__WEBPACK_IMPORTED_MODULE_4__["VSelection"]();
        this.loaders = {};
        this.mutex = Promise.resolve();
        // use a set so that when async function are called, wait until every batch
        // commands finish.
        this.preventRenders = new Set();
        this.dispatcher = new _Dispatcher__WEBPACK_IMPORTED_MODULE_0__["Dispatcher"](this);
        this.plugins = new Map();
        this.contextManager = new _ContextManager__WEBPACK_IMPORTED_MODULE_3__["ContextManager"](this);
        this.nextEventMutex = this.nextEventMutex.bind(this);
        // Core is a special mandatory plugin that handles the matching between
        // the commands supported in the core of the editor and the VDocument.
        this.load(_Core__WEBPACK_IMPORTED_MODULE_2__["Core"]);
        this.load(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_6__["Keymap"]);
    }
    async nextEventMutex(next) {
        return (this.mutex = this.mutex.then(next));
    }
    /**
     * Start the editor on the editable DOM node set on this editor instance.
     */
    async start() {
        this._mode = Mode.EDITION;
        this._loadPlugins();
        // Load editor-level loadables.
        if (this.configuration.loadables) {
            for (const loadableId of Object.keys(this.loaders)) {
                const loadable = this.configuration.loadables[loadableId];
                if (loadable) {
                    this.loaders[loadableId](loadable, this.configuration);
                }
            }
        }
        for (const plugin of this.plugins.values()) {
            await plugin.start();
        }
    }
    load(PluginOrLoadables, config) {
        // Actual loading is deferred to `start`.
        if (this._mode !== Mode.CONFIGURATION) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_7__["ModeError"](Mode.CONFIGURATION);
        }
        else if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_5__["isConstructor"])(PluginOrLoadables, _JWPlugin__WEBPACK_IMPORTED_MODULE_1__["JWPlugin"])) {
            // Add the plugin to the configuration.
            const Plugin = PluginOrLoadables;
            const plugins = this.configuration.plugins;
            const index = plugins.findIndex(([p]) => p === Plugin);
            if (index !== -1) {
                // Remove this module from the config to avoid loading it twice.
                plugins.splice(index, 1);
            }
            plugins.push([Plugin, config || {}]);
        }
        else {
            // Add the loadables to the configuration.
            const configuredLoadables = this.configuration.loadables;
            for (const loadableIdentifier of Object.keys(PluginOrLoadables)) {
                const loadables = PluginOrLoadables[loadableIdentifier];
                if (configuredLoadables[loadableIdentifier]) {
                    configuredLoadables[loadableIdentifier].push(...loadables);
                }
                else {
                    configuredLoadables[loadableIdentifier] = [...loadables];
                }
            }
        }
    }
    /**
     * Load the plugins specified in the editor configuration.
     *
     */
    _loadPlugins() {
        // Resolve dependencies.
        const Plugins = [...this.configuration.plugins];
        for (let offset = 1; offset <= Plugins.length; offset++) {
            const index = Plugins.length - offset;
            const [Plugin] = Plugins[index];
            for (const Dependency of [...Plugin.dependencies].reverse()) {
                const depIndex = Plugins.findIndex(([P]) => P === Dependency);
                if (depIndex === -1) {
                    // Load the missing dependency with no config parameters.
                    Plugins.splice(index, 0, [Dependency, {}]);
                }
                else if (depIndex > index) {
                    // Load the dependency before the plugin depending on it.
                    const [[Dep, config]] = Plugins.splice(depIndex, 1);
                    Plugins.splice(index, 0, [Dep, config]);
                    offset--;
                }
            }
        }
        // Load plugins.
        for (const [PluginClass, configuration] of Plugins) {
            const plugin = new PluginClass(this, configuration);
            this.plugins.set(PluginClass, plugin);
            // Register the commands of this plugin.
            Object.keys(plugin.commands).forEach(key => {
                const implementation = { ...plugin.commands[key] };
                // Bind handlers to the plugin itself. This preserves the
                // typing of the handler parameters which would be lost if
                // the binding was done in the plugin definition.
                implementation.handler = implementation.handler.bind(plugin);
                this.dispatcher.registerCommand(key, implementation);
            });
            // Register the hooks of this plugin.
            for (const [id, hook] of Object.entries(plugin.commandHooks)) {
                this.dispatcher.registerCommandHook(id, hook.bind(plugin));
            }
            // Load loaders.
            for (const loadableId of Object.keys(plugin.loaders)) {
                if (this.loaders[loadableId]) {
                    throw new Error(`Multiple loaders for '${loadableId}'.`);
                }
                else {
                    // Bind loaders to the plugin itself. This preserves the
                    // typing of the loader parameters which would be lost if
                    // the binding was done in the plugin definition.
                    const loader = plugin.loaders[loadableId];
                    this.loaders[loadableId] = loader.bind(plugin);
                }
            }
        }
        // Load loadables.
        for (const loadableIdentifier of Object.keys(this.loaders)) {
            for (const plugin of this.plugins.values()) {
                const loadableArray = plugin.loadables[loadableIdentifier];
                if (loadableArray) {
                    this.loaders[loadableIdentifier](loadableArray, plugin);
                }
            }
        }
    }
    configure(PluginOrEditorConfig, pluginConfig) {
        if (this._mode !== Mode.CONFIGURATION) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_7__["ModeError"](Mode.CONFIGURATION);
        }
        else if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_5__["isConstructor"])(PluginOrEditorConfig, _JWPlugin__WEBPACK_IMPORTED_MODULE_1__["JWPlugin"])) {
            // Configure the plugin.
            const Plugin = PluginOrEditorConfig;
            const conf = this.configuration.plugins.find(([P]) => P === Plugin);
            if (conf) {
                // Update the previous config if the plugin was already added.
                conf[1] = { ...conf[1], ...pluginConfig };
            }
            else {
                // Add the new plugin constructor and his configuration.
                this.configuration.plugins.push([Plugin, pluginConfig]);
            }
        }
        else {
            // Configure the editor.
            const preconf = this.configuration;
            const conf = PluginOrEditorConfig;
            this.configuration = { ...preconf, ...conf };
            // Merge special `defaults` configuration key.
            if (conf.defaults) {
                this.configuration.defaults = {
                    ...preconf.defaults,
                    ...conf.defaults,
                };
            }
            // Handle special `plugins` configuration key through `load`.
            if (conf.plugins) {
                this.configuration.plugins = [...preconf.plugins];
                for (const [Plugin, pluginConfiguration] of conf.plugins) {
                    this.load(Plugin, pluginConfiguration || {});
                }
            }
            // Handle special `loadables` configuration key through `load`.
            if (conf.loadables) {
                this.configuration.loadables = { ...preconf.loadables };
                this.load(conf.loadables);
            }
        }
    }
    async execBatch(callback) {
        console.log('this.preventRenders:', this.preventRenders);
        this.preventRenders.add(callback);
        await callback();
        this.preventRenders.delete(callback);
        // const dom = this.plugins.get(Dom);
        // return dom._renderInEditable();
    }
    /**
     * Execute the given command.
     *
     * @param id name identifier of the command to execute
     * @param params arguments object of the command to execute
     */
    async execCommand(commandName, params) {
        return await this.dispatcher.dispatch(commandName, params);
    }
    /**
     * Execute arbitrary code in `callback`, then dispatch the event.
     */
    async execCustomCommand(callback) {
        await callback();
        await this.dispatcher.dispatchCustom();
    }
    /**
     * Stop this editor instance.
     */
    async stop() {
        for (const plugin of this.plugins.values()) {
            await plugin.stop();
        }
        // Clear loaders.
        this.loaders = {};
        this._mode = Mode.CONFIGURATION;
    }
}
/* harmony default export */ __webpack_exports__["default"] = (JWEditor);


/***/ }),

/***/ "./packages/core/src/JWPlugin.ts":
/*!***************************************!*\
  !*** ./packages/core/src/JWPlugin.ts ***!
  \***************************************/
/*! exports provided: JWPlugin */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "JWPlugin", function() { return JWPlugin; });
class JWPlugin {
    constructor(editor, configuration = {}) {
        this.editor = editor;
        this.configuration = configuration;
        this.dependencies = new Map();
        this.loaders = {};
        this.loadables = {};
        this.commands = {};
        this.commandHooks = {};
        // Populate instantiated dependencies.
        for (const Dependency of this.constructor.dependencies) {
            this.dependencies.set(Dependency, editor.plugins.get(Dependency));
        }
    }
    /**
     * Start the plugin. Called when the editor starts.
     */
    async start() {
        // This is where plugins can do asynchronous work when the editor is
        // starting (e.g. retrieve data from a server, render stuff, etc).
    }
    /**
     * Stop the plugin. Called when the editor stops.
     */
    async stop() {
        // This is where plugins can do asynchronous work when the editor is
        // stopping (e.g. save on a server, close connections, etc).
    }
}
JWPlugin.dependencies = [];


/***/ }),

/***/ "./packages/core/src/Modifier.ts":
/*!***************************************!*\
  !*** ./packages/core/src/Modifier.ts ***!
  \***************************************/
/*! exports provided: Modifier */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Modifier", function() { return Modifier; });
class Modifier {
    get name() {
        return '';
    }
    toString() {
        return this.name;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    applyTo(node) {
        node.modifiers.prepend(this);
    }
    isSameAs(otherModifier) {
        return this === otherModifier;
    }
    clone() {
        return new this.constructor();
    }
}


/***/ }),

/***/ "./packages/core/src/Modifiers.ts":
/*!****************************************!*\
  !*** ./packages/core/src/Modifiers.ts ***!
  \****************************************/
/*! exports provided: Modifiers */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Modifiers", function() { return Modifiers; });
/* harmony import */ var _Modifier__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Modifier */ "./packages/core/src/Modifier.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");


class Modifiers {
    constructor(...modifiers) {
        this._contents = [];
        const clonedModifiers = modifiers.map(mod => {
            return mod instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"] ? mod.clone() : mod;
        });
        this.append(...clonedModifiers);
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * Return the length of the array.
     */
    get length() {
        return this._contents.length;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new instance of the Modifiers class containing the same
     * modifiers.
     */
    clone() {
        return new Modifiers(...this._contents.map(mod => mod.clone()));
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Append one or more modifiers to the array. If one of the given modifiers
     * is a modifier class constructor, instantiate it.
     *
     * @param modifiers
     */
    append(...modifiers) {
        for (const modifier of modifiers) {
            if (modifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
                this._contents.push(modifier);
            }
            else {
                this._contents.push(new modifier());
            }
        }
    }
    /**
     * Prepend one or more modifiers to the array. If one of the given modifiers
     * is a modifier class constructor, instantiate it.
     *
     * @param modifiers
     */
    prepend(...modifiers) {
        for (const modifier of modifiers) {
            if (modifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
                this._contents.unshift(modifier);
            }
            else {
                this._contents.unshift(new modifier());
            }
        }
    }
    find(modifier) {
        if (modifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
            // `modifier` is an instance of `Modifier` -> find it in the array.
            return this._contents.find(instance => instance === modifier);
        }
        else if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["isConstructor"])(modifier, _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"])) {
            // `modifier` is a `Modifier` class -> find its first instance in
            // the array.
            return this._contents.find(mod => mod.constructor.name === modifier.name);
        }
        else if (modifier instanceof Function) {
            // `modifier` is a callback -> call `find` natively on the array.
            return this._contents.find(modifier);
        }
    }
    /**
     * Return the first modifier in the array that is an instance of the given
     * modifier class or create one, append it and return it.
     * If the modifier passed is a modifier instance, return it if it was
     * present in the array.
     *
     * @param modifier
     */
    get(modifier) {
        let found = this.find(modifier);
        if (!found && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["isConstructor"])(modifier, _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"])) {
            found = new modifier();
            this.append(found);
        }
        return found;
    }
    /**
     * Return all the modifiers instances that are hold by `this`.
     */
    getContent() {
        return this._contents;
    }
    filter(modifier, 
    // eslint-disable-next-line @typescript-eslint/no-explicit-any
    thisArg) {
        if (modifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
            // `modifier` is an instance of `Modifier` -> find it in the array
            // and return it in a new array.
            return this._contents.filter(m => m === modifier);
        }
        else if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["isConstructor"])(modifier, _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"])) {
            // `modifier` is a `Modifier` class -> return all instances of it in
            // the array.
            return this._contents.filter(m => m instanceof modifier);
        }
        else {
            // `modifier` is a callback -> call `filter` natively on the array.
            return this._contents.filter(modifier, thisArg);
        }
    }
    /**
     * Remove the first modifier in the array that is an instance of the given
     * modifier class. If a modifier instance is given, remove that particuar
     * instance from the array. Return true if a modifier was removed, false
     * otherwise.
     *
     * @param modifier
     */
    remove(modifier) {
        const modifierIndex = this._contents.findIndex(modifierInstance => {
            if (modifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
                return modifierInstance === modifier;
            }
            else {
                return modifierInstance instanceof modifier;
            }
        });
        if (modifierIndex === -1) {
            return false;
        }
        else {
            this._contents.splice(modifierIndex, 1);
            return true;
        }
    }
    /**
     * Replace the first modifier in the array that is an instance of the given
     * modifier class or that matches the particular instance passed with the
     * given modifier instance. If the new modifier passed is a class,
     * instantiate it. If no modifier was found, simply push the new modifier on
     * the array.
     *
     * Return true if a modifier was replaced, false if the modifier was simply
     * added.
     *
     * @param oldModifier
     * @param newModifier
     */
    replace(oldModifier, newModifier) {
        const oldModifierIndex = this._contents.findIndex(modifierInstance => {
            if (oldModifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"]) {
                return modifierInstance === oldModifier;
            }
            else {
                return modifierInstance instanceof oldModifier;
            }
        });
        if (oldModifierIndex === -1) {
            this.append(newModifier);
            return false;
        }
        else {
            const modifier = newModifier instanceof _Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"] ? newModifier : new newModifier();
            this[oldModifierIndex] = modifier;
            return true;
        }
    }
    /**
     * Replace the modifiers that have the same constructor. Otherwise append
     * them.
     */
    replaceOrAppend(modifiers) {
        for (const modifier of modifiers.getContent()) {
            const foundModifier = this.find(modifier.constructor);
            if (foundModifier) {
                this.replace(foundModifier, modifier);
            }
            else {
                this.append(modifier.clone());
            }
        }
    }
    /**
     * Remove the first modifier in the array that is an instance of the given
     * modifier class or that matches the particular instance passed.
     * If no modifier was found, add the given modifier instead.
     * If the given new modifier is a class, instantiate it.
     *
     * @param modifier
     */
    toggle(modifier) {
        this.remove(modifier) || this.append(modifier);
    }
    /**
     * Return true if the modifiers in this array are the same as the modifiers
     * in the given array (as defined by the `isSameAs` methods of the
     * modifiers).
     *
     * @param otherModifiers
     */
    areSameAs(otherModifiers) {
        const modifiersMap = new Map(this._contents.map(a => [a, otherModifiers.find(b => a.isSameAs(b))]));
        const aModifiers = Array.from(modifiersMap.keys());
        const bModifiers = Array.from(modifiersMap.values());
        const allAinB = aModifiers.every(a => a.isSameAs(modifiersMap.get(a)));
        const allBinA = otherModifiers.every(b => bModifiers.includes(b) || b.isSameAs(this.find(b)));
        return allAinB && allBinA;
    }
    /**
     * Proxy for the native `some` method of `Array`, called on `this._contents`.
     *
     * @see Array.some
     * @param callbackfn
     */
    some(callbackfn) {
        return this._contents.some(callbackfn);
    }
    /**
     * Proxy for the native `every` method of `Array`, called on `this._contents`.
     *
     * @see Array.every
     * @param callbackfn
     */
    every(callbackfn) {
        return this._contents.every(callbackfn);
    }
    /**
     * Proxy for the native `map` method of `Array`, called on `this._contents`.
     *
     * @see Array.map
     * @param callbackfn
     */
    map(callbackfn) {
        return this._contents.map(callbackfn);
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/AbstractNode.ts":
/*!**************************************************!*\
  !*** ./packages/core/src/VNodes/AbstractNode.ts ***!
  \**************************************************/
/*! exports provided: AbstractNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbstractNode", function() { return AbstractNode; });
/* harmony import */ var _VNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _Modifiers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../Modifiers */ "./packages/core/src/Modifiers.ts");



let id = 0;
class AbstractNode {
    constructor() {
        this.id = id;
        this.editable = true;
        this.tangible = true;
        this.breakable = true;
        this.modifiers = new _Modifiers__WEBPACK_IMPORTED_MODULE_2__["Modifiers"]();
        id++;
    }
    /**
     * Return whether the given predicate is a constructor of a VNode class.
     *
     * @param predicate The predicate to check.
     */
    static isConstructor(predicate) {
        return predicate.prototype instanceof AbstractNode;
    }
    get name() {
        return this.constructor.name;
    }
    /**
     * Return the text content of this node.
     */
    get textContent() {
        return this.children()
            .map(child => child.textContent)
            .join('');
    }
    /**
     * @override
     */
    toString() {
        return this.name;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Transform the given DOM location into its VDocument counterpart.
     *
     * @param domNode DOM node corresponding to this VNode
     * @param offset The offset of the location in the given domNode
     */
    locate(domNode, offset) {
        // Position `BEFORE` is preferred over `AFTER`, unless the offset
        // overflows the children list, in which case `AFTER` is needed.
        let position = _VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
        const domNodeLength = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeLength"])(domNode);
        if (domNodeLength && offset >= domNodeLength) {
            position = _VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER;
        }
        return [this, position];
    }
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     */
    clone(params) {
        const clone = new this.constructor(params);
        clone.modifiers = this.modifiers.clone();
        return clone;
    }
    /**
     * Replace this VNode with the given VNode.
     *
     * @param node
     */
    replaceWith(node) {
        this.before(node);
        this.mergeWith(node);
    }
    //--------------------------------------------------------------------------
    // Properties
    //--------------------------------------------------------------------------
    /**
     * Return the length of this VNode.
     */
    get length() {
        return this.children().length;
    }
    is(predicate) {
        if (AbstractNode.isConstructor(predicate)) {
            return this instanceof predicate;
        }
        else {
            return predicate(this);
        }
    }
    /**
     * Test this node against the given predicate.
     *
     * If the predicate is falsy, return true. If the predicate is a constructor
     * of a VNode class, return whether this node is an instance of that class.
     * If the predicate is a standard function, return the result of this
     * function when called with the node as parameter.
     *
     *
     * @param predicate The predicate to test this node against.
     */
    test(predicate) {
        if (!predicate) {
            return true;
        }
        else if (AbstractNode.isConstructor(predicate)) {
            return this instanceof predicate;
        }
        else {
            return predicate(this);
        }
    }
    /**
     * Return true if this VNode comes before the given VNode in the pre-order
     * traversal.
     *
     * @param vNode
     */
    isBefore(vNode) {
        const thisPath = [this, ...this.ancestors()];
        const nodePath = [vNode, ...vNode.ancestors()];
        // Find the last distinct ancestors in the path to the root.
        let thisAncestor;
        let nodeAncestor;
        do {
            thisAncestor = thisPath.pop();
            nodeAncestor = nodePath.pop();
        } while (thisAncestor && nodeAncestor && thisAncestor === nodeAncestor);
        if (thisAncestor && nodeAncestor) {
            const thisParent = thisAncestor.parent;
            const nodeParent = nodeAncestor.parent;
            if (thisParent && thisParent === nodeParent) {
                // Compare the indices of both ancestors in their shared parent.
                const thisIndex = thisParent.childVNodes.indexOf(thisAncestor);
                const nodeIndex = nodeParent.childVNodes.indexOf(nodeAncestor);
                return thisIndex < nodeIndex;
            }
            else {
                // The very first ancestor of both nodes are different so
                // they actually come from two different trees altogether.
                return false;
            }
        }
        else {
            // One of the nodes was in the ancestors path of the other.
            return !thisAncestor && !!nodeAncestor;
        }
    }
    /**
     * Return true if this VNode comes after the given VNode in the pre-order
     * traversal.
     *
     * @param vNode
     */
    isAfter(vNode) {
        return vNode.isBefore(this);
    }
    closest(predicate) {
        if (this.test(predicate)) {
            return this;
        }
        else {
            return this.ancestor(predicate);
        }
    }
    ancestor(predicate) {
        let ancestor = this.parent;
        while (ancestor && !ancestor.test(predicate)) {
            ancestor = ancestor.parent;
        }
        return ancestor;
    }
    ancestors(predicate) {
        const ancestors = [];
        let parent = this.parent;
        while (parent) {
            if (parent.test(predicate)) {
                ancestors.push(parent);
            }
            parent = parent.parent;
        }
        return ancestors;
    }
    commonAncestor(node, predicate) {
        if (!this.parent) {
            return;
        }
        else if (this.parent === node.parent && this.parent.test(predicate)) {
            return this.parent;
        }
        const thisPath = [this, ...this.ancestors(predicate)];
        const nodePath = [node, ...node.ancestors(predicate)];
        let commonAncestor;
        while (thisPath[thisPath.length - 1] === nodePath.pop()) {
            commonAncestor = thisPath.pop();
        }
        return commonAncestor;
    }
    siblings(predicate) {
        const siblings = [];
        let sibling = this.previousSibling();
        while (sibling) {
            if (sibling.test(predicate)) {
                siblings.unshift(sibling);
            }
            sibling = sibling.previousSibling();
        }
        sibling = this.nextSibling();
        while (sibling) {
            if (sibling.test(predicate)) {
                siblings.push(sibling);
            }
            sibling = sibling.nextSibling();
        }
        return siblings;
    }
    adjacents(predicate) {
        const adjacents = [];
        let sibling = this.previousSibling();
        while (sibling && sibling.test(predicate)) {
            adjacents.unshift(sibling);
            sibling = sibling.previousSibling();
        }
        sibling = this.nextSibling();
        while (sibling && sibling.test(predicate)) {
            adjacents.push(sibling);
            sibling = sibling.nextSibling();
        }
        return adjacents;
    }
    previousSibling(predicate) {
        if (!this.parent)
            return;
        const index = this.parent.childVNodes.indexOf(this);
        let sibling = this.parent.childVNodes[index - 1];
        // Skip ignored siblings and those failing the predicate test.
        while (sibling && !(sibling.tangible && sibling.test(predicate))) {
            sibling = sibling.previousSibling();
        }
        return sibling;
    }
    nextSibling(predicate) {
        if (!this.parent)
            return;
        const index = this.parent.childVNodes.indexOf(this);
        let sibling = this.parent.childVNodes[index + 1];
        // Skip ignored siblings and those failing the predicate test.
        while (sibling && !(sibling.tangible && sibling.test(predicate))) {
            sibling = sibling.nextSibling();
        }
        return sibling;
    }
    previous(predicate) {
        let previous = this.previousSibling();
        if (previous) {
            // The previous node is the last leaf of the previous sibling.
            previous = previous.lastLeaf();
        }
        else {
            // If it has no previous sibling then climb up to the parent.
            previous = this.parent;
        }
        while (previous && !previous.test(predicate)) {
            previous = previous.previous();
        }
        return previous;
    }
    next(predicate) {
        // The node after node is its first child.
        let next = this.firstChild();
        if (!next) {
            // If it has no children then it is its next sibling.
            next = this.nextSibling();
        }
        if (!next) {
            // If it has no siblings either then climb up to the closest parent
            // which has a next sibiling.
            let ancestor = this.parent;
            while (ancestor && !ancestor.nextSibling()) {
                ancestor = ancestor.parent;
            }
            next = ancestor && ancestor.nextSibling();
        }
        while (next && !next.test(predicate)) {
            next = next.next();
        }
        return next;
    }
    previousLeaf(predicate) {
        return this.previous((node) => {
            return Object(_VNode__WEBPACK_IMPORTED_MODULE_0__["isLeaf"])(node) && node.test(predicate);
        });
    }
    nextLeaf(predicate) {
        return this.next((node) => {
            return Object(_VNode__WEBPACK_IMPORTED_MODULE_0__["isLeaf"])(node) && node.test(predicate);
        });
    }
    previousSiblings(predicate) {
        const previousSiblings = [];
        let sibling = this.previousSibling();
        while (sibling) {
            if (sibling.test(predicate)) {
                previousSiblings.push(sibling);
            }
            sibling = sibling.previousSibling();
        }
        return previousSiblings;
    }
    nextSiblings(predicate) {
        const nextSiblings = [];
        let sibling = this.nextSibling();
        while (sibling) {
            if (sibling.test(predicate)) {
                nextSiblings.push(sibling);
            }
            sibling = sibling.nextSibling();
        }
        return nextSiblings;
    }
    //--------------------------------------------------------------------------
    // Updating
    //--------------------------------------------------------------------------
    /**
     * Insert the given VNode before this VNode.
     *
     * @param node
     */
    before(node) {
        if (!this.parent) {
            throw 'Cannot insert a VNode before a VNode with no parent.';
        }
        this.parent.insertBefore(node, this);
    }
    /**
     * Insert the given VNode after this VNode.
     *
     * @param node
     */
    after(node) {
        if (!this.parent) {
            throw 'Cannot insert a VNode after a VNode with no parent.';
        }
        this.parent.insertAfter(node, this);
    }
    /**
     * Wrap this node in the given node by inserting the given node at this
     * node's position in its parent and appending this node to the given node.
     *
     * @param node
     */
    wrap(node) {
        this.before(node);
        node.append(this);
    }
    /**
     * Remove this node.
     */
    remove() {
        if (this.parent) {
            this.parent.removeChild(this);
        }
    }
    /**
     * Remove this node in forward direction. (e.g. `Delete` key)
     */
    removeForward() {
        this.remove();
    }
    /**
     * Remove this node in backward direction. (e.g. `Backspace` key)
     */
    removeBackward() {
        this.remove();
    }
    //--------------------------------------------------------------------------
    // Private.
    //--------------------------------------------------------------------------
    /**
     * Return a convenient string representation of this node and its
     * descendants.
     *
     * @param __repr
     * @param level
     */
    _repr(__repr = '', level = 0) {
        __repr += Array(level * 4 + 1).join(' ') + this.name + ' (' + this.id + ')' + '\n';
        this.childVNodes.forEach(child => {
            __repr = child._repr(__repr, level + 1);
        });
        return __repr;
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/AtomicNode.ts":
/*!************************************************!*\
  !*** ./packages/core/src/VNodes/AtomicNode.ts ***!
  \************************************************/
/*! exports provided: AtomicNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AtomicNode", function() { return AtomicNode; });
/* harmony import */ var _AbstractNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/src/errors */ "./packages/utils/src/errors.ts");


/**
 * This class provides typing overrides for multiple VNode methods which are
 * supposed to take parameters but that are unused in the case of atomic nodes.
 */
/* eslint-disable @typescript-eslint/no-unused-vars */
class AtomicNode extends _AbstractNode__WEBPACK_IMPORTED_MODULE_0__["AbstractNode"] {
    get childVNodes() {
        return [];
    }
    children(predicate) {
        return [];
    }
    /**
     * See {@link AbstractNode.hasChildren}.
     *
     * @return Returns `false` since an atomic node cannot have children.
     */
    hasChildren() {
        return false;
    }
    /**
     * See {@link AbstractNode.nthChild}.
     *
     * @return Returns `undefined` since an atomic node cannot have children.
     */
    nthChild(n) {
        return undefined;
    }
    firstChild(predicate) {
        return undefined;
    }
    lastChild(predicate) {
        return undefined;
    }
    firstLeaf(predicate) {
        return this;
    }
    lastLeaf(predicate) {
        return this;
    }
    firstDescendant(predicate) {
        return undefined;
    }
    lastDescendant(predicate) {
        return undefined;
    }
    descendants(predicate) {
        return [];
    }
    //--------------------------------------------------------------------------
    // Updating children.
    //--------------------------------------------------------------------------
    /**
     * See {@link AbstractNode.prepend}.
     *
     * @throws AtomicityError An atomic node cannot have children.
     */
    prepend(...children) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
     * See {@link AbstractNode.prepend}.
     *
     * @throws AtomicityError An atomic node cannot have children.
     */
    append(...children) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
   /**
     * See {@link AbstractNode.insertBefore}.
     *
     * @throws AtomicityError An atomic node cannot have children.
     */
    insertBefore(node, reference) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
     * See {@link AbstractNode.insertAfter}.
     *
     * @throws AtomicityError An atomic node cannot have children.
     */
    insertAfter(node, reference) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
     * See {@link AbstractNode.empty}.
     */
    empty() {
        return;
    }
    /**
     * See {@link AbstractNode.removeChild}.
     *
     * @throws AtomicityError An atomic node cannot have children.
     */
    removeChild(child) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
     * See {@link AbstractNode.splitAt}.
     *
     * @throws AtomicityError An atomic node cannot be split.
     */
    splitAt(child) {
        throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_1__["AtomicityError"](this);
    }
    /**
     * See {@link AbstractNode.mergeWith}.
     */
    mergeWith(newContainer) {
        return;
    }
    /**
     * See {@link AbstractNode.unwrap}.
     */
    unwrap() {
        return;
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/ContainerNode.ts":
/*!***************************************************!*\
  !*** ./packages/core/src/VNodes/ContainerNode.ts ***!
  \***************************************************/
/*! exports provided: ContainerNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContainerNode", function() { return ContainerNode; });
/* harmony import */ var _AbstractNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _utils_src_errors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../utils/src/errors */ "./packages/utils/src/errors.ts");



class ContainerNode extends _AbstractNode__WEBPACK_IMPORTED_MODULE_0__["AbstractNode"] {
    constructor() {
        super(...arguments);
        this.childVNodes = [];
    }
    children(predicate) {
        return this.childVNodes.filter(child => {
            return child.tangible && child.test(predicate);
        });
    }
    /**
     * See {@link AbstractNode.hasChildren}.
     */
    hasChildren() {
        return this.children().length > 0;
    }
    /**
     * See {@link AbstractNode.nthChild}.
     */
    nthChild(n) {
        return this.children()[n - 1];
    }
    firstChild(predicate) {
        let child = this.childVNodes[0];
        while (child && !(child.tangible && child.test(predicate))) {
            child = child.nextSibling();
        }
        return child;
    }
    lastChild(predicate) {
        let child = this.childVNodes[this.childVNodes.length - 1];
        while (child && !(child.tangible && child.test(predicate))) {
            child = child.previousSibling();
        }
        return child;
    }
    firstLeaf(predicate) {
        const isValidLeaf = (node) => {
            return Object(_VNode__WEBPACK_IMPORTED_MODULE_1__["isLeaf"])(node) && node.test(predicate);
        };
        if (isValidLeaf(this)) {
            return this;
        }
        else {
            return this.firstDescendant((node) => isValidLeaf(node));
        }
    }
    lastLeaf(predicate) {
        const isValidLeaf = (node) => {
            return Object(_VNode__WEBPACK_IMPORTED_MODULE_1__["isLeaf"])(node) && node.test(predicate);
        };
        if (isValidLeaf(this)) {
            return this;
        }
        else {
            return this.lastDescendant((node) => isValidLeaf(node));
        }
    }
    firstDescendant(predicate) {
        let firstDescendant = this.firstChild();
        while (firstDescendant && !firstDescendant.test(predicate)) {
            firstDescendant = this._descendantAfter(firstDescendant);
        }
        return firstDescendant;
    }
    lastDescendant(predicate) {
        let lastDescendant = this.lastChild();
        while (lastDescendant && lastDescendant.hasChildren()) {
            lastDescendant = lastDescendant.lastChild();
        }
        while (lastDescendant && !lastDescendant.test(predicate)) {
            lastDescendant = this._descendantBefore(lastDescendant);
        }
        return lastDescendant;
    }
    descendants(predicate) {
        const descendants = [];
        let currentDescendant = this.firstChild();
        while (currentDescendant) {
            if (currentDescendant.test(predicate)) {
                descendants.push(currentDescendant);
            }
            currentDescendant = this._descendantAfter(currentDescendant);
        }
        return descendants;
    }
    //--------------------------------------------------------------------------
    // Updating
    //--------------------------------------------------------------------------
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     */
    clone(deepClone, params) {
        const clone = super.clone(params);
        if (deepClone) {
            for (const child of this.childVNodes) {
                clone.append(child.clone(true));
            }
        }
        return clone;
    }
    /**
     * See {@link AbstractNode.prepend}.
     */
    prepend(...children) {
        for (const child of children) {
            this._insertAtIndex(child, 0);
        }
    }
    /**
     * See {@link AbstractNode.append}.
     */
    append(...children) {
        for (const child of children) {
            this._insertAtIndex(child, this.childVNodes.length);
        }
    }
    /**
     * See {@link AbstractNode.insertBefore}.
     */
    insertBefore(node, reference) {
        const index = this.childVNodes.indexOf(reference);
        if (index < 0) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_2__["ChildError"](this, node);
        }
        this._insertAtIndex(node, index);
    }
    /**
     * See {@link AbstractNode.insertAfter}.
     */
    insertAfter(node, reference) {
        const index = this.childVNodes.indexOf(reference);
        if (index < 0) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_2__["ChildError"](this, node);
        }
        this._insertAtIndex(node, index + 1);
    }
    /**
     * See {@link AbstractNode.empty}.
     */
    empty() {
        for (const child of this.childVNodes) {
            child.remove();
        }
    }
    /**
     * See {@link AbstractNode.removeChild}.
     */
    removeChild(child) {
        const index = this.childVNodes.indexOf(child);
        if (index < 0) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_2__["ChildError"](this, child);
        }
        this._removeAtIndex(index);
    }
    /**
     * See {@link AbstractNode.splitAt}.
     */
    splitAt(child) {
        if (child.parent !== this) {
            throw new _utils_src_errors__WEBPACK_IMPORTED_MODULE_2__["ChildError"](this, child);
        }
        else if (!this.breakable) {
            // Unbreakable nodes do not split.
            return this;
        }
        const duplicate = this.clone();
        const index = child.parent.childVNodes.indexOf(child);
        while (this.childVNodes.length > index) {
            duplicate.append(this.childVNodes[index]);
        }
        this.after(duplicate);
        return duplicate;
    }
    /**
     * See {@link AbstractNode.mergeWith}.
     */
    mergeWith(newContainer) {
        if (newContainer !== this) {
            if (newContainer.childVNodes.includes(this)) {
                for (const child of this.childVNodes.slice()) {
                    newContainer.insertBefore(child, this);
                }
            }
            else {
                newContainer.append(...this.childVNodes);
            }
            this.remove();
        }
    }
    /**
     * See {@link AbstractNode.unwrap}.
     */
    unwrap() {
        for (const child of this.childVNodes.slice()) {
            this.before(child);
        }
        this.remove();
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return the descendant of this node that directly precedes the given node
     * in depth-first pre-order traversal.
     *
     * @param node
     */
    _descendantBefore(node) {
        let previous = node.previousSibling();
        if (previous) {
            // The node before node is the last leaf of its previous sibling.
            previous = previous.lastLeaf();
        }
        else if (node.parent !== this) {
            // If it has no previous sibling then climb up to the parent.
            // This is similar to `previous` but can't go further than `this`.
            previous = node.parent;
        }
        return previous;
    }
    /**
     * Return the descendant of this node that directly follows the given node
     * in depth-first pre-order traversal.
     *
     * @param node
     */
    _descendantAfter(node) {
        // The node after node is its first child.
        let next = node.firstChild();
        if (!next) {
            // If it has no children then it is its next sibling.
            next = node.nextSibling();
        }
        if (!next) {
            // If it has no siblings either then climb up to the closest parent
            // which has a next sibiling.
            // This is similar to `next` but can't go further than `this`.
            let ancestor = node.parent;
            while (ancestor !== this && !ancestor.nextSibling()) {
                ancestor = ancestor.parent;
            }
            if (ancestor !== this) {
                next = ancestor.nextSibling();
            }
        }
        return next;
    }
    /**
     * Insert a VNode at the given index within this VNode's children.
     *
     * @param child
     * @param index The index at which the insertion must take place within this
     * VNode's parent, holding marker nodes into account.
     */
    _insertAtIndex(child, index) {
        if (child.parent) {
            const currentIndex = child.parent.childVNodes.indexOf(child);
            if (index && child.parent === this && currentIndex < index) {
                index--;
            }
            child.parent.removeChild(child);
        }
        this.childVNodes.splice(index, 0, child);
        child.parent = this;
    }
    /**
     * Remove the nth child from this node.
     *
     * @param index The index of the child to remove including marker nodes.
     */
    _removeAtIndex(index) {
        const child = this.childVNodes.splice(index, 1)[0];
        child.parent = undefined;
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/FragmentNode.ts":
/*!**************************************************!*\
  !*** ./packages/core/src/VNodes/FragmentNode.ts ***!
  \**************************************************/
/*! exports provided: FragmentNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FragmentNode", function() { return FragmentNode; });
/* harmony import */ var _ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class FragmentNode extends _ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor() {
        super(...arguments);
        this.editable = true;
        this.breakable = false;
    }
    set parent(parent) {
        this.mergeWith(parent);
        parent.removeChild(this);
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/MarkerNode.ts":
/*!************************************************!*\
  !*** ./packages/core/src/VNodes/MarkerNode.ts ***!
  \************************************************/
/*! exports provided: MarkerNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MarkerNode", function() { return MarkerNode; });
/* harmony import */ var _AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class MarkerNode extends _AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor() {
        super(...arguments);
        this.tangible = false;
    }
}
MarkerNode.atomic = true;


/***/ }),

/***/ "./packages/core/src/VNodes/SeparatorNode.ts":
/*!***************************************************!*\
  !*** ./packages/core/src/VNodes/SeparatorNode.ts ***!
  \***************************************************/
/*! exports provided: SeparatorNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SeparatorNode", function() { return SeparatorNode; });
/* harmony import */ var _AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

/**
 * This class represents an atomic node that is used as a content separator.
 */
class SeparatorNode extends _AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
}


/***/ }),

/***/ "./packages/core/src/VNodes/VElement.ts":
/*!**********************************************!*\
  !*** ./packages/core/src/VNodes/VElement.ts ***!
  \**********************************************/
/*! exports provided: VElement */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VElement", function() { return VElement; });
/* harmony import */ var _ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class VElement extends _ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor(params) {
        super();
        this.htmlTag = params.htmlTag;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     */
    clone(deepClone, params) {
        const defaults = {
            htmlTag: this.htmlTag,
        };
        return super.clone(deepClone, { ...defaults, ...params });
    }
}


/***/ }),

/***/ "./packages/core/src/VNodes/VNode.ts":
/*!*******************************************!*\
  !*** ./packages/core/src/VNodes/VNode.ts ***!
  \*******************************************/
/*! exports provided: RelativePosition, isLeaf */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RelativePosition", function() { return RelativePosition; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isLeaf", function() { return isLeaf; });
var RelativePosition;
(function (RelativePosition) {
    RelativePosition["BEFORE"] = "BEFORE";
    RelativePosition["AFTER"] = "AFTER";
    RelativePosition["INSIDE"] = "INSIDE";
})(RelativePosition || (RelativePosition = {}));
/**
 * Return true if the given node is a leaf in the VDocument, that is a node that
 * has no children.
 *
 * @param node node to check
 */
function isLeaf(node) {
    return !node.hasChildren();
}


/***/ }),

/***/ "./packages/core/src/VRange.ts":
/*!*************************************!*\
  !*** ./packages/core/src/VRange.ts ***!
  \*************************************/
/*! exports provided: VRange, withRange */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VRange", function() { return VRange; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "withRange", function() { return withRange; });
/* harmony import */ var _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./VNodes/MarkerNode */ "./packages/core/src/VNodes/MarkerNode.ts");
/* harmony import */ var _VNodes_FragmentNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./VNodes/FragmentNode */ "./packages/core/src/VNodes/FragmentNode.ts");
/* harmony import */ var _VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");





class VRange {
    constructor(boundaryPoints) {
        this.start = new _VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_1__["MarkerNode"]();
        this.end = new _VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_1__["MarkerNode"]();
        // If a range context is given, adapt this range to match it.
        if (boundaryPoints) {
            const [start, end] = boundaryPoints;
            const [startNode, startPosition] = start;
            const [endNode, endPosition] = end;
            if (endPosition === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
                this.setEnd(endNode, endPosition);
                this.setStart(startNode, startPosition);
            }
            else {
                this.setStart(startNode, startPosition);
                this.setEnd(endNode, endPosition);
            }
        }
    }
    /**
     * Return the context of a collapsed range at the given location, targetting
     * a reference VNode and specifying the position relative to that VNode.
     *
     * @param reference
     * @param position
     */
    static at(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE) {
        return VRange.selecting(reference, position, reference, position);
    }
    /**
     * Return the context of a range at the location of the given range.
     *
     * @param range
     */
    static clone(range) {
        return [
            [range.start, _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE],
            [range.end, _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER],
        ];
    }
    static selecting(startNode, startPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE, endNode = startNode, endPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
        if (startPosition instanceof _VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_4__["AbstractNode"]) {
            endNode = startPosition;
            startPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
        }
        return [
            [startNode, startPosition],
            [endNode, endPosition],
        ];
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    get startContainer() {
        return this.start.parent;
    }
    get endContainer() {
        return this.end.parent;
    }
    /**
     * Return true if the range is collapsed.
     */
    isCollapsed() {
        if (!this.startContainer || !this.endContainer)
            return;
        const startIndex = this.start.parent.childVNodes.indexOf(this.start);
        return this.startContainer.childVNodes[startIndex + 1] === this.end;
    }
    selectedNodes(predicate) {
        const selectedNodes = [];
        let node = this.start;
        const bound = this.end.next();
        const endContainers = this.end.ancestors();
        while ((node = node.next()) && node !== bound) {
            if (!endContainers.includes(node)) {
                let selectedNode = node;
                while (!(selectedNode === null || selectedNode === void 0 ? void 0 : selectedNode.test(_VNodes_FragmentNode__WEBPACK_IMPORTED_MODULE_2__["FragmentNode"])) && (selectedNode === null || selectedNode === void 0 ? void 0 : selectedNode.test(predicate))) {
                    if (selectedNode.editable) {
                        selectedNodes.push(selectedNode);
                    }
                    // Find the next ancestor whose children are all selected
                    // and add it to the list.
                    selectedNode = selectedNode.ancestor(ancestor => {
                        return ancestor.children().every(child => {
                            return selectedNodes.includes(child);
                        });
                    });
                }
            }
        }
        return selectedNodes;
    }
    targetedNodes(predicate) {
        const targetedNodes = this.traversedNodes(predicate);
        const closestStartAncestor = this.start.ancestor(predicate);
        if (closestStartAncestor === null || closestStartAncestor === void 0 ? void 0 : closestStartAncestor.editable) {
            targetedNodes.unshift(closestStartAncestor);
        }
        else if (closestStartAncestor) {
            const children = [...closestStartAncestor.childVNodes].reverse();
            for (const child of children) {
                if (!targetedNodes.includes(child) && child.test(predicate)) {
                    targetedNodes.unshift(child);
                }
            }
        }
        return targetedNodes;
    }
    traversedNodes(predicate) {
        const traversedNodes = [];
        let node = this.start;
        const bound = this.end.next();
        while ((node = node.next()) && node !== bound) {
            if (node.editable && node.test(predicate)) {
                traversedNodes.push(node);
            }
        }
        return traversedNodes;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Collapse the range.
     *
     * @param [edge] range edge on which to collapse
     */
    collapse(edge = this.start) {
        if (edge === this.start) {
            this.setEnd(edge);
        }
        else if (edge === this.end) {
            this.setStart(edge);
        }
    }
    /**
     * Set the range's start point (in traversal order) at the given location,
     * targetting a `reference` VNode and specifying the `position` in reference
     * to that VNode ('BEFORE', 'AFTER'), like in an `xpath.
     *
     * @param reference
     * @param [position]
     */
    setStart(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE) {
        if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE) {
            reference = reference.firstLeaf();
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
            reference = reference.lastLeaf();
        }
        if (reference.is(_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__["ContainerNode"]) && !reference.hasChildren()) {
            reference.prepend(this.start);
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER && reference !== this.end) {
            // We check that `reference` isn't `this.end` to avoid a backward
            // collapsed range.
            reference.after(this.start);
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE) {
            reference.append(this.start);
        }
        else {
            reference.before(this.start);
        }
    }
    /**
     * Set the range's end point (in traversal order) at the given location,
     * targetting a `reference` VNode and specifying the `position` in reference
     * to that VNode ('BEFORE', 'AFTER'), like in an `xpath.
     *
     * @param reference
     * @param [position]
     */
    setEnd(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
        if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE) {
            reference = reference.firstLeaf();
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
            reference = reference.lastLeaf();
        }
        if (reference.is(_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__["ContainerNode"]) && !reference.hasChildren()) {
            reference.append(this.end);
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE && reference !== this.start) {
            // We check that `reference` isn't `this.start` to avoid a backward
            // collapsed range.
            reference.before(this.end);
        }
        else if (position === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE) {
            reference.append(this.end);
        }
        else {
            reference.after(this.end);
        }
    }
    /**
     * Extend this range in such a way that it includes the given node.
     *
     * This method moves the boundary marker that is closest to the given node
     * up or down the tree in order to include the given node into the range.
     * Because of that, calling this method will always result in a range that
     * is at least the size that it was prior to calling it, and usually bigger.
     *
     * @param targetNode The node to extend the range to.
     */
    extendTo(targetNode) {
        let position;
        if (targetNode.isBefore(this.start)) {
            targetNode = targetNode.previous();
            if (targetNode.hasChildren()) {
                targetNode = targetNode.firstLeaf();
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
            }
            else {
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER;
            }
            if (targetNode && this.end.nextSibling() !== targetNode) {
                this.setStart(targetNode, position);
            }
        }
        else if (targetNode.isAfter(this.end)) {
            if (targetNode.hasChildren()) {
                targetNode = targetNode.next();
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
            }
            else {
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER;
            }
            if (targetNode) {
                this.setEnd(targetNode, position);
            }
        }
    }
    /**
     * Split the range containers up to their common ancestor. Return all
     * children of the common ancestor that are targeted by the range after the
     * split. If a predicate is given, splitting continues up to and including
     * the node closest to the common ancestor that matches the predicate.
     *
     * @param predicate
     */
    split(predicate) {
        const ancestor = this.startContainer.commonAncestor(this.endContainer);
        const closest = ancestor.closest(predicate);
        const container = closest ? closest.parent : ancestor;
        // Split the start ancestors.
        let start = this.start;
        do {
            let startAncestor = start.parent;
            // Do not split at the start edge of a node.
            if (start.previousSibling()) {
                startAncestor = startAncestor.splitAt(start);
            }
            start = startAncestor;
        } while (start.parent !== container);
        // Split the end ancestors.
        let end = this.end;
        do {
            const endAncestor = end.parent;
            // Do not split at the end edge of a node.
            if (end.nextSibling()) {
                endAncestor.splitAt(end);
                endAncestor.append(end);
            }
            end = endAncestor;
        } while (end.parent !== container);
        // Return all top-most split nodes between and including start and end.
        const nodes = [];
        let node = start;
        while (node !== end) {
            nodes.push(node);
            node = node.nextSibling();
        }
        nodes.push(end);
        return nodes;
    }
    /**
     * Empty the range by removing selected nodes and collapsing it by merging
     * nodes between start and end.
     */
    empty() {
        const removableNodes = this.selectedNodes(node => {
            var _a, _b;
            // TODO: Replace this check by complex table selection support.
            return node.breakable || ((_a = node.parent) === null || _a === void 0 ? void 0 : _a.breakable) || ((_b = node.parent) === null || _b === void 0 ? void 0 : _b.is(_VNodes_FragmentNode__WEBPACK_IMPORTED_MODULE_2__["FragmentNode"]));
        });
        // Remove selected nodes without touching the start range's ancestors.
        const startAncestors = this.start.ancestors();
        for (const node of removableNodes.filter(node => !startAncestors.includes(node))) {
            node.remove();
        }
        // Collapse the range by merging nodes between start and end.
        if (this.startContainer !== this.endContainer) {
            const commonAncestor = this.start.commonAncestor(this.end);
            let ancestor = this.endContainer.parent;
            while (ancestor !== commonAncestor) {
                if (ancestor.children().length > 1) {
                    ancestor.splitAt(this.endContainer);
                }
                if (this.endContainer.breakable) {
                    this.endContainer.mergeWith(ancestor);
                }
                ancestor = ancestor.parent;
            }
            if (this.endContainer.breakable) {
                this.endContainer.mergeWith(this.startContainer);
            }
        }
    }
    /**
     * Remove this range from its VDocument.
     */
    remove() {
        this.start.remove();
        this.end.remove();
    }
}
/**
 * Create a temporary range corresponding to the given boundary points and
 * call the given callback with the newly created range as argument. The
 * range is automatically destroyed after calling the callback.
 *
 * @param bounds The points corresponding to the range boundaries.
 * @param callback The callback to call with the newly created range.
 */
async function withRange(bounds, callback) {
    const range = new VRange(bounds);
    const result = await callback(range);
    range.remove();
    return result;
}


/***/ }),

/***/ "./packages/core/src/VSelection.ts":
/*!*****************************************!*\
  !*** ./packages/core/src/VSelection.ts ***!
  \*****************************************/
/*! exports provided: ANCHOR_CHAR, FOCUS_CHAR, Direction, VSelection */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ANCHOR_CHAR", function() { return ANCHOR_CHAR; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FOCUS_CHAR", function() { return FOCUS_CHAR; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Direction", function() { return Direction; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "VSelection", function() { return VSelection; });
/* harmony import */ var _VRange__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./VRange */ "./packages/core/src/VRange.ts");
/* harmony import */ var _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");



const ANCHOR_CHAR = '[';
const FOCUS_CHAR = ']';
var Direction;
(function (Direction) {
    Direction["BACKWARD"] = "BACKWARD";
    Direction["FORWARD"] = "FORWARD";
})(Direction || (Direction = {}));
class VSelection {
    constructor() {
        this.range = new _VRange__WEBPACK_IMPORTED_MODULE_0__["VRange"]();
        this._direction = Direction.FORWARD;
    }
    get anchor() {
        return this.direction === Direction.FORWARD ? this.range.start : this.range.end;
    }
    get focus() {
        return this.direction === Direction.FORWARD ? this.range.end : this.range.start;
    }
    get direction() {
        return this._direction;
    }
    isCollapsed() {
        return this.range.isCollapsed();
    }
    /**
     * Update the selection according to the given description.
     *
     * @param selection
     */
    set(selection) {
        this._direction = selection.direction;
        this.select(selection.anchorNode, selection.anchorPosition, selection.focusNode, selection.focusPosition);
    }
    /**
     * Set a collapsed selection at the given location, targetting a `reference`
     * VNode and specifying the `position` in reference to that VNode ('BEFORE',
     * 'AFTER'), like in an `xpath`.
     *
     * @param position
     * @param reference
     */
    setAt(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE) {
        this.setAnchor(reference, position);
        this.collapse();
    }
    select(anchorNode, anchorPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE, focusNode = anchorNode, focusPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER) {
        if (anchorPosition instanceof _VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]) {
            focusNode = anchorPosition;
            anchorPosition = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE;
        }
        if (focusPosition === _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER) {
            this.setFocus(focusNode, focusPosition);
            this.setAnchor(anchorNode, anchorPosition);
        }
        else {
            this.setAnchor(anchorNode, anchorPosition);
            this.setFocus(focusNode, focusPosition);
        }
    }
    /**
     * Set the anchor of the selection by targetting a `reference` VNode and
     * specifying the `position` in reference to that VNode ('BEFORE', 'AFTER'),
     * like in an `xpath`. If no relative position if given, include the
     * reference node in the selection.
     *
     * @param reference
     * @param [position]
     */
    setAnchor(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE) {
        if (this.direction === Direction.FORWARD) {
            this.range.setStart(reference, position);
        }
        else {
            this.range.setEnd(reference, position);
        }
    }
    /**
     * Set the focus of the selection by targetting a `reference` VNode and
     * specifying the `position` in reference to that VNode ('BEFORE', 'AFTER'),
     * like in an `xpath`. If no relative position if given, include the
     * reference node in the selection.
     *
     * @param reference
     * @param [position]
     */
    setFocus(reference, position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER) {
        if (this.direction === Direction.FORWARD) {
            this.range.setEnd(reference, position);
        }
        else {
            this.range.setStart(reference, position);
        }
    }
    /**
     * Extend the selection from its anchor to the given location, targetting a
     * `reference` VNode and specifying the `direction` of the extension.
     *
     * @param reference
     * @param [direction] default: Direction.FORWARD
     */
    extendTo(reference, direction = Direction.FORWARD) {
        let position;
        if (direction === Direction.FORWARD) {
            if (reference.hasChildren()) {
                reference = reference.next();
                reference = reference.firstLeaf();
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE;
            }
            else {
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER;
            }
        }
        else {
            reference = reference.previous();
            if (reference.hasChildren()) {
                reference = reference.firstLeaf();
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE;
            }
            else {
                position = _VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER;
            }
        }
        if (reference) {
            this.setFocus(reference, position);
        }
    }
    /**
     * Collapse the selection on its anchor.
     *
     */
    collapse() {
        this.range.collapse(this.anchor);
    }
}


/***/ }),

/***/ "./packages/plugin-align/src/Align.ts":
/*!********************************************!*\
  !*** ./packages/plugin-align/src/Align.ts ***!
  \********************************************/
/*! exports provided: AlignType, Align */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AlignType", function() { return AlignType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Align", function() { return Align; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");



var AlignType;
(function (AlignType) {
    AlignType["LEFT"] = "left";
    AlignType["CENTER"] = "center";
    AlignType["RIGHT"] = "right";
    AlignType["JUSTIFY"] = "justify";
})(AlignType || (AlignType = {}));
class Align extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            align: {
                handler: this.align.bind(this),
            },
        };
        this.loadables = {
            shortcuts: [
                {
                    pattern: 'Ctrl+Shift+L',
                    commandId: 'align',
                    commandArgs: { type: AlignType.LEFT },
                },
                {
                    pattern: 'Ctrl+Shift+E',
                    commandId: 'align',
                    commandArgs: { type: AlignType.CENTER },
                },
                {
                    pattern: 'Ctrl+Shift+R',
                    commandId: 'align',
                    commandArgs: { type: AlignType.RIGHT },
                },
                {
                    pattern: 'Ctrl+Shift+J',
                    commandId: 'align',
                    commandArgs: { type: AlignType.JUSTIFY },
                },
            ],
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return true if the given node has the given alignment style. If no type
     * is passed, return true if the given node has an alignment style at all.
     *
     * @param node
     * @param [type]
     */
    static isAligned(node, type) {
        var _a;
        const align = (_a = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"])) === null || _a === void 0 ? void 0 : _a.style.get('text-align');
        return type ? align === null || align === void 0 ? void 0 : align.includes(type) : !!align;
    }
    /**
     * Align text.
     */
    align(params) {
        var _a, _b;
        const nodes = params.context.range.targetedNodes((node) => {
            return node.is(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_1__["ContainerNode"]) || (node.parent && !node.parent.editable);
        });
        const type = params.type;
        for (const node of nodes) {
            const alignedAncestor = node.ancestor(Align.isAligned);
            // Compute current alignment.
            const currentAlignment = (_b = (_a = alignedAncestor === null || alignedAncestor === void 0 ? void 0 : alignedAncestor.modifiers) === null || _a === void 0 ? void 0 : _a.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"])) === null || _b === void 0 ? void 0 : _b.style.get('text-align');
            if (!alignedAncestor || currentAlignment !== type) {
                node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"]).style.set('text-align', type.toLowerCase());
            }
        }
    }
}
Align.dependencies = [];


/***/ }),

/***/ "./packages/plugin-align/src/AlignButtons.ts":
/*!***************************************************!*\
  !*** ./packages/plugin-align/src/AlignButtons.ts ***!
  \***************************************************/
/*! exports provided: AlignLeftButton, AlignCenterButton, AlignRightButton, AlignJustifyButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AlignLeftButton", function() { return AlignLeftButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AlignCenterButton", function() { return AlignCenterButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AlignRightButton", function() { return AlignRightButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AlignJustifyButton", function() { return AlignJustifyButton; });
/* harmony import */ var _Align__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Align */ "./packages/plugin-align/src/Align.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");


function isAligned(node, type) {
    const alignedAncestor = node.ancestor(_Align__WEBPACK_IMPORTED_MODULE_0__["Align"].isAligned);
    return _Align__WEBPACK_IMPORTED_MODULE_0__["Align"].isAligned(alignedAncestor || node, type);
}
const AlignLeftButton = {
    title: 'Align left',
    class: 'fa-align-left',
    commandId: 'align',
    commandArgs: { type: _Align__WEBPACK_IMPORTED_MODULE_0__["AlignType"].LEFT },
    selected: (editor) => {
        return editor.selection.range
            .targetedNodes(node => node.is(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_1__["ContainerNode"]))
            .every(node => isAligned(node, _Align__WEBPACK_IMPORTED_MODULE_0__["AlignType"].LEFT));
    },
};
const AlignCenterButton = {
    title: 'Align center',
    class: 'fa-align-center',
    commandId: 'align',
    commandArgs: { type: _Align__WEBPACK_IMPORTED_MODULE_0__["AlignType"].CENTER },
    selected: (editor) => {
        return editor.selection.range
            .targetedNodes(node => node.is(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_1__["ContainerNode"]))
            .every(node => isAligned(node, _Align__WEBPACK_IMPORTED_MODULE_0__["AlignType"].CENTER));
    },
};
const AlignRightButton = {
    title: 'Align right',
    class: 'fa-align-right',
    commandId: 'align',
    commandArgs: { type: _Align__WEBPACK_IMPORTED_MODULE_0__["AlignType"].RIGHT },
    selected: (editor) => {
        return editor.selection.range
            .targetedNodes(node => node.is(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_1__["ContainerNode"]))
            .every(node => isAligned(node, _Align__WEBPACK_IMPORTED_MODULE_0__["AlignType"].RIGHT));
    },
};
const AlignJustifyButton = {
    title: 'Align justify',
    class: 'fa-align-justify',
    commandId: 'align',
    commandArgs: { type: _Align__WEBPACK_IMPORTED_MODULE_0__["AlignType"].JUSTIFY },
    selected: (editor) => {
        return editor.selection.range
            .targetedNodes(node => node.is(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_1__["ContainerNode"]))
            .every(node => isAligned(node, _Align__WEBPACK_IMPORTED_MODULE_0__["AlignType"].JUSTIFY));
    },
};


/***/ }),

/***/ "./packages/plugin-backgroundcolor/src/BackgroundColor.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-backgroundcolor/src/BackgroundColor.ts ***!
  \****************************************************************/
/*! exports provided: BackgroundColor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BackgroundColor", function() { return BackgroundColor; });
/* harmony import */ var _plugin_color_src_Color__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-color/src/Color */ "./packages/plugin-color/src/Color.ts");

class BackgroundColor extends _plugin_color_src_Color__WEBPACK_IMPORTED_MODULE_0__["Color"] {
    constructor() {
        super(...arguments);
        this.styleName = 'background-color';
        this.configuration = { defaultColor: 'white', ...this.configuration };
        this.commands = {
            colorBackground: {
                handler: this.color,
            },
            uncolorBackground: {
                handler: this.uncolor,
            },
        };
        this.loadables = {
            shortcuts: [
                {
                    pattern: 'CTRL+H',
                    commandId: 'colorBackground',
                    // TODO: use dialog to get params
                    commandArgs: {
                        color: 'yellow',
                    },
                },
                {
                    pattern: 'CTRL+SHIFT+H',
                    commandId: 'uncolorBackground',
                },
            ],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-blockquote/src/Blockquote.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-blockquote/src/Blockquote.ts ***!
  \******************************************************/
/*! exports provided: Blockquote */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Blockquote", function() { return Blockquote; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _BlockquoteXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BlockquoteXmlDomParser */ "./packages/plugin-blockquote/src/BlockquoteXmlDomParser.ts");


class Blockquote extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_BlockquoteXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["BlockquoteXmlDomParser"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-blockquote/src/BlockquoteNode.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-blockquote/src/BlockquoteNode.ts ***!
  \**********************************************************/
/*! exports provided: BlockquoteNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlockquoteNode", function() { return BlockquoteNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class BlockquoteNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor() {
        super({ htmlTag: 'BLOCKQUOTE' });
    }
}


/***/ }),

/***/ "./packages/plugin-blockquote/src/BlockquoteXmlDomParser.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-blockquote/src/BlockquoteXmlDomParser.ts ***!
  \******************************************************************/
/*! exports provided: BlockquoteXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BlockquoteXmlDomParser", function() { return BlockquoteXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _BlockquoteNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./BlockquoteNode */ "./packages/plugin-blockquote/src/BlockquoteNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class BlockquoteXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'BLOCKQUOTE';
        };
    }
    async parse(item) {
        const blockquote = new _BlockquoteNode__WEBPACK_IMPORTED_MODULE_2__["BlockquoteNode"]();
        blockquote.modifiers.append(this.engine.parseAttributes(item));
        const nodes = await this.engine.parse(...item.childNodes);
        blockquote.append(...nodes);
        return [blockquote];
    }
}
BlockquoteXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-bold/src/Bold.ts":
/*!******************************************!*\
  !*** ./packages/plugin-bold/src/Bold.ts ***!
  \******************************************/
/*! exports provided: Bold */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Bold", function() { return Bold; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _BoldFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BoldFormat */ "./packages/plugin-bold/src/BoldFormat.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _BoldXmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./BoldXmlDomParser */ "./packages/plugin-bold/src/BoldXmlDomParser.ts");




class Bold extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_BoldXmlDomParser__WEBPACK_IMPORTED_MODULE_3__["BoldXmlDomParser"]],
            shortcuts: [
                {
                    pattern: 'CTRL+B',
                    commandId: 'toggleFormat',
                    commandArgs: { FormatClass: _BoldFormat__WEBPACK_IMPORTED_MODULE_1__["BoldFormat"] },
                },
            ],
        };
    }
}
Bold.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-bold/src/BoldButtons.ts":
/*!*************************************************!*\
  !*** ./packages/plugin-bold/src/BoldButtons.ts ***!
  \*************************************************/
/*! exports provided: BoldButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BoldButton", function() { return BoldButton; });
/* harmony import */ var _BoldFormat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BoldFormat */ "./packages/plugin-bold/src/BoldFormat.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");


const BoldButton = {
    title: 'Toggle bold',
    class: 'fa-bold',
    commandId: 'toggleFormat',
    commandArgs: { FormatClass: _BoldFormat__WEBPACK_IMPORTED_MODULE_0__["BoldFormat"] },
    selected: (editor) => editor.plugins.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]).isAllFormat(_BoldFormat__WEBPACK_IMPORTED_MODULE_0__["BoldFormat"]),
};


/***/ }),

/***/ "./packages/plugin-bold/src/BoldFormat.ts":
/*!************************************************!*\
  !*** ./packages/plugin-bold/src/BoldFormat.ts ***!
  \************************************************/
/*! exports provided: BoldFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BoldFormat", function() { return BoldFormat; });
/* harmony import */ var _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/Format */ "./packages/plugin-inline/src/Format.ts");

class BoldFormat extends _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor(htmlTag = 'B') {
        super(htmlTag);
    }
}


/***/ }),

/***/ "./packages/plugin-bold/src/BoldXmlDomParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-bold/src/BoldXmlDomParser.ts ***!
  \******************************************************/
/*! exports provided: BoldXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BoldXmlDomParser", function() { return BoldXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatParser */ "./packages/plugin-inline/src/FormatParser.ts");
/* harmony import */ var _BoldFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./BoldFormat */ "./packages/plugin-bold/src/BoldFormat.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class BoldXmlDomParser extends _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__["FormatParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'B' || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'STRONG');
        };
    }
    /**
     * Parse a bold node.
     *
     * @param item
     */
    async parse(item) {
        const bold = new _BoldFormat__WEBPACK_IMPORTED_MODULE_1__["BoldFormat"](Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item));
        bold.modifiers.append(this.engine.parseAttributes(item));
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(bold, children);
        return children;
    }
}
BoldXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-char/src/Char.ts":
/*!******************************************!*\
  !*** ./packages/plugin-char/src/Char.ts ***!
  \******************************************/
/*! exports provided: Char */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Char", function() { return Char; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _CharNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _CharFormatHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./CharFormatHtmlDomRenderer */ "./packages/plugin-char/src/CharFormatHtmlDomRenderer.ts");
/* harmony import */ var _CharHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./CharHtmlDomRenderer */ "./packages/plugin-char/src/CharHtmlDomRenderer.ts");
/* harmony import */ var _CharXmlDomParser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./CharXmlDomParser */ "./packages/plugin-char/src/CharXmlDomParser.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");









class Char extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_CharXmlDomParser__WEBPACK_IMPORTED_MODULE_5__["CharXmlDomParser"]],
            renderers: [_CharFormatHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_3__["CharFormatHtmlDomRenderer"], _CharHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_4__["CharHtmlDomRenderer"]],
        };
        this.commands = {
            insertText: {
                handler: this.insertText,
            },
            insertHtml: {
                handler: this.insertHtml.bind(this),
            },
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Insert text at the current position of the selection.
     *
     * If the selection is collapsed, add `text` to the vDocument and copy the
     * formating of the previous char or the next char.
     *
     * If the selection is not collapsed, replace the text with the formating
     * that was present in the selection.
     *
     * @param params
     */
    insertText(params) {
        const range = params.context.range;
        const text = params.text;
        const inline = this.editor.plugins.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]);
        const modifiers = inline.getCurrentModifiers(range);
        if (params.formats) {
            modifiers.replaceOrAppend(params.formats);
        }
        const style = inline.getCurrentStyle(range);
        // Remove the contents of the range if needed.
        console.log('!range.isCollapsed():', !range.isCollapsed());
        if (!range.isCollapsed()) {
            range.empty();
        }
        // Split the text into CHAR nodes and insert them at the range.
        const characters = text.split('');
        const charNodes = characters.map(char => {
            return new _CharNode__WEBPACK_IMPORTED_MODULE_1__["CharNode"]({ char: char, modifiers: modifiers.clone() });
        });
        charNodes.forEach(charNode => {
            charNode.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_7__["Attributes"]).style = style;
            range.start.before(charNode);
        });
        if (params.select && charNodes.length) {
            this.editor.selection.select(charNodes[0], charNodes[charNodes.length - 1]);
        }
        inline.resetCache();
    }
    async insertHtml(params) {
        const parser = this.editor.plugins.get(_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_6__["Parser"]);
        const domParser = parser && parser.engines['dom/html'];
        if (!domParser) {
            // TODO: remove this when the editor can be instantiated on
            // something else than DOM.
            throw new Error(`No DOM parser installed.`);
        }
        const div = document.createElement('div');
        div.innerHTML = params.html;
        const parsedEditable = await domParser.parse(div);
        const newNodes = parsedEditable[0].children();
        // Remove the contents of the range if needed.
        // todo: use Point or Range but not both.
        const range = params.context.range;
        if (!range.isCollapsed()) {
            range.empty();
        }
        if (params.rangePoint) {
            const [node, position] = params.rangePoint;
            switch (position) {
                case _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_8__["RelativePosition"].BEFORE:
                    newNodes.forEach(node.before.bind(node));
                    break;
                case _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_8__["RelativePosition"].AFTER:
                    [...newNodes].reverse().forEach(node.after.bind(node));
                    break;
                case _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_8__["RelativePosition"].INSIDE:
                    node.append(...newNodes);
                    break;
            }
        }
        else {
            newNodes.forEach(range.start.before.bind(range.start));
        }
        return newNodes;
    }
}
Char.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-char/src/CharFormatHtmlDomRenderer.ts":
/*!***************************************************************!*\
  !*** ./packages/plugin-char/src/CharFormatHtmlDomRenderer.ts ***!
  \***************************************************************/
/*! exports provided: CharFormatHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharFormatHtmlDomRenderer", function() { return CharFormatHtmlDomRenderer; });
/* harmony import */ var _plugin_inline_src_FormatDomRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatDomRenderer */ "./packages/plugin-inline/src/FormatDomRenderer.ts");
/* harmony import */ var _CharNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-inline/src/Format */ "./packages/plugin-inline/src/Format.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");





class CharFormatHtmlDomRenderer extends _plugin_inline_src_FormatDomRenderer__WEBPACK_IMPORTED_MODULE_0__["FormatDomRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _CharNode__WEBPACK_IMPORTED_MODULE_1__["CharNode"];
    }
    async render(node) {
        const previousSibling = node.previousSibling();
        if (previousSibling && node.isSameTextNode(previousSibling)) {
            return this.engine.render(previousSibling);
        }
        const textNode = await this.super.render(node);
        // If the node has attributes, wrap it inside a span with those
        // attributes.
        let rendering;
        const attributes = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]);
        if (attributes === null || attributes === void 0 ? void 0 : attributes.length) {
            const span = document.createElement('span');
            this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"], node, span);
            textNode.forEach(child => span.appendChild(child));
            rendering = [span];
        }
        else {
            rendering = textNode;
        }
        return this.renderFormats(node.modifiers.filter(_plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_3__["Format"]), rendering);
    }
}
CharFormatHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-char/src/CharHtmlDomRenderer.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-char/src/CharHtmlDomRenderer.ts ***!
  \*********************************************************/
/*! exports provided: CharHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharHtmlDomRenderer", function() { return CharHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _CharNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");




class CharHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _CharNode__WEBPACK_IMPORTED_MODULE_1__["CharNode"];
    }
    async render(node) {
        // Consecutive compatible char nodes are rendered as a single text node.
        let text = '' + node.char;
        let next = node.nextSibling();
        const charNodes = [node];
        while (next && node.isSameTextNode(next)) {
            if (next instanceof _CharNode__WEBPACK_IMPORTED_MODULE_1__["CharNode"]) {
                charNodes.push(next);
                if (next.char === ' ' && text[text.length - 1] === ' ') {
                    // Browsers don't render consecutive space chars otherwise.
                    text += '\u00A0';
                }
                else {
                    text += next.char;
                }
            }
            next = next.nextSibling();
        }
        // Render block edge spaces as non-breakable space (otherwise browsers
        // won't render them).
        const previous = node.previousSibling();
        if (!previous || !previous.is(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"])) {
            text = text.replace(/^ /g, '\u00A0');
        }
        if (!next || !next.is(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"])) {
            text = text.replace(/ $/g, '\u00A0');
        }
        const rendering = Promise.resolve([document.createTextNode(text)]);
        return this.engine.rendered(charNodes, [this, rendering]);
    }
}
CharHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_3__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-char/src/CharNode.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-char/src/CharNode.ts ***!
  \**********************************************/
/*! exports provided: CharNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharNode", function() { return CharNode; });
/* harmony import */ var _core_src_VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/MarkerNode */ "./packages/core/src/VNodes/MarkerNode.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");


class CharNode extends _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_1__["InlineNode"] {
    constructor(params) {
        super();
        if (params.char.length !== 1) {
            throw new Error('Cannot make a CharNode out of anything else than a string of length 1.');
        }
        this.char = params.char;
        if (params.modifiers) {
            this.modifiers = params.modifiers;
        }
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    get name() {
        return this.char;
    }
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     *
     * @override
     */
    clone(params) {
        const defaults = {
            char: this.char,
            modifiers: this.modifiers.clone(),
        };
        return super.clone({ ...defaults, ...params });
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return the length of this VNode.
     */
    get length() {
        return 1;
    }
    /**
     * Return the text content of this node.
     *
     * @override
     */
    get textContent() {
        return this.char;
    }
    /**
     * Return true if `a` has the same format properties as `b`.
     *
     * @param a
     * @param b
     */
    isSameTextNode(node) {
        if (this.is(CharNode) && node.is(CharNode)) {
            // Char VNodes are the same text node if they have the same
            // modifiers.
            return this.modifiers.areSameAs(node.modifiers);
        }
        else if (this.is(_core_src_VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_0__["MarkerNode"]) || node.is(_core_src_VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_0__["MarkerNode"])) {
            // A Marker node is always considered to be part of the same text
            // node as another node in the sense that the text node must not
            // be broken up just because it contains a marker.
            return true;
        }
        else {
            // Nodes that are not valid in a text node must end the text node.
            return false;
        }
    }
}
CharNode.atomic = true;


/***/ }),

/***/ "./packages/plugin-char/src/CharXmlDomParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-char/src/CharXmlDomParser.ts ***!
  \******************************************************/
/*! exports provided: CharXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CharXmlDomParser", function() { return CharXmlDomParser; });
/* harmony import */ var _utils_src_formattingSpace__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/src/formattingSpace */ "./packages/utils/src/formattingSpace.ts");
/* harmony import */ var _CharNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");




class CharXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_2__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item.nodeType === Node.TEXT_NODE;
        };
    }
    async parse(item) {
        const nodes = [];
        const text = Object(_utils_src_formattingSpace__WEBPACK_IMPORTED_MODULE_0__["removeFormattingSpace"])(item);
        for (let i = 0; i < text.length; i++) {
            const char = text.charAt(i);
            let parsedVNode;
            if (char === '\n') {
                parsedVNode = new this.engine.editor.configuration.defaults.Separator();
            }
            else {
                parsedVNode = new _CharNode__WEBPACK_IMPORTED_MODULE_1__["CharNode"]({ char: char });
            }
            nodes.push(parsedVNode);
        }
        return nodes;
    }
}
CharXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-color/src/Color.ts":
/*!********************************************!*\
  !*** ./packages/plugin-color/src/Color.ts ***!
  \********************************************/
/*! exports provided: Color */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Color", function() { return Color; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-inline/src/Format */ "./packages/plugin-inline/src/Format.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_xml_src_CssStyle__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-xml/src/CssStyle */ "./packages/plugin-xml/src/CssStyle.ts");







class Color extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    hasColor(color, node) {
        var _a;
        if (color instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]) {
            node = color;
        }
        const nodeBackgroundColor = (_a = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _a === void 0 ? void 0 : _a.style.get(this.styleName);
        if (color instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_2__["AbstractNode"]) {
            return !!nodeBackgroundColor;
        }
        else {
            return nodeBackgroundColor === color;
        }
    }
    /**
     * Apply the given color to the range.
     *
     * @param params
     */
    color(params) {
        var _a;
        const color = params.color;
        if (params.context.range.isCollapsed()) {
            // Set the style cache.
            const inline = this.dependencies.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]);
            const currentCache = inline.cache.style || {};
            inline.cache.style = new _plugin_xml_src_CssStyle__WEBPACK_IMPORTED_MODULE_6__["CssStyle"]({ ...currentCache, [this.styleName]: color });
        }
        else {
            const selectedNodes = params.context.range.selectedNodes();
            // Skip if the node already has the right color, through an
            // ancestor or a format.
            const notColoredYet = selectedNodes.filter(node => {
                if (this.hasColor(color, node))
                    return false;
                const colorAncestor = node.ancestor(this.hasColor.bind(this));
                return !colorAncestor || !this.hasColor(color, colorAncestor);
            });
            for (const node of notColoredYet) {
                // Apply the style to the node or its first format.
                this._nodeOrFirstFormat(node)
                    .modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])
                    .style.set(this.styleName, color);
                // If there are ancestors of this node whose children all have
                // this style, style these ancestors instead of their
                // descendants.
                let parent = node.parent;
                while (parent && parent.editable && this._isAllColored(parent, color)) {
                    parent.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]).style.set(this.styleName, color);
                    // TODO: not remove the children's styles when we have modifiers.
                    for (const child of parent.children()) {
                        (_a = child.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _a === void 0 ? void 0 : _a.style.remove(this.styleName);
                    }
                    parent = parent.parent;
                }
            }
        }
    }
    /**
     * Remove the current color from the range. If the color was applied to
     * an ancestor, apply the default color to its relevant inline descendants.
     *
     * @param params
     */
    uncolor(params) {
        var _a, _b, _c, _d;
        const range = params.context.range;
        const defaultColor = this.configuration.defaultColor;
        const hasColor = this.hasColor.bind(this);
        if (range.isCollapsed()) {
            const inline = this.dependencies.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]);
            if (range.start.ancestor(hasColor)) {
                // Set the color style cache to the default color.
                if (!inline.cache.style) {
                    inline.cache.style = new _plugin_xml_src_CssStyle__WEBPACK_IMPORTED_MODULE_6__["CssStyle"]();
                }
                inline.cache.style.set(this.styleName, defaultColor);
            }
            else if (inline.cache.style) {
                // Unset the color style cache.
                inline.cache.style.remove(this.styleName);
            }
        }
        else {
            for (const node of params.context.range.selectedNodes()) {
                const target = this._nodeOrFirstFormat(node);
                const currentColor = (_a = target.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _a === void 0 ? void 0 : _a.style.get(this.styleName);
                if (!currentColor || currentColor === defaultColor || node.ancestor(hasColor)) {
                    // Set the color to the default color.
                    target.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"]).style.set(this.styleName, defaultColor);
                }
                else {
                    // Remove the color.
                    (_b = target.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _b === void 0 ? void 0 : _b.style.remove(this.styleName);
                }
                // Uncolor the children and their formats as well.
                for (const child of node.children()) {
                    (_c = child.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _c === void 0 ? void 0 : _c.style.remove(this.styleName);
                    if (child.is(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"])) {
                        for (const format of child.modifiers.filter(_plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_4__["Format"])) {
                            (_d = format.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_5__["Attributes"])) === null || _d === void 0 ? void 0 : _d.style.remove(this.styleName);
                        }
                    }
                }
            }
        }
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return the node's first format if any, itself otherwise.
     *
     * @param node
     */
    _nodeOrFirstFormat(node) {
        return node.modifiers.filter(_plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_4__["Format"])[0] || node;
    }
    /**
     * Return true if all the children of the given node have the given color.
     *
     * @param node
     * @param color
     */
    _isAllColored(node, color) {
        return node.children().every(child => this.hasColor(color, child));
    }
}
Color.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]];


/***/ }),

/***/ "./packages/plugin-devtools/assets/DevTools.css":
/*!******************************************************!*\
  !*** ./packages/plugin-devtools/assets/DevTools.css ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../../node_modules/css-loader/dist/cjs.js!./DevTools.css */ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-devtools/assets/DevTools.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/plugin-devtools/assets/DevTools.xml":
/*!******************************************************!*\
  !*** ./packages/plugin-devtools/assets/DevTools.xml ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<templates>\n    <!-- INSPECTOR -->\n    <devtools-panel class=\"inspector\" t-name=\"InspectorComponent\" t-att-class=\"{active: props.isOpen}\"\n        t-on-node-selected=\"selectNode\"\n        t-on-keydown=\"onKeydown\">\n        <devtools-contents t-if=\"props.isOpen\">\n            <devtools-mainpane>\n                <mainpane-contents>\n                    <devtools-tree>\n                        <TreeComponent\n                            vNode=\"domEngine.root\"\n                            isRoot=\"true\"\n                            selectedPath=\"getPath(selectedNode)\"\n                            selectedID=\"state.selectedID\"/>\n                    </devtools-tree>\n                </mainpane-contents>\n                <PathComponent\n                    path=\"getPath(selectedNode)\"\n                    selectedID=\"state.selectedID\"/>\n            </devtools-mainpane>\n            <devtools-sidepane>\n                <InfoComponent vNode=\"selectedNode\"/>\n            </devtools-sidepane>\n        </devtools-contents>\n    </devtools-panel>\n\n    <!-- INSPECTOR.Tree -->\n    <devtools-node t-name=\"TreeComponent\"\n        t-att-class=\"{\n            block: props.vNode.length and !props.vNode.char,\n            folded: state.folded,\n            root: props.isRoot,\n            'self-closing': !props.vNode.hasChildren(),\n        }\"\n        tabindex=\"1\"\n        t-on-keydown=\"onKeydown\"\n        t-on-node-selected=\"selectNode\">\n        <t t-if=\"props.isRoot\">\n            <devtools-nodename class=\"selectable-line block\"\n                t-on-click=\"onClickNode\" t-on-dblclick=\"onDblClickNode\"\n                t-att-class=\"{\n                    selected: props.selectedID == props.vNode.id,\n                }\">root</devtools-nodename>\n            <t t-call=\"treeChildren\"/>\n        </t>\n        <t t-else=\"\">\n            <devtools-nodename t-if=\"!props.vNode.tangible\"\n                t-on-click=\"onClickNode\" t-on-dblclick=\"onDblClickNode\"\n                class=\"selectable-line inline marker-node\" t-att-class=\"{\n                    selected: props.selectedID == props.vNode.id,\n                }\">\n                <b><t t-esc=\"repr()\"/></b>\n            </devtools-nodename>\n            <devtools-nodename t-elif=\"props.vNode.char\" t-on-click=\"onClickNode\"\n                t-on-dblclick=\"onDblClickNode\"\n                class=\"selectable-line inline\" t-att-class=\"{\n                    bold: isFormat(props.vNode, 'b'),\n                    italic: isFormat(props.vNode, 'i'),\n                    underline: isFormat(props.vNode, 'u'),\n                    link: isFormat(props.vNode, 'link'),\n                    subscript: isFormat(props.vNode, 'subscript'),\n                    superscript: isFormat(props.vNode, 'superscript'),\n                    selected: props.selectedID == props.vNode.id,\n                }\">\n                <t t-esc=\"repr()\"/>\n            </devtools-nodename>\n            <t t-else=\"\">\n                <devtools-nodename class=\"selectable-line block\" t-on-click=\"onClickNode\"\n                    t-on-dblclick=\"onDblClickNode\"\n                    t-att-class=\"{\n                        bold: isFormat(props.vNode, 'b'),\n                        italic: isFormat(props.vNode, 'i'),\n                        underline: isFormat(props.vNode, 'u'),\n                        link: isFormat(props.vNode, 'link'),\n                        subscript: isFormat(props.vNode, 'subscript'),\n                        superscript: isFormat(props.vNode, 'superscript'),\n                        selected: props.selectedID == props.vNode.id,\n                        'line-break': props.vNode.htmlTag === 'BR',\n                    }\">\n                    <t t-esc=\"repr()\"/>\n                </devtools-nodename>\n                <t t-call=\"treeChildren\"/>\n            </t>\n        </t>\n    </devtools-node>\n\n    <t t-name=\"treeChildren\">\n        <devtools-children>\n            <TreeComponent t-if=\"!state.folded\"\n                t-foreach=\"props.vNode.childVNodes.slice()\" t-as=\"child\"\n                t-key=\"child.id\"\n                vNode=\"child\"\n                selectedPath=\"props.selectedPath\"\n                selectedID=\"props.selectedID\"/>\n        </devtools-children>\n    </t>\n\n    <!-- INSPECTOR.Path -->\n    <devtools-path t-name=\"PathComponent\">\n        <devtools-pathnode t-foreach=\"props.path\" t-as=\"vNode\"\n            t-key=\"vNode.id\"\n            t-att-class=\"{\n                selected: vNode.id == props.selectedID\n            }\"\n            t-on-click=\"selectNode(vNode)\">\n            <t t-esc=\"getNodeRepr(vNode)\"/>\n        </devtools-pathnode>\n    </devtools-path>\n\n    <!-- INSPECTOR.Info -->\n    <devtools-info t-name=\"InfoComponent\">\n        <devtools-navbar>\n            <devtools-button t-on-click=\"openTab('vNode')\" t-att-class=\"{\n                selected: state.currentTab == 'vNode',\n            }\">VNode</devtools-button>\n            <devtools-button t-on-click=\"openTab('selection')\" t-att-class=\"{\n                selected: state.currentTab == 'selection',\n            }\">Selection</devtools-button>\n        </devtools-navbar>\n        <t t-call=\"infoVNode\" t-if=\"state.currentTab == 'vNode'\"/>\n        <t t-call=\"infoSelection\" t-if=\"state.currentTab == 'selection'\"/>\n    </devtools-info>\n\n    <!-- INSPECTOR.Info.vNode -->\n    <t t-name=\"infoVNode\">\n        <devtools-about>\n            <devtools-type><t t-esc=\"className(props.vNode)\"/></devtools-type> <t t-esc=\"props.vNode.name\"/>\n            <t t-if=\"props.vNode.char\">:\n                \"<t t-esc=\"props.vNode.char\"/>\"\n            </t>\n            <devtools-button class=\"logger\" t-on-click=\"logVNode(props.vNode)\">&gt;_</devtools-button>\n            <devtools-id><t t-esc=\"props.vNode.id\"/></devtools-id>\n        </devtools-about>\n        <devtools-properties>\n            <devtools-infotitle>👤 About me</devtools-infotitle>\n            <devtools-table>\n                <devtools-tbody>\n                    <devtools-tr t-foreach=\"aboutMeProps\" t-as=\"propName\" t-key=\"propName_index\">\n                        <devtools-td><t t-esc=\"propName\"/></devtools-td>\n                        <devtools-td><t t-esc=\"propRepr(props.vNode, propName)\"/></devtools-td>\n                    </devtools-tr>\n                    <devtools-tr>\n                        <devtools-td>total length</devtools-td>\n                        <devtools-td><t t-esc=\"totalLength(props.vNode)\"/></devtools-td>\n                    </devtools-tr>\n                    <devtools-tr>\n                        <devtools-td>text content</devtools-td>\n                        <devtools-td><t t-esc=\"props.vNode.textContent\"/></devtools-td>\n                    </devtools-tr>\n                </devtools-tbody>\n            </devtools-table>\n            <devtools-infotitle>📖 My Properties</devtools-infotitle>\n            <devtools-table>\n                <devtools-tbody>\n                    <devtools-tr t-foreach=\"nodeProperties(props.vNode)\" t-as=\"prop\" t-key=\"prop_index\">\n                        <devtools-td><t t-esc=\"prop.key\"/></devtools-td>\n                        <devtools-td><t t-esc=\"prop.value\"/></devtools-td>\n                    </devtools-tr>\n                </devtools-tbody>\n            </devtools-table>\n            <devtools-infotitle>👪 My Family</devtools-infotitle>\n            <devtools-table>\n                <devtools-tbody>\n                    <devtools-tr t-foreach=\"familyProps\" t-as=\"propName\"\n                    t-key=\"propName_index\">\n                        <devtools-td><t t-esc=\"propName\"/></devtools-td>\n                        <devtools-td t-if=\"propName === 'parent'\" t-on-click=\"selectNode(props.vNode.parent)\">\n                            <t t-esc=\"propRepr(props.vNode, propName)\"/>\n                        </devtools-td>\n                        <devtools-td t-elif=\"propName === 'siblings'\">\n                            <devtools-list>\n                                <devtools-listitem t-if=\"props.vNode.previousSibling()\"\n                                    t-on-click=\"selectNode(props.vNode.previousSibling())\">\n                                    previous: <t t-esc=\"props.vNode.previousSibling().name\"/>\n                                </devtools-listitem>\n                                <devtools-listitem t-else=\"\">previous: none</devtools-listitem>\n                                <devtools-listitem t-if=\"props.vNode.nextSibling()\"\n                                    t-on-click=\"selectNode(props.vNode.nextSibling())\">\n                                    next: <t t-esc=\"props.vNode.nextSibling().name\"/>\n                                </devtools-listitem>\n                                <devtools-listitem t-else=\"\">next: none</devtools-listitem>\n                            </devtools-list>\n                        </devtools-td>\n                        <devtools-td t-elif=\"propName === 'children'\">\n                            <devtools-list t-if=\"props.vNode.childVNodes.length\">\n                                <devtools-listitem t-foreach=\"props.vNode.children()\"\n                                    t-as=\"child\" t-key=\"child.id\"\n                                    t-on-click=\"selectNode(child)\">\n                                    <t t-esc=\"child.name\"/>\n                                </devtools-listitem>\n                            </devtools-list>\n                            <t t-else=\"\">none</t>\n                        </devtools-td>\n                        <devtools-td t-else=\"\"><t t-esc=\"propRepr(props.vNode, propName)\"/></devtools-td>\n                    </devtools-tr>\n                </devtools-tbody>\n            </devtools-table>\n        </devtools-properties>\n    </t>\n\n    <!-- INSPECTOR.Info.selection -->\n    <t t-name=\"infoSelection\">\n        <devtools-about>\n            <devtools-type>VSelection</devtools-type> Selection\n        </devtools-about>\n        <devtools-properties>\n            <devtools-infotitle>👤 About me</devtools-infotitle>\n            <devtools-table>\n                <devtools-tbody>\n                    <devtools-tr>\n                        <devtools-td>direction</devtools-td>\n                        <devtools-td><t t-esc=\"env.editor.selection.direction\"/></devtools-td>\n                    </devtools-tr>\n                    <devtools-tr>\n                        <devtools-td><strong class=\"marker-node\">[</strong> anchor</devtools-td>\n                        <devtools-td><t t-esc=\"_repr(env.editor.selection.anchor)\"/></devtools-td>\n                    </devtools-tr>\n                    <devtools-tr>\n                        <devtools-td><strong class=\"marker-node\">]</strong> focus</devtools-td>\n                        <devtools-td><t t-esc=\"_repr(env.editor.selection.focus)\"/></devtools-td>\n                    </devtools-tr>\n                </devtools-tbody>\n            </devtools-table>\n        </devtools-properties>\n    </t>\n\n    <devtools-panel t-name=\"CommandsComponent\"\n        t-att-class=\"{active: props.isOpen}\" tabindex=\"1\"\n        t-on-keydown=\"onKeydown\">\n        <devtools-contents t-if=\"props.isOpen\">\n            <t t-set=\"selectedCommandImplementations\" t-value=\"state.registry[state.selectedCommandIdentifier]\"/>\n            <devtools-mainpane style=\"overflow: hidden\">\n                <devtools-navbar>\n                    <devtools-button t-on-click=\"openTab('queue')\" t-att-class=\"{\n                        selected: state.currentTab == 'queue',\n                    }\">Queue</devtools-button>\n                    <devtools-button t-on-click=\"openTab('registry')\" t-att-class=\"{\n                        selected: state.currentTab == 'registry',\n                    }\">Registry</devtools-button>\n                </devtools-navbar>\n                <mainpane-contents t-if=\"state.currentTab == 'queue'\" style=\"overflow: auto\">\n                    <devtools-table style=\"width: 100%;\">\n                        <devtools-tbody>\n                            <devtools-tr t-foreach=\"Array.from(props.commands.keys()).reverse()\" t-as=\"commandIndex\"\n                                t-key=\"commandIndex_index\" class=\"selectable-line\"\n                                t-att-class=\"{\n                                    selected: state.selectedCommandIndex == commandIndex,\n                                }\"\n                                t-on-click=\"selectCommandByIndex(commandIndex)\">\n                                <devtools-td><t t-esc=\"props.commands[commandIndex][0]\"/></devtools-td>\n                            </devtools-tr>\n                        </devtools-tbody>\n                    </devtools-table>\n                </mainpane-contents>\n                <mainpane-contents t-elif=\"state.currentTab == 'registry'\" style=\"overflow: auto\">\n                    <devtools-command t-foreach=\"Object.keys(state.registry).sort()\" t-as=\"commandIdentifier\"\n                        t-key=\"record_index\" class=\"selectable-line\"\n                        t-att-class=\"{\n                            selected: state.selectedCommandIdentifier == commandIdentifier,\n                        }\"\n                        t-on-click=\"selectCommand(commandIdentifier)\">\n                        <t t-esc=\"commandIdentifier\"/>\n                    </devtools-command>\n                </mainpane-contents>\n            </devtools-mainpane>\n            <devtools-sidepane>\n                <devtools-info t-if=\"state.currentTab == 'queue'\">\n                    <t t-set=\"selectedCommand\" t-value=\"props.commands[state.selectedCommandIndex]\"/>\n                    <devtools-about t-if=\"selectedCommand\">\n                        <devtools-type>Command</devtools-type> <t t-esc=\"selectedCommand[0]\"/>\n                    </devtools-about>\n                    <devtools-properties t-if=\"selectedCommand\">\n                        <devtools-infotitle>Arguments</devtools-infotitle>\n                        <devtools-properties>\n                            <t t-if=\"selectedCommand\">\n                                <t t-set=\"payload\" t-value=\"selectedCommand[1]\"/>\n                                <t t-call=\"commandArgs\"/>\n                            </t>\n                            <t t-call=\"selectedCommandTable\"/>\n                        </devtools-properties>\n                    </devtools-properties>\n                </devtools-info>\n                <devtools-info t-elif=\"state.currentTab == 'registry'\">\n                    <t t-if=\"state.registry\">\n                        <devtools-about t-if=\"state.selectedCommandIdentifier\">\n                            <devtools-type>Command</devtools-type> <t t-esc=\"state.selectedCommandIdentifier\"/>\n                        </devtools-about>\n                        <devtools-properties t-if=\"state.selectedCommandIdentifier\">\n                            <t t-call=\"selectedCommandTable\"/>\n                        </devtools-properties>\n                    </t>\n                </devtools-info>\n            </devtools-sidepane>\n        </devtools-contents>\n    </devtools-panel>\n\n    <t t-name=\"commandArgs\">\n        <devtools-table>\n            <devtools-tbody>\n                <t t-foreach=\"Object.keys(payload)\" t-as=\"key\" t-key=\"key_index\">\n                    <devtools-tr t-if=\"key !== 'context'\">\n                        <t t-set=\"value\" t-value=\"payload[key]\"/>\n                        <devtools-td>\n                            <t t-esc=\"key\"/>\n                        </devtools-td>\n                        <devtools-td>\n                            <t t-if=\"value and key == 'vSelection'\" t-call=\"payloadVSelection\"/>\n                            <t t-else=\"\"><t t-esc=\"formatPayloadValue(value)\"/></t>\n                        </devtools-td>\n                    </devtools-tr>\n                </t>\n            </devtools-tbody>\n        </devtools-table>\n    </t>\n\n    <t t-name=\"payloadVSelection\">\n        <devtools-table>\n            <devtools-tbody>\n                <devtools-tr>\n                    <devtools-td>\n                        direction\n                    </devtools-td>\n                    <devtools-td>\n                        <t t-esc=\"value.direction or 'unset'\"/>\n                    </devtools-td>\n                </devtools-tr>\n                <devtools-tr>\n                    <devtools-td>\n                        anchor\n                    </devtools-td>\n                    <devtools-td>\n                        <t t-esc=\"value.anchorPosition\"/> <t t-esc=\"value.anchorNode.id\"/> (<t t-esc=\"value.anchorNode.name\"/>)\n                    </devtools-td>\n                </devtools-tr>\n                <devtools-tr>\n                    <devtools-td>\n                        focus\n                    </devtools-td>\n                    <devtools-td>\n                        <t t-esc=\"value.focusPosition\"/> <t t-esc=\"value.focusNode.id\"/> (<t t-esc=\"value.focusNode.name\"/>)\n                    </devtools-td>\n                </devtools-tr>\n            </devtools-tbody>\n        </devtools-table>\n    </t>\n\n    <t t-name=\"selectedCommandTable\">\n        <devtools-infotitle>Command definitions</devtools-infotitle>\n        <devtools-table>\n            <devtools-tbody>\n                <devtools-tr t-foreach=\"selectedCommandImplementations\"\n                    t-as=\"selectedCommandImplementation\" t-key=\"selectedCommandImplementation_index\"\n                    class=\"selectable-line\"\n                    t-att-class=\"{\n                        selected: state.selectedCommandImplementationIndex == handlerIndex,\n                    }\">\n                    <devtools-td><t t-esc=\"selectedCommandImplementation.handler.name\"/></devtools-td>\n                    <devtools-td><t t-esc=\"selectedCommandImplementation.handler\"/></devtools-td>\n                </devtools-tr>\n            </devtools-tbody>\n        </devtools-table>\n        <t t-set=\"mappings\" t-value=\"matchingMappings(state.selectedCommandIdentifier)\"/>\n        <t t-if=\"mappings.length\">\n            <devtools-infotitle>Shortcuts</devtools-infotitle>\n            <devtools-table>\n                <devtools-tbody>\n                    <devtools-tr t-foreach=\"mappings\" t-as=\"mapping\" t-key=\"mapping_index\">\n                        <devtools-td style=\"width: 50%;\"><t t-esc=\"stringifyPattern(mapping.pattern)\"/></devtools-td>\n                        <devtools-td><t t-esc=\"argsRepr(mapping.configuredCommand.commandArgs)\"/></devtools-td>\n                    </devtools-tr>\n                </devtools-tbody>\n            </devtools-table>\n        </t>\n    </t>\n\n    <!-- SHORTCUTS -->\n    <devtools-panel t-name=\"ShortcutsComponent\"\n        t-att-class=\"{active: props.isOpen}\" tabindex=\"1\"\n        t-on-keydown=\"onKeydown\">\n        <devtools-contents t-if=\"props.isOpen\">\n            <devtools-mainpane style=\"overflow: hidden\">\n                <mainpane-contents style=\"overflow: auto\">\n                    <devtools-table>\n                        <devtools-tr t-foreach=\"mappings\" t-as=\"mapping\" t-key=\"mapping_index\" class=\"selectable-line\">\n                            <devtools-td><t t-esc=\"stringifyPattern(mapping.pattern)\"/></devtools-td>\n                            <devtools-td><t t-esc=\"mapping.configuredCommand.commandId\"/></devtools-td>\n                            <devtools-td><t t-esc=\"argsRepr(mapping.configuredCommand.commandArgs)\"/></devtools-td>\n                        </devtools-tr>\n                    </devtools-table>\n                </mainpane-contents>\n            </devtools-mainpane>\n        </devtools-contents>\n    </devtools-panel>\n\n    <!-- MAIN -->\n    <jw-devtools t-name=\"devtools\"\n        t-att-class=\"{\n            closed: state.closed,\n        }\"\n        t-attf-style=\"height: {{state.height}}px\"\n        tabindex=\"2\">\n        <devtools-navbar\n            t-on-click=\"toggleClosed\"\n            t-on-mousedown=\"startResize\"\n            t-on-touchstart=\"startResize\">\n            <devtools-button t-on-click=\"openTab('inspector')\" t-att-class=\"{\n                selected: state.currentTab == 'inspector',\n            }\">Inspector</devtools-button>\n            <devtools-button t-on-click=\"openTab('commands')\" t-att-class=\"{\n                selected: state.currentTab == 'commands',\n            }\">Commands</devtools-button>\n            <devtools-button t-on-click=\"openTab('shortcuts')\" t-att-class=\"{\n                selected: state.currentTab == 'shortcuts',\n            }\">Shortcuts</devtools-button>\n            <devtools-button t-on-click=\"inpectDom()\">&#128269;</devtools-button>\n        </devtools-navbar>\n        <t t-if=\"!state.closed\">\n            <InspectorComponent isOpen=\"state.currentTab == 'inspector'\" t-ref=\"inspector\"/>\n            <CommandsComponent isOpen=\"state.currentTab == 'commands'\"\n                commands=\"state.commands\"/>\n            <ShortcutsComponent isOpen=\"state.currentTab == 'shortcuts'\"/>\n        </t>\n    </jw-devtools>\n\n</templates>\n"

/***/ }),

/***/ "./packages/plugin-devtools/src/DevTools.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-devtools/src/DevTools.ts ***!
  \**************************************************/
/*! exports provided: DevTools */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DevTools", function() { return DevTools; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_owl_src_Owl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-owl/src/Owl */ "./packages/plugin-owl/src/Owl.ts");
/* harmony import */ var _plugin_owl_src_ui_OwlNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-owl/src/ui/OwlNode */ "./packages/plugin-owl/src/ui/OwlNode.ts");
/* harmony import */ var _components_DevToolsComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./components/DevToolsComponent */ "./packages/plugin-devtools/src/components/DevToolsComponent.ts");
/* harmony import */ var _plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-html/src/Html */ "./packages/plugin-html/src/Html.ts");
/* harmony import */ var _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _assets_DevTools_xml__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../assets/DevTools.xml */ "./packages/plugin-devtools/assets/DevTools.xml");
/* harmony import */ var _assets_DevTools_xml__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(_assets_DevTools_xml__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var _assets_DevTools_css__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../assets/DevTools.css */ "./packages/plugin-devtools/assets/DevTools.css");
/* harmony import */ var _assets_DevTools_css__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_assets_DevTools_css__WEBPACK_IMPORTED_MODULE_7__);








class DevTools extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            components: [
                {
                    id: 'devTools',
                    async render() {
                        return [new _plugin_owl_src_ui_OwlNode__WEBPACK_IMPORTED_MODULE_2__["OwlNode"](_components_DevToolsComponent__WEBPACK_IMPORTED_MODULE_3__["DevToolsComponent"], {})];
                    },
                },
            ],
            componentZones: [['devTools', 'debug']],
            owlTemplates: [_assets_DevTools_xml__WEBPACK_IMPORTED_MODULE_6___default.a],
        };
    }
}
DevTools.dependencies = [_plugin_owl_src_Owl__WEBPACK_IMPORTED_MODULE_1__["Owl"], _plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_4__["Html"], _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_5__["DomLayout"]];


/***/ }),

/***/ "./packages/plugin-devtools/src/components/CommandsComponent.ts":
/*!**********************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/CommandsComponent.ts ***!
  \**********************************************************************/
/*! exports provided: CommandsComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CommandsComponent", function() { return CommandsComponent; });
/* harmony import */ var _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/ui/OwlComponent */ "./packages/plugin-owl/src/ui/OwlComponent.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ "./packages/plugin-devtools/src/utils.ts");




class CommandsComponent extends _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.state = {
            currentTab: 'queue',
            registry: this.env.editor.dispatcher.commands,
            selectedCommandIndex: null,
            selectedCommandIdentifier: null,
            selectedCommandImplementationIndex: null,
        };
        this.localStorage = ['currentTab'];
        this.argsRepr = _utils__WEBPACK_IMPORTED_MODULE_3__["argsRepr"];
        this.stringifyPattern = this.env.editor.plugins.get(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_2__["Keymap"]).stringifyPattern;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Take a payload value and format it for display (mostly to ensure that
     * we can display it properly as a string).
     *
     * @param value
     */
    formatPayloadValue(value) {
        if (value && value instanceof Node && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(value)) {
            return '<' + Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(value).toLowerCase() + '>';
        }
        return '' + value;
    }
    /**
     * Handle keydown event to navigate in the command stack.
     */
    onKeydown(event) {
        if (this.state.currentTab === 'queue') {
            if (event.code === 'ArrowDown') {
                this.state.selectedCommandIndex = Math.max(this.state.selectedCommandIndex - 1, 0);
            }
            else if (event.code === 'ArrowUp') {
                this.state.selectedCommandIndex = Math.min(this.state.selectedCommandIndex + 1, this.props.commands.length - 1);
            }
            else {
                return;
            }
        }
        else if (this.state.currentTab === 'registry') {
            const identifiers = Object.keys(this.state.registry).sort();
            const currentIndex = identifiers.indexOf(this.state.selectedCommandIdentifier);
            if (event.code === 'ArrowDown') {
                this.state.selectedCommandIdentifier =
                    identifiers[Math.min(currentIndex + 1, identifiers.length - 1)];
            }
            else if (event.code === 'ArrowUp') {
                this.state.selectedCommandIdentifier = identifiers[Math.max(currentIndex - 1, 0)];
            }
            else {
                return;
            }
        }
        event.preventDefault();
        event.stopImmediatePropagation();
    }
    /**
     * Open the tab with the given tabName.
     *
     * @param tabName
     */
    openTab(tabName) {
        this.state.currentTab = tabName;
    }
    /**
     * Select the command at given index.
     *
     * @param index
     */
    selectCommandByIndex(index) {
        this.state.selectedCommandIndex = index;
        this.state.selectedCommandIdentifier = this.props.commands[index][0];
    }
    /**
     * Select the command with given identifier.
     *
     * @param commandIdentifier
     */
    selectCommand(commandIdentifier) {
        this.state.selectedCommandIdentifier = commandIdentifier;
    }
    /**
     * Return the key mappings matching the given command identifier.
     *
     * @param commandIdentifier
     */
    matchingMappings(commandIdentifier) {
        return this.env.editor.plugins
            .get(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_2__["Keymap"])
            .mappings.flat()
            .filter(mapping => mapping.configuredCommand.commandId === commandIdentifier);
    }
}


/***/ }),

/***/ "./packages/plugin-devtools/src/components/DevToolsComponent.ts":
/*!**********************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/DevToolsComponent.ts ***!
  \**********************************************************************/
/*! exports provided: DevToolsComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DevToolsComponent", function() { return DevToolsComponent; });
/* harmony import */ var _CommandsComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CommandsComponent */ "./packages/plugin-devtools/src/components/CommandsComponent.ts");
/* harmony import */ var _InspectorComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InspectorComponent */ "./packages/plugin-devtools/src/components/InspectorComponent.ts");
/* harmony import */ var _ShortcutsComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ShortcutsComponent */ "./packages/plugin-devtools/src/components/ShortcutsComponent.ts");
/* harmony import */ var _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugin-owl/src/ui/OwlComponent */ "./packages/plugin-owl/src/ui/OwlComponent.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @odoo/owl */ "./node_modules/@odoo/owl/dist/owl.js");
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_odoo_owl__WEBPACK_IMPORTED_MODULE_5__);






class DevToolsComponent extends _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_3__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.inspectorRef = _odoo_owl__WEBPACK_IMPORTED_MODULE_5__["hooks"].useRef('inspector');
        this.state = {
            closed: true,
            currentTab: 'inspector',
            height: 300,
            commands: [],
        };
        this.localStorage = ['closed', 'currentTab', 'height'];
    }
    async willStart() {
        this.env.editor.dispatcher.registerCommandHook('*', this.refresh.bind(this));
        return super.willStart();
    }
    willUnmount() {
        this.state.commands = [];
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Open the tab with the given `tabName`
     *
     * @param {string} tabName
     */
    openTab(tabName) {
        this.state.currentTab = tabName;
    }
    /**
     * Bind mouse handler to allow the selection of the node in the devtools inspector.
     * When the mouse will move, we add a class to highlight the targeted node (linked to VNode).
     * Will be unbind when the user click inside the dom.
     *
     * @param ev
     */
    inpectDom() {
        this.state.currentTab = 'inspector';
        this.inspectorRef.comp.inpectDom();
    }
    /**
     * Refresh this component with respect to the recent dispatching of the
     * given command with the given arguments.
     */
    refresh(params, id) {
        this.state.commands.push([id, params]);
        this.render();
    }
    /**
     * Drag the DevTools to resize them
     *
     * @param {MouseEvent} event
     */
    startResize(event) {
        event.preventDefault();
        this._heightOnLastMousedown = this.state.height;
        if (this.state.closed) {
            return; // Do not resize if the DevTools are closed
        }
        const startY = event instanceof MouseEvent ? event.pageY : event.targetTouches[0].pageY; // Y position of the mousedown
        /**
         * Perform the resizing on every mouse mouvement
         *
         * @param ev
         */
        const doResize = (ev) => {
            const currentY = ev instanceof MouseEvent ? ev.pageY : ev.targetTouches[0].pageY;
            const offset = startY - currentY;
            this.state.height = this._heightOnLastMousedown + offset;
        };
        /**
         * Stop resizing on mouse up
         */
        const stopResize = () => {
            window.removeEventListener('mousemove', doResize, false);
            window.removeEventListener('mouseup', stopResize, false);
            window.removeEventListener('touchmove', doResize, false);
            window.removeEventListener('touchend', stopResize, false);
        };
        window.addEventListener('mousemove', doResize);
        window.addEventListener('mouseup', stopResize);
        window.addEventListener('touchmove', doResize);
        window.addEventListener('touchend', stopResize);
    }
    /**
     * Toggle the `closed` state of the DevTools (only on a simple click: not
     * if some resizing occurred between mousedown and mouseup)
     */
    toggleClosed(event) {
        const didJustResize = this._heightOnLastMousedown !== this.state.height;
        const isOnButton = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(event.target) === 'DEVTOOLS-BUTTON';
        if (!didJustResize && !(isOnButton && !this.state.closed)) {
            this.state.closed = !this.state.closed;
        }
    }
}
DevToolsComponent.components = {
    CommandsComponent: _CommandsComponent__WEBPACK_IMPORTED_MODULE_0__["CommandsComponent"],
    InspectorComponent: _InspectorComponent__WEBPACK_IMPORTED_MODULE_1__["InspectorComponent"],
    ShortcutsComponent: _ShortcutsComponent__WEBPACK_IMPORTED_MODULE_2__["ShortcutsComponent"],
};
DevToolsComponent.template = 'devtools';


/***/ }),

/***/ "./packages/plugin-devtools/src/components/InfoComponent.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/InfoComponent.ts ***!
  \******************************************************************/
/*! exports provided: InfoComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InfoComponent", function() { return InfoComponent; });
/* harmony import */ var _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/ui/OwlComponent */ "./packages/plugin-owl/src/ui/OwlComponent.ts");
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");



class InfoComponent extends _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.aboutMeProps = ['id', 'name', 'length', 'atomic', 'modifiers'];
        this.familyProps = ['parent', 'children', 'siblings'];
        this.customPropsBlacklist = this.aboutMeProps.concat(this.familyProps).concat(['childVNodes']);
        this.state = {
            currentTab: 'vNode',
        };
        this.localStorage = ['currentTab'];
    }
    /**
     * Open the tab with the given `tabName`
     *
     * @param {string} tabName
     */
    openTab(tabName) {
        this.state.currentTab = tabName;
    }
    /**
     * Trigger a 'node-selected' custom event
     * with the given `vNode` to select it
     *
     * @param {VNode} vNode
     */
    selectNode(vNode) {
        this.trigger('node-selected', {
            vNode: vNode,
        });
    }
    /**
     * Return the name of the class of the given VNode.
     *
     * @param vNode
     */
    className(vNode) {
        return vNode.constructor.name;
    }
    /**
     * Return a string representing the contents of a property of a VNode.
     *
     * @param vNode
     * @param propName
     */
    propRepr(vNode, propName) {
        let prop = vNode[propName];
        if (propName === 'atomic') {
            if (vNode.is(_core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_1__["AtomicNode"])) {
                return 'true';
            }
            else if (vNode.is(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__["ContainerNode"])) {
                return 'false';
            }
            else {
                return '?';
            }
        }
        else if (propName === 'modifiers') {
            if (!vNode.modifiers.length)
                return '[]';
            return `[ ${vNode.modifiers.map(m => m.toString()).join(', ')} ]`;
        }
        else {
            if ({}.toString.call(prop) === '[object Function]') {
                prop = vNode[propName]();
            }
            return this._propRepr(prop);
        }
    }
    /**
     * Return an object representing the given VNode's public properties as
     * alphabetically sorted pairs of key and value strings.
     *
     * @param vNode
     */
    nodeProperties(vNode) {
        return Object.keys(vNode)
            .filter(key => !key.startsWith('_') && !this.customPropsBlacklist.includes(key))
            .sort()
            .map(key => {
            return { key: key, value: this._propRepr(vNode[key]) };
        });
    }
    /**
     * Return the length of this node and all its descendents.
     *
     * @param __current
     */
    totalLength(vNode, __current = 0) {
        __current += vNode.length;
        vNode.children().forEach((child) => {
            if (child.hasChildren()) {
                __current = this.totalLength(child, __current);
            }
        });
        return __current;
    }
    /**
     * Log a `VNode` to the console.
     *
     * @param vNode
     */
    logVNode(vNode) {
        console.log(vNode);
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    _repr(vNode) {
        const nextSibling = vNode.nextSibling();
        const prevSibling = vNode.previousSibling();
        const position = nextSibling ? 'BEFORE' : prevSibling ? 'AFTER' : 'INSIDE';
        const reference = nextSibling || prevSibling || vNode.parent;
        if (reference) {
            return `${position} ${reference.id} (${reference.name})`;
        }
        else {
            return 'Not in VDocument';
        }
    }
    /**
     * Return a string representing the contents of a property of a VNode.
     *
     * @param vNode
     * @param propName
     */
    _propRepr(prop) {
        let value = '' + prop;
        if (typeof prop === 'object') {
            if (Array.isArray(prop) && !prop.length) {
                value = '[]';
            }
            else if (prop === null) {
                value = 'null';
            }
            else if (prop === undefined) {
                value = 'undefined';
            }
            else if (prop instanceof Set) {
                const items = [];
                prop.forEach(item => {
                    items.push(item);
                });
                value = items.join('\n');
            }
            else if (!prop || !Object.keys(prop).length) {
                value = '{}';
            }
            else if (prop.toString === {}.toString) {
                value = this._objectRepr(prop);
            }
        }
        else if (typeof prop === 'string') {
            value = '"' + value + '"';
        }
        return value;
    }
    /**
     * Return a string representing all key/value pairs of an object.
     *
     * @param vNode
     * @param propName
     */
    _objectRepr(obj) {
        return Object.keys(obj)
            .filter(key => key !== 'toString')
            .map(key => {
            return key + ': ' + obj[key];
        })
            .join('\n');
    }
}


/***/ }),

/***/ "./packages/plugin-devtools/src/components/InspectorComponent.ts":
/*!***********************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/InspectorComponent.ts ***!
  \***********************************************************************/
/*! exports provided: InspectorComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InspectorComponent", function() { return InspectorComponent; });
/* harmony import */ var _InfoComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./InfoComponent */ "./packages/plugin-devtools/src/components/InfoComponent.ts");
/* harmony import */ var _PathComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PathComponent */ "./packages/plugin-devtools/src/components/PathComponent.ts");
/* harmony import */ var _TreeComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TreeComponent */ "./packages/plugin-devtools/src/components/TreeComponent.ts");
/* harmony import */ var _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugin-owl/src/ui/OwlComponent */ "./packages/plugin-owl/src/ui/OwlComponent.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _utils_src_polyfill__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../utils/src/polyfill */ "./packages/utils/src/polyfill.ts");
/* harmony import */ var _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../plugin-char/src/CharNode */ "./packages/plugin-char/src/CharNode.ts");







const hoverStyle = 'box-shadow: inset 0 0 0 100vh rgba(95, 146, 204, 0.5); cursor: pointer;';
class InspectorComponent extends _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_3__["OwlComponent"] {
    constructor(parent, props) {
        var _a;
        super(parent, props);
        this.domEngine = this.env.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]).engines.dom;
        this._hoveredTargets = [];
        this.state = {
            selectedID: (_a = this.domEngine.components.get('editable')[0]) === null || _a === void 0 ? void 0 : _a.id,
        };
        this.selectedNode = this.getNode(this.state.selectedID);
        this._onInspectorMouseMove = this._onInspectorMouseMove.bind(this);
        this._onInspectorMouseLeave = this._onInspectorMouseLeave.bind(this);
        this._onInspectorMouseDown = this._onInspectorMouseDown.bind(this);
        this._onInspectorClick = this._onInspectorClick.bind(this);
    }
    willUnmount() {
        this._hoveredTargets = [];
        this.selectedNode = null;
    }
    /**
     * Handle keyboard navigation in DevTools (arrows to move in the tree)
     *
     * @param {KeyboardEvent} event
     */
    onKeydown(event) {
        const selected = this.getNode(this.state.selectedID);
        let newSelection;
        switch (event.code) {
            case 'ArrowDown':
                newSelection = selected.nextSibling() || selected.firstChild();
                break;
            case 'ArrowUp':
                newSelection = selected.previousSibling() || selected.parent;
                break;
            case 'ArrowLeft':
                newSelection = selected.previousSibling();
                break;
            case 'ArrowRight':
                newSelection = selected.nextSibling();
                break;
            default:
                return;
        }
        if (newSelection) {
            event.preventDefault();
            this.state.selectedID = newSelection.id;
            this.selectedNode = this.getNode(this.state.selectedID);
        }
    }
    /**
     * Handle the selection of a node. A subcomponent triggers a 'select-node'
     * custom event and this method listens to it, retrieves the `vNode` that it
     * passes in its `detail` key, and modifies its state to account for the
     * change in selection.
     *
     * @param {CustomEvent} event
     * @param {VNode} event.detail.vNode
     */
    selectNode(event) {
        this.state.selectedID = event.detail.vNode.id;
        this.selectedNode = this.getNode(this.state.selectedID);
    }
    getNode(id) {
        return this.domEngine.root.descendants(node => node.id === id)[0] || this.domEngine.root;
    }
    /**
     * Return the path between the given `vNode` and the root vNode, as an array
     * of VNode, sorted from the highest parent (the root) to the given vNode.
     *
     * @param {VNode} vNode
     * @returns {VNode []}
     */
    getPath(vNode) {
        const path = [vNode];
        let parent = vNode.parent;
        while (parent) {
            path.unshift(parent);
            parent = parent.parent;
        }
        return path;
    }
    patched() {
        super.patched();
        const selected = this.el.querySelector('.selected');
        if (selected) {
            //selected.scrollIntoView();
        }
    }
    /**
     * Bind mouse handler to allow the selection of the node in the devtools inspector.
     * When the mouse will move, we add a class to highlight the targeted node (linked to VNode).
     * Will be unbind when the user click inside the dom.
     *
     * @param ev
     */
    inpectDom() {
        window.addEventListener('mousemove', this._onInspectorMouseMove, true);
        window.addEventListener('mouseleave', this._onInspectorMouseLeave, true);
        window.addEventListener('mousedown', this._onInspectorMouseDown, true);
        window.addEventListener('click', this._onInspectorClick, true);
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Add a class to highlight the targeted node (like to VNode).
     *
     * @param ev
     */
    async _onInspectorMouseMove(ev) {
        ev.stopImmediatePropagation();
        ev.preventDefault();
        for (const inspected of this._hoveredTargets) {
            inspected.element.setAttribute('style', inspected.oldStyle);
        }
        this._hoveredTargets = [];
        const elements = [];
        for (const node of this._getNodeFromPosition(ev.clientX, ev.clientY)) {
            for (const domNode of this.domEngine.getDomNodes(node)) {
                const element = domNode instanceof HTMLElement ? domNode : domNode.parentElement;
                if (!elements.includes(element)) {
                    elements.push(element);
                }
            }
        }
        for (const element of elements) {
            const style = element.getAttribute('style') || '';
            this._hoveredTargets.push({
                element: element,
                oldStyle: style,
            });
            element.setAttribute('style', style + ';' + hoverStyle);
        }
    }
    /**
     * remove class to remove the highlight.
     *
     * @param ev
     */
    _onInspectorMouseLeave(ev) {
        ev.stopImmediatePropagation();
        ev.preventDefault();
        for (const inspected of this._hoveredTargets) {
            if (inspected.element === ev.target) {
                this._hoveredTargets.splice(this._hoveredTargets.indexOf(inspected), 1);
                inspected.element.setAttribute('style', inspected.oldStyle);
            }
        }
    }
    /**
     * Prevent default behavior (domEditable normalisation).
     *
     * @param ev
     */
    _onInspectorMouseDown(ev) {
        ev.stopImmediatePropagation();
        ev.preventDefault();
    }
    _getNodeFromPosition(clientX, clientY) {
        const caretPosition = Object(_utils_src_polyfill__WEBPACK_IMPORTED_MODULE_5__["caretPositionFromPoint"])(clientX, clientY);
        let node = caretPosition === null || caretPosition === void 0 ? void 0 : caretPosition.offsetNode;
        let nodes = [];
        while (!nodes.length && node) {
            nodes = this.domEngine.getNodes(node);
            node = node.parentNode;
        }
        if (nodes.length && nodes[0].is(_plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_6__["CharNode"]) && nodes[caretPosition.offset]) {
            return [nodes[caretPosition.offset]];
        }
        return nodes;
    }
    /**
     * Select the targeted node in the devtools inspector and unbind the mouse handler
     *
     * @param ev
     */
    async _onInspectorClick(ev) {
        window.removeEventListener('mousemove', this._onInspectorMouseMove, true);
        window.removeEventListener('mouseleave', this._onInspectorMouseLeave, true);
        window.removeEventListener('mousedown', this._onInspectorMouseDown, true);
        window.removeEventListener('click', this._onInspectorClick, true);
        ev.stopImmediatePropagation();
        ev.preventDefault();
        for (const inspected of this._hoveredTargets) {
            inspected.element.setAttribute('style', inspected.oldStyle);
        }
        this._hoveredTargets = [];
        const nodes = this._getNodeFromPosition(ev.clientX, ev.clientY);
        if (nodes.length) {
            this.state.selectedID = nodes[0].id;
            this.selectedNode = this.getNode(this.state.selectedID);
        }
    }
}
InspectorComponent.components = { InfoComponent: _InfoComponent__WEBPACK_IMPORTED_MODULE_0__["InfoComponent"], PathComponent: _PathComponent__WEBPACK_IMPORTED_MODULE_1__["PathComponent"], TreeComponent: _TreeComponent__WEBPACK_IMPORTED_MODULE_2__["TreeComponent"] };


/***/ }),

/***/ "./packages/plugin-devtools/src/components/PathComponent.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/PathComponent.ts ***!
  \******************************************************************/
/*! exports provided: PathComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PathComponent", function() { return PathComponent; });
/* harmony import */ var _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/ui/OwlComponent */ "./packages/plugin-owl/src/ui/OwlComponent.ts");
/* harmony import */ var _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-inline/src/Format */ "./packages/plugin-inline/src/Format.ts");


class PathComponent extends _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    getNodeRepr(vNode) {
        let repr = vNode.name || '?';
        for (const format of vNode.modifiers.filter(_plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_1__["Format"])) {
            repr += '.' + format.name;
        }
        return repr;
    }
    /**
     * Trigger a 'node-selected' custom event
     * with the given `vNode` to select it
     *
     * @param {VNode} vNode
     */
    selectNode(vNode) {
        this.trigger('node-selected', {
            vNode: vNode,
        });
    }
}


/***/ }),

/***/ "./packages/plugin-devtools/src/components/ShortcutsComponent.ts":
/*!***********************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/ShortcutsComponent.ts ***!
  \***********************************************************************/
/*! exports provided: ShortcutsComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ShortcutsComponent", function() { return ShortcutsComponent; });
/* harmony import */ var _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-owl/src/ui/OwlComponent */ "./packages/plugin-owl/src/ui/OwlComponent.ts");
/* harmony import */ var _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../utils */ "./packages/plugin-devtools/src/utils.ts");



class ShortcutsComponent extends _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_0__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.mappings = this.env.editor.plugins
            .get(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_1__["Keymap"])
            .mappings.flat()
            .sort((a, b) => {
            if (a.configuredCommand.commandId < b.configuredCommand.commandId)
                return -1;
            if (a.configuredCommand.commandId > b.configuredCommand.commandId)
                return 1;
            return 0;
        });
        this.localStorage = ['currentTab'];
        this.argsRepr = _utils__WEBPACK_IMPORTED_MODULE_2__["argsRepr"];
        this.stringifyPattern = this.env.editor.plugins.get(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_1__["Keymap"]).stringifyPattern;
    }
}


/***/ }),

/***/ "./packages/plugin-devtools/src/components/TreeComponent.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-devtools/src/components/TreeComponent.ts ***!
  \******************************************************************/
/*! exports provided: TreeComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TreeComponent", function() { return TreeComponent; });
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-owl/src/ui/OwlComponent */ "./packages/plugin-owl/src/ui/OwlComponent.ts");
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/src/VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");





/**
 * Note: `TreeComponent` requires three properties passed by the parent
 *       Component (`DevToolsComponent`) via the template (see `DevTools.xml`):
 *       - vNode: VNode
 *       - isRoot: boolean
 *       - selectedID: number (the ID of the selected VNode)
 */
class TreeComponent extends _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_1__["OwlComponent"] {
    constructor() {
        super(...arguments);
        // User-friendly representation of the node
        this._repr = this._getNodeRepr(this.props.vNode);
        this.state = {
            // Show the selected node and root by default
            folded: !this.props.isRoot && !this.props.selectedPath.includes(this.props.vNode),
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Update `state.folded` when `props.selectedPath` changes if `props.vNode`
     * is in `props.selectedPath`, unless it is the last item. Also update
     * `state.folded` for the ancestors of the selection marker nodes.
     */
    async willUpdateProps(nextProps) {
        // The selected node itself should stay folded even when selected. Only
        // the nodes in the path leading to it should actually be unfolded. By
        // construction, the last item of `selected path` is always the selected
        // node itself so it can safely be omitted from the check.
        const path = nextProps.selectedPath.slice(0, -1);
        if (path.some(node => node.id === nextProps.vNode.id)) {
            this.state.folded = false;
        }
        const selectionMarkersPath = this._getSelectionMarkersAncestors();
        if (selectionMarkersPath.has(nextProps.vNode.id)) {
            this.state.folded = false;
        }
    }
    /**
     * Handle a click event on a node of the tree: toggle its fold on click its
     * caret, select it otherwise
     *
     * @param {MouseEvent} event
     */
    onClickNode(event) {
        const didClickCaret = event.offsetX < 10;
        if (didClickCaret) {
            this.toggleFolded();
        }
        else {
            this.trigger('node-selected', {
                vNode: this.props.vNode,
            });
        }
    }
    onDblClickNode() {
        const location = {
            anchorNode: this.props.vNode,
            focusNode: this.props.vNode,
            direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD,
        };
        this.env.editor.execCommand('setSelection', { vSelection: location });
    }
    /**
     * Handle folding/unfolding on press Enter
     *
     * @param {KeyboardEvent} event
     */
    onKeydown(event) {
        if (event.code === 'Enter') {
            event.preventDefault();
            this.toggleFolded();
            event.stopImmediatePropagation();
        }
    }
    repr() {
        if (this.props.vNode.tangible) {
            return this._repr;
        }
        else {
            // Representation of intangible nodes (e.g. markers) might change
            // depending on the context in which they are referenced, even
            // though they did not actually change per se.
            return this._getNodeRepr(this.props.vNode);
        }
    }
    /**
     * Unfold all of a node's direct ancestors on select it
     * TODO: find a way to do this cross-components
     *
     * @param {CustomEvent} event
     */
    selectNode(event) {
        if (event.detail.vNode.id !== this.props.vNode.id) {
            this.state.folded = false;
        }
    }
    /**
     * Toggle the `folded` propoerty of the state
     */
    toggleFolded() {
        this.state.folded = !this.state.folded;
    }
    /**
     * Return true if the given node has the given format.
     *
     * @param node
     */
    isFormat(node, formatName) {
        return node.is(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"]) && !!node.modifiers.find(format => format.name === formatName);
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return a user-friendly representation of the node
     *
     * @param {VNode} node
     * @returns {string}
     */
    _getNodeRepr(node) {
        if (node === this.env.editor.selection.anchor) {
            return _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["ANCHOR_CHAR"];
        }
        if (node === this.env.editor.selection.focus) {
            return _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["FOCUS_CHAR"];
        }
        if (node.name) {
            return Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_0__["toUnicode"])(node.name).replace(/Node/, '');
        }
        return '?';
    }
    /**
     * Return a set of the IDs of all ancestors of both selection marker nodes.
     */
    _getSelectionMarkersAncestors() {
        const selectionMarkersAncestors = new Set();
        let ancestor = this.env.editor.selection.anchor.parent;
        while (ancestor) {
            selectionMarkersAncestors.add(ancestor.id);
            ancestor = ancestor.parent;
        }
        ancestor = this.env.editor.selection.focus.parent;
        while (ancestor) {
            selectionMarkersAncestors.add(ancestor.id);
            ancestor = ancestor.parent;
        }
        return selectionMarkersAncestors;
    }
}
// This is a recursive Component: each node of the tree is itself a tree
TreeComponent.components = { TreeComponent };


/***/ }),

/***/ "./packages/plugin-devtools/src/utils.ts":
/*!***********************************************!*\
  !*** ./packages/plugin-devtools/src/utils.ts ***!
  \***********************************************/
/*! exports provided: argsRepr */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "argsRepr", function() { return argsRepr; });
function argsRepr(args) {
    if (args === undefined)
        return '';
    return `{ ${Object.keys(args)
        .map(key => key + ': ' + args[key])
        .join(', ')} }`;
}


/***/ }),

/***/ "./packages/plugin-dialog/src/Dialog.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-dialog/src/Dialog.ts ***!
  \**********************************************/
/*! exports provided: Dialog */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Dialog", function() { return Dialog; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _ui_DialogZoneHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui/DialogZoneHtmlDomRenderer */ "./packages/plugin-dialog/src/ui/DialogZoneHtmlDomRenderer.ts");
/* harmony import */ var _ui_DialogZoneXmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ui/DialogZoneXmlDomParser */ "./packages/plugin-dialog/src/ui/DialogZoneXmlDomParser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");






class Dialog extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_ui_DialogZoneXmlDomParser__WEBPACK_IMPORTED_MODULE_3__["DialogZoneXmlDomParser"]],
            renderers: [_ui_DialogZoneHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__["DialogZoneHtmlDomRenderer"]],
        };
    }
}
Dialog.dependencies = [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_4__["Renderer"], _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_5__["DomLayout"]];


/***/ }),

/***/ "./packages/plugin-dialog/src/ui/Dialog.css":
/*!**************************************************!*\
  !*** ./packages/plugin-dialog/src/ui/Dialog.css ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../../../node_modules/css-loader/dist/cjs.js!./Dialog.css */ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-dialog/src/ui/Dialog.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/plugin-dialog/src/ui/Dialog.xml":
/*!**************************************************!*\
  !*** ./packages/plugin-dialog/src/ui/Dialog.xml ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<jw-dialog>\n    <jw-backdrop class=\"jw-close\"></jw-backdrop>\n    <jw-content>\n        <jw-button class=\"jw-close\">❌</jw-button>\n    </jw-content>\n</jw-dialog>\n"

/***/ }),

/***/ "./packages/plugin-dialog/src/ui/DialogZoneHtmlDomRenderer.ts":
/*!********************************************************************!*\
  !*** ./packages/plugin-dialog/src/ui/DialogZoneHtmlDomRenderer.ts ***!
  \********************************************************************/
/*! exports provided: DialogZoneHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DialogZoneHtmlDomRenderer", function() { return DialogZoneHtmlDomRenderer; });
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _DialogZoneNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DialogZoneNode */ "./packages/plugin-dialog/src/ui/DialogZoneNode.ts");
/* harmony import */ var _Dialog_xml__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Dialog.xml */ "./packages/plugin-dialog/src/ui/Dialog.xml");
/* harmony import */ var _Dialog_xml__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(_Dialog_xml__WEBPACK_IMPORTED_MODULE_3__);
/* harmony import */ var _Dialog_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Dialog.css */ "./packages/plugin-dialog/src/ui/Dialog.css");
/* harmony import */ var _Dialog_css__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_Dialog_css__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");






const container = document.createElement('jw-container');
container.innerHTML = _Dialog_xml__WEBPACK_IMPORTED_MODULE_3___default.a;
const dialog = container.firstElementChild;
class DialogZoneHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_1__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _DialogZoneNode__WEBPACK_IMPORTED_MODULE_2__["DialogZoneNode"];
    }
    async render(node) {
        const float = document.createElement('jw-dialog-container');
        for (const child of node.childVNodes) {
            if (!node.hidden.get(child)) {
                float.appendChild(await this._renderDialog(child));
            }
        }
        return float.childNodes.length ? [float] : [document.createDocumentFragment()];
    }
    async _renderDialog(node) {
        const clone = dialog.cloneNode(true);
        const content = clone.querySelector('jw-content');
        for (const domNode of await this.engine.render(node)) {
            content.appendChild(domNode);
        }
        let componentId;
        const components = this.engine.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_5__["Layout"]).engines.dom.components;
        for (const [id, nodes] of components) {
            if (nodes.includes(node)) {
                componentId = id;
            }
        }
        clone.addEventListener('click', (ev) => {
            const target = ev.target;
            if (target.classList.contains('jw-close')) {
                this.engine.editor.execCommand('hide', { componentID: componentId });
            }
        });
        return clone;
    }
}
DialogZoneHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dialog/src/ui/DialogZoneNode.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-dialog/src/ui/DialogZoneNode.ts ***!
  \*********************************************************/
/*! exports provided: DialogZoneNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DialogZoneNode", function() { return DialogZoneNode; });
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");

class DialogZoneNode extends _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"] {
}


/***/ }),

/***/ "./packages/plugin-dialog/src/ui/DialogZoneXmlDomParser.ts":
/*!*****************************************************************!*\
  !*** ./packages/plugin-dialog/src/ui/DialogZoneXmlDomParser.ts ***!
  \*****************************************************************/
/*! exports provided: DialogZoneXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DialogZoneXmlDomParser", function() { return DialogZoneXmlDomParser; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _DialogZoneNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DialogZoneNode */ "./packages/plugin-dialog/src/ui/DialogZoneNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");




class DialogZoneXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'T-DIALOG';
        };
    }
    async parse(item) {
        const zones = [];
        for (const child of item.querySelectorAll('t[t-zone]')) {
            zones.push(child.getAttribute('t-zone'));
        }
        return [new _DialogZoneNode__WEBPACK_IMPORTED_MODULE_2__["DialogZoneNode"](zones)];
    }
}
DialogZoneXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-divider/src/Divider.ts":
/*!************************************************!*\
  !*** ./packages/plugin-divider/src/Divider.ts ***!
  \************************************************/
/*! exports provided: Divider */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Divider", function() { return Divider; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _DividerXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DividerXmlDomParser */ "./packages/plugin-divider/src/DividerXmlDomParser.ts");


class Divider extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_DividerXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["DividerXmlDomParser"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-divider/src/DividerNode.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-divider/src/DividerNode.ts ***!
  \****************************************************/
/*! exports provided: DividerNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DividerNode", function() { return DividerNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class DividerNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor() {
        super({ htmlTag: 'DIV' });
    }
}


/***/ }),

/***/ "./packages/plugin-divider/src/DividerXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-divider/src/DividerXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: DividerXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DividerXmlDomParser", function() { return DividerXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _DividerNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./DividerNode */ "./packages/plugin-divider/src/DividerNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class DividerXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'DIV';
        };
    }
    async parse(item) {
        const divider = new _DividerNode__WEBPACK_IMPORTED_MODULE_2__["DividerNode"]();
        divider.modifiers.append(this.engine.parseAttributes(item));
        const nodes = await this.engine.parse(...item.childNodes);
        divider.append(...nodes);
        return [divider];
    }
}
DividerXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-editable/src/DomEditable.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-dom-editable/src/DomEditable.ts ***!
  \*********************************************************/
/*! exports provided: DomEditable */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomEditable", function() { return DomEditable; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-dom-layout/src/DomLayout */ "./packages/plugin-dom-layout/src/DomLayout.ts");
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _EventNormalizer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./EventNormalizer */ "./packages/plugin-dom-editable/src/EventNormalizer.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");








class DomEditable extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor(editor, configuration) {
        super(editor, configuration);
        this.loadables = {
            renderers: [],
            components: [
                {
                    id: 'editable',
                    render: async () => {
                        const parseElement = this.configuration.source;
                        let root;
                        if (parseElement) {
                            const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]);
                            const domLayoutEngine = layout.engines.dom;
                            const node = await domLayoutEngine.parseElement(parseElement);
                            root = node[0];
                        }
                        else {
                            root = new _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_6__["VElement"]({ htmlTag: 'jw-editable' });
                            // Semantic elements are inline by default.
                            // We need to guarantee it's a block so it can contain
                            // other blocks.
                            root.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_7__["Attributes"]).set('style', 'display: block;');
                        }
                        root.editable = false;
                        root.breakable = false;
                        root.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_7__["Attributes"]).set('contentEditable', 'true');
                        if (!this.editor.selection.anchor.parent && this.configuration.autoFocus) {
                            this.editor.selection.setAt(root, _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_5__["RelativePosition"].INSIDE);
                        }
                        return [root];
                    },
                },
            ],
            componentZones: [['editable', 'main']],
        };
        this.commands = {
            selectAll: {
                handler: this.selectAll,
            },
        };
        this._processKeydown = this._processKeydown.bind(this);
    }
    async start() {
        this.eventNormalizer = new _EventNormalizer__WEBPACK_IMPORTED_MODULE_3__["EventNormalizer"](this._isInEditable.bind(this), this._onNormalizedEvent.bind(this));
        window.addEventListener('keydown', this._processKeydown);
    }
    async stop() {
        this.eventNormalizer.destroy();
        window.removeEventListener('keydown', this._processKeydown);
    }
    /**
     * Update the selection in such a way that it selects the entire document.
     *
     * @param params
     */
    selectAll() {
        const domEngine = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]).engines.dom;
        const editable = domEngine.components.get('editable')[0];
        this.editor.selection.set({
            anchorNode: editable.firstLeaf(),
            anchorPosition: _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_5__["RelativePosition"].BEFORE,
            focusNode: editable.lastLeaf(),
            focusPosition: _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_5__["RelativePosition"].AFTER,
            direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD,
        });
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    _isInEditable(target) {
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        let nodes = domLayoutEngine.getNodes(target);
        while (!nodes.length && target) {
            if (target.previousSibling) {
                target = target.previousSibling;
            }
            else {
                target = target.parentNode;
            }
            nodes = domLayoutEngine.getNodes(target);
        }
        const node = nodes === null || nodes === void 0 ? void 0 : nodes.pop();
        const ancestorContentEditable = node === null || node === void 0 ? void 0 : node.closest(node => { var _a; return !!((_a = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_7__["Attributes"])) === null || _a === void 0 ? void 0 : _a.get('contentEditable')); });
        return ((ancestorContentEditable === null || ancestorContentEditable === void 0 ? void 0 : ancestorContentEditable.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_7__["Attributes"]).get('contentEditable')) === 'true');
    }
    /**
     * Handle the received signal and dispatch the corresponding editor command,
     * based on the user's configuration and context.
     *
     * @param action
     */
    _matchCommand(action) {
        switch (action.type) {
            case 'insertLineBreak':
                return ['insertLineBreak', {}];
            case 'insertText':
            case 'insertHtml': {
                const params = { text: action.text };
                return ['insertText', params];
            }
            case 'selectAll':
                return ['selectAll', {}];
            case 'setSelection': {
                const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]);
                const domLayoutEngine = layout.engines.dom;
                const vSelectionParams = {
                    vSelection: domLayoutEngine.parseSelection(action.domSelection),
                };
                return ['setSelection', vSelectionParams];
            }
            case 'insertParagraphBreak':
                return ['insertParagraphBreak', {}];
            case 'deleteWord':
                // TODO: extract range
                if (action.direction === _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD) {
                    return ['deleteForward', { range: {} }];
                }
                else {
                    return ['deleteBackward', { range: {} }];
                }
            case 'deleteContent': {
                if (action.direction === _core_src_VSelection__WEBPACK_IMPORTED_MODULE_2__["Direction"].FORWARD) {
                    return ['deleteForward', {}];
                }
                else {
                    return ['deleteBackward', {}];
                }
            }
            default:
                break;
        }
    }
    /**
     * Handle the received signal and dispatch the corresponding editor command,
     * based on the user's configuration and context.
     *
     * @param batchPromise
     */
    async _onNormalizedEvent(batchPromise) {
        return this.editor.nextEventMutex(async () => {
            const batch = await batchPromise;
            let processed = false;
            if (batch.inferredKeydownEvent) {
                const domLayout = this.dependencies.get(_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_1__["DomLayout"]);
                processed = !!(await domLayout.processKeydown(new KeyboardEvent('keydown', {
                    ...batch.inferredKeydownEvent,
                    key: batch.inferredKeydownEvent.key,
                    code: batch.inferredKeydownEvent.code,
                })));
            }
            if (!processed) {
                for (const action of batch.actions) {
                    try {
                        const commandSpec = this._matchCommand(action);
                        if (commandSpec) {
                            await this.editor.execCommand(...commandSpec);
                        }
                    }
                    catch (e) {
                        console.error('impossible to launch action', action);
                    }
                }
            }
        });
    }
    /**
     * In DomLayout, KeyboardEvent listener to be added to the DOM that calls
     * `execCommand` if the keys pressed match one of the shortcut registered
     * in the keymap.
     * In case of the keydow are defaultPrevented it's means we executed a new
     * command. We split the event agragation of normalizer to ensure to have
     * the next execCommand at the right time.
     *
     * @param event
     */
    _processKeydown(event) {
        if (event.defaultPrevented) {
            this.eventNormalizer.initNextObservation();
        }
    }
}
DomEditable.dependencies = [_plugin_dom_layout_src_DomLayout__WEBPACK_IMPORTED_MODULE_1__["DomLayout"], _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_4__["Layout"]];


/***/ }),

/***/ "./packages/plugin-dom-editable/src/EventNormalizer.ts":
/*!*************************************************************!*\
  !*** ./packages/plugin-dom-editable/src/EventNormalizer.ts ***!
  \*************************************************************/
/*! exports provided: EventNormalizer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "EventNormalizer", function() { return EventNormalizer; });
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _MutationNormalizer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MutationNormalizer */ "./packages/plugin-dom-editable/src/MutationNormalizer.ts");
/* harmony import */ var _utils_src_polyfill__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/polyfill */ "./packages/utils/src/polyfill.ts");
/* harmony import */ var _utils_src_Dom__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/Dom */ "./packages/utils/src/Dom.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");





const navigationKey = new Set([
    'ArrowUp',
    'ArrowDown',
    'ArrowLeft',
    'ArrowRight',
    'PageUp',
    'PageDown',
    'End',
    'Home',
]);
const inputTypeCommands = new Set([
    'historyUndo',
    'historyRedo',
    'formatBold',
    'formatItalic',
    'formatUnderline',
    'formatStrikeThrough',
    'formatSuperscript',
    'formatSubscript',
    'formatJustifyFull',
    'formatJustifyCenter',
    'formatJustifyRight',
    'formatJustifyLeft',
    'formatIndent',
    'formatOutdent',
    'formatRemove',
    'formatSetBlockTextDirection',
    'formatSetInlineTextDirection',
    'formatBackColor',
    'formatFontColor',
    'formatFontName',
]);
/*
 * Regexp to test if a character is within an alphabet known by us.
 *
 * Note: Not all alphabets are taken into consideration and this RegExp is subject to be completed
 *       as more alphabets will be covered.
 *
 * Unicode range source:
 * - wikipedia
 * - google translate
 * - https://jrgraphix.net/r/Unicode/
 *
 * Tool to generate RegExp range:
 * - https://apps.timwhitlock.info/js/regex
 *
 * The strategy is to separate any word by selecting subsequent characters of a common alphabet.
 */
const alphabetsContainingSpaces = new RegExp('(' +
    [
        '[а-яА-ЯЀ-ӿԀ-ԯ]+',
        '[Ͱ-Ͼἀ-῾]+',
        '[\u0530-\u058F]+',
        '[\u0600-۾ݐ-ݾ\u08a0-\u08fe]+',
        '[\u0900-\u0DFF]+',
        '[a-zA-Z]+',
        '[a-zA-ZÀ-ÿ]+',
        '[a-zA-ZĀ-ſ]+',
        '[a-zA-Zƀ-ɏ]+',
    ].join('|') +
    ')$');
/**
 * These javascript event types might, in case of safari or spell-checking
 * keyboard, trigger dom events in multiple javascript stacks. They will require
 * to observe events during two ticks rather than after a single tick.
 */
const MultiStackEventTypes = ['input', 'compositionend', 'selectAll'];
/**
 * Create a promise that resolve once a timeout finish or when calling
 * `executeAndClear`.
 */
class Timeout {
    constructor(fn, interval = 0) {
        this.fn = fn;
        this.pending = true;
        this.promise = new Promise((resolve) => {
            this._resolve = resolve;
            this.id = window.setTimeout(() => {
                this.pending = false;
                resolve(fn());
            }, interval);
        });
    }
    fire(result) {
        clearTimeout(this.id);
        this.pending = false;
        if (result) {
            this._resolve(result);
        }
        else {
            this._resolve(this.fn());
        }
    }
}
/**
 * ## The problems the normalizer solve
 * Browser and virtual keyboards on mobile does not implement properly the w3c
 * contenteditable specification and are inconsistent.
 *
 * ## Goal of the normalizer
 * 1. Hook any change that happend in an element called the `editable`.
 * 2. Trigger the same event for the same action accross all browsers and
 *    devices.
 *
 * ## Strategy
 * Hook all javascript events that modify the `editable` element. Then, trigger
 * normalized events.
 *
 * ## How to use this normalizer?
 * 1. Javascript Events occurs
 * 2. Normalize javascript one or more `Event` to one or more
 *    `NormalizedAction`.
 * 3. Update our `VDocument` in regard of triggered normalized actions.
 * 4. Render what changed in the `VDocument` HTML in the `editable`.
 *
 * The normalizer does not preventDefault most of the change in the editable
 * happen (the exception for "paste" and "drop" javascript event).
 *
 *
 * ## Handeling javascript events
 * A javascript event is almost never prevented and almost always alter the
 * editable in the DOM.
 *
 * The reason that we do not prevent default is because we need more
 * informations. The information modified in the dom (by observing observing
 * mutations).
 *
 * There is an exception for the event 'paste' and 'drop'.
 *
 * The reason to preventDefault 'paste' is because most of the time, browsers
 * paste content that need to be cleaned. For that reason we prevent it from
 * being inserted in the editable element but the informations can be found in
 * the triggered normalized events actions.
 *
 * The reason to preventDefault 'drop' is because some browsers change page when
 * dropping an image or an url that comes from the address bar (e.g. chrome).
 *
 * ## Supported browser and virtual keyboard
 * - Mac
 *   - Chrome
 *   - Firefox
 *   - Edge
 *   - Safari
 * - Windows
 *   - Chrome
 *   - Firefox
 *   - Edge
 *   - Safari
 * - Linux
 *   - Chrome
 *   - Firefox
 * - Android
 *   - Chrome
 *   - Firefox
 *   - Google keyboard
 *   - Swift keyboard
 * - IOS
 *   - Safari
 *   - Chrome
 *   - Firefox
 */
class EventNormalizer {
    /**
     *
     * @param _isInEditable Callback to check if the node is in editable.
     * @param _triggerEventBatch Callback to trigger for each user action.
     */
    constructor(_isInEditable, _triggerEventBatch, root = document) {
        this._isInEditable = _isInEditable;
        this._triggerEventBatch = _triggerEventBatch;
        /**
         * Event listeners that are bound in the DOM by the normalizer on creation
         * and unbound on destroy.
         */
        this._eventListeners = [];
        /**
         * Cache the state of modifiers keys on each keystrokes.
         */
        this._modifierKeys = {
            ctrlKey: false,
            altKey: false,
            metaKey: false,
            shiftKey: false,
        };
        /**
         * Map of the shadow dom event normalizer.
         * If an event is triggered inside a shadow dom, we instanciate a new
         * EventNormalizer in the shadow dom.
         */
        this._shadowNormalizers = new Map();
        this.initNextObservation();
        // const document = this.editable.ownerDocument;
        this._bindEventInEditable(root, 'compositionstart', this._registerEvent);
        this._bindEventInEditable(root, 'compositionupdate', this._registerEvent);
        this._bindEventInEditable(root, 'compositionend', this._registerEvent);
        this._bindEventInEditable(root, 'beforeinput', this._registerEvent);
        this._bindEventInEditable(root, 'input', this._registerEvent);
        this._bindEvent(document, 'selectionchange', this._onSelectionChange);
        this._bindEventInEditable(root, 'contextmenu', this._onContextMenu);
        this._bindEvent(root, 'mousedown', this._onPointerDown);
        this._bindEvent(root, 'touchstart', this._onPointerDown);
        this._bindEvent(root, 'mouseup', this._onPointerUp);
        this._bindEvent(root, 'touchend', this._onPointerUp);
        this._bindEventInEditable(root, 'keydown', this._onKeyDownOrKeyPress);
        this._bindEventInEditable(root, 'keypress', this._onKeyDownOrKeyPress);
        this._bindEvent(root, 'onkeyup', this._updateModifiersKeys);
        this._bindEventInEditable(root, 'cut', this._onClipboard);
        this._bindEventInEditable(root, 'paste', this._onClipboard);
        this._bindEventInEditable(root, 'dragstart', this._onDragStart);
        this._bindEventInEditable(root, 'drop', this._onDrop);
        this._mutationNormalizer = new _MutationNormalizer__WEBPACK_IMPORTED_MODULE_1__["MutationNormalizer"](root instanceof Document ? root.body : root.lastElementChild);
    }
    /**
     * Called when destroy the event normalizer.
     * Remove all added handlers.
     *
     */
    destroy() {
        this._mutationNormalizer.destroy();
        this._unbindEvents();
        this._shadowNormalizers.forEach(eventNormalizer => eventNormalizer.destroy());
        this._triggerEventBatch = null;
        this._isInEditable = null;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Bind the occurence of given even type on the given target element to the
     * given listener function. See _unbindEvents to unbind all events bound by
     * calling this function.
     *
     * @param target element on which to listen for events
     * @param type of the event to listen
     * @param listener to call when the even occurs on the target
     */
    _bindEvent(target, type, listener) {
        const boundListener = listener.bind(this);
        this._eventListeners.push({
            target: target,
            type: type,
            listener: boundListener,
        });
        target.addEventListener(type, boundListener, true);
    }
    /**
     * Filter event from editable.
     *
     * @see _bindEvent
     *
     * @param target element on which to listen for events
     * @param type of the event to listen
     * @param listener to call when the even occurs on the target
     */
    _bindEventInEditable(target, type, listener) {
        const boundListener = (ev) => {
            const eventTarget = 'target' in ev && ev.target;
            const shadowRoot = eventTarget instanceof Element && eventTarget.shadowRoot;
            if (shadowRoot) {
                if (!this._shadowNormalizers.get(shadowRoot)) {
                    const eventNormalizer = new EventNormalizer(this._isInEditable, this._triggerEventBatch, shadowRoot);
                    this._shadowNormalizers.set(shadowRoot, eventNormalizer);
                }
            }
            else if (!eventTarget || this._isInEditable(eventTarget)) {
                listener.call(this, ev);
            }
        };
        this._bindEvent(target, type, boundListener);
    }
    /**
     * Unbind all events bound by calls to _bindEvent.
     *
     */
    _unbindEvents() {
        this._eventListeners.forEach(({ target, type, listener }) => {
            target.removeEventListener(type, listener, true);
        });
    }
    /**
     * Register given event on the this.currentStackObservation._events queue. If the queue is not yet
     * initialized or has been cleared prior to this call, re-initialize it.
     * After a tick (setTimeout 0ms) the '_processEvents' method is called. All
     * events that happened during the tick are read from the queue and the
     * analysis tries to extract the actions desired by the user such as insert,
     * delete, backspace, spell checking, special characters, etc.
     *
     * @see _processEvents
     */
    _registerEvent(ev) {
        var _a, _b, _c;
        // See comment on `_keyboardSelectionTimeout`.
        if ((_a = this._keyboardSelectionTimeout) === null || _a === void 0 ? void 0 : _a.pending) {
            this._keyboardSelectionTimeout.fire();
        }
        // See comment on `_pointerSelectionTimeout`.
        if ((_b = this._pointerSelectionTimeout) === null || _b === void 0 ? void 0 : _b.pending) {
            this._pointerSelectionTimeout.fire();
        }
        const isNavigationEvent = ev instanceof KeyboardEvent && ev.type === 'keydown' && navigationKey.has(ev.key);
        if (isNavigationEvent) {
            // Manually triggering the processing of the current stack at this
            // point forces the rendering in the DOM of the result of the
            // observed events. This ensures that the new selection that is
            // eventually going to be set by the browser actually targets nodes
            // that are properly recognized in our abstration, which would not
            // be the case otherwise. See comment on `_stackTimeout`.
            if ((_c = this._stackTimeout) === null || _c === void 0 ? void 0 : _c.pending) {
                this._stackTimeout.fire();
            }
            // TODO: no rendering in editable can happen before the analysis of
            // the selection. There should be a mechanism here that can be used
            // by the normalizer to block the rendering until this resolves.
            this._keyboardSelectionTimeout = new Timeout(async () => {
                const setSelectionAction = {
                    type: 'setSelection',
                    domSelection: this._getSelection(),
                };
                return { actions: [setSelectionAction], mutatedElements: new Set([]) };
            });
            this._triggerEventBatch(this._keyboardSelectionTimeout.promise);
            this.initNextObservation();
        }
        else {
            if (this.currentStackObservation._events.length === 0) {
                // The queue is not initialized or has been reset, so this is a
                // new user action. Re-initialize the queue such that the
                // analysis is not polluted by previous observations.
                // this.initNextObservation();
                const stack = this.currentStackObservation;
                // Start observing mutations.
                this._mutationNormalizer.start();
                // All events of this tick will be processed in the next one.
                this._stackTimeout = new Timeout(() => {
                    return this._processEvents(stack);
                });
                this._triggerEventBatch(this._stackTimeout.promise);
            }
            // It is possible to have multiples keys that must trigger multiples
            // times that are being push in the same tick. To be able to handle
            // this case in `_processEvents`, we aggregate the informations in
            // `_multiKeyStack`.
            if (['keydown', 'keypress', 'input'].includes(ev.type)) {
                // In the multiple key case, a 'keydown' is always the first
                // event triggered between the three (keydown, keypress, input).
                // So we create a new map each time a 'keydown' is registred.
                if (ev.type === 'keydown') {
                    this.currentStackObservation._multiKeyStack.push({});
                }
                const lastMultiKeys = this.currentStackObservation._multiKeyStack[this.currentStackObservation._multiKeyStack.length - 1];
                if (lastMultiKeys) {
                    lastMultiKeys[ev.type] = ev;
                }
            }
            this.currentStackObservation._eventsMap[ev.type] = ev;
            if (ev.type.startsWith('composition')) {
                // In most cases we only need the last composition of the
                // registred events
                this.currentStackObservation._eventsMap.lastComposition = ev;
            }
            this.currentStackObservation._events.push(ev);
        }
    }
    /**
     * This function is the root of the normalization for most events.
     *
     * Process the events registered with `_regiterEvent` and call
     * `_triggerEventBatch` with one or more `NormalizedEvent` when sufficient
     * information has been gathered from all registred events.
     *
     * It could take up to two tick in the browser to gather all the sufficient
     * information. (e.g. Safari)
     *
     */
    /**
     * In some cases, the observation must be delayed to the next tick. In these
     * cases, this control variable will be set to true such that the analysis
     * process knows the current event queue processing has been delayed.
     */
    async _processEvents(currentStackObservation, secondTickObservation = false) {
        // In some cases, for example cutting with Cmd+X on Safari, the browser
        // triggers events in two different stacks. In such cases, observing
        // events occuring during one tick is not enough so we need to delay the
        // analysis after we observe events during two ticks instead.
        const needSecondTickObservation = currentStackObservation._events.every(ev => {
            return !MultiStackEventTypes.includes(ev.type);
        });
        if (needSecondTickObservation && !secondTickObservation) {
            return await new Promise((resolve) => {
                setTimeout(() => {
                    resolve(this._processEvents(currentStackObservation, true));
                });
            });
        }
        let normalizedActions = [];
        const keydownEvent = currentStackObservation._eventsMap.keydown;
        const keypressEvent = currentStackObservation._eventsMap.keypress;
        const inputEvent = currentStackObservation._eventsMap.input;
        const keyboardSelectAllEvent = currentStackObservation._eventsMap.keyboardSelectAll;
        const compositionEvent = currentStackObservation._eventsMap.lastComposition;
        const cutEvent = currentStackObservation._eventsMap.cut;
        const dropEvent = currentStackObservation._eventsMap.drop;
        const pasteEvent = currentStackObservation._eventsMap.paste;
        const compositionData = this._getCompositionData(compositionEvent, inputEvent);
        const isGoogleKeyboardBackspace = compositionData &&
            compositionData.compositionFrom.slice(0, -1) === compositionData.compositionTo &&
            keydownEvent &&
            keydownEvent.key === 'Unidentified';
        const inferredKeydownEvent = keydownEvent &&
            keydownEvent.key === 'Unidentified' &&
            this._inferKeydownEvent(inputEvent);
        //
        // First pass to get the informations
        //
        const key = (keypressEvent &&
            keypressEvent.key !== 'Unidentified' &&
            keypressEvent.key !== 'Dead' &&
            keypressEvent.key) ||
            (inputEvent &&
                inputEvent.data !== null &&
                inputEvent.data.length === 1 &&
                inputEvent.data) ||
            (keydownEvent &&
                keydownEvent.key !== 'Unidentified' &&
                keydownEvent.key !== 'Dead' &&
                keydownEvent.key) ||
            (isGoogleKeyboardBackspace && 'Backspace') ||
            (keydownEvent &&
                keydownEvent.key === 'Unidentified' &&
                inferredKeydownEvent &&
                inferredKeydownEvent.code);
        const inputType = (cutEvent && 'deleteByCut') ||
            (dropEvent && 'insertFromDrop') ||
            (pasteEvent && 'insertFromPaste') ||
            (inputEvent && inputEvent.inputType);
        // In case of accent inserted from a Mac, check that the char before was
        // one of the special accent temporarily inserted in the DOM (e.g. '^',
        // '`', ...).
        //
        const compositionReplaceOneChar = compositionData &&
            compositionData.compositionFrom.length === 1 &&
            compositionData.compositionTo.length === 1;
        const compositionAddOneChar = compositionData &&
            compositionData.compositionFrom === '' &&
            compositionData.compositionTo.length === 1;
        const isCompositionKeyboard = compositionAddOneChar || compositionReplaceOneChar;
        const isVirtualKeyboard = compositionEvent && key && key.length !== 1;
        // Compute the set of mutated elements accross all observed events.
        const mutatedElements = this._mutationNormalizer.getMutatedElements();
        this._mutationNormalizer.stop();
        // When the browser trigger multiples keydown at once, for each keydown
        // there is always also a keypress and an input that must be present.
        const possibleMultiKeydown = currentStackObservation._multiKeyStack.every(keydownMap => keydownMap.keydown &&
            keydownMap.keydown.key !== 'Unidentified' &&
            (keydownMap.input || keydownMap.keydown.key.length > 1));
        // if there is only one _multiKeyMap, it means that there is no
        // multiples keys pushed.
        if (currentStackObservation._multiKeyStack.length > 1 && possibleMultiKeydown) {
            currentStackObservation._multiKeyStack.map(keydownMap => {
                const keyboardAction = this._getKeyboardAction(keydownMap.keydown.key, (keydownMap.input && keydownMap.input.inputType) || '', !!mutatedElements.size);
                if (keyboardAction) {
                    normalizedActions.push(keyboardAction);
                }
            });
        }
        else if (cutEvent) {
            const deleteContentAction = {
                type: 'deleteContent',
                direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
            };
            // remove previously parsed keyboard action as we only want to remove
            normalizedActions.push(deleteContentAction);
        }
        else if (dropEvent) {
            normalizedActions.push(...this._getDropActions(dropEvent));
        }
        else if (pasteEvent) {
            normalizedActions.push(this._getDataTransferAction(pasteEvent));
        }
        else if (keyboardSelectAllEvent) {
            const selectAllAction = {
                type: 'selectAll',
            };
            normalizedActions.push(selectAllAction);
        }
        else if (normalizedActions.length === 0 &&
            ((!compositionEvent && key) || isCompositionKeyboard || isVirtualKeyboard)) {
            const keyboardAction = this._getKeyboardAction(key, inputType, !!mutatedElements.size);
            if (keyboardAction) {
                normalizedActions.push(keyboardAction);
            }
            if (compositionReplaceOneChar) {
                normalizedActions = compositionData.actions;
            }
        }
        else if (normalizedActions.length === 0 && compositionData) {
            normalizedActions.push(...compositionData.actions);
        }
        if (inputEvent && inputEvent.inputType && inputEvent.inputType.indexOf('format') === 0) {
            const formatName = inputEvent.inputType.replace('format', '').toLowerCase();
            const applyFormatAction = {
                type: 'applyFormat',
                format: formatName,
                data: inputEvent.data,
            };
            normalizedActions.push(applyFormatAction);
        }
        else if (inputEvent && ['historyUndo', 'historyRedo'].includes(inputEvent.inputType)) {
            const historyAction = {
                type: inputEvent.inputType,
            };
            normalizedActions.push(historyAction);
        }
        this.initNextObservation();
        if (normalizedActions.length > 0) {
            const batch = {
                actions: normalizedActions,
                mutatedElements,
            };
            if (inferredKeydownEvent) {
                batch.inferredKeydownEvent = inferredKeydownEvent;
            }
            return batch;
        }
        return { actions: [] };
    }
    /**
     * Set the next observation.
     */
    initNextObservation() {
        this._followsPointerAction = false;
        this.currentStackObservation = {
            _events: [],
            _multiKeyStack: [],
            _eventsMap: {},
        };
    }
    _getCompositionData(compositionEvent, inputEvent) {
        if (compositionEvent && inputEvent) {
            let compositionDataString = compositionEvent.data;
            // Specific case for SwiftKey. Swiftkey add a space in the
            // inputEvent but not in the composition event.
            const isSwiftKeyAutocorrect = inputEvent.inputType === 'insertText' &&
                inputEvent.data &&
                inputEvent.data.length === 1 &&
                inputEvent.data !== compositionDataString &&
                inputEvent.data === ' ';
            if (isSwiftKeyAutocorrect) {
                compositionDataString += ' ';
            }
            return this._getCompositionFromString(compositionDataString);
        }
        else if (inputEvent && inputEvent.inputType === 'insertReplacementText') {
            // safari trigger an input with 'insertReplacementText' when it
            // correct a word.
            return this._getCompositionFromString(inputEvent.data);
        }
    }
    /**
     * Infer a `KeyboardEvent` `code` from an `InputEvent`
     */
    _inferKeydownEvent(inputEvent) {
        let code;
        if (inputEvent.inputType === 'insertParagraph') {
            code = 'Enter';
        }
        else if (inputEvent.inputType === 'deleteContentBackward') {
            code = 'Backspace';
        }
        else if (inputEvent.inputType === 'deleteContentForward') {
            code = 'Delete';
        }
        if (code) {
            return {
                ...this._modifierKeys,
                key: code,
                code: code,
            };
        }
    }
    /**
     * Get a keyboard action if something has happned in the DOM (insert,
     * delete, navigation).
     *
     * @param key
     * @param inputType
     * @param hasMutataedElements
     * @param isMultiKey
     */
    _getKeyboardAction(key, inputType, hasMutatedElements) {
        const isInsertOrRemoveAction = hasMutatedElements && !inputTypeCommands.has(inputType);
        if (isInsertOrRemoveAction) {
            if (key === 'Backspace' || key === 'Delete') {
                return this._getRemoveAction(key, inputType);
            }
            else if (key === 'Enter') {
                if (inputType === 'insertLineBreak') {
                    const insertLineBreakAction = {
                        type: 'insertLineBreak',
                    };
                    return insertLineBreakAction;
                }
                else {
                    const insertParagraphAction = {
                        type: 'insertParagraphBreak',
                    };
                    return insertParagraphAction;
                }
            }
            else if (key.length === 1) {
                const insertTextAction = {
                    type: 'insertText',
                    text: key,
                };
                return insertTextAction;
            }
        }
    }
    /**
     * Get the actions for a event `ev` of type drop.
     *
     * @param ev
     */
    _getDropActions(ev) {
        const actions = [];
        if (ev.draggingFromEditable && !ev.files.length) {
            const selection = document.getSelection();
            if (!selection.isCollapsed) {
                const deleteContentAction = {
                    type: 'deleteContent',
                    direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
                };
                actions.push(deleteContentAction);
            }
        }
        const setSelectionAction = {
            type: 'setSelection',
            domSelection: ev.selection,
        };
        actions.push(setSelectionAction);
        actions.push(this._getDataTransferAction(ev));
        return actions;
    }
    /**
     * Extract informations from dataTranser to know what has been done in the
     * DOM and return it a normalizedAction.
     *
     * when drag and dropping, most browsers wrap the element with tags and
     * styles.  And when dropping in the (same or different) browser, there is
     * many differents behavior.
     *
     * Some browser reload the page when dropping (img or link (from status
     * bar)).  For this reason, we block all the content from being added in the
     * editable. (otherwise reloading happen).
     *
     * Note: The user can drag and drop a link or an img, from the browser
     * navigation bar.
     *
     */
    _getDataTransferAction(dataTransfer) {
        if (dataTransfer.files.length) {
            const insertFilesAction = {
                type: 'insertFiles',
                files: dataTransfer.files,
            };
            return insertFilesAction;
        }
        const uri = dataTransfer['text/uri-list'];
        // eslint-disable-next-line no-control-regex
        const html = dataTransfer['text/html'].replace(/\x00/g, ''); // replace for drag&drop from firefox to chrome
        const text = dataTransfer['text/plain'];
        if (html && uri) {
            const temp = document.createElement('temp');
            temp.innerHTML = html;
            const element = temp.querySelector('a, img');
            if (element) {
                if (!dataTransfer.draggingFromEditable &&
                    Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(element) === 'A' &&
                    element.innerHTML === '') {
                    // add default content if it's external link
                    element.innerHTML = uri;
                }
                const insertHtmlAction = {
                    type: 'insertHtml',
                    html: element.outerHTML,
                    text: uri,
                };
                return insertHtmlAction;
            }
            else {
                const insertHtmlAction = {
                    type: 'insertHtml',
                    html: html,
                    text: uri,
                };
                return insertHtmlAction;
            }
        }
        else if (html) {
            const insertHtmlAction = {
                type: 'insertHtml',
                // Cross browser drag & drop will add useless meta tag at the
                // beginning of the html.
                html: html && html.replace(/^<meta[^>]+>/, ''),
                text: text,
            };
            return insertHtmlAction;
        }
        else if (uri) {
            const insertHtmlAction = {
                type: 'insertHtml',
                html: '<a href="' + uri + '">' + uri + '</a>',
                text: uri,
            };
            return insertHtmlAction;
        }
        else {
            const insertTextAction = {
                type: 'insertText',
                text: text,
            };
            return insertTextAction;
        }
    }
    /**
     * Process the composition to identify the text that was inserted.
     *
     * Attention, there is a case impossible to retrieve the complete
     * information. In the case of we don't have the event data and mutation
     * and we might have "a b" change from a composition to "a c". We receive
     * the word change "b" to "c" instead of "a b" to "a c".
     *
     */
    _getCompositionFromString(compositionData) {
        const charMap = this._mutationNormalizer.getCharactersMapping();
        // The goal of this function is to precisely find what was inserted by
        // a keyboard supporting spell-checking and suggestions.
        // Example (`|` represents the text cursor):
        //   Previous content: 'My friend Christofe| was here.'
        //   Current content:  'My friend Christophe Matthieu| was here.'
        //   Actual text inserted by the keyboard: 'Christophe Matthieu'
        let index = charMap.index;
        let insert = charMap.insert;
        let remove = charMap.remove;
        if (insert === remove && compositionData) {
            insert = compositionData;
            remove = compositionData;
        }
        // In mutation:
        // - we get the changes
        // - try to extract the word or a part of the word (with or without
        //   position)
        // - locate: where the change has been made
        const selection = this._getSelection();
        // if index === -1 it means we could not find the position in the mutated elements
        if (index === -1) {
            // It is possible that the index of the observed change are
            // undefined
            // Example (`|` represents the collapsed selection):
            //   Previous content: 'aa aa aa| aa aa'
            //   Current content:  'aa aa aa aa| aa aa'
            //   Actual text inserted by the keyboard: 'aa '
            //   Observed change:  'aa ]aa aa aa aa[ aa'
            // TODO CHM: the below min/max does not cover all cases
            // With most spell-checking mobile keyboards, the range is set right
            // after the inserted text. It can then be used as a marker to
            // identify the end of the change.
            let insertEnd = 0;
            // The text has been flattened in the characters mapping. When
            // the index of the node has been found, use the range offset
            // to find the index of the character proper.
            insertEnd += selection.focusOffset;
            index = insertEnd - insert.length;
        }
        else {
            let offset = index + insert.length - 1;
            if (charMap.current.nodes[offset] &&
                (selection.focusNode !== charMap.current.nodes[offset] ||
                    selection.focusOffset !== charMap.current.offsets[offset] + 1)) {
                offset++;
                while (charMap.current.nodes[offset] &&
                    (selection.focusNode !== charMap.current.nodes[offset] ||
                        selection.focusOffset > charMap.current.offsets[offset])) {
                    const text = charMap.current.chars[offset];
                    insert += text;
                    remove += text;
                    offset++;
                }
            }
        }
        const before = charMap.previous.chars.slice(0, index);
        const match = before.match(alphabetsContainingSpaces);
        if (match &&
            (insert === '' || alphabetsContainingSpaces.test(insert)) &&
            (remove === '' || alphabetsContainingSpaces.test(remove))) {
            // the word is write in a alphabet who contain space, search
            // to complete the change and include the rest of the word
            const beginWord = match[1];
            remove = beginWord + remove;
            insert = beginWord + insert;
            index -= beginWord.length;
            // Some virtual keyboards (e.g. SwiftKey) add a space at the end of
            // each composition such that the insert is ' '. We filter out those
            // events.
        }
        else if (compositionData &&
            insert &&
            (remove || insert !== ' ') &&
            compositionData !== insert) {
            const charIndex = compositionData.lastIndexOf(insert);
            if (charIndex !== -1) {
                index -= charIndex;
                insert = compositionData;
                const len = remove.length + charIndex;
                remove = charMap.previous.chars.slice(index, index + len + 1);
            }
        }
        // Trim the trailing space added by some virtual keyboards (e.g.
        // SwiftKey).
        const removedEndSpace = remove[remove.length - 1] === ' ';
        const insertedEndSpace = insert[insert.length - 1] === ' ';
        let rawRemove = remove;
        let rawInsert = insert;
        if (insertedEndSpace && removedEndSpace) {
            rawRemove = rawRemove.slice(0, -1);
        }
        if (insertedEndSpace) {
            rawInsert = rawInsert.slice(0, -1);
        }
        const previousNodes = charMap.previous.nodes;
        const previousOffsets = charMap.previous.offsets;
        const lastPreviousNode = previousNodes[previousNodes.length - 1];
        const lastPreviousOffset = previousOffsets[previousOffsets.length - 1] + 1;
        const offsetEnd = index + rawRemove.length;
        const setSelectionAction = {
            type: 'setSelection',
            domSelection: {
                anchorNode: previousNodes[index] || lastPreviousNode,
                anchorOffset: index in previousOffsets ? previousOffsets[index] : lastPreviousOffset,
                focusNode: previousNodes[offsetEnd] || lastPreviousNode,
                focusOffset: offsetEnd in previousOffsets ? previousOffsets[offsetEnd] : lastPreviousOffset,
                direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
            },
        };
        const insertTextAction = {
            type: 'insertText',
            text: rawInsert,
        };
        const actions = [setSelectionAction, insertTextAction];
        if (insertedEndSpace) {
            if (removedEndSpace) {
                index += rawRemove.length;
                const setSelectionAction = {
                    type: 'setSelection',
                    domSelection: {
                        anchorNode: previousNodes[index],
                        anchorOffset: previousOffsets[index],
                        focusNode: previousNodes[offsetEnd],
                        focusOffset: previousOffsets[index + 1],
                        direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
                    },
                };
                actions.push(setSelectionAction);
            }
            const insertTextAction = {
                type: 'insertText',
                text: ' ',
            };
            actions.push(insertTextAction);
        }
        return {
            compositionFrom: remove,
            compositionTo: insert,
            actions: actions,
        };
    }
    /**
     * Process the given compiled event as a backspace/delete to identify the
     * text that was removed and return an array of the corresponding
     * NormalizedAction.
     *
     * In the case of cut event, the direction will be `Direction.FORWARD`.
     *
     */
    _getRemoveAction(key, inputType) {
        const direction = key === 'Backspace' ? _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].BACKWARD : _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD;
        // Get characterMapping to retrieve which word has been deleted.
        const characterMapping = this._mutationNormalizer.getCharactersMapping();
        const isSwiftKeyDeleteWord = (inputType === 'deleteContentForward' || inputType === 'deleteContentBackward') &&
            characterMapping.remove.length > 1;
        if (inputType === 'deleteWordForward' ||
            inputType === 'deleteWordBackward' ||
            isSwiftKeyDeleteWord) {
            const deleteWordAction = {
                type: 'deleteWord',
                direction: direction,
                text: characterMapping.remove,
            };
            return deleteWordAction;
        }
        if (inputType === 'deleteHardLineForward' ||
            inputType === 'deleteHardLineBackward' ||
            inputType === 'deleteSoftLineForward' ||
            inputType === 'deleteSoftLineBackward') {
            const deleteHardLineAction = {
                type: 'deleteHardLine',
                direction: direction,
                domSelection: {
                    anchorNode: characterMapping.previous.nodes[characterMapping.index],
                    anchorOffset: characterMapping.previous.offsets[characterMapping.index],
                    focusNode: characterMapping.previous.nodes[characterMapping.index + characterMapping.remove.length - 1],
                    focusOffset: characterMapping.previous.offsets[characterMapping.index + characterMapping.remove.length - 1] + 1,
                    direction: direction,
                },
            };
            return deleteHardLineAction;
        }
        const deleteContentAction = {
            type: 'deleteContent',
            direction: direction,
        };
        return deleteContentAction;
    }
    /**
     * Return true if the given node can be considered a textual node, that is
     * a text node or a BR node.
     *
     * @param node
     */
    _isTextualNode(node) {
        return node.nodeType === Node.TEXT_NODE || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(node) === 'BR';
    }
    /**
     * Get the current selection from the DOM. If there is no selection in the
     * DOM, return a fake one at offset 0 of the editable element.
     * If an event is given, then the selection must be at least partially
     * contained in the target of the event, otherwise it means it took no
     * part in it. In this case, return the caret position instead.
     *
     * @param [ev]
     */
    _getSelection(ev) {
        var _a;
        let selectionDescription;
        let target;
        let root;
        if (ev) {
            target = this._getEventTarget(ev);
            root = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["getDocument"])(target);
        }
        else if ((_a = this._initialCaretPosition) === null || _a === void 0 ? void 0 : _a.offsetNode) {
            root = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["getDocument"])(this._initialCaretPosition.offsetNode);
        }
        else {
            root = document;
        }
        const selection = root.getSelection();
        let forward;
        if (!selection || selection.rangeCount === 0) {
            // No selection in the DOM. Create a fake one.
            selectionDescription = {
                anchorNode: document.body,
                anchorOffset: 0,
                focusNode: document.body,
                focusOffset: 0,
                direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
            };
        }
        else {
            // The selection direction is sorely missing from the DOM api.
            const nativeRange = selection.getRangeAt(0);
            if (selection.anchorNode === selection.focusNode) {
                forward = selection.anchorOffset <= selection.focusOffset;
            }
            else {
                forward = selection.anchorNode === nativeRange.startContainer;
            }
            selectionDescription = {
                anchorNode: selection.anchorNode,
                anchorOffset: selection.anchorOffset,
                focusNode: selection.focusNode,
                focusOffset: selection.focusOffset,
                direction: forward ? _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD : _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].BACKWARD,
            };
        }
        // If an event is given, then the range must be at least partially
        // contained in the target of the event, otherwise it means it took no
        // part in it. In this case, consider the caret position instead.
        // This can happen when target is an input or a contenteditable=false.
        if (target instanceof Node) {
            if (!target.contains(selectionDescription.anchorNode) &&
                !target.contains(selectionDescription.focusNode)) {
                const caretPosition = this._getEventCaretPosition(ev);
                selectionDescription = {
                    anchorNode: caretPosition.offsetNode,
                    anchorOffset: caretPosition.offset,
                    focusNode: caretPosition.offsetNode,
                    focusOffset: caretPosition.offset,
                    direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
                };
            }
        }
        return selectionDescription;
    }
    /**
     * Check if the given range is selecting the whole editable.
     *
     * @param selection
     */
    _isSelectAll(selection) {
        // The selection from the context menu or a shortcut never have
        // direction forward.
        if (selection.direction === _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].BACKWARD) {
            return false;
        }
        let startContainer = selection.anchorNode;
        let startOffset = selection.anchorOffset;
        let endContainer = selection.focusNode;
        let endOffset = selection.focusOffset;
        // The selection might still be on a node which has since been removed.
        let invalidStart = true;
        let domNode = startContainer;
        while (domNode && invalidStart) {
            if (domNode instanceof ShadowRoot) {
                domNode = domNode.host;
            }
            else if (document.body.contains(domNode)) {
                invalidStart = false;
            }
            else {
                domNode = domNode.parentNode;
            }
        }
        let invalidEnd = true;
        domNode = endContainer;
        while (domNode && invalidEnd) {
            if (domNode instanceof ShadowRoot) {
                domNode = domNode.host;
            }
            else if (document.body.contains(domNode)) {
                invalidEnd = false;
            }
            else {
                domNode = domNode.parentNode;
            }
        }
        const invalidSelection = invalidStart || invalidEnd;
        // The selection might be collapsed in which case there is no selection.
        const onlyOneNodeSelected = startContainer === endContainer;
        const noCharacterSelected = startOffset === endOffset;
        const isCollapsed = onlyOneNodeSelected && noCharacterSelected;
        // If the selection is invalid or the selection is collapsed, it
        // definitely does not correspond to a select all action.
        if (invalidSelection || isCollapsed) {
            return false;
        }
        [startContainer, startOffset] = Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_3__["targetDeepest"])(startContainer, startOffset);
        [endContainer, endOffset] = Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_3__["targetDeepest"])(endContainer, endOffset);
        if (startOffset !== 0 ||
            (endContainer.nodeType === Node.TEXT_NODE &&
                endOffset !== endContainer.textContent.length)) {
            return false;
        }
        // Look for visible nodes in editable that would be outside the selection.
        const startInside = this._isInEditable(startContainer);
        const endInside = this._isInEditable(endContainer);
        const startEdge = startInside && this._isAtVisibleEdge(startContainer, 'start');
        const endEdge = endInside && this._isAtVisibleEdge(endContainer, 'end');
        return (startEdge && endEdge) || (startEdge && !endInside) || (!startInside && endEdge);
    }
    /**
     * Return true if the given element is at the edge of the editable node in
     * the given direction. An element is considered at the edge of the editable
     * node if there is no other visible element in editable that is located
     * beyond it in the given direction.
     *
     * @param node to check whether it is at the visible edge
     * @param side from which to look for textual nodes ('start' or 'end')
     */
    _isAtVisibleEdge(node, side) {
        const element = node instanceof Element ? node : node.parentElement;
        const editable = element.closest('[contentEditable=true]');
        // Start from the top and do a depth-first search trying to find a
        // visible node that would be in editable and beyond the given element.
        let currentNode = editable;
        const child = side === 'start' ? 'firstChild' : 'lastChild';
        const sibling = side === 'start' ? 'nextSibling' : 'previousSibling';
        let crossVisible = false;
        while (currentNode) {
            if (currentNode === node) {
                // The element was reached without finding another visible node.
                return !crossVisible;
            }
            if (this._isTextualNode(currentNode) && this._isVisible(currentNode, editable)) {
                // There is a textual node in editable beyond the given element.
                crossVisible = true;
            }
            // Continue the depth-first search.
            if (currentNode[child]) {
                currentNode = currentNode[child];
            }
            else if (currentNode[sibling]) {
                currentNode = currentNode[sibling];
            }
            else if (currentNode.parentNode === editable) {
                // Depth-first search has checked all elements in editable.
                return true;
            }
            else {
                currentNode = currentNode.parentNode[sibling];
            }
        }
        return false;
    }
    /**
     * Determine if a node is considered visible.
     */
    _isVisible(el, editable) {
        if (el === document) {
            return false;
        }
        if (el === editable) {
            // The editable node was reached without encountering a hidden
            // container. The editable node is supposed to be visible.
            return true;
        }
        // A <br> element with no next sibling is never visible.
        if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(el) === 'BR' && !el.nextSibling) {
            return false;
        }
        const element = el.nodeType === Node.TEXT_NODE ? el.parentElement : el;
        const style = window.getComputedStyle(element);
        if (style.display === 'none' || style.visibility === 'hidden') {
            return false;
        }
        return this._isVisible(el.parentNode, editable);
    }
    /**
     * Return the node and offset targeted by a event, including if the target
     * is inside a shadow element
     *
     * @param ev
     */
    _getEventCaretPosition(ev) {
        const x = ev instanceof MouseEvent ? ev.clientX : ev.touches[0].clientX;
        const y = ev instanceof MouseEvent ? ev.clientY : ev.touches[0].clientY;
        let caretPosition = Object(_utils_src_polyfill__WEBPACK_IMPORTED_MODULE_2__["caretPositionFromPoint"])(x, y);
        if (!caretPosition || !this._isInEditable(caretPosition.offsetNode)) {
            caretPosition = { offsetNode: ev.target, offset: 0 };
        }
        return caretPosition;
    }
    /**
     * Use the position to get the target from the event (including the target
     * in shadow element)
     *
     * @param ev
     */
    _getEventTarget(ev) {
        const x = ev instanceof MouseEvent ? ev.clientX : ev.touches[0].clientX;
        const y = ev instanceof MouseEvent ? ev.clientY : ev.touches[0].clientY;
        return Object(_utils_src_polyfill__WEBPACK_IMPORTED_MODULE_2__["elementFromPoint"])(x, y) || ev.target;
    }
    //--------------------------------------------------------------------------
    // Handlers
    //--------------------------------------------------------------------------
    /**
     * Catch setSelection and selectAll actions
     *
     * @param {MouseEvent} ev
     */
    _onContextMenu(ev) {
        var _a;
        if ((_a = this._pointerSelectionTimeout) === null || _a === void 0 ? void 0 : _a.pending) {
            this._pointerSelectionTimeout.fire();
        }
        this._pointerSelectionTimeout = new Timeout(() => {
            if (!this._selectionHasChanged || this._currentlySelectingAll) {
                return { actions: [] };
            }
            this._initialCaretPosition = this._getEventCaretPosition(ev);
            const setSelectionAction = {
                type: 'setSelection',
                domSelection: this._getSelection(ev),
            };
            this._selectionHasChanged = false;
            return {
                actions: [setSelectionAction],
                mutatedElements: new Set([]),
            };
        });
        this._triggerEventBatch(this._pointerSelectionTimeout.promise);
        // The _clickedInEditable property is used to assess whether the user is
        // currently changing the selection by using the mouse. If the context
        // menu ends up opening, the user is definitely not selecting.
        this._mousedownInEditable = false;
    }
    /**
     * Catch Enter, Backspace, Delete and insert actions
     *
     * @param {KeyboardEvent} ev
     */
    _onKeyDownOrKeyPress(ev) {
        this._updateModifiersKeys(ev);
        this._registerEvent(ev);
        const selection = this._getSelection();
        const [offsetNode, offset] = Object(_utils_src_Dom__WEBPACK_IMPORTED_MODULE_3__["targetDeepest"])(selection.anchorNode, selection.anchorOffset);
        this._initialCaretPosition = { offsetNode, offset };
    }
    /**
     * Set internal properties of the pointer down event to retrieve them later
     * on when the user stops dragging its selection and the selection has
     * changed.
     *
     * @param {MouseEvent} ev
     */
    _onPointerDown(ev) {
        // Don't trigger events on the editable if the click was done outside of
        // the editable itself or on something else than an element.
        const target = this._getEventTarget(ev);
        if (target && this._isInEditable(target)) {
            this._mousedownInEditable = true;
            this._initialCaretPosition = this._getEventCaretPosition(ev);
            this._selectionHasChanged = false;
            this._followsPointerAction = true;
        }
        else {
            this._mousedownInEditable = false;
            this._initialCaretPosition = undefined;
        }
    }
    /**
     * Catch setSelection actions coming from clicks.
     *
     * @param ev
     */
    _onPointerUp(ev) {
        try {
            // Don't trigger events on the editable if the click was done outside of
            // the editable itself or on something else than an element.
            if (this._mousedownInEditable && ev.target instanceof Element) {
                // When the users clicks in the DOM, the range is set in the next
                // tick. The observation of the resulting range must thus be delayed
                // to the next tick as well. Store the data we have now before it
                // gets invalidated by the redrawing of the DOM.
                this._initialCaretPosition = this._getEventCaretPosition(ev);
                this._pointerSelectionTimeout = new Timeout(() => {
                    return this._analyzeSelectionChange(ev);
                });
                this._triggerEventBatch(this._pointerSelectionTimeout.promise);
            }
        }
        catch (e) {
            this._mousedownInEditable = false;
            this._initialCaretPosition = undefined;
        }
    }
    /**
     * Analyze a change of selection to trigger a pointer event for it.
     *
     * @param ev
     */
    _analyzeSelectionChange(ev) {
        const eventBatch = {
            actions: [],
            mutatedElements: new Set([]),
        };
        if (this._selectionHasChanged) {
            const setSelectionAction = {
                type: 'setSelection',
                domSelection: this._getSelection(ev),
            };
            eventBatch.actions.push(setSelectionAction);
        }
        return eventBatch;
    }
    /**
     * If the drag start event is observed by the normalizer, it means the
     * dragging started in the editable itself. It means the user is dragging
     * content around in the editable zone.
     *
     */
    _onDragStart() {
        this._draggingFromEditable = true;
    }
    /**
     * Convert the drop event into a custom pre-processed format in order to
     * store additional information that are specific to this point in time,
     * such as the current range and the initial caret position.
     *
     * In some browser we need to infer the drop from other events.
     *
     * Example of droppable object are file, text, url.
     *
     * Drop event can originate from another software, outside the editor zone
     * or inside the editor zone.
     *
     * @param ev
     */
    _onDrop(ev) {
        // Prevent default behavior (e.g. prevent file from being opened in the
        // current tab).
        ev.preventDefault();
        const transfer = ev.dataTransfer;
        const files = [];
        for (const item of transfer.items) {
            if (item.kind === 'file') {
                files.push(item.getAsFile());
            }
        }
        const caretPosition = this._getEventCaretPosition(ev);
        const dropEvent = {
            type: 'drop',
            'text/plain': transfer.getData('text/plain'),
            'text/html': transfer.getData('text/html'),
            'text/uri-list': transfer.getData('text/uri-list'),
            files: files,
            originalEvent: ev,
            selection: {
                anchorNode: caretPosition.offsetNode,
                anchorOffset: caretPosition.offset,
                focusNode: caretPosition.offsetNode,
                focusOffset: caretPosition.offset,
                direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_0__["Direction"].FORWARD,
            },
            caretPosition: caretPosition,
            draggingFromEditable: this._draggingFromEditable,
        };
        this._registerEvent(dropEvent);
        // Dragging is over, reset this property.
        this._draggingFromEditable = false;
    }
    /**
     * Convert the clipboard event into a custom pre-processed format in order
     * to store additional information that are specific to this point in time,
     * such as the current range and the initial caret position.
     *
     * @param ev
     */
    _onClipboard(ev) {
        if (ev.type === 'paste') {
            // Prevent the default browser wild pasting behavior.
            ev.preventDefault();
        }
        const clipboard = ev.clipboardData;
        const pasteEvent = {
            type: ev.type,
            'text/plain': clipboard.getData('text/plain'),
            'text/html': clipboard.getData('text/html'),
            'text/uri-list': clipboard.getData('text/uri-list'),
            files: [],
            originalEvent: ev,
            selection: this._getSelection(),
            caretPosition: this._initialCaretPosition,
            draggingFromEditable: false,
        };
        this._registerEvent(pasteEvent);
    }
    /**
     * Update the modifiers keys to know which modifiers keys are pushed.
     *
     * @param e
     */
    _updateModifiersKeys(e) {
        this._modifierKeys = {
            ctrlKey: e.ctrlKey,
            altKey: e.altKey,
            metaKey: e.metaKey,
            shiftKey: e.shiftKey,
        };
    }
    /**
     * On each change of selection, check if it might be a "selectAll" action.
     *
     * A "selectAll" action can be triggered by:
     * - The shortcut 'CTRL+A'
     * - A user mapping of the OS or browser
     * - From the context menu
     * - Programmatically
     */
    _onSelectionChange() {
        if (!this._initialCaretPosition) {
            // Filter the events because we can have some Shadow root and each
            // normaliser bind event on document.
            return;
        }
        const keydownEvent = this.currentStackObservation._eventsMap.keydown;
        const isNavEvent = keydownEvent instanceof KeyboardEvent &&
            keydownEvent.type === 'keydown' &&
            navigationKey.has(keydownEvent.key);
        if (isNavEvent) {
            const setSelectionAction = {
                type: 'setSelection',
                domSelection: this._getSelection(),
            };
            this.initNextObservation();
            this._triggerEventBatch(new Promise((resolve) => {
                setTimeout(() => {
                    resolve({ actions: [setSelectionAction] });
                });
            }));
        }
        else {
            this._selectionHasChanged = true;
            // This heuristic protects against a costly `_isSelectAll` call.
            const modifiedKeyEvent = this._modifierKeys.ctrlKey || this._modifierKeys.metaKey;
            const heuristic = modifiedKeyEvent || this._followsPointerAction;
            const isSelectAll = heuristic && this._isSelectAll(this._getSelection());
            if (isSelectAll && !this._currentlySelectingAll) {
                if (modifiedKeyEvent) {
                    // This select all was triggered from the keyboard. Add a
                    // fake selectAll event to the queue as a marker for
                    // `_processEvents` to register that a select all was
                    // triggered in this stack.
                    this._registerEvent(new CustomEvent('keyboardSelectAll'));
                }
                else {
                    // The target of the select all specifies where the user caret
                    // was when the select all was triggered.
                    const selectAllAction = {
                        type: 'selectAll',
                    };
                    // We did not find any case where a select all triggered
                    // from the mouse actually resulted in a mutation, so the
                    // mutation normalizer is not listnening in this case. If it
                    // happens to be insufficient later on, the mutated elements
                    // will need to be retrieved from the mutation normalizer.
                    this._triggerEventBatch(Promise.resolve({
                        actions: [selectAllAction],
                        mutatedElements: new Set(),
                    }));
                }
            }
            // Safari on MacOS triggers a selection change when pressing Ctrl
            // even though the selection did not actually change. This property
            // is used to store whether the current state is considered to be a
            // select all. The point is to avoid triggering a new event for a
            // selection change if everything was already selected beforehand.
            this._currentlySelectingAll = isSelectAll;
        }
    }
}


/***/ }),

/***/ "./packages/plugin-dom-editable/src/MutationNormalizer.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-dom-editable/src/MutationNormalizer.ts ***!
  \****************************************************************/
/*! exports provided: MutationNormalizer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MutationNormalizer", function() { return MutationNormalizer; });
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");

class MutationNormalizer {
    constructor(el = document.body) {
        this._observer = new MutationObserver(this._onMutation.bind(this));
        this._observer.observe(el, {
            characterDataOldValue: true,
            characterData: true,
            childList: true,
            subtree: true,
        });
    }
    start() {
        this._listen = true;
        this._mutations = [];
    }
    /**
     * Extract a mapping of the separate characters, their corresponding text
     * nodes and their offsets in said nodes from the given node's subtree.
     *
     * @private
     * @param charMutations
     * @returns { previous, current }
     */
    getCharactersMapping() {
        const before = new Set();
        const add = new Set();
        const current = new Set();
        const textMutations = [];
        // Gather all modified nodes to notify the listener.
        function getSelfAndAllChildren(target) {
            const texts = [target];
            target.childNodes.forEach(target => {
                texts.push(...getSelfAndAllChildren(target));
            });
            return texts;
        }
        function isTextNode(target) {
            return target.nodeType === Node.TEXT_NODE || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_0__["nodeName"])(target) === 'BR';
        }
        this._mutations.forEach(record => {
            const targetMutation = record.target;
            const targetIsAdded = add.has(targetMutation);
            if (!targetIsAdded) {
                before.add(targetMutation);
            }
            if (record.type === 'characterData') {
                current.add(targetMutation);
                textMutations.push({
                    target: targetMutation,
                    old: record.oldValue.replace(/\u00A0/g, ' '),
                    current: targetMutation.textContent.replace(/\u00A0/g, ' '),
                });
            }
            else {
                record.addedNodes.forEach(node => {
                    getSelfAndAllChildren(node).forEach(child => {
                        if (!before.has(child)) {
                            add.add(child);
                        }
                        current.add(child);
                        if (!isTextNode(child)) {
                            return;
                        }
                        textMutations.push({
                            target: child,
                            old: '',
                            current: child.nodeType === Node.TEXT_NODE
                                ? child.textContent.replace(/\u00A0/g, ' ')
                                : '\n',
                        });
                    });
                });
                record.removedNodes.forEach(node => {
                    getSelfAndAllChildren(node).forEach(child => {
                        if (current.has(child)) {
                            current.delete(child);
                        }
                        if (targetIsAdded) {
                            add.add(child);
                        }
                        if (!add.has(child)) {
                            before.add(child);
                        }
                        if (!isTextNode(child)) {
                            return;
                        }
                        textMutations.push({
                            target: child,
                            old: child.nodeType === Node.TEXT_NODE
                                ? child.textContent.replace(/\u00A0/g, ' ')
                                : '\n',
                            current: '',
                        });
                    });
                });
            }
        });
        const already = new Map();
        const charMutations = [];
        textMutations.forEach(textMutation => {
            const target = textMutation.target;
            let mutation = already.get(target);
            if (mutation) {
                if (current.has(target) && !mutation.current.length) {
                    mutation.current = textMutation.current;
                }
                return;
            }
            if (current.has(target)) {
                mutation = {
                    target: target,
                    old: before.has(target) ? textMutation.old : '',
                    current: textMutation.current,
                };
                charMutations.push(mutation);
            }
            else if (before.has(target)) {
                mutation = {
                    target: target,
                    old: textMutation.old,
                    current: '',
                };
                charMutations.push(mutation);
            }
            already.set(target, mutation);
        });
        const currentLinked = this._getCharLinked(charMutations, 'current');
        const previousLinked = this._getCharLinked(charMutations, 'old');
        const oldText = previousLinked.chars;
        const currentText = currentLinked.chars;
        if (oldText === currentText) {
            return {
                index: -1,
                insert: '',
                remove: '',
                previous: previousLinked,
                current: currentLinked,
            };
        }
        const changePosition = this._changedOffset(oldText, currentText);
        const minLength = Math.min(oldText.length, currentText.length);
        let insertByChange;
        const unknownPosition = changePosition.left > minLength - changePosition.right;
        if (unknownPosition) {
            const maxLength = Math.max(oldText.length, currentText.length);
            const len = maxLength - minLength;
            insertByChange = currentText.slice(currentText.length - changePosition.right);
            for (let k = 0; k + len < minLength; k++) {
                if (insertByChange[k - 1] === ' ') {
                    insertByChange = insertByChange.slice(k);
                    break;
                }
            }
            insertByChange = insertByChange.slice(0, len);
            return {
                index: -1,
                insert: insertByChange,
                remove: '',
                previous: previousLinked,
                current: currentLinked,
            };
        }
        else {
            insertByChange = currentText.slice(changePosition.left, currentText.length - changePosition.right);
        }
        let fineChangePosition;
        let insertedWordAnalysed;
        if (textMutations.length > 1) {
            let alreadyFound = false;
            for (let k = textMutations.length - 1; k >= 0; k--) {
                const charMutation = textMutations[k];
                if (charMutation.old.length >= charMutation.current.length) {
                    continue;
                }
                let currentChange;
                if (charMutation.old !== '') {
                    if (alreadyFound) {
                        continue;
                    }
                    const oldTextMutation = charMutation.old;
                    const currentTextMutation = charMutation.current;
                    const resMutation = this._changedOffset(oldTextMutation, currentTextMutation);
                    currentChange = currentTextMutation.slice(resMutation.left, currentTextMutation.length - resMutation.right);
                }
                else if (charMutation.current === currentText) {
                    continue;
                }
                else {
                    currentChange = charMutation.current;
                }
                const changeIndex = currentChange.indexOf(insertByChange);
                if (changeIndex === -1) {
                    continue;
                }
                const indexStart = currentText.indexOf(currentChange);
                const indexEnd = indexStart + currentChange.length;
                const rangeChangeStart = changePosition.left - changeIndex;
                const rangeChangeEnd = currentText.length - changePosition.right;
                if ((rangeChangeStart >= indexStart && rangeChangeStart < indexEnd) ||
                    (rangeChangeEnd > indexStart && rangeChangeEnd <= indexEnd) ||
                    (rangeChangeEnd >= indexEnd && rangeChangeStart <= indexStart)) {
                    fineChangePosition = {
                        left: indexStart,
                        right: currentText.length - indexEnd,
                    };
                    insertedWordAnalysed = currentChange;
                    alreadyFound = true;
                    if (charMutation.old === '') {
                        break;
                    }
                }
            }
        }
        if (typeof insertedWordAnalysed === 'undefined') {
            insertedWordAnalysed = insertByChange;
            let beforeIndex = insertedWordAnalysed.indexOf(insertByChange);
            if (insertByChange === '') {
                beforeIndex = insertedWordAnalysed.length;
            }
            else {
                beforeIndex = 0;
            }
            fineChangePosition = {
                left: changePosition.left - beforeIndex,
                right: changePosition.right,
            };
        }
        const removedWordAnalysed = oldText.slice(fineChangePosition.left, oldText.length - fineChangePosition.right);
        return {
            index: fineChangePosition.left,
            insert: insertedWordAnalysed,
            remove: removedWordAnalysed,
            previous: previousLinked,
            current: currentLinked,
        };
    }
    getMutatedElements() {
        const elements = new Set();
        this._mutations.forEach(MutationRecord => {
            if (MutationRecord.type === 'characterData') {
                elements.add(MutationRecord.target);
            }
            else {
                MutationRecord.addedNodes.forEach(target => elements.add(target));
                MutationRecord.removedNodes.forEach(target => elements.add(target));
            }
        });
        return elements;
    }
    stop() {
        this._listen = false;
    }
    /**
     * Called when destroy the mutation normalizer.
     * Remove all added handlers.
     *
     */
    destroy() {
        this._observer.disconnect();
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    _getCharLinked(charMutations, type) {
        const mapNodeValue = new WeakMap();
        const obj = {
            chars: '',
            nodes: [],
            offsets: [],
        };
        charMutations.forEach(charMutation => {
            mapNodeValue.set(charMutation.target, charMutation[type]);
            const len = charMutation[type].length;
            if (obj.nodes.length) {
                const charParented = new Set();
                let node = charMutation.target;
                while (node &&
                    (!(node instanceof Element) || !node.getAttribute('contentEditable'))) {
                    charParented.add(node);
                    node = node.parentNode;
                }
                let first = obj.nodes[0];
                while (first &&
                    (!(first instanceof Element) || !first.getAttribute('contentEditable'))) {
                    if (charParented.has(first.previousSibling)) {
                        obj.chars = charMutation[type] + obj.chars;
                        obj.nodes.unshift(...new Array(len).fill(charMutation.target));
                        obj.offsets.unshift(...Array(len).keys());
                        return;
                    }
                    first = first.parentNode;
                }
            }
            obj.chars += charMutation[type];
            obj.nodes.push(...new Array(len).fill(charMutation.target));
            obj.offsets.push(...Array(len).keys());
        });
        obj.chars = obj.chars.replace(/\u00A0/g, ' ');
        return obj;
    }
    _changedOffset(old, current) {
        // In the optimal case where both the range is correctly placed and the
        // data property of the composition event is correctly set, the above
        // analysis is capable of finding the precise text that was inserted.
        // However, if any of these two conditions are not met, the results
        // might be spectacularly wrong. For example, spell checking suggestions
        // on MacOS are displayed while hovering the mispelled word, regardless
        // of the current position of the range, and the correction does not
        // trigger an update of the range position either after correcting.
        // Example (`|` represents the text cursor):
        //   Previous content: 'My friend Christofe was here.|'
        //   Current content:  'My friend Christophe Matthieu was here.|'
        //   Actual text inserted by the keyboard: 'Christophe Matthieu'
        //   Result if data is set to 'Christophe' (length: 10): 'e was here'
        //   Result if data is not set (regardless of the range): ''
        //
        // Because the first analysis might not be enough in some cases, a
        // second analysis must be performed. This analysis aims at precisely
        // identifying the offset of the actual change in the text by comparing
        // the previous content with the current one from left to right to find
        // the start of the change and from right to left to find its end.
        // Example (`|` represents the text cursor):
        //   Previous content: 'My friend Christofe| was here.'
        //   Current content:  'My friend Christophe Matthieu| was here.'
        //   Observed change:  'My friend Christo[fe => phe Matthieu] was here.'
        //   Change offsets in the current content: {left: 17, right: 29}
        const oldText = old;
        const currentText = current;
        const maxLength = Math.max(oldText.length, currentText.length);
        let left = 0;
        for (; left < maxLength; left++) {
            if (oldText[left] !== currentText[left]) {
                break;
            }
        }
        let right = 0;
        for (; right < maxLength; right++) {
            if (oldText[oldText.length - 1 - right] !== currentText[currentText.length - 1 - right]) {
                break;
            }
        }
        return { left, right };
    }
    //--------------------------------------------------------------------------
    // Handlers
    //--------------------------------------------------------------------------
    _onMutation(mutationsList) {
        if (this._listen) {
            // we push the mutation because some browser (e.g. safari) separate mutations with
            // microtask.
            this._mutations.push(...mutationsList);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-dom-layout/src/DomLayout.ts":
/*!*****************************************************!*\
  !*** ./packages/plugin-dom-layout/src/DomLayout.ts ***!
  \*****************************************************/
/*! exports provided: DomLayout */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomLayout", function() { return DomLayout; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _ui_DomLayoutEngine__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ui/DomLayoutEngine */ "./packages/plugin-dom-layout/src/ui/DomLayoutEngine.ts");
/* harmony import */ var _plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-html/src/Html */ "./packages/plugin-html/src/Html.ts");
/* harmony import */ var _ui_ZoneHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ui/ZoneHtmlDomRenderer */ "./packages/plugin-dom-layout/src/ui/ZoneHtmlDomRenderer.ts");
/* harmony import */ var _ui_ZoneXmlDomParser__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ui/ZoneXmlDomParser */ "./packages/plugin-dom-layout/src/ui/ZoneXmlDomParser.ts");
/* harmony import */ var _ui_LayoutContainerHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./ui/LayoutContainerHtmlDomRenderer */ "./packages/plugin-dom-layout/src/ui/LayoutContainerHtmlDomRenderer.ts");
/* harmony import */ var _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../plugin-keymap/src/Keymap */ "./packages/plugin-keymap/src/Keymap.ts");










class DomLayout extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor(editor, configuration) {
        super(editor, configuration);
        this.loadables = {
            renderers: [_ui_ZoneHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_6__["ZoneHtmlDomRenderer"], _ui_LayoutContainerHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_8__["LayoutContainerHtmlDomRenderer"]],
            parsers: [_ui_ZoneXmlDomParser__WEBPACK_IMPORTED_MODULE_7__["ZoneXmlDomParser"]],
            layoutEngines: [],
            components: [],
        };
        this.loaders = {
            domLocations: this._loadComponentLocations,
        };
        this.commandHooks = {
            '*': this._redraw,
        };
        this.loadables.layoutEngines.push(_ui_DomLayoutEngine__WEBPACK_IMPORTED_MODULE_4__["DomLayoutEngine"]);
        this.processKeydown = this.processKeydown.bind(this);
    }
    async start() {
        var _a, _b;
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        for (const component of this.configuration.components || []) {
            domLayoutEngine.loadComponent(component);
        }
        const zones = {};
        for (const [id, zone] of this.configuration.componentZones || []) {
            zones[id] = zone;
        }
        domLayoutEngine.loadComponentZones(zones);
        this._loadComponentLocations(this.configuration.locations || []);
        domLayoutEngine.location = this.configuration.location;
        await domLayoutEngine.start();
        await ((_b = (_a = this.configuration).afterRender) === null || _b === void 0 ? void 0 : _b.call(_a));
        window.addEventListener('keydown', this.processKeydown, true);
    }
    async stop() {
        window.removeEventListener('keydown', this.processKeydown, true);
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        await domLayoutEngine.stop();
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * KeyboardEvent listener to be added to the DOM that calls `execCommand` if
     * the keys pressed match one of the shortcut registered in the keymap.
     *
     * @param event
     */
    async processKeydown(event) {
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        if (event.target && !domLayoutEngine.getNodes(event.target).length) {
            // Don't process keydown if the user is outside the current editor
            return;
        }
        const keymap = this.dependencies.get(_plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_9__["Keymap"]);
        const commands = keymap.match(event);
        const [command, context] = this.editor.contextManager.match(commands);
        if (command && command.commandId) {
            const params = { context, ...command.commandArgs };
            event.preventDefault();
            event.stopPropagation();
            event.stopImmediatePropagation();
            this.editor.nextEventMutex(() => {
                return this.editor.execCommand(command.commandId, params);
            });
            return command.commandId;
        }
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    async _redraw() {
        var _a, _b;
        // console.log('domlayout redraws');
        // TODO update this method to use JSON renderer feature (update also show, hide, add, remove)
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        const editables = domLayoutEngine.components.get('editable');
        if (editables === null || editables === void 0 ? void 0 : editables.length) {
            await domLayoutEngine.redraw(editables[0]);
            await ((_b = (_a = this.configuration).afterRender) === null || _b === void 0 ? void 0 : _b.call(_a));
        }
        // console.log('this.configuration.afterRender:', this.configuration.afterRender);
    }
    _loadComponentLocations(locations) {
        const layout = this.dependencies.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
        const domLayoutEngine = layout.engines.dom;
        for (const [id, location] of locations) {
            domLayoutEngine.locations[id] = location;
        }
    }
}
DomLayout.dependencies = [_plugin_html_src_Html__WEBPACK_IMPORTED_MODULE_5__["Html"], _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__["Renderer"], _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"], _plugin_keymap_src_Keymap__WEBPACK_IMPORTED_MODULE_9__["Keymap"]];


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ui/DomLayoutEngine.ts":
/*!**************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ui/DomLayoutEngine.ts ***!
  \**************************************************************/
/*! exports provided: DomLayoutEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomLayoutEngine", function() { return DomLayoutEngine; });
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _plugin_layout_src_LayoutEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-layout/src/LayoutEngine */ "./packages/plugin-layout/src/LayoutEngine.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/src/VSelection */ "./packages/core/src/VSelection.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./LayoutContainerNode */ "./packages/plugin-dom-layout/src/ui/LayoutContainerNode.ts");
/* harmony import */ var _DomMap__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./DomMap */ "./packages/plugin-dom-layout/src/ui/DomMap.ts");










class DomLayoutEngine extends _plugin_layout_src_LayoutEngine__WEBPACK_IMPORTED_MODULE_1__["LayoutEngine"] {
    constructor() {
        super(...arguments);
        this.id = 'dom';
        this._domMap = new _DomMap__WEBPACK_IMPORTED_MODULE_9__["DomMap"]();
        // used only to develop and avoid wrong promise from commands
        this._currentlyRedrawing = false;
        this.renderingMap = {};
        this.locations = {};
        this.defaultRootComponent = {
            id: 'editor',
            render(editor) {
                const layout = '<jw-editor><t t-zone="main"/><t t-zone="default"/></jw-editor>';
                return editor.plugins.get(_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_2__["Parser"]).parse('text/html', layout);
            },
        };
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    async start() {
        for (const componentId in this.locations) {
            this.renderingMap[componentId] = [];
            this.componentZones[componentId] = 'root';
            if (!this.componentDefinitions[componentId]) {
                throw new Error('Layout component "' + componentId + '" not found.');
            }
        }
        if (!Object.values(this.componentZones).includes('root')) {
            this.componentDefinitions.editor = this.defaultRootComponent;
            this.componentZones.editor = 'root';
        }
        for (const componentId in this.componentDefinitions) {
            this._prepareLayoutContainerAndLocation(this.componentDefinitions[componentId]);
        }
        await super.start();
        await this.redraw();
    }
    async stop() {
        for (const componentId in this.componentDefinitions) {
            const location = this.locations[componentId];
            if (location) {
                const nodes = this.components.get(componentId);
                for (const node of nodes) {
                    const domNodes = this.getDomNodes(node);
                    if (location[1] === 'replace') {
                        // Undo the replace that was done by the layout engine.
                        let first = domNodes && domNodes[0];
                        if (!first) {
                            first = this.renderingMap[componentId][0];
                        }
                        if (first && first.parentNode) {
                            first.parentNode.insertBefore(location[0], first);
                        }
                    }
                    for (const domNode of domNodes) {
                        if (domNode.parentNode) {
                            domNode.parentNode.removeChild(domNode);
                        }
                    }
                }
            }
        }
        this._domMap.clear();
        this.renderingMap = {};
        this.location = null;
        this.locations = {};
        return super.stop();
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return the VNode(s) corresponding to the given DOM Node.
     *
     * @param Node
     */
    getNodes(domNode) {
        const nodes = this._domMap.fromDom(domNode) || [];
        return nodes.filter(node => !(node instanceof _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_4__["ZoneNode"]));
    }
    getDomNodes(node) {
        if (node instanceof _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_8__["LayoutContainer"]) {
            return node.childVNodes.map(node => this.getDomNodes(node)).flat();
        }
        else {
            return this._domMap.toDom(node);
        }
    }
    /**
     * Redraw the layout component after insertion.
     * If the target zone is the root, prepare its location before redrawing.
     *
     * @override
     */
    async add(componentId, zoneId) {
        const nodes = await super.add(componentId, zoneId);
        // Filter out children of nodes that we are already going to redraw.
        const nodeToRedraw = nodes.filter(node => !node.ancestor(n => nodes.includes(n)));
        for (const node of nodeToRedraw) {
            // only used if the zone want to return a Node but hide the component (eg: a panel)
            await this.redraw(node);
        }
        return nodes;
    }
    /**
     * Redraw the layout component after removal.
     *
     * @override
     */
    async remove(componentId) {
        const zones = await super.remove(componentId);
        for (const zone of zones) {
            await this.redraw(zone);
        }
        return zones;
    }
    /**
     * Redraw the layout component after showing the component.
     *
     * @override
     */
    async show(componentId) {
        const nodes = await super.show(componentId);
        for (const node of nodes) {
            await this.redraw(node.ancestor(_plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_4__["ZoneNode"]));
        }
        return nodes;
    }
    /**
     * Redraw the layout component after hidding the component.
     *
     * @override
     */
    async hide(componentId) {
        const nodes = await super.hide(componentId);
        for (const node of nodes) {
            await this.redraw(node.ancestor(_plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_4__["ZoneNode"]));
        }
        return nodes;
    }
    async redraw(node) {
        // if (this._currentlyRedrawing) {
        //     throw new Error('Double redraw detected');
        // }
        if (this.editor.preventRenders.size)
            return;
        this._currentlyRedrawing = true;
        // Find the closest node that has already been rendered preciously.
        const nodeToRedraw = node === null || node === void 0 ? void 0 : node.closest(n => {
            const domNode = this._domMap.toDom(n).pop();
            return domNode === null || domNode === void 0 ? void 0 : domNode.ownerDocument.body.contains(domNode);
        });
        if (nodeToRedraw) {
            // redraw item
            const domNodeToRedraw = this._domMap.toDom(nodeToRedraw).pop();
            let componentIdentifier;
            for (const [componentId, nodes] of this.components) {
                if (nodes.includes(nodeToRedraw)) {
                    componentIdentifier = componentId;
                    break;
                }
            }
            if (this.locations[componentIdentifier]) {
                await this._renderNode(nodeToRedraw);
                await this._appendComponentInDom(componentIdentifier);
            }
            else {
                const parentNode = domNodeToRedraw.parentNode;
                const domNodes = await this._renderNode(nodeToRedraw);
                for (const domNode of domNodes) {
                    if (domNode !== domNodeToRedraw) {
                        if (!parentNode)
                            debugger;
                        parentNode.insertBefore(domNode, domNodeToRedraw);
                    }
                }
                const last = (domNodes === null || domNodes === void 0 ? void 0 : domNodes.length) && domNodes[domNodes.length - 1];
                if (last !== domNodeToRedraw) {
                    parentNode.removeChild(domNodeToRedraw);
                }
            }
        }
        else {
            // redraw all
            for (const componentId in this.locations) {
                const nodes = this.components.get(componentId);
                for (const node of nodes) {
                    await this._renderNode(node);
                }
                await this._appendComponentInDom(componentId);
            }
        }
        this._renderSelection();
        // this._currentlyRedrawing = false;
    }
    async parseElement(element) {
        const parser = this.editor.plugins.get(_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_2__["Parser"]);
        const domParserEngine = parser.engines['dom/html'];
        const parsedVNodes = await domParserEngine.parse(element);
        // Construct DOM map from the parsing in order to parse the selection.
        for (const node of parsedVNodes) {
            this._domMap.set(node, element);
        }
        for (const [domNode, nodes] of domParserEngine.parsingMap) {
            for (const node of nodes) {
                this._domMap.set(node, domNode);
            }
        }
        const domSelection = element.ownerDocument.getSelection();
        const anchorNode = domSelection.anchorNode;
        if (element === anchorNode || element.contains(anchorNode)) {
            const selection = this.parseSelection(domSelection);
            this.editor.selection.set(selection);
        }
        return parsedVNodes;
    }
    /**
     * Parse the dom selection into the description of a VSelection.
     *
     * @param selection
     * @param [direction]
     */
    parseSelection(selection) {
        const start = this._locate(selection.anchorNode, selection.anchorOffset);
        const end = this._locate(selection.focusNode, selection.focusOffset);
        const [startVNode, startPosition] = start;
        const [endVNode, endPosition] = end;
        let direction;
        if (selection instanceof Selection) {
            const domRange = selection.rangeCount && selection.getRangeAt(0);
            if (domRange.startContainer === selection.anchorNode &&
                domRange.startOffset === selection.anchorOffset) {
                direction = _core_src_VSelection__WEBPACK_IMPORTED_MODULE_6__["Direction"].FORWARD;
            }
            else {
                direction = _core_src_VSelection__WEBPACK_IMPORTED_MODULE_6__["Direction"].BACKWARD;
            }
        }
        else {
            direction = selection.direction;
        }
        return {
            anchorNode: startVNode,
            anchorPosition: startPosition,
            focusNode: endVNode,
            focusPosition: endPosition,
            direction: direction,
        };
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Render the given VSelection as a DOM selection in the given target.
     *
     * @param selection
     * @param target
     */
    _renderSelection() {
        const selection = this.editor.selection;
        const domNode = this._domMap.toDom(selection.anchor.parent)[0];
        if (!domNode) {
            return;
        }
        const document = domNode.ownerDocument;
        const anchor = this._getDomLocation(selection.anchor);
        const focus = this._getDomLocation(selection.focus);
        const domSelection = document.getSelection();
        if (domSelection.anchorNode === anchor[0] &&
            domSelection.anchorOffset === anchor[1] &&
            domSelection.focusNode === focus[0] &&
            domSelection.focusOffset === focus[1]) {
            return;
        }
        const domRange = domNode.ownerDocument.createRange();
        if (selection.direction === _core_src_VSelection__WEBPACK_IMPORTED_MODULE_6__["Direction"].FORWARD) {
            domRange.setStart(anchor[0], anchor[1]);
            domRange.collapse(true);
        }
        else {
            domRange.setEnd(anchor[0], anchor[1]);
            domRange.collapse(false);
        }
        domSelection.removeAllRanges();
        domSelection.addRange(domRange);
        domSelection.extend(focus[0], focus[1]);
    }
    async _appendComponentInDom(id) {
        var _a;
        let [target, position] = this.locations[id];
        const nodes = this.renderingMap[id];
        const first = nodes.find(node => node.parentNode && node.ownerDocument.body.contains(node));
        if (first === null || first === void 0 ? void 0 : first.previousSibling) {
            target = first.previousSibling;
            position = 'after';
        }
        else if ((_a = first === null || first === void 0 ? void 0 : first.parentNode) === null || _a === void 0 ? void 0 : _a.parentNode) {
            target = first.parentNode;
            position = 'prepend';
        }
        else {
            let previous = id;
            while ((previous = this._getPreviousComponentId(previous))) {
                const last = this.renderingMap[previous][this.renderingMap[previous].length - 1];
                if (last && last.ownerDocument.body.contains(last)) {
                    target = last;
                    position = 'after';
                }
            }
        }
        if (position === 'after' && !target.parentNode) {
            throw new Error('Impossible to render a component after an element with no parent.');
        }
        if (position === 'replace' && !target.parentNode) {
            throw new Error('Impossible to replace an element without any parent.');
        }
        const domNodes = [];
        for (const node of this.components.get(id)) {
            domNodes.push(...this.getDomNodes(node));
        }
        if (!domNodes.length && this.locations[id][1] === 'replace') {
            throw new Error('Impossible to replace a element with an empty template.');
        }
        if (position === 'after') {
            if (target.nextSibling) {
                for (const domNode of domNodes) {
                    target.parentNode.insertBefore(domNode, target.nextSibling);
                }
            }
            else {
                for (const domNode of domNodes) {
                    target.parentNode.appendChild(domNode);
                }
            }
        }
        else if (position === 'prepend') {
            const firstChild = target.firstChild;
            for (const domNode of domNodes) {
                target.insertBefore(domNode, firstChild);
            }
        }
        else if (position === 'replace') {
            for (const domNode of domNodes) {
                target.parentNode.insertBefore(domNode, target);
            }
            target.parentNode.removeChild(target);
        }
        else {
            for (const domNode of domNodes) {
                target.appendChild(domNode);
            }
        }
        for (const node of this.renderingMap[id]) {
            if (node.parentNode) {
                node.parentNode.removeChild(node);
            }
        }
        this.renderingMap[id] = domNodes;
    }
    _getPreviousComponentId(id) {
        const [target, position] = this.locations[id];
        const locations = Object.values(this.locations);
        const componentIds = Object.keys(this.locations);
        const index = componentIds.indexOf(id);
        if (position === 'after') {
            for (let u = index - 1; u >= 0; u--) {
                const [otherTarget, otherPosition] = locations[u];
                if (target === otherTarget &&
                    (otherPosition === 'after' || otherPosition === 'replace')) {
                    return componentIds[u];
                }
            }
            for (let u = locations.length - 1; u > index; u--) {
                const [otherTarget, otherPosition] = locations[u];
                if (target === otherTarget && otherPosition === 'replace') {
                    return componentIds[u];
                }
            }
        }
        else if (position === 'replace') {
            for (let u = index - 1; u >= 0; u--) {
                const [otherTarget, otherPosition] = locations[u];
                if (target === otherTarget && otherPosition === 'replace') {
                    return componentIds[u];
                }
            }
        }
    }
    /**
     * Return a position in the VNodes as a tuple containing a reference
     * node and a relative position with respect to this node ('BEFORE' or
     * 'AFTER'). The position is always given on the leaf.
     *
     * @param container
     * @param offset
     */
    _locate(domNode, domOffset) {
        let forceAfter = false;
        let forcePrepend = false;
        let container = domNode.childNodes[domOffset] || domNode;
        let offset = container === domNode ? domOffset : 0;
        if (container === domNode && container.childNodes.length) {
            container = container.childNodes[container.childNodes.length - 1];
            offset = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_5__["nodeLength"])(container);
            forceAfter = true;
        }
        while (!this.getNodes(container).length) {
            forceAfter = false;
            forcePrepend = false;
            if (container.previousSibling) {
                forceAfter = true;
                container = container.previousSibling;
                offset = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_5__["nodeLength"])(container);
            }
            else {
                forcePrepend = true;
                offset = [].indexOf.call(container.parentNode.childNodes, container);
                container = container.parentNode;
            }
        }
        // When targetting the end of a node, the DOM gives an offset that is
        // equal to the length of the container. In order to retrieve the last
        // descendent, we need to make sure we target an existing node, ie. an
        // existing index.
        const isAfterEnd = offset >= Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_5__["nodeLength"])(container);
        let index = isAfterEnd ? Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_5__["nodeLength"])(container) - 1 : offset;
        // Move to deepest child of container.
        while (container.hasChildNodes()) {
            const child = container.childNodes[index];
            if (!this.getNodes(child).length) {
                break;
            }
            container = child;
            index = isAfterEnd ? Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_5__["nodeLength"])(container) - 1 : 0;
            // Adapt the offset to be its equivalent within the new container.
            offset = isAfterEnd ? Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_5__["nodeLength"])(container) : index;
        }
        const nodes = this.getNodes(container);
        // Get the VNodes matching the container.
        let reference;
        if (container.nodeType === Node.TEXT_NODE) {
            // The reference is the index-th match (eg.: text split into chars).
            reference = forceAfter ? nodes[nodes.length - 1] : nodes[index];
        }
        else {
            reference = nodes[0];
        }
        if (forceAfter) {
            return [reference, _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER];
        }
        if (forcePrepend && reference.is(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_7__["ContainerNode"])) {
            return [reference, _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE];
        }
        return reference.locate(container, offset);
    }
    /**
     * Return the location in the DOM corresponding to the location in the
     * VDocument of the given VNode. The location in the DOM is expressed as a
     * tuple containing a reference Node and a relative position with respect to
     * the reference Node.
     *
     * @param node
     */
    _getDomLocation(node) {
        let reference = node.previousSibling();
        let position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER;
        if (reference) {
            reference = reference.lastLeaf();
        }
        else {
            reference = node.nextSibling();
            position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE;
            if (reference) {
                reference = reference.firstLeaf();
            }
        }
        if (!reference) {
            reference = node.parent;
            position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE;
        }
        // If the given position is "before", the reference DOM Node is the first
        // DOM node matching the given VNode.
        // If the given position is "after", the reference DOM Node is the last DOM
        // node matching the given VNode.
        const locations = this._domMap.toDomPoint(reference);
        const locationIndex = position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].BEFORE ? 0 : locations.length - 1;
        let [domNode, offset] = locations[locationIndex];
        if (domNode.nodeType === Node.TEXT_NODE && offset === -1) {
            // This -1 is a hack to accomodate the VDocumentMap to the new
            // rendering process without altering it for the parser.
            offset = this._domMap.fromDom(domNode).indexOf(reference);
        }
        else if (position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].INSIDE && offset === -1) {
            offset = 0;
        }
        else {
            // Char nodes have their offset in the corresponding text nodes
            // registered in the map via `set` but void nodes don't. Their
            // location need to be computed with respect to their parents.
            const container = domNode.parentNode;
            offset = Array.prototype.indexOf.call(container.childNodes, domNode);
            domNode = container;
        }
        if (position === _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER) {
            // Increment the offset to be positioned after the reference node.
            offset += 1;
        }
        return [domNode, offset];
    }
    async _renderNode(node) {
        const renderer = this.editor.plugins.get(_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_3__["Renderer"]);
        const domRendererEngine = renderer.engines['dom/html'];
        // Clear the rendering cache and update the rendering.
        domRendererEngine.renderings.clear();
        const domNodes = await domRendererEngine.render(node);
        // Put the rendered nodes into the map.
        let child = node.lastLeaf();
        while (child) {
            const renderings = domRendererEngine.renderings.get(child);
            if (renderings) {
                const rendering = renderings[renderings.length - 1];
                const renderedNodes = await rendering[1];
                // Remove from cache to update with the newest nodes.
                this._domMap.clear(child);
                // Add in cache.
                for (const domNode of renderedNodes) {
                    this._domMap.set(child, domNode, -1, 'unshift');
                }
            }
            child = child.previous();
        }
        return domNodes || [];
    }
    _prepareLayoutContainerAndLocation(componentDefinition) {
        const zone = this.componentZones[componentDefinition.id];
        if (zone === 'root') {
            // automatically wrap the child into a layoutContainer to keep location of all nodes
            // when update the template and redraw
            this.componentDefinitions[componentDefinition.id] = {
                id: componentDefinition.id,
                async render(editor) {
                    const nodes = await componentDefinition.render(editor);
                    const layoutContainer = new _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_8__["LayoutContainer"]();
                    layoutContainer.append(...nodes);
                    return [layoutContainer];
                },
            };
            if (this.location) {
                if (!this.locations[componentDefinition.id]) {
                    this.locations[componentDefinition.id] = this.location;
                    this.renderingMap[componentDefinition.id] = [];
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ui/DomMap.ts":
/*!*****************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ui/DomMap.ts ***!
  \*****************************************************/
/*! exports provided: DomMap */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DomMap", function() { return DomMap; });
/* harmony import */ var _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./LayoutContainerNode */ "./packages/plugin-dom-layout/src/ui/LayoutContainerNode.ts");

class DomMap {
    constructor() {
        this._fromDom = new Map();
        this._toDom = new Map();
    }
    /**
     * Map the given VNode to its corresponding DOM Node and its offset in it.
     *
     * @param node
     * @param domNode
     * @param offset
     * @param method
     */
    set(node, domNode, offset = 0, method = 'push') {
        if (node instanceof _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_0__["LayoutContainer"]) {
            return;
        }
        if (this._fromDom.has(domNode)) {
            const matches = this._fromDom.get(domNode);
            if (!matches.some((match) => match.id === node.id)) {
                matches[method](node);
            }
        }
        else {
            this._fromDom.set(domNode, [node]);
        }
        const locations = this._toDom.get(node) || [];
        locations.push([domNode, offset]);
        this._toDom.set(node, locations);
        // Set children.
        for (const renderedChild of domNode.childNodes) {
            const mapping = this.toDomPoint(node);
            if (!mapping) {
                this.set(node, renderedChild, -1, 'unshift');
            }
        }
    }
    /**
     * Return the VNode(s) corresponding to the given DOM Node.
     *
     * @param domNode
     */
    fromDom(domNode) {
        return this._fromDom.get(domNode);
    }
    /**
     * Return the array of tuple (node, number) corresponding to the given VNode.
     *
     * @param node
     */
    toDomPoint(node) {
        return this._toDom.get(node) || [];
    }
    /**
     * Return the DOM Node corresponding to the given VNode.
     *
     * @param node
     */
    toDom(node) {
        const domNodes = [];
        for (const point of this._toDom.get(node) || []) {
            domNodes.push(point[0]);
        }
        return domNodes;
    }
    /**
     * Clear the map of all correspondances.
     *
     * @param [node]
     */
    clear(node) {
        if (node) {
            for (const point of this._toDom.get(node) || []) {
                const nodes = this._fromDom.get(point[0]);
                const index = nodes.indexOf(node);
                if (index !== -1) {
                    nodes.splice(index, 0);
                }
                if (nodes.length === 0) {
                    this._fromDom.delete(point[0]);
                }
            }
            this._toDom.delete(node);
        }
        else {
            this._fromDom.clear();
            this._toDom.clear();
        }
    }
}


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ui/LayoutContainerHtmlDomRenderer.ts":
/*!*****************************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ui/LayoutContainerHtmlDomRenderer.ts ***!
  \*****************************************************************************/
/*! exports provided: LayoutContainerHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayoutContainerHtmlDomRenderer", function() { return LayoutContainerHtmlDomRenderer; });
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LayoutContainerNode */ "./packages/plugin-dom-layout/src/ui/LayoutContainerNode.ts");



class LayoutContainerHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_1__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _LayoutContainerNode__WEBPACK_IMPORTED_MODULE_2__["LayoutContainer"];
    }
    async render(node) {
        if (node.hasChildren()) {
            const renderedChildren = await this.renderChildren(node);
            return renderedChildren.flat();
        }
        return [];
    }
}
LayoutContainerHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ui/LayoutContainerNode.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ui/LayoutContainerNode.ts ***!
  \******************************************************************/
/*! exports provided: LayoutContainer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayoutContainer", function() { return LayoutContainer; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class LayoutContainer extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor() {
        super(...arguments);
        this.editable = false;
        this.breakable = false;
    }
}


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ui/ZoneHtmlDomRenderer.ts":
/*!******************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ui/ZoneHtmlDomRenderer.ts ***!
  \******************************************************************/
/*! exports provided: ZoneHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ZoneHtmlDomRenderer", function() { return ZoneHtmlDomRenderer; });
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");



class ZoneHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_1__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_2__["ZoneNode"];
    }
    async render(node) {
        const renderedChildren = [];
        if (node.hasChildren()) {
            for (const child of node.childVNodes) {
                if (!node.hidden.get(child)) {
                    renderedChildren.push(...(await this.engine.render(child)));
                }
            }
        }
        return renderedChildren;
    }
}
ZoneHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-dom-layout/src/ui/ZoneXmlDomParser.ts":
/*!***************************************************************!*\
  !*** ./packages/plugin-dom-layout/src/ui/ZoneXmlDomParser.ts ***!
  \***************************************************************/
/*! exports provided: ZoneXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ZoneXmlDomParser", function() { return ZoneXmlDomParser; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../plugin-layout/src/ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../utils/src/utils */ "./packages/utils/src/utils.ts");




class ZoneXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'T' && !!item.getAttribute('t-zone');
        };
    }
    async parse(item) {
        return [new _plugin_layout_src_ZoneNode__WEBPACK_IMPORTED_MODULE_2__["ZoneNode"]([item.getAttribute('t-zone')])];
    }
}
ZoneXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-heading/src/Heading.ts":
/*!************************************************!*\
  !*** ./packages/plugin-heading/src/Heading.ts ***!
  \************************************************/
/*! exports provided: Heading */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Heading", function() { return Heading; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _HeadingXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./HeadingXmlDomParser */ "./packages/plugin-heading/src/HeadingXmlDomParser.ts");
/* harmony import */ var _HeadingNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HeadingNode */ "./packages/plugin-heading/src/HeadingNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");




class Heading extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            applyHeadingStyle: {
                handler: this.applyHeadingStyle,
            },
            insertParagraphBreak: {
                selector: [_HeadingNode__WEBPACK_IMPORTED_MODULE_2__["HeadingNode"]],
                check: (context) => {
                    const range = context.range;
                    return range.isCollapsed() && !range.start.nextSibling();
                },
                handler: this.insertParagraphBreak,
            },
        };
        this.loadables = {
            parsers: [_HeadingXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["HeadingXmlDomParser"]],
            shortcuts: [0, 1, 2, 3, 4, 5, 6].map(level => {
                return {
                    pattern: 'CTRL+SHIFT+<Digit' + level + '>',
                    commandId: 'applyHeadingStyle',
                    commandArgs: { level: level },
                };
            }),
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Change the formatting of the nodes in given range to Heading.
     *
     * @param params
     */
    applyHeadingStyle(params) {
        for (const node of params.context.range.targetedNodes(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_3__["ContainerNode"])) {
            const heading = this._createHeadingContainer(params.level);
            heading.modifiers = node.modifiers.clone();
            node.replaceWith(heading);
        }
    }
    /**
     * Inserting a paragraph break at the end of a heading exits the heading.
     *
     * @param params
     */
    insertParagraphBreak(params) {
        const range = params.context.range;
        const heading = range.targetedNodes(_HeadingNode__WEBPACK_IMPORTED_MODULE_2__["HeadingNode"])[0];
        const duplicate = heading.splitAt(range.start);
        const newContainer = new this.editor.configuration.defaults.Container();
        duplicate.replaceWith(newContainer);
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return a heading node or a base container based on the given level.
     *
     * @param level
     */
    _createHeadingContainer(level) {
        if (level === 0) {
            return new this.editor.configuration.defaults.Container();
        }
        else {
            return new _HeadingNode__WEBPACK_IMPORTED_MODULE_2__["HeadingNode"]({ level: level });
        }
    }
}


/***/ }),

/***/ "./packages/plugin-heading/src/HeadingButtons.ts":
/*!*******************************************************!*\
  !*** ./packages/plugin-heading/src/HeadingButtons.ts ***!
  \*******************************************************/
/*! exports provided: ParagraphButton, Heading1Button, Heading2Button, Heading3Button, Heading4Button, Heading5Button, Heading6Button */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ParagraphButton", function() { return ParagraphButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Heading1Button", function() { return Heading1Button; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Heading2Button", function() { return Heading2Button; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Heading3Button", function() { return Heading3Button; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Heading4Button", function() { return Heading4Button; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Heading5Button", function() { return Heading5Button; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Heading6Button", function() { return Heading6Button; });
/* harmony import */ var _HeadingNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./HeadingNode */ "./packages/plugin-heading/src/HeadingNode.ts");

function headingButton(level) {
    return {
        title: 'Heading' + level,
        class: 'h' + level,
        commandId: 'applyHeadingStyle',
        commandArgs: { level: level },
        selected: (editor) => {
            return editor.selection.range.targetedNodes().every(node => {
                return node.closest(ancestor => {
                    return ancestor.is(_HeadingNode__WEBPACK_IMPORTED_MODULE_0__["HeadingNode"]) && ancestor.level === level;
                });
            });
        },
    };
}
const ParagraphButton = {
    title: 'Paragraph',
    commandId: 'applyHeadingStyle',
    commandArgs: { level: 0 },
    selected: (editor) => {
        return editor.selection.range.targetedNodes().every(node => {
            return node.closest(ancestor => {
                return ancestor.is(editor.configuration.defaults.Container);
            });
        });
    },
};
const Heading1Button = headingButton(1);
const Heading2Button = headingButton(2);
const Heading3Button = headingButton(3);
const Heading4Button = headingButton(4);
const Heading5Button = headingButton(5);
const Heading6Button = headingButton(6);


/***/ }),

/***/ "./packages/plugin-heading/src/HeadingNode.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-heading/src/HeadingNode.ts ***!
  \****************************************************/
/*! exports provided: HeadingNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HeadingNode", function() { return HeadingNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class HeadingNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor(params) {
        super({ htmlTag: 'H' + params.level });
        this.level = params.level;
    }
    get name() {
        return super.name + ': ' + this.level;
    }
    clone(deepClone, params) {
        const defaults = {
            level: this.level,
        };
        return super.clone(deepClone, { ...defaults, ...params });
    }
}


/***/ }),

/***/ "./packages/plugin-heading/src/HeadingXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-heading/src/HeadingXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: HeadingXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HeadingXmlDomParser", function() { return HeadingXmlDomParser; });
/* harmony import */ var _HeadingNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./HeadingNode */ "./packages/plugin-heading/src/HeadingNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




const HeadingTags = ['H1', 'H2', 'H3', 'H4', 'H5', 'H6'];
class HeadingXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && HeadingTags.includes(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item));
        };
    }
    async parse(item) {
        const heading = new _HeadingNode__WEBPACK_IMPORTED_MODULE_0__["HeadingNode"]({ level: parseInt(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item)[1], 10) });
        heading.modifiers.append(this.engine.parseAttributes(item));
        const nodes = await this.engine.parse(...item.childNodes);
        heading.append(...nodes);
        return [heading];
    }
}
HeadingXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-html/src/DefaultHtmlDomRenderer.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-html/src/DefaultHtmlDomRenderer.ts ***!
  \************************************************************/
/*! exports provided: DefaultHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultHtmlDomRenderer", function() { return DefaultHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _core_src_VNodes_FragmentNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/FragmentNode */ "./packages/core/src/VNodes/FragmentNode.ts");
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class DefaultHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    async render(node) {
        let domNode;
        if (node.tangible) {
            if (node.test(_core_src_VNodes_FragmentNode__WEBPACK_IMPORTED_MODULE_1__["FragmentNode"])) {
                domNode = document.createDocumentFragment();
            }
            else {
                let nodeName;
                if (node.is(_core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_2__["VElement"])) {
                    nodeName = node.htmlTag;
                }
                else {
                    nodeName = node.constructor.name.toUpperCase() + '-' + node.id;
                }
                const element = document.createElement(nodeName);
                this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], node, element);
                domNode = element;
            }
            const renderedChildren = await this.renderChildren(node);
            for (const renderedChild of renderedChildren) {
                for (const domChild of renderedChild) {
                    domNode.appendChild(domChild);
                }
            }
            return [domNode];
        }
        else {
            return [];
        }
    }
}
DefaultHtmlDomRenderer.id = 'dom/html';


/***/ }),

/***/ "./packages/plugin-html/src/DefaultHtmlTextParser.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-html/src/DefaultHtmlTextParser.ts ***!
  \***********************************************************/
/*! exports provided: DefaultHtmlTextParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultHtmlTextParser", function() { return DefaultHtmlTextParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");


const autoCloseRegExp = /(<(area|base|br|col|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)[^/]*)>/gi;
class DefaultHtmlTextParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    async parse(item) {
        const domParser = new DOMParser();
        const template = item.replace(autoCloseRegExp, '$1/>');
        const xmlDoc = domParser.parseFromString('<t>' + template + '</t>', 'text/xml');
        const parser = this.engine.editor.plugins.get(_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"]);
        return parser.parse('dom/xml', ...xmlDoc.firstChild.childNodes);
    }
}
DefaultHtmlTextParser.id = 'text/html';


/***/ }),

/***/ "./packages/plugin-html/src/Html.ts":
/*!******************************************!*\
  !*** ./packages/plugin-html/src/Html.ts ***!
  \******************************************/
/*! exports provided: Html */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Html", function() { return Html; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _HtmlTextParsingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./HtmlTextParsingEngine */ "./packages/plugin-html/src/HtmlTextParsingEngine.ts");
/* harmony import */ var _HtmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./HtmlDomParsingEngine */ "./packages/plugin-html/src/HtmlDomParsingEngine.ts");
/* harmony import */ var _HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_xml_src_Xml__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-xml/src/Xml */ "./packages/plugin-xml/src/Xml.ts");
/* harmony import */ var _HtmlNodeDomRenderer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./HtmlNodeDomRenderer */ "./packages/plugin-html/src/HtmlNodeDomRenderer.ts");








class Html extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsingEngines: [_HtmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_4__["HtmlDomParsingEngine"], _HtmlTextParsingEngine__WEBPACK_IMPORTED_MODULE_3__["HtmlTextParsingEngine"]],
            renderingEngines: [_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_5__["HtmlDomRenderingEngine"]],
            renderers: [_HtmlNodeDomRenderer__WEBPACK_IMPORTED_MODULE_7__["HtmlHtmlDomRenderer"]],
        };
    }
}
Html.dependencies = [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__["Renderer"], _plugin_xml_src_Xml__WEBPACK_IMPORTED_MODULE_6__["Xml"]];


/***/ }),

/***/ "./packages/plugin-html/src/HtmlDomParsingEngine.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-html/src/HtmlDomParsingEngine.ts ***!
  \**********************************************************/
/*! exports provided: HtmlDomParsingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HtmlDomParsingEngine", function() { return HtmlDomParsingEngine; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");

class HtmlDomParsingEngine extends _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"] {
}
HtmlDomParsingEngine.id = 'dom/html';
HtmlDomParsingEngine.extends = ['dom/xml'];


/***/ }),

/***/ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-html/src/HtmlDomRenderingEngine.ts ***!
  \************************************************************/
/*! exports provided: HtmlDomRenderingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HtmlDomRenderingEngine", function() { return HtmlDomRenderingEngine; });
/* harmony import */ var _plugin_renderer_src_RenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/RenderingEngine */ "./packages/plugin-renderer/src/RenderingEngine.ts");
/* harmony import */ var _DefaultHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DefaultHtmlDomRenderer */ "./packages/plugin-html/src/DefaultHtmlDomRenderer.ts");
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");



class HtmlDomRenderingEngine extends _plugin_renderer_src_RenderingEngine__WEBPACK_IMPORTED_MODULE_0__["RenderingEngine"] {
    /**
     * Render the attributes (of the given Class extending Attributes) of the
     * given VNode onto the given DOM Element.
     *
     * @param Class
     * @param node
     * @param element
     */
    renderAttributes(Class, node, element) {
        const attributes = node.modifiers.find(Class);
        if (attributes) {
            for (const name of attributes.keys()) {
                const value = attributes.get(name);
                element.setAttribute(name, value);
            }
            if (attributes.style.length) {
                for (const name of attributes.style.keys()) {
                    element.style.setProperty(name, attributes.style.get(name));
                }
            }
            if (attributes.classList.length) {
                for (const className of attributes.classList.items()) {
                    element.classList.add(className);
                }
            }
        }
    }
    /**
     * If a node is empty but could accomodate children, fill it to make it
     * visible.
     *
     * @param node
     */
    async renderEmpty(node) {
        return node.is(_core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_2__["AtomicNode"]) ? [] : [document.createElement('br')];
    }
}
HtmlDomRenderingEngine.id = 'dom/html';
HtmlDomRenderingEngine.defaultRenderer = _DefaultHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_1__["DefaultHtmlDomRenderer"];


/***/ }),

/***/ "./packages/plugin-html/src/HtmlNode.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-html/src/HtmlNode.ts ***!
  \**********************************************/
/*! exports provided: HtmlNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HtmlNode", function() { return HtmlNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class HtmlNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor(params) {
        super();
        this.domNode = params.domNode;
    }
}


/***/ }),

/***/ "./packages/plugin-html/src/HtmlNodeDomRenderer.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-html/src/HtmlNodeDomRenderer.ts ***!
  \*********************************************************/
/*! exports provided: HtmlHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HtmlHtmlDomRenderer", function() { return HtmlHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _HtmlNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./HtmlNode */ "./packages/plugin-html/src/HtmlNode.ts");



class HtmlHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor(engine, superRenderer) {
        super(engine, superRenderer);
        this.predicate = _HtmlNode__WEBPACK_IMPORTED_MODULE_2__["HtmlNode"];
    }
    async render(node) {
        return [node.domNode];
    }
}
HtmlHtmlDomRenderer.id = _HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-html/src/HtmlTextParsingEngine.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-html/src/HtmlTextParsingEngine.ts ***!
  \***********************************************************/
/*! exports provided: HtmlTextParsingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HtmlTextParsingEngine", function() { return HtmlTextParsingEngine; });
/* harmony import */ var _plugin_parser_src_ParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/ParsingEngine */ "./packages/plugin-parser/src/ParsingEngine.ts");
/* harmony import */ var _DefaultHtmlTextParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DefaultHtmlTextParser */ "./packages/plugin-html/src/DefaultHtmlTextParser.ts");


class HtmlTextParsingEngine extends _plugin_parser_src_ParsingEngine__WEBPACK_IMPORTED_MODULE_0__["ParsingEngine"] {
}
HtmlTextParsingEngine.id = 'text/html';
HtmlTextParsingEngine.defaultParser = _DefaultHtmlTextParser__WEBPACK_IMPORTED_MODULE_1__["DefaultHtmlTextParser"];


/***/ }),

/***/ "./packages/plugin-image/src/Image.ts":
/*!********************************************!*\
  !*** ./packages/plugin-image/src/Image.ts ***!
  \********************************************/
/*! exports provided: Image */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Image", function() { return Image; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ImageXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ImageXmlDomParser */ "./packages/plugin-image/src/ImageXmlDomParser.ts");
/* harmony import */ var _ImageHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ImageHtmlDomRenderer */ "./packages/plugin-image/src/ImageHtmlDomRenderer.ts");



class Image extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_ImageXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["ImageXmlDomParser"]],
            renderers: [_ImageHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__["ImageHtmlDomRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-image/src/ImageHtmlDomRenderer.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-image/src/ImageHtmlDomRenderer.ts ***!
  \***********************************************************/
/*! exports provided: ImageHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageHtmlDomRenderer", function() { return ImageHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _ImageNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ImageNode */ "./packages/plugin-image/src/ImageNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _plugin_youtube_src_Youtube__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-youtube/src/Youtube */ "./packages/plugin-youtube/src/Youtube.ts");





class ImageHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = (node) => !![_ImageNode__WEBPACK_IMPORTED_MODULE_1__["ImageNode"], _plugin_youtube_src_Youtube__WEBPACK_IMPORTED_MODULE_4__["Youtube"]].find(NodeClass => node instanceof NodeClass);
    }
    async render(node) {
        const image = document.createElement('img');
        const isSelected = this.engine.editor.selection.range.selectedNodes(selectedNode => selectedNode === node);
        if (isSelected.length === 1) {
            image.classList.add('jw_selected_image');
        }
        image.addEventListener('click', e => {
            this.engine.editor.nextEventMutex(() => {
                this.engine.editor.execCustomCommand(async () => {
                    this.engine.editor.selection.select(node, node);
                });
            });
        });
        this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], node, image);
        return [image];
    }
}
ImageHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-image/src/ImageNode.ts":
/*!************************************************!*\
  !*** ./packages/plugin-image/src/ImageNode.ts ***!
  \************************************************/
/*! exports provided: ImageNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageNode", function() { return ImageNode; });
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");

class ImageNode extends _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__["InlineNode"] {
}
ImageNode.atomic = true;


/***/ }),

/***/ "./packages/plugin-image/src/ImageXmlDomParser.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-image/src/ImageXmlDomParser.ts ***!
  \********************************************************/
/*! exports provided: ImageXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ImageXmlDomParser", function() { return ImageXmlDomParser; });
/* harmony import */ var _ImageNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ImageNode */ "./packages/plugin-image/src/ImageNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class ImageXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'IMG';
        };
    }
    async parse(item) {
        const image = new _ImageNode__WEBPACK_IMPORTED_MODULE_0__["ImageNode"]();
        image.modifiers.append(this.engine.parseAttributes(item));
        return [image];
    }
}
ImageXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-indent/src/Indent.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-indent/src/Indent.ts ***!
  \**********************************************/
/*! exports provided: Indent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Indent", function() { return Indent; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-char/src/Char */ "./packages/plugin-char/src/Char.ts");
/* harmony import */ var _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-char/src/CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-linebreak/src/LineBreak */ "./packages/plugin-linebreak/src/LineBreak.ts");
/* harmony import */ var _plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../plugin-linebreak/src/LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _core_src_VRange__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/src/VRange */ "./packages/core/src/VRange.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");









class Indent extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            indent: {
                title: 'Indent chars',
                handler: this.indent,
            },
            outdent: {
                title: 'Outdent chars',
                handler: this.outdent,
            },
        };
        this.loadables = {
            shortcuts: [
                {
                    pattern: 'TAB',
                    commandId: 'indent',
                },
                {
                    pattern: 'SHIFT+TAB',
                    commandId: 'outdent',
                },
            ],
        };
        this.tab = '    ';
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Indent text or lines.
     *
     * - If there is more than one line selected in range, indent each lines.
     * - Otherwise, insert 4 spaces.
     */
    async indent(params) {
        const range = params.context.range;
        const segmentBreaks = range.traversedNodes(this._isSegmentBreak);
        // Only indent when there is at leat two lines selected, that is when
        // at least one segment break could be identified in the selection.
        if (range.isCollapsed() || !segmentBreaks.length) {
            await this.editor.execCommand('insertText', {
                text: this.tab,
                context: {
                    range: range,
                },
            });
        }
        else {
            // The first line of the selection is neither fully selected nor
            // traversed so its segment break was not in `range.traversedNodes`.
            const nextSegmentBreak = range.start.previous(this._isSegmentBreak);
            if (nextSegmentBreak) {
                segmentBreaks.unshift(nextSegmentBreak);
            }
            for (const segmentBreak of segmentBreaks) {
                // Insert 4 spaces at the start of next segment.
                const [node, position] = this._nextSegmentStart(segmentBreak);
                await Object(_core_src_VRange__WEBPACK_IMPORTED_MODULE_6__["withRange"])(_core_src_VRange__WEBPACK_IMPORTED_MODULE_6__["VRange"].at(node, position), async (range) => {
                    await this.editor.execCommand('insertText', {
                        text: this.tab,
                        context: {
                            range: range,
                        },
                    });
                });
            }
        }
    }
    /**
     * Outdent lines.
     *
     * If there is more than one line selected, for each of the lines, remove up
     * to 4 spaces in the beggining of the line.
     */
    outdent(params) {
        const range = params.context.range;
        const segmentBreaks = range.traversedNodes(this._isSegmentBreak);
        // The first line of the selection is neither fully selected nor
        // traversed so its segment break was not in `range.traversedNodes`.
        const previousSegmentBreak = range.start.previous(this._isSegmentBreak);
        if (previousSegmentBreak) {
            segmentBreaks.unshift(previousSegmentBreak);
        }
        // Only outdent when there is at leat two lines selected, that is when
        // at least one segment break could be identified in the selection.
        if (segmentBreaks.length) {
            segmentBreaks.forEach(segmentBreak => {
                for (let i = 0; i < this.tab.length; i++) {
                    const space = this._nextIndentationSpace(segmentBreak);
                    if (space) {
                        space.remove();
                    }
                }
            });
        }
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return true if the given VNode can be considered to be a segment break.
     *
     * @param params
     */
    _isSegmentBreak(node) {
        return node.is(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_7__["ContainerNode"]) || node.is(_plugin_linebreak_src_LineBreakNode__WEBPACK_IMPORTED_MODULE_5__["LineBreakNode"]);
    }
    /**
     * Return the next segment start point after the given segment break.
     *
     * @param segmentBreak
     */
    _nextSegmentStart(segmentBreak) {
        let reference = segmentBreak;
        let position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE;
        if (segmentBreak.is(_core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_8__["AtomicNode"])) {
            reference = segmentBreak.nextSibling();
        }
        else if (segmentBreak.hasChildren()) {
            reference = segmentBreak.firstChild();
        }
        else {
            position = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].INSIDE;
        }
        return [reference, position];
    }
    /**
     * Return true if the given VNode is a CharNode containing a space.
     *
     * @param node
     */
    _isSpace(node) {
        return node.is(_plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_3__["CharNode"]) && /^\s$/g.test(node.char);
    }
    /**
     * Return true if the given VNode can be considered to be a segment break.
     *
     * @param segmentBreak
     */
    _nextIndentationSpace(segmentBreak) {
        let space;
        if (segmentBreak.is(_core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_8__["AtomicNode"])) {
            space = segmentBreak.nextSibling();
        }
        else {
            space = segmentBreak.firstChild();
        }
        return space && space.test(this._isSpace) && space;
    }
}
Indent.dependencies = [_plugin_char_src_Char__WEBPACK_IMPORTED_MODULE_2__["Char"], _plugin_linebreak_src_LineBreak__WEBPACK_IMPORTED_MODULE_4__["LineBreak"]];


/***/ }),

/***/ "./packages/plugin-indent/src/IndentButtons.ts":
/*!*****************************************************!*\
  !*** ./packages/plugin-indent/src/IndentButtons.ts ***!
  \*****************************************************/
/*! exports provided: IndentButton, OutdentButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IndentButton", function() { return IndentButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OutdentButton", function() { return OutdentButton; });
const IndentButton = {
    title: 'Indent',
    class: 'fa-indent',
    commandId: 'indent',
};
const OutdentButton = {
    title: 'Outdent',
    class: 'fa-outdent',
    commandId: 'outdent',
};


/***/ }),

/***/ "./packages/plugin-inline/src/Format.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-inline/src/Format.ts ***!
  \**********************************************/
/*! exports provided: Format */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Format", function() { return Format; });
/* harmony import */ var _core_src_Modifier__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Modifier */ "./packages/core/src/Modifier.ts");
/* harmony import */ var _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/Modifiers */ "./packages/core/src/Modifiers.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");



class Format extends _core_src_Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"] {
    constructor(htmlTag) {
        super();
        this.modifiers = new _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_1__["Modifiers"]();
        this.htmlTag = htmlTag;
    }
    get name() {
        return this.htmlTag.toLowerCase();
    }
    toString() {
        const nonEmptyAttributes = this.modifiers.filter(modifier => !(modifier instanceof _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"]) || !!modifier.length);
        if (nonEmptyAttributes.length) {
            const modifiersRepr = [];
            for (const modifier of nonEmptyAttributes) {
                modifiersRepr.push(modifier.toString());
            }
            return `${this.name}[${modifiersRepr.join(', ')}]`;
        }
        else {
            return this.name;
        }
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    render() {
        const domNode = document.createElement(this.htmlTag);
        const attributes = this.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"]);
        if (attributes) {
            for (const name of attributes.keys()) {
                domNode.setAttribute(name, attributes.get(name));
            }
            if (attributes.style.length) {
                for (const name of attributes.style.keys().sort()) {
                    domNode.style.setProperty(name, attributes.style.get(name));
                }
            }
            if (attributes.classList.length) {
                for (const className of attributes.classList.items()) {
                    domNode.classList.add(className);
                }
            }
        }
        return domNode;
    }
    clone() {
        const clone = new this.constructor();
        clone.htmlTag = this.htmlTag;
        clone.modifiers = this.modifiers.clone();
        return clone;
    }
    isSameAs(otherFormat) {
        const aModifiers = this.modifiers;
        const bModifiers = otherFormat === null || otherFormat === void 0 ? void 0 : otherFormat.modifiers;
        return otherFormat instanceof this.constructor && aModifiers.areSameAs(bModifiers);
    }
}


/***/ }),

/***/ "./packages/plugin-inline/src/FormatDomRenderer.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-inline/src/FormatDomRenderer.ts ***!
  \*********************************************************/
/*! exports provided: FormatDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormatDomRenderer", function() { return FormatDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _InlineNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _Format__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Format */ "./packages/plugin-inline/src/Format.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");




class FormatDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _InlineNode__WEBPACK_IMPORTED_MODULE_1__["InlineNode"];
    }
    async render(node) {
        const inline = await this.super.render(node);
        return this.renderFormats(node.modifiers.filter(_Format__WEBPACK_IMPORTED_MODULE_2__["Format"]), inline);
    }
    /**
     * Render an inline node's formats and return them in a fragment.
     *
     * @param rendering
     */
    async renderFormats(formats, rendering) {
        const fragment = document.createDocumentFragment();
        let parent = fragment;
        for (const value of Object.values(formats)) {
            const formatNode = value.render();
            parent.appendChild(formatNode);
            // Update the parent so the text is inside the format node.
            parent = formatNode;
        }
        for (const domChild of rendering) {
            parent.appendChild(domChild);
        }
        return Array.from(fragment.childNodes);
    }
}
FormatDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_3__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-inline/src/FormatParser.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-inline/src/FormatParser.ts ***!
  \****************************************************/
/*! exports provided: FormatParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormatParser", function() { return FormatParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _InlineNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");


class FormatParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    /**
     * Parse a span node.
     *
     * @param nodes
     */
    applyFormat(format, nodes) {
        for (const node of nodes) {
            if (node.is(_InlineNode__WEBPACK_IMPORTED_MODULE_1__["InlineNode"])) {
                format.clone().applyTo(node);
            }
            else {
                const inlineNodes = node.descendants(_InlineNode__WEBPACK_IMPORTED_MODULE_1__["InlineNode"]);
                for (const inline of inlineNodes) {
                    format.clone().applyTo(inline);
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-inline/src/Inline.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-inline/src/Inline.ts ***!
  \**********************************************/
/*! exports provided: Inline */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Inline", function() { return Inline; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _InlineNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/Modifiers */ "./packages/core/src/Modifiers.ts");
/* harmony import */ var _plugin_xml_src_CssStyle__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/CssStyle */ "./packages/plugin-xml/src/CssStyle.ts");





class Inline extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            toggleFormat: {
                handler: this.toggleFormat,
            },
        };
        this.commandHooks = {
            setSelection: this.resetCache,
        };
        /**
         * When applying a modifier on a collapsed range, cache the calculation of
         * the modifier in the following property. This value is reset each time the
         * range changes in a document.
         */
        this.cache = {
            modifiers: null,
            style: null,
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Apply the `format` to the range.
     *
     * @param params
     */
    toggleFormat(params) {
        const range = params.context.range;
        const FormatClass = params.FormatClass;
        if (range.isCollapsed()) {
            if (!this.cache.modifiers) {
                this.cache.modifiers = this.getCurrentModifiers(range);
            }
            const format = this.cache.modifiers.find(FormatClass);
            if (format) {
                this.cache.modifiers.remove(format);
            }
            else {
                this.cache.modifiers.append(new FormatClass());
            }
        }
        else {
            const selectedInlines = range.selectedNodes(_InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"]);
            // If every char in the range has the format `FormatClass`, remove
            // the format for all of them.
            const allHaveFormat = selectedInlines.every(inline => {
                return !!inline.modifiers.find(FormatClass);
            });
            if (allHaveFormat) {
                for (const inline of selectedInlines) {
                    const format = inline.modifiers.find(FormatClass);
                    // Apply the attributes of the format we're about to remove
                    // to the inline itself.
                    const attributes = inline.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"]);
                    const matchingFormatAttributes = format.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"]);
                    if (matchingFormatAttributes) {
                        for (const key of matchingFormatAttributes.keys()) {
                            attributes.set(key, matchingFormatAttributes.get(key));
                        }
                    }
                    // Remove the format.
                    inline.modifiers.remove(format);
                }
            }
            else {
                // If there is at least one char in the range without the format
                // `FormatClass`, set the format for all nodes.
                for (const inline of selectedInlines) {
                    if (!inline.modifiers.find(FormatClass)) {
                        new FormatClass().applyTo(inline);
                    }
                }
            }
        }
    }
    isAllFormat(FormatClass, range = this.editor.selection.range) {
        if (range.isCollapsed()) {
            if (!this.cache.modifiers) {
                this.cache.modifiers = this.getCurrentModifiers(range);
            }
            return !!this.cache.modifiers.find(FormatClass);
        }
        else {
            const selectedInlines = range.selectedNodes(_InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"]);
            return (selectedInlines.length &&
                selectedInlines.every(char => !!char.modifiers.find(FormatClass)));
        }
    }
    /**
     * Get the modifiers for the next insertion.
     */
    getCurrentModifiers(range = this.editor.selection.range) {
        if (this.cache.modifiers) {
            return this.cache.modifiers;
        }
        let inlineToCopyModifiers;
        if (range.isCollapsed()) {
            inlineToCopyModifiers = range.start.previousSibling() || range.start.nextSibling();
        }
        else {
            inlineToCopyModifiers = range.start.nextSibling();
        }
        if (inlineToCopyModifiers && inlineToCopyModifiers.is(_InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"])) {
            return inlineToCopyModifiers.modifiers.clone();
        }
        return new _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_3__["Modifiers"]();
    }
    /**
     * Get the styles for the next insertion.
     */
    getCurrentStyle(range = this.editor.selection.range) {
        var _a;
        if (this.cache.style) {
            return this.cache.style;
        }
        let inlineToCopyStyle;
        if (range.isCollapsed()) {
            inlineToCopyStyle = range.start.previousSibling() || range.start.nextSibling();
        }
        else {
            inlineToCopyStyle = range.start.nextSibling();
        }
        if (inlineToCopyStyle && inlineToCopyStyle.is(_InlineNode__WEBPACK_IMPORTED_MODULE_2__["InlineNode"])) {
            return ((_a = inlineToCopyStyle.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_1__["Attributes"])) === null || _a === void 0 ? void 0 : _a.style.clone()) || new _plugin_xml_src_CssStyle__WEBPACK_IMPORTED_MODULE_4__["CssStyle"]();
        }
        return new _plugin_xml_src_CssStyle__WEBPACK_IMPORTED_MODULE_4__["CssStyle"]();
    }
    /**
     * Each time the selection changes, we reset its format and style.
     */
    resetCache() {
        this.cache = {
            modifiers: null,
            style: null,
        };
    }
}


/***/ }),

/***/ "./packages/plugin-inline/src/InlineNode.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-inline/src/InlineNode.ts ***!
  \**************************************************/
/*! exports provided: InlineNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InlineNode", function() { return InlineNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class InlineNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
}


/***/ }),

/***/ "./packages/plugin-input/src/Input.ts":
/*!********************************************!*\
  !*** ./packages/plugin-input/src/Input.ts ***!
  \********************************************/
/*! exports provided: Input */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Input", function() { return Input; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _InputXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InputXmlDomParser */ "./packages/plugin-input/src/InputXmlDomParser.ts");
/* harmony import */ var _InputHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./InputHtmlDomRenderer */ "./packages/plugin-input/src/InputHtmlDomRenderer.ts");



class Input extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_InputXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["InputXmlDomParser"]],
            renderers: [_InputHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__["InputHtmlDomRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-input/src/InputHtmlDomRenderer.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-input/src/InputHtmlDomRenderer.ts ***!
  \***********************************************************/
/*! exports provided: InputHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputHtmlDomRenderer", function() { return InputHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _InputNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./InputNode */ "./packages/plugin-input/src/InputNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class InputHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _InputNode__WEBPACK_IMPORTED_MODULE_1__["InputNode"];
    }
    /**
     * Render the VNode to the given format.
     */
    async render(node) {
        const input = document.createElement('input');
        const attributes = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]);
        if (attributes) {
            this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], node, input);
        }
        if (node.inputType) {
            input.setAttribute('type', node.inputType);
        }
        if (node.inputName) {
            input.setAttribute('name', node.inputName);
        }
        input.value = node.value;
        return [input];
    }
}
InputHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-input/src/InputNode.ts":
/*!************************************************!*\
  !*** ./packages/plugin-input/src/InputNode.ts ***!
  \************************************************/
/*! exports provided: InputNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputNode", function() { return InputNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class InputNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor(params = {}) {
        super({ htmlTag: 'INPUT' });
        this.inputName = params.name;
        this.inputType = params.type;
        this.value = params.value;
    }
}


/***/ }),

/***/ "./packages/plugin-input/src/InputXmlDomParser.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-input/src/InputXmlDomParser.ts ***!
  \********************************************************/
/*! exports provided: InputXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "InputXmlDomParser", function() { return InputXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _InputNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./InputNode */ "./packages/plugin-input/src/InputNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");





class InputXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'INPUT';
        };
    }
    async parse(item) {
        const input = new _InputNode__WEBPACK_IMPORTED_MODULE_2__["InputNode"]({
            type: item.getAttribute('type'),
            name: item.getAttribute('name'),
            value: item.value,
        });
        input.modifiers.append(this.engine.parseAttributes(item));
        const attributes = input.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"]);
        if (attributes) {
            attributes.remove('type'); // type is on input.inputType
            attributes.remove('name'); // type is on input.inputName
        }
        const nodes = await this.engine.parse(...item.childNodes);
        input.append(...nodes);
        return [input];
    }
}
InputXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-italic/src/Italic.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-italic/src/Italic.ts ***!
  \**********************************************/
/*! exports provided: Italic */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Italic", function() { return Italic; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ItalicFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ItalicFormat */ "./packages/plugin-italic/src/ItalicFormat.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _ItalicXmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ItalicXmlDomParser */ "./packages/plugin-italic/src/ItalicXmlDomParser.ts");




class Italic extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_ItalicXmlDomParser__WEBPACK_IMPORTED_MODULE_3__["ItalicXmlDomParser"]],
            shortcuts: [
                {
                    pattern: 'CTRL+I',
                    commandId: 'toggleFormat',
                    commandArgs: { FormatClass: _ItalicFormat__WEBPACK_IMPORTED_MODULE_1__["ItalicFormat"] },
                },
            ],
        };
    }
}
Italic.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-italic/src/ItalicButtons.ts":
/*!*****************************************************!*\
  !*** ./packages/plugin-italic/src/ItalicButtons.ts ***!
  \*****************************************************/
/*! exports provided: ItalicButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItalicButton", function() { return ItalicButton; });
/* harmony import */ var _ItalicFormat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ItalicFormat */ "./packages/plugin-italic/src/ItalicFormat.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");


const ItalicButton = {
    title: 'Toggle italic',
    class: 'fa-italic',
    commandId: 'toggleFormat',
    commandArgs: { FormatClass: _ItalicFormat__WEBPACK_IMPORTED_MODULE_0__["ItalicFormat"] },
    selected: (editor) => editor.plugins.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]).isAllFormat(_ItalicFormat__WEBPACK_IMPORTED_MODULE_0__["ItalicFormat"]),
};


/***/ }),

/***/ "./packages/plugin-italic/src/ItalicFormat.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-italic/src/ItalicFormat.ts ***!
  \****************************************************/
/*! exports provided: ItalicFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItalicFormat", function() { return ItalicFormat; });
/* harmony import */ var _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/Format */ "./packages/plugin-inline/src/Format.ts");

class ItalicFormat extends _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor(htmlTag = 'I') {
        super(htmlTag);
    }
}


/***/ }),

/***/ "./packages/plugin-italic/src/ItalicXmlDomParser.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-italic/src/ItalicXmlDomParser.ts ***!
  \**********************************************************/
/*! exports provided: ItalicXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ItalicXmlDomParser", function() { return ItalicXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatParser */ "./packages/plugin-inline/src/FormatParser.ts");
/* harmony import */ var _ItalicFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ItalicFormat */ "./packages/plugin-italic/src/ItalicFormat.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class ItalicXmlDomParser extends _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__["FormatParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'I' || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'EM');
        };
    }
    /**
     * Parse an italic node.
     *
     * @param item
     */
    async parse(item) {
        const italic = new _ItalicFormat__WEBPACK_IMPORTED_MODULE_1__["ItalicFormat"](Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item));
        italic.modifiers.append(this.engine.parseAttributes(item));
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(italic, children);
        return children;
    }
}
ItalicXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-keymap/src/Keymap.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-keymap/src/Keymap.ts ***!
  \**********************************************/
/*! exports provided: Platform, LEVEL, Keymap */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Platform", function() { return Platform; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LEVEL", function() { return LEVEL; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Keymap", function() { return Keymap; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");

var Platform;
(function (Platform) {
    Platform["MAC"] = "mac";
    Platform["PC"] = "pc";
})(Platform || (Platform = {}));
var LEVEL;
(function (LEVEL) {
    LEVEL[LEVEL["DEFAULT"] = 0] = "DEFAULT";
    LEVEL[LEVEL["USER"] = 1] = "USER";
})(LEVEL || (LEVEL = {}));
/**
 * Keymap allow to add and remove shortucts and provide a function to match a
 * keyboard event with the registered shortcuts patterns.
 *
 * ## Adding shortcuts
 * The expression to describe a shortuct is zero or more `modifiers` and one
 * `hotkey` joined with the symbol `+`.
 *
 * ### Modifiers
 * - SHIFT
 * - ALT
 * - CTRL
 * - META
 * - CMD (alias of META)
 *
 * Example:
 * ```typescript
 * // using a modifier and one key
 * keymap.bind('CTRL+A', 'commandIdentifier')
 * // using multiples modifiers and one key
 * keymap.bind('CTRL+ALT+A', 'commandIdentifier')
 * ```
 *
 * ### Hotkeys
 * A hotkey can be wether a `key` or `code`.
 *
 * #### Key
 * The syntax to describe a `key` is to write the `key` as it is. The convention
 * is to write it in uppercase.
 *
 * Example:
 * ```typescript
 * keymap.bind('CTRL+A', 'commandIdentifier')
 * ```
 * The list of possible `key` values are defined in the following link:
 * https://www.w3.org/TR/uievents/#dom-keyboardevent-key
 *
 * #### Code
 * The syntax to describe a `code` is to write `<code>` (surrounded by "<" and
 * ">").
 *
 * Example:
 * ```typescript
 * keymap.bind('CTRL+<KeyA>', 'commandIdentifier')
 * ```
 *
 * The list of possible `code` values are defined in the following link:
 * https://www.w3.org/TR/uievents/#dom-keyboardevent-key
 *
 * ## Removing shortucts
 * To remove a shortuct, call `bind` without specifying a commandIdentifier.
 *
 * Example:
 * ```typescript
 * keymap.bind('CTRL+<KeyA>')
 * ```
 */
class Keymap extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor(editor, config) {
        super(editor, config);
        this.editor = editor;
        this.config = config;
        this.loaders = {
            shortcuts: this._loadShortcuts,
        };
        this.mappings = [...new Array(LEVEL.USER + 1)].map(() => []);
        this.defaultMappings = [];
        this.userMappings = [];
        if (!config.platform) {
            const isMac = navigator.platform.match(/Mac/);
            config.platform = isMac ? Platform.MAC : Platform.PC;
        }
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Bind a shortuct.
     *
     * If there is no `command.commandId`, it means that we want nothing to
     * execute, thus replacing the command originally bound on this shortcut.
     *
     * @param pattern
     * @param command
     */
    bind(pattern, command, level = LEVEL.DEFAULT) {
        this.mappings[level].push({
            pattern: this.parsePattern(pattern),
            configuredCommand: command,
        });
    }
    /**
     * Return all configured commands which shortcut match the given `keyEvent`.
     *
     * @param keyEvent
     */
    match(keyEvent) {
        var _a;
        const matchingCommands = [];
        for (let level = LEVEL.USER; level >= 0; level--) {
            for (const shortcut of this.mappings[level]) {
                const modifiers = shortcut.pattern.modifiers;
                let match;
                if ('code' in shortcut.pattern) {
                    match = shortcut.pattern.code === keyEvent.code;
                }
                else {
                    // In rare case the KeyboardEvent `key` is undefined.
                    match = shortcut.pattern.key === ((_a = keyEvent.key) === null || _a === void 0 ? void 0 : _a.toUpperCase());
                }
                match =
                    match &&
                        modifiers.has('CTRL') === keyEvent.ctrlKey &&
                        modifiers.has('SHIFT') === keyEvent.shiftKey &&
                        modifiers.has('META') === keyEvent.metaKey &&
                        modifiers.has('ALT') === keyEvent.altKey;
                if (match) {
                    if (!shortcut.configuredCommand.commandId) {
                        // An `undefined` command unbounds the other commands
                        // previously registered on this shortcut.
                        matchingCommands.length = 0;
                    }
                    matchingCommands.push(shortcut.configuredCommand);
                }
            }
            if (matchingCommands.length) {
                // Matches were found at this level so do not look lower.
                break;
            }
        }
        return matchingCommands;
    }
    /**
     * Parse a string that represents a pattern and return a `ShortuctPattern`.
     * Supported pattern is: [modifier+]*[<code>|key]
     *
     * @param pattern
     */
    parsePattern(pattern) {
        const tokens = pattern
            .replace(/cmd/gi, 'META')
            .split(/[+]/)
            .map(token => token.trim());
        const keyCode = tokens.pop();
        const modifiers = new Set(tokens.map(token => token.toUpperCase()));
        if (!keyCode) {
            throw new Error('You must have at least one key or code.');
        }
        // There are two ways to specify a shortcut hotkey : key or code
        // - "CTRL+1" is the modifier CTRL with the event.key "1".
        // - "CTRL+<Key1>" is the modifier CTRL with the event.code "Key1"
        const codeMatch = keyCode.match(/^<(\w+)>$/);
        if (codeMatch && codeMatch.length > 1) {
            return { code: codeMatch[1], modifiers };
        }
        else {
            return { key: keyCode.toUpperCase(), modifiers };
        }
    }
    /**
     * Take a `ShortuctPattern` and return a string that represents a pattern,
     * in the form [modifier+]*[<code>|key].
     *
     * @param pattern
     */
    stringifyPattern(pattern) {
        const parts = Array.from(pattern.modifiers);
        if ('code' in pattern) {
            parts.push(pattern.code);
        }
        else if ('key' in pattern) {
            parts.push(pattern.key);
        }
        return parts.join('+');
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Load a shortcut in the keymap depending on the platform.
     *
     * - If the shortuct has no platform property; load the shortuct in both
     *   platform ('mac' and 'pc').
     * - If the shortuct has no platform property and the current platform is
     *   mac, modify the ctrl key to meta key.
     * - If the shortuct has a platform property, only load the shortcut for
     *   that platform.
     * - If no `mapping.commandId` is declared, it means removing the shortcut.
     *
     * @param shortcuts The shortuct definitions.
     * @param source The source of the shortcuts.
     */
    _loadShortcuts(shortcuts, source) {
        for (const shortcut of [...shortcuts]) {
            // A shortcut is a configured command on which the properties
            // `pattern`, and optionally `platform`, were set.
            const platform = shortcut.platform;
            if (!platform || platform === this.config.platform) {
                let pattern = shortcut.pattern;
                const command = shortcut;
                // Patterns using the CTRL modifier target CMD instead for Mac.
                if (!platform && this.config.platform === Platform.MAC) {
                    pattern = shortcut.pattern.replace(/ctrl/gi, 'CMD');
                }
                if (source instanceof _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"]) {
                    this.bind(pattern, command, LEVEL.DEFAULT);
                }
                else {
                    this.bind(pattern, command, LEVEL.USER);
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-layout/src/Layout.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-layout/src/Layout.ts ***!
  \**********************************************/
/*! exports provided: Layout */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Layout", function() { return Layout; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");

class Layout extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.engines = {};
        this.loaders = {
            layoutEngines: this.loadEngines,
            components: this.loadComponents,
            componentZones: this.loadComponentsZones,
        };
        this.commands = {
            show: {
                title: 'Show a layout component',
                handler: this.show.bind(this),
            },
            hide: {
                title: 'Hide a layout component',
                handler: this.hide.bind(this),
            },
        };
    }
    async start() {
        this.loadComponents(this.configuration.components || []);
        this.loadComponentsZones(this.configuration.componentZones || []);
    }
    /**
     * Add a Component in a zone.
     *
     * @param componentId
     * @param zoneId
     */
    async add(componentId, zoneId = 'default') {
        const engines = Object.values(this.engines);
        await Promise.all(engines.map(engine => engine.add(componentId, zoneId)));
    }
    /**
     * Remove a component (instance or clonse) from the zone.
     *
     * @param componentID
     */
    async remove(componentID) {
        const promises = [];
        for (const layoutEngine of Object.values(this.engines)) {
            promises.push(layoutEngine.remove(componentID));
        }
        await Promise.all(promises);
    }
    /**
     * Show component (instance or clonse) inside the zone.
     *
     * @param params
     */
    async show(params) {
        const promises = [];
        for (const layoutEngine of Object.values(this.engines)) {
            promises.push(layoutEngine.show(params.componentID));
        }
        await Promise.all(promises);
    }
    /**
     * Hide component (instance or clonse) inside the zone.
     *
     * @param params
     */
    async hide(params) {
        const promises = [];
        for (const layoutEngine of Object.values(this.engines)) {
            promises.push(layoutEngine.hide(params.componentID));
        }
        await Promise.all(promises);
    }
    /**
     * Load layout engines.
     *
     * @param layoutEngines
     */
    loadEngines(layoutEngines) {
        for (const EngineClass of layoutEngines) {
            const engine = new EngineClass(this.editor);
            if (this.engines[engine.id]) {
                throw new Error(`Rendering engine ${EngineClass.name} already registered.`);
            }
            this.engines[engine.id] = engine;
        }
    }
    /**
     * Load components into all layout engines.
     *
     * @param Components
     */
    loadComponents(Components) {
        for (const Component of Components) {
            for (const layoutEngine of Object.values(this.engines)) {
                layoutEngine.loadComponent(Component);
            }
        }
    }
    /**
     * Load component zones into all layout engines.
     *
     * @param componentsZones
     */
    loadComponentsZones(componentsZones) {
        const zones = {};
        for (const [id, zone] of componentsZones) {
            zones[id] = zone;
        }
        for (const layoutEngine of Object.values(this.engines)) {
            layoutEngine.loadComponentZones(zones);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-layout/src/LayoutEngine.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-layout/src/LayoutEngine.ts ***!
  \****************************************************/
/*! exports provided: LayoutEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LayoutEngine", function() { return LayoutEngine; });
/* harmony import */ var _ZoneNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ZoneNode */ "./packages/plugin-layout/src/ZoneNode.ts");

class LayoutEngine {
    constructor(editor) {
        this.editor = editor;
        this.componentDefinitions = {};
        this.componentZones = {};
        this.root = new _ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"](['root']);
        this.components = new Map();
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Automatically intanciate the components in available zones.
     */
    async start() {
        let allZones = [this.root, ...this.root.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"])];
        await this._fillZones(allZones);
        allZones = [this.root, ...this.root.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"])];
        if (!allZones.find(zone => zone.managedZones.includes('default'))) {
            // Add into the default zone if no valid zone could be found.
            throw new Error('Please define a "default" zone in your template.');
        }
    }
    /**
     * Hide all components.
     */
    async stop() {
        for (const component of this.components.values()) {
            for (const node of component) {
                const zone = node.ancestor(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
                if (zone) {
                    zone.hide(node);
                }
            }
        }
        this.componentDefinitions = {};
        this.componentZones = {};
        this.components.clear();
        this.root.empty();
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Load the given Component in this layout engine.
     *
     * @param componentDefinition
     */
    loadComponent(componentDefinition) {
        this.componentDefinitions[componentDefinition.id] = componentDefinition;
    }
    /**
     * Load component zones in this layout engine.
     *
     * @param componentZones
     */
    loadComponentZones(componentZones) {
        Object.assign(this.componentZones, componentZones);
    }
    /**
     * Add the given node in the given zone if it exists. Otherwise, add it in
     * the default zone.
     * Return every created instance
     *
     * @param componentDefinition
     * @param zoneId
     */
    async add(componentId, zoneId) {
        const allZones = [this.root, ...this.root.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"])];
        let matchingZones = allZones.filter(node => node.managedZones.includes(zoneId));
        if (!matchingZones.length) {
            matchingZones = allZones.filter(zone => zone.managedZones.includes('default'));
        }
        const componentDefinition = this.componentDefinitions[componentId];
        const newComponents = await this._instantiateComponent(componentDefinition, matchingZones);
        return this._fillZones(newComponents);
    }
    /**
     *
     * Remove the component identified by the given reference from all zones.
     *
     * @param componentId
     */
    async remove(componentId) {
        const components = this.components.get(componentId) || [];
        const zones = [];
        let component;
        while ((component = components.pop())) {
            // Remove all instances in the zone children.
            for (const zone of component.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"])) {
                for (const child of zone.children()) {
                    zone.removeChild(child);
                    for (const component of this.components) {
                        const nodes = component[1];
                        if (nodes.includes(child)) {
                            nodes.splice(nodes.indexOf(child), 1);
                            break;
                        }
                    }
                }
            }
            // Remove the instance.
            const zone = component.ancestor(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
            if (zone && !zones.includes(zone)) {
                zones.push(zone);
            }
            component.remove();
        }
        return zones;
    }
    /**
     *
     * Show the components corresponding to given ref. Return the updated zones.
     *
     * @param componentId
     */
    async show(componentId) {
        const components = this.components.get(componentId);
        if (!(components === null || components === void 0 ? void 0 : components.length)) {
            console.warn('No component to show. Add it in a zone first.');
        }
        for (const component of components) {
            const zone = component.ancestor(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
            zone.show(component);
        }
        return components;
    }
    /**
     *
     * Hide the components corresponding to given ref. Return the updated zones.
     *
     * @param componentId
     */
    async hide(componentId) {
        const components = this.components.get(componentId) || [];
        for (const component of components) {
            const zone = component.ancestor(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
            zone.hide(component);
        }
        return components;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    async _fillZones(nodes) {
        const newComponents = [];
        const stack = [...nodes];
        while (stack.length) {
            const node = stack.pop();
            const zones = node.descendants(_ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]);
            if (node instanceof _ZoneNode__WEBPACK_IMPORTED_MODULE_0__["ZoneNode"]) {
                zones.push(node);
            }
            for (const componentId in this.componentDefinitions) {
                const zoneId = this.componentZones[componentId];
                if (zoneId) {
                    const layoutComponent = this.componentDefinitions[componentId];
                    // Filter the zones corresponding to the given identifier.
                    let matchingZones = zones.filter(zone => zone.managedZones.includes(zoneId));
                    const components = this.components.get(componentId);
                    if (components) {
                        // Excluding the ones that are contained within the given node.
                        // avoid loop with child in itself.
                        matchingZones = matchingZones.filter(zone => !zone.closest(ancestor => components.includes(ancestor)));
                    }
                    stack.push(...(await this._instantiateComponent(layoutComponent, matchingZones)));
                }
            }
            newComponents.push(node);
        }
        return newComponents;
    }
    async _instantiateComponent(componentDefinition, zones) {
        const components = this.components.get(componentDefinition.id) || [];
        // Add into the container.
        const newComponents = [];
        for (const zone of zones) {
            const nodes = await componentDefinition.render(this.editor);
            components.push(...nodes);
            newComponents.push(...nodes);
            zone.append(...nodes);
        }
        // Set the local reference.
        this.components.set(componentDefinition.id, components);
        // Return the components that were newly created.
        return newComponents;
    }
}


/***/ }),

/***/ "./packages/plugin-layout/src/ZoneNode.ts":
/*!************************************************!*\
  !*** ./packages/plugin-layout/src/ZoneNode.ts ***!
  \************************************************/
/*! exports provided: ZoneNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ZoneNode", function() { return ZoneNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class ZoneNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor(managedZones) {
        super();
        this.managedZones = managedZones;
        this.hidden = new Map();
        this.breakable = false;
    }
    get name() {
        return super.name + ': ' + this.managedZones.join();
    }
    hide(child) {
        this.hidden.set(child, true);
        return;
    }
    show(child) {
        this.hidden.set(child, false);
        const parentZone = this.ancestor(ZoneNode);
        if (parentZone) {
            parentZone.show(this);
        }
    }
    _removeAtIndex(index) {
        const child = this.childVNodes[index];
        super._removeAtIndex(index);
        this.hidden.delete(child);
    }
}


/***/ }),

/***/ "./packages/plugin-linebreak/src/LineBreak.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-linebreak/src/LineBreak.ts ***!
  \****************************************************/
/*! exports provided: LineBreak */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LineBreak", function() { return LineBreak; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _LineBreakNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _LineBreakXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LineBreakXmlDomParser */ "./packages/plugin-linebreak/src/LineBreakXmlDomParser.ts");
/* harmony import */ var _LineBreakHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./LineBreakHtmlDomRenderer */ "./packages/plugin-linebreak/src/LineBreakHtmlDomRenderer.ts");




class LineBreak extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_LineBreakXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["LineBreakXmlDomParser"]],
            renderers: [_LineBreakHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_3__["LineBreakHtmlDomRenderer"]],
        };
        this.commands = {
            insertLineBreak: {
                handler: this.insertLineBreak,
            },
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Insert a line break node at range.
     */
    insertLineBreak() {
        return this.editor.execCommand('insert', {
            node: new _LineBreakNode__WEBPACK_IMPORTED_MODULE_1__["LineBreakNode"](),
        });
    }
}


/***/ }),

/***/ "./packages/plugin-linebreak/src/LineBreakHtmlDomRenderer.ts":
/*!*******************************************************************!*\
  !*** ./packages/plugin-linebreak/src/LineBreakHtmlDomRenderer.ts ***!
  \*******************************************************************/
/*! exports provided: LineBreakHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LineBreakHtmlDomRenderer", function() { return LineBreakHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _LineBreakNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class LineBreakHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _LineBreakNode__WEBPACK_IMPORTED_MODULE_1__["LineBreakNode"];
    }
    /**
     * Render the VNode to the given format.
     */
    async render(node) {
        const br = document.createElement('br');
        this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], node, br);
        const rendering = [br];
        if (!node.nextSibling()) {
            // If a LineBreakNode has no next sibling, it must be rendered
            // as two BRs in order for it to be visible.
            rendering.push(document.createElement('br'));
        }
        return rendering;
    }
}
LineBreakHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-linebreak/src/LineBreakNode.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-linebreak/src/LineBreakNode.ts ***!
  \********************************************************/
/*! exports provided: LineBreakNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LineBreakNode", function() { return LineBreakNode; });
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _core_src_VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/SeparatorNode */ "./packages/core/src/VNodes/SeparatorNode.ts");


class LineBreakNode extends _core_src_VNodes_SeparatorNode__WEBPACK_IMPORTED_MODULE_1__["SeparatorNode"] {
    get name() {
        return '↲';
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Transform the given DOM location into its VDocument counterpart.
     *
     * @override
     * @param domNode DOM node corresponding to this VNode
     * @param offset The offset of the location in the given domNode
     */
    locate(domNode, offset) {
        const location = super.locate(domNode, offset);
        // When clicking on a trailing line break, we need to target after the
        // line break. The DOM represents these as 2 <br> so this is a special
        // case.
        if (!this.nextSibling() && !domNode.nextSibling) {
            location[1] = _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_0__["RelativePosition"].AFTER;
        }
        return location;
    }
}


/***/ }),

/***/ "./packages/plugin-linebreak/src/LineBreakXmlDomParser.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-linebreak/src/LineBreakXmlDomParser.ts ***!
  \****************************************************************/
/*! exports provided: LineBreakXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LineBreakXmlDomParser", function() { return LineBreakXmlDomParser; });
/* harmony import */ var _LineBreakNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./LineBreakNode */ "./packages/plugin-linebreak/src/LineBreakNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_isBlock__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/isBlock */ "./packages/utils/src/isBlock.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");





class LineBreakXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(item) === 'BR';
        };
    }
    async parse(item) {
        if (this._isInvisibleBR(item)) {
            return [];
        }
        const lineBreak = new _LineBreakNode__WEBPACK_IMPORTED_MODULE_0__["LineBreakNode"]();
        lineBreak.modifiers.append(this.engine.parseAttributes(item));
        return [lineBreak];
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return true if the given <br/> node is invisible. A <br/> at the end edge
     * of a block or before another block is there only to make its parent
     * visible. Consume it since it was just parsed as its parent element node.
     * TODO: account for formatting space.
     *
     * @param node
     */
    _isInvisibleBR(node) {
        // Search for another non-block cousin in the same block parent.
        while (node && !node.nextSibling && node.parentNode && !Object(_utils_src_isBlock__WEBPACK_IMPORTED_MODULE_3__["isBlock"])(node.parentNode)) {
            node = node.parentNode;
        }
        return !node || !node.nextSibling || Object(_utils_src_isBlock__WEBPACK_IMPORTED_MODULE_3__["isBlock"])(node.nextSibling);
    }
}
LineBreakXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-link/assets/LinkForm.xml":
/*!**************************************************!*\
  !*** ./packages/plugin-link/assets/LinkForm.xml ***!
  \**************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<templates>\n    <div t-name=\"link\">\n        <h2>Insert a link</h2>\n        <table class=\"form-table\">\n            <tr>\n                <td><label for=\"linkUrl\">URL </label></td>\n                <td><input type=\"text\" id=\"linkUrl\" name=\"url\" t-model=\"state.url\"/></td>\n            </tr>\n            <tr>\n                <td><label for=\"linkLabel\">Label </label></td>\n                <td><input type=\"text\" id=\"linkLabel\" name=\"label\" t-model=\"state.label\"/></td>\n            </tr>\n        </table>\n        <br/>\n        <button name=\"save\" t-on-click=\"saveLink()\">Save</button> <button name=\"save\" t-on-click=\"cancel()\">Cancel</button>\n    </div>\n</templates>\n"

/***/ }),

/***/ "./packages/plugin-link/src/Link.ts":
/*!******************************************!*\
  !*** ./packages/plugin-link/src/Link.ts ***!
  \******************************************/
/*! exports provided: Link */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Link", function() { return Link; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _LinkXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LinkXmlDomParser */ "./packages/plugin-link/src/LinkXmlDomParser.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _LinkFormat__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./LinkFormat */ "./packages/plugin-link/src/LinkFormat.ts");
/* harmony import */ var _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/Modifiers */ "./packages/core/src/Modifiers.ts");
/* harmony import */ var _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/src/VNodes/AbstractNode */ "./packages/core/src/VNodes/AbstractNode.ts");
/* harmony import */ var _assets_LinkForm_xml__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../assets/LinkForm.xml */ "./packages/plugin-link/assets/LinkForm.xml");
/* harmony import */ var _assets_LinkForm_xml__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(_assets_LinkForm_xml__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");









class Link extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            link: {
                handler: this.link,
            },
            unlink: {
                handler: this.unlink,
            },
        };
        this.loadables = {
            parsers: [_LinkXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["LinkXmlDomParser"]],
            shortcuts: [
                {
                    pattern: 'CTRL+K',
                    selector: [(node) => !Link.isLink(node)],
                    commandId: 'link',
                },
                {
                    pattern: 'CTRL+K',
                    selector: [Link.isLink],
                    commandId: 'unlink',
                },
            ],
            // componentZones: [['link', 'float']],
            owlTemplates: [_assets_LinkForm_xml__WEBPACK_IMPORTED_MODULE_7___default.a],
        };
    }
    static isLink(link, node) {
        if (link instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_6__["AbstractNode"]) {
            node = link;
        }
        const format = node.is(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"]) && node.modifiers.find(_LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"]);
        return link instanceof _core_src_VNodes_AbstractNode__WEBPACK_IMPORTED_MODULE_6__["AbstractNode"] ? !!format : format === link;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    async link(params) {
        // // If the url is undefined, ask the user to provide one.
        // if (!params.url) {
        //     const layout = this.editor.plugins.get(Layout);
        //     await layout.remove('link');
        //     await layout.add('link');
        //     return this.editor.execCommand('show', { componentID: 'link' });
        // }
        const link = new _LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"](params.url);
        if (params.target) {
            link.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_8__["Attributes"]).set('target', params.target);
        }
        // // TODO: modal re-using url
        // if (!link) return;
        // if (range.isCollapsed()) {
        console.log('params:', params);
        console.log('link:', link);
        this.editor.execCommand('insertText', {
            text: params.label || link.url,
            formats: new _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__["Modifiers"](link),
            select: true,
            context: params.context,
        });
        // } else {
        //     for (const inline of selectedInlines) {
        //         inline.formats.replace(LinkFormat, link);
        //     }
        // }
    }
    unlink(params) {
        const range = params.context.range;
        const node = range.start.previousSibling() || range.start.nextSibling();
        if (!node.is(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_3__["InlineNode"]))
            return;
        const link = node.modifiers.find(_LinkFormat__WEBPACK_IMPORTED_MODULE_4__["LinkFormat"]);
        if (!link)
            return;
        const sameLink = Link.isLink.bind(Link, link);
        for (const inline of [node, ...node.adjacents(sameLink)]) {
            inline.modifiers.remove(link);
        }
    }
}
Link.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]];


/***/ }),

/***/ "./packages/plugin-link/src/LinkFormat.ts":
/*!************************************************!*\
  !*** ./packages/plugin-link/src/LinkFormat.ts ***!
  \************************************************/
/*! exports provided: LinkFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LinkFormat", function() { return LinkFormat; });
/* harmony import */ var _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/Format */ "./packages/plugin-inline/src/Format.ts");

class LinkFormat extends _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor(url = '#', target = '') {
        super('A');
        this.url = url;
        this.target = target;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * @override
     */
    render() {
        const element = super.render();
        element.setAttribute('href', this.url);
        return element;
    }
    /**
     * @override
     */
    clone() {
        const clone = super.clone();
        clone.url = this.url;
        return clone;
    }
}


/***/ }),

/***/ "./packages/plugin-link/src/LinkXmlDomParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-link/src/LinkXmlDomParser.ts ***!
  \******************************************************/
/*! exports provided: LinkXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LinkXmlDomParser", function() { return LinkXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatParser */ "./packages/plugin-inline/src/FormatParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _LinkFormat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./LinkFormat */ "./packages/plugin-link/src/LinkFormat.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");





class LinkXmlDomParser extends _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__["FormatParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'A';
        };
    }
    async parse(item) {
        var _a;
        const link = new _LinkFormat__WEBPACK_IMPORTED_MODULE_2__["LinkFormat"](item.getAttribute('href'));
        link.modifiers.append(this.engine.parseAttributes(item));
        (_a = link.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"])) === null || _a === void 0 ? void 0 : _a.remove('href'); // href is on link.url
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(link, children);
        return children;
    }
}
LinkXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-list/src/List.ts":
/*!******************************************!*\
  !*** ./packages/plugin-list/src/List.ts ***!
  \******************************************/
/*! exports provided: List */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "List", function() { return List; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ListNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ListNode */ "./packages/plugin-list/src/ListNode.ts");
/* harmony import */ var _ListHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ListHtmlDomRenderer */ "./packages/plugin-list/src/ListHtmlDomRenderer.ts");
/* harmony import */ var _ListItemHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ListItemHtmlDomRenderer */ "./packages/plugin-list/src/ListItemHtmlDomRenderer.ts");
/* harmony import */ var _ListXmlDomParser__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ListXmlDomParser */ "./packages/plugin-list/src/ListXmlDomParser.ts");
/* harmony import */ var _ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ListItemXmlDomParser */ "./packages/plugin-list/src/ListItemXmlDomParser.ts");
/* harmony import */ var _core_src_VRange__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/src/VRange */ "./packages/core/src/VRange.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");








class List extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            toggleList: {
                title: 'Toggle list',
                handler: this.toggleList,
            },
            indent: {
                title: 'Indent list items',
                selector: [_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]],
                handler: this.indent,
            },
            outdent: {
                title: 'Outdent list items',
                selector: [_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]],
                handler: this.outdent,
            },
            insertParagraphBreak: {
                selector: [_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"], List.isListItem],
                check: (context) => {
                    const [list, listItem] = context.selector;
                    return !listItem.hasChildren() && listItem === list.lastChild();
                },
                handler: this.insertParagraphBreak,
            },
        };
        this.commandHooks = {
            // TODO: replace this with `onSiblingsChange` when we introduce events.
            deleteBackward: this.rejoin.bind(this),
            deleteForward: this.rejoin.bind(this),
        };
        this.loadables = {
            parsers: [_ListXmlDomParser__WEBPACK_IMPORTED_MODULE_4__["ListXmlDomParser"], _ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__["ListItemXmlDomParser"]],
            renderers: [_ListItemHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_3__["ListItemHtmlDomRenderer"], _ListHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__["ListHtmlDomRenderer"]],
            shortcuts: [
                {
                    pattern: 'CTRL+SHIFT+<Digit7>',
                    commandId: 'toggleList',
                    commandArgs: { type: _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].ORDERED },
                },
                {
                    pattern: 'CTRL+SHIFT+<Digit8>',
                    commandId: 'toggleList',
                    commandArgs: { type: _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].UNORDERED },
                },
                {
                    pattern: 'Backspace',
                    selector: [List.isListItem],
                    check: (context) => {
                        return !context.range.start.previousSibling();
                    },
                    commandId: 'outdent',
                },
            ],
        };
    }
    static isListItem(node) {
        return node.parent && node.parent.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
    }
    static isInList(type, node) {
        var _a;
        return ((_a = node === null || node === void 0 ? void 0 : node.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"])) === null || _a === void 0 ? void 0 : _a.listType) === type;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Insert/remove a list at range.
     *
     * @param params
     */
    toggleList(params) {
        const type = params.type;
        const range = params.context.range;
        Object(_core_src_VRange__WEBPACK_IMPORTED_MODULE_6__["withRange"])(_core_src_VRange__WEBPACK_IMPORTED_MODULE_6__["VRange"].clone(range), range => {
            // Extend the range to cover the entirety of its containers.
            if (range.startContainer.hasChildren()) {
                range.setStart(range.startContainer.firstChild());
            }
            if (range.endContainer.hasChildren()) {
                range.setEnd(range.endContainer.lastChild());
            }
            // If all targeted nodes are within a list of given type then unlist
            // them. Otherwise, convert them to the given list type.
            const targetedNodes = range.targetedNodes();
            const ancestors = targetedNodes.map(node => node.closest(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]));
            const targetedLists = ancestors.filter(list => !!list);
            if (targetedLists.length === targetedNodes.length &&
                targetedLists.every(list => list.listType === type)) {
                // Unlist the targeted nodes from all its list ancestors.
                while (range.start.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"])) {
                    const nodesToUnlist = range.split(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
                    for (const list of nodesToUnlist) {
                        for (const nestedList of list.descendants(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"])) {
                            // TODO: automatically invalidate `ListItemAttributes`.
                            for (const child of nestedList.childVNodes) {
                                child.modifiers.remove(_ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__["ListItemAttributes"]);
                            }
                            nestedList.unwrap();
                        }
                        list.unwrap();
                    }
                }
            }
            else if (targetedLists.length === targetedNodes.length) {
                // If all nodes are in lists, convert the targeted list
                // nodes to the given list type.
                const lists = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_7__["distinct"])(targetedLists);
                const listsToConvert = lists.filter(l => l.listType !== type);
                for (const list of listsToConvert) {
                    let newList = new _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]({ listType: type });
                    list.replaceWith(newList);
                    // If the new list is after or before a list of the same
                    // type, merge them. Example:
                    // <ol><li>a</li></ol><ol><li>b</li></ol>
                    // => <ol><li>a</li><li>b</li></ol>).
                    const previousSibling = newList.previousSibling();
                    if (previousSibling && previousSibling.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][type])) {
                        newList.mergeWith(previousSibling);
                        newList = previousSibling;
                    }
                    const nextSibling = newList.nextSibling();
                    if (nextSibling && nextSibling.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][type])) {
                        nextSibling.mergeWith(newList);
                    }
                }
            }
            else {
                // If only some nodes are in lists and other aren't then only
                // wrap the ones that were not already in a list into a list of
                // the given type.
                let newList = new _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]({ listType: type });
                const nodesToConvert = range.split(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
                for (const node of nodesToConvert) {
                    node.wrap(newList);
                    // Merge top-level lists instead of nesting them.
                    if (node.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"])) {
                        node.mergeWith(newList);
                    }
                }
                // If the new list is after or before a list of the same type,
                // merge them. Example:
                // <ol><li>a</li></ol><ol><li>b</li></ol>
                // => <ol><li>a</li><li>b</li></ol>).
                const previousSibling = newList.previousSibling();
                if (previousSibling && previousSibling.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][type])) {
                    newList.mergeWith(previousSibling);
                    newList = previousSibling;
                }
                const nextSibling = newList.nextSibling();
                if (nextSibling && nextSibling.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][type])) {
                    nextSibling.mergeWith(newList);
                }
            }
        });
    }
    /**
     * Indent one or more list items.
     *
     * @param params
     */
    indent(params) {
        const range = params.context.range;
        const items = range.targetedNodes(node => { var _a; return (_a = node.parent) === null || _a === void 0 ? void 0 : _a.test(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]); });
        // Do not indent items of a targeted nested list, since they
        // will automatically be indented with their list ancestor.
        const itemsToIndent = items.filter(item => {
            return !items.includes(item.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]));
        });
        if (!itemsToIndent.length)
            return;
        for (const item of itemsToIndent) {
            const prev = item.previousSibling();
            const next = item.nextSibling();
            // Indent the item by putting it into a pre-existing list sibling.
            if (prev && prev.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"])) {
                prev.append(item);
                // The two list siblings might be rejoinable now that the lower
                // level item breaking them into two different lists is no more.
                const listType = prev.listType;
                if (_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][listType](next) && !itemsToIndent.includes(next)) {
                    next.mergeWith(prev);
                }
            }
            else if ((next === null || next === void 0 ? void 0 : next.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"])) && !itemsToIndent.includes(next)) {
                next.prepend(item);
            }
            else {
                // If no other candidate exists then wrap it in a new ListNode.
                const listType = item.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]).listType;
                item.wrap(new _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]({ listType: listType }));
            }
        }
    }
    /**
     * Outdent one or more list items.
     *
     * @param params
     */
    outdent(params) {
        const range = params.context.range;
        const items = range.targetedNodes(node => { var _a; return (_a = node.parent) === null || _a === void 0 ? void 0 : _a.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]); });
        // Do not outdent items of a targeted nested list, since they
        // will automatically be outdented with their list ancestor.
        const itemsToOutdent = items.filter(item => {
            return !items.includes(item.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]));
        });
        if (!itemsToOutdent.length)
            return;
        for (const item of itemsToOutdent) {
            const list = item.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
            const previousSibling = item.previousSibling();
            const nextSibling = item.nextSibling();
            if (previousSibling && nextSibling) {
                const splitList = item.parent.splitAt(item);
                splitList.before(item);
            }
            else if (previousSibling) {
                list.after(item);
            }
            else if (nextSibling) {
                list.before(item);
            }
            else {
                list.unwrap();
            }
        }
    }
    /**
     * Insert a paragraph break in the last empty item of a list by unwrapping
     * the list item from the list, thus becoming the new paragraph.
     *
     * @param params
     */
    insertParagraphBreak(params) {
        const range = params.context.range;
        const listItem = range.startContainer;
        const listNode = listItem.ancestor(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
        if (listNode.children().length === 1) {
            listNode.unwrap();
        }
        else {
            listNode.after(listItem);
        }
    }
    /**
     * Rejoin same type lists that are now direct siblings after the remove.
     *
     * @param params
     */
    rejoin(params) {
        const range = params.context.range;
        const listAncestors = range.start.ancestors(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]);
        if (listAncestors.length) {
            let list = listAncestors[listAncestors.length - 1];
            let nextSibling = list && list.nextSibling();
            while (list &&
                nextSibling &&
                list.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"]) &&
                nextSibling.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"][list.listType])) {
                const nextList = list.lastChild();
                const nextListSibling = nextSibling.firstChild();
                nextSibling.mergeWith(list);
                list = nextList;
                nextSibling = nextListSibling;
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-list/src/ListButtons.ts":
/*!*************************************************!*\
  !*** ./packages/plugin-list/src/ListButtons.ts ***!
  \*************************************************/
/*! exports provided: OrderedListButton, UnorderedListButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OrderedListButton", function() { return OrderedListButton; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UnorderedListButton", function() { return UnorderedListButton; });
/* harmony import */ var _List__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./List */ "./packages/plugin-list/src/List.ts");
/* harmony import */ var _ListNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ListNode */ "./packages/plugin-list/src/ListNode.ts");


const OrderedListButton = {
    title: 'Toggle ordered list',
    class: 'fa-list-ol',
    commandId: 'toggleList',
    commandArgs: { type: _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].ORDERED },
    selected: (editor) => {
        const targetedNodes = editor.selection.range.targetedNodes();
        return targetedNodes.every(_List__WEBPACK_IMPORTED_MODULE_0__["List"].isInList.bind(_List__WEBPACK_IMPORTED_MODULE_0__["List"], _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].ORDERED));
    },
};
const UnorderedListButton = {
    title: 'Toggle unordered list',
    class: 'fa-list-ul',
    commandId: 'toggleList',
    commandArgs: { type: _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].UNORDERED },
    selected: (editor) => {
        const targetedNodes = editor.selection.range.targetedNodes();
        return targetedNodes.every(_List__WEBPACK_IMPORTED_MODULE_0__["List"].isInList.bind(_List__WEBPACK_IMPORTED_MODULE_0__["List"], _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].UNORDERED));
    },
};


/***/ }),

/***/ "./packages/plugin-list/src/ListHtmlDomRenderer.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-list/src/ListHtmlDomRenderer.ts ***!
  \*********************************************************/
/*! exports provided: ListHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListHtmlDomRenderer", function() { return ListHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _ListNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ListNode */ "./packages/plugin-list/src/ListNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class ListHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"];
    }
    async render(node) {
        const tag = node.listType === _ListNode__WEBPACK_IMPORTED_MODULE_1__["ListType"].ORDERED ? 'OL' : 'UL';
        const domListNode = document.createElement(tag);
        this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], node, domListNode);
        const renderedChildren = await this.renderChildren(node);
        domListNode.append(...renderedChildren.flat());
        return [domListNode];
    }
}
ListHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-list/src/ListItemHtmlDomRenderer.ts":
/*!*************************************************************!*\
  !*** ./packages/plugin-list/src/ListItemHtmlDomRenderer.ts ***!
  \*************************************************************/
/*! exports provided: ListItemHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListItemHtmlDomRenderer", function() { return ListItemHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _ListNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ListNode */ "./packages/plugin-list/src/ListNode.ts");
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _List__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./List */ "./packages/plugin-list/src/List.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./ListItemXmlDomParser */ "./packages/plugin-list/src/ListItemXmlDomParser.ts");






class ListItemHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _List__WEBPACK_IMPORTED_MODULE_3__["List"].isListItem;
    }
    async render(node) {
        const domListItem = document.createElement('li');
        if (node.is(_ListNode__WEBPACK_IMPORTED_MODULE_1__["ListNode"])) {
            if (!domListItem.style.listStyle) {
                domListItem.style.listStyle = 'none';
            }
        }
        // Direct ListNode's VElement children "P" are rendered as "LI"
        // while other nodes will be rendered inside the "LI".
        if (node.is(_core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_2__["VElement"]) && node.htmlTag === 'P') {
            const renderedChildren = await this.renderChildren(node);
            domListItem.append(...renderedChildren.flat());
        }
        else {
            // The node was wrapped in a "LI" but needs to be rendered as well.
            const renderedNode = await this.super.render(node);
            domListItem.append(...renderedNode);
        }
        // Render the node's attributes that were stored on the technical key
        // that specifies those attributes belong on the list item.
        this.engine.renderAttributes(_ListItemXmlDomParser__WEBPACK_IMPORTED_MODULE_5__["ListItemAttributes"], node, domListItem);
        return [domListItem];
    }
}
ListItemHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_4__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-list/src/ListItemXmlDomParser.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-list/src/ListItemXmlDomParser.ts ***!
  \**********************************************************/
/*! exports provided: ListItemAttributes, ListItemXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListItemAttributes", function() { return ListItemAttributes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListItemXmlDomParser", function() { return ListItemXmlDomParser; });
/* harmony import */ var _utils_src_isBlock__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../utils/src/isBlock */ "./packages/utils/src/isBlock.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/Modifiers */ "./packages/core/src/Modifiers.ts");






class ListItemAttributes extends _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"] {
}
class ListItemXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_2__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(item) === 'LI';
        };
    }
    /**
     * Parse a list element (LI).
     *
     * @param context
     */
    async parse(item) {
        const children = Array.from(item.childNodes);
        // A list item with no children should be skipped.
        if (!children.length) {
            return [];
        }
        const nodes = [];
        let inlinesContainer;
        // Parse the list item's attributes into the node's ListItemAttributes,
        // which will be read only by ListItemDomRenderer.
        const itemModifiers = new _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__["Modifiers"](this.engine.parseAttributes(item));
        const Container = this.engine.editor.configuration.defaults.Container;
        for (let childIndex = 0; childIndex < children.length; childIndex++) {
            const domChild = children[childIndex];
            const parsedChild = await this.engine.parse(domChild);
            if (parsedChild.length) {
                if (this._isInlineListItem(domChild)) {
                    // Contiguous inline elements in a list item should be
                    // wrapped together in a base container.
                    if (!inlinesContainer) {
                        inlinesContainer = new Container();
                        inlinesContainer.modifiers.append(new ListItemAttributes(itemModifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"])));
                        nodes.push(inlinesContainer);
                    }
                    inlinesContainer.append(...parsedChild);
                }
                else {
                    inlinesContainer = null; // Close the inlinesContainer.
                    for (const child of parsedChild) {
                        child.modifiers.replace(ListItemAttributes, new ListItemAttributes(itemModifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"])));
                    }
                    nodes.push(...parsedChild);
                }
            }
        }
        // A list item with children but whose parsing returned nothing should
        // be parsed as an empty base container. Eg: <li><br/></li>: li has a
        // child so it will not return [] above (and therefore be ignored), but
        // br will parse to nothing because it's a placeholder br, not a real
        // line break. We cannot ignore that li because it does in fact exist so
        // we parse it as an empty base container.
        return nodes.length ? nodes : [new Container()];
    }
    /**
     * Return true if the given node is an inline list item.
     *
     * @param item
     */
    _isInlineListItem(item) {
        return item && (!Object(_utils_src_isBlock__WEBPACK_IMPORTED_MODULE_0__["isBlock"])(item) || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(item) === 'BR');
    }
}
ListItemXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-list/src/ListNode.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-list/src/ListNode.ts ***!
  \**********************************************/
/*! exports provided: ListType, ListNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListType", function() { return ListType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListNode", function() { return ListNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

var ListType;
(function (ListType) {
    ListType["ORDERED"] = "ORDERED";
    ListType["UNORDERED"] = "UNORDERED";
})(ListType || (ListType = {}));
class ListNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
    constructor(params) {
        super();
        this.listType = params.listType;
    }
    // Typescript currently doesn't support using enum as keys in interfaces.
    // Source: https://github.com/microsoft/TypeScript/issues/13042
    static ORDERED(node) {
        return node && node.is(ListNode) && node.listType === ListType.ORDERED;
    }
    static UNORDERED(node) {
        return node && node.is(ListNode) && node.listType == ListType.UNORDERED;
    }
    get name() {
        return super.name + ': ' + this.listType;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     *
     *  @override
     */
    clone(deepClone, params) {
        const defaults = {
            listType: this.listType,
        };
        return super.clone(deepClone, { ...defaults, ...params });
    }
}


/***/ }),

/***/ "./packages/plugin-list/src/ListXmlDomParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-list/src/ListXmlDomParser.ts ***!
  \******************************************************/
/*! exports provided: ListXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ListXmlDomParser", function() { return ListXmlDomParser; });
/* harmony import */ var _ListNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ListNode */ "./packages/plugin-list/src/ListNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




const listTags = ['UL', 'OL'];
class ListXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && listTags.includes(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item));
        };
    }
    /**
     * Parse a list (UL, OL) and his children list elements (LI).
     *
     * @param context
     */
    async parse(item) {
        if (!listTags.includes(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item)))
            return;
        const listType = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'UL' ? _ListNode__WEBPACK_IMPORTED_MODULE_0__["ListType"].UNORDERED : _ListNode__WEBPACK_IMPORTED_MODULE_0__["ListType"].ORDERED;
        const listNode = new _ListNode__WEBPACK_IMPORTED_MODULE_0__["ListNode"]({ listType });
        listNode.modifiers.append(this.engine.parseAttributes(item));
        const nodes = await this.engine.parse(...item.childNodes);
        listNode.append(...nodes);
        return [listNode];
    }
}
ListXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-metadata/src/MetaDataHtmlDomRenderer.ts":
/*!*****************************************************************!*\
  !*** ./packages/plugin-metadata/src/MetaDataHtmlDomRenderer.ts ***!
  \*****************************************************************/
/*! exports provided: MetadataHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MetadataHtmlDomRenderer", function() { return MetadataHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _MetadataNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MetadataNode */ "./packages/plugin-metadata/src/MetadataNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class MetadataHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _MetadataNode__WEBPACK_IMPORTED_MODULE_2__["MetadataNode"];
    }
    async render(node) {
        const domNode = document.createElement(node.htmlTag);
        this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], node, domNode);
        domNode.innerHTML = node.contents;
        return [domNode];
    }
}
MetadataHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-metadata/src/Metadata.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-metadata/src/Metadata.ts ***!
  \**************************************************/
/*! exports provided: Metadata */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Metadata", function() { return Metadata; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _MetadataXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MetadataXmlDomParser */ "./packages/plugin-metadata/src/MetadataXmlDomParser.ts");
/* harmony import */ var _MetaDataHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MetaDataHtmlDomRenderer */ "./packages/plugin-metadata/src/MetaDataHtmlDomRenderer.ts");



class Metadata extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_MetadataXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["MetadataXmlDomParser"]],
            renderers: [_MetaDataHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__["MetadataHtmlDomRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-metadata/src/MetadataNode.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-metadata/src/MetadataNode.ts ***!
  \******************************************************/
/*! exports provided: MetadataNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MetadataNode", function() { return MetadataNode; });
/* harmony import */ var _core_src_VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/MarkerNode */ "./packages/core/src/VNodes/MarkerNode.ts");

class MetadataNode extends _core_src_VNodes_MarkerNode__WEBPACK_IMPORTED_MODULE_0__["MarkerNode"] {
    constructor(htmlTag) {
        super();
        this.contents = '';
        this.htmlTag = htmlTag;
    }
    get name() {
        return this.constructor.name + ': ' + this.htmlTag;
    }
}
MetadataNode.atomic = true;


/***/ }),

/***/ "./packages/plugin-metadata/src/MetadataXmlDomParser.ts":
/*!**************************************************************!*\
  !*** ./packages/plugin-metadata/src/MetadataXmlDomParser.ts ***!
  \**************************************************************/
/*! exports provided: MetadataXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MetadataXmlDomParser", function() { return MetadataXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _MetadataNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./MetadataNode */ "./packages/plugin-metadata/src/MetadataNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




// See https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Content_categories#Metadata_content
const METADATA_NODENAMES = [
    'BASE',
    'COMMAND',
    'LINK',
    'META',
    'NOSCRIPT',
    'SCRIPT',
    'STYLE',
    'TITLE',
];
class MetadataXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && METADATA_NODENAMES.includes(Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item));
        };
    }
    async parse(item) {
        const technical = new _MetadataNode__WEBPACK_IMPORTED_MODULE_2__["MetadataNode"](Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item));
        technical.modifiers.append(this.engine.parseAttributes(item));
        technical.contents = item.innerHTML;
        return [technical];
    }
}
MetadataXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-odoo-snippets/src/LinkButton.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-odoo-snippets/src/LinkButton.ts ***!
  \*********************************************************/
/*! exports provided: LinkButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LinkButton", function() { return LinkButton; });
const LinkButton = {
    title: 'Link',
    commandId: 'openLinkDialog',
    class: 'fa-link',
};


/***/ }),

/***/ "./packages/plugin-odoo-snippets/src/MediaButton.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-odoo-snippets/src/MediaButton.ts ***!
  \**********************************************************/
/*! exports provided: MediaButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MediaButton", function() { return MediaButton; });
const MediaButton = {
    title: 'Media',
    commandId: 'openMedia',
    class: 'fa-file-image-o',
};


/***/ }),

/***/ "./packages/plugin-odoo-snippets/src/OdooBindings.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-odoo-snippets/src/OdooBindings.ts ***!
  \***********************************************************/
/*! exports provided: createExecCommandHelpersForOdoo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "createExecCommandHelpersForOdoo", function() { return createExecCommandHelpersForOdoo; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");




function createExecCommandHelpersForOdoo(editor) {
    const layout = editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_3__["Layout"]);
    const domEngine = layout.engines.dom;
    function _getVElements(node) {
        const vnodes = domEngine.getNodes(node);
        for (const vnode of vnodes) {
            if (!(vnode instanceof _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"])) {
                throw new Error('VNode is not a VElement');
            }
        }
        return vnodes;
    }
    const odooCommands = {
        hasVNode(node) {
            const vnodes = domEngine.getNodes(node);
            return !!(vnodes && vnodes.length);
        },
        async addClasses(node, classes) {
            const params = {
                elements: _getVElements(node),
                classes,
            };
            await editor.execCommand('addClasses', params);
        },
        async removeClasses(node, classes) {
            const params = {
                elements: _getVElements(node),
                classes,
            };
            await editor.execCommand('removeClasses', params);
        },
        async toggleClass(node, klass, set) {
            const nodes = domEngine.getNodes(node);
            if (!nodes) {
                throw new Error('nodes are empty');
            }
            const params = {
                nodes: nodes,
                class: klass,
                set,
            };
            await editor.execCommand('toggleClass', params);
        },
        async setAttribute(node, attributeName, attributeValue) {
            const params = {
                elements: _getVElements(node),
                attributeName,
                attributeValue,
            };
            await editor.execCommand('setAttribute', params);
        },
        async setStyle(node, property, value, important = false) {
            const params = {
                nodes: domEngine.getNodes(node),
                property,
                value,
                important,
            };
            await editor.execCommand('setStyle', params);
        },
        // todo: sometimes i need to append. Because the implementation of the insertHTML append
        // it when the RelativePosition is 'inside', it work. But this is unclear that it will
        // append.
        // Change the API to have a clearer distinction and allowing to append/prepend;
        async insertHtml(rangePoint, html) {
            const vnode = domEngine.getNodes(rangePoint[0])[0];
            const params = {
                rangePoint: [vnode, rangePoint[1]],
                html,
            };
            return await editor.execCommand('insertHtml', params);
        },
        async moveBefore(fromNode, toNode) {
            const fromVNode = domEngine.getNodes(fromNode)[0];
            const toVNode = domEngine.getNodes(toNode)[0];
            const params = {
                from: fromVNode,
                to: [toVNode, _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].BEFORE],
            };
            return await editor.execCommand('move', params);
        },
        async moveAfter(fromNode, toNode) {
            const fromVNode = domEngine.getNodes(fromNode)[0];
            const toVNode = domEngine.getNodes(toNode)[0];
            const params = {
                from: fromVNode,
                to: [toVNode, _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_1__["RelativePosition"].AFTER],
            };
            return await editor.execCommand('move', params);
        },
        async remove(node) {
            const params = {
                vnodes: domEngine.getNodes(node),
            };
            return await editor.execCommand('remove', params);
        },
        exists(node) {
            return !!domEngine.getNodes(node);
        },
        async empty(node) {
            const params = {
                vnodes: domEngine.getNodes(node),
            };
            return await editor.execCommand('empty', params);
        },
        async wrap(node, html) {
            const container = domEngine.getNodes(node)[0];
            if (!(container instanceof _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__["ContainerNode"])) {
                throw new Error('The provided node must be a ContainerNode in the jabberwock structure');
            }
            const params = {
                container,
                html,
            };
            return await editor.execCommand('empty', params);
        },
        async replace(node, html) {
            const params = {
                nodes: domEngine.getNodes(node),
                html,
            };
            return await editor.execCommand('replace', params);
        },
    };
    return odooCommands;
}


/***/ }),

/***/ "./packages/plugin-odoo-snippets/src/OdooImageHtmlDomRenderer.ts":
/*!***********************************************************************!*\
  !*** ./packages/plugin-odoo-snippets/src/OdooImageHtmlDomRenderer.ts ***!
  \***********************************************************************/
/*! exports provided: OdooImageHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooImageHtmlDomRenderer", function() { return OdooImageHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_image_src_ImageNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-image/src/ImageNode */ "./packages/plugin-image/src/ImageNode.ts");



function isElement(node) {
    return node.nodeType === node.ELEMENT_NODE;
}
// export interface OpenImageParams {
//     image: ImageNode;
// }
class OdooImageHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _plugin_image_src_ImageNode__WEBPACK_IMPORTED_MODULE_2__["ImageNode"];
    }
    async render(node) {
        const nodes = await this.super.render(node);
        const image = nodes.length &&
            nodes.find(node => isElement(node) && node.nodeName.toUpperCase() === 'IMG');
        if (image) {
            image.addEventListener('dblclick', e => {
                const params = { image: node };
                this.engine.editor.execCommand('openMedia', params);
                // e.preventDefault();
                // e.stopPropagation();
                // e.stopImmediatePropagation();
                // alert('dblclick');
                // this.engine.editor.nextEventMutex(() => {
                //     this.engine.editor.execCustomCommand(async () => {
                //         console.log('selecting');
                //         this.engine.editor.selection.select(node, node);
                //     });
                // });
                // console.log('clicked');
            });
        }
        return nodes;
    }
}
OdooImageHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-odoo-snippets/src/OdooSnippet.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-odoo-snippets/src/OdooSnippet.ts ***!
  \**********************************************************/
/*! exports provided: OdooSnippet */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooSnippet", function() { return OdooSnippet; });
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-layout/src/Layout */ "./packages/plugin-layout/src/Layout.ts");
/* harmony import */ var _OdooStructureNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./OdooStructureNode */ "./packages/plugin-odoo-snippets/src/OdooStructureNode.ts");
/* harmony import */ var _OdooStrucutreXmlDomParser__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./OdooStrucutreXmlDomParser */ "./packages/plugin-odoo-snippets/src/OdooStrucutreXmlDomParser.ts");
/* harmony import */ var _OdooImageHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./OdooImageHtmlDomRenderer */ "./packages/plugin-odoo-snippets/src/OdooImageHtmlDomRenderer.ts");
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_link_src_LinkFormat__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../plugin-link/src/LinkFormat */ "./packages/plugin-link/src/LinkFormat.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../plugin-char/src/CharNode */ "./packages/plugin-char/src/CharNode.ts");















class OdooSnippet extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_1__["JWPlugin"] {
    constructor(editor, configuration) {
        super(editor, configuration);
        this.editor = editor;
        this.configuration = configuration;
        this.loadables = {
            parsers: [_OdooStrucutreXmlDomParser__WEBPACK_IMPORTED_MODULE_8__["OdooStrucutreXmlDomParser"]],
            renderers: [_OdooImageHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_9__["OdooImageHtmlDomRenderer"]],
            shortcuts: [],
        };
        this.commands = {
            removeClasses: {
                handler: this.removeClasses.bind(this),
            },
            addClasses: {
                handler: this.addClasses.bind(this),
            },
            addClassToLink: {
                handler: this.addClassToLink.bind(this),
            },
            toggleClass: {
                handler: this.toggleClass.bind(this),
            },
            setAttribute: {
                handler: this.setAttribute.bind(this),
            },
            setStyle: {
                handler: this.setStyle.bind(this),
            },
            move: {
                handler: this.move.bind(this),
            },
            remove: {
                handler: this.remove.bind(this),
            },
            empty: {
                handler: this.empty.bind(this),
            },
            wrap: {
                handler: this.wrap.bind(this),
            },
            replace: {
                handler: this.replace.bind(this),
            },
            getStructures: {
                handler: this.getStructures.bind(this),
            },
            getRecordCover: {
                handler: this.getRecordCover.bind(this),
            },
            getLinkInfo: {
                handler: this.getLinkInfo.bind(this),
            },
        };
    }
    removeClasses(params) {
        // todo: use range rather than params.elements
        for (const element of params.elements) {
            for (const className of params.classes) {
                element.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"]).classList.remove(className);
            }
        }
    }
    addClasses(params) {
        var _a;
        // todo: remeve elements and only use a range.
        let nodes;
        if (params.elements) {
            nodes = params.elements;
        }
        else {
            nodes = ((_a = params.context) === null || _a === void 0 ? void 0 : _a.range.selectedNodes()) || [];
        }
        for (const element of nodes) {
            for (const className of params.classes) {
                element.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"]).classList.add(className);
            }
        }
    }
    addClassToLink(params) {
        console.log('addclasstolink');
        console.log('params.context.range:', params.context.range);
        console.log('params.context.range.start:', params.context.range.start);
        console.log('params.context.range.targetedNodes():', params.context.range.targetedNodes());
        console.log('params.context.range.traversedNodes():', params.context.range.traversedNodes());
        const nodes = params.context.range.targetedNodes(_plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_10__["InlineNode"]);
        console.log('nodes:', nodes);
        for (const node of nodes) {
            node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"]).set('class', params.class);
        }
    }
    toggleClass(params) {
        for (const node of params.nodes) {
            const classList = node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"]).classList;
            const value = typeof params.set !== 'undefined' ? params.set : !classList.has(params.class);
            if (value) {
                classList.add(params.class);
            }
            else {
                classList.remove(params.class);
            }
        }
    }
    setAttribute(params) {
        for (const element of params.elements) {
            element.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"]).set(params.attributeName, params.attributeValue);
        }
    }
    setStyle(params) {
        for (const node of params.nodes) {
            const value = params.important ? params.value + ' !important' : params.value;
            node.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"]).style.set(params.property, value);
        }
    }
    move(params) {
        switch (params.to[1]) {
            case _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_4__["RelativePosition"].AFTER:
                params.from.after(params.to[0]);
                break;
            case _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_4__["RelativePosition"].BEFORE:
                params.from.before(params.to[0]);
                break;
            case _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_4__["RelativePosition"].INSIDE:
                params.from.append(params.to[0]);
                break;
        }
    }
    remove(params) {
        for (const vnode of params.vnodes) {
            vnode.remove();
        }
    }
    empty(params) {
        for (const vnode of params.vnodes) {
            vnode.empty();
        }
    }
    getStructures() {
        const layout = this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_6__["Layout"]);
        const domLayout = layout.engines.dom;
        const editable = domLayout.components.get('editable')[0];
        const structures = editable.descendants(_OdooStructureNode__WEBPACK_IMPORTED_MODULE_7__["OdooStructureNode"]);
        return structures;
    }
    async wrap(params) {
        const parsedNodes = await this._parseHTMLString(params.html);
        const wrapNode = parsedNodes[0];
        const containerVNodes = [...params.container.childVNodes];
        if (!(wrapNode instanceof _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_5__["ContainerNode"])) {
            throw new Error('Impossible to wrap without a ContainerNode. Check "params.html".');
        }
        let vnode;
        while ((vnode = containerVNodes.shift())) {
            wrapNode.append(vnode);
        }
        params.container.append(wrapNode);
    }
    async replace(params) {
        const parsedNodes = await this._parseHTMLString(params.html);
        const firstNode = params.nodes[0];
        parsedNodes.forEach(firstNode.before.bind(firstNode));
        for (const node of params.nodes) {
            node.remove();
        }
    }
    async getRecordCover() {
        const layout = this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_6__["Layout"]);
        const domLayout = layout.engines.dom;
        const editableNode = domLayout.components.get('editable')[0];
        const covers = editableNode.descendants(node => {
            const attributes = node.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"]);
            if (attributes.length && typeof attributes.get('class') === 'string') {
                return attributes.classList.has('o_record_cover_container');
            }
        });
        const cover = covers && covers[0];
        if (cover)
            return domLayout.getDomNodes(cover)[0];
    }
    async getSelectedText(params) {
        const selectedNode = params.context.range.selectedNodes().map(node => node.clone());
        const container = new _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_5__["ContainerNode"]();
        container.append(...selectedNode);
        const renderer = this.editor.plugins.get(_plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_3__["Renderer"]);
        const renderedNode = await renderer.render(_plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_11__["HtmlDomRenderingEngine"].id, container);
        // todo: what if there is more rendered nodes?
        return renderedNode ? renderedNode[0].innerText : '';
    }
    async getSelectedLink(params) {
        const selectedNode = params.context.range.selectedNodes().map(node => node.clone());
        const nodeWithFormat = selectedNode.find(node => node instanceof _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_10__["InlineNode"] &&
            node.modifiers.find(modifier => modifier instanceof _plugin_link_src_LinkFormat__WEBPACK_IMPORTED_MODULE_12__["LinkFormat"]));
        const linkFormat = nodeWithFormat &&
            nodeWithFormat.modifiers.find(modifier => modifier instanceof _plugin_link_src_LinkFormat__WEBPACK_IMPORTED_MODULE_12__["LinkFormat"]);
        return linkFormat ? linkFormat.url : '';
    }
    getLinkInfo(params) {
        var _a, _b, _c, _d, _e;
        const targettedNodes = params.context.range.targetedNodes(_plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_14__["CharNode"]);
        const text = targettedNodes.map(x => x.char).join('');
        //
        const inline = this.editor.plugins.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_13__["Inline"]);
        const modifiers = inline.getCurrentModifiers(params.context.range);
        return {
            text: text,
            url: (_a = modifiers.get(_plugin_link_src_LinkFormat__WEBPACK_IMPORTED_MODULE_12__["LinkFormat"])) === null || _a === void 0 ? void 0 : _a.url,
            class: (_b = modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"])) === null || _b === void 0 ? void 0 : _b.get('class'),
            target: (_e = (_d = (_c = modifiers
                .get(_plugin_link_src_LinkFormat__WEBPACK_IMPORTED_MODULE_12__["LinkFormat"])) === null || _c === void 0 ? void 0 : _c.modifiers) === null || _d === void 0 ? void 0 : _d.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_0__["Attributes"])) === null || _e === void 0 ? void 0 : _e.get('target'),
        };
    }
    async _parseHTMLString(content) {
        const parser = this.editor.plugins.get(_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_2__["Parser"]);
        const domParser = parser && parser.engines.dom;
        if (!domParser) {
            // TODO: remove this when the editor can be instantiated on
            // something else than DOM.
            throw new Error(`No DOM parser installed.`);
        }
        const div = document.createElement('div');
        div.innerHTML = content;
        return (await domParser.parse(div))[0].children();
    }
    _getVNode(domNode) {
        const layout = this.editor.plugins.get(_plugin_layout_src_Layout__WEBPACK_IMPORTED_MODULE_6__["Layout"]);
        const domEngine = layout.engines.dom;
        return domEngine.getNodes(domNode)[0];
    }
}


/***/ }),

/***/ "./packages/plugin-odoo-snippets/src/OdooStructureNode.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-odoo-snippets/src/OdooStructureNode.ts ***!
  \****************************************************************/
/*! exports provided: OdooStructureNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooStructureNode", function() { return OdooStructureNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class OdooStructureNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor(params) {
        super(params);
        this.xpath = params.xpath;
        this.viewId = params.viewId;
    }
}


/***/ }),

/***/ "./packages/plugin-odoo-snippets/src/OdooStrucutreXmlDomParser.ts":
/*!************************************************************************!*\
  !*** ./packages/plugin-odoo-snippets/src/OdooStrucutreXmlDomParser.ts ***!
  \************************************************************************/
/*! exports provided: OdooStrucutreXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooStrucutreXmlDomParser", function() { return OdooStrucutreXmlDomParser; });
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _OdooStructureNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OdooStructureNode */ "./packages/plugin-odoo-snippets/src/OdooStructureNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class OdooStrucutreXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return (item instanceof Element &&
                item.classList.contains('oe_structure') &&
                item.attributes &&
                item.attributes['data-oe-xpath'] &&
                item.attributes['data-oe-id']);
        };
    }
    /**
     * Parse a bold node.
     *
     * @param item
     */
    async parse(item) {
        const element = new _OdooStructureNode__WEBPACK_IMPORTED_MODULE_2__["OdooStructureNode"]({
            htmlTag: Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item),
            xpath: item.attributes['data-oe-xpath'].value,
            viewId: item.attributes['data-oe-id'].value,
        });
        if (item instanceof Element) {
            element.modifiers.append(this.engine.parseAttributes(item));
        }
        const nodes = await this.engine.parse(...item.childNodes);
        element.append(...nodes);
        return [element];
    }
}
OdooStrucutreXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_0__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-odoo-snippets/src/SaveButton.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-odoo-snippets/src/SaveButton.ts ***!
  \*********************************************************/
/*! exports provided: SaveButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SaveButton", function() { return SaveButton; });
const SaveButton = {
    title: 'Save',
    commandId: 'saveOdoo',
    class: 'fa-save jw-primary-button',
};


/***/ }),

/***/ "./packages/plugin-owl/src/Owl.ts":
/*!****************************************!*\
  !*** ./packages/plugin-owl/src/Owl.ts ***!
  \****************************************/
/*! exports provided: Owl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Owl", function() { return Owl; });
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @odoo/owl */ "./node_modules/@odoo/owl/dist/owl.js");
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_odoo_owl__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ui_OwlHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui/OwlHtmlDomRenderer */ "./packages/plugin-owl/src/ui/OwlHtmlDomRenderer.ts");



// Temporary fix waiting for the `Env` interface of Owl to let the `browser`
// property be optional
const browser = {
    setTimeout: window.setTimeout.bind(window),
    clearTimeout: window.clearTimeout.bind(window),
    setInterval: window.setInterval.bind(window),
    clearInterval: window.clearInterval.bind(window),
    requestAnimationFrame: window.requestAnimationFrame.bind(window),
    random: Math.random,
    Date: window.Date,
    // eslint-disable-next-line @typescript-eslint/no-empty-function
    fetch: (window.fetch || (() => { })).bind(window),
    localStorage: window.localStorage,
};
class Owl extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_1__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            renderers: [_ui_OwlHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__["OwlHtmlDomRenderer"]],
        };
        this.loaders = {
            owlTemplates: this._loadTemplates,
        };
        this.env = {
            qweb: new _odoo_owl__WEBPACK_IMPORTED_MODULE_0__["QWeb"](),
            editor: this.editor,
            browser: browser,
        };
        this.components = new Map();
    }
    async stop() {
        for (const [, component] of this.components) {
            component.destroy();
        }
        this.components.clear();
    }
    _loadTemplates(templates) {
        for (const template of templates) {
            this.env.qweb.addTemplates(template);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-owl/src/ui/OwlComponent.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-owl/src/ui/OwlComponent.ts ***!
  \****************************************************/
/*! exports provided: OwlComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OwlComponent", function() { return OwlComponent; });
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @odoo/owl */ "./node_modules/@odoo/owl/dist/owl.js");
/* harmony import */ var _odoo_owl__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_odoo_owl__WEBPACK_IMPORTED_MODULE_0__);


class OwlComponent extends _odoo_owl__WEBPACK_IMPORTED_MODULE_0__["Component"] {
    constructor() {
        super(...arguments);
        this._storageKeyPrefix = 'OwlUI' + this.constructor.name + ':';
        // State items which names are listed in the localStorage property will be
        // read from the localStorage during the willStart of the component, and
        // wrote back to the localStorage whenever the state changes.
        this.localStorage = [];
    }
    /**
     * Owl hook called exactly once before the initial rendering.
     */
    willStart() {
        if (this.state) {
            this._importStateFromStorage(localStorage, this.localStorage);
            this.state = Object(_odoo_owl__WEBPACK_IMPORTED_MODULE_0__["useState"])(this.state);
        }
        return super.willStart();
    }
    /**
     * Called by the Owl state observer every time the state changes.
     *
     * @param force see Owl Component
     */
    render(force = false) {
        if (this.state) {
            this._exportStateToStorage(localStorage, this.localStorage);
        }
        return super.render(force);
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Read the given storable state items from the given `storage` and write
     * the items as the key of the `state` property.
     *
     * @param storage from which to read the state items
     * @param storableItems names of the state items to read from storage
     */
    _importStateFromStorage(storage, storableItems) {
        storableItems.forEach(itemName => {
            const storageKey = this._storageKeyPrefix + itemName;
            const value = storage.getItem(storageKey);
            // The value of items that were not yet set in storage is null.
            if (value !== null) {
                // Otherwise, the value was stored as a string in the storage.
                // Convert it to the type of the default value for the state.
                try {
                    this.state[itemName] = JSON.parse(value);
                }
                catch (e) {
                    // Stored item is not parseable. Keep the default value.
                    console.warn(`Storage: Ignoring state.${itemName} stored value.\n` +
                        `${e.name}: ${e.message}\n` +
                        `Stored value: ${value}`);
                }
            }
        });
    }
    /**
     * For every key in the property `state`, write it back to `storage`
     * Write the given storable state items to the given storage.
     *
     * @param storage to write the state items to
     * @param storableItems names of the state items to write to storage
     */
    _exportStateToStorage(storage, storableItems) {
        storableItems.forEach(itemName => {
            const storageKey = this._storageKeyPrefix + itemName;
            // Storage require items to be stored as strings.
            try {
                const serializedValue = JSON.stringify(this.state[itemName]);
                storage.setItem(storageKey, serializedValue);
            }
            catch (e) {
                // State item is not serializable. Skip storing it.
                console.warn(`Storage: Unserializable state.${itemName} value.\n` +
                    `${e.name}: ${e.message}`);
            }
        });
    }
}


/***/ }),

/***/ "./packages/plugin-owl/src/ui/OwlHtmlDomRenderer.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-owl/src/ui/OwlHtmlDomRenderer.ts ***!
  \**********************************************************/
/*! exports provided: OwlHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OwlHtmlDomRenderer", function() { return OwlHtmlDomRenderer; });
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _OwlNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OwlNode */ "./packages/plugin-owl/src/ui/OwlNode.ts");
/* harmony import */ var _Owl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../Owl */ "./packages/plugin-owl/src/Owl.ts");




class OwlHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_1__["AbstractRenderer"] {
    constructor(engine, superRenderer) {
        super(engine, superRenderer);
        this.predicate = _OwlNode__WEBPACK_IMPORTED_MODULE_2__["OwlNode"];
        this.env = this.engine.editor.plugins.get(_Owl__WEBPACK_IMPORTED_MODULE_3__["Owl"]).env;
    }
    async render(node) {
        const components = this.engine.editor.plugins.get(_Owl__WEBPACK_IMPORTED_MODULE_3__["Owl"]).components;
        if (components.get(node)) {
            components.get(node).destroy();
        }
        const placeholder = document.createElement('jw-placeholer');
        document.body.appendChild(placeholder);
        node.Component.env = this.env;
        const component = new node.Component(null, node.props);
        components.set(node, component);
        await component.mount(placeholder);
        placeholder.remove();
        return [...placeholder.childNodes];
    }
}
OwlHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_0__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-owl/src/ui/OwlNode.ts":
/*!***********************************************!*\
  !*** ./packages/plugin-owl/src/ui/OwlNode.ts ***!
  \***********************************************/
/*! exports provided: OwlNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OwlNode", function() { return OwlNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class OwlNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor(Component, props) {
        super();
        this.Component = Component;
        this.props = props;
    }
    get name() {
        return super.name + ': ' + this.Component.name;
    }
}


/***/ }),

/***/ "./packages/plugin-paragraph/src/Paragraph.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-paragraph/src/Paragraph.ts ***!
  \****************************************************/
/*! exports provided: Paragraph */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Paragraph", function() { return Paragraph; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _ParagraphXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ParagraphXmlDomParser */ "./packages/plugin-paragraph/src/ParagraphXmlDomParser.ts");


class Paragraph extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_ParagraphXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["ParagraphXmlDomParser"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-paragraph/src/ParagraphNode.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-paragraph/src/ParagraphNode.ts ***!
  \********************************************************/
/*! exports provided: ParagraphNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ParagraphNode", function() { return ParagraphNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");

class ParagraphNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor() {
        super({ htmlTag: 'P' });
    }
}


/***/ }),

/***/ "./packages/plugin-paragraph/src/ParagraphXmlDomParser.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-paragraph/src/ParagraphXmlDomParser.ts ***!
  \****************************************************************/
/*! exports provided: ParagraphXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ParagraphXmlDomParser", function() { return ParagraphXmlDomParser; });
/* harmony import */ var _ParagraphNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ParagraphNode */ "./packages/plugin-paragraph/src/ParagraphNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class ParagraphXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'P';
        };
    }
    async parse(item) {
        const paragraph = new _ParagraphNode__WEBPACK_IMPORTED_MODULE_0__["ParagraphNode"]();
        paragraph.modifiers.append(this.engine.parseAttributes(item));
        const nodes = await this.engine.parse(...item.childNodes);
        paragraph.append(...nodes);
        return [paragraph];
    }
}
ParagraphXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-parser/src/AbstractParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-parser/src/AbstractParser.ts ***!
  \******************************************************/
/*! exports provided: AbstractParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbstractParser", function() { return AbstractParser; });
class AbstractParser {
    constructor(engine) {
        this.engine = engine;
    }
}


/***/ }),

/***/ "./packages/plugin-parser/src/Parser.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-parser/src/Parser.ts ***!
  \**********************************************/
/*! exports provided: Parser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Parser", function() { return Parser; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");

class Parser extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.engines = {};
        this.loaders = {
            parsingEngines: this.loadParsingEngines,
            parsers: this.loadParsers,
        };
    }
    async parse(engineId, ...items) {
        return this.engines[engineId].parse(...items);
    }
    loadParsingEngines(parsingEngines) {
        for (const EngineClass of parsingEngines) {
            const id = EngineClass.id;
            if (this.engines[id]) {
                throw new Error(`Rendering engine ${id} already registered.`);
            }
            const engine = new EngineClass(this.editor);
            this.engines[id] = engine;
        }
    }
    loadParsers(parsers) {
        parsers = [...parsers].reverse();
        for (const ParserClass of parsers) {
            for (const id in this.engines) {
                const parsingEngine = this.engines[id];
                const supportedTypes = [id, ...parsingEngine.constructor.extends];
                if (supportedTypes.includes(ParserClass.id)) {
                    parsingEngine.register(ParserClass);
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-parser/src/ParsingEngine.ts":
/*!*****************************************************!*\
  !*** ./packages/plugin-parser/src/ParsingEngine.ts ***!
  \*****************************************************/
/*! exports provided: ParsingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ParsingEngine", function() { return ParsingEngine; });
class ParsingEngine {
    constructor(editor) {
        this.parsers = [];
        this.parsingMap = new Map();
        this.editor = editor;
        const defaultParser = new this.constructor.defaultParser(this);
        if (defaultParser.predicate) {
            throw new Error(`Default renderer cannot have a predicate.`);
        }
        else {
            this.parsers.push(defaultParser);
        }
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Register the given parser by instantiating it with this parser engine.
     *
     * @param ParserClass
     */
    register(ParserClass) {
        if (ParserClass.id === this.constructor.id) {
            this.parsers.unshift(new ParserClass(this));
        }
        else {
            const supportedTypes = [this.constructor.id, ...this.constructor.extends];
            const priorParserIds = supportedTypes.slice(0, supportedTypes.indexOf(ParserClass.id));
            const postParserIndex = this.parsers.findIndex(parser => !priorParserIds.includes(parser.constructor.id));
            this.parsers.splice(postParserIndex, 0, new ParserClass(this));
        }
    }
    /**
     * Parse items into the editor's virtual `VNode` representation.
     *
     * @param items the items to parse
     * @returns Promise resolved by the element parsed into the editor virtual
     * VNode representation
     */
    async parse(...items) {
        const nodes = [];
        const childPromises = items.map(node => this._parseItem(node));
        const resList = await Promise.all(childPromises);
        for (const res of resList) {
            nodes.push(...res);
        }
        return nodes;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Parse an item into the editor's virtual representation.
     *
     */
    async _parseItem(item) {
        let nodes;
        for (const parser of this.parsers) {
            if (!parser.predicate || parser.predicate(item)) {
                nodes = await parser.parse(item);
                break;
            }
        }
        if (nodes.length >= 1) {
            this.parsingMap.set(item, nodes);
        }
        return nodes;
    }
}
ParsingEngine.extends = [];


/***/ }),

/***/ "./packages/plugin-pre/src/Pre.ts":
/*!****************************************!*\
  !*** ./packages/plugin-pre/src/Pre.ts ***!
  \****************************************/
/*! exports provided: Pre */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Pre", function() { return Pre; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _PreXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./PreXmlDomParser */ "./packages/plugin-pre/src/PreXmlDomParser.ts");
/* harmony import */ var _PreHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PreHtmlDomRenderer */ "./packages/plugin-pre/src/PreHtmlDomRenderer.ts");
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");
/* harmony import */ var _PreCharHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./PreCharHtmlDomRenderer */ "./packages/plugin-pre/src/PreCharHtmlDomRenderer.ts");
/* harmony import */ var _PreSeparatorHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./PreSeparatorHtmlDomRenderer */ "./packages/plugin-pre/src/PreSeparatorHtmlDomRenderer.ts");







class Pre extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.commands = {
            applyPreStyle: {
                handler: this.applyPreStyle,
            },
        };
        this.loadables = {
            parsers: [_PreXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["PreXmlDomParser"]],
            renderers: [_PreHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__["PreHtmlDomRenderer"], _PreSeparatorHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_6__["PreSeparatorHtmlDomRenderer"], _PreCharHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_5__["PreCharHtmlDomRenderer"]],
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Change the formatting of the nodes in given range to Pre.
     *
     * @param params
     */
    applyPreStyle(params) {
        for (const node of params.context.range.targetedNodes(_core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_4__["ContainerNode"])) {
            const pre = new _PreNode__WEBPACK_IMPORTED_MODULE_3__["PreNode"]();
            pre.modifiers = node.modifiers.clone();
            node.replaceWith(pre);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-pre/src/PreButtons.ts":
/*!***********************************************!*\
  !*** ./packages/plugin-pre/src/PreButtons.ts ***!
  \***********************************************/
/*! exports provided: PreButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreButton", function() { return PreButton; });
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");

const PreButton = {
    title: 'Pre',
    commandId: 'applyPreStyle',
    selected: (editor) => {
        return editor.selection.range.targetedNodes().every(node => {
            return node.closest(_PreNode__WEBPACK_IMPORTED_MODULE_0__["PreNode"]);
        });
    },
};


/***/ }),

/***/ "./packages/plugin-pre/src/PreCharHtmlDomRenderer.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-pre/src/PreCharHtmlDomRenderer.ts ***!
  \***********************************************************/
/*! exports provided: PreCharHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreCharHtmlDomRenderer", function() { return PreCharHtmlDomRenderer; });
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");
/* harmony import */ var _plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-char/src/CharNode */ "./packages/plugin-char/src/CharNode.ts");
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");




class PreCharHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_2__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => item.is(_plugin_char_src_CharNode__WEBPACK_IMPORTED_MODULE_1__["CharNode"]) && !!item.ancestor(_PreNode__WEBPACK_IMPORTED_MODULE_0__["PreNode"]);
    }
    /**
     * Render the VNode to the given format.
     */
    async render(node) {
        const rendering = await this.super.render(node);
        rendering[0].textContent = rendering[0].textContent.replace(/\u00A0/g, ' ');
        return rendering;
    }
}
PreCharHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_3__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-pre/src/PreHtmlDomRenderer.ts":
/*!*******************************************************!*\
  !*** ./packages/plugin-pre/src/PreHtmlDomRenderer.ts ***!
  \*******************************************************/
/*! exports provided: PreHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreHtmlDomRenderer", function() { return PreHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class PreHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _PreNode__WEBPACK_IMPORTED_MODULE_2__["PreNode"];
    }
    /**
     * Render the VNode to the given format.
     */
    async render(node) {
        const pre = document.createElement('pre');
        this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], node, pre);
        const renderedChildren = await this.renderChildren(node);
        pre.append(...renderedChildren.flat());
        return [pre];
    }
}
PreHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_1__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-pre/src/PreNode.ts":
/*!********************************************!*\
  !*** ./packages/plugin-pre/src/PreNode.ts ***!
  \********************************************/
/*! exports provided: PreNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreNode", function() { return PreNode; });
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");

class PreNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_0__["ContainerNode"] {
}


/***/ }),

/***/ "./packages/plugin-pre/src/PreSeparatorHtmlDomRenderer.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-pre/src/PreSeparatorHtmlDomRenderer.ts ***!
  \****************************************************************/
/*! exports provided: PreSeparatorHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreSeparatorHtmlDomRenderer", function() { return PreSeparatorHtmlDomRenderer; });
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");



class PreSeparatorHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_1__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            const DefaultSeparator = this.engine.editor.configuration.defaults.Separator;
            return item.is(DefaultSeparator) && !!item.ancestor(_PreNode__WEBPACK_IMPORTED_MODULE_0__["PreNode"]);
        };
    }
    /**
     * Render the VNode.
     */
    async render(node) {
        const separators = await this.super.render(node);
        const rendering = separators.map(() => document.createTextNode('\n'));
        return this.engine.rendered([node], [this, Promise.resolve(rendering)]);
    }
}
PreSeparatorHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-pre/src/PreXmlDomParser.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-pre/src/PreXmlDomParser.ts ***!
  \****************************************************/
/*! exports provided: PreXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "PreXmlDomParser", function() { return PreXmlDomParser; });
/* harmony import */ var _PreNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PreNode */ "./packages/plugin-pre/src/PreNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class PreXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'PRE';
        };
    }
    async parse(item) {
        const pre = new _PreNode__WEBPACK_IMPORTED_MODULE_0__["PreNode"]();
        pre.modifiers.append(this.engine.parseAttributes(item));
        const children = await this.engine.parse(...item.childNodes);
        pre.append(...children);
        return [pre];
    }
}
PreXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-renderer/src/AbstractRenderer.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-renderer/src/AbstractRenderer.ts ***!
  \**********************************************************/
/*! exports provided: AbstractRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AbstractRenderer", function() { return AbstractRenderer; });
class AbstractRenderer {
    constructor(engine, superRenderer) {
        this._renderChildMutex = new Map();
        this.engine = engine;
        this.super = superRenderer;
    }
    /**
     * Render the given child node. This function ensures that the promise
     * corresponding to the rendering of each child of the same parent will be
     * resolved in the order in which `renderChild` was called.
     *
     * @param child
     */
    async renderChild(child) {
        const parent = child.parent;
        await this._renderChildMutex.get(parent);
        const renderedChild = this.engine.render(child);
        this._renderChildMutex.set(parent, renderedChild);
        return renderedChild;
    }
    /**
     * Render the children of given node. Return a promise resolved with the
     * result of the rendering of each child concatenated into a single array
     * conserving the order of the children.
     *
     * @param node
     */
    async renderChildren(node) {
        const renderedChildren = [];
        if (node.hasChildren()) {
            for (const child of node.childVNodes) {
                renderedChildren.push(this.engine.render(child));
            }
        }
        else if (this.engine.renderEmpty) {
            renderedChildren.push(this.engine.renderEmpty(node));
        }
        return Promise.all(renderedChildren);
    }
}


/***/ }),

/***/ "./packages/plugin-renderer/src/Renderer.ts":
/*!**************************************************!*\
  !*** ./packages/plugin-renderer/src/Renderer.ts ***!
  \**************************************************/
/*! exports provided: Renderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Renderer", function() { return Renderer; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");

class Renderer extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loaders = {
            renderingEngines: this.loadRenderingEngines,
            renderers: this.loadRenderers,
        };
        this.engines = {};
    }
    async render(renderingId, node) {
        const engine = this.engines[renderingId];
        if (!engine) {
            // The caller might want to fallback on another rendering.
            return;
        }
        engine.renderings.clear();
        return engine.render(node);
    }
    loadRenderingEngines(renderingEngines) {
        for (const EngineClass of renderingEngines) {
            const id = EngineClass.id;
            if (this.engines[id]) {
                throw new Error(`Rendering engine ${id} already registered.`);
            }
            const engine = new EngineClass(this.editor);
            this.engines[id] = engine;
        }
    }
    loadRenderers(renderers) {
        renderers = [...renderers].reverse();
        for (const RendererClass of renderers) {
            const renderingEngine = this.engines[RendererClass.id];
            if (renderingEngine) {
                renderingEngine.register(RendererClass);
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-renderer/src/RenderingEngine.ts":
/*!*********************************************************!*\
  !*** ./packages/plugin-renderer/src/RenderingEngine.ts ***!
  \*********************************************************/
/*! exports provided: RenderingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "RenderingEngine", function() { return RenderingEngine; });
class RenderingEngine {
    constructor(editor) {
        this.renderers = [];
        this.renderings = new Map();
        this.editor = editor;
        const defaultRenderer = new this.constructor.defaultRenderer(this);
        if (defaultRenderer.predicate) {
            throw `Default renderer cannot have a predicate.`;
        }
        else {
            this.renderers.push(defaultRenderer);
        }
    }
    /**
     * Register the given renderer by instantiating it with this rendering
     * engine. The renderer constructor will receive a special second parameter
     * which is a magic renderer whose `render` method will call the next
     * compatible renderer in line for the given node.
     *
     * @param RendererClass
     */
    register(RendererClass) {
        const superRenderer = {
            render: this._render.bind(this),
        };
        const renderer = new RendererClass(this, superRenderer);
        this.renderers.unshift(renderer);
    }
    /**
     * Render the given node. If a prior rendering already exists for this node
     * in this run, return it directly.
     *
     * @param node
     */
    async render(node) {
        const renderings = this.renderings.get(node);
        if (renderings && renderings.length) {
            return renderings[0][1];
        }
        else {
            return this._render(node);
        }
    }
    /**
     * Return the rendering of several nodes, so as to skip rendering them again
     * later in the process.
     *
     * @param nodes
     * @param rendering
     */
    async rendered(nodes, rendering) {
        for (const node of nodes) {
            const renderings = this.renderings.get(node) || [];
            renderings.push(rendering);
        }
        return rendering[1];
    }
    /**
     * Trigger the rendering of the given node by the next compatible renderer
     * that has not yet produced a rendering for this run.
     *
     * @param node
     */
    async _render(node) {
        const renderings = this.renderings.get(node) || [];
        // TODO: test all renders with predicates before no predicates
        const lastRendering = renderings[renderings.length - 1];
        const lastRenderer = lastRendering && lastRendering[0];
        let nextRendererIndex = this.renderers.indexOf(lastRenderer) + 1;
        let nextRenderer;
        do {
            nextRenderer = this.renderers[nextRendererIndex];
            nextRendererIndex++;
        } while (nextRenderer && !node.test(nextRenderer.predicate));
        if (!nextRenderer)
            return;
        // This promise will be returned synchronously and will be resolved
        // later with the same return value as the asynchronous render call.
        const rendererProm = new Promise((resolve) => {
            Promise.resolve().then(() => {
                nextRenderer.render(node).then(resolve);
            });
        });
        renderings.push([nextRenderer, rendererProm]);
        this.renderings.set(node, renderings);
        return rendererProm;
    }
}


/***/ }),

/***/ "./packages/plugin-span/src/Span.ts":
/*!******************************************!*\
  !*** ./packages/plugin-span/src/Span.ts ***!
  \******************************************/
/*! exports provided: Span */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Span", function() { return Span; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _SpanXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SpanXmlDomParser */ "./packages/plugin-span/src/SpanXmlDomParser.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");



class Span extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_SpanXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["SpanXmlDomParser"]],
        };
    }
}
Span.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-span/src/SpanFormat.ts":
/*!************************************************!*\
  !*** ./packages/plugin-span/src/SpanFormat.ts ***!
  \************************************************/
/*! exports provided: SpanFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SpanFormat", function() { return SpanFormat; });
/* harmony import */ var _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/Format */ "./packages/plugin-inline/src/Format.ts");

class SpanFormat extends _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor(htmlTag = 'SPAN') {
        super(htmlTag);
    }
}


/***/ }),

/***/ "./packages/plugin-span/src/SpanXmlDomParser.ts":
/*!******************************************************!*\
  !*** ./packages/plugin-span/src/SpanXmlDomParser.ts ***!
  \******************************************************/
/*! exports provided: SpanXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SpanXmlDomParser", function() { return SpanXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatParser */ "./packages/plugin-inline/src/FormatParser.ts");
/* harmony import */ var _SpanFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SpanFormat */ "./packages/plugin-span/src/SpanFormat.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class SpanXmlDomParser extends _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__["FormatParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'SPAN' || Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'FONT');
        };
    }
    /**
     * Parse a span node.
     *
     * @param item
     */
    async parse(item) {
        const span = new _SpanFormat__WEBPACK_IMPORTED_MODULE_1__["SpanFormat"](Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item));
        span.modifiers.append(this.engine.parseAttributes(item));
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(span, children);
        return children;
    }
}
SpanXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-subscript/src/Subscript.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-subscript/src/Subscript.ts ***!
  \****************************************************/
/*! exports provided: Subscript */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Subscript", function() { return Subscript; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _SubscriptXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SubscriptXmlDomParser */ "./packages/plugin-subscript/src/SubscriptXmlDomParser.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");



class Subscript extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_SubscriptXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["SubscriptXmlDomParser"]],
        };
    }
}
Subscript.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-subscript/src/SubscriptFormat.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-subscript/src/SubscriptFormat.ts ***!
  \**********************************************************/
/*! exports provided: SubscriptFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SubscriptFormat", function() { return SubscriptFormat; });
/* harmony import */ var _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/Format */ "./packages/plugin-inline/src/Format.ts");

class SubscriptFormat extends _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor() {
        super('SUB');
    }
}


/***/ }),

/***/ "./packages/plugin-subscript/src/SubscriptXmlDomParser.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-subscript/src/SubscriptXmlDomParser.ts ***!
  \****************************************************************/
/*! exports provided: SubscriptXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SubscriptXmlDomParser", function() { return SubscriptXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatParser */ "./packages/plugin-inline/src/FormatParser.ts");
/* harmony import */ var _SubscriptFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SubscriptFormat */ "./packages/plugin-subscript/src/SubscriptFormat.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class SubscriptXmlDomParser extends _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__["FormatParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'SUB';
        };
    }
    /**
     * Parse a span node.
     *
     * @param item
     */
    async parse(item) {
        const subscript = new _SubscriptFormat__WEBPACK_IMPORTED_MODULE_1__["SubscriptFormat"]();
        subscript.modifiers.append(this.engine.parseAttributes(item));
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(subscript, children);
        return children;
    }
}
SubscriptXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-superscript/src/Superscript.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-superscript/src/Superscript.ts ***!
  \********************************************************/
/*! exports provided: Superscript */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Superscript", function() { return Superscript; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _SuperscriptXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SuperscriptXmlDomParser */ "./packages/plugin-superscript/src/SuperscriptXmlDomParser.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");



class Superscript extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_SuperscriptXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["SuperscriptXmlDomParser"]],
        };
    }
}
Superscript.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-superscript/src/SuperscriptFormat.ts":
/*!**************************************************************!*\
  !*** ./packages/plugin-superscript/src/SuperscriptFormat.ts ***!
  \**************************************************************/
/*! exports provided: SuperscriptFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SuperscriptFormat", function() { return SuperscriptFormat; });
/* harmony import */ var _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/Format */ "./packages/plugin-inline/src/Format.ts");

class SuperscriptFormat extends _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor() {
        super('SUP');
    }
}


/***/ }),

/***/ "./packages/plugin-superscript/src/SuperscriptXmlDomParser.ts":
/*!********************************************************************!*\
  !*** ./packages/plugin-superscript/src/SuperscriptXmlDomParser.ts ***!
  \********************************************************************/
/*! exports provided: SuperscriptXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SuperscriptXmlDomParser", function() { return SuperscriptXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatParser */ "./packages/plugin-inline/src/FormatParser.ts");
/* harmony import */ var _SuperscriptFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SuperscriptFormat */ "./packages/plugin-superscript/src/SuperscriptFormat.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class SuperscriptXmlDomParser extends _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__["FormatParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'SUP';
        };
    }
    /**
     * Parse a span node.
     *
     * @param item
     */
    async parse(item) {
        const superscript = new _SuperscriptFormat__WEBPACK_IMPORTED_MODULE_1__["SuperscriptFormat"]();
        superscript.modifiers.append(this.engine.parseAttributes(item));
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(superscript, children);
        return children;
    }
}
SuperscriptXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/Table.ts":
/*!********************************************!*\
  !*** ./packages/plugin-table/src/Table.ts ***!
  \********************************************/
/*! exports provided: Table */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Table", function() { return Table; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _TableXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableXmlDomParser */ "./packages/plugin-table/src/TableXmlDomParser.ts");
/* harmony import */ var _TableRowXmlDomParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableRowXmlDomParser */ "./packages/plugin-table/src/TableRowXmlDomParser.ts");
/* harmony import */ var _TableCellXmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TableCellXmlDomParser */ "./packages/plugin-table/src/TableCellXmlDomParser.ts");
/* harmony import */ var _TableHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TableHtmlDomRenderer */ "./packages/plugin-table/src/TableHtmlDomRenderer.ts");
/* harmony import */ var _TableRowHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TableRowHtmlDomRenderer */ "./packages/plugin-table/src/TableRowHtmlDomRenderer.ts");
/* harmony import */ var _TableCellHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./TableCellHtmlDomRenderer */ "./packages/plugin-table/src/TableCellHtmlDomRenderer.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../core/src/VNodes/VNode */ "./packages/core/src/VNodes/VNode.ts");












class Table extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_TableXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["TableXmlDomParser"], _TableRowXmlDomParser__WEBPACK_IMPORTED_MODULE_2__["TableRowXmlDomParser"], _TableCellXmlDomParser__WEBPACK_IMPORTED_MODULE_3__["TableCellXmlDomParser"]],
            renderers: [_TableHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_4__["TableHtmlDomRenderer"], _TableRowHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_5__["TableRowHtmlDomRenderer"], _TableCellHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_6__["TableCellHtmlDomRenderer"]],
            shortcuts: [
                {
                    pattern: 'CTRL+<Slash>',
                    commandId: 'addRowBelow',
                },
                {
                    pattern: 'CTRL+SHIFT+<Slash>',
                    commandId: 'addRowAbove',
                },
                {
                    pattern: 'CTRL+<Equal>',
                    commandId: 'addColumnAfter',
                },
                {
                    pattern: 'CTRL+SHIFT+<Equal>',
                    commandId: 'addColumnBefore',
                },
                {
                    pattern: 'CTRL+SHIFT+DELETE',
                    commandId: 'deleteRow',
                },
                {
                    pattern: 'CTRL+SHIFT+BACKSPACE',
                    commandId: 'deleteColumn',
                },
                {
                    pattern: 'CTRL+ALT+SHIFT+DELETE',
                    commandId: 'deleteTable',
                },
                {
                    pattern: 'CTRL+<Period>',
                    commandId: 'mergeCells',
                },
                {
                    pattern: 'CTRL+SHIFT+<Period>',
                    commandId: 'unmergeCells',
                },
            ],
        };
        this.commands = {
            addRowAbove: {
                handler: this.addRowAbove.bind(this),
            },
            addRowBelow: {
                handler: this.addRowBelow.bind(this),
            },
            addColumnBefore: {
                handler: this.addColumnBefore.bind(this),
            },
            addColumnAfter: {
                handler: this.addColumnAfter.bind(this),
            },
            deleteRow: {
                handler: this.deleteRow.bind(this),
            },
            deleteColumn: {
                handler: this.deleteColumn.bind(this),
            },
            deleteTable: {
                handler: this.deleteTable.bind(this),
            },
            mergeCells: {
                handler: this.mergeCells.bind(this),
            },
            unmergeCells: {
                handler: this.unmergeCells.bind(this),
            },
        };
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Add a row above the cell at given range start.
     *
     * @param params
     */
    addRowAbove(params) {
        const range = params.context.range;
        const cell = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]);
        if (!cell)
            return;
        cell.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_8__["TableNode"]).addRowAbove(cell);
    }
    /**
     * Add a row below the cell at given range start.
     *
     * @param params
     */
    addRowBelow(params) {
        const range = params.context.range;
        const row = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]);
        if (!row)
            return;
        row.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_8__["TableNode"]).addRowBelow(row);
    }
    /**
     * Add a column before the cell at given range start.
     *
     * @param params
     */
    addColumnBefore(params) {
        const range = params.context.range;
        const cell = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]);
        if (!cell)
            return;
        cell.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_8__["TableNode"]).addColumnBefore(cell);
    }
    /**
     * Add a column after the cell at given range start.
     *
     * @param params
     */
    addColumnAfter(params) {
        const range = params.context.range;
        const cell = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]);
        if (!cell)
            return;
        cell.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_8__["TableNode"]).addColumnAfter(cell);
    }
    /**
     * Delete the row at given range start.
     *
     * @param params
     */
    deleteRow(params) {
        const range = params.context.range;
        const cell = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]);
        if (!cell)
            return;
        const row = cell.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_10__["TableRowNode"]);
        const nextRow = row.nextSibling(_TableRowNode__WEBPACK_IMPORTED_MODULE_10__["TableRowNode"]) || row.previousSibling(_TableRowNode__WEBPACK_IMPORTED_MODULE_10__["TableRowNode"]);
        const nextCell = nextRow && nextRow.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"])[cell.columnIndex];
        if (nextCell) {
            const nextRowIndex = nextCell.rowIndex;
            // Handle rowspans.
            const cells = row.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]);
            for (const cell of cells) {
                if (cell.rowspan > 1) {
                    // Cells managed by this cell will now be managed by the
                    // cell below (or above if there is none below) instead.
                    const belowCell = Array.from(cell.managedCells).find(managedCell => managedCell.rowIndex === nextRowIndex);
                    if (belowCell) {
                        belowCell.unmerge();
                        for (const managedCell of cell.managedCells) {
                            if (managedCell !== belowCell) {
                                managedCell.mergeWith(belowCell);
                            }
                        }
                    }
                }
                else if (!cell.isActive()) {
                    // If this cell is inactive, unmerge it so its manager
                    // doesn't believe it still manages it.
                    cell.unmerge();
                }
            }
            // Remove the row.
            row.remove();
            // The place where the range used to live was just demolished. Give
            // it shelter within the next active cell.
            const nextActiveCell = nextCell.managerCell || nextCell;
            range.setStart(nextActiveCell.firstLeaf(), _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_11__["RelativePosition"].BEFORE);
            range.collapse();
        }
        else {
            // If there is no `nextCell`, we're trying to delete the only row in
            // this table so just remove the table.
            this.deleteTable(params);
        }
    }
    /**
     * Delete the column at given range start.
     *
     * @param params
     */
    deleteColumn(params) {
        const range = params.context.range;
        const cell = range.start.ancestor(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]);
        if (!cell)
            return;
        const column = cell.column;
        const nextCell = cell.nextSibling(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]) || cell.previousSibling(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]);
        if (nextCell) {
            const nextColumnIndex = nextCell.columnIndex;
            // Handle colspans and cell removal.
            for (const cell of column) {
                if (cell.colspan > 1) {
                    // Cells managed by this cell will now be managed by the
                    // cell after (or before if there is none after) instead.
                    const afterCell = Array.from(cell.managedCells).find(managedCell => managedCell.columnIndex === nextColumnIndex);
                    if (afterCell) {
                        afterCell.unmerge();
                        for (const managedCell of cell.managedCells) {
                            if (managedCell !== afterCell) {
                                managedCell.mergeWith(afterCell);
                            }
                        }
                    }
                }
                else if (!cell.isActive()) {
                    // If this cell is inactive, unmerge it so its manager
                    // doesn't believe it still manages it.
                    cell.unmerge();
                }
                // Remove the cell.
                cell.remove();
                // The place where the range used to live was just demolished.
                // Give it shelter within the next active cell.
                const nextManagerCell = nextCell.managerCell || nextCell;
                range.setStart(nextManagerCell.firstLeaf(), _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_11__["RelativePosition"].BEFORE);
                range.collapse();
            }
        }
        else {
            // If there is no `nextCell`, we're trying to delete the only column
            // in this table so just remove the table.
            this.deleteTable(params);
        }
    }
    /**
     * Delete the table at given range start.
     *
     * @param params
     */
    deleteTable(params) {
        const range = params.context.range;
        const table = range.start.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_8__["TableNode"]);
        if (!table)
            return;
        const nextSibling = table.nextSibling();
        const previousSibling = table.previousSibling();
        if (nextSibling) {
            range.setStart(nextSibling.firstLeaf(), _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_11__["RelativePosition"].BEFORE);
            range.collapse();
        }
        else if (previousSibling) {
            range.setStart(previousSibling.lastLeaf(), _core_src_VNodes_VNode__WEBPACK_IMPORTED_MODULE_11__["RelativePosition"].AFTER);
            range.collapse();
        }
        table.remove();
    }
    /**
     * Merge the cells at given range into the first cell at given range.
     *
     * @param params
     */
    mergeCells(params) {
        const range = params.context.range;
        const cells = range.targetedNodes(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]);
        if (this._isRectangle(cells)) {
            // Only merge the cells if they would not imply to merge
            // unrelated cells, ie. the selected cells form a rectangle.
            const managerCell = cells.shift();
            const Separator = this.editor.configuration.defaults.Separator;
            for (const cell of cells) {
                if (managerCell.hasChildren()) {
                    managerCell.append(new Separator());
                }
                cell.mergeWith(managerCell);
            }
        }
    }
    /**
     * Unmerge previously merged cells at given range.
     *
     * @param params
     */
    unmergeCells(params) {
        const range = params.context.range;
        const cells = range.targetedNodes(_TableCellNode__WEBPACK_IMPORTED_MODULE_7__["TableCellNode"]);
        for (const cell of cells) {
            for (const managedCell of cell.managedCells) {
                managedCell.unmerge();
            }
        }
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return true if the given array of cells forms a rectangle in the table
     * grid.
     *
     * @param cells
     */
    _isRectangle(cells) {
        cells = [...cells];
        // Add managed cells to the list.
        for (const cell of [...cells]) {
            if (cell.managedCells.size) {
                cells.push(...cell.managedCells);
            }
        }
        cells = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_9__["distinct"])(cells);
        // Compute the row/column index extrema.
        const rowIndices = cells.map(cell => cell.rowIndex);
        const columnIndices = cells.map(cell => cell.columnIndex);
        const minRowIndex = Math.min(...rowIndices);
        const minColumnIndex = Math.min(...columnIndices);
        const maxRowIndex = Math.max(...rowIndices);
        const maxColumnIndex = Math.max(...columnIndices);
        // If a cell between the extrema cannot be found in the list, the
        // selected cells do not form a rectangle.
        for (let rowIndex = minRowIndex; rowIndex <= maxRowIndex; rowIndex++) {
            for (let columnIndex = minColumnIndex; columnIndex <= maxColumnIndex; columnIndex++) {
                const cell = cells.find(cell => {
                    return cell.rowIndex === rowIndex && cell.columnIndex === columnIndex;
                });
                if (!cell) {
                    return false;
                }
            }
        }
        return true;
    }
}


/***/ }),

/***/ "./packages/plugin-table/src/TableCellHtmlDomRenderer.ts":
/*!***************************************************************!*\
  !*** ./packages/plugin-table/src/TableCellHtmlDomRenderer.ts ***!
  \***************************************************************/
/*! exports provided: TableCellHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableCellHtmlDomRenderer", function() { return TableCellHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class TableCellHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _TableCellNode__WEBPACK_IMPORTED_MODULE_1__["TableCellNode"];
    }
    /**
     * Render the TableCellNode along with its contents.
     *
     * @param cell
     */
    async render(cell) {
        // If the cell is not active, do not render it (it means it is
        // represented by its manager cell's colspan or rowspan: it was merged).
        if (!cell.isActive())
            return [];
        // Render the cell and its contents.
        const td = document.createElement(cell.header ? 'th' : 'td');
        const renderedChildren = await this.renderChildren(cell);
        td.append(...renderedChildren.flat());
        // Render attributes.
        // Colspan and rowspan are handled differently from other attributes:
        // they are automatically calculated in function of the cell's managed
        // cells. Render them here. If their value is 1 or less, they are
        // insignificant so no need to render them.
        if (cell.colspan > 1) {
            cell.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]).set('colspan', '' + cell.colspan);
        }
        if (cell.rowspan > 1) {
            cell.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]).set('rowspan', '' + cell.rowspan);
        }
        this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], cell, td);
        cell.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]).remove('colspan');
        cell.modifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"]).remove('rowspan');
        return [td];
    }
}
TableCellHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableCellNode.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-table/src/TableCellNode.ts ***!
  \****************************************************/
/*! exports provided: TableCellNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableCellNode", function() { return TableCellNode; });
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/src/VNodes/ContainerNode */ "./packages/core/src/VNodes/ContainerNode.ts");



class TableCellNode extends _core_src_VNodes_ContainerNode__WEBPACK_IMPORTED_MODULE_2__["ContainerNode"] {
    constructor(params) {
        super();
        this.breakable = false;
        this.__managedCells = new Set();
        this.header = (params === null || params === void 0 ? void 0 : params.header) || false;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     *
     *  @override
     */
    clone(deepClone, params) {
        const defaults = {
            header: this.header,
        };
        return super.clone(deepClone, { ...defaults, ...params });
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * @override
     */
    get name() {
        let coordinatesRepr = ' <(' + this.rowIndex + ', ' + this.columnIndex + ')';
        if (this.colspan > 1 || this.rowspan > 1) {
            const endRow = this.rowIndex + this.rowspan - 1;
            const endColumn = this.columnIndex + this.colspan - 1;
            coordinatesRepr += ':(' + endRow + ', ' + endColumn + ')';
        }
        coordinatesRepr += '>';
        return (super.name +
            coordinatesRepr +
            (this.header ? ': header' : '') +
            (this.isActive() ? '' : ' (inactive)'));
    }
    /**
     * Return the cell that manages this cell, if any.
     */
    get managerCell() {
        return this.__managerCell;
    }
    /**
     * Return the set of cells that this cell manages.
     */
    get managedCells() {
        return new Set(this.__managedCells);
    }
    /**
     * Return the computed column span of this cell, in function of its managed
     * cells.
     */
    get colspan() {
        const cellsArray = Array.from(this.managedCells);
        const sameRowCells = cellsArray.filter(cell => cell.rowIndex === this.rowIndex);
        return 1 + sameRowCells.length;
    }
    /**
     * Return the computed row span of this cell, in function of its managed
     * cells.
     */
    get rowspan() {
        const cellsArray = Array.from(this.managedCells);
        const sameColumnCells = cellsArray.filter(cell => cell.columnIndex === this.columnIndex);
        return 1 + sameColumnCells.length;
    }
    /**
     * Return the row to which this cell belongs.
     */
    get row() {
        return this.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).children(TableCellNode);
    }
    /**
     * Return the column to which this cell belongs, as an array of cells.
     */
    get column() {
        return this.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_0__["TableNode"]).columns[this.columnIndex];
    }
    /**
     * Return the index of the row to which this cell belongs.
     */
    get rowIndex() {
        return this.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).rowIndex;
    }
    /**
     * Return the index of the column to which this cell belongs.
     */
    get columnIndex() {
        return this.parent.children(TableCellNode).indexOf(this);
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return true if this cell is active (ie not managed by another cell).
     */
    isActive() {
        return !this.managerCell;
    }
    /**
     * Set the given cell as manager of this cell.
     * Note: A cell managed by another cell also copies its manager's attributes
     * and properties and hands over its children to its manager.
     *
     * @override
     */
    mergeWith(newManager) {
        const thisTable = this.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_0__["TableNode"]);
        const otherTable = newManager.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_0__["TableNode"]);
        if (!newManager.is(TableCellNode) || thisTable !== otherTable)
            return;
        this.__managerCell = newManager;
        newManager.manage(this);
    }
    /**
     * Unmerge this cell from its manager.
     */
    unmerge() {
        const manager = this.__managerCell;
        if (manager) {
            this.__managerCell = null;
            // If we just removed this cell's manager, also remove this cell
            // from the old manager's managed cells.
            manager.unmanage(this);
        }
    }
    /**
     * Set the given cell as managed by this cell.
     * Note: A cell managed by another cell also copies its manager's modifiers
     * and properties and hands over its children to its manager.
     *
     * @param cell
     */
    manage(cell) {
        this.__managedCells.add(cell);
        // Copy the manager's modifiers and properties.
        cell.modifiers = this.modifiers.clone();
        cell.header = this.header;
        // Move the children to the manager.
        this.append(...cell.childVNodes);
        // Hand the managed cells over to the manager.
        for (const managedCell of cell.managedCells) {
            managedCell.mergeWith(this);
            cell.unmanage(managedCell);
        }
        // Copy the manager's row if an entire row was merged
        const row = cell.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]);
        if (row) {
            const cells = row.children(TableCellNode);
            const rowIsMerged = cells.every(rowCell => rowCell.managerCell === this);
            if (rowIsMerged) {
                const managerRow = cell.managerCell.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]);
                row.header = managerRow.header;
                row.modifiers = managerRow.modifiers.clone();
            }
        }
        // Ensure reciprocity.
        if (cell.managerCell !== this) {
            cell.mergeWith(this);
        }
    }
    /**
     * Restore the independence of the given cell.
     *
     * @param cell
     */
    unmanage(cell) {
        this.__managedCells.delete(cell);
        // Ensure reciprocity.
        if (cell.managerCell === this) {
            cell.unmerge();
        }
    }
}


/***/ }),

/***/ "./packages/plugin-table/src/TableCellXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-table/src/TableCellXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: TableCellXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableCellXmlDomParser", function() { return TableCellXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class TableCellXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            const name = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item);
            return name === 'TD' || name === 'TH';
        };
    }
    /**
     * Parse a table cell node.
     *
     * @param item
     */
    async parse(item) {
        const cell = new _TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]({ header: Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'TH' });
        cell.modifiers.append(this.engine.parseAttributes(item));
        const children = await this.engine.parse(...item.childNodes);
        cell.append(...children);
        return [cell];
    }
}
TableCellXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableHtmlDomRenderer.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-table/src/TableHtmlDomRenderer.ts ***!
  \***********************************************************/
/*! exports provided: TableHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableHtmlDomRenderer", function() { return TableHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _TableRowXmlDomParser__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./TableRowXmlDomParser */ "./packages/plugin-table/src/TableRowXmlDomParser.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");







class TableHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _TableNode__WEBPACK_IMPORTED_MODULE_1__["TableNode"];
    }
    /**
     * Render the TableNode along with its contents (TableRowNodes).
     */
    async render(table) {
        const domTable = document.createElement('table');
        const domHead = document.createElement('thead');
        let domBody = document.createElement('tbody');
        for (const child of table.children()) {
            const domChild = await this.renderChild(child);
            if (child.is(_TableRowNode__WEBPACK_IMPORTED_MODULE_2__["TableRowNode"])) {
                // If the child is a row, append it to its containing section.
                const tableSection = child.header ? domHead : domBody;
                tableSection.append(...domChild);
                this.engine.renderAttributes(_TableRowXmlDomParser__WEBPACK_IMPORTED_MODULE_5__["TableSectionAttributes"], child, tableSection);
                if (!tableSection.parentNode) {
                    domTable.append(tableSection);
                }
            }
            else {
                domTable.append(...domChild);
                // Create a new <tbody> so the rest of the rows, if any, get
                // appended to it, after this element.
                domBody = document.createElement('tbody');
            }
        }
        this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__["Attributes"], table, domTable);
        return [domTable];
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return true if the given item is a table section element.
     *
     * @param item
     */
    _isTableSection(item) {
        const name = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_4__["nodeName"])(item);
        return name === 'THEAD' || name === 'TBODY';
    }
}
TableHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_3__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableNode.ts":
/*!************************************************!*\
  !*** ./packages/plugin-table/src/TableNode.ts ***!
  \************************************************/
/*! exports provided: TableNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableNode", function() { return TableNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");



class TableNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor() {
        super({ htmlTag: 'TABLE' });
        this.breakable = false;
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * @override
     */
    get name() {
        return super.name + ': ' + this.rowCount + 'x' + this.columnCount;
    }
    /**
     * Return an array of rows in this table, as arrays of cells.
     */
    get rows() {
        return this.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).map(row => row.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]));
    }
    /**
     * Return an array of columns in this table, as arrays of cells.
     */
    get columns() {
        const columns = new Array(this.columnCount).fill(undefined);
        return columns.map((_, columnIndex) => this.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).map(row => row.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"])[columnIndex]));
    }
    /**
     * Return the number of rows in this table.
     */
    get rowCount() {
        return this.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).length;
    }
    /**
     * Return the number of columns in this table.
     */
    get columnCount() {
        return this.firstChild(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]).children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"]).length;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return the cell of this table that can be found at the given coordinates,
     * if any.
     *
     * @param rowIndex
     * @param columnIndex
     */
    getCellAt(rowIndex, columnIndex) {
        return this.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"])[rowIndex].children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"])[columnIndex];
    }
    /**
     * Add a new row above the reference row (the row of the given reference
     * cell). Copy the styles and colspans of the cells of the reference row. If
     * the reference row traverses a rowspan, extend that rowspan.
     *
     * @param referenceCell
     */
    addRowAbove(referenceCell) {
        const referenceRow = referenceCell.ancestor(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"]);
        const newRow = referenceRow.clone();
        referenceRow.before(newRow);
        for (const cell of referenceRow.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"])) {
            const clone = cell.clone();
            newRow.append(clone);
            // Handle managers.
            const manager = cell.managerCell;
            if (manager) {
                if (manager.rowIndex === referenceRow.rowIndex) {
                    // If the current cell's manager is in the reference row,
                    // the clone's manager should be that manager's clone.
                    const managerClone = this.getCellAt(newRow.rowIndex, manager.columnIndex);
                    clone.mergeWith(managerClone);
                }
                else {
                    clone.mergeWith(manager);
                }
            }
        }
    }
    /**
     * Add a new row below the reference row (the row of the given reference
     * cell). Copy the styles and colspans of the cells of the reference row. If
     * the reference row traverses a rowspan, extend that rowspan.
     * Note: a rowspan ending at the reference cell is not extended.
     *
     * @param referenceCell
     */
    addRowBelow(referenceCell) {
        const rowIndex = referenceCell.rowIndex + referenceCell.rowspan - 1;
        const referenceRow = this.children(_TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"])[rowIndex];
        const newRow = referenceRow.clone();
        referenceRow.after(newRow);
        for (const cell of referenceRow.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_2__["TableCellNode"])) {
            const clone = cell.clone();
            newRow.append(clone);
            // Handle managers.
            if (cell.managerCell) {
                const manager = cell.managerCell;
                const managerEndRow = manager.rowIndex + manager.rowspan - 1;
                if (managerEndRow === rowIndex && manager.columnIndex !== cell.columnIndex) {
                    // Take the new row equivalent of the above cell's manager
                    // (copy colspan).
                    clone.mergeWith(this.getCellAt(newRow.rowIndex, manager.columnIndex));
                }
                else if (managerEndRow !== rowIndex) {
                    // Take the manager cell of the above cell (extend rowspan),
                    // only if said manager's rowspan is not ending with the
                    // above cell.
                    clone.mergeWith(manager);
                }
            }
            else if (cell.rowspan > 1) {
                // If the cell has a rowspan, extend it.
                clone.mergeWith(cell);
            }
        }
    }
    /**
     * Add a new column before the reference column (the column of the given
     * reference cell). Copy the styles and rowspans of the cells of the
     * reference column. If the reference column traverses a colspan, extend
     * that colspan.
     *
     * @param referenceCell
     */
    addColumnBefore(referenceCell) {
        const referenceColumn = referenceCell.column;
        for (const cell of referenceColumn) {
            const clone = cell.clone();
            cell.before(clone);
            // Handle managers.
            const manager = cell.managerCell;
            if (manager) {
                if (manager.columnIndex === referenceCell.columnIndex) {
                    // If the current cell's manager is in the reference column,
                    // the clone's manager should be that manager's clone.
                    const managerClone = this.getCellAt(manager.rowIndex, clone.columnIndex);
                    clone.mergeWith(managerClone);
                }
                else {
                    clone.mergeWith(manager);
                }
            }
        }
    }
    /**
     * Add a new column after the reference column (the column of the given
     * reference cell). Copy the styles and rowspans of the cells of the
     * reference column. If the reference column traverses a colpan, extend that
     * colspan.
     * Note: a colspan ending at the reference cell is not extended.
     *
     * @param referenceCell
     */
    addColumnAfter(referenceCell) {
        const columnIndex = referenceCell.columnIndex + referenceCell.colspan - 1;
        const referenceColumn = this.columns[columnIndex];
        for (const cell of referenceColumn) {
            const clone = cell.clone();
            cell.after(clone);
            // Handle managers.
            if (cell.managerCell) {
                const manager = cell.managerCell;
                const managerEndColumn = manager.columnIndex + manager.colspan - 1;
                if (managerEndColumn === columnIndex && manager.rowIndex !== cell.rowIndex) {
                    // Take the new column equivalent of the previous cell's
                    // manager (copy rowspan).
                    clone.mergeWith(this.getCellAt(manager.rowIndex, clone.columnIndex));
                }
                else if (managerEndColumn !== columnIndex) {
                    // Take the manager cell of the previous cell (extend
                    // colspan), only if said manager's colspan is not ending
                    // with the previous cell.
                    clone.mergeWith(manager);
                }
            }
            else if (cell.colspan > 1) {
                // If the cell has a colspan, extend it.
                clone.mergeWith(cell);
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-table/src/TableRowHtmlDomRenderer.ts":
/*!**************************************************************!*\
  !*** ./packages/plugin-table/src/TableRowHtmlDomRenderer.ts ***!
  \**************************************************************/
/*! exports provided: TableRowHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableRowHtmlDomRenderer", function() { return TableRowHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class TableRowHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _TableRowNode__WEBPACK_IMPORTED_MODULE_1__["TableRowNode"];
    }
    /**
     * Render the TableRowNode along with its contents.
     */
    async render(row) {
        const domRow = document.createElement('tr');
        this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], row, domRow);
        const renderedChildren = await this.renderChildren(row);
        domRow.append(...renderedChildren.flat());
        return [domRow];
    }
}
TableRowHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableRowNode.ts":
/*!***************************************************!*\
  !*** ./packages/plugin-table/src/TableRowNode.ts ***!
  \***************************************************/
/*! exports provided: TableRowNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableRowNode", function() { return TableRowNode; });
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");


class TableRowNode extends _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_0__["VElement"] {
    constructor(params) {
        super({ htmlTag: 'TR' });
        this.breakable = false;
        this.header = (params === null || params === void 0 ? void 0 : params.header) || false;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new VNode with the same type and attributes as this VNode.
     *
     *  @override
     */
    clone(deepClone, params) {
        const defaults = {
            header: this.header,
        };
        return super.clone(deepClone, { ...defaults, ...params });
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * @override
     */
    get name() {
        return super.name + (this.header ? ': header' : '');
    }
    /**
     * Return the index of this row in the table.
     */
    get rowIndex() {
        return this.ancestor(_TableNode__WEBPACK_IMPORTED_MODULE_1__["TableNode"])
            .children(TableRowNode)
            .indexOf(this);
    }
}


/***/ }),

/***/ "./packages/plugin-table/src/TableRowXmlDomParser.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-table/src/TableRowXmlDomParser.ts ***!
  \***********************************************************/
/*! exports provided: TableSectionAttributes, TableRowXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableSectionAttributes", function() { return TableSectionAttributes; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableRowXmlDomParser", function() { return TableRowXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");
/* harmony import */ var _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/src/Modifiers */ "./packages/core/src/Modifiers.ts");






class TableSectionAttributes extends _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"] {
}
class TableRowXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            const name = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item);
            return name === 'THEAD' || name === 'TBODY' || name === 'TR';
        };
    }
    /**
     * Parse a row node or a table section node.
     *
     * @param item
     */
    async parse(item) {
        if (this._isTableSection(item)) {
            return this.parseTableSection(item);
        }
        else if (Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'TR') {
            const row = new _TableRowNode__WEBPACK_IMPORTED_MODULE_2__["TableRowNode"]();
            row.modifiers.append(this.engine.parseAttributes(item));
            const cells = await this.engine.parse(...item.childNodes);
            row.append(...cells);
            return [row];
        }
    }
    /**
     * Parse a <tbody> or a <thead> into an array of table rows with their
     * `header` property set in function of whether they are contained in a
     * <tbody> or a <thead>.
     *
     * @param tableSection
     */
    async parseTableSection(tableSection) {
        const parsedNodes = [];
        // Parse the section's children.
        for (const child of tableSection.childNodes) {
            parsedNodes.push(...(await this.engine.parse(child)));
        }
        // Parse the <tbody> or <thead>'s modifiers.
        const containerModifiers = new _core_src_Modifiers__WEBPACK_IMPORTED_MODULE_5__["Modifiers"](this.engine.parseAttributes(tableSection));
        // Apply the attributes, style and `header` property of the container to
        // each row.
        const name = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(tableSection);
        for (const parsedNode of parsedNodes) {
            if (parsedNode.is(_TableRowNode__WEBPACK_IMPORTED_MODULE_2__["TableRowNode"])) {
                parsedNode.header = name === 'THEAD';
                parsedNode.modifiers.replace(TableSectionAttributes, new TableSectionAttributes(containerModifiers.get(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_4__["Attributes"])));
            }
        }
        return parsedNodes;
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return true if the given item is a table section element.
     *
     * @param item
     */
    _isTableSection(item) {
        const name = Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item);
        return name === 'THEAD' || name === 'TBODY';
    }
}
TableRowXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-table/src/TableXmlDomParser.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-table/src/TableXmlDomParser.ts ***!
  \********************************************************/
/*! exports provided: TableXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TableXmlDomParser", function() { return TableXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _TableNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./TableNode */ "./packages/plugin-table/src/TableNode.ts");
/* harmony import */ var _TableRowNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./TableRowNode */ "./packages/plugin-table/src/TableRowNode.ts");
/* harmony import */ var _TableCellNode__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./TableCellNode */ "./packages/plugin-table/src/TableCellNode.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");







class TableXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_5__["nodeName"])(item) === 'TABLE';
        };
    }
    /**
     * Parse a table node.
     *
     * @param item
     */
    async parse(item) {
        // Parse the table itself and its attributes.
        const table = new _TableNode__WEBPACK_IMPORTED_MODULE_2__["TableNode"]();
        table.modifiers.append(this.engine.parseAttributes(item));
        // Parse the contents of the table.
        const children = await this.engine.parse(...item.childNodes);
        // Build the grid.
        const dimensions = this._getTableDimensions(item);
        const parsedRows = children.filter(row => row.is(_TableRowNode__WEBPACK_IMPORTED_MODULE_3__["TableRowNode"]));
        const grid = this._createTableGrid(dimensions, parsedRows);
        // Append the cells to the rows.
        const rows = new Array(dimensions[0]);
        for (let rowIndex = 0; rowIndex < grid.length; rowIndex += 1) {
            rows[rowIndex] = parsedRows[rowIndex];
            const cells = grid[rowIndex];
            let row = rows[rowIndex];
            if (!row) {
                row = new _TableRowNode__WEBPACK_IMPORTED_MODULE_3__["TableRowNode"]();
            }
            row.append(...cells);
        }
        // Append the rows and other children to the table.
        let rowIndex = 0;
        for (let childIndex = 0; childIndex < children.length; childIndex += 1) {
            const child = children[childIndex];
            if (child.is(_TableRowNode__WEBPACK_IMPORTED_MODULE_3__["TableRowNode"])) {
                const row = rows[rowIndex];
                table.append(row);
                rowIndex += 1;
            }
            else {
                table.append(children[childIndex]);
            }
        }
        return [table];
    }
    //--------------------------------------------------------------------------
    // Private
    //--------------------------------------------------------------------------
    /**
     * Return a tuple with the row length and the column length of the given DOM
     * table element.
     *
     * @param domTable
     */
    _getTableDimensions(domTable) {
        const domRows = Array.from(domTable.querySelectorAll('tr'));
        const domTableRows = domRows.filter(row => row.closest('table') === domTable);
        let columnCount = 0;
        if (domTableRows.length) {
            const domCells = Array.from(domTableRows[0].querySelectorAll('td, th'));
            const domTableCells = domCells.filter(cell => cell.closest('table') === domTable);
            for (const domChild of domTableCells) {
                columnCount += parseInt(domChild.getAttribute('colSpan') || '1', 10);
            }
        }
        return [domTableRows.length, columnCount];
    }
    /**
     * Build and return the grid (2D array: rows of cells) that will be used to
     * create the table. We want all the rows to have the same number of cells,
     * and all the columns to have the same number of cells.
     *
     * @param dimensions
     * @param rows
     */
    _createTableGrid(dimensions, rows) {
        const [rowCount, columnCount] = dimensions;
        // Initialize the grid (2D array: rows of cells).
        const grid = Array.from(Array(rowCount), () => new Array(columnCount));
        // Move every parsed child row to its place in the grid, and create
        // placeholder cells where there aren't any, accounting for column spans
        // and row spans.
        for (let rowIndex = 0; rowIndex < rowCount; rowIndex += 1) {
            const row = rows[rowIndex];
            const cells = row.children(_TableCellNode__WEBPACK_IMPORTED_MODULE_4__["TableCellNode"]).slice();
            for (let domCellIndex = 0; domCellIndex < cells.length; domCellIndex += 1) {
                const cell = cells[domCellIndex];
                // If there is a cell at this grid position already, it means we
                // added it there when handling another cell, ie. it's a
                // placeholder cell, managed by a previously handled cell.
                // The current cell needs to be added at the next available slot
                // instead.
                let columnIndex = domCellIndex;
                while (grid[rowIndex][columnIndex]) {
                    columnIndex += 1;
                }
                // Check traversing colspan and rowspan to insert placeholder
                // cells where necessary. Consume these attributes as they will
                // be replaced with getters.
                const attributes = cell.modifiers.find(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_6__["Attributes"]);
                let colspan = 1;
                let rowspan = 1;
                if (attributes) {
                    colspan = parseInt(attributes.get('colspan'), 10) || 1;
                    rowspan = parseInt(attributes.get('rowspan'), 10) || 1;
                    attributes.remove('colspan');
                    attributes.remove('rowspan');
                }
                for (let i = rowIndex; i < rowIndex + rowspan; i += 1) {
                    for (let j = columnIndex; j < columnIndex + colspan; j += 1) {
                        if (i === rowIndex && j === columnIndex) {
                            // Add the current cell to the grid.
                            grid[i][j] = cell;
                        }
                        else {
                            // Add a placeholder cell to the grid.
                            const placeholderCell = new _TableCellNode__WEBPACK_IMPORTED_MODULE_4__["TableCellNode"]();
                            placeholderCell.mergeWith(cell);
                            grid[i][j] = placeholderCell;
                        }
                    }
                }
            }
        }
        return grid;
    }
}
TableXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_1__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-textcolor/src/TextColor.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-textcolor/src/TextColor.ts ***!
  \****************************************************/
/*! exports provided: TextColor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TextColor", function() { return TextColor; });
/* harmony import */ var _plugin_color_src_Color__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-color/src/Color */ "./packages/plugin-color/src/Color.ts");

class TextColor extends _plugin_color_src_Color__WEBPACK_IMPORTED_MODULE_0__["Color"] {
    constructor() {
        super(...arguments);
        this.styleName = 'color';
        this.configuration = { defaultColor: 'black', ...this.configuration };
        this.commands = {
            colorText: {
                handler: this.color,
            },
            uncolorText: {
                handler: this.uncolor,
            },
        };
        this.loadables = {
            shortcuts: [
                {
                    pattern: 'CTRL+G',
                    commandId: 'colorText',
                    // TODO: use dialog to get params
                    commandArgs: {
                        color: 'red',
                    },
                },
                {
                    pattern: 'CTRL+SHIFT+G',
                    commandId: 'uncolorText',
                },
            ],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-toolbar/assets/Toolbar.css":
/*!****************************************************!*\
  !*** ./packages/plugin-toolbar/assets/Toolbar.css ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var api = __webpack_require__(/*! ../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js */ "./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js");
            var content = __webpack_require__(/*! !../../../node_modules/css-loader/dist/cjs.js!./Toolbar.css */ "./node_modules/css-loader/dist/cjs.js!./packages/plugin-toolbar/assets/Toolbar.css");

            content = content.__esModule ? content.default : content;

            if (typeof content === 'string') {
              content = [[module.i, content, '']];
            }

var options = {};

options.insert = "head";
options.singleton = false;

var update = api(content, options);

var exported = content.locals ? content.locals : {};



module.exports = exported;

/***/ }),

/***/ "./packages/plugin-toolbar/assets/Toolbar.xml":
/*!****************************************************!*\
  !*** ./packages/plugin-toolbar/assets/Toolbar.xml ***!
  \****************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

module.exports = "<templates>\n    <!-- MAIN -->\n    <jw-toolbar t-name=\"toolbar\">\n        <t t-foreach=\"config\" t-as=\"group\"\n            t-key=\"group_index\">\n            <t t-if=\"group === '|'\">\n                <jw-separator role=\"separator\"/>\n            </t>\n            <t t-elif=\"isString(group)\">\n                <span><t t-esc=\"group\"/></span>\n            </t>\n            <t t-else=\"\">\n                <toolbar-group>\n                    <t t-foreach=\"group\" t-as=\"toolbarItem\" t-key=\"toolbarItem_index\">\n                        <t t-if=\"toolbarItem === '|'\">\n                            <jw-separator role=\"separator\"/>\n                        </t>\n                        <t t-elif=\"isString(toolbarItem)\">\n                            <span><t t-esc=\"toolbarItem\"/></span>\n                        </t>\n                        <t t-elif=\"isArray(toolbarItem)\">\n                            <select t-on-change=\"onDropdownChange(toolbarItem)\">\n                                <option/>\n                                <t t-foreach=\"toolbarItem\" t-as=\"dropDownItem\" t-key=\"dropdownItem_index\">\n                                    <t t-if=\"isString(dropDownItem)\">\n                                        <option disabled=\"true\"><t t-esc=\"dropDownItem\"/></option>\n                                    </t>\n                                    <t t-else=\"\">\n                                        <option t-if=\"isEnabled(toolbarItem)\"\n                                            t-attf-class=\"{{dropDownItem.class}}\"\n                                            t-attf-value=\"{{dropDownItem.title}}\"\n                                            t-att-selected=\"isSelected(dropDownItem)\">\n                                            <t t-esc=\"dropDownItem.title\"/>\n                                        </option>\n                                    </t>\n                                </t>\n                            </select>\n                        </t>\n                        <t t-else=\"\">\n                            <button t-attf-class=\"fa {{toolbarItem.class}} fa-fw\"\n                                t-att-class=\"{\n                                    pressed: isSelected(toolbarItem),\n                                }\"\n                                t-attf-title=\"{{toolbarItem.title}}\"\n                                t-att-aria-pressed=\"isSelected(toolbarItem)\"\n                                t-on-click=\"execCommand(toolbarItem.commandId,\n                                    toolbarItem.commandArgs)\"\n                                t-att-disabled=\"!isEnabled(toolbarItem)\"/>\n                        </t>\n                    </t>\n                </toolbar-group>\n            </t>\n        </t>\n    </jw-toolbar>\n</templates>\n"

/***/ }),

/***/ "./packages/plugin-toolbar/src/Toolbar.ts":
/*!************************************************!*\
  !*** ./packages/plugin-toolbar/src/Toolbar.ts ***!
  \************************************************/
/*! exports provided: Toolbar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Toolbar", function() { return Toolbar; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_owl_src_Owl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-owl/src/Owl */ "./packages/plugin-owl/src/Owl.ts");
/* harmony import */ var _components_ToolbarComponent__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./components/ToolbarComponent */ "./packages/plugin-toolbar/src/components/ToolbarComponent.ts");
/* harmony import */ var _plugin_owl_src_ui_OwlNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-owl/src/ui/OwlNode */ "./packages/plugin-owl/src/ui/OwlNode.ts");
/* harmony import */ var _assets_Toolbar_xml__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../assets/Toolbar.xml */ "./packages/plugin-toolbar/assets/Toolbar.xml");
/* harmony import */ var _assets_Toolbar_xml__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(_assets_Toolbar_xml__WEBPACK_IMPORTED_MODULE_4__);
/* harmony import */ var _assets_Toolbar_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../assets/Toolbar.css */ "./packages/plugin-toolbar/assets/Toolbar.css");
/* harmony import */ var _assets_Toolbar_css__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_assets_Toolbar_css__WEBPACK_IMPORTED_MODULE_5__);






class Toolbar extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            components: [
                {
                    id: 'toolbar',
                    async render() {
                        return [new _plugin_owl_src_ui_OwlNode__WEBPACK_IMPORTED_MODULE_3__["OwlNode"](_components_ToolbarComponent__WEBPACK_IMPORTED_MODULE_2__["ToolbarComponent"], {})];
                    },
                },
            ],
            componentZones: [['toolbar', 'tools']],
            owlTemplates: [_assets_Toolbar_xml__WEBPACK_IMPORTED_MODULE_4___default.a],
        };
    }
}
Toolbar.dependencies = [_plugin_owl_src_Owl__WEBPACK_IMPORTED_MODULE_1__["Owl"]];


/***/ }),

/***/ "./packages/plugin-toolbar/src/components/ToolbarComponent.ts":
/*!********************************************************************!*\
  !*** ./packages/plugin-toolbar/src/components/ToolbarComponent.ts ***!
  \********************************************************************/
/*! exports provided: ToolbarComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ToolbarComponent", function() { return ToolbarComponent; });
/* harmony import */ var _Toolbar__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Toolbar */ "./packages/plugin-toolbar/src/Toolbar.ts");
/* harmony import */ var _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../plugin-owl/src/ui/OwlComponent */ "./packages/plugin-owl/src/ui/OwlComponent.ts");


class ToolbarComponent extends _plugin_owl_src_ui_OwlComponent__WEBPACK_IMPORTED_MODULE_1__["OwlComponent"] {
    constructor() {
        super(...arguments);
        this.config = this.env.editor.plugins.get(_Toolbar__WEBPACK_IMPORTED_MODULE_0__["Toolbar"]).configuration.layout || [];
    }
    async willStart() {
        this.env.editor.dispatcher.registerCommandHook('*', this.refresh.bind(this));
        return super.willStart();
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    execCommand(commandId, commandArgs) {
        this.env.editor.execCommand(commandId, commandArgs);
    }
    isEnabled(item) {
        return !item.enabled || item.enabled(this.env.editor);
    }
    isSelected(item) {
        return item.selected && item.selected(this.env.editor);
    }
    isArray(item) {
        return Array.isArray(item);
    }
    isString(item) {
        return typeof item === 'string';
    }
    onDropdownChange(dropdown, event) {
        const selectedIndex = event.target.selectedIndex;
        // -1 to account for the mandatory empty option on top:
        const dropdownItem = dropdown[selectedIndex - 1];
        if (dropdownItem) {
            this.execCommand(dropdownItem.commandId, dropdownItem.commandArgs);
        }
    }
    async refresh() {
        this.render();
    }
}
ToolbarComponent.components = {};
ToolbarComponent.template = 'toolbar';


/***/ }),

/***/ "./packages/plugin-underline/src/Underline.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-underline/src/Underline.ts ***!
  \****************************************************/
/*! exports provided: Underline */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Underline", function() { return Underline; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UnderlineFormat */ "./packages/plugin-underline/src/UnderlineFormat.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");
/* harmony import */ var _UnderlineXmlDomParser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./UnderlineXmlDomParser */ "./packages/plugin-underline/src/UnderlineXmlDomParser.ts");




class Underline extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_UnderlineXmlDomParser__WEBPACK_IMPORTED_MODULE_3__["UnderlineXmlDomParser"]],
            shortcuts: [
                {
                    pattern: 'CTRL+U',
                    commandId: 'toggleFormat',
                    commandArgs: { FormatClass: _UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__["UnderlineFormat"] },
                },
            ],
        };
    }
}
Underline.dependencies = [_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_2__["Inline"]];


/***/ }),

/***/ "./packages/plugin-underline/src/UnderlineButtons.ts":
/*!***********************************************************!*\
  !*** ./packages/plugin-underline/src/UnderlineButtons.ts ***!
  \***********************************************************/
/*! exports provided: UnderlineButton */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UnderlineButton", function() { return UnderlineButton; });
/* harmony import */ var _UnderlineFormat__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./UnderlineFormat */ "./packages/plugin-underline/src/UnderlineFormat.ts");
/* harmony import */ var _plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-inline/src/Inline */ "./packages/plugin-inline/src/Inline.ts");


const UnderlineButton = {
    title: 'Toggle underline',
    class: 'fa-underline',
    commandId: 'toggleFormat',
    commandArgs: { FormatClass: _UnderlineFormat__WEBPACK_IMPORTED_MODULE_0__["UnderlineFormat"] },
    selected: (editor) => editor.plugins.get(_plugin_inline_src_Inline__WEBPACK_IMPORTED_MODULE_1__["Inline"]).isAllFormat(_UnderlineFormat__WEBPACK_IMPORTED_MODULE_0__["UnderlineFormat"]),
};


/***/ }),

/***/ "./packages/plugin-underline/src/UnderlineFormat.ts":
/*!**********************************************************!*\
  !*** ./packages/plugin-underline/src/UnderlineFormat.ts ***!
  \**********************************************************/
/*! exports provided: UnderlineFormat */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UnderlineFormat", function() { return UnderlineFormat; });
/* harmony import */ var _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/Format */ "./packages/plugin-inline/src/Format.ts");

class UnderlineFormat extends _plugin_inline_src_Format__WEBPACK_IMPORTED_MODULE_0__["Format"] {
    constructor() {
        super(...arguments);
        this.htmlTag = 'U';
    }
}


/***/ }),

/***/ "./packages/plugin-underline/src/UnderlineXmlDomParser.ts":
/*!****************************************************************!*\
  !*** ./packages/plugin-underline/src/UnderlineXmlDomParser.ts ***!
  \****************************************************************/
/*! exports provided: UnderlineXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UnderlineXmlDomParser", function() { return UnderlineXmlDomParser; });
/* harmony import */ var _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/FormatParser */ "./packages/plugin-inline/src/FormatParser.ts");
/* harmony import */ var _UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./UnderlineFormat */ "./packages/plugin-underline/src/UnderlineFormat.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class UnderlineXmlDomParser extends _plugin_inline_src_FormatParser__WEBPACK_IMPORTED_MODULE_0__["FormatParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            return item instanceof Element && Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'U';
        };
    }
    /**
     * Parse an underline node.
     *
     * @param item
     */
    async parse(item) {
        const underline = new _UnderlineFormat__WEBPACK_IMPORTED_MODULE_1__["UnderlineFormat"]();
        underline.modifiers.append(this.engine.parseAttributes(item));
        const children = await this.engine.parse(...item.childNodes);
        this.applyFormat(underline, children);
        return children;
    }
}
UnderlineXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-video/src/OdooVideo.ts":
/*!************************************************!*\
  !*** ./packages/plugin-video/src/OdooVideo.ts ***!
  \************************************************/
/*! exports provided: OdooVideo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooVideo", function() { return OdooVideo; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _OdooVideoXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OdooVideoXmlDomParser */ "./packages/plugin-video/src/OdooVideoXmlDomParser.ts");
/* harmony import */ var _OdooVideoHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OdooVideoHtmlDomRenderer */ "./packages/plugin-video/src/OdooVideoHtmlDomRenderer.ts");



class OdooVideo extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_OdooVideoXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["OdooVideoXmlDomParser"]],
            renderers: [_OdooVideoHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__["OdooVideoHtmlDomRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-video/src/OdooVideoHtmlDomRenderer.ts":
/*!***************************************************************!*\
  !*** ./packages/plugin-video/src/OdooVideoHtmlDomRenderer.ts ***!
  \***************************************************************/
/*! exports provided: OdooVideoHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooVideoHtmlDomRenderer", function() { return OdooVideoHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _OdooVideoNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OdooVideoNode */ "./packages/plugin-video/src/OdooVideoNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _core_src_VSelection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/src/VSelection */ "./packages/core/src/VSelection.ts");




class OdooVideoHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _OdooVideoNode__WEBPACK_IMPORTED_MODULE_1__["OdooVideoNode"];
    }
    async render(node) {
        const wrapper = document.createElement('div');
        wrapper.classList.add('media_iframe_video');
        wrapper.setAttribute('data-oe-expression', node.src);
        wrapper.innerHTML = [
            `<div class="css_editable_mode_display">&nbsp;</div>`,
            `<div class="media_iframe_video_size">&nbsp;</div>`,
            `<iframe src="${node.src}" frameborder="0" allowfullscreen="allowfullscreen"></iframe>`,
        ].join('');
        wrapper.querySelector('.css_editable_mode_display').addEventListener('click', () => {
            this.engine.editor.nextEventMutex(() => {
                this.engine.editor.execCommand('setSelection', {
                    vSelection: {
                        anchorNode: node,
                        direction: _core_src_VSelection__WEBPACK_IMPORTED_MODULE_3__["Direction"].FORWARD,
                    },
                });
            });
        });
        wrapper.querySelector('.css_editable_mode_display').addEventListener('dblclick', () => {
            this.engine.editor.nextEventMutex(() => {
                this.engine.editor.execCommand('openMedia');
            });
        });
        return [wrapper];
    }
}
OdooVideoHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-video/src/OdooVideoNode.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-video/src/OdooVideoNode.ts ***!
  \****************************************************/
/*! exports provided: OdooVideoNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooVideoNode", function() { return OdooVideoNode; });
/* harmony import */ var _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/VNodes/AtomicNode */ "./packages/core/src/VNodes/AtomicNode.ts");

class OdooVideoNode extends _core_src_VNodes_AtomicNode__WEBPACK_IMPORTED_MODULE_0__["AtomicNode"] {
    constructor(params) {
        super();
        this.src = params.src;
    }
}


/***/ }),

/***/ "./packages/plugin-video/src/OdooVideoXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-video/src/OdooVideoXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: OdooVideoXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "OdooVideoXmlDomParser", function() { return OdooVideoXmlDomParser; });
/* harmony import */ var _OdooVideoNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OdooVideoNode */ "./packages/plugin-video/src/OdooVideoNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class OdooVideoXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (node) => {
            const isVideo = node instanceof Element &&
                Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(node) === 'DIV' &&
                node.classList.contains('media_iframe_video') &&
                node.attributes['data-oe-expression'] &&
                node.attributes['data-oe-expression'].value;
            return isVideo;
        };
    }
    async parse(element) {
        const video = new _OdooVideoNode__WEBPACK_IMPORTED_MODULE_0__["OdooVideoNode"]({ src: element.attributes['data-oe-expression'].value });
        video.modifiers.append(this.engine.parseAttributes(element));
        return [video];
    }
}
OdooVideoXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/plugin-xml/src/Attributes.ts":
/*!***********************************************!*\
  !*** ./packages/plugin-xml/src/Attributes.ts ***!
  \***********************************************/
/*! exports provided: Attributes */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Attributes", function() { return Attributes; });
/* harmony import */ var _core_src_Modifier__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/Modifier */ "./packages/core/src/Modifier.ts");
/* harmony import */ var _CssStyle__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./CssStyle */ "./packages/plugin-xml/src/CssStyle.ts");
/* harmony import */ var _ClassList__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ClassList */ "./packages/plugin-xml/src/ClassList.ts");



class Attributes extends _core_src_Modifier__WEBPACK_IMPORTED_MODULE_0__["Modifier"] {
    constructor(attributes) {
        super();
        this._record = {};
        this.style = new _CssStyle__WEBPACK_IMPORTED_MODULE_1__["CssStyle"]();
        this.classList = new _ClassList__WEBPACK_IMPORTED_MODULE_2__["ClassList"]();
        if (attributes instanceof Attributes) {
            for (const key of attributes.keys()) {
                this.set(key, attributes.get(key));
            }
        }
        else if (attributes instanceof NamedNodeMap) {
            for (const attribute of Array.from(attributes)) {
                this.set(attribute.name, attribute.value);
            }
        }
        else if (attributes) {
            for (const key of Object.keys(attributes)) {
                this.set(key, attributes[key]);
            }
        }
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    get length() {
        return this.keys().length;
    }
    get name() {
        const name = [];
        for (const attributeName of this.keys()) {
            name.push(`${attributeName}: "${this.get(attributeName)}"`);
        }
        return `{${name.join(', ')}}`;
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a clone of this record.
     */
    clone() {
        const clone = new this.constructor();
        clone._record = { ...this._record };
        clone.style = this.style.clone();
        clone.classList = this.classList.clone();
        return clone;
    }
    /**
     * Return a string representing the attributes.
     */
    toString() {
        if (!this.length)
            return `${this.constructor.name}: {}`;
        const valueRepr = [];
        for (const key of this.keys()) {
            valueRepr.push(`${key}: "${this.get(key)}"`);
        }
        return `${this.constructor.name}: { ${valueRepr.join(', ')} }`;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return true if the record has the given key, false otherwise.
     *
     * @param key
     */
    has(key) {
        return this.keys().includes(key);
    }
    /**
     * Return an array containing all the keys in the record.
     */
    keys() {
        const keys = Object.keys(this._record).filter(key => {
            return ((key !== 'style' || !!this.style.length) &&
                (key !== 'class' || !!this.classList.length));
        });
        if (this.classList.length && !keys.includes('class')) {
            // The node was not parsed with a class attribute, add it in place.
            // Use `get` for its value but record its position in the record.
            this._record.class = null;
            keys.push('class');
        }
        if (this.style.length && !keys.includes('style')) {
            // The node was not parsed with a style attribute, keep it always at
            // the end of the attributes list.
            keys.push('style');
        }
        return keys;
    }
    /**
     * Return an array containing all the values in the record.
     */
    values() {
        return this.keys().map(key => this.get(key));
    }
    /**
     * Return the record matching the given name.
     *
     * @param name
     */
    get(name) {
        if (name === 'style') {
            return this.style.cssText;
        }
        else if (name === 'class') {
            return this.classList.className;
        }
        else {
            return this._record[name];
        }
    }
    /**
     * Set the record with the given name to the given value.
     *
     * @param name
     * @param value
     */
    set(name, value) {
        if (name === 'style') {
            this.style.reset(value);
            // Use `get` for its value but record its position in the record.
            this._record.style = null;
        }
        else if (name === 'class') {
            this.classList.reset(value);
            // Use `get` for its value but record its position in the record.
            this._record.class = null;
        }
        else {
            this._record[name] = value;
        }
    }
    /**
     * Remove the records with the given names.
     *
     * @param names
     */
    remove(...names) {
        for (const name of names) {
            if (name === 'style') {
                this.style.clear();
            }
            else if (name === 'class') {
                this.classList.clear();
            }
            else {
                delete this._record[name];
            }
        }
    }
    clear() {
        this._record = {};
        this.style.clear();
        this.classList.clear();
    }
    /**
     * Return true if the given attributes are the same as the ones in this
     * record.
     *
     * @param otherAttributes
     */
    isSameAs(otherAttributes) {
        if (otherAttributes) {
            return (this.length === otherAttributes.length &&
                this.keys().every(key => {
                    return this.get(key) === otherAttributes.get(key);
                }));
        }
        else {
            return !this.length;
        }
    }
}


/***/ }),

/***/ "./packages/plugin-xml/src/ClassList.ts":
/*!**********************************************!*\
  !*** ./packages/plugin-xml/src/ClassList.ts ***!
  \**********************************************/
/*! exports provided: ClassList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ClassList", function() { return ClassList; });
class ClassList {
    constructor(...classList) {
        this._classList = new Set();
        for (const className of classList) {
            this.add(className);
        }
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * Return the number of classes in the set.
     */
    get length() {
        return this._classList.size;
    }
    /**
     * Return a textual representation of the set.
     */
    get className() {
        if (!this._classList.size)
            return;
        return Array.from(this._classList).join(' ');
    }
    /**
     * Reinitialize the set with a new set of classes, from a string to parse.
     */
    set className(className) {
        this.reset(className);
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new set of classes, parsed from a className string.
     *
     * @param className
     */
    parseClassName(className) {
        return new Set(className
            .trim()
            .split(/\s+/)
            .filter(c => c.length));
    }
    /**
     * Return a clone of this list.
     */
    clone() {
        const clone = new ClassList();
        clone._classList = new Set(this._classList);
        return clone;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return true if the set has the given class, false otherwise.
     *
     * @param name
     */
    has(name) {
        return this._classList.has(name);
    }
    /**
     * Return an array containing all the items in the list.
     */
    items() {
        return Array.from(this._classList);
    }
    /**
     * Add the given class(s) to the set.
     *
     * @param className
     */
    add(className) {
        const classes = this.parseClassName(className);
        for (const name of classes) {
            this._classList.add(name);
        }
    }
    /**
     * Remove the given class(es) from the set.
     *
     * @param className
     */
    remove(className) {
        const classes = this.parseClassName(className);
        for (const name of classes) {
            this._classList.delete(name);
        }
    }
    /**
     * Clear the set of all its classes.
     */
    clear() {
        this._classList = new Set();
    }
    /**
     * Reinitialize the set with a new set of classes (empty if no argument is
     * passed). The argument can be a set of classes or a string to parse.
     *
     * @param classList
     */
    reset(...classList) {
        this._classList.clear();
        for (const className of classList) {
            this.add(className);
        }
    }
    /**
     * For each given class, add it to the set if it doesn't have it yet,
     * otherwise remove it.
     *
     * @param classes
     */
    toggle(...classes) {
        for (const className of classes) {
            const parsed = this.parseClassName(className);
            for (const name of parsed) {
                if (this._classList.has(name)) {
                    this._classList.delete(name);
                }
                else {
                    this._classList.add(name);
                }
            }
        }
    }
}


/***/ }),

/***/ "./packages/plugin-xml/src/CssStyle.ts":
/*!*********************************************!*\
  !*** ./packages/plugin-xml/src/CssStyle.ts ***!
  \*********************************************/
/*! exports provided: CssStyle */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CssStyle", function() { return CssStyle; });
class CssStyle {
    constructor(style) {
        this._style = {};
        if (style) {
            this.reset(style);
        }
    }
    //--------------------------------------------------------------------------
    // Getters
    //--------------------------------------------------------------------------
    /**
     * Return the number of styles in the set.
     */
    get length() {
        return Object.keys(this._style).length;
    }
    /**
     * Return a textual representation of the CSS declaration block.
     */
    get cssText() {
        const keys = Object.keys(this._style);
        if (!Object.keys(this._style).length)
            return;
        const valueRepr = [];
        for (const key of keys) {
            valueRepr.push(`${key}: ${this._style[key]}`);
        }
        let result = valueRepr.join('; ');
        if (valueRepr.length) {
            result += ';';
        }
        return result;
    }
    /**
     * Reinitialize the record with a new record of styles, from a string to
     * parse.
     */
    set cssText(cssText) {
        this.reset(cssText);
    }
    //--------------------------------------------------------------------------
    // Lifecycle
    //--------------------------------------------------------------------------
    /**
     * Return a new record of styles, parsed from a cssText string.
     *
     * @param className
     */
    parseCssText(cssText) {
        const style = {};
        return cssText
            .split(';')
            .map(style => style.trim())
            .filter(style => style.length)
            .reduce((accumulator, value) => {
            const [key, v] = value.split(':');
            style[key.trim()] = v.trim();
            return accumulator;
        }, style);
    }
    /**
     * Return a clone of this record.
     */
    clone() {
        const clone = new CssStyle();
        clone._style = { ...this._style };
        return clone;
    }
    //--------------------------------------------------------------------------
    // Public
    //--------------------------------------------------------------------------
    /**
     * Return true if the record has the given style, false otherwise.
     *
     * @param key
     */
    has(key) {
        return !!this._style[key];
    }
    /**
     * Return an array containing all the keys in the record.
     */
    keys() {
        return Object.keys(this._style);
    }
    /**
     * Return an array containing all the values in the record.
     */
    values() {
        return Object.values(this._style);
    }
    /**
     * Return the record matching the given name.
     *
     * @param name
     */
    get(name) {
        return this._style[name];
    }
    /**
     * Set the record with the given name to the given value.
     *
     * @param name
     * @param value
     */
    set(name, value) {
        this._style[name] = value;
    }
    /**
     * Remove the record(s) with the given name(s).
     *
     * @param name
     */
    remove(...names) {
        for (const name of names) {
            delete this._style[name];
        }
    }
    /**
     * Clear the record of all its styles.
     */
    clear() {
        this._style = {};
    }
    /**
     * Reinitialize the record with a new record of styles (empty if no argument
     * is passed). The argument can be a record of styles or a string to parse.
     *
     * @param style
     */
    reset(style = {}) {
        if (typeof style === 'object') {
            this._style = style;
        }
        else {
            this._style = this.parseCssText(style);
        }
    }
}


/***/ }),

/***/ "./packages/plugin-xml/src/DefaultXmlDomParser.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-xml/src/DefaultXmlDomParser.ts ***!
  \********************************************************/
/*! exports provided: DefaultXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultXmlDomParser", function() { return DefaultXmlDomParser; });
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/src/VNodes/VElement */ "./packages/core/src/VNodes/VElement.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");



class DefaultXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_0__["AbstractParser"] {
    async parse(item) {
        // If the node could not be parsed, create a generic element node with
        // the HTML tag of the DOM Node. This way we may not support the node
        // but we don't break it either.
        const element = new _core_src_VNodes_VElement__WEBPACK_IMPORTED_MODULE_1__["VElement"]({ htmlTag: Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_2__["nodeName"])(item) });
        if (item instanceof Element) {
            element.modifiers.append(this.engine.parseAttributes(item));
        }
        const nodes = await this.engine.parse(...item.childNodes);
        element.append(...nodes);
        return [element];
    }
}
DefaultXmlDomParser.id = 'dom/xml';


/***/ }),

/***/ "./packages/plugin-xml/src/Xml.ts":
/*!****************************************!*\
  !*** ./packages/plugin-xml/src/Xml.ts ***!
  \****************************************/
/*! exports provided: Xml */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Xml", function() { return Xml; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/Parser */ "./packages/plugin-parser/src/Parser.ts");
/* harmony import */ var _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-renderer/src/Renderer */ "./packages/plugin-renderer/src/Renderer.ts");
/* harmony import */ var _XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");




class Xml extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsingEngines: [_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_3__["XmlDomParsingEngine"]],
        };
    }
}
Xml.dependencies = [_plugin_parser_src_Parser__WEBPACK_IMPORTED_MODULE_1__["Parser"], _plugin_renderer_src_Renderer__WEBPACK_IMPORTED_MODULE_2__["Renderer"]];


/***/ }),

/***/ "./packages/plugin-xml/src/XmlDomParsingEngine.ts":
/*!********************************************************!*\
  !*** ./packages/plugin-xml/src/XmlDomParsingEngine.ts ***!
  \********************************************************/
/*! exports provided: XmlDomParsingEngine */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "XmlDomParsingEngine", function() { return XmlDomParsingEngine; });
/* harmony import */ var _plugin_parser_src_ParsingEngine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-parser/src/ParsingEngine */ "./packages/plugin-parser/src/ParsingEngine.ts");
/* harmony import */ var _DefaultXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./DefaultXmlDomParser */ "./packages/plugin-xml/src/DefaultXmlDomParser.ts");
/* harmony import */ var _Attributes__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Attributes */ "./packages/plugin-xml/src/Attributes.ts");



class XmlDomParsingEngine extends _plugin_parser_src_ParsingEngine__WEBPACK_IMPORTED_MODULE_0__["ParsingEngine"] {
    /**
     * Parse a node's attributes and return them.
     *
     * @param node
     */
    parseAttributes(node) {
        return new _Attributes__WEBPACK_IMPORTED_MODULE_2__["Attributes"](node.attributes);
    }
}
XmlDomParsingEngine.id = 'dom/xml';
XmlDomParsingEngine.defaultParser = _DefaultXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["DefaultXmlDomParser"];


/***/ }),

/***/ "./packages/plugin-youtube/src/Youtube.ts":
/*!************************************************!*\
  !*** ./packages/plugin-youtube/src/Youtube.ts ***!
  \************************************************/
/*! exports provided: Youtube */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Youtube", function() { return Youtube; });
/* harmony import */ var _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../core/src/JWPlugin */ "./packages/core/src/JWPlugin.ts");
/* harmony import */ var _YoutubeXmlDomParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./YoutubeXmlDomParser */ "./packages/plugin-youtube/src/YoutubeXmlDomParser.ts");
/* harmony import */ var _YoutubeHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./YoutubeHtmlDomRenderer */ "./packages/plugin-youtube/src/YoutubeHtmlDomRenderer.ts");



class Youtube extends _core_src_JWPlugin__WEBPACK_IMPORTED_MODULE_0__["JWPlugin"] {
    constructor() {
        super(...arguments);
        this.loadables = {
            parsers: [_YoutubeXmlDomParser__WEBPACK_IMPORTED_MODULE_1__["YoutubeXmlDomParser"]],
            renderers: [_YoutubeHtmlDomRenderer__WEBPACK_IMPORTED_MODULE_2__["YoutubeHtmlDomRenderer"]],
        };
    }
}


/***/ }),

/***/ "./packages/plugin-youtube/src/YoutubeHtmlDomRenderer.ts":
/*!***************************************************************!*\
  !*** ./packages/plugin-youtube/src/YoutubeHtmlDomRenderer.ts ***!
  \***************************************************************/
/*! exports provided: YoutubeHtmlDomRenderer */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "YoutubeHtmlDomRenderer", function() { return YoutubeHtmlDomRenderer; });
/* harmony import */ var _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-renderer/src/AbstractRenderer */ "./packages/plugin-renderer/src/AbstractRenderer.ts");
/* harmony import */ var _YoutubeNode__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./YoutubeNode */ "./packages/plugin-youtube/src/YoutubeNode.ts");
/* harmony import */ var _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-html/src/HtmlDomRenderingEngine */ "./packages/plugin-html/src/HtmlDomRenderingEngine.ts");
/* harmony import */ var _plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../plugin-xml/src/Attributes */ "./packages/plugin-xml/src/Attributes.ts");




class YoutubeHtmlDomRenderer extends _plugin_renderer_src_AbstractRenderer__WEBPACK_IMPORTED_MODULE_0__["AbstractRenderer"] {
    constructor() {
        super(...arguments);
        this.predicate = _YoutubeNode__WEBPACK_IMPORTED_MODULE_1__["YoutubeNode"];
    }
    async render(node) {
        const youtube = document.createElement('iframe');
        this.engine.renderAttributes(_plugin_xml_src_Attributes__WEBPACK_IMPORTED_MODULE_3__["Attributes"], node, youtube);
        return [youtube];
    }
}
YoutubeHtmlDomRenderer.id = _plugin_html_src_HtmlDomRenderingEngine__WEBPACK_IMPORTED_MODULE_2__["HtmlDomRenderingEngine"].id;


/***/ }),

/***/ "./packages/plugin-youtube/src/YoutubeNode.ts":
/*!****************************************************!*\
  !*** ./packages/plugin-youtube/src/YoutubeNode.ts ***!
  \****************************************************/
/*! exports provided: YoutubeNode */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "YoutubeNode", function() { return YoutubeNode; });
/* harmony import */ var _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../plugin-inline/src/InlineNode */ "./packages/plugin-inline/src/InlineNode.ts");

class YoutubeNode extends _plugin_inline_src_InlineNode__WEBPACK_IMPORTED_MODULE_0__["InlineNode"] {
}
YoutubeNode.atomic = true;


/***/ }),

/***/ "./packages/plugin-youtube/src/YoutubeXmlDomParser.ts":
/*!************************************************************!*\
  !*** ./packages/plugin-youtube/src/YoutubeXmlDomParser.ts ***!
  \************************************************************/
/*! exports provided: YoutubeXmlDomParser */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "YoutubeXmlDomParser", function() { return YoutubeXmlDomParser; });
/* harmony import */ var _YoutubeNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./YoutubeNode */ "./packages/plugin-youtube/src/YoutubeNode.ts");
/* harmony import */ var _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../plugin-parser/src/AbstractParser */ "./packages/plugin-parser/src/AbstractParser.ts");
/* harmony import */ var _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../plugin-xml/src/XmlDomParsingEngine */ "./packages/plugin-xml/src/XmlDomParsingEngine.ts");
/* harmony import */ var _utils_src_utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/src/utils */ "./packages/utils/src/utils.ts");




class YoutubeXmlDomParser extends _plugin_parser_src_AbstractParser__WEBPACK_IMPORTED_MODULE_1__["AbstractParser"] {
    constructor() {
        super(...arguments);
        this.predicate = (item) => {
            const isYoutubeVideo = item instanceof Element &&
                Object(_utils_src_utils__WEBPACK_IMPORTED_MODULE_3__["nodeName"])(item) === 'IFRAME' &&
                item.getAttribute('src').includes('youtu');
            return isYoutubeVideo;
        };
    }
    async parse(item) {
        const youtube = new _YoutubeNode__WEBPACK_IMPORTED_MODULE_0__["YoutubeNode"]();
        youtube.modifiers.append(this.engine.parseAttributes(item));
        return [youtube];
    }
}
YoutubeXmlDomParser.id = _plugin_xml_src_XmlDomParsingEngine__WEBPACK_IMPORTED_MODULE_2__["XmlDomParsingEngine"].id;


/***/ }),

/***/ "./packages/utils/src/Dom.ts":
/*!***********************************!*\
  !*** ./packages/utils/src/Dom.ts ***!
  \***********************************/
/*! exports provided: targetDeepest, nodeLength */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "targetDeepest", function() { return targetDeepest; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nodeLength", function() { return nodeLength; });
/**
 * Return the deepest child of a given container at a given offset, and its
 * adapted offset.
 *
 * @param container
 * @param offset
 */
function targetDeepest(container, offset) {
    while (container.hasChildNodes()) {
        let childNodes;
        if (container instanceof Element && container.shadowRoot) {
            childNodes = container.shadowRoot.childNodes;
        }
        else {
            childNodes = container.childNodes;
        }
        if (offset >= childNodes.length) {
            container = container.lastChild;
            // The new container might be a text node, so considering only
            // the `childNodes` property would be wrong.
            offset = nodeLength(container);
        }
        else {
            container = childNodes[offset];
            offset = 0;
        }
    }
    return [container, offset];
}
/**
 * Return the length of a DOM Node.
 *
 * @param node
 */
function nodeLength(node) {
    if (node.nodeType === Node.TEXT_NODE) {
        return node.nodeValue.length;
    }
    else if (node instanceof Element && node.shadowRoot) {
        return node.shadowRoot.childNodes.length;
    }
    else {
        return node.childNodes.length;
    }
}


/***/ }),

/***/ "./packages/utils/src/errors.ts":
/*!**************************************!*\
  !*** ./packages/utils/src/errors.ts ***!
  \**************************************/
/*! exports provided: CustomError, ModeError, ChildError, AtomicityError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CustomError", function() { return CustomError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ModeError", function() { return ModeError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ChildError", function() { return ChildError; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AtomicityError", function() { return AtomicityError; });
/**
 * Creates an instance representing a custom error adapting to the constructor
 * name of the custom error and taking advantage of `captureStackTrace` of V8.
 *
 * Source:
 * http://developer.mozilla.org/docs/JavaScript/Reference/Global_Objects/Error
 */
class CustomError extends Error {
    constructor(...params) {
        super(...params);
        this.name = this.constructor.name;
        // Maintains proper stack trace for where our error was thrown.
        if (Error.captureStackTrace) {
            // This is only available on V8.
            Error.captureStackTrace(this, this.constructor);
        }
    }
}
/**
 * Creates an instance representing an error that occurs when a function only
 * allowed to be called in a specific mode is called in a different mode.
 */
class ModeError extends CustomError {
    constructor(mode, ...params) {
        super(...params);
        this.message = `This operation is only allowed in ${mode} mode.`;
    }
}
/**
 * Creates an instance representing an error that occurs when a VNode given as
 * child function parameter is actually not a child of the current VNode.
 */
class ChildError extends CustomError {
    constructor(thisNode, node, ...params) {
        super(...params);
        this.message = `${node.name} is not a child of ${thisNode.name}`;
    }
}
/**
 * Creates an instance representing an error that occurs when an action would
 * violate the atomicity of a VNode.
 */
class AtomicityError extends CustomError {
    constructor(node, ...params) {
        super(...params);
        this.message = `${node.name} is atomic.`;
    }
}


/***/ }),

/***/ "./packages/utils/src/formattingSpace.ts":
/*!***********************************************!*\
  !*** ./packages/utils/src/formattingSpace.ts ***!
  \***********************************************/
/*! exports provided: removeFormattingSpace */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "removeFormattingSpace", function() { return removeFormattingSpace; });
/* harmony import */ var _isBlock__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./isBlock */ "./packages/utils/src/isBlock.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./packages/utils/src/utils.ts");


/**
 * Return a string with the value of a text node stripped of its formatting
 * space, applying the w3 rules for white space processing
 * TODO: decide what exactly to do with formatting spaces:
 * remove, keep, recompute?
 *
 * @see https://www.w3.org/TR/css-text-3/#white-space-processing
 * @returns {string}
 */
function removeFormattingSpace(node) {
    var _a;
    // TODO: check the value of the `white-space` property
    const text = node.textContent;
    if ((_a = node.parentElement) === null || _a === void 0 ? void 0 : _a.closest('PRE')) {
        return text;
    }
    const spaceBeforeNewline = /([ \t])*(\n)/g;
    const spaceAfterNewline = /(\n)([ \t])*/g;
    const tabs = /\t/g;
    const newlines = /\n/g;
    const consecutiveSpace = /  */g;
    // (Comments refer to the w3 link provided above.)
    // Phase I: Collapsing and Transformation
    let newText = text
        // 1. All spaces and tabs immediately preceding or following a
        //    segment break are removed.
        .replace(spaceBeforeNewline, '$2')
        .replace(spaceAfterNewline, '$1')
        // 2. Segment breaks are transformed for rendering according to the
        //    segment break transformation rules.
        .replace(newlines, ' ')
        // 3. Every tab is converted to a space (U+0020).
        .replace(tabs, ' ')
        // 4. Any space immediately following another collapsible space —
        //    even one outside the boundary of the inline containing that
        //    space, provided both spaces are within the same inline
        //    formatting context—is collapsed to have zero advance width.
        //    (It is invisible, but retains its soft wrap opportunity, if
        //    any.)
        .replace(consecutiveSpace, ' ');
    // Phase II: Trimming and Positioning
    // 1. A sequence of collapsible spaces at the beginning of a line
    //    (ignoring any intervening inline box boundaries) is removed.
    if (_isAtSegmentBreak(node, 'start')) {
        const startSpace = /^ */g;
        newText = newText.replace(startSpace, '');
    }
    // 2. If the tab size is zero, tabs are not rendered. Otherwise, each
    //    tab is rendered as a horizontal shift that lines up the start edge
    //    of the next glyph with the next tab stop. If this distance is less
    //    than 0.5ch, then the subsequent tab stop is used instead. Tab
    //    stops occur at points that are multiples of the tab size from the
    //    block’s starting content edge. The tab size is given by the
    //    tab-size property.
    // TODO
    // 3. A sequence at the end of a line (ignoring any intervening inline
    //    box boundaries) of collapsible spaces (U+0020) and/or ideographic
    //    spaces (U+3000) whose white-space value collapses spaces is
    //    removed.
    if (_isAtSegmentBreak(node, 'end')) {
        const endSpace = /[ \u3000]*$/g;
        newText = newText.replace(endSpace, '');
    }
    return newText;
}
/**
 * Return true if the given node is immediately preceding (`side` === 'end')
 * or following (`side` === 'start') a segment break, to see if its edge
 * space must be removed.
 * A segment break is a sort of line break, not considering automatic breaks
 * that are function of the screen size. In this context, a segment is what
 * you see when you triple click in text in the browser.
 * Eg: `<div><p>◆one◆</p>◆two◆<br>◆three◆</div>` where ◆ = segment breaks.
 *
 * @param {Element} node
 * @param {'start'|'end'} side
 * @returns {boolean}
 */
function _isAtSegmentBreak(node, side) {
    const siblingSide = side === 'start' ? 'previousSibling' : 'nextSibling';
    const sibling = node && node[siblingSide];
    const isAgainstAnotherSegment = sibling && _isSegment(sibling);
    const isAtEdgeOfOwnSegment = _isBlockEdge(node, side);
    // In the DOM, a space before a BR is rendered but a space after a BR isn't.
    const isBeforeBR = side === 'end' && sibling && Object(_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(sibling) === 'BR';
    return (isAgainstAnotherSegment && !isBeforeBR) || isAtEdgeOfOwnSegment;
}
/**
 * Return true if the node is a segment according to W3 formatting model.
 *
 * @param node to check
 */
function _isSegment(node) {
    if (node.nodeType !== Node.ELEMENT_NODE) {
        // Only proper elements can be a segment.
        return false;
    }
    else if (Object(_utils__WEBPACK_IMPORTED_MODULE_1__["nodeName"])(node) === 'BR') {
        // Break (BR) tags end a segment.
        return true;
    }
    else {
        // The W3 specification has many specific cases that defines what is
        // or is not a segment. For the moment, we only handle display: block.
        return Object(_isBlock__WEBPACK_IMPORTED_MODULE_0__["isBlock"])(node);
    }
}
/**
 * Return true if the node is at the given edge of a block.
 *
 * @param node to check
 * @param side of the block to check ('start' or 'end')
 */
function _isBlockEdge(node, side) {
    const ancestorsUpToBlock = [];
    // Move up to the first block ancestor
    let ancestor = node;
    while (ancestor && (_isTextNode(ancestor) || !_isSegment(ancestor))) {
        ancestorsUpToBlock.push(ancestor);
        ancestor = ancestor.parentElement;
    }
    // Return true if no ancestor up to the first block ancestor has a
    // sibling on the specified side
    const siblingSide = side === 'start' ? 'previousSibling' : 'nextSibling';
    return ancestorsUpToBlock.every(ancestor => {
        return !ancestor[siblingSide];
    });
}
/**
 * Return true if the given node is a text node, false otherwise.
 *
 * @param node to check
 */
function _isTextNode(node) {
    return node.nodeType === Node.TEXT_NODE;
}


/***/ }),

/***/ "./packages/utils/src/isBlock.ts":
/*!***************************************!*\
  !*** ./packages/utils/src/isBlock.ts ***!
  \***************************************/
/*! exports provided: isBlock */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isBlock", function() { return isBlock; });
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./utils */ "./packages/utils/src/utils.ts");

/**
 * The following is a complete list of all HTML "block-level" elements.
 *
 * Source:
 * https://developer.mozilla.org/en-US/docs/Web/HTML/Block-level_elements
 *
 * */
const blockTagNames = [
    'ADDRESS',
    'ARTICLE',
    'ASIDE',
    'BLOCKQUOTE',
    'DETAILS',
    'DIALOG',
    'DD',
    'DIV',
    'DL',
    'DT',
    'FIELDSET',
    'FIGCAPTION',
    'FIGURE',
    'FOOTER',
    'FORM',
    'H1',
    'H2',
    'H3',
    'H4',
    'H5',
    'H6',
    'HEADER',
    'HGROUP',
    'HR',
    'LI',
    'MAIN',
    'NAV',
    'OL',
    'P',
    'PRE',
    'SECTION',
    'TABLE',
    'UL',
    // The following elements are not in the W3C list, for some reason.
    'TR',
    'TD',
    'TBODY',
    'THEAD',
    'TH',
];
const computedStyles = new WeakMap();
/**
 * Return true if the given node is a block-level element, false otherwise.
 *
 * @param node
 */
function isBlock(node) {
    let result;
    if (node instanceof Element) {
        const tagName = Object(_utils__WEBPACK_IMPORTED_MODULE_0__["nodeName"])(node);
        // every custom jw-* node will be considered as blocks
        if (tagName.startsWith('JW-') || tagName === 'T') {
            return true;
        }
        // We won't call `getComputedStyle` more than once per node.
        let style = computedStyles.get(node);
        if (!style) {
            style = window.getComputedStyle(node);
        }
        // The node might not be in the DOM, in which case it has no CSS values.
        if (style.display) {
            result = !style.display.includes('inline') && style.display !== 'contents';
        }
        else {
            result = blockTagNames.includes(tagName);
        }
    }
    else {
        result = false;
    }
    return result;
}


/***/ }),

/***/ "./packages/utils/src/polyfill.ts":
/*!****************************************!*\
  !*** ./packages/utils/src/polyfill.ts ***!
  \****************************************/
/*! exports provided: elementFromPoint, caretPositionFromPoint */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "elementFromPoint", function() { return elementFromPoint; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "caretPositionFromPoint", function() { return caretPositionFromPoint; });
/* harmony import */ var _Dom__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Dom */ "./packages/utils/src/Dom.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ "./packages/utils/src/utils.ts");


function elementFromPoint(x, y) {
    let element = document.elementFromPoint(x, y);
    if (element) {
        let root;
        root = element.ownerDocument;
        while (element.shadowRoot) {
            root = element.shadowRoot;
            element = root.elementFromPoint(x, y);
        }
        return element;
    }
}
function caretPositionFromPoint(x, y) {
    if ((!x && x !== 0) || (!y && y !== 0))
        return;
    // There is no cross-browser function for this, but the three functions below
    // cover all modern browsers as well as the shadow DOM.
    let caretPosition;
    const element = elementFromPoint(x, y);
    if (!element) {
        return;
    }
    const root = Object(_utils__WEBPACK_IMPORTED_MODULE_1__["getDocument"])(element);
    if (root.caretPositionFromPoint) {
        caretPosition = root.caretPositionFromPoint(x, y);
    }
    else if (root instanceof ShadowRoot) {
        // Find the nearest node leaf or char in leaf.
        const position = caretPositionFromPointInShadowDom(x, y, element);
        caretPosition = {
            offsetNode: position.node,
            offset: position.offset,
        };
    }
    else {
        const carretRange = root.caretRangeFromPoint(x, y);
        caretPosition = {
            offsetNode: carretRange.startContainer,
            offset: carretRange.startOffset,
        };
    }
    if (caretPosition) {
        const [offsetNode, offset] = Object(_Dom__WEBPACK_IMPORTED_MODULE_0__["targetDeepest"])(caretPosition.offsetNode, caretPosition.offset);
        return { offsetNode, offset };
    }
}
function caretPositionFromPointInShadowDom(x, y, element) {
    const range = document.createRange();
    let distX = Infinity;
    let distY = Infinity;
    let node;
    let offset;
    const leafs = [];
    const elements = [element];
    while (elements.length) {
        const element = elements.shift();
        if (element.childNodes.length) {
            elements.push(...element.childNodes);
        }
        else {
            leafs.push(element);
        }
    }
    // Find the nearest node leaf.
    for (const leaf of leafs) {
        let box;
        if (leaf instanceof Element) {
            box = leaf.getBoundingClientRect();
        }
        else {
            range.setStart(leaf, 0);
            range.setEnd(leaf, leaf.textContent.length);
            box = range.getBoundingClientRect();
        }
        if (box.y + box.height < y) {
            continue;
        }
        let currentOffset = 0;
        let newDistY;
        if (box.y <= y && box.y + box.height >= y) {
            newDistY = 0;
            if (leaf.nodeType === Node.TEXT_NODE) {
                currentOffset = getNearestCharOffset(x, y, leaf);
                range.setStart(leaf, currentOffset);
                range.setEnd(leaf, currentOffset);
                box = range.getBoundingClientRect();
            }
        }
        else {
            newDistY = Math.abs(box.y + box.height / 2 - y);
        }
        let newDistX;
        if (box.x <= x && box.x + box.width >= x) {
            newDistX = 0;
        }
        else {
            newDistX = Math.abs(box.x + box.width / 2 - x);
        }
        if (newDistY < distY) {
            distY = newDistY;
            distX = newDistX;
            node = leaf;
            offset = currentOffset;
        }
        else if (newDistY === distY &&
            ((newDistY === 0 && newDistX <= distX) || (newDistY !== 0 && newDistX > distX))) {
            distY = newDistY;
            distX = newDistX;
            node = leaf;
            offset = currentOffset;
        }
        if (distX === 0 && distY === 0) {
            break;
        }
    }
    return node && { node, offset };
}
function getNearestCharOffset(x, y, text) {
    // Search with a pseudo dichotomic for performance.
    const range = document.createRange();
    const posToTest = [[0, text.textContent.length]];
    const verticalMatches = [];
    while (posToTest.length) {
        const pos = posToTest.pop();
        range.setStart(text, pos[0]);
        range.setEnd(text, pos[1]);
        const box = range.getBoundingClientRect();
        if (box.y <= y && box.y + box.height >= y) {
            if (box.x <= x && box.x + box.width >= x) {
                if (pos[1] - pos[0] <= 1) {
                    return box.x + box.width / 2 <= x ? pos[1] : pos[0];
                }
                const alf = Math.floor((pos[0] + pos[1]) / 2);
                posToTest.push([pos[0], alf], [alf, pos[1]]);
            }
            else {
                verticalMatches.push(pos);
            }
        }
    }
    // Did not found the char, eg: user click on left above the container like
    // the browser we get the nearest char at the same cursor of the pointer.
    let dist = Infinity;
    let offset = 0;
    for (const pos of verticalMatches.reverse()) {
        for (let i = pos[0]; i < pos[1]; i++) {
            range.setStart(text, i);
            range.setEnd(text, i + 1);
            const box = range.getBoundingClientRect();
            const dx = box.x + box.width / 2;
            const dy = box.y + box.height / 2;
            const delta = Math.pow(dx - x, 2) + Math.pow(dy - y, 4);
            if (delta <= dist) {
                dist = delta;
                offset = i + (dx < x ? 1 : 0);
            }
        }
    }
    return offset;
}


/***/ }),

/***/ "./packages/utils/src/utils.ts":
/*!*************************************!*\
  !*** ./packages/utils/src/utils.ts ***!
  \*************************************/
/*! exports provided: isConstructor, deepEqualObjects, toUnicode, nodeLength, distinct, nodeName, getDocument */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "isConstructor", function() { return isConstructor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deepEqualObjects", function() { return deepEqualObjects; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "toUnicode", function() { return toUnicode; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nodeLength", function() { return nodeLength; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "distinct", function() { return distinct; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "nodeName", function() { return nodeName; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getDocument", function() { return getDocument; });
/**
 * Return whether the given constructor is a constructor of given superClass.
 *
 * @param constructor
 * @param superClass
 */
function isConstructor(constructor, superClass) {
    return constructor.prototype instanceof superClass || constructor === superClass;
}
/**
 * Return true if object a is deep equal to object b, false otherwise.
 *
 * @param a
 * @param b
 */
function deepEqualObjects(a, b) {
    const aKeys = Object.keys(a);
    if (aKeys.length !== Object.keys(b).length)
        return false;
    for (const key of aKeys) {
        const aValue = a[key];
        const bValue = b[key];
        if (typeof aValue === 'object') {
            if (!deepEqualObjects(aValue, bValue)) {
                return false;
            }
        }
        else {
            if (aValue !== bValue) {
                return false;
            }
        }
    }
    return true;
}
/**
 * Convert certain special characters to unicode.
 */
function toUnicode(string) {
    if (string === ' ') {
        return '\u00A0';
    }
    if (string === '\n') {
        return '\u000d';
    }
    if (string === '\t') {
        return '\u0009';
    }
    return string;
}
/**
 * Return the length of a DOM Node.
 *
 * @param node
 */
function nodeLength(node) {
    const isTextNode = node.nodeType === Node.TEXT_NODE;
    const content = isTextNode ? node.nodeValue : node.childNodes;
    return content.length;
}
/**
 * Return a duplicate-free version of an array.
 *
 * @param array
 */
function distinct(array) {
    return Array.from(new Set(array));
}
/**
 * Return the uppercase name of the given DOM node.
 *
 * @param node
 */
function nodeName(node) {
    return node.nodeName.toUpperCase();
}
function getDocument(node) {
    let root;
    while (node && !root) {
        if (node instanceof Document || node instanceof ShadowRoot) {
            root = node;
        }
        else {
            node = node.parentNode;
        }
    }
    return root || document;
}


/***/ })

/******/ });
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KV0VkaXRvci93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL2J1bmRsZXMvQmFzaWNFZGl0b3IudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9idW5kbGVzL09kb29XZWJzaXRlRWRpdG9yLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vYnVuZGxlcy9iYXNpY0xheW91dC5jc3M/ZDgzOSIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL2J1bmRsZXMvYmFzaWNMYXlvdXQueG1sIiwid2VicGFjazovL0pXRWRpdG9yLy4vbm9kZV9tb2R1bGVzL0BvZG9vL293bC9kaXN0L293bC5qcyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL2J1bmRsZXMvYmFzaWNMYXlvdXQuY3NzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRldnRvb2xzL2Fzc2V0cy9EZXZUb29scy5jc3MiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGlhbG9nL3NyYy91aS9EaWFsb2cuY3NzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRvb2xiYXIvYXNzZXRzL1Rvb2xiYXIuY3NzIiwid2VicGFjazovL0pXRWRpdG9yLy4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qcyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qcyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2J1aWxkLW9kb28taW50ZWdyYXRpb24vb2Rvby1pbnRlZ3JhdGlvbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL0NvbnRleHRNYW5hZ2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvQ29yZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL0Rpc3BhdGNoZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9KV0VkaXRvci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL0pXUGx1Z2luLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvTW9kaWZpZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9Nb2RpZmllcnMudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9WTm9kZXMvQWJzdHJhY3ROb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvVk5vZGVzL0F0b21pY05vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL1ZOb2Rlcy9GcmFnbWVudE5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9jb3JlL3NyYy9WTm9kZXMvTWFya2VyTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL2NvcmUvc3JjL1ZOb2Rlcy9TZXBhcmF0b3JOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvVk5vZGVzL1ZFbGVtZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvVk5vZGVzL1ZOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvVlJhbmdlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvY29yZS9zcmMvVlNlbGVjdGlvbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1hbGlnbi9zcmMvQWxpZ24udHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tYWxpZ24vc3JjL0FsaWduQnV0dG9ucy50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1iYWNrZ3JvdW5kY29sb3Ivc3JjL0JhY2tncm91bmRDb2xvci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1ibG9ja3F1b3RlL3NyYy9CbG9ja3F1b3RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWJsb2NrcXVvdGUvc3JjL0Jsb2NrcXVvdGVOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWJsb2NrcXVvdGUvc3JjL0Jsb2NrcXVvdGVYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tYm9sZC9zcmMvQm9sZC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1ib2xkL3NyYy9Cb2xkQnV0dG9ucy50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1ib2xkL3NyYy9Cb2xkRm9ybWF0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWJvbGQvc3JjL0JvbGRYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tY2hhci9zcmMvQ2hhci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1jaGFyL3NyYy9DaGFyRm9ybWF0SHRtbERvbVJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWNoYXIvc3JjL0NoYXJIdG1sRG9tUmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tY2hhci9zcmMvQ2hhck5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tY2hhci9zcmMvQ2hhclhtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1jb2xvci9zcmMvQ29sb3IudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvYXNzZXRzL0RldlRvb2xzLmNzcz9kMmEzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRldnRvb2xzL2Fzc2V0cy9EZXZUb29scy54bWwiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvc3JjL0RldlRvb2xzLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRldnRvb2xzL3NyYy9jb21wb25lbnRzL0NvbW1hbmRzQ29tcG9uZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRldnRvb2xzL3NyYy9jb21wb25lbnRzL0RldlRvb2xzQ29tcG9uZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRldnRvb2xzL3NyYy9jb21wb25lbnRzL0luZm9Db21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvc3JjL2NvbXBvbmVudHMvSW5zcGVjdG9yQ29tcG9uZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRldnRvb2xzL3NyYy9jb21wb25lbnRzL1BhdGhDb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvc3JjL2NvbXBvbmVudHMvU2hvcnRjdXRzQ29tcG9uZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRldnRvb2xzL3NyYy9jb21wb25lbnRzL1RyZWVDb21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGV2dG9vbHMvc3JjL3V0aWxzLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRpYWxvZy9zcmMvRGlhbG9nLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRpYWxvZy9zcmMvdWkvRGlhbG9nLmNzcz83YTg1Iiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRpYWxvZy9zcmMvdWkvRGlhbG9nLnhtbCIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kaWFsb2cvc3JjL3VpL0RpYWxvZ1pvbmVIdG1sRG9tUmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGlhbG9nL3NyYy91aS9EaWFsb2dab25lTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kaWFsb2cvc3JjL3VpL0RpYWxvZ1pvbmVYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZGl2aWRlci9zcmMvRGl2aWRlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kaXZpZGVyL3NyYy9EaXZpZGVyTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kaXZpZGVyL3NyYy9EaXZpZGVyWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRvbS1lZGl0YWJsZS9zcmMvRG9tRWRpdGFibGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWVkaXRhYmxlL3NyYy9FdmVudE5vcm1hbGl6ZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWVkaXRhYmxlL3NyYy9NdXRhdGlvbk5vcm1hbGl6ZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWxheW91dC9zcmMvRG9tTGF5b3V0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRvbS1sYXlvdXQvc3JjL3VpL0RvbUxheW91dEVuZ2luZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kb20tbGF5b3V0L3NyYy91aS9Eb21NYXAudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWxheW91dC9zcmMvdWkvTGF5b3V0Q29udGFpbmVySHRtbERvbVJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWRvbS1sYXlvdXQvc3JjL3VpL0xheW91dENvbnRhaW5lck5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWxheW91dC9zcmMvdWkvWm9uZUh0bWxEb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1kb20tbGF5b3V0L3NyYy91aS9ab25lWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWhlYWRpbmcvc3JjL0hlYWRpbmcudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taGVhZGluZy9zcmMvSGVhZGluZ0J1dHRvbnMudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taGVhZGluZy9zcmMvSGVhZGluZ05vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taGVhZGluZy9zcmMvSGVhZGluZ1htbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1odG1sL3NyYy9EZWZhdWx0SHRtbERvbVJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWh0bWwvc3JjL0RlZmF1bHRIdG1sVGV4dFBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1odG1sL3NyYy9IdG1sLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWh0bWwvc3JjL0h0bWxEb21QYXJzaW5nRW5naW5lLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWh0bWwvc3JjL0h0bWxEb21SZW5kZXJpbmdFbmdpbmUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taHRtbC9zcmMvSHRtbE5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taHRtbC9zcmMvSHRtbE5vZGVEb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1odG1sL3NyYy9IdG1sVGV4dFBhcnNpbmdFbmdpbmUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taW1hZ2Uvc3JjL0ltYWdlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWltYWdlL3NyYy9JbWFnZUh0bWxEb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pbWFnZS9zcmMvSW1hZ2VOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWltYWdlL3NyYy9JbWFnZVhtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pbmRlbnQvc3JjL0luZGVudC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pbmRlbnQvc3JjL0luZGVudEJ1dHRvbnMudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taW5saW5lL3NyYy9Gb3JtYXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taW5saW5lL3NyYy9Gb3JtYXREb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdFBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZU5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taW5wdXQvc3JjL0lucHV0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWlucHV0L3NyYy9JbnB1dEh0bWxEb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pbnB1dC9zcmMvSW5wdXROb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWlucHV0L3NyYy9JbnB1dFhtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pdGFsaWMvc3JjL0l0YWxpYy50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1pdGFsaWMvc3JjL0l0YWxpY0J1dHRvbnMudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taXRhbGljL3NyYy9JdGFsaWNGb3JtYXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4taXRhbGljL3NyYy9JdGFsaWNYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXRFbmdpbmUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGF5b3V0L3NyYy9ab25lTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVhay50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVha0h0bWxEb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVha05vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGluZWJyZWFrL3NyYy9MaW5lQnJlYWtYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGluay9hc3NldHMvTGlua0Zvcm0ueG1sIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWxpbmsvc3JjL0xpbmsudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGluay9zcmMvTGlua0Zvcm1hdC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saW5rL3NyYy9MaW5rWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLWxpc3Qvc3JjL0xpc3QudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGlzdC9zcmMvTGlzdEJ1dHRvbnMudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbGlzdC9zcmMvTGlzdEh0bWxEb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saXN0L3NyYy9MaXN0SXRlbUh0bWxEb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saXN0L3NyYy9MaXN0SXRlbVhtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saXN0L3NyYy9MaXN0Tm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1saXN0L3NyYy9MaXN0WG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW1ldGFkYXRhL3NyYy9NZXRhRGF0YUh0bWxEb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1tZXRhZGF0YS9zcmMvTWV0YWRhdGEudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tbWV0YWRhdGEvc3JjL01ldGFkYXRhTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1tZXRhZGF0YS9zcmMvTWV0YWRhdGFYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby1zbmlwcGV0cy9zcmMvTGlua0J1dHRvbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vZG9vLXNuaXBwZXRzL3NyYy9NZWRpYUJ1dHRvbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vZG9vLXNuaXBwZXRzL3NyYy9PZG9vQmluZGluZ3MudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby1zbmlwcGV0cy9zcmMvT2Rvb0ltYWdlSHRtbERvbVJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW9kb28tc25pcHBldHMvc3JjL09kb29TbmlwcGV0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW9kb28tc25pcHBldHMvc3JjL09kb29TdHJ1Y3R1cmVOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLW9kb28tc25pcHBldHMvc3JjL09kb29TdHJ1Y3V0cmVYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby1zbmlwcGV0cy9zcmMvU2F2ZUJ1dHRvbi50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vd2wvc3JjL093bC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vd2wvc3JjL3VpL093bENvbXBvbmVudC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vd2wvc3JjL3VpL093bEh0bWxEb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1vd2wvc3JjL3VpL093bE5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tcGFyYWdyYXBoL3NyYy9QYXJhZ3JhcGgudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tcGFyYWdyYXBoL3NyYy9QYXJhZ3JhcGhOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXBhcmFncmFwaC9zcmMvUGFyYWdyYXBoWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzaW5nRW5naW5lLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXByZS9zcmMvUHJlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXByZS9zcmMvUHJlQnV0dG9ucy50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1wcmUvc3JjL1ByZUNoYXJIdG1sRG9tUmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tcHJlL3NyYy9QcmVIdG1sRG9tUmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tcHJlL3NyYy9QcmVOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXByZS9zcmMvUHJlU2VwYXJhdG9ySHRtbERvbVJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXByZS9zcmMvUHJlWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXNwYW4vc3JjL1NwYW4udHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tc3Bhbi9zcmMvU3BhbkZvcm1hdC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1zcGFuL3NyYy9TcGFuWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXN1YnNjcmlwdC9zcmMvU3Vic2NyaXB0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXN1YnNjcmlwdC9zcmMvU3Vic2NyaXB0Rm9ybWF0LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXN1YnNjcmlwdC9zcmMvU3Vic2NyaXB0WG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXN1cGVyc2NyaXB0L3NyYy9TdXBlcnNjcmlwdC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi1zdXBlcnNjcmlwdC9zcmMvU3VwZXJzY3JpcHRGb3JtYXQudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tc3VwZXJzY3JpcHQvc3JjL1N1cGVyc2NyaXB0WG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi10YWJsZS9zcmMvVGFibGVDZWxsSHRtbERvbVJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZUNlbGxOb2RlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZUNlbGxYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGFibGUvc3JjL1RhYmxlSHRtbERvbVJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZU5vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGFibGUvc3JjL1RhYmxlUm93SHRtbERvbVJlbmRlcmVyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZVJvd05vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdGFibGUvc3JjL1RhYmxlUm93WG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZVhtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi10ZXh0Y29sb3Ivc3JjL1RleHRDb2xvci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi10b29sYmFyL2Fzc2V0cy9Ub29sYmFyLmNzcz9hZmU3Iiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRvb2xiYXIvYXNzZXRzL1Rvb2xiYXIueG1sIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXRvb2xiYXIvc3JjL1Rvb2xiYXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdG9vbGJhci9zcmMvY29tcG9uZW50cy9Ub29sYmFyQ29tcG9uZW50LnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXVuZGVybGluZS9zcmMvVW5kZXJsaW5lLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXVuZGVybGluZS9zcmMvVW5kZXJsaW5lQnV0dG9ucy50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi11bmRlcmxpbmUvc3JjL1VuZGVybGluZUZvcm1hdC50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi11bmRlcmxpbmUvc3JjL1VuZGVybGluZVhtbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi12aWRlby9zcmMvT2Rvb1ZpZGVvLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXZpZGVvL3NyYy9PZG9vVmlkZW9IdG1sRG9tUmVuZGVyZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdmlkZW8vc3JjL09kb29WaWRlb05vZGUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4tdmlkZW8vc3JjL09kb29WaWRlb1htbERvbVBhcnNlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teG1sL3NyYy9DbGFzc0xpc3QudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teG1sL3NyYy9Dc3NTdHlsZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi14bWwvc3JjL0RlZmF1bHRYbWxEb21QYXJzZXIudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teG1sL3NyYy9YbWwudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvcGx1Z2luLXlvdXR1YmUvc3JjL1lvdXR1YmUudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy9wbHVnaW4teW91dHViZS9zcmMvWW91dHViZUh0bWxEb21SZW5kZXJlci50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi15b3V0dWJlL3NyYy9Zb3V0dWJlTm9kZS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3BsdWdpbi15b3V0dWJlL3NyYy9Zb3V0dWJlWG1sRG9tUGFyc2VyLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvdXRpbHMvc3JjL0RvbS50cyIsIndlYnBhY2s6Ly9KV0VkaXRvci8uL3BhY2thZ2VzL3V0aWxzL3NyYy9lcnJvcnMudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy91dGlscy9zcmMvZm9ybWF0dGluZ1NwYWNlLnRzIiwid2VicGFjazovL0pXRWRpdG9yLy4vcGFja2FnZXMvdXRpbHMvc3JjL2lzQmxvY2sudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy91dGlscy9zcmMvcG9seWZpbGwudHMiLCJ3ZWJwYWNrOi8vSldFZGl0b3IvLi9wYWNrYWdlcy91dGlscy9zcmMvdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7UUFBQTtRQUNBOztRQUVBO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7O1FBRUE7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTs7O1FBR0E7UUFDQTs7UUFFQTtRQUNBOztRQUVBO1FBQ0E7UUFDQTtRQUNBLDBDQUEwQyxnQ0FBZ0M7UUFDMUU7UUFDQTs7UUFFQTtRQUNBO1FBQ0E7UUFDQSx3REFBd0Qsa0JBQWtCO1FBQzFFO1FBQ0EsaURBQWlELGNBQWM7UUFDL0Q7O1FBRUE7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBLHlDQUF5QyxpQ0FBaUM7UUFDMUUsZ0hBQWdILG1CQUFtQixFQUFFO1FBQ3JJO1FBQ0E7O1FBRUE7UUFDQTtRQUNBO1FBQ0EsMkJBQTJCLDBCQUEwQixFQUFFO1FBQ3ZELGlDQUFpQyxlQUFlO1FBQ2hEO1FBQ0E7UUFDQTs7UUFFQTtRQUNBLHNEQUFzRCwrREFBK0Q7O1FBRXJIO1FBQ0E7OztRQUdBO1FBQ0E7Ozs7Ozs7Ozs7Ozs7QUNsRkE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxVQUFVO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCOztBQUVyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZO0FBQ1o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkIsc0JBQXNCLGFBQWE7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLGtCQUFrQjtBQUNqQztBQUNBLG1CQUFtQixvQkFBb0I7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0VBQWdFO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxVQUFVO0FBQzNEO0FBQ0E7QUFDQSxtREFBbUQsVUFBVTtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLG9CQUFvQjtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0RBQWtELFVBQVU7QUFDNUQ7QUFDQTtBQUNBLHlEQUF5RCxVQUFVO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsb0JBQW9CO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlEQUF5RCxVQUFVO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQ7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpREFBaUQsVUFBVTtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMENBQTBDLFVBQVU7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsVUFBVTtBQUMvRDtBQUNBO0FBQ0EsMkNBQTJDLFVBQVU7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyxVQUFVO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsVUFBVTtBQUNyRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FB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a0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3RUFBd0UsV0FBVyxVQUFVLFlBQVk7QUFDekcsbUNBQW1DLEtBQUssSUFBSSw0QkFBNEI7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCO0FBQzNCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQ0FBMEMsZUFBZTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBDQUEwQyxLQUFLO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUNBQXlDLEtBQUs7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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dEI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0dBQXdHLElBQUk7QUFDNUc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSw4Q0FBOEM7QUFDOUMscUNBQXFDLE9BQU87QUFDNUMsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ047QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFD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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCLHFDQUFxQztBQUNyQyxvQ0FBb0M7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLGNBQWM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsUUFBUTtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBEQUEwRCwyQkFBMkI7QUFDckY7QUFDQTtBQUNBO0FBQ0EsOERB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDLHNCQUFzQjtBQUM5RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrREFBa0QsRUFBRTtBQUNwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdEO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEVBQTBFLHNCQUFzQjtBQUNoRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhDQUE4QyxzQkFBc0I7QUFDcEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyREFBMkQ7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkRBQTZEO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOENBQThDLE9BQU87QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0NBQXdDO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkRBQTJELDJCQUEyQjtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxjQUFjO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdDQUF3QyxZQUFZLEVBQUU7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsY0FBYztBQUMzQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnRkFBZ0YsZUFBZTtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RCxrQkFBa0I7QUFDL0U7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLGdDQUFnQztBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFD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QWU7SUFDdkMsT0FBTyxLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7QUFDdEMsQ0FBQztBQUVEOzs7O0dBSUc7QUFDSSxTQUFTLFFBQVEsQ0FBQyxJQUFVO0lBQy9CLE9BQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUN2QyxDQUFDO0FBRU0sU0FBUyxXQUFXLENBQUMsSUFBVTtJQUNsQyxJQUFJLElBQTJCLENBQUM7SUFDaEMsT0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUU7UUFDbEIsSUFBSSxJQUFJLFlBQVksUUFBUSxJQUFJLElBQUksWUFBWSxVQUFVLEVBQUU7WUFDeEQsSUFBSSxHQUFHLElBQUksQ0FBQztTQUNmO2FBQU07WUFDSCxJQUFJLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQztTQUMxQjtLQUNKO0lBQ0QsT0FBTyxJQUFJLElBQUksUUFBUSxDQUFDO0FBQzVCLENBQUMiLCJmaWxlIjoib2Rvby1pbnRlZ3JhdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vcGFja2FnZXMvYnVpbGQtb2Rvby1pbnRlZ3JhdGlvbi9vZG9vLWludGVncmF0aW9uLnRzXCIpO1xuIiwiaW1wb3J0IEpXRWRpdG9yIGZyb20gJy4uL3BhY2thZ2VzL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBIdG1sIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWh0bWwvc3JjL0h0bWwnO1xuaW1wb3J0IHsgQ2hhciB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1jaGFyL3NyYy9DaGFyJztcbmltcG9ydCB7IExpbmVCcmVhayB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVhayc7XG5pbXBvcnQgeyBIZWFkaW5nIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWhlYWRpbmcvc3JjL0hlYWRpbmcnO1xuaW1wb3J0IHsgUGFyYWdyYXBoIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLXBhcmFncmFwaC9zcmMvUGFyYWdyYXBoJztcbmltcG9ydCB7IExpc3QgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tbGlzdC9zcmMvTGlzdCc7XG5pbXBvcnQgeyBJbmRlbnQgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4taW5kZW50L3NyYy9JbmRlbnQnO1xuaW1wb3J0IHsgUGFyYWdyYXBoTm9kZSB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1wYXJhZ3JhcGgvc3JjL1BhcmFncmFwaE5vZGUnO1xuaW1wb3J0IHsgTGluZUJyZWFrTm9kZSB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVha05vZGUnO1xuaW1wb3J0IHsgU3BhbiB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1zcGFuL3NyYy9TcGFuJztcbmltcG9ydCB7IEJvbGQgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tYm9sZC9zcmMvQm9sZCc7XG5pbXBvcnQgeyBJdGFsaWMgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4taXRhbGljL3NyYy9JdGFsaWMnO1xuaW1wb3J0IHsgVW5kZXJsaW5lIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLXVuZGVybGluZS9zcmMvVW5kZXJsaW5lJztcbmltcG9ydCB7IElubGluZSB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWxpbmsvc3JjL0xpbmsnO1xuaW1wb3J0IHsgRGl2aWRlciB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1kaXZpZGVyL3NyYy9EaXZpZGVyJztcbmltcG9ydCB7IEltYWdlIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWltYWdlL3NyYy9JbWFnZSc7XG5pbXBvcnQgeyBTdWJzY3JpcHQgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tc3Vic2NyaXB0L3NyYy9TdWJzY3JpcHQnO1xuaW1wb3J0IHsgU3VwZXJzY3JpcHQgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tc3VwZXJzY3JpcHQvc3JjL1N1cGVyc2NyaXB0JztcbmltcG9ydCB7IEJsb2NrcXVvdGUgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tYmxvY2txdW90ZS9zcmMvQmxvY2txdW90ZSc7XG5pbXBvcnQgeyBZb3V0dWJlIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLXlvdXR1YmUvc3JjL1lvdXR1YmUnO1xuaW1wb3J0IHsgVGFibGUgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tdGFibGUvc3JjL1RhYmxlJztcbmltcG9ydCB7IE1ldGFkYXRhIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLW1ldGFkYXRhL3NyYy9NZXRhZGF0YSc7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgS2V5bWFwIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcbmltcG9ydCB7IEFsaWduIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWFsaWduL3NyYy9BbGlnbic7XG5pbXBvcnQgeyBQcmUgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tcHJlL3NyYy9QcmUnO1xuaW1wb3J0IHsgVGV4dENvbG9yIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLXRleHRjb2xvci9zcmMvVGV4dENvbG9yJztcbmltcG9ydCB7IEJhY2tncm91bmRDb2xvciB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1iYWNrZ3JvdW5kY29sb3Ivc3JjL0JhY2tncm91bmRDb2xvcic7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgRG9tTGF5b3V0IH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0RvbUxheW91dCc7XG5pbXBvcnQgeyBEb21FZGl0YWJsZSB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1kb20tZWRpdGFibGUvc3JjL0RvbUVkaXRhYmxlJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vcGFja2FnZXMvY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IElucHV0IH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWlucHV0L3NyYy9JbnB1dCc7XG5pbXBvcnQgeyBEaWFsb2cgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tZGlhbG9nL3NyYy9EaWFsb2cnO1xuXG5pbXBvcnQgdGVtcGxhdGUgZnJvbSAnLi9iYXNpY0xheW91dC54bWwnO1xuaW1wb3J0ICcuL2Jhc2ljTGF5b3V0LmNzcyc7XG5cbmV4cG9ydCBjbGFzcyBCYXNpY0VkaXRvciBleHRlbmRzIEpXRWRpdG9yIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSh7XG4gICAgICAgICAgICBkZWZhdWx0czoge1xuICAgICAgICAgICAgICAgIENvbnRhaW5lcjogUGFyYWdyYXBoTm9kZSxcbiAgICAgICAgICAgICAgICBTZXBhcmF0b3I6IExpbmVCcmVha05vZGUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcGx1Z2luczogW1xuICAgICAgICAgICAgICAgIFtQYXJzZXJdLFxuICAgICAgICAgICAgICAgIFtSZW5kZXJlcl0sXG4gICAgICAgICAgICAgICAgW0xheW91dF0sXG4gICAgICAgICAgICAgICAgW0tleW1hcF0sXG4gICAgICAgICAgICAgICAgW0h0bWxdLFxuICAgICAgICAgICAgICAgIFtEb21MYXlvdXRdLFxuICAgICAgICAgICAgICAgIFtEb21FZGl0YWJsZV0sXG4gICAgICAgICAgICAgICAgLy8gW1xuICAgICAgICAgICAgICAgIC8vICAgICBEb20sXG4gICAgICAgICAgICAgICAgLy8gICAgIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGFmdGVyUmVuZGVyOiAoZWRpdGFibGU6IEhUTUxFbGVtZW50KSA9PiBjb25zb2xlLmxvZygnYWZ0ZXJSZW5kZXInKSxcbiAgICAgICAgICAgICAgICAvLyAgICAgfSxcbiAgICAgICAgICAgICAgICAvLyBdLFxuICAgICAgICAgICAgICAgIFtJbmxpbmVdLFxuICAgICAgICAgICAgICAgIFtDaGFyXSxcbiAgICAgICAgICAgICAgICBbTGluZUJyZWFrXSxcbiAgICAgICAgICAgICAgICBbSGVhZGluZ10sXG4gICAgICAgICAgICAgICAgW1BhcmFncmFwaF0sXG4gICAgICAgICAgICAgICAgW0xpc3RdLFxuICAgICAgICAgICAgICAgIFtJbmRlbnRdLFxuICAgICAgICAgICAgICAgIFtTcGFuXSxcbiAgICAgICAgICAgICAgICBbQm9sZF0sXG4gICAgICAgICAgICAgICAgW0l0YWxpY10sXG4gICAgICAgICAgICAgICAgW1VuZGVybGluZV0sXG4gICAgICAgICAgICAgICAgW0xpbmtdLFxuICAgICAgICAgICAgICAgIFtEaXZpZGVyXSxcbiAgICAgICAgICAgICAgICBbSW1hZ2VdLFxuICAgICAgICAgICAgICAgIFtTdWJzY3JpcHRdLFxuICAgICAgICAgICAgICAgIFtTdXBlcnNjcmlwdF0sXG4gICAgICAgICAgICAgICAgW0Jsb2NrcXVvdGVdLFxuICAgICAgICAgICAgICAgIFtZb3V0dWJlXSxcbiAgICAgICAgICAgICAgICBbVGFibGVdLFxuICAgICAgICAgICAgICAgIFtNZXRhZGF0YV0sXG4gICAgICAgICAgICAgICAgW0FsaWduXSxcbiAgICAgICAgICAgICAgICBbUHJlXSxcbiAgICAgICAgICAgICAgICBbVGV4dENvbG9yXSxcbiAgICAgICAgICAgICAgICBbQmFja2dyb3VuZENvbG9yXSxcbiAgICAgICAgICAgICAgICBbSW5wdXRdLFxuICAgICAgICAgICAgICAgIFtEaWFsb2ddLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY29uZmlndXJlKERvbUxheW91dCwge1xuICAgICAgICAgICAgY29tcG9uZW50czogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6ICdlZGl0b3InLFxuICAgICAgICAgICAgICAgICAgICByZW5kZXIoZWRpdG9yOiBKV0VkaXRvcik6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVkaXRvci5wbHVnaW5zLmdldChQYXJzZXIpLnBhcnNlKCd0ZXh0L2h0bWwnLCB0ZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBjb21wb25lbnRab25lczogW1snZWRpdG9yJywgJ3Jvb3QnXV0sXG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiIsImltcG9ydCBKV0VkaXRvciBmcm9tICcuLi9wYWNrYWdlcy9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgSHRtbCB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1odG1sL3NyYy9IdG1sJztcbmltcG9ydCB7IENoYXIgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tY2hhci9zcmMvQ2hhcic7XG5pbXBvcnQgeyBMaW5lQnJlYWsgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tbGluZWJyZWFrL3NyYy9MaW5lQnJlYWsnO1xuaW1wb3J0IHsgSGVhZGluZyB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1oZWFkaW5nL3NyYy9IZWFkaW5nJztcbmltcG9ydCB7IFBhcmFncmFwaCB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1wYXJhZ3JhcGgvc3JjL1BhcmFncmFwaCc7XG5pbXBvcnQgeyBMaXN0IH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWxpc3Qvc3JjL0xpc3QnO1xuaW1wb3J0IHsgSW5kZW50IH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWluZGVudC9zcmMvSW5kZW50JztcbmltcG9ydCB7IFBhcmFncmFwaE5vZGUgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tcGFyYWdyYXBoL3NyYy9QYXJhZ3JhcGhOb2RlJztcbmltcG9ydCB7IExpbmVCcmVha05vZGUgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tbGluZWJyZWFrL3NyYy9MaW5lQnJlYWtOb2RlJztcbmltcG9ydCB7IFNwYW4gfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tc3Bhbi9zcmMvU3Bhbic7XG5pbXBvcnQgeyBCb2xkIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWJvbGQvc3JjL0JvbGQnO1xuaW1wb3J0IHsgSXRhbGljIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWl0YWxpYy9zcmMvSXRhbGljJztcbmltcG9ydCB7IFVuZGVybGluZSB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi11bmRlcmxpbmUvc3JjL1VuZGVybGluZSc7XG5pbXBvcnQgeyBJbmxpbmUgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmUnO1xuaW1wb3J0IHsgTGluayB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1saW5rL3NyYy9MaW5rJztcbmltcG9ydCB7IERpdmlkZXIgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tZGl2aWRlci9zcmMvRGl2aWRlcic7XG5pbXBvcnQgeyBJbWFnZSB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1pbWFnZS9zcmMvSW1hZ2UnO1xuaW1wb3J0IHsgU3Vic2NyaXB0IH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLXN1YnNjcmlwdC9zcmMvU3Vic2NyaXB0JztcbmltcG9ydCB7IFN1cGVyc2NyaXB0IH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLXN1cGVyc2NyaXB0L3NyYy9TdXBlcnNjcmlwdCc7XG5pbXBvcnQgeyBCbG9ja3F1b3RlIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWJsb2NrcXVvdGUvc3JjL0Jsb2NrcXVvdGUnO1xuaW1wb3J0IHsgWW91dHViZSB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi15b3V0dWJlL3NyYy9Zb3V0dWJlJztcbmltcG9ydCB7IFRhYmxlIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLXRhYmxlL3NyYy9UYWJsZSc7XG5pbXBvcnQgeyBNZXRhZGF0YSB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1tZXRhZGF0YS9zcmMvTWV0YWRhdGEnO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IEtleW1hcCB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5pbXBvcnQgeyBBbGlnbiB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1hbGlnbi9zcmMvQWxpZ24nO1xuaW1wb3J0IHsgUHJlIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLXByZS9zcmMvUHJlJztcbmltcG9ydCB7IFRleHRDb2xvciB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi10ZXh0Y29sb3Ivc3JjL1RleHRDb2xvcic7XG5pbXBvcnQgeyBCYWNrZ3JvdW5kQ29sb3IgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tYmFja2dyb3VuZGNvbG9yL3NyYy9CYWNrZ3JvdW5kQ29sb3InO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IERvbUxheW91dCB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9Eb21MYXlvdXQnO1xuaW1wb3J0IHsgRG9tRWRpdGFibGUgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tZG9tLWVkaXRhYmxlL3NyYy9Eb21FZGl0YWJsZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uL3BhY2thZ2VzL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5cbmltcG9ydCAnLi9iYXNpY0xheW91dC5jc3MnO1xuaW1wb3J0IHsgT2Rvb1NuaXBwZXQgfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby1zbmlwcGV0cy9zcmMvT2Rvb1NuaXBwZXQnO1xuXG5pbXBvcnQgeyBUb29sYmFyIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLXRvb2xiYXIvc3JjL1Rvb2xiYXInO1xuaW1wb3J0IHsgUGFyYWdyYXBoQnV0dG9uIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWhlYWRpbmcvc3JjL0hlYWRpbmdCdXR0b25zJztcbmltcG9ydCB7IEhlYWRpbmcxQnV0dG9uIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWhlYWRpbmcvc3JjL0hlYWRpbmdCdXR0b25zJztcbmltcG9ydCB7IEhlYWRpbmcyQnV0dG9uIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWhlYWRpbmcvc3JjL0hlYWRpbmdCdXR0b25zJztcbmltcG9ydCB7IEhlYWRpbmczQnV0dG9uIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWhlYWRpbmcvc3JjL0hlYWRpbmdCdXR0b25zJztcbmltcG9ydCB7IEhlYWRpbmc0QnV0dG9uIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWhlYWRpbmcvc3JjL0hlYWRpbmdCdXR0b25zJztcbmltcG9ydCB7IEhlYWRpbmc1QnV0dG9uIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWhlYWRpbmcvc3JjL0hlYWRpbmdCdXR0b25zJztcbmltcG9ydCB7IEhlYWRpbmc2QnV0dG9uIH0gZnJvbSAnLi4vcGFja2FnZXMvcGx1Z2luLWhlYWRpbmcvc3JjL0hlYWRpbmdCdXR0b25zJztcbmltcG9ydCB7IFByZUJ1dHRvbiB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1wcmUvc3JjL1ByZUJ1dHRvbnMnO1xuaW1wb3J0IHsgQm9sZEJ1dHRvbiB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1ib2xkL3NyYy9Cb2xkQnV0dG9ucyc7XG5pbXBvcnQgeyBJdGFsaWNCdXR0b24gfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4taXRhbGljL3NyYy9JdGFsaWNCdXR0b25zJztcbmltcG9ydCB7IFVuZGVybGluZUJ1dHRvbiB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi11bmRlcmxpbmUvc3JjL1VuZGVybGluZUJ1dHRvbnMnO1xuaW1wb3J0IHsgT3JkZXJlZExpc3RCdXR0b24gfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tbGlzdC9zcmMvTGlzdEJ1dHRvbnMnO1xuaW1wb3J0IHsgVW5vcmRlcmVkTGlzdEJ1dHRvbiB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1saXN0L3NyYy9MaXN0QnV0dG9ucyc7XG5pbXBvcnQgeyBJbmRlbnRCdXR0b24gfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4taW5kZW50L3NyYy9JbmRlbnRCdXR0b25zJztcbmltcG9ydCB7IE91dGRlbnRCdXR0b24gfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4taW5kZW50L3NyYy9JbmRlbnRCdXR0b25zJztcbmltcG9ydCB7IFNhdmVCdXR0b24gfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby1zbmlwcGV0cy9zcmMvU2F2ZUJ1dHRvbic7XG5pbXBvcnQgeyBIdG1sTm9kZSB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1odG1sL3NyYy9IdG1sTm9kZSc7XG5pbXBvcnQgeyBNZWRpYUJ1dHRvbiB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1vZG9vLXNuaXBwZXRzL3NyYy9NZWRpYUJ1dHRvbic7XG5pbXBvcnQgeyBDb21tYW5kSW1wbGVtZW50YXRpb24sIENvbW1hbmRJZGVudGlmaWVyIH0gZnJvbSAnLi4vcGFja2FnZXMvY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBKV1BsdWdpbiB9IGZyb20gJy4uL3BhY2thZ2VzL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IE9kb29WaWRlbyB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi12aWRlby9zcmMvT2Rvb1ZpZGVvJztcbmltcG9ydCB7IExpbmtCdXR0b24gfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tb2Rvby1zbmlwcGV0cy9zcmMvTGlua0J1dHRvbic7XG5pbXBvcnQgeyBEb21ab25lUG9zaXRpb24gfSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXRFbmdpbmUnO1xuaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uL3BhY2thZ2VzL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7XG4gICAgQWxpZ25MZWZ0QnV0dG9uLFxuICAgIEFsaWduQ2VudGVyQnV0dG9uLFxuICAgIEFsaWduUmlnaHRCdXR0b24sXG4gICAgQWxpZ25KdXN0aWZ5QnV0dG9uLFxufSBmcm9tICcuLi9wYWNrYWdlcy9wbHVnaW4tYWxpZ24vc3JjL0FsaWduQnV0dG9ucyc7XG5cbmludGVyZmFjZSBPZG9vV2Vic2l0ZUVkaXRvck9wdGlvbiB7XG4gICAgc291cmNlOiBIVE1MRWxlbWVudDtcbiAgICBsb2NhdGlvbjogW05vZGUsIERvbVpvbmVQb3NpdGlvbl07XG4gICAgY3VzdG9tQ29tbWFuZHM6IFJlY29yZDxDb21tYW5kSWRlbnRpZmllciwgQ29tbWFuZEltcGxlbWVudGF0aW9uPjtcbiAgICBhZnRlclJlbmRlcj86IEZ1bmN0aW9uO1xuICAgIHNuaXBwZXRNZW51RWxlbWVudD86IEhUTUxFbGVtZW50O1xuICAgIHNuaXBwZXRNYW5pcHVsYXRvcnM/OiBIVE1MRWxlbWVudDtcbiAgICB0ZW1wbGF0ZT86IHN0cmluZztcbiAgICAvLyB0b2RvOiBSZW1vdmUgd2hlbiBjb25maWd1cmluZyB0aGUgdG9vbGJhciBpbiBhbm90aGVyIHdheS5cbiAgICBzYXZlQnV0dG9uPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIE9kb29XZWJzaXRlRWRpdG9yIGV4dGVuZHMgSldFZGl0b3Ige1xuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnM6IE9kb29XZWJzaXRlRWRpdG9yT3B0aW9uKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIGNsYXNzIEN1c3RvbVBsdWdpbiBleHRlbmRzIEpXUGx1Z2luIHtcbiAgICAgICAgICAgIGNvbW1hbmRzID0gb3B0aW9ucy5jdXN0b21Db21tYW5kcztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY29uZmlndXJlKHtcbiAgICAgICAgICAgIGRlZmF1bHRzOiB7XG4gICAgICAgICAgICAgICAgQ29udGFpbmVyOiBQYXJhZ3JhcGhOb2RlLFxuICAgICAgICAgICAgICAgIFNlcGFyYXRvcjogTGluZUJyZWFrTm9kZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBwbHVnaW5zOiBbXG4gICAgICAgICAgICAgICAgW1BhcnNlcl0sXG4gICAgICAgICAgICAgICAgW1JlbmRlcmVyXSxcbiAgICAgICAgICAgICAgICBbTGF5b3V0XSxcbiAgICAgICAgICAgICAgICBbS2V5bWFwXSxcbiAgICAgICAgICAgICAgICBbSHRtbF0sXG4gICAgICAgICAgICAgICAgW0lubGluZV0sXG4gICAgICAgICAgICAgICAgW0NoYXJdLFxuICAgICAgICAgICAgICAgIFtMaW5lQnJlYWtdLFxuICAgICAgICAgICAgICAgIFtIZWFkaW5nXSxcbiAgICAgICAgICAgICAgICBbUGFyYWdyYXBoXSxcbiAgICAgICAgICAgICAgICBbTGlzdF0sXG4gICAgICAgICAgICAgICAgW0luZGVudF0sXG4gICAgICAgICAgICAgICAgW1NwYW5dLFxuICAgICAgICAgICAgICAgIFtCb2xkXSxcbiAgICAgICAgICAgICAgICBbSXRhbGljXSxcbiAgICAgICAgICAgICAgICBbVW5kZXJsaW5lXSxcbiAgICAgICAgICAgICAgICBbTGlua10sXG4gICAgICAgICAgICAgICAgW0RpdmlkZXJdLFxuICAgICAgICAgICAgICAgIFtJbWFnZV0sXG4gICAgICAgICAgICAgICAgW1N1YnNjcmlwdF0sXG4gICAgICAgICAgICAgICAgW1N1cGVyc2NyaXB0XSxcbiAgICAgICAgICAgICAgICBbQmxvY2txdW90ZV0sXG4gICAgICAgICAgICAgICAgW1lvdXR1YmVdLFxuICAgICAgICAgICAgICAgIFtUYWJsZV0sXG4gICAgICAgICAgICAgICAgW01ldGFkYXRhXSxcbiAgICAgICAgICAgICAgICBbQWxpZ25dLFxuICAgICAgICAgICAgICAgIFtQcmVdLFxuICAgICAgICAgICAgICAgIFtUZXh0Q29sb3JdLFxuICAgICAgICAgICAgICAgIFtCYWNrZ3JvdW5kQ29sb3JdLFxuICAgICAgICAgICAgICAgIFtPZG9vU25pcHBldF0sXG4gICAgICAgICAgICAgICAgLy8gW01lZGlhRGlhbG9nXSxcbiAgICAgICAgICAgICAgICBbT2Rvb1ZpZGVvXSxcbiAgICAgICAgICAgICAgICBbQ3VzdG9tUGx1Z2luXSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvbmZpZ3VyZShUb29sYmFyLCB7XG4gICAgICAgICAgICBsYXlvdXQ6IFtcbiAgICAgICAgICAgICAgICBbXG4gICAgICAgICAgICAgICAgICAgIFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhcmFncmFwaEJ1dHRvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIEhlYWRpbmcxQnV0dG9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgSGVhZGluZzJCdXR0b24sXG4gICAgICAgICAgICAgICAgICAgICAgICBIZWFkaW5nM0J1dHRvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIEhlYWRpbmc0QnV0dG9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgSGVhZGluZzVCdXR0b24sXG4gICAgICAgICAgICAgICAgICAgICAgICBIZWFkaW5nNkJ1dHRvbixcbiAgICAgICAgICAgICAgICAgICAgICAgIFByZUJ1dHRvbixcbiAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgICAgIFtCb2xkQnV0dG9uLCBJdGFsaWNCdXR0b24sIFVuZGVybGluZUJ1dHRvbl0sXG4gICAgICAgICAgICAgICAgW0FsaWduTGVmdEJ1dHRvbiwgQWxpZ25DZW50ZXJCdXR0b24sIEFsaWduUmlnaHRCdXR0b24sIEFsaWduSnVzdGlmeUJ1dHRvbl0sXG4gICAgICAgICAgICAgICAgW09yZGVyZWRMaXN0QnV0dG9uLCBVbm9yZGVyZWRMaXN0QnV0dG9uXSxcbiAgICAgICAgICAgICAgICBbSW5kZW50QnV0dG9uLCBPdXRkZW50QnV0dG9uXSxcbiAgICAgICAgICAgICAgICBbTGlua0J1dHRvbl0sXG4gICAgICAgICAgICAgICAgW01lZGlhQnV0dG9uXSxcbiAgICAgICAgICAgICAgICAuLi4ob3B0aW9ucy5zYXZlQnV0dG9uID8gW1tTYXZlQnV0dG9uXV0gOiBbXSksXG4gICAgICAgICAgICBdLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBkZWZhdWx0VGVtcGxhdGUgPSBgXG4gICAgICAgIDx0IHQtem9uZT1cImZsb2F0XCIvPlxuICAgICAgICA8dCB0LXpvbmU9XCJkZWZhdWx0XCIvPlxuICAgICAgICA8ZGl2IGNsYXNzPVwid3JhcF9lZGl0b3IgZC1mbGV4IGZsZXgtY29sdW1uXCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiZC1mbGV4IGZsZXgtcm93IG92ZXJmbG93LWF1dG9cIj5cbiAgICAgICAgICAgICAgICA8dCB0LXpvbmU9XCJtYWluX3NpZGViYXJcIi8+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImQtZmxleCBmbGV4LWNvbHVtbiBvdmVyZmxvdy1hdXRvIG9fZWRpdG9yX2NlbnRlclwiPlxuICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwib190b29sYmFyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8dCB0LXpvbmU9XCJ0b29sc1wiLz5cbiAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJkLWZsZXggb3ZlcmZsb3ctYXV0b1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC16b25lPVwic25pcHBldE1hbmlwdWxhdG9yc1wiLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtem9uZT1cIm1haW5cIi8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwib19kZWJ1Z196b25lXCI+XG4gICAgICAgICAgICAgICAgPHQgdC16b25lPVwiZGVidWdcIi8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgYDtcbiAgICAgICAgdGhpcy5jb25maWd1cmUoRG9tTGF5b3V0LCB7XG4gICAgICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBpZDogJ21haW5fdGVtcGxhdGUnLFxuICAgICAgICAgICAgICAgICAgICByZW5kZXIoZWRpdG9yOiBKV0VkaXRvcik6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVkaXRvci5wbHVnaW5zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmdldChQYXJzZXIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBhcnNlKCd0ZXh0L2h0bWwnLCBvcHRpb25zLnRlbXBsYXRlIHx8IGRlZmF1bHRUZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAnc25pcHBldF9tZW51JyxcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyKCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZTogVk5vZGUgPSBvcHRpb25zLnNuaXBwZXRNZW51RWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gbmV3IEh0bWxOb2RlKHsgZG9tTm9kZTogb3B0aW9ucy5zbmlwcGV0TWVudUVsZW1lbnQgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG5ldyBMaW5lQnJlYWtOb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtub2RlXSk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlkOiAnc25pcHBldE1hbmlwdWxhdG9ycycsXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcigpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGU6IFZOb2RlID0gb3B0aW9ucy5zbmlwcGV0TWVudUVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IG5ldyBIdG1sTm9kZSh7IGRvbU5vZGU6IG9wdGlvbnMuc25pcHBldE1hbmlwdWxhdG9ycyB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbmV3IExpbmVCcmVha05vZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW25vZGVdKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIGNvbXBvbmVudFpvbmVzOiBbXG4gICAgICAgICAgICAgICAgWydtYWluX3RlbXBsYXRlJywgJ3Jvb3QnXSxcbiAgICAgICAgICAgICAgICBbJ3NuaXBwZXRfbWVudScsICdtYWluX3NpZGViYXInXSxcbiAgICAgICAgICAgICAgICBbJ3NuaXBwZXRNYW5pcHVsYXRvcnMnLCAnc25pcHBldE1hbmlwdWxhdG9ycyddLFxuICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIGxvY2F0aW9uOiBvcHRpb25zLmxvY2F0aW9uLFxuICAgICAgICAgICAgYWZ0ZXJSZW5kZXI6IG9wdGlvbnMuYWZ0ZXJSZW5kZXIsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmNvbmZpZ3VyZShEb21FZGl0YWJsZSwge1xuICAgICAgICAgICAgYXV0b0ZvY3VzOiB0cnVlLFxuICAgICAgICAgICAgc291cmNlOiBvcHRpb25zLnNvdXJjZS5maXJzdEVsZW1lbnRDaGlsZCBhcyBIVE1MRWxlbWVudCxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSB2YWx1ZSBieSByZW5kZXJpbmcgdGhlIFwiZWRpdGFibGVcIiBjb21wb25lbnQgb2YgdGhlIGVkaXRvci5cbiAgICAgKi9cbiAgICBhc3luYyBnZXRWYWx1ZSgpOiBQcm9taXNlPE5vZGU+IHtcbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSB0aGlzLnBsdWdpbnMuZ2V0KFJlbmRlcmVyKTtcbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5wbHVnaW5zLmdldChMYXlvdXQpO1xuICAgICAgICBjb25zdCBkb21MYXlvdXQgPSBsYXlvdXQuZW5naW5lcy5kb207XG4gICAgICAgIGNvbnN0IGRvbVJlbmRlcmluZ0VuZ2luZSA9IHJlbmRlcmVyLmVuZ2luZXNbXG4gICAgICAgICAgICBIdG1sRG9tUmVuZGVyaW5nRW5naW5lLmlkXG4gICAgICAgIF0gYXMgSHRtbERvbVJlbmRlcmluZ0VuZ2luZTtcbiAgICAgICAgY29uc3QgZWRpdGFibGUgPSBkb21MYXlvdXQuY29tcG9uZW50cy5nZXQoJ2VkaXRhYmxlJylbMF07XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgZG9tUmVuZGVyaW5nRW5naW5lLnJlbmRlcihlZGl0YWJsZSk7XG4gICAgICAgIHJldHVybiBub2Rlc1swXTtcbiAgICB9XG59XG4iLCJ2YXIgYXBpID0gcmVxdWlyZShcIiEuLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIik7XG4gICAgICAgICAgICB2YXIgY29udGVudCA9IHJlcXVpcmUoXCIhIS4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vYmFzaWNMYXlvdXQuY3NzXCIpO1xuXG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5fX2VzTW9kdWxlID8gY29udGVudC5kZWZhdWx0IDogY29udGVudDtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG4gICAgICAgICAgICB9XG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuaW5zZXJ0ID0gXCJoZWFkXCI7XG5vcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuXG52YXIgdXBkYXRlID0gYXBpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG52YXIgZXhwb3J0ZWQgPSBjb250ZW50LmxvY2FscyA/IGNvbnRlbnQubG9jYWxzIDoge307XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydGVkOyIsIm1vZHVsZS5leHBvcnRzID0gXCI8anctZWRpdG9yPlxcbiAgICA8dCB0LXpvbmU9XFxcInJhbmdlXFxcIi8+XFxuICAgIDxqdy1oZWFkZXI+PHQgdC16b25lPVxcXCJ0b29sc1xcXCIvPjwvanctaGVhZGVyPlxcbiAgICA8anctYm9keT48dCB0LXpvbmU9XFxcIm1haW5cXFwiLz48L2p3LWJvZHk+XFxuICAgIDxqdy1mb290ZXI+XFxuICAgICAgICA8dCB0LXpvbmU9XFxcInN0YXR1c1xcXCIvPlxcbiAgICA8L2p3LWZvb3Rlcj5cXG4gICAgPHQtZGlhbG9nPlxcbiAgICAgICAgPHQgdC16b25lPVxcXCJkaWFsb2dcXFwiLz5cXG4gICAgICAgIDx0IHQtem9uZT1cXFwiZGVmYXVsdFxcXCIvPlxcbiAgICA8L3QtZGlhbG9nPlxcbiAgICA8dCB0LXpvbmU9XFxcImRlYnVnXFxcIi8+XFxuPC9qdy1lZGl0b3I+XFxuXCIiLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG5cbi8qKlxyXG4gKiBXZSBkZWZpbmUgaGVyZSBhIHNpbXBsZSBldmVudCBidXM6IGl0IGNhblxyXG4gKiAtIGVtaXQgZXZlbnRzXHJcbiAqIC0gYWRkL3JlbW92ZSBsaXN0ZW5lcnMuXHJcbiAqXHJcbiAqIFRoaXMgaXMgYSB1c2VmdWwgcGF0dGVybiBvZiBjb21tdW5pY2F0aW9uIGluIG1hbnkgY2FzZXMuICBGb3IgT1dMLCBlYWNoXHJcbiAqIGNvbXBvbmVudHMgYW5kIHN0b3JlcyBhcmUgZXZlbnQgYnVzZXMuXHJcbiAqL1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBFdmVudEJ1c1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5jbGFzcyBFdmVudEJ1cyB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSB7fTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWRkIGEgbGlzdGVuZXIgZm9yIHRoZSAnZXZlbnRUeXBlJyBldmVudHMuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IHRoZSAnb3duZXInIG9mIHRoaXMgZXZlbnQgY2FuIGJlIGFueXRoaW5nLCBidXQgd2lsbCBtb3JlIGxpa2VseVxyXG4gICAgICogYmUgYSBjb21wb25lbnQgb3IgYSBjbGFzcy4gVGhlIGlkZWEgaXMgdGhhdCB0aGUgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQgd2l0aFxyXG4gICAgICogdGhlIHByb3BlciBvd25lciBib3VuZC5cclxuICAgICAqXHJcbiAgICAgKiBBbHNvLCB0aGUgb3duZXIgc2hvdWxkIGJlIGtpbmQgb2YgdW5pcXVlLiBUaGlzIHdpbGwgYmUgdXNlZCB0byByZW1vdmUgdGhlXHJcbiAgICAgKiBsaXN0ZW5lci5cclxuICAgICAqL1xyXG4gICAgb24oZXZlbnRUeXBlLCBvd25lciwgY2FsbGJhY2spIHtcclxuICAgICAgICBpZiAoIWNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgY2FsbGJhY2tcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV0pIHtcclxuICAgICAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV0gPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV0ucHVzaCh7XHJcbiAgICAgICAgICAgIG93bmVyLFxyXG4gICAgICAgICAgICBjYWxsYmFja1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgYSBsaXN0ZW5lclxyXG4gICAgICovXHJcbiAgICBvZmYoZXZlbnRUeXBlLCBvd25lcikge1xyXG4gICAgICAgIGNvbnN0IHN1YnMgPSB0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnRUeXBlXTtcclxuICAgICAgICBpZiAoc3Vicykge1xyXG4gICAgICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnNbZXZlbnRUeXBlXSA9IHN1YnMuZmlsdGVyKHMgPT4gcy5vd25lciAhPT0gb3duZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRW1pdCBhbiBldmVudCBvZiB0eXBlICdldmVudFR5cGUnLiAgQW55IGV4dHJhIGFyZ3VtZW50cyB3aWxsIGJlIHBhc3NlZCB0b1xyXG4gICAgICogdGhlIGxpc3RlbmVycyBjYWxsYmFjay5cclxuICAgICAqL1xyXG4gICAgdHJpZ2dlcihldmVudFR5cGUsIC4uLmFyZ3MpIHtcclxuICAgICAgICBjb25zdCBzdWJzID0gdGhpcy5zdWJzY3JpcHRpb25zW2V2ZW50VHlwZV0gfHwgW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlMZW4gPSBzdWJzLmxlbmd0aDsgaSA8IGlMZW47IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBzdWIgPSBzdWJzW2ldO1xyXG4gICAgICAgICAgICBzdWIuY2FsbGJhY2suY2FsbChzdWIub3duZXIsIC4uLmFyZ3MpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlIGFsbCBzdWJzY3JpcHRpb25zLlxyXG4gICAgICovXHJcbiAgICBjbGVhcigpIHtcclxuICAgICAgICB0aGlzLnN1YnNjcmlwdGlvbnMgPSB7fTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogT3dsIE9ic2VydmVyXHJcbiAqXHJcbiAqIFRoaXMgY29kZSBjb250YWlucyB0aGUgbG9naWMgdGhhdCBhbGxvd3MgT3dsIHRvIG9ic2VydmUgYW5kIHJlYWN0IHRvIHN0YXRlXHJcbiAqIGNoYW5nZXMuXHJcbiAqXHJcbiAqIFRoaXMgaXMgYSBPYnNlcnZlciBjbGFzcyB0aGF0IGNhbiBvYnNlcnZlIGFueSBKUyB2YWx1ZXMuICBUaGUgd2F5IGl0IHdvcmtzXHJcbiAqIGNhbiBiZSBzdW1tYXJpemVkIHRodXNseTpcclxuICogLSBwcmltaXRpdmUgdmFsdWVzIGFyZSBub3Qgb2JzZXJ2ZWQgYXQgYWxsXHJcbiAqIC0gT2JqZWN0cyBhbmQgYXJyYXlzIGFyZSBvYnNlcnZlZCBieSByZXBsYWNpbmcgdGhlbSB3aXRoIGEgUHJveHlcclxuICogLSBlYWNoIG9iamVjdC9hcnJheSBtZXRhZGF0YSBhcmUgdHJhY2tlZCBpbiBhIHdlYWttYXAsIGFuZCBrZWVwIGEgcmV2aXNpb25cclxuICogICBudW1iZXJcclxuICpcclxuICogTm90ZSB0aGF0IHRoaXMgY29kZSBpcyBsb29zZWx5IGluc3BpcmVkIGJ5IFZ1ZS5cclxuICovXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIE9ic2VydmVyXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNsYXNzIE9ic2VydmVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMucmV2ID0gMTtcclxuICAgICAgICB0aGlzLmFsbG93TXV0YXRpb25zID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLndlYWtNYXAgPSBuZXcgV2Vha01hcCgpO1xyXG4gICAgfVxyXG4gICAgbm90aWZ5Q0IoKSB7IH1cclxuICAgIG9ic2VydmUodmFsdWUsIHBhcmVudCkge1xyXG4gICAgICAgIGlmICh2YWx1ZSA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsdWUgIT09IFwib2JqZWN0XCIgfHwgdmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICAgICAgICAgIC8vIGZ1biBmYWN0OiB0eXBlb2YgbnVsbCA9PT0gJ29iamVjdCdcclxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbWV0YWRhdGEgPSB0aGlzLndlYWtNYXAuZ2V0KHZhbHVlKSB8fCB0aGlzLl9vYnNlcnZlKHZhbHVlLCBwYXJlbnQpO1xyXG4gICAgICAgIHJldHVybiBtZXRhZGF0YS5wcm94eTtcclxuICAgIH1cclxuICAgIHJldk51bWJlcih2YWx1ZSkge1xyXG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0gdGhpcy53ZWFrTWFwLmdldCh2YWx1ZSk7XHJcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhID8gbWV0YWRhdGEucmV2IDogMDtcclxuICAgIH1cclxuICAgIF9vYnNlcnZlKHZhbHVlLCBwYXJlbnQpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkodmFsdWUsIHtcclxuICAgICAgICAgICAgZ2V0KHRhcmdldCwgaykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0VmFsdWUgPSB0YXJnZXRba107XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5vYnNlcnZlKHRhcmdldFZhbHVlLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHNldCh0YXJnZXQsIGtleSwgbmV3VmFsKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRhcmdldFtrZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5ld1ZhbCAhPT0gdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGYuYWxsb3dNdXRhdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBPYnNlcnZlZCBzdGF0ZSBjYW5ub3QgYmUgY2hhbmdlZCBoZXJlISAoa2V5OiBcIiR7a2V5fVwiLCB2YWw6IFwiJHtuZXdWYWx9XCIpYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3VwZGF0ZVJldk51bWJlcih0YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldFtrZXldID0gbmV3VmFsO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubm90aWZ5Q0IoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBkZWxldGVQcm9wZXJ0eSh0YXJnZXQsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGtleSBpbiB0YXJnZXQpIHtcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdGFyZ2V0W2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fdXBkYXRlUmV2TnVtYmVyKHRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5ub3RpZnlDQigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zdCBtZXRhZGF0YSA9IHtcclxuICAgICAgICAgICAgdmFsdWUsXHJcbiAgICAgICAgICAgIHByb3h5LFxyXG4gICAgICAgICAgICByZXY6IHRoaXMucmV2LFxyXG4gICAgICAgICAgICBwYXJlbnRcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMud2Vha01hcC5zZXQodmFsdWUsIG1ldGFkYXRhKTtcclxuICAgICAgICB0aGlzLndlYWtNYXAuc2V0KG1ldGFkYXRhLnByb3h5LCBtZXRhZGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIG1ldGFkYXRhO1xyXG4gICAgfVxyXG4gICAgX3VwZGF0ZVJldk51bWJlcih0YXJnZXQpIHtcclxuICAgICAgICB0aGlzLnJldisrO1xyXG4gICAgICAgIGxldCBtZXRhZGF0YSA9IHRoaXMud2Vha01hcC5nZXQodGFyZ2V0KTtcclxuICAgICAgICBsZXQgcGFyZW50ID0gdGFyZ2V0O1xyXG4gICAgICAgIGRvIHtcclxuICAgICAgICAgICAgbWV0YWRhdGEgPSB0aGlzLndlYWtNYXAuZ2V0KHBhcmVudCk7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLnJldisrO1xyXG4gICAgICAgIH0gd2hpbGUgKChwYXJlbnQgPSBtZXRhZGF0YS5wYXJlbnQpICYmIHBhcmVudCAhPT0gdGFyZ2V0KTtcclxuICAgIH1cclxufVxuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBtb2R1bGUvcHJvcHMudHNcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuZnVuY3Rpb24gdXBkYXRlUHJvcHMob2xkVm5vZGUsIHZub2RlKSB7XHJcbiAgICB2YXIga2V5LCBjdXIsIG9sZCwgZWxtID0gdm5vZGUuZWxtLCBvbGRQcm9wcyA9IG9sZFZub2RlLmRhdGEucHJvcHMsIHByb3BzID0gdm5vZGUuZGF0YS5wcm9wcztcclxuICAgIGlmICghb2xkUHJvcHMgJiYgIXByb3BzKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGlmIChvbGRQcm9wcyA9PT0gcHJvcHMpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgb2xkUHJvcHMgPSBvbGRQcm9wcyB8fCB7fTtcclxuICAgIHByb3BzID0gcHJvcHMgfHwge307XHJcbiAgICBmb3IgKGtleSBpbiBvbGRQcm9wcykge1xyXG4gICAgICAgIGlmICghcHJvcHNba2V5XSkge1xyXG4gICAgICAgICAgICBkZWxldGUgZWxtW2tleV07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yIChrZXkgaW4gcHJvcHMpIHtcclxuICAgICAgICBjdXIgPSBwcm9wc1trZXldO1xyXG4gICAgICAgIG9sZCA9IG9sZFByb3BzW2tleV07XHJcbiAgICAgICAgaWYgKG9sZCAhPT0gY3VyICYmIChrZXkgIT09IFwidmFsdWVcIiB8fCBlbG1ba2V5XSAhPT0gY3VyKSkge1xyXG4gICAgICAgICAgICBlbG1ba2V5XSA9IGN1cjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuY29uc3QgcHJvcHNNb2R1bGUgPSB7XHJcbiAgICBjcmVhdGU6IHVwZGF0ZVByb3BzLFxyXG4gICAgdXBkYXRlOiB1cGRhdGVQcm9wc1xyXG59O1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBtb2R1bGUvZXZlbnRsaXN0ZW5lcnMudHNcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuZnVuY3Rpb24gaW52b2tlSGFuZGxlcihoYW5kbGVyLCB2bm9kZSwgZXZlbnQpIHtcclxuICAgIGlmICh0eXBlb2YgaGFuZGxlciA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgLy8gY2FsbCBmdW5jdGlvbiBoYW5kbGVyXHJcbiAgICAgICAgaGFuZGxlci5jYWxsKHZub2RlLCBldmVudCwgdm5vZGUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAodHlwZW9mIGhhbmRsZXIgPT09IFwib2JqZWN0XCIpIHtcclxuICAgICAgICAvLyBjYWxsIGhhbmRsZXIgd2l0aCBhcmd1bWVudHNcclxuICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXJbMF0gPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgICAgICAvLyBzcGVjaWFsIGNhc2UgZm9yIHNpbmdsZSBhcmd1bWVudCBmb3IgcGVyZm9ybWFuY2VcclxuICAgICAgICAgICAgaWYgKGhhbmRsZXIubGVuZ3RoID09PSAyKSB7XHJcbiAgICAgICAgICAgICAgICBoYW5kbGVyWzBdLmNhbGwodm5vZGUsIGhhbmRsZXJbMV0sIGV2ZW50LCB2bm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IGhhbmRsZXIuc2xpY2UoMSk7XHJcbiAgICAgICAgICAgICAgICBhcmdzLnB1c2goZXZlbnQpO1xyXG4gICAgICAgICAgICAgICAgYXJncy5wdXNoKHZub2RlKTtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXJbMF0uYXBwbHkodm5vZGUsIGFyZ3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBjYWxsIG11bHRpcGxlIGhhbmRsZXJzXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBpTGVuID0gaGFuZGxlci5sZW5ndGg7IGkgPCBpTGVuOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGludm9rZUhhbmRsZXIoaGFuZGxlcltpXSwgdm5vZGUsIGV2ZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBoYW5kbGVFdmVudChldmVudCwgdm5vZGUpIHtcclxuICAgIHZhciBuYW1lID0gZXZlbnQudHlwZSwgb24gPSB2bm9kZS5kYXRhLm9uO1xyXG4gICAgLy8gY2FsbCBldmVudCBoYW5kbGVyKHMpIGlmIGV4aXN0c1xyXG4gICAgaWYgKG9uKSB7XHJcbiAgICAgICAgaWYgKG9uW25hbWVdKSB7XHJcbiAgICAgICAgICAgIGludm9rZUhhbmRsZXIob25bbmFtZV0sIHZub2RlLCBldmVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG9uW1wiIVwiICsgbmFtZV0pIHtcclxuICAgICAgICAgICAgaW52b2tlSGFuZGxlcihvbltcIiFcIiArIG5hbWVdLCB2bm9kZSwgZXZlbnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBjcmVhdGVMaXN0ZW5lcigpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiBoYW5kbGVyKGV2ZW50KSB7XHJcbiAgICAgICAgaGFuZGxlRXZlbnQoZXZlbnQsIGhhbmRsZXIudm5vZGUpO1xyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiB1cGRhdGVFdmVudExpc3RlbmVycyhvbGRWbm9kZSwgdm5vZGUpIHtcclxuICAgIHZhciBvbGRPbiA9IG9sZFZub2RlLmRhdGEub24sIG9sZExpc3RlbmVyID0gb2xkVm5vZGUubGlzdGVuZXIsIG9sZEVsbSA9IG9sZFZub2RlLmVsbSwgb24gPSB2bm9kZSAmJiB2bm9kZS5kYXRhLm9uLCBlbG0gPSAodm5vZGUgJiYgdm5vZGUuZWxtKSwgbmFtZTtcclxuICAgIC8vIG9wdGltaXphdGlvbiBmb3IgcmV1c2VkIGltbXV0YWJsZSBoYW5kbGVyc1xyXG4gICAgaWYgKG9sZE9uID09PSBvbikge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIC8vIHJlbW92ZSBleGlzdGluZyBsaXN0ZW5lcnMgd2hpY2ggbm8gbG9uZ2VyIHVzZWRcclxuICAgIGlmIChvbGRPbiAmJiBvbGRMaXN0ZW5lcikge1xyXG4gICAgICAgIC8vIGlmIGVsZW1lbnQgY2hhbmdlZCBvciBkZWxldGVkIHdlIHJlbW92ZSBhbGwgZXhpc3RpbmcgbGlzdGVuZXJzIHVuY29uZGl0aW9uYWxseVxyXG4gICAgICAgIGlmICghb24pIHtcclxuICAgICAgICAgICAgZm9yIChuYW1lIGluIG9sZE9uKSB7XHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgbGlzdGVuZXIgaWYgZWxlbWVudCB3YXMgY2hhbmdlZCBvciBleGlzdGluZyBsaXN0ZW5lcnMgcmVtb3ZlZFxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FwdHVyZSA9IG5hbWUuY2hhckF0KDApID09PSBcIiFcIjtcclxuICAgICAgICAgICAgICAgIG5hbWUgPSBjYXB0dXJlID8gbmFtZS5zbGljZSgxKSA6IG5hbWU7XHJcbiAgICAgICAgICAgICAgICBvbGRFbG0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihuYW1lLCBvbGRMaXN0ZW5lciwgY2FwdHVyZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAobmFtZSBpbiBvbGRPbikge1xyXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGxpc3RlbmVyIGlmIGV4aXN0aW5nIGxpc3RlbmVyIHJlbW92ZWRcclxuICAgICAgICAgICAgICAgIGlmICghb25bbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjYXB0dXJlID0gbmFtZS5jaGFyQXQoMCkgPT09IFwiIVwiO1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgPSBjYXB0dXJlID8gbmFtZS5zbGljZSgxKSA6IG5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgb2xkRWxtLnJlbW92ZUV2ZW50TGlzdGVuZXIobmFtZSwgb2xkTGlzdGVuZXIsIGNhcHR1cmUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLy8gYWRkIG5ldyBsaXN0ZW5lcnMgd2hpY2ggaGFzIG5vdCBhbHJlYWR5IGF0dGFjaGVkXHJcbiAgICBpZiAob24pIHtcclxuICAgICAgICAvLyByZXVzZSBleGlzdGluZyBsaXN0ZW5lciBvciBjcmVhdGUgbmV3XHJcbiAgICAgICAgdmFyIGxpc3RlbmVyID0gKHZub2RlLmxpc3RlbmVyID0gb2xkVm5vZGUubGlzdGVuZXIgfHwgY3JlYXRlTGlzdGVuZXIoKSk7XHJcbiAgICAgICAgLy8gdXBkYXRlIHZub2RlIGZvciBsaXN0ZW5lclxyXG4gICAgICAgIGxpc3RlbmVyLnZub2RlID0gdm5vZGU7XHJcbiAgICAgICAgLy8gaWYgZWxlbWVudCBjaGFuZ2VkIG9yIGFkZGVkIHdlIGFkZCBhbGwgbmVlZGVkIGxpc3RlbmVycyB1bmNvbmRpdGlvbmFsbHlcclxuICAgICAgICBpZiAoIW9sZE9uKSB7XHJcbiAgICAgICAgICAgIGZvciAobmFtZSBpbiBvbikge1xyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGxpc3RlbmVyIGlmIGVsZW1lbnQgd2FzIGNoYW5nZWQgb3IgbmV3IGxpc3RlbmVycyBhZGRlZFxyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FwdHVyZSA9IG5hbWUuY2hhckF0KDApID09PSBcIiFcIjtcclxuICAgICAgICAgICAgICAgIG5hbWUgPSBjYXB0dXJlID8gbmFtZS5zbGljZSgxKSA6IG5hbWU7XHJcbiAgICAgICAgICAgICAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBsaXN0ZW5lciwgY2FwdHVyZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZvciAobmFtZSBpbiBvbikge1xyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGxpc3RlbmVyIGlmIG5ldyBsaXN0ZW5lciBhZGRlZFxyXG4gICAgICAgICAgICAgICAgaWYgKCFvbGRPbltuYW1lXSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNhcHR1cmUgPSBuYW1lLmNoYXJBdCgwKSA9PT0gXCIhXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGNhcHR1cmUgPyBuYW1lLnNsaWNlKDEpIDogbmFtZTtcclxuICAgICAgICAgICAgICAgICAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcihuYW1lLCBsaXN0ZW5lciwgY2FwdHVyZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuY29uc3QgZXZlbnRMaXN0ZW5lcnNNb2R1bGUgPSB7XHJcbiAgICBjcmVhdGU6IHVwZGF0ZUV2ZW50TGlzdGVuZXJzLFxyXG4gICAgdXBkYXRlOiB1cGRhdGVFdmVudExpc3RlbmVycyxcclxuICAgIGRlc3Ryb3k6IHVwZGF0ZUV2ZW50TGlzdGVuZXJzXHJcbn07XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIGF0dHJpYnV0ZXMudHNcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgeGxpbmtOUyA9IFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiO1xyXG5jb25zdCB4bWxOUyA9IFwiaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlXCI7XHJcbmNvbnN0IGNvbG9uQ2hhciA9IDU4O1xyXG5jb25zdCB4Q2hhciA9IDEyMDtcclxuZnVuY3Rpb24gdXBkYXRlQXR0cnMob2xkVm5vZGUsIHZub2RlKSB7XHJcbiAgICB2YXIga2V5LCBlbG0gPSB2bm9kZS5lbG0sIG9sZEF0dHJzID0gb2xkVm5vZGUuZGF0YS5hdHRycywgYXR0cnMgPSB2bm9kZS5kYXRhLmF0dHJzO1xyXG4gICAgaWYgKCFvbGRBdHRycyAmJiAhYXR0cnMpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgaWYgKG9sZEF0dHJzID09PSBhdHRycylcclxuICAgICAgICByZXR1cm47XHJcbiAgICBvbGRBdHRycyA9IG9sZEF0dHJzIHx8IHt9O1xyXG4gICAgYXR0cnMgPSBhdHRycyB8fCB7fTtcclxuICAgIC8vIHVwZGF0ZSBtb2RpZmllZCBhdHRyaWJ1dGVzLCBhZGQgbmV3IGF0dHJpYnV0ZXNcclxuICAgIGZvciAoa2V5IGluIGF0dHJzKSB7XHJcbiAgICAgICAgY29uc3QgY3VyID0gYXR0cnNba2V5XTtcclxuICAgICAgICBjb25zdCBvbGQgPSBvbGRBdHRyc1trZXldO1xyXG4gICAgICAgIGlmIChvbGQgIT09IGN1cikge1xyXG4gICAgICAgICAgICBpZiAoY3VyID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICBlbG0uc2V0QXR0cmlidXRlKGtleSwgXCJcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY3VyID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgZWxtLnJlbW92ZUF0dHJpYnV0ZShrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGtleS5jaGFyQ29kZUF0KDApICE9PSB4Q2hhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsbS5zZXRBdHRyaWJ1dGUoa2V5LCBjdXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoa2V5LmNoYXJDb2RlQXQoMykgPT09IGNvbG9uQ2hhcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIEFzc3VtZSB4bWwgbmFtZXNwYWNlXHJcbiAgICAgICAgICAgICAgICAgICAgZWxtLnNldEF0dHJpYnV0ZU5TKHhtbE5TLCBrZXksIGN1cik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChrZXkuY2hhckNvZGVBdCg1KSA9PT0gY29sb25DaGFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQXNzdW1lIHhsaW5rIG5hbWVzcGFjZVxyXG4gICAgICAgICAgICAgICAgICAgIGVsbS5zZXRBdHRyaWJ1dGVOUyh4bGlua05TLCBrZXksIGN1cik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBlbG0uc2V0QXR0cmlidXRlKGtleSwgY3VyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIHJlbW92ZSByZW1vdmVkIGF0dHJpYnV0ZXNcclxuICAgIC8vIHVzZSBgaW5gIG9wZXJhdG9yIHNpbmNlIHRoZSBwcmV2aW91cyBgZm9yYCBpdGVyYXRpb24gdXNlcyBpdCAoLmkuZS4gYWRkIGV2ZW4gYXR0cmlidXRlcyB3aXRoIHVuZGVmaW5lZCB2YWx1ZSlcclxuICAgIC8vIHRoZSBvdGhlciBvcHRpb24gaXMgdG8gcmVtb3ZlIGFsbCBhdHRyaWJ1dGVzIHdpdGggdmFsdWUgPT0gdW5kZWZpbmVkXHJcbiAgICBmb3IgKGtleSBpbiBvbGRBdHRycykge1xyXG4gICAgICAgIGlmICghKGtleSBpbiBhdHRycykpIHtcclxuICAgICAgICAgICAgZWxtLnJlbW92ZUF0dHJpYnV0ZShrZXkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5jb25zdCBhdHRyc01vZHVsZSA9IHtcclxuICAgIGNyZWF0ZTogdXBkYXRlQXR0cnMsXHJcbiAgICB1cGRhdGU6IHVwZGF0ZUF0dHJzXHJcbn07XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIGNsYXNzLnRzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmZ1bmN0aW9uIHVwZGF0ZUNsYXNzKG9sZFZub2RlLCB2bm9kZSkge1xyXG4gICAgdmFyIGN1ciwgbmFtZSwgZWxtLCBvbGRDbGFzcyA9IG9sZFZub2RlLmRhdGEuY2xhc3MsIGtsYXNzID0gdm5vZGUuZGF0YS5jbGFzcztcclxuICAgIGlmICghb2xkQ2xhc3MgJiYgIWtsYXNzKVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIGlmIChvbGRDbGFzcyA9PT0ga2xhc3MpXHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgb2xkQ2xhc3MgPSBvbGRDbGFzcyB8fCB7fTtcclxuICAgIGtsYXNzID0ga2xhc3MgfHwge307XHJcbiAgICBlbG0gPSB2bm9kZS5lbG07XHJcbiAgICBmb3IgKG5hbWUgaW4gb2xkQ2xhc3MpIHtcclxuICAgICAgICBpZiAobmFtZSAmJiAha2xhc3NbbmFtZV0pIHtcclxuICAgICAgICAgICAgZWxtLmNsYXNzTGlzdC5yZW1vdmUobmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yIChuYW1lIGluIGtsYXNzKSB7XHJcbiAgICAgICAgY3VyID0ga2xhc3NbbmFtZV07XHJcbiAgICAgICAgaWYgKGN1ciAhPT0gb2xkQ2xhc3NbbmFtZV0pIHtcclxuICAgICAgICAgICAgZWxtLmNsYXNzTGlzdFtjdXIgPyBcImFkZFwiIDogXCJyZW1vdmVcIl0obmFtZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmNvbnN0IGNsYXNzTW9kdWxlID0geyBjcmVhdGU6IHVwZGF0ZUNsYXNzLCB1cGRhdGU6IHVwZGF0ZUNsYXNzIH07XG5cbi8qKlxyXG4gKiBPd2wgVkRPTVxyXG4gKlxyXG4gKiBUaGlzIGZpbGUgY29udGFpbnMgYW4gaW1wbGVtZW50YXRpb24gb2YgYSB2aXJ0dWFsIERPTSwgd2hpY2ggaXMgYSBzeXN0ZW0gdGhhdFxyXG4gKiBjYW4gZ2VuZXJhdGUgaW4tbWVtb3J5IHJlcHJlc2VudGF0aW9ucyBvZiBhIERPTSB0cmVlLCBjb21wYXJlIHRoZW0sIGFuZFxyXG4gKiBldmVudHVhbGx5IGNoYW5nZSBhIGNvbmNyZXRlIERPTSB0cmVlIHRvIG1hdGNoIGl0cyByZXByZXNlbnRhdGlvbiwgaW4gYW5cclxuICogaG9wZWZ1bGx5IGVmZmljaWVudCB3YXkuXHJcbiAqXHJcbiAqIE5vdGUgdGhhdCB0aGlzIGNvZGUgaXMgYSBmb3JrIG9mIFNuYWJiZG9tLCBzbGlnaHRseSB0d2Vha2VkL29wdGltaXplZCBmb3Igb3VyXHJcbiAqIG5lZWRzIChzZWUgaHR0cHM6Ly9naXRodWIuY29tL3NuYWJiZG9tL3NuYWJiZG9tKS5cclxuICpcclxuICogVGhlIG1haW4gZXhwb3J0ZWQgdmFsdWVzIGFyZTpcclxuICogLSBpbnRlcmZhY2UgVk5vZGVcclxuICogLSBoIGZ1bmN0aW9uIChhIGhlbHBlciBmdW5jdGlvbiB0byBnZW5lcmF0ZSBhIHZub2RlKVxyXG4gKiAtIHBhdGNoIGZ1bmN0aW9uICh0byBhcHBseSBhIHZub2RlIHRvIGFuIGFjdHVhbCBET00gbm9kZSlcclxuICovXHJcbmZ1bmN0aW9uIHZub2RlKHNlbCwgZGF0YSwgY2hpbGRyZW4sIHRleHQsIGVsbSkge1xyXG4gICAgbGV0IGtleSA9IGRhdGEgPT09IHVuZGVmaW5lZCA/IHVuZGVmaW5lZCA6IGRhdGEua2V5O1xyXG4gICAgcmV0dXJuIHsgc2VsLCBkYXRhLCBjaGlsZHJlbiwgdGV4dCwgZWxtLCBrZXkgfTtcclxufVxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBzbmFiYmRvbS50c1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5mdW5jdGlvbiBpc1VuZGVmKHMpIHtcclxuICAgIHJldHVybiBzID09PSB1bmRlZmluZWQ7XHJcbn1cclxuZnVuY3Rpb24gaXNEZWYocykge1xyXG4gICAgcmV0dXJuIHMgIT09IHVuZGVmaW5lZDtcclxufVxyXG5jb25zdCBlbXB0eU5vZGUgPSB2bm9kZShcIlwiLCB7fSwgW10sIHVuZGVmaW5lZCwgdW5kZWZpbmVkKTtcclxuZnVuY3Rpb24gc2FtZVZub2RlKHZub2RlMSwgdm5vZGUyKSB7XHJcbiAgICByZXR1cm4gdm5vZGUxLmtleSA9PT0gdm5vZGUyLmtleSAmJiB2bm9kZTEuc2VsID09PSB2bm9kZTIuc2VsO1xyXG59XHJcbmZ1bmN0aW9uIGlzVm5vZGUodm5vZGUpIHtcclxuICAgIHJldHVybiB2bm9kZS5zZWwgIT09IHVuZGVmaW5lZDtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVLZXlUb09sZElkeChjaGlsZHJlbiwgYmVnaW5JZHgsIGVuZElkeCkge1xyXG4gICAgbGV0IGksIG1hcCA9IHt9LCBrZXksIGNoO1xyXG4gICAgZm9yIChpID0gYmVnaW5JZHg7IGkgPD0gZW5kSWR4OyArK2kpIHtcclxuICAgICAgICBjaCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgIGlmIChjaCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGtleSA9IGNoLmtleTtcclxuICAgICAgICAgICAgaWYgKGtleSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgbWFwW2tleV0gPSBpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBtYXA7XHJcbn1cclxuY29uc3QgaG9va3MgPSBbXCJjcmVhdGVcIiwgXCJ1cGRhdGVcIiwgXCJyZW1vdmVcIiwgXCJkZXN0cm95XCIsIFwicHJlXCIsIFwicG9zdFwiXTtcclxuZnVuY3Rpb24gaW5pdChtb2R1bGVzLCBkb21BcGkpIHtcclxuICAgIGxldCBpLCBqLCBjYnMgPSB7fTtcclxuICAgIGNvbnN0IGFwaSA9IGRvbUFwaSAhPT0gdW5kZWZpbmVkID8gZG9tQXBpIDogaHRtbERvbUFwaTtcclxuICAgIGZvciAoaSA9IDA7IGkgPCBob29rcy5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgIGNic1tob29rc1tpXV0gPSBbXTtcclxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgbW9kdWxlcy5sZW5ndGg7ICsraikge1xyXG4gICAgICAgICAgICBjb25zdCBob29rID0gbW9kdWxlc1tqXVtob29rc1tpXV07XHJcbiAgICAgICAgICAgIGlmIChob29rICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGNic1tob29rc1tpXV0ucHVzaChob29rKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGVtcHR5Tm9kZUF0KGVsbSkge1xyXG4gICAgICAgIGNvbnN0IGlkID0gZWxtLmlkID8gXCIjXCIgKyBlbG0uaWQgOiBcIlwiO1xyXG4gICAgICAgIGNvbnN0IGMgPSBlbG0uY2xhc3NOYW1lID8gXCIuXCIgKyBlbG0uY2xhc3NOYW1lLnNwbGl0KFwiIFwiKS5qb2luKFwiLlwiKSA6IFwiXCI7XHJcbiAgICAgICAgcmV0dXJuIHZub2RlKGFwaS50YWdOYW1lKGVsbSkudG9Mb3dlckNhc2UoKSArIGlkICsgYywge30sIFtdLCB1bmRlZmluZWQsIGVsbSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBjcmVhdGVSbUNiKGNoaWxkRWxtLCBsaXN0ZW5lcnMpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gcm1DYigpIHtcclxuICAgICAgICAgICAgaWYgKC0tbGlzdGVuZXJzID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnQgPSBhcGkucGFyZW50Tm9kZShjaGlsZEVsbSk7XHJcbiAgICAgICAgICAgICAgICBhcGkucmVtb3ZlQ2hpbGQocGFyZW50LCBjaGlsZEVsbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gY3JlYXRlRWxtKHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpIHtcclxuICAgICAgICBsZXQgaSwgaUxlbiwgZGF0YSA9IHZub2RlLmRhdGE7XHJcbiAgICAgICAgaWYgKGRhdGEgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBpZiAoaXNEZWYoKGkgPSBkYXRhLmhvb2spKSAmJiBpc0RlZigoaSA9IGkuaW5pdCkpKSB7XHJcbiAgICAgICAgICAgICAgICBpKHZub2RlKTtcclxuICAgICAgICAgICAgICAgIGRhdGEgPSB2bm9kZS5kYXRhO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBjaGlsZHJlbiA9IHZub2RlLmNoaWxkcmVuLCBzZWwgPSB2bm9kZS5zZWw7XHJcbiAgICAgICAgaWYgKHNlbCA9PT0gXCIhXCIpIHtcclxuICAgICAgICAgICAgaWYgKGlzVW5kZWYodm5vZGUudGV4dCkpIHtcclxuICAgICAgICAgICAgICAgIHZub2RlLnRleHQgPSBcIlwiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZub2RlLmVsbSA9IGFwaS5jcmVhdGVDb21tZW50KHZub2RlLnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChzZWwgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBjb25zdCBlbG0gPSB2bm9kZS5lbG0gfHxcclxuICAgICAgICAgICAgICAgICh2bm9kZS5lbG0gPVxyXG4gICAgICAgICAgICAgICAgICAgIGlzRGVmKGRhdGEpICYmIGlzRGVmKChpID0gZGF0YS5ucykpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID8gYXBpLmNyZWF0ZUVsZW1lbnROUyhpLCBzZWwpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDogYXBpLmNyZWF0ZUVsZW1lbnQoc2VsKSk7XHJcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIGlMZW4gPSBjYnMuY3JlYXRlLmxlbmd0aDsgaSA8IGlMZW47ICsraSlcclxuICAgICAgICAgICAgICAgIGNicy5jcmVhdGVbaV0oZW1wdHlOb2RlLCB2bm9kZSk7XHJcbiAgICAgICAgICAgIGlmIChhcnJheShjaGlsZHJlbikpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDAsIGlMZW4gPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpTGVuOyArK2kpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaCA9IGNoaWxkcmVuW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjaCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFwaS5hcHBlbmRDaGlsZChlbG0sIGNyZWF0ZUVsbShjaCwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHByaW1pdGl2ZSh2bm9kZS50ZXh0KSkge1xyXG4gICAgICAgICAgICAgICAgYXBpLmFwcGVuZENoaWxkKGVsbSwgYXBpLmNyZWF0ZVRleHROb2RlKHZub2RlLnRleHQpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpID0gdm5vZGUuZGF0YS5ob29rOyAvLyBSZXVzZSB2YXJpYWJsZVxyXG4gICAgICAgICAgICBpZiAoaXNEZWYoaSkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpLmNyZWF0ZSlcclxuICAgICAgICAgICAgICAgICAgICBpLmNyZWF0ZShlbXB0eU5vZGUsIHZub2RlKTtcclxuICAgICAgICAgICAgICAgIGlmIChpLmluc2VydClcclxuICAgICAgICAgICAgICAgICAgICBpbnNlcnRlZFZub2RlUXVldWUucHVzaCh2bm9kZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHZub2RlLmVsbSA9IGFwaS5jcmVhdGVUZXh0Tm9kZSh2bm9kZS50ZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZub2RlLmVsbTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGFkZFZub2RlcyhwYXJlbnRFbG0sIGJlZm9yZSwgdm5vZGVzLCBzdGFydElkeCwgZW5kSWR4LCBpbnNlcnRlZFZub2RlUXVldWUpIHtcclxuICAgICAgICBmb3IgKDsgc3RhcnRJZHggPD0gZW5kSWR4OyArK3N0YXJ0SWR4KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoID0gdm5vZGVzW3N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgaWYgKGNoICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGFwaS5pbnNlcnRCZWZvcmUocGFyZW50RWxtLCBjcmVhdGVFbG0oY2gsIGluc2VydGVkVm5vZGVRdWV1ZSksIGJlZm9yZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBpbnZva2VEZXN0cm95SG9vayh2bm9kZSkge1xyXG4gICAgICAgIGxldCBpLCBpTGVuLCBqLCBqTGVuLCBkYXRhID0gdm5vZGUuZGF0YTtcclxuICAgICAgICBpZiAoZGF0YSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIGlmIChpc0RlZigoaSA9IGRhdGEuaG9vaykpICYmIGlzRGVmKChpID0gaS5kZXN0cm95KSkpXHJcbiAgICAgICAgICAgICAgICBpKHZub2RlKTtcclxuICAgICAgICAgICAgZm9yIChpID0gMCwgaUxlbiA9IGNicy5kZXN0cm95Lmxlbmd0aDsgaSA8IGlMZW47ICsraSlcclxuICAgICAgICAgICAgICAgIGNicy5kZXN0cm95W2ldKHZub2RlKTtcclxuICAgICAgICAgICAgaWYgKHZub2RlLmNoaWxkcmVuICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoaiA9IDAsIGpMZW4gPSB2bm9kZS5jaGlsZHJlbi5sZW5ndGg7IGogPCBqTGVuOyArK2opIHtcclxuICAgICAgICAgICAgICAgICAgICBpID0gdm5vZGUuY2hpbGRyZW5bal07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT0gbnVsbCAmJiB0eXBlb2YgaSAhPT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnZva2VEZXN0cm95SG9vayhpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiByZW1vdmVWbm9kZXMocGFyZW50RWxtLCB2bm9kZXMsIHN0YXJ0SWR4LCBlbmRJZHgpIHtcclxuICAgICAgICBmb3IgKDsgc3RhcnRJZHggPD0gZW5kSWR4OyArK3N0YXJ0SWR4KSB7XHJcbiAgICAgICAgICAgIGxldCBpLCBpTGVuLCBsaXN0ZW5lcnMsIHJtLCBjaCA9IHZub2Rlc1tzdGFydElkeF07XHJcbiAgICAgICAgICAgIGlmIChjaCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNEZWYoY2guc2VsKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGludm9rZURlc3Ryb3lIb29rKGNoKTtcclxuICAgICAgICAgICAgICAgICAgICBsaXN0ZW5lcnMgPSBjYnMucmVtb3ZlLmxlbmd0aCArIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgcm0gPSBjcmVhdGVSbUNiKGNoLmVsbSwgbGlzdGVuZXJzKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwLCBpTGVuID0gY2JzLnJlbW92ZS5sZW5ndGg7IGkgPCBpTGVuOyArK2kpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNicy5yZW1vdmVbaV0oY2gsIHJtKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaXNEZWYoKGkgPSBjaC5kYXRhKSkgJiYgaXNEZWYoKGkgPSBpLmhvb2spKSAmJiBpc0RlZigoaSA9IGkucmVtb3ZlKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaShjaCwgcm0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcm0oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBUZXh0IG5vZGVcclxuICAgICAgICAgICAgICAgICAgICBhcGkucmVtb3ZlQ2hpbGQocGFyZW50RWxtLCBjaC5lbG0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZnVuY3Rpb24gdXBkYXRlQ2hpbGRyZW4ocGFyZW50RWxtLCBvbGRDaCwgbmV3Q2gsIGluc2VydGVkVm5vZGVRdWV1ZSkge1xyXG4gICAgICAgIGxldCBvbGRTdGFydElkeCA9IDAsIG5ld1N0YXJ0SWR4ID0gMDtcclxuICAgICAgICBsZXQgb2xkRW5kSWR4ID0gb2xkQ2gubGVuZ3RoIC0gMTtcclxuICAgICAgICBsZXQgb2xkU3RhcnRWbm9kZSA9IG9sZENoWzBdO1xyXG4gICAgICAgIGxldCBvbGRFbmRWbm9kZSA9IG9sZENoW29sZEVuZElkeF07XHJcbiAgICAgICAgbGV0IG5ld0VuZElkeCA9IG5ld0NoLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgbGV0IG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFswXTtcclxuICAgICAgICBsZXQgbmV3RW5kVm5vZGUgPSBuZXdDaFtuZXdFbmRJZHhdO1xyXG4gICAgICAgIGxldCBvbGRLZXlUb0lkeDtcclxuICAgICAgICBsZXQgaWR4SW5PbGQ7XHJcbiAgICAgICAgbGV0IGVsbVRvTW92ZTtcclxuICAgICAgICBsZXQgYmVmb3JlO1xyXG4gICAgICAgIHdoaWxlIChvbGRTdGFydElkeCA8PSBvbGRFbmRJZHggJiYgbmV3U3RhcnRJZHggPD0gbmV3RW5kSWR4KSB7XHJcbiAgICAgICAgICAgIGlmIChvbGRTdGFydFZub2RlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTsgLy8gVm5vZGUgbWlnaHQgaGF2ZSBiZWVuIG1vdmVkIGxlZnRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChvbGRFbmRWbm9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBvbGRFbmRWbm9kZSA9IG9sZENoWy0tb2xkRW5kSWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChuZXdTdGFydFZub2RlID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChuZXdFbmRWbm9kZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBuZXdFbmRWbm9kZSA9IG5ld0NoWy0tbmV3RW5kSWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzYW1lVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3U3RhcnRWbm9kZSkpIHtcclxuICAgICAgICAgICAgICAgIHBhdGNoVm5vZGUob2xkU3RhcnRWbm9kZSwgbmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcclxuICAgICAgICAgICAgICAgIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFsrK29sZFN0YXJ0SWR4XTtcclxuICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzYW1lVm5vZGUob2xkRW5kVm5vZGUsIG5ld0VuZFZub2RlKSkge1xyXG4gICAgICAgICAgICAgICAgcGF0Y2hWbm9kZShvbGRFbmRWbm9kZSwgbmV3RW5kVm5vZGUsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgICAgICAgICBvbGRFbmRWbm9kZSA9IG9sZENoWy0tb2xkRW5kSWR4XTtcclxuICAgICAgICAgICAgICAgIG5ld0VuZFZub2RlID0gbmV3Q2hbLS1uZXdFbmRJZHhdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHNhbWVWbm9kZShvbGRTdGFydFZub2RlLCBuZXdFbmRWbm9kZSkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFZub2RlIG1vdmVkIHJpZ2h0XHJcbiAgICAgICAgICAgICAgICBwYXRjaFZub2RlKG9sZFN0YXJ0Vm5vZGUsIG5ld0VuZFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpO1xyXG4gICAgICAgICAgICAgICAgYXBpLmluc2VydEJlZm9yZShwYXJlbnRFbG0sIG9sZFN0YXJ0Vm5vZGUuZWxtLCBhcGkubmV4dFNpYmxpbmcob2xkRW5kVm5vZGUuZWxtKSk7XHJcbiAgICAgICAgICAgICAgICBvbGRTdGFydFZub2RlID0gb2xkQ2hbKytvbGRTdGFydElkeF07XHJcbiAgICAgICAgICAgICAgICBuZXdFbmRWbm9kZSA9IG5ld0NoWy0tbmV3RW5kSWR4XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzYW1lVm5vZGUob2xkRW5kVm5vZGUsIG5ld1N0YXJ0Vm5vZGUpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBWbm9kZSBtb3ZlZCBsZWZ0XHJcbiAgICAgICAgICAgICAgICBwYXRjaFZub2RlKG9sZEVuZFZub2RlLCBuZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpO1xyXG4gICAgICAgICAgICAgICAgYXBpLmluc2VydEJlZm9yZShwYXJlbnRFbG0sIG9sZEVuZFZub2RlLmVsbSwgb2xkU3RhcnRWbm9kZS5lbG0pO1xyXG4gICAgICAgICAgICAgICAgb2xkRW5kVm5vZGUgPSBvbGRDaFstLW9sZEVuZElkeF07XHJcbiAgICAgICAgICAgICAgICBuZXdTdGFydFZub2RlID0gbmV3Q2hbKytuZXdTdGFydElkeF07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2xkS2V5VG9JZHggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9sZEtleVRvSWR4ID0gY3JlYXRlS2V5VG9PbGRJZHgob2xkQ2gsIG9sZFN0YXJ0SWR4LCBvbGRFbmRJZHgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWR4SW5PbGQgPSBvbGRLZXlUb0lkeFtuZXdTdGFydFZub2RlLmtleV07XHJcbiAgICAgICAgICAgICAgICBpZiAoaXNVbmRlZihpZHhJbk9sZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBOZXcgZWxlbWVudFxyXG4gICAgICAgICAgICAgICAgICAgIGFwaS5pbnNlcnRCZWZvcmUocGFyZW50RWxtLCBjcmVhdGVFbG0obmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSwgb2xkU3RhcnRWbm9kZS5lbG0pO1xyXG4gICAgICAgICAgICAgICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsbVRvTW92ZSA9IG9sZENoW2lkeEluT2xkXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZWxtVG9Nb3ZlLnNlbCAhPT0gbmV3U3RhcnRWbm9kZS5zZWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXBpLmluc2VydEJlZm9yZShwYXJlbnRFbG0sIGNyZWF0ZUVsbShuZXdTdGFydFZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpLCBvbGRTdGFydFZub2RlLmVsbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXRjaFZub2RlKGVsbVRvTW92ZSwgbmV3U3RhcnRWbm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2xkQ2hbaWR4SW5PbGRdID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcGkuaW5zZXJ0QmVmb3JlKHBhcmVudEVsbSwgZWxtVG9Nb3ZlLmVsbSwgb2xkU3RhcnRWbm9kZS5lbG0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBuZXdTdGFydFZub2RlID0gbmV3Q2hbKytuZXdTdGFydElkeF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9sZFN0YXJ0SWR4IDw9IG9sZEVuZElkeCB8fCBuZXdTdGFydElkeCA8PSBuZXdFbmRJZHgpIHtcclxuICAgICAgICAgICAgaWYgKG9sZFN0YXJ0SWR4ID4gb2xkRW5kSWR4KSB7XHJcbiAgICAgICAgICAgICAgICBiZWZvcmUgPSBuZXdDaFtuZXdFbmRJZHggKyAxXSA9PSBudWxsID8gbnVsbCA6IG5ld0NoW25ld0VuZElkeCArIDFdLmVsbTtcclxuICAgICAgICAgICAgICAgIGFkZFZub2RlcyhwYXJlbnRFbG0sIGJlZm9yZSwgbmV3Q2gsIG5ld1N0YXJ0SWR4LCBuZXdFbmRJZHgsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVWbm9kZXMocGFyZW50RWxtLCBvbGRDaCwgb2xkU3RhcnRJZHgsIG9sZEVuZElkeCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBwYXRjaFZub2RlKG9sZFZub2RlLCB2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKSB7XHJcbiAgICAgICAgbGV0IGksIGlMZW4sIGhvb2s7XHJcbiAgICAgICAgaWYgKGlzRGVmKChpID0gdm5vZGUuZGF0YSkpICYmIGlzRGVmKChob29rID0gaS5ob29rKSkgJiYgaXNEZWYoKGkgPSBob29rLnByZXBhdGNoKSkpIHtcclxuICAgICAgICAgICAgaShvbGRWbm9kZSwgdm5vZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBlbG0gPSAodm5vZGUuZWxtID0gb2xkVm5vZGUuZWxtKTtcclxuICAgICAgICBsZXQgb2xkQ2ggPSBvbGRWbm9kZS5jaGlsZHJlbjtcclxuICAgICAgICBsZXQgY2ggPSB2bm9kZS5jaGlsZHJlbjtcclxuICAgICAgICBpZiAob2xkVm5vZGUgPT09IHZub2RlKVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgaWYgKHZub2RlLmRhdGEgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBpTGVuID0gY2JzLnVwZGF0ZS5sZW5ndGg7IGkgPCBpTGVuOyArK2kpXHJcbiAgICAgICAgICAgICAgICBjYnMudXBkYXRlW2ldKG9sZFZub2RlLCB2bm9kZSk7XHJcbiAgICAgICAgICAgIGkgPSB2bm9kZS5kYXRhLmhvb2s7XHJcbiAgICAgICAgICAgIGlmIChpc0RlZihpKSAmJiBpc0RlZigoaSA9IGkudXBkYXRlKSkpXHJcbiAgICAgICAgICAgICAgICBpKG9sZFZub2RlLCB2bm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpc1VuZGVmKHZub2RlLnRleHQpKSB7XHJcbiAgICAgICAgICAgIGlmIChpc0RlZihvbGRDaCkgJiYgaXNEZWYoY2gpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob2xkQ2ggIT09IGNoKVxyXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUNoaWxkcmVuKGVsbSwgb2xkQ2gsIGNoLCBpbnNlcnRlZFZub2RlUXVldWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGlzRGVmKGNoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzRGVmKG9sZFZub2RlLnRleHQpKVxyXG4gICAgICAgICAgICAgICAgICAgIGFwaS5zZXRUZXh0Q29udGVudChlbG0sIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgYWRkVm5vZGVzKGVsbSwgbnVsbCwgY2gsIDAsIGNoLmxlbmd0aCAtIDEsIGluc2VydGVkVm5vZGVRdWV1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNEZWYob2xkQ2gpKSB7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVWbm9kZXMoZWxtLCBvbGRDaCwgMCwgb2xkQ2gubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXNEZWYob2xkVm5vZGUudGV4dCkpIHtcclxuICAgICAgICAgICAgICAgIGFwaS5zZXRUZXh0Q29udGVudChlbG0sIFwiXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKG9sZFZub2RlLnRleHQgIT09IHZub2RlLnRleHQpIHtcclxuICAgICAgICAgICAgaWYgKGlzRGVmKG9sZENoKSkge1xyXG4gICAgICAgICAgICAgICAgcmVtb3ZlVm5vZGVzKGVsbSwgb2xkQ2gsIDAsIG9sZENoLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGFwaS5zZXRUZXh0Q29udGVudChlbG0sIHZub2RlLnRleHQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNEZWYoaG9vaykgJiYgaXNEZWYoKGkgPSBob29rLnBvc3RwYXRjaCkpKSB7XHJcbiAgICAgICAgICAgIGkob2xkVm5vZGUsIHZub2RlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gcGF0Y2gob2xkVm5vZGUsIHZub2RlKSB7XHJcbiAgICAgICAgbGV0IGksIGlMZW4sIGVsbSwgcGFyZW50O1xyXG4gICAgICAgIGNvbnN0IGluc2VydGVkVm5vZGVRdWV1ZSA9IFtdO1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlMZW4gPSBjYnMucHJlLmxlbmd0aDsgaSA8IGlMZW47ICsraSlcclxuICAgICAgICAgICAgY2JzLnByZVtpXSgpO1xyXG4gICAgICAgIGlmICghaXNWbm9kZShvbGRWbm9kZSkpIHtcclxuICAgICAgICAgICAgb2xkVm5vZGUgPSBlbXB0eU5vZGVBdChvbGRWbm9kZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChzYW1lVm5vZGUob2xkVm5vZGUsIHZub2RlKSkge1xyXG4gICAgICAgICAgICBwYXRjaFZub2RlKG9sZFZub2RlLCB2bm9kZSwgaW5zZXJ0ZWRWbm9kZVF1ZXVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGVsbSA9IG9sZFZub2RlLmVsbTtcclxuICAgICAgICAgICAgcGFyZW50ID0gYXBpLnBhcmVudE5vZGUoZWxtKTtcclxuICAgICAgICAgICAgY3JlYXRlRWxtKHZub2RlLCBpbnNlcnRlZFZub2RlUXVldWUpO1xyXG4gICAgICAgICAgICBpZiAocGFyZW50ICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBhcGkuaW5zZXJ0QmVmb3JlKHBhcmVudCwgdm5vZGUuZWxtLCBhcGkubmV4dFNpYmxpbmcoZWxtKSk7XHJcbiAgICAgICAgICAgICAgICByZW1vdmVWbm9kZXMocGFyZW50LCBbb2xkVm5vZGVdLCAwLCAwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGkgPSAwLCBpTGVuID0gaW5zZXJ0ZWRWbm9kZVF1ZXVlLmxlbmd0aDsgaSA8IGlMZW47ICsraSkge1xyXG4gICAgICAgICAgICBpbnNlcnRlZFZub2RlUXVldWVbaV0uZGF0YS5ob29rLmluc2VydChpbnNlcnRlZFZub2RlUXVldWVbaV0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGkgPSAwLCBpTGVuID0gY2JzLnBvc3QubGVuZ3RoOyBpIDwgaUxlbjsgKytpKVxyXG4gICAgICAgICAgICBjYnMucG9zdFtpXSgpO1xyXG4gICAgICAgIHJldHVybiB2bm9kZTtcclxuICAgIH07XHJcbn1cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gaXMudHNcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgYXJyYXkgPSBBcnJheS5pc0FycmF5O1xyXG5mdW5jdGlvbiBwcmltaXRpdmUocykge1xyXG4gICAgcmV0dXJuIHR5cGVvZiBzID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBzID09PSBcIm51bWJlclwiO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZUVsZW1lbnQodGFnTmFtZSkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZSk7XHJcbn1cclxuZnVuY3Rpb24gY3JlYXRlRWxlbWVudE5TKG5hbWVzcGFjZVVSSSwgcXVhbGlmaWVkTmFtZSkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhuYW1lc3BhY2VVUkksIHF1YWxpZmllZE5hbWUpO1xyXG59XHJcbmZ1bmN0aW9uIGNyZWF0ZVRleHROb2RlKHRleHQpIHtcclxuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0ZXh0KTtcclxufVxyXG5mdW5jdGlvbiBjcmVhdGVDb21tZW50KHRleHQpIHtcclxuICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVDb21tZW50KHRleHQpO1xyXG59XHJcbmZ1bmN0aW9uIGluc2VydEJlZm9yZShwYXJlbnROb2RlLCBuZXdOb2RlLCByZWZlcmVuY2VOb2RlKSB7XHJcbiAgICBwYXJlbnROb2RlLmluc2VydEJlZm9yZShuZXdOb2RlLCByZWZlcmVuY2VOb2RlKTtcclxufVxyXG5mdW5jdGlvbiByZW1vdmVDaGlsZChub2RlLCBjaGlsZCkge1xyXG4gICAgbm9kZS5yZW1vdmVDaGlsZChjaGlsZCk7XHJcbn1cclxuZnVuY3Rpb24gYXBwZW5kQ2hpbGQobm9kZSwgY2hpbGQpIHtcclxuICAgIG5vZGUuYXBwZW5kQ2hpbGQoY2hpbGQpO1xyXG59XHJcbmZ1bmN0aW9uIHBhcmVudE5vZGUobm9kZSkge1xyXG4gICAgcmV0dXJuIG5vZGUucGFyZW50Tm9kZTtcclxufVxyXG5mdW5jdGlvbiBuZXh0U2libGluZyhub2RlKSB7XHJcbiAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZztcclxufVxyXG5mdW5jdGlvbiB0YWdOYW1lKGVsbSkge1xyXG4gICAgcmV0dXJuIGVsbS50YWdOYW1lO1xyXG59XHJcbmZ1bmN0aW9uIHNldFRleHRDb250ZW50KG5vZGUsIHRleHQpIHtcclxuICAgIG5vZGUudGV4dENvbnRlbnQgPSB0ZXh0O1xyXG59XHJcbmNvbnN0IGh0bWxEb21BcGkgPSB7XHJcbiAgICBjcmVhdGVFbGVtZW50LFxyXG4gICAgY3JlYXRlRWxlbWVudE5TLFxyXG4gICAgY3JlYXRlVGV4dE5vZGUsXHJcbiAgICBjcmVhdGVDb21tZW50LFxyXG4gICAgaW5zZXJ0QmVmb3JlLFxyXG4gICAgcmVtb3ZlQ2hpbGQsXHJcbiAgICBhcHBlbmRDaGlsZCxcclxuICAgIHBhcmVudE5vZGUsXHJcbiAgICBuZXh0U2libGluZyxcclxuICAgIHRhZ05hbWUsXHJcbiAgICBzZXRUZXh0Q29udGVudFxyXG59O1xyXG5mdW5jdGlvbiBhZGROUyhkYXRhLCBjaGlsZHJlbiwgc2VsKSB7XHJcbiAgICBpZiAoc2VsID09PSBcImR1bW15XCIpIHtcclxuICAgICAgICAvLyB3ZSBkbyBub3QgbmVlZCB0byBhZGQgdGhlIG5hbWVzcGFjZSBvbiBkdW1teSBlbGVtZW50cywgdGhleSBjb21lIGZyb20gYVxyXG4gICAgICAgIC8vIHN1YmNvbXBvbmVudCwgd2hpY2ggd2lsbCBoYW5kbGUgdGhlIG5hbWVzcGFjZSBpdHNlbGZcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBkYXRhLm5zID0gXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiO1xyXG4gICAgaWYgKHNlbCAhPT0gXCJmb3JlaWduT2JqZWN0XCIgJiYgY2hpbGRyZW4gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBpTGVuID0gY2hpbGRyZW4ubGVuZ3RoOyBpIDwgaUxlbjsgKytpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5baV07XHJcbiAgICAgICAgICAgIGxldCBjaGlsZERhdGEgPSBjaGlsZC5kYXRhO1xyXG4gICAgICAgICAgICBpZiAoY2hpbGREYXRhICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGFkZE5TKGNoaWxkRGF0YSwgY2hpbGQuY2hpbGRyZW4sIGNoaWxkLnNlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gaChzZWwsIGIsIGMpIHtcclxuICAgIHZhciBkYXRhID0ge30sIGNoaWxkcmVuLCB0ZXh0LCBpLCBpTGVuO1xyXG4gICAgaWYgKGMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGRhdGEgPSBiO1xyXG4gICAgICAgIGlmIChhcnJheShjKSkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbiA9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHByaW1pdGl2ZShjKSkge1xyXG4gICAgICAgICAgICB0ZXh0ID0gYztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyAmJiBjLnNlbCkge1xyXG4gICAgICAgICAgICBjaGlsZHJlbiA9IFtjXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChiICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICBpZiAoYXJyYXkoYikpIHtcclxuICAgICAgICAgICAgY2hpbGRyZW4gPSBiO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwcmltaXRpdmUoYikpIHtcclxuICAgICAgICAgICAgdGV4dCA9IGI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGIgJiYgYi5zZWwpIHtcclxuICAgICAgICAgICAgY2hpbGRyZW4gPSBbYl07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkYXRhID0gYjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoY2hpbGRyZW4gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIGZvciAoaSA9IDAsIGlMZW4gPSBjaGlsZHJlbi5sZW5ndGg7IGkgPCBpTGVuOyArK2kpIHtcclxuICAgICAgICAgICAgaWYgKHByaW1pdGl2ZShjaGlsZHJlbltpXSkpXHJcbiAgICAgICAgICAgICAgICBjaGlsZHJlbltpXSA9IHZub2RlKHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGNoaWxkcmVuW2ldLCB1bmRlZmluZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB2bm9kZShzZWwsIGRhdGEsIGNoaWxkcmVuLCB0ZXh0LCB1bmRlZmluZWQpO1xyXG59XG5cbmNvbnN0IHBhdGNoID0gaW5pdChbZXZlbnRMaXN0ZW5lcnNNb2R1bGUsIGF0dHJzTW9kdWxlLCBwcm9wc01vZHVsZSwgY2xhc3NNb2R1bGVdKTtcblxuLyoqXHJcbiAqIE93bCBRV2ViIEV4cHJlc3Npb24gUGFyc2VyXHJcbiAqXHJcbiAqIE93bCBuZWVkcyBpbiB2YXJpb3VzIGNvbnRleHRzIHRvIGJlIGFibGUgdG8gdW5kZXJzdGFuZCB0aGUgc3RydWN0dXJlIG9mIGFcclxuICogc3RyaW5nIHJlcHJlc2VudGluZyBhIGphdmFzY3JpcHQgZXhwcmVzc2lvbi4gIFRoZSB1c3VhbCBnb2FsIGlzIHRvIGJlIGFibGVcclxuICogdG8gcmV3cml0ZSBzb21lIHZhcmlhYmxlcy4gIEZvciBleGFtcGxlLCBpZiBhIHRlbXBsYXRlIGhhc1xyXG4gKlxyXG4gKiAgYGBgeG1sXHJcbiAqICA8dCB0LWlmPVwiY29tcHV0ZVNvbWV0aGluZyh7dmFsOiBzdGF0ZS52YWx9KVwiPi4uLjwvdD5cclxuICogYGBgXHJcbiAqXHJcbiAqIHRoaXMgbmVlZHMgdG8gYmUgdHJhbnNsYXRlZCBpbiBzb21ldGhpbmcgbGlrZSB0aGlzOlxyXG4gKlxyXG4gKiBgYGBqc1xyXG4gKiAgIGlmIChjb250ZXh0W1wiY29tcHV0ZVNvbWV0aGluZ1wiXSh7dmFsOiBjb250ZXh0W1wic3RhdGVcIl0udmFsfSkpIHsgLi4uIH1cclxuICogYGBgXHJcbiAqXHJcbiAqIFRoaXMgZmlsZSBjb250YWlucyB0aGUgaW1wbGVtZW50YXRpb24gb2YgYW4gZXh0cmVtZWx5IG5haXZlIHRva2VuaXplci9wYXJzZXJcclxuICogYW5kIGV2YWx1YXRvciBmb3IgamF2YXNjcmlwdCBleHByZXNzaW9ucy4gIFRoZSBzdXBwb3J0ZWQgZ3JhbW1hciBpcyBiYXNpY2FsbHlcclxuICogb25seSBleHByZXNzaXZlIGVub3VnaCB0byB1bmRlcnN0YW5kIHRoZSBzaGFwZSBvZiBvYmplY3RzLCBvZiBhcnJheXMsIGFuZFxyXG4gKiB2YXJpb3VzIG9wZXJhdG9ycy5cclxuICovXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIE1pc2MgdHlwZXMsIGNvbnN0YW50cyBhbmQgaGVscGVyc1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5jb25zdCBSRVNFUlZFRF9XT1JEUyA9IFwidHJ1ZSxmYWxzZSxOYU4sbnVsbCx1bmRlZmluZWQsZGVidWdnZXIsY29uc29sZSx3aW5kb3csaW4saW5zdGFuY2VvZixuZXcsZnVuY3Rpb24scmV0dXJuLHRoaXMsZXZhbCx2b2lkLE1hdGgsUmVnRXhwLEFycmF5LE9iamVjdCxEYXRlXCIuc3BsaXQoXCIsXCIpO1xyXG5jb25zdCBXT1JEX1JFUExBQ0VNRU5UID0ge1xyXG4gICAgYW5kOiBcIiYmXCIsXHJcbiAgICBvcjogXCJ8fFwiLFxyXG4gICAgZ3Q6IFwiPlwiLFxyXG4gICAgZ3RlOiBcIj49XCIsXHJcbiAgICBsdDogXCI8XCIsXHJcbiAgICBsdGU6IFwiPD1cIlxyXG59O1xyXG5jb25zdCBTVEFUSUNfVE9LRU5fTUFQID0ge1xyXG4gICAgXCJ7XCI6IFwiTEVGVF9CUkFDRVwiLFxyXG4gICAgXCJ9XCI6IFwiUklHSFRfQlJBQ0VcIixcclxuICAgIFwiW1wiOiBcIkxFRlRfQlJBQ0tFVFwiLFxyXG4gICAgXCJdXCI6IFwiUklHSFRfQlJBQ0tFVFwiLFxyXG4gICAgXCI6XCI6IFwiQ09MT05cIixcclxuICAgIFwiLFwiOiBcIkNPTU1BXCIsXHJcbiAgICBcIihcIjogXCJMRUZUX1BBUkVOXCIsXHJcbiAgICBcIilcIjogXCJSSUdIVF9QQVJFTlwiXHJcbn07XHJcbi8vIG5vdGUgdGhhdCB0aGUgc3BhY2UgYWZ0ZXIgdHlwZW9mIGlzIHJlbGV2YW50LiBJdCBtYWtlcyBzdXJlIHRoYXQgdGhlIGZvcm1hdHRlZFxyXG4vLyBleHByZXNzaW9uIGhhcyBhIHNwYWNlIGFmdGVyIHR5cGVvZlxyXG5jb25zdCBPUEVSQVRPUlMgPSBcIi4uLiwuLD09PSw9PSwrLCE9PSwhPSwhLHx8LCYmLD49LD4sPD0sPCw/LC0sKiwvLCUsdHlwZW9mICw9Piw9LDssaW4gXCIuc3BsaXQoXCIsXCIpO1xyXG5sZXQgdG9rZW5pemVTdHJpbmcgPSBmdW5jdGlvbiAoZXhwcikge1xyXG4gICAgbGV0IHMgPSBleHByWzBdO1xyXG4gICAgbGV0IHN0YXJ0ID0gcztcclxuICAgIGlmIChzICE9PSBcIidcIiAmJiBzICE9PSAnXCInKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgbGV0IGkgPSAxO1xyXG4gICAgbGV0IGN1cjtcclxuICAgIHdoaWxlIChleHByW2ldICYmIGV4cHJbaV0gIT09IHN0YXJ0KSB7XHJcbiAgICAgICAgY3VyID0gZXhwcltpXTtcclxuICAgICAgICBzICs9IGN1cjtcclxuICAgICAgICBpZiAoY3VyID09PSBcIlxcXFxcIikge1xyXG4gICAgICAgICAgICBpKys7XHJcbiAgICAgICAgICAgIGN1ciA9IGV4cHJbaV07XHJcbiAgICAgICAgICAgIGlmICghY3VyKSB7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIGV4cHJlc3Npb25cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcyArPSBjdXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGkrKztcclxuICAgIH1cclxuICAgIGlmIChleHByW2ldICE9PSBzdGFydCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkludmFsaWQgZXhwcmVzc2lvblwiKTtcclxuICAgIH1cclxuICAgIHMgKz0gc3RhcnQ7XHJcbiAgICByZXR1cm4geyB0eXBlOiBcIlZBTFVFXCIsIHZhbHVlOiBzIH07XHJcbn07XHJcbmxldCB0b2tlbml6ZU51bWJlciA9IGZ1bmN0aW9uIChleHByKSB7XHJcbiAgICBsZXQgcyA9IGV4cHJbMF07XHJcbiAgICBpZiAocyAmJiBzLm1hdGNoKC9bMC05XS8pKSB7XHJcbiAgICAgICAgbGV0IGkgPSAxO1xyXG4gICAgICAgIHdoaWxlIChleHByW2ldICYmIGV4cHJbaV0ubWF0Y2goL1swLTldfFxcLi8pKSB7XHJcbiAgICAgICAgICAgIHMgKz0gZXhwcltpXTtcclxuICAgICAgICAgICAgaSsrO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4geyB0eXBlOiBcIlZBTFVFXCIsIHZhbHVlOiBzIH07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcbmxldCB0b2tlbml6ZVN5bWJvbCA9IGZ1bmN0aW9uIChleHByKSB7XHJcbiAgICBsZXQgcyA9IGV4cHJbMF07XHJcbiAgICBpZiAocyAmJiBzLm1hdGNoKC9bYS16QS1aX1xcJF0vKSkge1xyXG4gICAgICAgIGxldCBpID0gMTtcclxuICAgICAgICB3aGlsZSAoZXhwcltpXSAmJiBleHByW2ldLm1hdGNoKC9cXHcvKSkge1xyXG4gICAgICAgICAgICBzICs9IGV4cHJbaV07XHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHMgaW4gV09SRF9SRVBMQUNFTUVOVCkge1xyXG4gICAgICAgICAgICByZXR1cm4geyB0eXBlOiBcIk9QRVJBVE9SXCIsIHZhbHVlOiBXT1JEX1JFUExBQ0VNRU5UW3NdLCBzaXplOiBzLmxlbmd0aCB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4geyB0eXBlOiBcIlNZTUJPTFwiLCB2YWx1ZTogcyB9O1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG59O1xyXG5jb25zdCB0b2tlbml6ZVN0YXRpYyA9IGZ1bmN0aW9uIChleHByKSB7XHJcbiAgICBjb25zdCBjaGFyID0gZXhwclswXTtcclxuICAgIGlmIChjaGFyICYmIGNoYXIgaW4gU1RBVElDX1RPS0VOX01BUCkge1xyXG4gICAgICAgIHJldHVybiB7IHR5cGU6IFNUQVRJQ19UT0tFTl9NQVBbY2hhcl0sIHZhbHVlOiBjaGFyIH07XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn07XHJcbmNvbnN0IHRva2VuaXplT3BlcmF0b3IgPSBmdW5jdGlvbiAoZXhwcikge1xyXG4gICAgZm9yIChsZXQgb3Agb2YgT1BFUkFUT1JTKSB7XHJcbiAgICAgICAgaWYgKGV4cHIuc3RhcnRzV2l0aChvcCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogXCJPUEVSQVRPUlwiLCB2YWx1ZTogb3AgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZmFsc2U7XHJcbn07XHJcbmNvbnN0IFRPS0VOSVpFUlMgPSBbXHJcbiAgICB0b2tlbml6ZVN0cmluZyxcclxuICAgIHRva2VuaXplTnVtYmVyLFxyXG4gICAgdG9rZW5pemVPcGVyYXRvcixcclxuICAgIHRva2VuaXplU3ltYm9sLFxyXG4gICAgdG9rZW5pemVTdGF0aWNcclxuXTtcclxuLyoqXHJcbiAqIENvbnZlcnQgYSBqYXZhc2NyaXB0IGV4cHJlc3Npb24gKGFzIGEgc3RyaW5nKSBpbnRvIGEgbGlzdCBvZiB0b2tlbnMuIEZvclxyXG4gKiBleGFtcGxlOiBgdG9rZW5pemUoXCIxICsgYlwiKWAgd2lsbCByZXR1cm46XHJcbiAqIGBgYGpzXHJcbiAqICBbXHJcbiAqICAge3R5cGU6IFwiVkFMVUVcIiwgdmFsdWU6IFwiMVwifSxcclxuICogICB7dHlwZTogXCJPUEVSQVRPUlwiLCB2YWx1ZTogXCIrXCJ9LFxyXG4gKiAgIHt0eXBlOiBcIlNZTUJPTFwiLCB2YWx1ZTogXCJiXCJ9XHJcbiAqIF1cclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiB0b2tlbml6ZShleHByKSB7XHJcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcclxuICAgIGxldCB0b2tlbiA9IHRydWU7XHJcbiAgICB3aGlsZSAodG9rZW4pIHtcclxuICAgICAgICBleHByID0gZXhwci50cmltKCk7XHJcbiAgICAgICAgaWYgKGV4cHIpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgdG9rZW5pemVyIG9mIFRPS0VOSVpFUlMpIHtcclxuICAgICAgICAgICAgICAgIHRva2VuID0gdG9rZW5pemVyKGV4cHIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2godG9rZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIGV4cHIgPSBleHByLnNsaWNlKHRva2VuLnNpemUgfHwgdG9rZW4udmFsdWUubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdG9rZW4gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAoZXhwci5sZW5ndGgpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRva2VuaXplciBlcnJvcjogY291bGQgbm90IHRva2VuaXplIFwiJHtleHByfVwiYCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIEV4cHJlc3Npb24gXCJldmFsdWF0b3JcIlxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vKipcclxuICogVGhpcyBpcyB0aGUgbWFpbiBmdW5jdGlvbiBleHBvcnRlZCBieSB0aGlzIGZpbGUuIFRoaXMgaXMgdGhlIGNvZGUgdGhhdCB3aWxsXHJcbiAqIHByb2Nlc3MgYW4gZXhwcmVzc2lvbiAoZ2l2ZW4gYXMgYSBzdHJpbmcpIGFuZCByZXR1cm5zIGFub3RoZXIgZXhwcmVzc2lvbiB3aXRoXHJcbiAqIHByb3BlciBsb29rdXBzIGluIHRoZSBjb250ZXh0LlxyXG4gKlxyXG4gKiBVc3VhbGx5LCB0aGlzIGtpbmQgb2YgY29kZSB3b3VsZCBiZSB2ZXJ5IHNpbXBsZSB0byBkbyBpZiB3ZSBoYWQgYW4gQVNUIChzbyxcclxuICogaWYgd2UgaGFkIGEgamF2YXNjcmlwdCBwYXJzZXIpLCBzaW5jZSB0aGVuLCB3ZSB3b3VsZCBvbmx5IG5lZWQgdG8gZmluZCB0aGVcclxuICogdmFyaWFibGVzIGFuZCByZXBsYWNlIHRoZW0uICBIb3dldmVyLCBhIHBhcnNlciBpcyBtb3JlIGNvbXBsaWNhdGVkLCBhbmQgdGhlcmVcclxuICogYXJlIG5vIHN0YW5kYXJkIGJ1aWx0aW4gcGFyc2VyIEFQSS5cclxuICpcclxuICogU2luY2UgdGhpcyBtZXRob2QgaXMgYXBwbGllZCB0byBzaW1wbGUgamF2YXNyaXB0IGV4cHJlc3Npb25zLCBhbmQgdGhlIHdvcmsgdG9cclxuICogYmUgZG9uZSBpcyBhY3R1YWxseSBxdWl0ZSBzaW1wbGUsIHdlIGFjdHVhbGx5IGNhbiBnZXQgYXdheSB3aXRoIG5vdCB1c2luZyBhXHJcbiAqIHBhcnNlciwgd2hpY2ggaGVscHMgd2l0aCB0aGUgY29kZSBzaXplLlxyXG4gKlxyXG4gKiBIZXJlIGlzIHRoZSBoZXVyaXN0aWMgdXNlZCBieSB0aGlzIG1ldGhvZCB0byBkZXRlcm1pbmUgaWYgYSB0b2tlbiBpcyBhXHJcbiAqIHZhcmlhYmxlOlxyXG4gKiAtIGJ5IGRlZmF1bHQsIGFsbCBzeW1ib2xzIGFyZSBjb25zaWRlcmVkIGEgdmFyaWFibGVcclxuICogLSB1bmxlc3MgdGhlIHByZXZpb3VzIHRva2VuIGlzIGEgZG90IChpbiB0aGF0IGNhc2UsIHRoaXMgaXMgYSBwcm9wZXJ0eTogYGEuYmApXHJcbiAqIC0gb3IgaWYgdGhlIHByZXZpb3VzIHRva2VuIGlzIGEgbGVmdCBicmFjZSBvciBhIGNvbW1hLCBhbmQgdGhlIG5leHQgdG9rZW4gaXNcclxuICogICBhIGNvbG9uIChpbiB0aGF0IGNhc2UsIHRoaXMgaXMgYW4gb2JqZWN0IGtleTogYHthOiBifWApXHJcbiAqXHJcbiAqIFNvbWUgc3BlY2lmaWMgY29kZSBpcyBhbHNvIHJlcXVpcmVkIHRvIHN1cHBvcnQgYXJyb3cgZnVuY3Rpb25zLiBJZiB3ZSBkZXRlY3RcclxuICogdGhlIGFycm93IG9wZXJhdG9yLCB0aGVuIHdlIGFkZCB0aGUgY3VycmVudCAob3Igc29tZSBwcmV2aW91cyB0b2tlbnMpIHRva2VuIHRvXHJcbiAqIHRoZSBsaXN0IG9mIHZhcmlhYmxlcyBzbyBpdCBkb2VzIG5vdCBnZXQgcmVwbGFjZWQgYnkgYSBsb29rdXAgaW4gdGhlIGNvbnRleHRcclxuICovXHJcbmZ1bmN0aW9uIGNvbXBpbGVFeHByVG9BcnJheShleHByLCBzY29wZSkge1xyXG4gICAgc2NvcGUgPSBPYmplY3QuY3JlYXRlKHNjb3BlKTtcclxuICAgIGNvbnN0IHRva2VucyA9IHRva2VuaXplKGV4cHIpO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b2tlbnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBsZXQgdG9rZW4gPSB0b2tlbnNbaV07XHJcbiAgICAgICAgbGV0IHByZXZUb2tlbiA9IHRva2Vuc1tpIC0gMV07XHJcbiAgICAgICAgbGV0IG5leHRUb2tlbiA9IHRva2Vuc1tpICsgMV07XHJcbiAgICAgICAgbGV0IGlzVmFyID0gdG9rZW4udHlwZSA9PT0gXCJTWU1CT0xcIiAmJiAhUkVTRVJWRURfV09SRFMuaW5jbHVkZXModG9rZW4udmFsdWUpO1xyXG4gICAgICAgIGlmICh0b2tlbi50eXBlID09PSBcIlNZTUJPTFwiICYmICFSRVNFUlZFRF9XT1JEUy5pbmNsdWRlcyh0b2tlbi52YWx1ZSkpIHtcclxuICAgICAgICAgICAgaWYgKHByZXZUb2tlbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKHByZXZUb2tlbi50eXBlID09PSBcIk9QRVJBVE9SXCIgJiYgcHJldlRva2VuLnZhbHVlID09PSBcIi5cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlzVmFyID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIGlmIChwcmV2VG9rZW4udHlwZSA9PT0gXCJMRUZUX0JSQUNFXCIgfHwgcHJldlRva2VuLnR5cGUgPT09IFwiQ09NTUFcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZXh0VG9rZW4gJiYgbmV4dFRva2VuLnR5cGUgPT09IFwiQ09MT05cIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc1ZhciA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobmV4dFRva2VuICYmIG5leHRUb2tlbi50eXBlID09PSBcIk9QRVJBVE9SXCIgJiYgbmV4dFRva2VuLnZhbHVlID09PSBcIj0+XCIpIHtcclxuICAgICAgICAgICAgaWYgKHRva2VuLnR5cGUgPT09IFwiUklHSFRfUEFSRU5cIikge1xyXG4gICAgICAgICAgICAgICAgbGV0IGogPSBpIC0gMTtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChqID4gMCAmJiB0b2tlbnNbal0udHlwZSAhPT0gXCJMRUZUX1BBUkVOXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW5zW2pdLnR5cGUgPT09IFwiU1lNQk9MXCIgJiYgdG9rZW5zW2pdLm9yaWdpbmFsVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5zW2pdLnZhbHVlID0gdG9rZW5zW2pdLm9yaWdpbmFsVmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlW3Rva2Vuc1tqXS52YWx1ZV0gPSB7IGlkOiB0b2tlbnNbal0udmFsdWUsIGV4cHI6IHRva2Vuc1tqXS52YWx1ZSB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBqLS07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZVt0b2tlbi52YWx1ZV0gPSB7IGlkOiB0b2tlbi52YWx1ZSwgZXhwcjogdG9rZW4udmFsdWUgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNWYXIpIHtcclxuICAgICAgICAgICAgdG9rZW4udmFyTmFtZSA9IHRva2VuLnZhbHVlO1xyXG4gICAgICAgICAgICBpZiAodG9rZW4udmFsdWUgaW4gc2NvcGUgJiYgXCJpZFwiIGluIHNjb3BlW3Rva2VuLnZhbHVlXSkge1xyXG4gICAgICAgICAgICAgICAgdG9rZW4udmFsdWUgPSBzY29wZVt0b2tlbi52YWx1ZV0uZXhwcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRva2VuLm9yaWdpbmFsVmFsdWUgPSB0b2tlbi52YWx1ZTtcclxuICAgICAgICAgICAgICAgIHRva2VuLnZhbHVlID0gYHNjb3BlWycke3Rva2VuLnZhbHVlfSddYDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiB0b2tlbnM7XHJcbn1cclxuZnVuY3Rpb24gY29tcGlsZUV4cHIoZXhwciwgc2NvcGUpIHtcclxuICAgIHJldHVybiBjb21waWxlRXhwclRvQXJyYXkoZXhwciwgc2NvcGUpXHJcbiAgICAgICAgLm1hcCh0ID0+IHQudmFsdWUpXHJcbiAgICAgICAgLmpvaW4oXCJcIik7XHJcbn1cblxuY29uc3QgSU5URVJQX1JFR0VYUCA9IC9cXHtcXHsuKj9cXH1cXH0vZztcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gQ29tcGlsYXRpb24gQ29udGV4dFxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5jbGFzcyBDb21waWxhdGlvbkNvbnRleHQge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSkge1xyXG4gICAgICAgIHRoaXMuY29kZSA9IFtdO1xyXG4gICAgICAgIHRoaXMudmFyaWFibGVzID0ge307XHJcbiAgICAgICAgdGhpcy5lc2NhcGluZyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMucGFyZW50Tm9kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5wYXJlbnRUZXh0Tm9kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5yb290Tm9kZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5pbmRlbnRMZXZlbCA9IDA7XHJcbiAgICAgICAgdGhpcy5zaG91bGREZWZpbmVQYXJlbnQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNob3VsZERlZmluZVNjb3BlID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5wcm90ZWN0ZWRTY29wZU51bWJlciA9IDA7XHJcbiAgICAgICAgdGhpcy5zaG91bGREZWZpbmVRV2ViID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zaG91bGREZWZpbmVVdGlscyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2hvdWxkRGVmaW5lUmVmcyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuc2hvdWxkRGVmaW5lUmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICB0aGlzLmxvb3BOdW1iZXIgPSAwO1xyXG4gICAgICAgIHRoaXMuaW5QcmVUYWcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmFsbG93TXVsdGlwbGVSb290cyA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaGFzUGFyZW50V2lkZ2V0ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5oYXNLZXkwID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5rZXlTdGFjayA9IFtdO1xyXG4gICAgICAgIHRoaXMucm9vdENvbnRleHQgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMudGVtcGxhdGVOYW1lID0gbmFtZSB8fCBcIm5vbmFtZVwiO1xyXG4gICAgICAgIHRoaXMuYWRkTGluZShcImxldCBoID0gdGhpcy5oO1wiKTtcclxuICAgIH1cclxuICAgIGdlbmVyYXRlSUQoKSB7XHJcbiAgICAgICAgcmV0dXJuIENvbXBpbGF0aW9uQ29udGV4dC5uZXh0SUQrKztcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBtZXRob2QgZ2VuZXJhdGVzIGEgXCJ0ZW1wbGF0ZSBrZXlcIiwgd2hpY2ggaXMgYmFzaWNhbGx5IGEgdW5pcXVlIGtleVxyXG4gICAgICogd2hpY2ggZGVwZW5kcyBvbiB0aGUgY3VycmVudGx5IHNldCBrZXlzLCBhbmQgb24gdGhlIGl0ZXJhdGlvbiBudW1iZXJzIChpZlxyXG4gICAgICogd2UgYXJlIGluIGEgbG9vcCkuXHJcbiAgICAgKlxyXG4gICAgICogU3VjaCBhIGtleSBpcyBuZWNlc3Nhcnkgd2hlbiB3ZSBuZWVkIHRvIGFzc29jaWF0ZSBhbiBpZCB0byBzb21lIGVsZW1lbnRcclxuICAgICAqIGdlbmVyYXRlZCBieSBhIHRlbXBsYXRlIChmb3IgZXhhbXBsZSwgYSBjb21wb25lbnQpXHJcbiAgICAgKi9cclxuICAgIGdlbmVyYXRlVGVtcGxhdGVLZXkocHJlZml4ID0gXCJcIikge1xyXG4gICAgICAgIGNvbnN0IGlkID0gdGhpcy5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgaWYgKHRoaXMubG9vcE51bWJlciA9PT0gMCAmJiAhdGhpcy5oYXNLZXkwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBgJyR7cHJlZml4fV9fJHtpZH1fXydgO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQga2V5ID0gYFxcYCR7cHJlZml4fV9fJHtpZH1fX2A7XHJcbiAgICAgICAgbGV0IHN0YXJ0ID0gdGhpcy5oYXNLZXkwID8gMCA6IDE7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0OyBpIDwgdGhpcy5sb29wTnVtYmVyICsgMTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGtleSArPSBgXFwke2tleSR7aX19X19gO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmFkZExpbmUoYGxldCBrJHtpZH0gPSAke2tleX1cXGA7YCk7XHJcbiAgICAgICAgcmV0dXJuIGBrJHtpZH1gO1xyXG4gICAgfVxyXG4gICAgZ2VuZXJhdGVDb2RlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZERlZmluZVJlc3VsdCkge1xyXG4gICAgICAgICAgICB0aGlzLmNvZGUudW5zaGlmdChcIiAgICBsZXQgcmVzdWx0O1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvdWxkRGVmaW5lU2NvcGUpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2RlLnVuc2hpZnQoXCIgICAgbGV0IHNjb3BlID0gT2JqZWN0LmNyZWF0ZShjb250ZXh0KTtcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZERlZmluZVJlZnMpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2RlLnVuc2hpZnQoXCIgICAgY29udGV4dC5fX293bF9fLnJlZnMgPSBjb250ZXh0Ll9fb3dsX18ucmVmcyB8fCB7fTtcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZERlZmluZVBhcmVudCkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5oYXNQYXJlbnRXaWRnZXQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29kZS51bnNoaWZ0KFwiICAgIGxldCBwYXJlbnQgPSBleHRyYS5wYXJlbnQ7XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb2RlLnVuc2hpZnQoXCIgICAgbGV0IHBhcmVudCA9IGNvbnRleHQ7XCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNob3VsZERlZmluZVFXZWIpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2RlLnVuc2hpZnQoXCIgICAgbGV0IFFXZWIgPSB0aGlzLmNvbnN0cnVjdG9yO1wiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuc2hvdWxkRGVmaW5lVXRpbHMpIHtcclxuICAgICAgICAgICAgdGhpcy5jb2RlLnVuc2hpZnQoXCIgICAgbGV0IHV0aWxzID0gdGhpcy5jb25zdHJ1Y3Rvci51dGlscztcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmNvZGU7XHJcbiAgICB9XHJcbiAgICB3aXRoUGFyZW50KG5vZGUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYWxsb3dNdWx0aXBsZVJvb3RzICYmXHJcbiAgICAgICAgICAgIHRoaXMgPT09IHRoaXMucm9vdENvbnRleHQgJiZcclxuICAgICAgICAgICAgKHRoaXMucGFyZW50Tm9kZSB8fCB0aGlzLnBhcmVudFRleHROb2RlKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBIHRlbXBsYXRlIHNob3VsZCBub3QgaGF2ZSBtb3JlIHRoYW4gb25lIHJvb3Qgbm9kZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLnJvb3RDb250ZXh0LnJvb3ROb2RlKSB7XHJcbiAgICAgICAgICAgIHRoaXMucm9vdENvbnRleHQucm9vdE5vZGUgPSBub2RlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIXRoaXMucGFyZW50Tm9kZSAmJiB0aGlzLnJvb3RDb250ZXh0LnNob3VsZERlZmluZVJlc3VsdCkge1xyXG4gICAgICAgICAgICB0aGlzLmFkZExpbmUoYHJlc3VsdCA9IHZuJHtub2RlfTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3ViQ29udGV4dChcInBhcmVudE5vZGVcIiwgbm9kZSk7XHJcbiAgICB9XHJcbiAgICBzdWJDb250ZXh0KGtleSwgdmFsdWUpIHtcclxuICAgICAgICBjb25zdCBuZXdDb250ZXh0ID0gT2JqZWN0LmNyZWF0ZSh0aGlzKTtcclxuICAgICAgICBuZXdDb250ZXh0W2tleV0gPSB2YWx1ZTtcclxuICAgICAgICByZXR1cm4gbmV3Q29udGV4dDtcclxuICAgIH1cclxuICAgIGluZGVudCgpIHtcclxuICAgICAgICB0aGlzLnJvb3RDb250ZXh0LmluZGVudExldmVsKys7XHJcbiAgICB9XHJcbiAgICBkZWRlbnQoKSB7XHJcbiAgICAgICAgdGhpcy5yb290Q29udGV4dC5pbmRlbnRMZXZlbC0tO1xyXG4gICAgfVxyXG4gICAgYWRkTGluZShsaW5lKSB7XHJcbiAgICAgICAgY29uc3QgcHJlZml4ID0gbmV3IEFycmF5KHRoaXMuaW5kZW50TGV2ZWwgKyAyKS5qb2luKFwiICAgIFwiKTtcclxuICAgICAgICB0aGlzLmNvZGUucHVzaChwcmVmaXggKyBsaW5lKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb2RlLmxlbmd0aCAtIDE7XHJcbiAgICB9XHJcbiAgICBhZGRJZihjb25kaXRpb24pIHtcclxuICAgICAgICB0aGlzLmFkZExpbmUoYGlmICgke2NvbmRpdGlvbn0pIHtgKTtcclxuICAgICAgICB0aGlzLmluZGVudCgpO1xyXG4gICAgfVxyXG4gICAgYWRkRWxzZSgpIHtcclxuICAgICAgICB0aGlzLmRlZGVudCgpO1xyXG4gICAgICAgIHRoaXMuYWRkTGluZShcIn0gZWxzZSB7XCIpO1xyXG4gICAgICAgIHRoaXMuaW5kZW50KCk7XHJcbiAgICB9XHJcbiAgICBjbG9zZUlmKCkge1xyXG4gICAgICAgIHRoaXMuZGVkZW50KCk7XHJcbiAgICAgICAgdGhpcy5hZGRMaW5lKFwifVwiKTtcclxuICAgIH1cclxuICAgIGdldFZhbHVlKHZhbCkge1xyXG4gICAgICAgIHJldHVybiB2YWwgaW4gdGhpcy52YXJpYWJsZXMgPyB0aGlzLmdldFZhbHVlKHRoaXMudmFyaWFibGVzW3ZhbF0pIDogdmFsO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQcmVwYXJlIGFuIGV4cHJlc3Npb24gZm9yIGJlaW5nIGNvbnN1bWVkIGF0IHJlbmRlciB0aW1lLiAgSXRzIG1haW4gam9iXHJcbiAgICAgKiBpcyB0b1xyXG4gICAgICogLSByZXBsYWNlIHVua25vd24gdmFyaWFibGVzIGJ5IGEgbG9va3VwIGluIHRoZSBjb250ZXh0XHJcbiAgICAgKiAtIHJlcGxhY2UgYWxyZWFkeSBkZWZpbmVkIHZhcmlhYmxlcyBieSB0aGVpciBpbnRlcm5hbCBuYW1lXHJcbiAgICAgKi9cclxuICAgIGZvcm1hdEV4cHJlc3Npb24oZXhwcikge1xyXG4gICAgICAgIHRoaXMucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lU2NvcGUgPSB0cnVlO1xyXG4gICAgICAgIHJldHVybiBjb21waWxlRXhwcihleHByLCB0aGlzLnZhcmlhYmxlcyk7XHJcbiAgICB9XHJcbiAgICBjYXB0dXJlRXhwcmVzc2lvbihleHByKSB7XHJcbiAgICAgICAgdGhpcy5yb290Q29udGV4dC5zaG91bGREZWZpbmVTY29wZSA9IHRydWU7XHJcbiAgICAgICAgY29uc3QgYXJnSWQgPSB0aGlzLmdlbmVyYXRlSUQoKTtcclxuICAgICAgICBjb25zdCB0b2tlbnMgPSBjb21waWxlRXhwclRvQXJyYXkoZXhwciwgdGhpcy52YXJpYWJsZXMpO1xyXG4gICAgICAgIGNvbnN0IGRvbmUgPSBuZXcgU2V0KCk7XHJcbiAgICAgICAgcmV0dXJuIHRva2Vuc1xyXG4gICAgICAgICAgICAubWFwKHRvayA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0b2sudmFyTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFkb25lLmhhcyh0b2sudmFyTmFtZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICBkb25lLmFkZCh0b2sudmFyTmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRMaW5lKGBjb25zdCAke3Rvay52YXJOYW1lfV8ke2FyZ0lkfSA9ICR7dG9rLnZhbHVlfTtgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRvay52YWx1ZSA9IGAke3Rvay52YXJOYW1lfV8ke2FyZ0lkfWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRvay52YWx1ZTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuam9pbihcIlwiKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUGVyZm9ybSBzdHJpbmcgaW50ZXJwb2xhdGlvbiBvbiB0aGUgZ2l2ZW4gc3RyaW5nLiBOb3RlIHRoYXQgaWYgdGhlIHdob2xlXHJcbiAgICAgKiBzdHJpbmcgaXMgYW4gZXhwcmVzc2lvbiwgaXQgc2ltcGx5IHJldHVybnMgaXQgKGZvcm1hdHRlZCBhbmQgZW5jbG9zZWQgaW5cclxuICAgICAqIHBhcmVudGhlc2VzKS5cclxuICAgICAqIEZvciBpbnN0YW5jZTpcclxuICAgICAqICAgJ0hlbGxvIHt7eH19IScgLT4gYEhlbGxvICR7eH1gXHJcbiAgICAgKiAgICd7e3ggPyAnYSc6ICdiJ319JyAtPiAoeCA/ICdhJyA6ICdiJylcclxuICAgICAqL1xyXG4gICAgaW50ZXJwb2xhdGUocykge1xyXG4gICAgICAgIGxldCBtYXRjaGVzID0gcy5tYXRjaChJTlRFUlBfUkVHRVhQKTtcclxuICAgICAgICBpZiAobWF0Y2hlcyAmJiBtYXRjaGVzWzBdLmxlbmd0aCA9PT0gcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGAoJHt0aGlzLmZvcm1hdEV4cHJlc3Npb24ocy5zbGljZSgyLCAtMikpfSlgO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgciA9IHMucmVwbGFjZSgvXFx7XFx7Lio/XFx9XFx9L2csIHMgPT4gXCIke1wiICsgdGhpcy5mb3JtYXRFeHByZXNzaW9uKHMuc2xpY2UoMiwgLTIpKSArIFwifVwiKTtcclxuICAgICAgICByZXR1cm4gXCJgXCIgKyByICsgXCJgXCI7XHJcbiAgICB9XHJcbiAgICBzdGFydFByb3RlY3RTY29wZShjb2RlQmxvY2spIHtcclxuICAgICAgICBjb25zdCBwcm90ZWN0SUQgPSB0aGlzLmdlbmVyYXRlSUQoKTtcclxuICAgICAgICB0aGlzLnJvb3RDb250ZXh0LnByb3RlY3RlZFNjb3BlTnVtYmVyKys7XHJcbiAgICAgICAgdGhpcy5yb290Q29udGV4dC5zaG91bGREZWZpbmVTY29wZSA9IHRydWU7XHJcbiAgICAgICAgY29uc3Qgc2NvcGVFeHByID0gYE9iamVjdC5jcmVhdGUoc2NvcGUpO2A7XHJcbiAgICAgICAgdGhpcy5hZGRMaW5lKGBsZXQgX29yaWdTY29wZSR7cHJvdGVjdElEfSA9IHNjb3BlO2ApO1xyXG4gICAgICAgIHRoaXMuYWRkTGluZShgc2NvcGUgPSAke3Njb3BlRXhwcn1gKTtcclxuICAgICAgICBpZiAoIWNvZGVCbG9jaykge1xyXG4gICAgICAgICAgICB0aGlzLmFkZExpbmUoYHNjb3BlLl9fYWNjZXNzX21vZGVfXyA9ICdybyc7YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwcm90ZWN0SUQ7XHJcbiAgICB9XHJcbiAgICBzdG9wUHJvdGVjdFNjb3BlKHByb3RlY3RJRCkge1xyXG4gICAgICAgIHRoaXMucm9vdENvbnRleHQucHJvdGVjdGVkU2NvcGVOdW1iZXItLTtcclxuICAgICAgICB0aGlzLmFkZExpbmUoYHNjb3BlID0gX29yaWdTY29wZSR7cHJvdGVjdElEfTtgKTtcclxuICAgIH1cclxufVxyXG5Db21waWxhdGlvbkNvbnRleHQubmV4dElEID0gMTtcblxuY29uc3QgYnJvd3NlciA9IHtcclxuICAgIHNldFRpbWVvdXQ6IHdpbmRvdy5zZXRUaW1lb3V0LmJpbmQod2luZG93KSxcclxuICAgIGNsZWFyVGltZW91dDogd2luZG93LmNsZWFyVGltZW91dC5iaW5kKHdpbmRvdyksXHJcbiAgICBzZXRJbnRlcnZhbDogd2luZG93LnNldEludGVydmFsLmJpbmQod2luZG93KSxcclxuICAgIGNsZWFySW50ZXJ2YWw6IHdpbmRvdy5jbGVhckludGVydmFsLmJpbmQod2luZG93KSxcclxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZTogd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZS5iaW5kKHdpbmRvdyksXHJcbiAgICByYW5kb206IE1hdGgucmFuZG9tLFxyXG4gICAgRGF0ZTogd2luZG93LkRhdGUsXHJcbiAgICBmZXRjaDogKHdpbmRvdy5mZXRjaCB8fCAoKCkgPT4geyB9KSkuYmluZCh3aW5kb3cpLFxyXG4gICAgbG9jYWxTdG9yYWdlOiB3aW5kb3cubG9jYWxTdG9yYWdlXHJcbn07XG5cbi8qKlxyXG4gKiBPd2wgVXRpbHNcclxuICpcclxuICogV2UgaGF2ZSBoZXJlIGEgc21hbGwgY29sbGVjdGlvbiBvZiB1dGlsaXR5IGZ1bmN0aW9uczpcclxuICpcclxuICogLSB3aGVuUmVhZHlcclxuICogLSBsb2FkSlNcclxuICogLSBsb2FkRmlsZVxyXG4gKiAtIGVzY2FwZVxyXG4gKiAtIGRlYm91bmNlXHJcbiAqL1xyXG5mdW5jdGlvbiB3aGVuUmVhZHkoZm4pIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkge1xyXG4gICAgICAgIGlmIChkb2N1bWVudC5yZWFkeVN0YXRlICE9PSBcImxvYWRpbmdcIikge1xyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCByZXNvbHZlLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSkudGhlbihmbiB8fCBmdW5jdGlvbiAoKSB7IH0pO1xyXG59XHJcbmNvbnN0IGxvYWRlZFNjcmlwdHMgPSB7fTtcclxuZnVuY3Rpb24gbG9hZEpTKHVybCkge1xyXG4gICAgaWYgKHVybCBpbiBsb2FkZWRTY3JpcHRzKSB7XHJcbiAgICAgICAgcmV0dXJuIGxvYWRlZFNjcmlwdHNbdXJsXTtcclxuICAgIH1cclxuICAgIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgY29uc3Qgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtcclxuICAgICAgICBzY3JpcHQudHlwZSA9IFwidGV4dC9qYXZhc2NyaXB0XCI7XHJcbiAgICAgICAgc2NyaXB0LnNyYyA9IHVybDtcclxuICAgICAgICBzY3JpcHQub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBzY3JpcHQub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmVqZWN0KGBFcnJvciBsb2FkaW5nIGZpbGUgJyR7dXJsfSdgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGhlYWQgPSBkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXTtcclxuICAgICAgICBoZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7XHJcbiAgICB9KTtcclxuICAgIGxvYWRlZFNjcmlwdHNbdXJsXSA9IHByb21pc2U7XHJcbiAgICByZXR1cm4gcHJvbWlzZTtcclxufVxyXG5hc3luYyBmdW5jdGlvbiBsb2FkRmlsZSh1cmwpIHtcclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGJyb3dzZXIuZmV0Y2godXJsKTtcclxuICAgIGlmICghcmVzdWx0Lm9rKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiRXJyb3Igd2hpbGUgZmV0Y2hpbmcgeG1sIHRlbXBsYXRlc1wiKTtcclxuICAgIH1cclxuICAgIHJldHVybiBhd2FpdCByZXN1bHQudGV4dCgpO1xyXG59XHJcbmZ1bmN0aW9uIGVzY2FwZShzdHIpIHtcclxuICAgIGlmIChzdHIgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBzdHIgPT09IFwibnVtYmVyXCIpIHtcclxuICAgICAgICByZXR1cm4gU3RyaW5nKHN0cik7XHJcbiAgICB9XHJcbiAgICBjb25zdCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XHJcbiAgICBwLnRleHRDb250ZW50ID0gc3RyO1xyXG4gICAgcmV0dXJuIHAuaW5uZXJIVE1MO1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgZnVuY3Rpb24sIHRoYXQsIGFzIGxvbmcgYXMgaXQgY29udGludWVzIHRvIGJlIGludm9rZWQsIHdpbGwgbm90XHJcbiAqIGJlIHRyaWdnZXJlZC4gVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGl0IHN0b3BzIGJlaW5nIGNhbGxlZCBmb3JcclxuICogTiBtaWxsaXNlY29uZHMuIElmIGBpbW1lZGlhdGVgIGlzIHBhc3NlZCwgdHJpZ2dlciB0aGUgZnVuY3Rpb24gb24gdGhlXHJcbiAqIGxlYWRpbmcgZWRnZSwgaW5zdGVhZCBvZiB0aGUgdHJhaWxpbmcuXHJcbiAqXHJcbiAqIEluc3BpcmVkIGJ5IGh0dHBzOi8vZGF2aWR3YWxzaC5uYW1lL2phdmFzY3JpcHQtZGVib3VuY2UtZnVuY3Rpb25cclxuICovXHJcbmZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkge1xyXG4gICAgbGV0IHRpbWVvdXQ7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzO1xyXG4gICAgICAgIGNvbnN0IGFyZ3MgPSBhcmd1bWVudHM7XHJcbiAgICAgICAgZnVuY3Rpb24gbGF0ZXIoKSB7XHJcbiAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xyXG4gICAgICAgICAgICBpZiAoIWltbWVkaWF0ZSkge1xyXG4gICAgICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjYWxsTm93ID0gaW1tZWRpYXRlICYmICF0aW1lb3V0O1xyXG4gICAgICAgIGJyb3dzZXIuY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xyXG4gICAgICAgIHRpbWVvdXQgPSBicm93c2VyLnNldFRpbWVvdXQobGF0ZXIsIHdhaXQpO1xyXG4gICAgICAgIGlmIChjYWxsTm93KSB7XHJcbiAgICAgICAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5mdW5jdGlvbiBzaGFsbG93RXF1YWwocDEsIHAyKSB7XHJcbiAgICBmb3IgKGxldCBrIGluIHAxKSB7XHJcbiAgICAgICAgaWYgKHAxW2tdICE9PSBwMltrXSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cblxudmFyIF91dGlscyA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHtcbiAgICBfX3Byb3RvX186IG51bGwsXG4gICAgd2hlblJlYWR5OiB3aGVuUmVhZHksXG4gICAgbG9hZEpTOiBsb2FkSlMsXG4gICAgbG9hZEZpbGU6IGxvYWRGaWxlLFxuICAgIGVzY2FwZTogZXNjYXBlLFxuICAgIGRlYm91bmNlOiBkZWJvdW5jZSxcbiAgICBzaGFsbG93RXF1YWw6IHNoYWxsb3dFcXVhbFxufSk7XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIENvbnN0L2dsb2JhbCBzdHVmZi9oZWxwZXJzXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbmNvbnN0IERJU0FCTEVEX1RBR1MgPSBbXCJpbnB1dFwiLCBcInRleHRhcmVhXCIsIFwiYnV0dG9uXCIsIFwic2VsZWN0XCIsIFwib3B0aW9uXCIsIFwib3B0Z3JvdXBcIl07XHJcbmNvbnN0IFRSQU5TTEFUQUJMRV9BVFRSUyA9IFtcImxhYmVsXCIsIFwidGl0bGVcIiwgXCJwbGFjZWhvbGRlclwiLCBcImFsdFwiXTtcclxuY29uc3QgbGluZUJyZWFrUkUgPSAvW1xcclxcbl0vO1xyXG5jb25zdCB3aGl0ZXNwYWNlUkUgPSAvXFxzKy9nO1xyXG5jb25zdCBOT0RFX0hPT0tTX1BBUkFNUyA9IHtcclxuICAgIGNyZWF0ZTogXCIoXywgbilcIixcclxuICAgIGluc2VydDogXCJ2blwiLFxyXG4gICAgcmVtb3ZlOiBcIih2biwgcm0pXCIsXHJcbiAgICBkZXN0cm95OiBcIigpXCJcclxufTtcclxuZnVuY3Rpb24gaXNDb21wb25lbnQob2JqKSB7XHJcbiAgICByZXR1cm4gb2JqICYmIG9iai5oYXNPd25Qcm9wZXJ0eShcIl9fb3dsX19cIik7XHJcbn1cclxuY29uc3QgVVRJTFMgPSB7XHJcbiAgICB6ZXJvOiBTeW1ib2woXCJ6ZXJvXCIpLFxyXG4gICAgdG9PYmooZXhwcikge1xyXG4gICAgICAgIGlmICh0eXBlb2YgZXhwciA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICBleHByID0gZXhwci50cmltKCk7XHJcbiAgICAgICAgICAgIGlmICghZXhwcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCB3b3JkcyA9IGV4cHIuc3BsaXQoL1xccysvKTtcclxuICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHt9O1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHRbd29yZHNbaV1dID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZXhwcjtcclxuICAgIH0sXHJcbiAgICBzaGFsbG93RXF1YWwsXHJcbiAgICBhZGROYW1lU3BhY2Uodm5vZGUpIHtcclxuICAgICAgICBhZGROUyh2bm9kZS5kYXRhLCB2bm9kZS5jaGlsZHJlbiwgdm5vZGUuc2VsKTtcclxuICAgIH0sXHJcbiAgICBWRG9tQXJyYXk6IGNsYXNzIFZEb21BcnJheSBleHRlbmRzIEFycmF5IHtcclxuICAgIH0sXHJcbiAgICB2RG9tVG9TdHJpbmc6IGZ1bmN0aW9uICh2ZG9tKSB7XHJcbiAgICAgICAgcmV0dXJuIHZkb21cclxuICAgICAgICAgICAgLm1hcCh2bm9kZSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh2bm9kZS5zZWwpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHZub2RlLnNlbCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBwYXRjaChub2RlLCB2bm9kZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmVsbS5vdXRlckhUTUw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdm5vZGUudGV4dDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5qb2luKFwiXCIpO1xyXG4gICAgfSxcclxuICAgIGdldENvbXBvbmVudChvYmopIHtcclxuICAgICAgICB3aGlsZSAob2JqICYmICFpc0NvbXBvbmVudChvYmopKSB7XHJcbiAgICAgICAgICAgIG9iaiA9IG9iai5fX3Byb3RvX187XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvYmo7XHJcbiAgICB9LFxyXG4gICAgZ2V0U2NvcGUob2JqLCBwcm9wZXJ0eSkge1xyXG4gICAgICAgIGNvbnN0IG9iajAgPSBvYmo7XHJcbiAgICAgICAgd2hpbGUgKG9iaiAmJlxyXG4gICAgICAgICAgICAhb2JqLmhhc093blByb3BlcnR5KHByb3BlcnR5KSAmJlxyXG4gICAgICAgICAgICAhKG9iai5oYXNPd25Qcm9wZXJ0eShcIl9fYWNjZXNzX21vZGVfX1wiKSAmJiBvYmouX19hY2Nlc3NfbW9kZV9fID09PSBcInJvXCIpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld09iaiA9IG9iai5fX3Byb3RvX187XHJcbiAgICAgICAgICAgIGlmICghbmV3T2JqIHx8IGlzQ29tcG9uZW50KG5ld09iaikpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvYmowO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG9iaiA9IG5ld09iajtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG9iajtcclxuICAgIH1cclxufTtcclxuZnVuY3Rpb24gcGFyc2VYTUwoeG1sKSB7XHJcbiAgICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7XHJcbiAgICBjb25zdCBkb2MgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKHhtbCwgXCJ0ZXh0L3htbFwiKTtcclxuICAgIGlmIChkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJwYXJzZXJlcnJvclwiKS5sZW5ndGgpIHtcclxuICAgICAgICBsZXQgbXNnID0gXCJJbnZhbGlkIFhNTCBpbiB0ZW1wbGF0ZS5cIjtcclxuICAgICAgICBjb25zdCBwYXJzZXJlcnJvclRleHQgPSBkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJwYXJzZXJlcnJvclwiKVswXS50ZXh0Q29udGVudDtcclxuICAgICAgICBpZiAocGFyc2VyZXJyb3JUZXh0KSB7XHJcbiAgICAgICAgICAgIG1zZyArPSBcIlxcblRoZSBwYXJzZXIgaGFzIHByb2R1Y2VkIHRoZSBmb2xsb3dpbmcgZXJyb3IgbWVzc2FnZTpcXG5cIiArIHBhcnNlcmVycm9yVGV4dDtcclxuICAgICAgICAgICAgY29uc3QgcmUgPSAvXFxkKy9nO1xyXG4gICAgICAgICAgICBjb25zdCBmaXJzdE1hdGNoID0gcmUuZXhlYyhwYXJzZXJlcnJvclRleHQpO1xyXG4gICAgICAgICAgICBpZiAoZmlyc3RNYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGluZU51bWJlciA9IE51bWJlcihmaXJzdE1hdGNoWzBdKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSB4bWwuc3BsaXQoXCJcXG5cIilbbGluZU51bWJlciAtIDFdO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc2Vjb25kTWF0Y2ggPSByZS5leGVjKHBhcnNlcmVycm9yVGV4dCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobGluZSAmJiBzZWNvbmRNYXRjaCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbHVtbkluZGV4ID0gTnVtYmVyKHNlY29uZE1hdGNoWzBdKSAtIDE7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmVbY29sdW1uSW5kZXhdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1zZyArPVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYFxcblRoZSBlcnJvciBtaWdodCBiZSBsb2NhdGVkIGF0IHhtbCBsaW5lICR7bGluZU51bWJlcn0gY29sdW1uICR7Y29sdW1uSW5kZXh9XFxuYCArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYCR7bGluZX1cXG4ke1wiLVwiLnJlcGVhdChjb2x1bW5JbmRleCAtIDEpfV5gO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IobXNnKTtcclxuICAgIH1cclxuICAgIHJldHVybiBkb2M7XHJcbn1cclxuZnVuY3Rpb24gZXNjYXBlUXVvdGVzKHN0cikge1xyXG4gICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cXCcvZywgXCJcXFxcJ1wiKTtcclxufVxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBRV2ViIHJlbmRlcmluZyBlbmdpbmVcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY2xhc3MgUVdlYiBleHRlbmRzIEV2ZW50QnVzIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZyA9IHt9KSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmggPSBoO1xyXG4gICAgICAgIC8vIHJlY3Vyc2l2ZVRlbXBsYXRlcyBjb250YWlucyBzdWIgdGVtcGxhdGVzIGNhbGxlZCB3aXRoIHQtY2FsbCwgYnV0IHdoaWNoXHJcbiAgICAgICAgLy8gZW5kcyB1cCBpbiByZWN1cnNpdmUgc2l0dWF0aW9ucy4gIFRoaXMgaXMgdmVyeSBzaW1pbGFyIHRvIHRoZSBzbG90IHNpdHVhdGlvbixcclxuICAgICAgICAvLyBhcyBpbiB3ZSBuZWVkIHRvIHByb3BhZ2F0ZSB0aGUgc2NvcGUuXHJcbiAgICAgICAgdGhpcy5zdWJUZW1wbGF0ZXMgPSB7fTtcclxuICAgICAgICB0aGlzLmlzVXBkYXRpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnRlbXBsYXRlcyA9IE9iamVjdC5jcmVhdGUoUVdlYi5URU1QTEFURVMpO1xyXG4gICAgICAgIGlmIChjb25maWcudGVtcGxhdGVzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkVGVtcGxhdGVzKGNvbmZpZy50ZW1wbGF0ZXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY29uZmlnLnRyYW5zbGF0ZUZuKSB7XHJcbiAgICAgICAgICAgIHRoaXMudHJhbnNsYXRlRm4gPSBjb25maWcudHJhbnNsYXRlRm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc3RhdGljIGFkZERpcmVjdGl2ZShkaXJlY3RpdmUpIHtcclxuICAgICAgICBpZiAoZGlyZWN0aXZlLm5hbWUgaW4gUVdlYi5ESVJFQ1RJVkVfTkFNRVMpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBEaXJlY3RpdmUgXCIke2RpcmVjdGl2ZS5uYW1lfSBhbHJlYWR5IHJlZ2lzdGVyZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgUVdlYi5ESVJFQ1RJVkVTLnB1c2goZGlyZWN0aXZlKTtcclxuICAgICAgICBRV2ViLkRJUkVDVElWRV9OQU1FU1tkaXJlY3RpdmUubmFtZV0gPSAxO1xyXG4gICAgICAgIFFXZWIuRElSRUNUSVZFUy5zb3J0KChkMSwgZDIpID0+IGQxLnByaW9yaXR5IC0gZDIucHJpb3JpdHkpO1xyXG4gICAgICAgIGlmIChkaXJlY3RpdmUuZXh0cmFOYW1lcykge1xyXG4gICAgICAgICAgICBkaXJlY3RpdmUuZXh0cmFOYW1lcy5mb3JFYWNoKG4gPT4gKFFXZWIuRElSRUNUSVZFX05BTUVTW25dID0gMSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHN0YXRpYyByZWdpc3RlckNvbXBvbmVudChuYW1lLCBDb21wb25lbnQpIHtcclxuICAgICAgICBpZiAoUVdlYi5jb21wb25lbnRzW25hbWVdKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ29tcG9uZW50ICcke25hbWV9JyBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgUVdlYi5jb21wb25lbnRzW25hbWVdID0gQ29tcG9uZW50O1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZWdpc3RlciBnbG9iYWxseSBhIHRlbXBsYXRlLiAgQWxsIFFXZWIgaW5zdGFuY2VzIHdpbGwgb2J0YWluIHRoZWlyXHJcbiAgICAgKiB0ZW1wbGF0ZXMgZnJvbSB0aGVpciBvd24gdGVtcGxhdGUgbWFwLCBhbmQgdGhlbiwgZnJvbSB0aGUgZ2xvYmFsIHN0YXRpY1xyXG4gICAgICogVEVNUExBVEVTIHByb3BlcnR5LlxyXG4gICAgICovXHJcbiAgICBzdGF0aWMgcmVnaXN0ZXJUZW1wbGF0ZShuYW1lLCB0ZW1wbGF0ZSkge1xyXG4gICAgICAgIGlmIChRV2ViLlRFTVBMQVRFU1tuYW1lXSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRlbXBsYXRlICcke25hbWV9JyBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcXdlYiA9IG5ldyBRV2ViKCk7XHJcbiAgICAgICAgcXdlYi5hZGRUZW1wbGF0ZShuYW1lLCB0ZW1wbGF0ZSk7XHJcbiAgICAgICAgUVdlYi5URU1QTEFURVNbbmFtZV0gPSBxd2ViLnRlbXBsYXRlc1tuYW1lXTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQWRkIGEgdGVtcGxhdGUgdG8gdGhlIGludGVybmFsIHRlbXBsYXRlIG1hcC4gIE5vdGUgdGhhdCBpdCBpcyBub3RcclxuICAgICAqIGltbWVkaWF0ZWx5IGNvbXBpbGVkLlxyXG4gICAgICovXHJcbiAgICBhZGRUZW1wbGF0ZShuYW1lLCB4bWxTdHJpbmcsIGFsbG93RHVwbGljYXRlKSB7XHJcbiAgICAgICAgaWYgKGFsbG93RHVwbGljYXRlICYmIG5hbWUgaW4gdGhpcy50ZW1wbGF0ZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkb2MgPSBwYXJzZVhNTCh4bWxTdHJpbmcpO1xyXG4gICAgICAgIGlmICghZG9jLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCB0ZW1wbGF0ZSAoc2hvdWxkIG5vdCBiZSBlbXB0eSlcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2FkZFRlbXBsYXRlKG5hbWUsIGRvYy5maXJzdENoaWxkKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogTG9hZCB0ZW1wbGF0ZXMgZnJvbSBhIHhtbCAoYXMgYSBzdHJpbmcgb3IgeG1sIGRvY3VtZW50KS4gIFRoaXMgd2lsbCBsb29rIHVwXHJcbiAgICAgKiBmb3IgdGhlIGZpcnN0IDx0ZW1wbGF0ZXM+IHRhZywgYW5kIHdpbGwgY29uc2lkZXIgZWFjaCBjaGlsZCBvZiB0aGlzIGFzIGFcclxuICAgICAqIHRlbXBsYXRlLCB3aXRoIHRoZSBuYW1lIGdpdmVuIGJ5IHRoZSB0LW5hbWUgYXR0cmlidXRlLlxyXG4gICAgICovXHJcbiAgICBhZGRUZW1wbGF0ZXMoeG1sc3RyKSB7XHJcbiAgICAgICAgY29uc3QgZG9jID0gdHlwZW9mIHhtbHN0ciA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlWE1MKHhtbHN0cikgOiB4bWxzdHI7XHJcbiAgICAgICAgY29uc3QgdGVtcGxhdGVzID0gZG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwidGVtcGxhdGVzXCIpWzBdO1xyXG4gICAgICAgIGlmICghdGVtcGxhdGVzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgZWxlbSBvZiB0ZW1wbGF0ZXMuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IGVsZW0uZ2V0QXR0cmlidXRlKFwidC1uYW1lXCIpO1xyXG4gICAgICAgICAgICB0aGlzLl9hZGRUZW1wbGF0ZShuYW1lLCBlbGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfYWRkVGVtcGxhdGUobmFtZSwgZWxlbSkge1xyXG4gICAgICAgIGlmIChuYW1lIGluIHRoaXMudGVtcGxhdGVzKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVGVtcGxhdGUgJHtuYW1lfSBhbHJlYWR5IGRlZmluZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fcHJvY2Vzc1RlbXBsYXRlKGVsZW0pO1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlID0ge1xyXG4gICAgICAgICAgICBlbGVtLFxyXG4gICAgICAgICAgICBmbjogZnVuY3Rpb24gKGNvbnRleHQsIGV4dHJhKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb21waWxlZEZ1bmN0aW9uID0gdGhpcy5fY29tcGlsZShuYW1lLCBlbGVtKTtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlLmZuID0gY29tcGlsZWRGdW5jdGlvbjtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb21waWxlZEZ1bmN0aW9uLmNhbGwodGhpcywgY29udGV4dCwgZXh0cmEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnRlbXBsYXRlc1tuYW1lXSA9IHRlbXBsYXRlO1xyXG4gICAgfVxyXG4gICAgX3Byb2Nlc3NUZW1wbGF0ZShlbGVtKSB7XHJcbiAgICAgICAgbGV0IHRicmFuY2ggPSBlbGVtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbdC1lbGlmXSwgW3QtZWxzZV1cIik7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlsZW4gPSB0YnJhbmNoLmxlbmd0aDsgaSA8IGlsZW47IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgbm9kZSA9IHRicmFuY2hbaV07XHJcbiAgICAgICAgICAgIGxldCBwcmV2RWxlbSA9IG5vZGUucHJldmlvdXNFbGVtZW50U2libGluZztcclxuICAgICAgICAgICAgbGV0IHBhdHRyID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcmV2RWxlbS5nZXRBdHRyaWJ1dGUobmFtZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGxldCBuYXR0ciA9IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gKyEhbm9kZS5nZXRBdHRyaWJ1dGUobmFtZSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGlmIChwcmV2RWxlbSAmJiAocGF0dHIoXCJ0LWlmXCIpIHx8IHBhdHRyKFwidC1lbGlmXCIpKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHBhdHRyKFwidC1mb3JlYWNoXCIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidC1pZiBjYW5ub3Qgc3RheSBhdCB0aGUgc2FtZSBsZXZlbCBhcyB0LWZvcmVhY2ggd2hlbiB1c2luZyB0LWVsaWYgb3IgdC1lbHNlXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKFtcInQtaWZcIiwgXCJ0LWVsaWZcIiwgXCJ0LWVsc2VcIl0ubWFwKG5hdHRyKS5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSArIGI7XHJcbiAgICAgICAgICAgICAgICB9KSA+IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPbmx5IG9uZSBjb25kaXRpb25hbCBicmFuY2hpbmcgZGlyZWN0aXZlIGlzIGFsbG93ZWQgcGVyIG5vZGVcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBBbGwgdGV4dCAod2l0aCBvbmx5IHNwYWNlcykgYW5kIGNvbW1lbnQgbm9kZXMgKG5vZGVUeXBlIDgpIGJldHdlZW5cclxuICAgICAgICAgICAgICAgIC8vIGJyYW5jaCBub2RlcyBhcmUgcmVtb3ZlZFxyXG4gICAgICAgICAgICAgICAgbGV0IHRleHROb2RlO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKCh0ZXh0Tm9kZSA9IG5vZGUucHJldmlvdXNTaWJsaW5nKSAhPT0gcHJldkVsZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGV4dE5vZGUubm9kZVZhbHVlLnRyaW0oKS5sZW5ndGggJiYgdGV4dE5vZGUubm9kZVR5cGUgIT09IDgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGV4dCBpcyBub3QgYWxsb3dlZCBiZXR3ZWVuIGJyYW5jaGluZyBkaXJlY3RpdmVzXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB0ZXh0Tm9kZS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInQtZWxpZiBhbmQgdC1lbHNlIGRpcmVjdGl2ZXMgbXVzdCBiZSBwcmVjZWRlZCBieSBhIHQtaWYgb3IgdC1lbGlmIGRpcmVjdGl2ZVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVuZGVyIGEgdGVtcGxhdGVcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSB0aGUgdGVtcGxhdGUgc2hvdWxkIGFscmVhZHkgaGF2ZSBiZWVuIGFkZGVkXHJcbiAgICAgKi9cclxuICAgIHJlbmRlcihuYW1lLCBjb250ZXh0ID0ge30sIGV4dHJhID0gbnVsbCkge1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlID0gdGhpcy50ZW1wbGF0ZXNbbmFtZV07XHJcbiAgICAgICAgaWYgKCF0ZW1wbGF0ZSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRlbXBsYXRlICR7bmFtZX0gZG9lcyBub3QgZXhpc3RgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlLmZuLmNhbGwodGhpcywgY29udGV4dCwgZXh0cmEpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW5kZXIgYSB0ZW1wbGF0ZSB0byBhIGh0bWwgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCB0aGlzIGlzIG1vcmUgbGltaXRlZCB0aGFuIHRoZSBgcmVuZGVyYCBtZXRob2Q6IGl0IGlzIG5vdCBzdWl0YWJsZVxyXG4gICAgICogdG8gcmVuZGVyIGEgZnVsbCBjb21wb25lbnQgdHJlZSwgc2luY2UgdGhpcyBpcyBhbiBhc3luY2hyb25vdXMgb3BlcmF0aW9uLlxyXG4gICAgICogVGhpcyBtZXRob2QgY2FuIG9ubHkgcmVuZGVyIHRlbXBsYXRlcyB3aXRob3V0IGNvbXBvbmVudHMuXHJcbiAgICAgKi9cclxuICAgIHJlbmRlclRvU3RyaW5nKG5hbWUsIGNvbnRleHQgPSB7fSwgZXh0cmEpIHtcclxuICAgICAgICBjb25zdCB2bm9kZSA9IHRoaXMucmVuZGVyKG5hbWUsIGNvbnRleHQsIGV4dHJhKTtcclxuICAgICAgICBpZiAodm5vZGUuc2VsID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZub2RlLnRleHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IG5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHZub2RlLnNlbCk7XHJcbiAgICAgICAgY29uc3QgZWxlbSA9IHBhdGNoKG5vZGUsIHZub2RlKS5lbG07XHJcbiAgICAgICAgZnVuY3Rpb24gZXNjYXBlVGV4dE5vZGVzKG5vZGUpIHtcclxuICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDMpIHtcclxuICAgICAgICAgICAgICAgIG5vZGUudGV4dENvbnRlbnQgPSBlc2NhcGUobm9kZS50ZXh0Q29udGVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZm9yIChsZXQgbiBvZiBub2RlLmNoaWxkTm9kZXMpIHtcclxuICAgICAgICAgICAgICAgIGVzY2FwZVRleHROb2RlcyhuKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlc2NhcGVUZXh0Tm9kZXMoZWxlbSk7XHJcbiAgICAgICAgcmV0dXJuIGVsZW0ub3V0ZXJIVE1MO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBGb3JjZSBhbGwgd2lkZ2V0cyBjb25uZWN0ZWQgdG8gdGhpcyBRV2ViIGluc3RhbmNlIHRvIHJlcmVuZGVyIHRoZW1zZWx2ZXMuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBtZXRob2QgaXMgbW9zdGx5IHVzZWZ1bCBmb3IgZXh0ZXJuYWwgY29kZSB0aGF0IHdhbnQgdG8gbW9kaWZ5IHRoZVxyXG4gICAgICogYXBwbGljYXRpb24gaW4gc29tZSBjYXNlcy4gIEZvciBleGFtcGxlLCBhIHJvdXRlciBwbHVnaW4uXHJcbiAgICAgKi9cclxuICAgIGZvcmNlVXBkYXRlKCkge1xyXG4gICAgICAgIHRoaXMuaXNVcGRhdGluZyA9IHRydWU7XHJcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVXBkYXRpbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaXNVcGRhdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50cmlnZ2VyKFwidXBkYXRlXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBfY29tcGlsZShuYW1lLCBlbGVtLCBwYXJlbnRDb250ZXh0LCBkZWZpbmVLZXkpIHtcclxuICAgICAgICBjb25zdCBpc0RlYnVnID0gZWxlbS5hdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KFwidC1kZWJ1Z1wiKTtcclxuICAgICAgICBjb25zdCBjdHggPSBuZXcgQ29tcGlsYXRpb25Db250ZXh0KG5hbWUpO1xyXG4gICAgICAgIGlmIChlbGVtLnRhZ05hbWUgIT09IFwidFwiKSB7XHJcbiAgICAgICAgICAgIGN0eC5zaG91bGREZWZpbmVSZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHBhcmVudENvbnRleHQpIHtcclxuICAgICAgICAgICAgY3R4LnZhcmlhYmxlcyA9IE9iamVjdC5jcmVhdGUocGFyZW50Q29udGV4dC52YXJpYWJsZXMpO1xyXG4gICAgICAgICAgICBjdHgucGFyZW50Tm9kZSA9IHBhcmVudENvbnRleHQucGFyZW50Tm9kZSB8fCBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgICAgICBjdHguYWxsb3dNdWx0aXBsZVJvb3RzID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3R4Lmhhc1BhcmVudFdpZGdldCA9IHRydWU7XHJcbiAgICAgICAgICAgIGN0eC5zaG91bGREZWZpbmVSZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCBjJHtjdHgucGFyZW50Tm9kZX0gPSBleHRyYS5wYXJlbnROb2RlO2ApO1xyXG4gICAgICAgICAgICBpZiAoZGVmaW5lS2V5KSB7XHJcbiAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IGtleTAgPSBleHRyYS5rZXkgfHwgXCJcIjtgKTtcclxuICAgICAgICAgICAgICAgIGN0eC5oYXNLZXkwID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9jb21waWxlTm9kZShlbGVtLCBjdHgpO1xyXG4gICAgICAgIGlmICghcGFyZW50Q29udGV4dCkge1xyXG4gICAgICAgICAgICBpZiAoY3R4LnNob3VsZERlZmluZVJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYHJldHVybiByZXN1bHQ7YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWN0eC5yb290Tm9kZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQSB0ZW1wbGF0ZSBzaG91bGQgaGF2ZSBvbmUgcm9vdCBub2RlICgke2N0eC50ZW1wbGF0ZU5hbWV9KWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYHJldHVybiB2biR7Y3R4LnJvb3ROb2RlfTtgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgY29kZSA9IGN0eC5nZW5lcmF0ZUNvZGUoKTtcclxuICAgICAgICBjb25zdCB0ZW1wbGF0ZU5hbWUgPSBjdHgudGVtcGxhdGVOYW1lLnJlcGxhY2UoL2AvZywgXCInXCIpLnNsaWNlKDAsIDIwMCk7XHJcbiAgICAgICAgY29kZS51bnNoaWZ0KGAgICAgLy8gVGVtcGxhdGUgbmFtZTogXCIke3RlbXBsYXRlTmFtZX1cImApO1xyXG4gICAgICAgIGxldCB0ZW1wbGF0ZTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZSA9IG5ldyBGdW5jdGlvbihcImNvbnRleHQsIGV4dHJhXCIsIGNvZGUuam9pbihcIlxcblwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQoYEludmFsaWQgQ29kZSBnZW5lcmF0ZWQgYnkgJHt0ZW1wbGF0ZU5hbWV9YCk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2Fybihjb2RlLmpvaW4oXCJcXG5cIikpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBnZW5lcmF0ZWQgY29kZSB3aGlsZSBjb21waWxpbmcgdGVtcGxhdGUgJyR7dGVtcGxhdGVOYW1lfSc6ICR7ZS5tZXNzYWdlfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaXNEZWJ1Zykge1xyXG4gICAgICAgICAgICBjb25zdCB0cGwgPSB0aGlzLnRlbXBsYXRlc1tuYW1lXTtcclxuICAgICAgICAgICAgaWYgKHRwbCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbXNnID0gYFRlbXBsYXRlOiAke3RwbC5lbGVtLm91dGVySFRNTH1cXG5Db21waWxlZCBjb2RlOlxcbiR7dGVtcGxhdGUudG9TdHJpbmcoKX1gO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cobXNnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGVtcGxhdGU7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEdlbmVyYXRlIGNvZGUgZnJvbSBhbiB4bWwgbm9kZVxyXG4gICAgICpcclxuICAgICAqL1xyXG4gICAgX2NvbXBpbGVOb2RlKG5vZGUsIGN0eCkge1xyXG4gICAgICAgIGlmICghKG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50KSkge1xyXG4gICAgICAgICAgICAvLyB0aGlzIGlzIGEgdGV4dCBub2RlLCB0aGVyZSBhcmUgbm8gZGlyZWN0aXZlIHRvIGFwcGx5XHJcbiAgICAgICAgICAgIGxldCB0ZXh0ID0gbm9kZS50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgaWYgKCFjdHguaW5QcmVUYWcpIHtcclxuICAgICAgICAgICAgICAgIGlmIChsaW5lQnJlYWtSRS50ZXN0KHRleHQpICYmICF0ZXh0LnRyaW0oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2Uod2hpdGVzcGFjZVJFLCBcIiBcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNsYXRlRm4pIHtcclxuICAgICAgICAgICAgICAgIGlmIChub2RlLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKFwidC10cmFuc2xhdGlvblwiKSAhPT0gXCJvZmZcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQgPSB0aGlzLnRyYW5zbGF0ZUZuKHRleHQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjdHgucGFyZW50Tm9kZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgYyR7Y3R4LnBhcmVudE5vZGV9LnB1c2goe3RleHQ6IFxcYCR7dGV4dH1cXGB9KTtgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKG5vZGUubm9kZVR5cGUgPT09IDgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgYyR7Y3R4LnBhcmVudE5vZGV9LnB1c2goaCgnIScsIFxcYCR7dGV4dH1cXGApKTtgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChjdHgucGFyZW50VGV4dE5vZGUpIHtcclxuICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGB2biR7Y3R4LnBhcmVudFRleHROb2RlfS50ZXh0ICs9IFxcYCR7dGV4dH1cXGA7YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIGFuIHVudXN1YWwgc2l0dWF0aW9uOiB0aGlzIHRleHQgbm9kZSBpcyB0aGUgcmVzdWx0IG9mIHRoZVxyXG4gICAgICAgICAgICAgICAgLy8gdGVtcGxhdGUgcmVuZGVyaW5nLlxyXG4gICAgICAgICAgICAgICAgbGV0IG5vZGVJRCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IHZuJHtub2RlSUR9ID0ge3RleHQ6IFxcYCR7dGV4dH1cXGB9O2ApO1xyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYHJlc3VsdCA9IHZuJHtub2RlSUR9O2ApO1xyXG4gICAgICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnJvb3ROb2RlID0gbm9kZUlEO1xyXG4gICAgICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnBhcmVudFRleHROb2RlID0gbm9kZUlEO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZmlyc3RMZXR0ZXIgPSBub2RlLnRhZ05hbWVbMF07XHJcbiAgICAgICAgaWYgKGZpcnN0TGV0dGVyID09PSBmaXJzdExldHRlci50b1VwcGVyQ2FzZSgpKSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMgaXMgYSBjb21wb25lbnQsIHdlIG1vZGlmeSBpbiBwbGFjZSB0aGUgeG1sIGRvY3VtZW50IHRvIGNoYW5nZVxyXG4gICAgICAgICAgICAvLyA8U29tZUNvbXBvbmVudCAuLi4gLz4gdG8gPHQgdC1jb21wb25lbnQ9XCJTb21lQ29tcG9uZW50XCIgLi4uIC8+XHJcbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKFwidC1jb21wb25lbnRcIiwgbm9kZS50YWdOYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAobm9kZS50YWdOYW1lICE9PSBcInRcIiAmJiBub2RlLmhhc0F0dHJpYnV0ZShcInQtY29tcG9uZW50XCIpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRGlyZWN0aXZlICd0LWNvbXBvbmVudCcgY2FuIG9ubHkgYmUgdXNlZCBvbiA8dD4gbm9kZXMgKHVzZWQgb24gYSA8JHtub2RlLnRhZ05hbWV9PilgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IG5vZGUuYXR0cmlidXRlcztcclxuICAgICAgICBjb25zdCB2YWxpZERpcmVjdGl2ZXMgPSBbXTtcclxuICAgICAgICBjb25zdCBmaW5hbGl6ZXJzID0gW107XHJcbiAgICAgICAgLy8gbWF5YmUgdGhpcyBpcyBub3Qgb3B0aW1hbDogd2UgaXRlcmF0ZSBvbiBhbGwgYXR0cmlidXRlcyBoZXJlLCBhbmQgYWdhaW5cclxuICAgICAgICAvLyBqdXN0IGFmdGVyIGZvciBlYWNoIGRpcmVjdGl2ZS5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGF0dHJpYnV0ZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGF0dHJOYW1lID0gYXR0cmlidXRlc1tpXS5uYW1lO1xyXG4gICAgICAgICAgICBpZiAoYXR0ck5hbWUuc3RhcnRzV2l0aChcInQtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZE5hbWUgPSBhdHRyTmFtZS5zbGljZSgyKS5zcGxpdCgvLXxcXC4vKVswXTtcclxuICAgICAgICAgICAgICAgIGlmICghKGROYW1lIGluIFFXZWIuRElSRUNUSVZFX05BTUVTKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBRV2ViIGRpcmVjdGl2ZTogJyR7YXR0ck5hbWV9J2ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKG5vZGUudGFnTmFtZSAhPT0gXCJ0XCIgJiYgKGF0dHJOYW1lID09PSBcInQtZXNjXCIgfHwgYXR0ck5hbWUgPT09IFwidC1yYXdcIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHROb2RlLnNldEF0dHJpYnV0ZShhdHRyTmFtZSwgbm9kZS5nZXRBdHRyaWJ1dGUoYXR0ck5hbWUpKTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBjaGlsZCBvZiBBcnJheS5mcm9tKG5vZGUuY2hpbGROb2RlcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdE5vZGUuYXBwZW5kQ2hpbGQoY2hpbGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZENoaWxkKHROb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZShhdHRyTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgRElSX04gPSBRV2ViLkRJUkVDVElWRVMubGVuZ3RoO1xyXG4gICAgICAgIGNvbnN0IEFUVFJfTiA9IGF0dHJpYnV0ZXMubGVuZ3RoO1xyXG4gICAgICAgIGxldCB3aXRoSGFuZGxlcnMgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IERJUl9OOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGRpcmVjdGl2ZSA9IFFXZWIuRElSRUNUSVZFU1tpXTtcclxuICAgICAgICAgICAgbGV0IGZ1bGxOYW1lO1xyXG4gICAgICAgICAgICBsZXQgdmFsdWU7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgQVRUUl9OOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBhdHRyaWJ1dGVzW2pdLm5hbWU7XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gXCJ0LVwiICsgZGlyZWN0aXZlLm5hbWUgfHxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lLnN0YXJ0c1dpdGgoXCJ0LVwiICsgZGlyZWN0aXZlLm5hbWUgKyBcIi1cIikgfHxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lLnN0YXJ0c1dpdGgoXCJ0LVwiICsgZGlyZWN0aXZlLm5hbWUgKyBcIi5cIikpIHtcclxuICAgICAgICAgICAgICAgICAgICBmdWxsTmFtZSA9IG5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBhdHRyaWJ1dGVzW2pdLnRleHRDb250ZW50O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhbGlkRGlyZWN0aXZlcy5wdXNoKHsgZGlyZWN0aXZlLCB2YWx1ZSwgZnVsbE5hbWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpcmVjdGl2ZS5uYW1lID09PSBcIm9uXCIgfHwgZGlyZWN0aXZlLm5hbWUgPT09IFwibW9kZWxcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aXRoSGFuZGxlcnMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCB7IGRpcmVjdGl2ZSwgdmFsdWUsIGZ1bGxOYW1lIH0gb2YgdmFsaWREaXJlY3RpdmVzKSB7XHJcbiAgICAgICAgICAgIGlmIChkaXJlY3RpdmUuZmluYWxpemUpIHtcclxuICAgICAgICAgICAgICAgIGZpbmFsaXplcnMucHVzaCh7IGRpcmVjdGl2ZSwgdmFsdWUsIGZ1bGxOYW1lIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChkaXJlY3RpdmUuYXROb2RlRW5jb3VudGVyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpc0RvbmUgPSBkaXJlY3RpdmUuYXROb2RlRW5jb3VudGVyKHtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICAgICAgICAgIHF3ZWI6IHRoaXMsXHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bGxOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGlmIChpc0RvbmUpIHtcclxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB7IGRpcmVjdGl2ZSwgdmFsdWUsIGZ1bGxOYW1lIH0gb2YgZmluYWxpemVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3RpdmUuZmluYWxpemUoeyBub2RlLCBxd2ViOiB0aGlzLCBjdHgsIGZ1bGxOYW1lLCB2YWx1ZSB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChub2RlLm5vZGVOYW1lICE9PSBcInRcIikge1xyXG4gICAgICAgICAgICBsZXQgbm9kZUlEID0gdGhpcy5fY29tcGlsZUdlbmVyaWNOb2RlKG5vZGUsIGN0eCwgd2l0aEhhbmRsZXJzKTtcclxuICAgICAgICAgICAgY3R4ID0gY3R4LndpdGhQYXJlbnQobm9kZUlEKTtcclxuICAgICAgICAgICAgbGV0IG5vZGVIb29rcyA9IHt9O1xyXG4gICAgICAgICAgICBsZXQgYWRkTm9kZUhvb2sgPSBmdW5jdGlvbiAoaG9vaywgaGFuZGxlcikge1xyXG4gICAgICAgICAgICAgICAgbm9kZUhvb2tzW2hvb2tdID0gbm9kZUhvb2tzW2hvb2tdIHx8IFtdO1xyXG4gICAgICAgICAgICAgICAgbm9kZUhvb2tzW2hvb2tdLnB1c2goaGFuZGxlcik7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGZvciAobGV0IHsgZGlyZWN0aXZlLCB2YWx1ZSwgZnVsbE5hbWUgfSBvZiB2YWxpZERpcmVjdGl2ZXMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChkaXJlY3RpdmUuYXROb2RlQ3JlYXRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBkaXJlY3RpdmUuYXROb2RlQ3JlYXRpb24oe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBxd2ViOiB0aGlzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdHgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bGxOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbm9kZUlELFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGROb2RlSG9va1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhub2RlSG9va3MpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYHAke25vZGVJRH0uaG9vayA9IHtgKTtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGhvb2sgaW4gbm9kZUhvb2tzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYCAgJHtob29rfTogJHtOT0RFX0hPT0tTX1BBUkFNU1tob29rXX0gPT4ge2ApO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGhhbmRsZXIgb2Ygbm9kZUhvb2tzW2hvb2tdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGAgICAgJHtoYW5kbGVyfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgICB9LGApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYH07YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT09IFwicHJlXCIpIHtcclxuICAgICAgICAgICAgY3R4ID0gY3R4LnN1YkNvbnRleHQoXCJpblByZVRhZ1wiLCB0cnVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fY29tcGlsZUNoaWxkcmVuKG5vZGUsIGN0eCk7XHJcbiAgICAgICAgLy8gc3ZnIHN1cHBvcnRcclxuICAgICAgICAvLyB3ZSBoYWRkIHN2ZyBuYW1lc3BhY2UgaWYgaXQgaXMgYSBzdmcgb3IgaWYgaXQgaXMgYSBnLCBidXQgb25seSBpZiBpdCBpc1xyXG4gICAgICAgIC8vIHRoZSByb290IG5vZGUuICBUaGlzIGlzIHRoZSBlYXNpZXN0IHdheSB0byBzdXBwb3J0IHN2ZyBzdWIgY29tcG9uZW50czpcclxuICAgICAgICAvLyB0aGV5IG5lZWQgdG8gaGF2ZSBhIGcgdGFnIGFzIHJvb3QuIE90aGVyd2lzZSwgd2Ugd291bGQgbmVlZCBhIGNvbXBsZXRlXHJcbiAgICAgICAgLy8gbGlzdCBvZiBhbGxvd2VkIHN2ZyB0YWdzLlxyXG4gICAgICAgIGNvbnN0IHNob3VsZEFkZE5TID0gbm9kZS5ub2RlTmFtZSA9PT0gXCJzdmdcIiB8fCAobm9kZS5ub2RlTmFtZSA9PT0gXCJnXCIgJiYgY3R4LnJvb3ROb2RlID09PSBjdHgucGFyZW50Tm9kZSk7XHJcbiAgICAgICAgaWYgKHNob3VsZEFkZE5TKSB7XHJcbiAgICAgICAgICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVVdGlscyA9IHRydWU7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGB1dGlscy5hZGROYW1lU3BhY2Uodm4ke2N0eC5wYXJlbnROb2RlfSk7YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAobGV0IHsgZGlyZWN0aXZlLCB2YWx1ZSwgZnVsbE5hbWUgfSBvZiBmaW5hbGl6ZXJzKSB7XHJcbiAgICAgICAgICAgIGRpcmVjdGl2ZS5maW5hbGl6ZSh7IG5vZGUsIHF3ZWI6IHRoaXMsIGN0eCwgZnVsbE5hbWUsIHZhbHVlIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9jb21waWxlR2VuZXJpY05vZGUobm9kZSwgY3R4LCB3aXRoSGFuZGxlcnMgPSB0cnVlKSB7XHJcbiAgICAgICAgLy8gbm9kZVR5cGUgMSBpcyBnZW5lcmljIHRhZ1xyXG4gICAgICAgIGlmIChub2RlLm5vZGVUeXBlICE9PSAxKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcInVuc3VwcG9ydGVkIG5vZGUgdHlwZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IG5vZGUuYXR0cmlidXRlcztcclxuICAgICAgICBjb25zdCBhdHRycyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IHByb3BzID0gW107XHJcbiAgICAgICAgY29uc3QgdGF0dHJzID0gW107XHJcbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlQm9vbGVhblByb3BzKGtleSwgdmFsKSB7XHJcbiAgICAgICAgICAgIGxldCBpc1Byb3AgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT09IFwiaW5wdXRcIiAmJiBrZXkgPT09IFwiY2hlY2tlZFwiKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdHlwZSA9IG5vZGUuZ2V0QXR0cmlidXRlKFwidHlwZVwiKTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSBcImNoZWNrYm94XCIgfHwgdHlwZSA9PT0gXCJyYWRpb1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaXNQcm9wID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobm9kZS5ub2RlTmFtZSA9PT0gXCJvcHRpb25cIiAmJiBrZXkgPT09IFwic2VsZWN0ZWRcIikge1xyXG4gICAgICAgICAgICAgICAgaXNQcm9wID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoa2V5ID09PSBcImRpc2FibGVkXCIgJiYgRElTQUJMRURfVEFHUy5pbmRleE9mKG5vZGUubm9kZU5hbWUpID4gLTEpIHtcclxuICAgICAgICAgICAgICAgIGlzUHJvcCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKChrZXkgPT09IFwicmVhZG9ubHlcIiAmJiBub2RlLm5vZGVOYW1lID09PSBcImlucHV0XCIpIHx8IG5vZGUubm9kZU5hbWUgPT09IFwidGV4dGFyZWFcIikge1xyXG4gICAgICAgICAgICAgICAgaXNQcm9wID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaXNQcm9wKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9wcy5wdXNoKGAke2tleX06IF8ke3ZhbH1gKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgY2xhc3NPYmogPSBcIlwiO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXR0cmlidXRlcy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgbmFtZSA9IGF0dHJpYnV0ZXNbaV0ubmFtZTtcclxuICAgICAgICAgICAgbGV0IHZhbHVlID0gYXR0cmlidXRlc1tpXS50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgaWYgKHRoaXMudHJhbnNsYXRlRm4gJiYgVFJBTlNMQVRBQkxFX0FUVFJTLmluY2x1ZGVzKG5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHRoaXMudHJhbnNsYXRlRm4odmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHJlZ3VsYXIgYXR0cmlidXRlc1xyXG4gICAgICAgICAgICBpZiAoIW5hbWUuc3RhcnRzV2l0aChcInQtXCIpICYmICFub2RlLmdldEF0dHJpYnV0ZShcInQtYXR0Zi1cIiArIG5hbWUpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBhdHRJRCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZSA9PT0gXCJjbGFzc1wiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSA9IHZhbHVlLnRyaW0oKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNsYXNzRGVmID0gdmFsdWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdCgvXFxzKy8pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGEgPT4gYCcke2VzY2FwZVF1b3RlcyhhKX0nOnRydWVgKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oXCIsXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc09iaiA9IGBfJHtjdHguZ2VuZXJhdGVJRCgpfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgJHtjbGFzc09ian0gPSB7JHtjbGFzc0RlZn19O2ApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgXyR7YXR0SUR9ID0gJyR7ZXNjYXBlUXVvdGVzKHZhbHVlKX0nO2ApO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbmFtZS5tYXRjaCgvXlthLXpBLVpdKyQvKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhdHRyaWJ1dGUgY29udGFpbnMgJ25vbiBsZXR0ZXJzJyA9PiB3ZSB3YW50IHRvIHF1b3RlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSAnXCInICsgbmFtZSArICdcIic7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzLnB1c2goYCR7bmFtZX06IF8ke2F0dElEfWApO1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZUJvb2xlYW5Qcm9wcyhuYW1lLCBhdHRJRCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gZHluYW1pYyBhdHRyaWJ1dGVzXHJcbiAgICAgICAgICAgIGlmIChuYW1lLnN0YXJ0c1dpdGgoXCJ0LWF0dC1cIikpIHtcclxuICAgICAgICAgICAgICAgIGxldCBhdHROYW1lID0gbmFtZS5zbGljZSg2KTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHYgPSBjdHguZ2V0VmFsdWUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGZvcm1hdHRlZFZhbHVlID0gdHlwZW9mIHYgPT09IFwic3RyaW5nXCIgPyBjdHguZm9ybWF0RXhwcmVzc2lvbih2KSA6IGBzY29wZS4ke3YuaWR9YDtcclxuICAgICAgICAgICAgICAgIGlmIChhdHROYW1lID09PSBcImNsYXNzXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZFZhbHVlID0gYHV0aWxzLnRvT2JqKCR7Zm9ybWF0dGVkVmFsdWV9KWA7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNsYXNzT2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBPYmplY3QuYXNzaWduKCR7Y2xhc3NPYmp9LCAke2Zvcm1hdHRlZFZhbHVlfSlgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzT2JqID0gYF8ke2N0eC5nZW5lcmF0ZUlEKCl9YDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCAke2NsYXNzT2JqfSA9ICR7Zm9ybWF0dGVkVmFsdWV9O2ApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dElEID0gY3R4LmdlbmVyYXRlSUQoKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWF0dE5hbWUubWF0Y2goL15bYS16QS1aXSskLykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXR0cmlidXRlIGNvbnRhaW5zICdub24gbGV0dGVycycgPT4gd2Ugd2FudCB0byBxdW90ZSBpdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHROYW1lID0gJ1wiJyArIGF0dE5hbWUgKyAnXCInO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGNvbWJpbmUgZHluYW1pYyB3aXRoIG5vbiBkeW5hbWljIGF0dHJpYnV0ZXM6XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY2xhc3M9XCJhXCIgdC1hdHQtY2xhc3M9XCIneW9wJ1wiIHNob3VsZCBiZSByZW5kZXJlZCBhcyBjbGFzcz1cImEgeW9wXCJcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRWYWx1ZSA9IG5vZGUuZ2V0QXR0cmlidXRlKGF0dE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhdHRWYWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRWYWx1ZUlEID0gY3R4LmdlbmVyYXRlSUQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCBfJHthdHRWYWx1ZUlEfSA9ICR7Zm9ybWF0dGVkVmFsdWV9O2ApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRWYWx1ZSA9IGAnJHthdHRWYWx1ZX0nICsgKF8ke2F0dFZhbHVlSUR9ID8gJyAnICsgXyR7YXR0VmFsdWVJRH0gOiAnJylgO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRySW5kZXggPSBhdHRycy5maW5kSW5kZXgoYXR0ID0+IGF0dC5zdGFydHNXaXRoKGF0dE5hbWUgKyBcIjpcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRycy5zcGxpY2UoYXR0ckluZGV4LCAxKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCBfJHthdHRJRH0gPSAke2Zvcm1hdHRlZFZhbHVlfTtgKTtcclxuICAgICAgICAgICAgICAgICAgICBhdHRycy5wdXNoKGAke2F0dE5hbWV9OiBfJHthdHRJRH1gKTtcclxuICAgICAgICAgICAgICAgICAgICBoYW5kbGVCb29sZWFuUHJvcHMoYXR0TmFtZSwgYXR0SUQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChuYW1lLnN0YXJ0c1dpdGgoXCJ0LWF0dGYtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYXR0TmFtZSA9IG5hbWUuc2xpY2UoNyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWF0dE5hbWUubWF0Y2goL15bYS16QS1aXSskLykpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBhdHRyaWJ1dGUgY29udGFpbnMgJ25vbiBsZXR0ZXJzJyA9PiB3ZSB3YW50IHRvIHF1b3RlIGl0XHJcbiAgICAgICAgICAgICAgICAgICAgYXR0TmFtZSA9ICdcIicgKyBhdHROYW1lICsgJ1wiJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZEV4cHIgPSBjdHguaW50ZXJwb2xhdGUodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgYXR0SUQgPSBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgICAgICAgICAgbGV0IHN0YXRpY1ZhbCA9IG5vZGUuZ2V0QXR0cmlidXRlKGF0dE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN0YXRpY1ZhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgXyR7YXR0SUR9ID0gJyR7c3RhdGljVmFsfSAnICsgJHtmb3JtYXR0ZWRFeHByfTtgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgXyR7YXR0SUR9ID0gJHtmb3JtYXR0ZWRFeHByfTtgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGF0dHJzLnB1c2goYCR7YXR0TmFtZX06IF8ke2F0dElEfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8vIHQtYXR0PSBhdHRyaWJ1dGVzXHJcbiAgICAgICAgICAgIGlmIChuYW1lID09PSBcInQtYXR0XCIpIHtcclxuICAgICAgICAgICAgICAgIGxldCBpZCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IF8ke2lkfSA9ICR7Y3R4LmZvcm1hdEV4cHJlc3Npb24odmFsdWUpfTtgKTtcclxuICAgICAgICAgICAgICAgIHRhdHRycy5wdXNoKGlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgbm9kZUlEID0gY3R4LmdlbmVyYXRlSUQoKTtcclxuICAgICAgICBsZXQga2V5ID0gY3R4Lmxvb3BOdW1iZXIgfHwgY3R4Lmhhc0tleTAgPyBgXFxgXFwke2tleSR7Y3R4Lmxvb3BOdW1iZXJ9fV8ke25vZGVJRH1cXGBgIDogbm9kZUlEO1xyXG4gICAgICAgIGNvbnN0IHBhcnRzID0gW2BrZXk6JHtrZXl9YF07XHJcbiAgICAgICAgaWYgKGF0dHJzLmxlbmd0aCArIHRhdHRycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHBhcnRzLnB1c2goYGF0dHJzOnske2F0dHJzLmpvaW4oXCIsXCIpfX1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHByb3BzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgcGFydHMucHVzaChgcHJvcHM6eyR7cHJvcHMuam9pbihcIixcIil9fWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY2xhc3NPYmopIHtcclxuICAgICAgICAgICAgcGFydHMucHVzaChgY2xhc3M6JHtjbGFzc09ian1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHdpdGhIYW5kbGVycykge1xyXG4gICAgICAgICAgICBwYXJ0cy5wdXNoKGBvbjp7fWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkTGluZShgbGV0IGMke25vZGVJRH0gPSBbXSwgcCR7bm9kZUlEfSA9IHske3BhcnRzLmpvaW4oXCIsXCIpfX07YCk7XHJcbiAgICAgICAgZm9yIChsZXQgaWQgb2YgdGF0dHJzKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRJZihgXyR7aWR9IGluc3RhbmNlb2YgQXJyYXlgKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHAke25vZGVJRH0uYXR0cnNbXyR7aWR9WzBdXSA9IF8ke2lkfVsxXTtgKTtcclxuICAgICAgICAgICAgY3R4LmFkZEVsc2UoKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGZvciAobGV0IGtleSBpbiBfJHtpZH0pIHtgKTtcclxuICAgICAgICAgICAgY3R4LmluZGVudCgpO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgcCR7bm9kZUlEfS5hdHRyc1trZXldID0gXyR7aWR9W2tleV07YCk7XHJcbiAgICAgICAgICAgIGN0eC5kZWRlbnQoKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYH1gKTtcclxuICAgICAgICAgICAgY3R4LmNsb3NlSWYoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCB2biR7bm9kZUlEfSA9IGgoJyR7bm9kZS5ub2RlTmFtZX0nLCBwJHtub2RlSUR9LCBjJHtub2RlSUR9KTtgKTtcclxuICAgICAgICBpZiAoY3R4LnBhcmVudE5vZGUpIHtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGMke2N0eC5wYXJlbnROb2RlfS5wdXNoKHZuJHtub2RlSUR9KTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY3R4Lmxvb3BOdW1iZXIgfHwgY3R4Lmhhc0tleTApIHtcclxuICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGByZXN1bHQgPSB2biR7bm9kZUlEfTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5vZGVJRDtcclxuICAgIH1cclxuICAgIF9jb21waWxlQ2hpbGRyZW4obm9kZSwgY3R4KSB7XHJcbiAgICAgICAgaWYgKG5vZGUuY2hpbGROb2Rlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGNoaWxkIG9mIEFycmF5LmZyb20obm9kZS5jaGlsZE5vZGVzKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY29tcGlsZU5vZGUoY2hpbGQsIGN0eCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuUVdlYi51dGlscyA9IFVUSUxTO1xyXG5RV2ViLmNvbXBvbmVudHMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG5RV2ViLkRJUkVDVElWRV9OQU1FUyA9IHtcclxuICAgIG5hbWU6IDEsXHJcbiAgICBhdHQ6IDEsXHJcbiAgICBhdHRmOiAxLFxyXG4gICAgdHJhbnNsYXRpb246IDFcclxufTtcclxuUVdlYi5ESVJFQ1RJVkVTID0gW107XHJcblFXZWIuVEVNUExBVEVTID0ge307XHJcblFXZWIubmV4dElkID0gMTtcclxuLy8gZGV2IG1vZGUgZW5hYmxlcyBiZXR0ZXIgZXJyb3IgbWVzc2FnZXMgb3IgbW9yZSBjb3N0bHkgdmFsaWRhdGlvbnNcclxuUVdlYi5kZXYgPSBmYWxzZTtcclxuLy8gc2xvdHMgY29udGFpbnMgc3ViIHRlbXBsYXRlcyBkZWZpbmVkIHdpdGggdC1zZXQgaW5zaWRlIHQtY29tcG9uZW50IG5vZGVzLCBhbmRcclxuLy8gYXJlIG1lYW50IHRvIGJlIHVzZWQgYnkgdGhlIHQtc2xvdCBkaXJlY3RpdmUuXHJcblFXZWIuc2xvdHMgPSB7fTtcclxuUVdlYi5uZXh0U2xvdElkID0gMTtcblxuY29uc3QgcGFyc2VyID0gbmV3IERPTVBhcnNlcigpO1xyXG5mdW5jdGlvbiBodG1sVG9WRE9NKGh0bWwpIHtcclxuICAgIGNvbnN0IGRvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoaHRtbCwgXCJ0ZXh0L2h0bWxcIik7XHJcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcclxuICAgIGZvciAobGV0IGNoaWxkIG9mIGRvYy5ib2R5LmNoaWxkTm9kZXMpIHtcclxuICAgICAgICByZXN1bHQucHVzaChodG1sVG9WTm9kZShjaGlsZCkpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxyXG5mdW5jdGlvbiBodG1sVG9WTm9kZShub2RlKSB7XHJcbiAgICBpZiAoIShub2RlIGluc3RhbmNlb2YgRWxlbWVudCkpIHtcclxuICAgICAgICByZXR1cm4geyB0ZXh0OiBub2RlLnRleHRDb250ZW50IH07XHJcbiAgICB9XHJcbiAgICBjb25zdCBhdHRycyA9IHt9O1xyXG4gICAgZm9yIChsZXQgYXR0ciBvZiBub2RlLmF0dHJpYnV0ZXMpIHtcclxuICAgICAgICBhdHRyc1thdHRyLm5hbWVdID0gYXR0ci50ZXh0Q29udGVudDtcclxuICAgIH1cclxuICAgIGNvbnN0IGNoaWxkcmVuID0gW107XHJcbiAgICBmb3IgKGxldCBjIG9mIG5vZGUuY2hpbGROb2Rlcykge1xyXG4gICAgICAgIGNoaWxkcmVuLnB1c2goaHRtbFRvVk5vZGUoYykpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGgobm9kZS50YWdOYW1lLCB7IGF0dHJzIH0sIGNoaWxkcmVuKTtcclxufVxuXG4vKipcclxuICogT3dsIFFXZWIgRGlyZWN0aXZlc1xyXG4gKlxyXG4gKiBUaGlzIGZpbGUgY29udGFpbnMgdGhlIGltcGxlbWVudGF0aW9uIG9mIG1vc3Qgc3RhbmRhcmQgUVdlYiBkaXJlY3RpdmVzOlxyXG4gKiAtIHQtZXNjXHJcbiAqIC0gdC1yYXdcclxuICogLSB0LXNldC90LXZhbHVlXHJcbiAqIC0gdC1pZi90LWVsaWYvdC1lbHNlXHJcbiAqIC0gdC1jYWxsXHJcbiAqIC0gdC1mb3JlYWNoL3QtYXNcclxuICogLSB0LWRlYnVnXHJcbiAqIC0gdC1sb2dcclxuICovXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtZXNjIGFuZCB0LXJhd1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5RV2ViLnV0aWxzLmh0bWxUb1ZET00gPSBodG1sVG9WRE9NO1xyXG5mdW5jdGlvbiBjb21waWxlVmFsdWVOb2RlKHZhbHVlLCBub2RlLCBxd2ViLCBjdHgpIHtcclxuICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVTY29wZSA9IHRydWU7XHJcbiAgICBpZiAodmFsdWUgPT09IFwiMFwiKSB7XHJcbiAgICAgICAgaWYgKGN0eC5wYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgIC8vIHRoZSAnemVybycgbWFnaWNhbCBzeW1ib2wgaXMgd2hlcmUgd2UgY2FuIGZpbmQgdGhlIHJlc3VsdCBvZiB0aGUgcmVuZGVyaW5nXHJcbiAgICAgICAgICAgIC8vIG9mICB0aGUgYm9keSBvZiB0aGUgdC1jYWxsLlxyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgICAgICBjb25zdCB6ZXJvQXJncyA9IGN0eC5lc2NhcGluZ1xyXG4gICAgICAgICAgICAgICAgPyBge3RleHQ6IHV0aWxzLnZEb21Ub1N0cmluZyhzY29wZVt1dGlscy56ZXJvXSl9YFxyXG4gICAgICAgICAgICAgICAgOiBgLi4uc2NvcGVbdXRpbHMuemVyb11gO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgYyR7Y3R4LnBhcmVudE5vZGV9LnB1c2goJHt6ZXJvQXJnc30pO2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBsZXQgZXhwcklEO1xyXG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgIGV4cHJJRCA9IGBfJHtjdHguZ2VuZXJhdGVJRCgpfWA7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCAke2V4cHJJRH0gPSAke2N0eC5mb3JtYXRFeHByZXNzaW9uKHZhbHVlKX07YCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICBleHBySUQgPSBgc2NvcGUuJHt2YWx1ZS5pZH1gO1xyXG4gICAgfVxyXG4gICAgY3R4LmFkZElmKGAke2V4cHJJRH0gIT0gbnVsbGApO1xyXG4gICAgaWYgKGN0eC5lc2NhcGluZykge1xyXG4gICAgICAgIGxldCBwcm90ZWN0SUQ7XHJcbiAgICAgICAgaWYgKHZhbHVlLmhhc0JvZHkpIHtcclxuICAgICAgICAgICAgcHJvdGVjdElEID0gY3R4LnN0YXJ0UHJvdGVjdFNjb3BlKCk7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGAke2V4cHJJRH0gPSAke2V4cHJJRH0gaW5zdGFuY2VvZiB1dGlscy5WRG9tQXJyYXkgPyB1dGlscy52RG9tVG9TdHJpbmcoJHtleHBySUR9KSA6ICR7ZXhwcklEfTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGN0eC5wYXJlbnRUZXh0Tm9kZSkge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgdm4ke2N0eC5wYXJlbnRUZXh0Tm9kZX0udGV4dCArPSAke2V4cHJJRH07YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGN0eC5wYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBjJHtjdHgucGFyZW50Tm9kZX0ucHVzaCh7dGV4dDogJHtleHBySUR9fSk7YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgbm9kZUlEID0gY3R4LmdlbmVyYXRlSUQoKTtcclxuICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnJvb3ROb2RlID0gbm9kZUlEO1xyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQucGFyZW50VGV4dE5vZGUgPSBub2RlSUQ7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgdm4ke25vZGVJRH0gPSB7dGV4dDogJHtleHBySUR9fTtgKTtcclxuICAgICAgICAgICAgaWYgKGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVSZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGN0eC5hZGRMaW5lKGByZXN1bHQgPSB2biR7bm9kZUlEfWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWx1ZS5oYXNCb2R5KSB7XHJcbiAgICAgICAgICAgIGN0eC5zdG9wUHJvdGVjdFNjb3BlKHByb3RlY3RJRCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVV0aWxzID0gdHJ1ZTtcclxuICAgICAgICBpZiAodmFsdWUuaGFzQm9keSkge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgY29uc3Qgdm5vZGVBcnJheSA9ICR7ZXhwcklEfSBpbnN0YW5jZW9mIHV0aWxzLlZEb21BcnJheSA/ICR7ZXhwcklEfSA6IHV0aWxzLmh0bWxUb1ZET00oJHtleHBySUR9KTtgKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGMke2N0eC5wYXJlbnROb2RlfS5wdXNoKC4uLnZub2RlQXJyYXkpO2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGMke2N0eC5wYXJlbnROb2RlfS5wdXNoKC4uLnV0aWxzLmh0bWxUb1ZET00oJHtleHBySUR9KSk7YCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaWYgKG5vZGUuY2hpbGROb2Rlcy5sZW5ndGgpIHtcclxuICAgICAgICBjdHguYWRkRWxzZSgpO1xyXG4gICAgICAgIHF3ZWIuX2NvbXBpbGVDaGlsZHJlbihub2RlLCBjdHgpO1xyXG4gICAgfVxyXG4gICAgY3R4LmNsb3NlSWYoKTtcclxufVxyXG5RV2ViLmFkZERpcmVjdGl2ZSh7XHJcbiAgICBuYW1lOiBcImVzY1wiLFxyXG4gICAgcHJpb3JpdHk6IDcwLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgbm9kZSwgcXdlYiwgY3R4IH0pIHtcclxuICAgICAgICBsZXQgdmFsdWUgPSBjdHguZ2V0VmFsdWUobm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LWVzY1wiKSk7XHJcbiAgICAgICAgY29tcGlsZVZhbHVlTm9kZSh2YWx1ZSwgbm9kZSwgcXdlYiwgY3R4LnN1YkNvbnRleHQoXCJlc2NhcGluZ1wiLCB0cnVlKSk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0pO1xyXG5RV2ViLmFkZERpcmVjdGl2ZSh7XHJcbiAgICBuYW1lOiBcInJhd1wiLFxyXG4gICAgcHJpb3JpdHk6IDgwLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgbm9kZSwgcXdlYiwgY3R4IH0pIHtcclxuICAgICAgICBsZXQgdmFsdWUgPSBjdHguZ2V0VmFsdWUobm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LXJhd1wiKSk7XHJcbiAgICAgICAgY29tcGlsZVZhbHVlTm9kZSh2YWx1ZSwgbm9kZSwgcXdlYiwgY3R4KTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtc2V0XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwic2V0XCIsXHJcbiAgICBleHRyYU5hbWVzOiBbXCJ2YWx1ZVwiXSxcclxuICAgIHByaW9yaXR5OiA2MCxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IG5vZGUsIHF3ZWIsIGN0eCB9KSB7XHJcbiAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVNjb3BlID0gdHJ1ZTtcclxuICAgICAgICBjb25zdCB2YXJpYWJsZSA9IG5vZGUuZ2V0QXR0cmlidXRlKFwidC1zZXRcIik7XHJcbiAgICAgICAgbGV0IHZhbHVlID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LXZhbHVlXCIpO1xyXG4gICAgICAgIGN0eC52YXJpYWJsZXNbdmFyaWFibGVdID0gY3R4LnZhcmlhYmxlc1t2YXJpYWJsZV0gfHwge307XHJcbiAgICAgICAgbGV0IHF3ZWJ2YXIgPSBjdHgudmFyaWFibGVzW3ZhcmlhYmxlXTtcclxuICAgICAgICBjb25zdCBoYXNCb2R5ID0gbm9kZS5oYXNDaGlsZE5vZGVzKCk7XHJcbiAgICAgICAgcXdlYnZhci5pZCA9IHZhcmlhYmxlO1xyXG4gICAgICAgIHF3ZWJ2YXIuZXhwciA9IGBzY29wZS4ke3ZhcmlhYmxlfWA7XHJcbiAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZFZhbHVlID0gY3R4LmZvcm1hdEV4cHJlc3Npb24odmFsdWUpO1xyXG4gICAgICAgICAgICBsZXQgc2NvcGVFeHByID0gYHNjb3BlYDtcclxuICAgICAgICAgICAgaWYgKGN0eC5wcm90ZWN0ZWRTY29wZU51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVV0aWxzID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIHNjb3BlRXhwciA9IGB1dGlscy5nZXRTY29wZShzY29wZSwgJyR7dmFyaWFibGV9JylgO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGAke3Njb3BlRXhwcn0uJHt2YXJpYWJsZX0gPSAke2Zvcm1hdHRlZFZhbHVlfTtgKTtcclxuICAgICAgICAgICAgcXdlYnZhci52YWx1ZSA9IGZvcm1hdHRlZFZhbHVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaGFzQm9keSkge1xyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGN0eC5hZGRJZihgISgke3F3ZWJ2YXIuZXhwcn0pYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgdGVtcFBhcmVudE5vZGVJRCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IF9wYXJlbnROb2RlID0gY3R4LnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIGN0eC5wYXJlbnROb2RlID0gdGVtcFBhcmVudE5vZGVJRDtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCBjJHt0ZW1wUGFyZW50Tm9kZUlEfSA9IG5ldyB1dGlscy5WRG9tQXJyYXkoKTtgKTtcclxuICAgICAgICAgICAgY29uc3Qgbm9kZUNvcHkgPSBub2RlLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICAgICAgZm9yIChsZXQgYXR0ciBvZiBbXCJ0LXNldFwiLCBcInQtdmFsdWVcIiwgXCJ0LWlmXCIsIFwidC1lbHNlXCIsIFwidC1lbGlmXCJdKSB7XHJcbiAgICAgICAgICAgICAgICBub2RlQ29weS5yZW1vdmVBdHRyaWJ1dGUoYXR0cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcXdlYi5fY29tcGlsZU5vZGUobm9kZUNvcHksIGN0eCk7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGAke3F3ZWJ2YXIuZXhwcn0gPSBjJHt0ZW1wUGFyZW50Tm9kZUlEfWApO1xyXG4gICAgICAgICAgICBxd2VidmFyLnZhbHVlID0gYGMke3RlbXBQYXJlbnROb2RlSUR9YDtcclxuICAgICAgICAgICAgcXdlYnZhci5oYXNCb2R5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3R4LnBhcmVudE5vZGUgPSBfcGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBjdHguY2xvc2VJZigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG59KTtcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdC1pZiwgdC1lbGlmLCB0LWVsc2VcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJpZlwiLFxyXG4gICAgcHJpb3JpdHk6IDIwLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgbm9kZSwgY3R4IH0pIHtcclxuICAgICAgICBsZXQgY29uZCA9IGN0eC5nZXRWYWx1ZShub2RlLmdldEF0dHJpYnV0ZShcInQtaWZcIikpO1xyXG4gICAgICAgIGN0eC5hZGRJZih0eXBlb2YgY29uZCA9PT0gXCJzdHJpbmdcIiA/IGN0eC5mb3JtYXRFeHByZXNzaW9uKGNvbmQpIDogYHNjb3BlLiR7Y29uZC5pZH1gKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9LFxyXG4gICAgZmluYWxpemUoeyBjdHggfSkge1xyXG4gICAgICAgIGN0eC5jbG9zZUlmKCk7XHJcbiAgICB9XHJcbn0pO1xyXG5RV2ViLmFkZERpcmVjdGl2ZSh7XHJcbiAgICBuYW1lOiBcImVsaWZcIixcclxuICAgIHByaW9yaXR5OiAzMCxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IG5vZGUsIGN0eCB9KSB7XHJcbiAgICAgICAgbGV0IGNvbmQgPSBjdHguZ2V0VmFsdWUobm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LWVsaWZcIikpO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBlbHNlIGlmICgke3R5cGVvZiBjb25kID09PSBcInN0cmluZ1wiID8gY3R4LmZvcm1hdEV4cHJlc3Npb24oY29uZCkgOiBgc2NvcGUuJHtjb25kLmlkfWB9KSB7YCk7XHJcbiAgICAgICAgY3R4LmluZGVudCgpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBmaW5hbGl6ZSh7IGN0eCB9KSB7XHJcbiAgICAgICAgY3R4LmNsb3NlSWYoKTtcclxuICAgIH1cclxufSk7XHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwiZWxzZVwiLFxyXG4gICAgcHJpb3JpdHk6IDQwLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgY3R4IH0pIHtcclxuICAgICAgICBjdHguYWRkTGluZShgZWxzZSB7YCk7XHJcbiAgICAgICAgY3R4LmluZGVudCgpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH0sXHJcbiAgICBmaW5hbGl6ZSh7IGN0eCB9KSB7XHJcbiAgICAgICAgY3R4LmNsb3NlSWYoKTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtY2FsbFxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5RV2ViLmFkZERpcmVjdGl2ZSh7XHJcbiAgICBuYW1lOiBcImNhbGxcIixcclxuICAgIHByaW9yaXR5OiA1MCxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IG5vZGUsIHF3ZWIsIGN0eCB9KSB7XHJcbiAgICAgICAgLy8gU3RlcCAxOiBzYW5pdHkgY2hlY2tzXHJcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVNjb3BlID0gdHJ1ZTtcclxuICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgIGlmIChub2RlLm5vZGVOYW1lICE9PSBcInRcIikge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHRhZyBmb3IgdC1jYWxsIGRpcmVjdGl2ZSAoc2hvdWxkIGJlICd0JylcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHN1YlRlbXBsYXRlID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LWNhbGxcIik7XHJcbiAgICAgICAgY29uc3Qgbm9kZVRlbXBsYXRlID0gcXdlYi50ZW1wbGF0ZXNbc3ViVGVtcGxhdGVdO1xyXG4gICAgICAgIGlmICghbm9kZVRlbXBsYXRlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGZpbmQgdGVtcGxhdGUgXCIke3N1YlRlbXBsYXRlfVwiICh0LWNhbGwpYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFN0ZXAgMjogY29tcGlsZSB0YXJnZXQgdGVtcGxhdGUgaW4gc3ViIHRlbXBsYXRlc1xyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIGlmICghcXdlYi5zdWJUZW1wbGF0ZXNbc3ViVGVtcGxhdGVdKSB7XHJcbiAgICAgICAgICAgIHF3ZWIuc3ViVGVtcGxhdGVzW3N1YlRlbXBsYXRlXSA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnN0IHN1YlRlbXBsYXRlRm4gPSBxd2ViLl9jb21waWxlKHN1YlRlbXBsYXRlLCBub2RlVGVtcGxhdGUuZWxlbSwgY3R4LCB0cnVlKTtcclxuICAgICAgICAgICAgcXdlYi5zdWJUZW1wbGF0ZXNbc3ViVGVtcGxhdGVdID0gc3ViVGVtcGxhdGVGbjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU3RlcCAzOiBjb21waWxlIHQtY2FsbCBib2R5IGlmIG5lY2Vzc2FyeVxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIGxldCBoYXNCb2R5ID0gbm9kZS5oYXNDaGlsZE5vZGVzKCk7XHJcbiAgICAgICAgbGV0IHByb3RlY3RJRDtcclxuICAgICAgICBpZiAoaGFzQm9keSkge1xyXG4gICAgICAgICAgICAvLyB3ZSBhZGQgYSBzdWIgc2NvcGUgdG8gcHJvdGVjdCB0aGUgYW1iaWVudCBzY29wZVxyXG4gICAgICAgICAgICBjdHguYWRkTGluZShge2ApO1xyXG4gICAgICAgICAgICBjdHguaW5kZW50KCk7XHJcbiAgICAgICAgICAgIHByb3RlY3RJRCA9IGN0eC5zdGFydFByb3RlY3RTY29wZSgpO1xyXG4gICAgICAgICAgICBjb25zdCBub2RlQ29weSA9IG5vZGUuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBhdHRyIG9mIFtcInQtaWZcIiwgXCJ0LWVsc2VcIiwgXCJ0LWVsaWZcIiwgXCJ0LWNhbGxcIl0pIHtcclxuICAgICAgICAgICAgICAgIG5vZGVDb3B5LnJlbW92ZUF0dHJpYnV0ZShhdHRyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBwYXJlbnROb2RlID0gY3R4LnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIGN0eC5wYXJlbnROb2RlID0gXCJfXzBcIjtcclxuICAgICAgICAgICAgLy8gdGhpcyBsb2NhbCBzY29wZSBpcyBpbnRlbmRlZCB0byB0cmFwIGNfXzBcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHtgKTtcclxuICAgICAgICAgICAgY3R4LmluZGVudCgpO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShcImxldCBjX18wID0gW107XCIpO1xyXG4gICAgICAgICAgICBxd2ViLl9jb21waWxlTm9kZShub2RlQ29weSwgY3R4KTtcclxuICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVV0aWxzID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoXCJzY29wZVt1dGlscy56ZXJvXSA9IGNfXzA7XCIpO1xyXG4gICAgICAgICAgICBjdHgucGFyZW50Tm9kZSA9IHBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIGN0eC5kZWRlbnQoKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYH1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU3RlcCA0OiBhZGQgdGhlIGFwcHJvcHJpYXRlIGZ1bmN0aW9uIGNhbGwgdG8gY3VycmVudCBjb21wb25lbnRcclxuICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgICAgICBjb25zdCBjYWxsaW5nU2NvcGUgPSBoYXNCb2R5ID8gXCJzY29wZVwiIDogXCJPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoY29udGV4dCksIHNjb3BlKVwiO1xyXG4gICAgICAgIGNvbnN0IHBhcmVudENvbXBvbmVudCA9IGB1dGlscy5nZXRDb21wb25lbnQoY29udGV4dClgO1xyXG4gICAgICAgIGNvbnN0IGtleSA9IGN0eC5nZW5lcmF0ZVRlbXBsYXRlS2V5KCk7XHJcbiAgICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IGN0eC5wYXJlbnROb2RlID8gYGMke2N0eC5wYXJlbnROb2RlfWAgOiBcInJlc3VsdFwiO1xyXG4gICAgICAgIGNvbnN0IGV4dHJhID0gYE9iamVjdC5hc3NpZ24oe30sIGV4dHJhLCB7cGFyZW50Tm9kZTogJHtwYXJlbnROb2RlfSwgcGFyZW50OiAke3BhcmVudENvbXBvbmVudH0sIGtleTogJHtrZXl9fSlgO1xyXG4gICAgICAgIGlmIChjdHgucGFyZW50Tm9kZSkge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgdGhpcy5zdWJUZW1wbGF0ZXNbJyR7c3ViVGVtcGxhdGV9J10uY2FsbCh0aGlzLCAke2NhbGxpbmdTY29wZX0sICR7ZXh0cmF9KTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHRoaXMgaXMgYSB0LWNhbGwgd2l0aCBubyBwYXJlbnRub2RlLCB3ZSBuZWVkIHRvIGV4dHJhY3QgdGhlIHJlc3VsdFxyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lUmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHJlc3VsdCA9IFtdYCk7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGB0aGlzLnN1YlRlbXBsYXRlc1snJHtzdWJUZW1wbGF0ZX0nXS5jYWxsKHRoaXMsICR7Y2FsbGluZ1Njb3BlfSwgJHtleHRyYX0pO2ApO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgcmVzdWx0ID0gcmVzdWx0WzBdYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFN0ZXAgNTogcmVzdG9yZSBwcmV2aW91cyBzY29wZVxyXG4gICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgICAgIGlmIChoYXNCb2R5KSB7XHJcbiAgICAgICAgICAgIGN0eC5zdG9wUHJvdGVjdFNjb3BlKHByb3RlY3RJRCk7XHJcbiAgICAgICAgICAgIGN0eC5kZWRlbnQoKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYH1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0pO1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyB0LWZvcmVhY2hcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJmb3JlYWNoXCIsXHJcbiAgICBleHRyYU5hbWVzOiBbXCJhc1wiXSxcclxuICAgIHByaW9yaXR5OiAxMCxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IG5vZGUsIHF3ZWIsIGN0eCB9KSB7XHJcbiAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVNjb3BlID0gdHJ1ZTtcclxuICAgICAgICBjdHggPSBjdHguc3ViQ29udGV4dChcImxvb3BOdW1iZXJcIiwgY3R4Lmxvb3BOdW1iZXIgKyAxKTtcclxuICAgICAgICBjb25zdCBlbGVtcyA9IG5vZGUuZ2V0QXR0cmlidXRlKFwidC1mb3JlYWNoXCIpO1xyXG4gICAgICAgIGNvbnN0IG5hbWUgPSBub2RlLmdldEF0dHJpYnV0ZShcInQtYXNcIik7XHJcbiAgICAgICAgbGV0IGFycmF5SUQgPSBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBsZXQgXyR7YXJyYXlJRH0gPSAke2N0eC5mb3JtYXRFeHByZXNzaW9uKGVsZW1zKX07YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGlmICghXyR7YXJyYXlJRH0pIHsgdGhyb3cgbmV3IEVycm9yKCdRV2ViIGVycm9yOiBJbnZhbGlkIGxvb3AgZXhwcmVzc2lvbicpfWApO1xyXG4gICAgICAgIGxldCBrZXlzSUQgPSBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgIGxldCB2YWx1ZXNJRCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBfJHtrZXlzSUR9ID0gXyR7dmFsdWVzSUR9ID0gXyR7YXJyYXlJRH07YCk7XHJcbiAgICAgICAgY3R4LmFkZElmKGAhKF8ke2FycmF5SUR9IGluc3RhbmNlb2YgQXJyYXkpYCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYF8ke2tleXNJRH0gPSBPYmplY3Qua2V5cyhfJHthcnJheUlEfSk7YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYF8ke3ZhbHVlc0lEfSA9IE9iamVjdC52YWx1ZXMoXyR7YXJyYXlJRH0pO2ApO1xyXG4gICAgICAgIGN0eC5jbG9zZUlmKCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBfbGVuZ3RoJHtrZXlzSUR9ID0gXyR7a2V5c0lEfS5sZW5ndGg7YCk7XHJcbiAgICAgICAgbGV0IHZhcnNJRCA9IGN0eC5zdGFydFByb3RlY3RTY29wZSh0cnVlKTtcclxuICAgICAgICBjb25zdCBsb29wVmFyID0gYGkke2N0eC5sb29wTnVtYmVyfWA7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGZvciAobGV0ICR7bG9vcFZhcn0gPSAwOyAke2xvb3BWYXJ9IDwgX2xlbmd0aCR7a2V5c0lEfTsgJHtsb29wVmFyfSsrKSB7YCk7XHJcbiAgICAgICAgY3R4LmluZGVudCgpO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBzY29wZS4ke25hbWV9X2ZpcnN0ID0gJHtsb29wVmFyfSA9PT0gMGApO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBzY29wZS4ke25hbWV9X2xhc3QgPSAke2xvb3BWYXJ9ID09PSBfbGVuZ3RoJHtrZXlzSUR9IC0gMWApO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBzY29wZS4ke25hbWV9X2luZGV4ID0gJHtsb29wVmFyfWApO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBzY29wZS4ke25hbWV9ID0gXyR7a2V5c0lEfVske2xvb3BWYXJ9XWApO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBzY29wZS4ke25hbWV9X3ZhbHVlID0gXyR7dmFsdWVzSUR9WyR7bG9vcFZhcn1dYCk7XHJcbiAgICAgICAgY29uc3Qgbm9kZUNvcHkgPSBub2RlLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICBsZXQgc2hvdWxkV2FybiA9ICFub2RlQ29weS5oYXNBdHRyaWJ1dGUoXCJ0LWtleVwiKSAmJlxyXG4gICAgICAgICAgICBub2RlLmNoaWxkcmVuLmxlbmd0aCA9PT0gMSAmJlxyXG4gICAgICAgICAgICBub2RlLmNoaWxkcmVuWzBdLnRhZ05hbWUgIT09IFwidFwiICYmXHJcbiAgICAgICAgICAgICFub2RlLmNoaWxkcmVuWzBdLmhhc0F0dHJpYnV0ZShcInQta2V5XCIpO1xyXG4gICAgICAgIGlmIChzaG91bGRXYXJuKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgRGlyZWN0aXZlIHQtZm9yZWFjaCBzaG91bGQgYWx3YXlzIGJlIHVzZWQgd2l0aCBhIHQta2V5ISAoaW4gdGVtcGxhdGU6ICcke2N0eC50ZW1wbGF0ZU5hbWV9JylgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG5vZGVDb3B5Lmhhc0F0dHJpYnV0ZShcInQta2V5XCIpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4cHIgPSBjdHguZm9ybWF0RXhwcmVzc2lvbihub2RlQ29weS5nZXRBdHRyaWJ1dGUoXCJ0LWtleVwiKSk7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQga2V5JHtjdHgubG9vcE51bWJlcn0gPSAke2V4cHJ9O2ApO1xyXG4gICAgICAgICAgICBub2RlQ29weS5yZW1vdmVBdHRyaWJ1dGUoXCJ0LWtleVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBsZXQga2V5JHtjdHgubG9vcE51bWJlcn0gPSBpJHtjdHgubG9vcE51bWJlcn07YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG5vZGVDb3B5LnJlbW92ZUF0dHJpYnV0ZShcInQtZm9yZWFjaFwiKTtcclxuICAgICAgICBxd2ViLl9jb21waWxlTm9kZShub2RlQ29weSwgY3R4KTtcclxuICAgICAgICBjdHguZGVkZW50KCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoXCJ9XCIpO1xyXG4gICAgICAgIGN0eC5zdG9wUHJvdGVjdFNjb3BlKHZhcnNJRCk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0pO1xyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyB0LWRlYnVnXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwiZGVidWdcIixcclxuICAgIHByaW9yaXR5OiAxLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgY3R4IH0pIHtcclxuICAgICAgICBjdHguYWRkTGluZShcImRlYnVnZ2VyO1wiKTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtbG9nXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwibG9nXCIsXHJcbiAgICBwcmlvcml0eTogMSxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IGN0eCwgdmFsdWUgfSkge1xyXG4gICAgICAgIGNvbnN0IGV4cHIgPSBjdHguZm9ybWF0RXhwcmVzc2lvbih2YWx1ZSk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGNvbnNvbGUubG9nKCR7ZXhwcn0pYCk7XHJcbiAgICB9XHJcbn0pO1xuXG4vKipcclxuICogT3dsIFFXZWIgRXh0ZW5zaW9uc1xyXG4gKlxyXG4gKiBUaGlzIGZpbGUgY29udGFpbnMgdGhlIGltcGxlbWVudGF0aW9uIG9mIG5vbiBzdGFuZGFyZCBRV2ViIGRpcmVjdGl2ZXMsIGFkZGVkXHJcbiAqIGJ5IE93bCBhbmQgdGhhdCB3aWxsIG9ubHkgd29yayBvbiBPd2wgcHJvamVjdHM6XHJcbiAqXHJcbiAqIC0gdC1vblxyXG4gKiAtIHQtcmVmXHJcbiAqIC0gdC10cmFuc2l0aW9uXHJcbiAqIC0gdC1tb3VudGVkXHJcbiAqIC0gdC1zbG90XHJcbiAqIC0gdC1tb2RlbFxyXG4gKi9cclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdC1vblxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyB0aGVzZSBhcmUgcGllY2VzIG9mIGNvZGUgdGhhdCB3aWxsIGJlIGluamVjdGVkIGludG8gdGhlIGV2ZW50IGhhbmRsZXIgaWZcclxuLy8gbW9kaWZpZXJzIGFyZSBzcGVjaWZpZWRcclxuY29uc3QgTU9EU19DT0RFID0ge1xyXG4gICAgcHJldmVudDogXCJlLnByZXZlbnREZWZhdWx0KCk7XCIsXHJcbiAgICBzZWxmOiBcImlmIChlLnRhcmdldCAhPT0gdGhpcy5lbG0pIHtyZXR1cm59XCIsXHJcbiAgICBzdG9wOiBcImUuc3RvcFByb3BhZ2F0aW9uKCk7XCJcclxufTtcclxuY29uc3QgRk5BTUVSRUdFWFAgPSAvXlskQS1aX11bMC05QS1aXyRdKiQvaTtcclxuZnVuY3Rpb24gbWFrZUhhbmRsZXJDb2RlKGN0eCwgZnVsbE5hbWUsIHZhbHVlLCBwdXRJbkNhY2hlLCBtb2Rjb2RlcyA9IE1PRFNfQ09ERSkge1xyXG4gICAgbGV0IFtldmVudCwgLi4ubW9kc10gPSBmdWxsTmFtZS5zbGljZSg1KS5zcGxpdChcIi5cIik7XHJcbiAgICBpZiAobW9kcy5pbmNsdWRlcyhcImNhcHR1cmVcIikpIHtcclxuICAgICAgICBldmVudCA9IFwiIVwiICsgZXZlbnQ7XHJcbiAgICB9XHJcbiAgICBpZiAoIWV2ZW50KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTWlzc2luZyBldmVudCBuYW1lIHdpdGggdC1vbiBkaXJlY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgICBsZXQgY29kZTtcclxuICAgIC8vIGNoZWNrIGlmIGl0IGlzIGEgbWV0aG9kIHdpdGggbm8gYXJncywgYSBtZXRob2Qgd2l0aCBhcmdzIG9yIGFuIGV4cHJlc3Npb25cclxuICAgIGxldCBhcmdzID0gXCJcIjtcclxuICAgIGNvbnN0IG5hbWUgPSB2YWx1ZS5yZXBsYWNlKC9cXCguKlxcKS8sIGZ1bmN0aW9uIChfYXJncykge1xyXG4gICAgICAgIGFyZ3MgPSBfYXJncy5zbGljZSgxLCAtMSk7XHJcbiAgICAgICAgcmV0dXJuIFwiXCI7XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IGlzTWV0aG9kQ2FsbCA9IG5hbWUubWF0Y2goRk5BTUVSRUdFWFApO1xyXG4gICAgLy8gdGhlbiBnZW5lcmF0ZSBjb2RlXHJcbiAgICBpZiAoaXNNZXRob2RDYWxsKSB7XHJcbiAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVV0aWxzID0gdHJ1ZTtcclxuICAgICAgICBjb25zdCBjb21wID0gYHV0aWxzLmdldENvbXBvbmVudChjb250ZXh0KWA7XHJcbiAgICAgICAgaWYgKGFyZ3MpIHtcclxuICAgICAgICAgICAgY29uc3QgYXJnSWQgPSBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IGFyZ3Mke2FyZ0lkfSA9IFske2N0eC5mb3JtYXRFeHByZXNzaW9uKGFyZ3MpfV07YCk7XHJcbiAgICAgICAgICAgIGNvZGUgPSBgJHtjb21wfVsnJHtuYW1lfSddKC4uLmFyZ3Mke2FyZ0lkfSwgZSk7YDtcclxuICAgICAgICAgICAgcHV0SW5DYWNoZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29kZSA9IGAke2NvbXB9Wycke25hbWV9J10oZSk7YDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICAvLyBpZiB3ZSBnZXQgaGVyZSwgdGhlbiBpdCBpcyBhbiBleHByZXNzaW9uXHJcbiAgICAgICAgLy8gd2UgbmVlZCB0byBjYXB0dXJlIGV2ZXJ5IHZhcmlhYmxlIGluIGl0XHJcbiAgICAgICAgcHV0SW5DYWNoZSA9IGZhbHNlO1xyXG4gICAgICAgIGNvZGUgPSBjdHguY2FwdHVyZUV4cHJlc3Npb24odmFsdWUpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgbW9kQ29kZSA9IG1vZHMubWFwKG1vZCA9PiBtb2Rjb2Rlc1ttb2RdKS5qb2luKFwiXCIpO1xyXG4gICAgbGV0IGhhbmRsZXIgPSBgZnVuY3Rpb24gKGUpIHtpZiAoIWNvbnRleHQuX19vd2xfXy5pc01vdW50ZWQpe3JldHVybn0ke21vZENvZGV9JHtjb2RlfX1gO1xyXG4gICAgaWYgKHB1dEluQ2FjaGUpIHtcclxuICAgICAgICBjb25zdCBrZXkgPSBjdHguZ2VuZXJhdGVUZW1wbGF0ZUtleShldmVudCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGV4dHJhLmhhbmRsZXJzWyR7a2V5fV0gPSBleHRyYS5oYW5kbGVyc1ske2tleX1dIHx8ICR7aGFuZGxlcn07YCk7XHJcbiAgICAgICAgaGFuZGxlciA9IGBleHRyYS5oYW5kbGVyc1ske2tleX1dYDtcclxuICAgIH1cclxuICAgIHJldHVybiB7IGV2ZW50LCBoYW5kbGVyIH07XHJcbn1cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJvblwiLFxyXG4gICAgcHJpb3JpdHk6IDkwLFxyXG4gICAgYXROb2RlQ3JlYXRpb24oeyBjdHgsIGZ1bGxOYW1lLCB2YWx1ZSwgbm9kZUlEIH0pIHtcclxuICAgICAgICBjb25zdCB7IGV2ZW50LCBoYW5kbGVyIH0gPSBtYWtlSGFuZGxlckNvZGUoY3R4LCBmdWxsTmFtZSwgdmFsdWUsIHRydWUpO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBwJHtub2RlSUR9Lm9uWycke2V2ZW50fSddID0gJHtoYW5kbGVyfTtgKTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtcmVmXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwicmVmXCIsXHJcbiAgICBwcmlvcml0eTogOTUsXHJcbiAgICBhdE5vZGVDcmVhdGlvbih7IGN0eCwgdmFsdWUsIGFkZE5vZGVIb29rIH0pIHtcclxuICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lUmVmcyA9IHRydWU7XHJcbiAgICAgICAgY29uc3QgcmVmS2V5ID0gYHJlZiR7Y3R4LmdlbmVyYXRlSUQoKX1gO1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBjb25zdCAke3JlZktleX0gPSAke2N0eC5pbnRlcnBvbGF0ZSh2YWx1ZSl9O2ApO1xyXG4gICAgICAgIGFkZE5vZGVIb29rKFwiY3JlYXRlXCIsIGBjb250ZXh0Ll9fb3dsX18ucmVmc1ske3JlZktleX1dID0gbi5lbG07YCk7XHJcbiAgICAgICAgYWRkTm9kZUhvb2soXCJkZXN0cm95XCIsIGBkZWxldGUgY29udGV4dC5fX293bF9fLnJlZnNbJHtyZWZLZXl9XTtgKTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtdHJhbnNpdGlvblxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5RV2ViLnV0aWxzLm5leHRGcmFtZSA9IGZ1bmN0aW9uIChjYikge1xyXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHJlcXVlc3RBbmltYXRpb25GcmFtZShjYikpO1xyXG59O1xyXG5RV2ViLnV0aWxzLnRyYW5zaXRpb25JbnNlcnQgPSBmdW5jdGlvbiAodm4sIG5hbWUpIHtcclxuICAgIGNvbnN0IGVsbSA9IHZuLmVsbTtcclxuICAgIC8vIHJlbW92ZSBwb3RlbnRpYWwgZHVwbGljYXRlZCB2bm9kZSB0aGF0IGlzIGN1cnJlbnRseSBiZWluZyByZW1vdmVkLCB0b1xyXG4gICAgLy8gcHJldmVudCBmcm9tIGhhdmluZyB0d2ljZSB0aGUgc2FtZSBub2RlIGluIHRoZSBET00gZHVyaW5nIGFuIGFuaW1hdGlvblxyXG4gICAgY29uc3QgZHVwID0gZWxtLnBhcmVudEVsZW1lbnQgJiYgZWxtLnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcihgKltkYXRhLW93bC1rZXk9JyR7dm4ua2V5fSddYCk7XHJcbiAgICBpZiAoZHVwKSB7XHJcbiAgICAgICAgZHVwLnJlbW92ZSgpO1xyXG4gICAgfVxyXG4gICAgZWxtLmNsYXNzTGlzdC5hZGQobmFtZSArIFwiLWVudGVyXCIpO1xyXG4gICAgZWxtLmNsYXNzTGlzdC5hZGQobmFtZSArIFwiLWVudGVyLWFjdGl2ZVwiKTtcclxuICAgIGVsbS5jbGFzc0xpc3QucmVtb3ZlKG5hbWUgKyBcIi1sZWF2ZS1hY3RpdmVcIik7XHJcbiAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShuYW1lICsgXCItbGVhdmUtdG9cIik7XHJcbiAgICBjb25zdCBmaW5hbGl6ZSA9ICgpID0+IHtcclxuICAgICAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShuYW1lICsgXCItZW50ZXItYWN0aXZlXCIpO1xyXG4gICAgICAgIGVsbS5jbGFzc0xpc3QucmVtb3ZlKG5hbWUgKyBcIi1lbnRlci10b1wiKTtcclxuICAgIH07XHJcbiAgICB0aGlzLm5leHRGcmFtZSgoKSA9PiB7XHJcbiAgICAgICAgZWxtLmNsYXNzTGlzdC5yZW1vdmUobmFtZSArIFwiLWVudGVyXCIpO1xyXG4gICAgICAgIGVsbS5jbGFzc0xpc3QuYWRkKG5hbWUgKyBcIi1lbnRlci10b1wiKTtcclxuICAgICAgICB3aGVuVHJhbnNpdGlvbkVuZChlbG0sIGZpbmFsaXplKTtcclxuICAgIH0pO1xyXG59O1xyXG5RV2ViLnV0aWxzLnRyYW5zaXRpb25SZW1vdmUgPSBmdW5jdGlvbiAodm4sIG5hbWUsIHJtKSB7XHJcbiAgICBjb25zdCBlbG0gPSB2bi5lbG07XHJcbiAgICBlbG0uc2V0QXR0cmlidXRlKFwiZGF0YS1vd2wta2V5XCIsIHZuLmtleSk7XHJcbiAgICBlbG0uY2xhc3NMaXN0LmFkZChuYW1lICsgXCItbGVhdmVcIik7XHJcbiAgICBlbG0uY2xhc3NMaXN0LmFkZChuYW1lICsgXCItbGVhdmUtYWN0aXZlXCIpO1xyXG4gICAgY29uc3QgZmluYWxpemUgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKCFlbG0uY2xhc3NMaXN0LmNvbnRhaW5zKG5hbWUgKyBcIi1sZWF2ZS1hY3RpdmVcIikpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShuYW1lICsgXCItbGVhdmUtYWN0aXZlXCIpO1xyXG4gICAgICAgIGVsbS5jbGFzc0xpc3QucmVtb3ZlKG5hbWUgKyBcIi1sZWF2ZS10b1wiKTtcclxuICAgICAgICBybSgpO1xyXG4gICAgfTtcclxuICAgIHRoaXMubmV4dEZyYW1lKCgpID0+IHtcclxuICAgICAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShuYW1lICsgXCItbGVhdmVcIik7XHJcbiAgICAgICAgZWxtLmNsYXNzTGlzdC5hZGQobmFtZSArIFwiLWxlYXZlLXRvXCIpO1xyXG4gICAgICAgIHdoZW5UcmFuc2l0aW9uRW5kKGVsbSwgZmluYWxpemUpO1xyXG4gICAgfSk7XHJcbn07XHJcbmZ1bmN0aW9uIGdldFRpbWVvdXQoZGVsYXlzLCBkdXJhdGlvbnMpIHtcclxuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXHJcbiAgICB3aGlsZSAoZGVsYXlzLmxlbmd0aCA8IGR1cmF0aW9ucy5sZW5ndGgpIHtcclxuICAgICAgICBkZWxheXMgPSBkZWxheXMuY29uY2F0KGRlbGF5cyk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gTWF0aC5tYXguYXBwbHkobnVsbCwgZHVyYXRpb25zLm1hcCgoZCwgaSkgPT4ge1xyXG4gICAgICAgIHJldHVybiB0b01zKGQpICsgdG9NcyhkZWxheXNbaV0pO1xyXG4gICAgfSkpO1xyXG59XHJcbi8vIE9sZCB2ZXJzaW9ucyBvZiBDaHJvbWl1bSAoYmVsb3cgNjEuMC4zMTYzLjEwMCkgZm9ybWF0cyBmbG9hdGluZyBwb2ludGVyIG51bWJlcnNcclxuLy8gaW4gYSBsb2NhbGUtZGVwZW5kZW50IHdheSwgdXNpbmcgYSBjb21tYSBpbnN0ZWFkIG9mIGEgZG90LlxyXG4vLyBJZiBjb21tYSBpcyBub3QgcmVwbGFjZWQgd2l0aCBhIGRvdCwgdGhlIGlucHV0IHdpbGwgYmUgcm91bmRlZCBkb3duIChpLmUuIGFjdGluZ1xyXG4vLyBhcyBhIGZsb29yIGZ1bmN0aW9uKSBjYXVzaW5nIHVuZXhwZWN0ZWQgYmVoYXZpb3JzXHJcbmZ1bmN0aW9uIHRvTXMocykge1xyXG4gICAgcmV0dXJuIE51bWJlcihzLnNsaWNlKDAsIC0xKS5yZXBsYWNlKFwiLFwiLCBcIi5cIikpICogMTAwMDtcclxufVxyXG5mdW5jdGlvbiB3aGVuVHJhbnNpdGlvbkVuZChlbG0sIGNiKSB7XHJcbiAgICBpZiAoIWVsbS5wYXJlbnROb2RlKSB7XHJcbiAgICAgICAgLy8gaWYgd2UgZ2V0IGhlcmUsIHRoaXMgbWVhbnMgdGhhdCB0aGUgZWxlbWVudCB3YXMgcmVtb3ZlZCBmb3Igc29tZSBvdGhlclxyXG4gICAgICAgIC8vIHJlYXNvbnMsIGFuZCBpbiB0aGF0IGNhc2UsIHdlIGRvbid0IHdhbnQgdG8gd29yayBvbiBhbmltYXRpb24gc2luY2Ugbm90aGluZ1xyXG4gICAgICAgIC8vIHdpbGwgYmUgZGlzcGxheWVkIGFueXdheS5cclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBzdHlsZXMgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbG0pO1xyXG4gICAgY29uc3QgZGVsYXlzID0gKHN0eWxlcy50cmFuc2l0aW9uRGVsYXkgfHwgXCJcIikuc3BsaXQoXCIsIFwiKTtcclxuICAgIGNvbnN0IGR1cmF0aW9ucyA9IChzdHlsZXMudHJhbnNpdGlvbkR1cmF0aW9uIHx8IFwiXCIpLnNwbGl0KFwiLCBcIik7XHJcbiAgICBjb25zdCB0aW1lb3V0ID0gZ2V0VGltZW91dChkZWxheXMsIGR1cmF0aW9ucyk7XHJcbiAgICBpZiAodGltZW91dCA+IDApIHtcclxuICAgICAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIiwgY2IsIHsgb25jZTogdHJ1ZSB9KTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIGNiKCk7XHJcbiAgICB9XHJcbn1cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJ0cmFuc2l0aW9uXCIsXHJcbiAgICBwcmlvcml0eTogOTYsXHJcbiAgICBhdE5vZGVDcmVhdGlvbih7IGN0eCwgdmFsdWUsIGFkZE5vZGVIb29rIH0pIHtcclxuICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgIGxldCBuYW1lID0gdmFsdWU7XHJcbiAgICAgICAgY29uc3QgaG9va3MgPSB7XHJcbiAgICAgICAgICAgIGluc2VydDogYHV0aWxzLnRyYW5zaXRpb25JbnNlcnQodm4sICcke25hbWV9Jyk7YCxcclxuICAgICAgICAgICAgcmVtb3ZlOiBgdXRpbHMudHJhbnNpdGlvblJlbW92ZSh2biwgJyR7bmFtZX0nLCBybSk7YFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yIChsZXQgaG9va05hbWUgaW4gaG9va3MpIHtcclxuICAgICAgICAgICAgYWRkTm9kZUhvb2soaG9va05hbWUsIGhvb2tzW2hvb2tOYW1lXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdC1zbG90XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblFXZWIuYWRkRGlyZWN0aXZlKHtcclxuICAgIG5hbWU6IFwic2xvdFwiLFxyXG4gICAgcHJpb3JpdHk6IDgwLFxyXG4gICAgYXROb2RlRW5jb3VudGVyKHsgY3R4LCB2YWx1ZSwgbm9kZSwgcXdlYiB9KSB7XHJcbiAgICAgICAgY29uc3Qgc2xvdEtleSA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGNvbnN0IHNsb3Qke3Nsb3RLZXl9ID0gdGhpcy5jb25zdHJ1Y3Rvci5zbG90c1tjb250ZXh0Ll9fb3dsX18uc2xvdElkICsgJ18nICsgJyR7dmFsdWV9J107YCk7XHJcbiAgICAgICAgY3R4LmFkZElmKGBzbG90JHtzbG90S2V5fWApO1xyXG4gICAgICAgIGxldCBwYXJlbnROb2RlID0gYGMke2N0eC5wYXJlbnROb2RlfWA7XHJcbiAgICAgICAgaWYgKCFjdHgucGFyZW50Tm9kZSkge1xyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lUmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgY3R4LnJvb3RDb250ZXh0LnNob3VsZERlZmluZVV0aWxzID0gdHJ1ZTtcclxuICAgICAgICAgICAgcGFyZW50Tm9kZSA9IGBjaGlsZHJlbiR7Y3R4LmdlbmVyYXRlSUQoKX1gO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgbGV0ICR7cGFyZW50Tm9kZX09IFtdYCk7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGByZXN1bHQgPSB7fWApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkTGluZShgc2xvdCR7c2xvdEtleX0uY2FsbCh0aGlzLCBjb250ZXh0Ll9fb3dsX18uc2NvcGUsIE9iamVjdC5hc3NpZ24oe30sIGV4dHJhLCB7cGFyZW50Tm9kZTogJHtwYXJlbnROb2RlfSwgcGFyZW50OiBleHRyYS5wYXJlbnQgfHwgY29udGV4dH0pKTtgKTtcclxuICAgICAgICBpZiAoIWN0eC5wYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGB1dGlscy5kZWZpbmVQcm94eShyZXN1bHQsICR7cGFyZW50Tm9kZX1bMF0pO2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobm9kZS5oYXNDaGlsZE5vZGVzKCkpIHtcclxuICAgICAgICAgICAgY3R4LmFkZEVsc2UoKTtcclxuICAgICAgICAgICAgY29uc3Qgbm9kZUNvcHkgPSBub2RlLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgICAgICAgbm9kZUNvcHkucmVtb3ZlQXR0cmlidXRlKFwidC1zbG90XCIpO1xyXG4gICAgICAgICAgICBxd2ViLl9jb21waWxlTm9kZShub2RlQ29weSwgY3R4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmNsb3NlSWYoKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxufSk7XHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8vIHQtbW9kZWxcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuUVdlYi51dGlscy50b051bWJlciA9IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgIGNvbnN0IG4gPSBwYXJzZUZsb2F0KHZhbCk7XHJcbiAgICByZXR1cm4gaXNOYU4obikgPyB2YWwgOiBuO1xyXG59O1xyXG5RV2ViLmFkZERpcmVjdGl2ZSh7XHJcbiAgICBuYW1lOiBcIm1vZGVsXCIsXHJcbiAgICBwcmlvcml0eTogNDIsXHJcbiAgICBhdE5vZGVDcmVhdGlvbih7IGN0eCwgbm9kZUlELCB2YWx1ZSwgbm9kZSwgZnVsbE5hbWUsIGFkZE5vZGVIb29rIH0pIHtcclxuICAgICAgICBjb25zdCB0eXBlID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpO1xyXG4gICAgICAgIGxldCBoYW5kbGVyO1xyXG4gICAgICAgIGxldCBldmVudCA9IGZ1bGxOYW1lLmluY2x1ZGVzKFwiLmxhenlcIikgPyBcImNoYW5nZVwiIDogXCJpbnB1dFwiO1xyXG4gICAgICAgIC8vIHdlIGtlZXAgaGVyZSBhIHJlZmVyZW5jZSB0byB0aGUgXCJiYXNlIGV4cHJlc3Npb25cIiAoaWYgdGhlIGV4cHJlc3Npb25cclxuICAgICAgICAvLyBpcyBgdC1tb2RlbD1cInNvbWUuZXhwci52YWx1ZVwiLCB0aGVuIHRoZSBiYXNlIGV4cHJlc3Npb24gaXMgXCJzb21lLmV4cHJcIikuXHJcbiAgICAgICAgLy8gVGhpcyBpcyBuZWNlc3Nhcnkgc28gd2UgY2FuIGNhcHR1cmUgaXQgaW4gdGhlIGhhbmRsZXIgY2xvc3VyZS5cclxuICAgICAgICBsZXQgZXhwciA9IGN0eC5mb3JtYXRFeHByZXNzaW9uKHZhbHVlKTtcclxuICAgICAgICBjb25zdCBpbmRleCA9IGV4cHIubGFzdEluZGV4T2YoXCIuXCIpO1xyXG4gICAgICAgIGNvbnN0IGJhc2VFeHByID0gZXhwci5zbGljZSgwLCBpbmRleCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBleHByJHtub2RlSUR9ID0gJHtiYXNlRXhwcn07YCk7XHJcbiAgICAgICAgZXhwciA9IGBleHByJHtub2RlSUR9LiR7ZXhwci5zbGljZShpbmRleCArIDEpfWA7XHJcbiAgICAgICAgY29uc3Qga2V5ID0gY3R4LmdlbmVyYXRlVGVtcGxhdGVLZXkoKTtcclxuICAgICAgICBpZiAobm9kZS50YWdOYW1lID09PSBcInNlbGVjdFwiKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBwJHtub2RlSUR9LnByb3BzID0ge3ZhbHVlOiAke2V4cHJ9fTtgKTtcclxuICAgICAgICAgICAgYWRkTm9kZUhvb2soXCJjcmVhdGVcIiwgYG4uZWxtLnZhbHVlPSR7ZXhwcn07YCk7XHJcbiAgICAgICAgICAgIGV2ZW50ID0gXCJjaGFuZ2VcIjtcclxuICAgICAgICAgICAgaGFuZGxlciA9IGAoZXYpID0+IHske2V4cHJ9ID0gZXYudGFyZ2V0LnZhbHVlfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHR5cGUgPT09IFwiY2hlY2tib3hcIikge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgcCR7bm9kZUlEfS5wcm9wcyA9IHtjaGVja2VkOiAke2V4cHJ9fTtgKTtcclxuICAgICAgICAgICAgaGFuZGxlciA9IGAoZXYpID0+IHske2V4cHJ9ID0gZXYudGFyZ2V0LmNoZWNrZWR9YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodHlwZSA9PT0gXCJyYWRpb1wiKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5vZGVWYWx1ZSA9IG5vZGUuZ2V0QXR0cmlidXRlKFwidmFsdWVcIik7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBwJHtub2RlSUR9LnByb3BzID0ge2NoZWNrZWQ6JHtleHByfSA9PT0gJyR7bm9kZVZhbHVlfSd9O2ApO1xyXG4gICAgICAgICAgICBoYW5kbGVyID0gYChldikgPT4geyR7ZXhwcn0gPSBldi50YXJnZXQudmFsdWV9YDtcclxuICAgICAgICAgICAgZXZlbnQgPSBcImNsaWNrXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgcCR7bm9kZUlEfS5wcm9wcyA9IHt2YWx1ZTogJHtleHByfX07YCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRyaW1Db2RlID0gZnVsbE5hbWUuaW5jbHVkZXMoXCIudHJpbVwiKSA/IFwiLnRyaW0oKVwiIDogXCJcIjtcclxuICAgICAgICAgICAgbGV0IHZhbHVlQ29kZSA9IGBldi50YXJnZXQudmFsdWUke3RyaW1Db2RlfWA7XHJcbiAgICAgICAgICAgIGlmIChmdWxsTmFtZS5pbmNsdWRlcyhcIi5udW1iZXJcIikpIHtcclxuICAgICAgICAgICAgICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVVdGlscyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB2YWx1ZUNvZGUgPSBgdXRpbHMudG9OdW1iZXIoJHt2YWx1ZUNvZGV9KWA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaGFuZGxlciA9IGAoZXYpID0+IHske2V4cHJ9ID0gJHt2YWx1ZUNvZGV9fWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN0eC5hZGRMaW5lKGBleHRyYS5oYW5kbGVyc1ske2tleX1dID0gZXh0cmEuaGFuZGxlcnNbJHtrZXl9XSB8fCAoJHtoYW5kbGVyfSk7YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHAke25vZGVJRH0ub25bJyR7ZXZlbnR9J10gPSBleHRyYS5oYW5kbGVyc1ske2tleX1dO2ApO1xyXG4gICAgfVxyXG59KTtcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdC1rZXlcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJrZXlcIixcclxuICAgIHByaW9yaXR5OiA0NSxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IGN0eCwgdmFsdWUsIG5vZGUgfSkge1xyXG4gICAgICAgIGlmIChjdHgubG9vcE51bWJlciA9PT0gMCkge1xyXG4gICAgICAgICAgICBjdHgua2V5U3RhY2sucHVzaChjdHgucm9vdENvbnRleHQuaGFzS2V5MCk7XHJcbiAgICAgICAgICAgIGN0eC5yb290Q29udGV4dC5oYXNLZXkwID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmFkZExpbmUoXCJ7XCIpO1xyXG4gICAgICAgIGN0eC5pbmRlbnQoKTtcclxuICAgICAgICBjdHguYWRkTGluZShgbGV0IGtleSR7Y3R4Lmxvb3BOdW1iZXJ9ID0gJHtjdHguZm9ybWF0RXhwcmVzc2lvbih2YWx1ZSl9O2ApO1xyXG4gICAgfSxcclxuICAgIGZpbmFsaXplKHsgY3R4IH0pIHtcclxuICAgICAgICBjdHguZGVkZW50KCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoXCJ9XCIpO1xyXG4gICAgICAgIGlmIChjdHgubG9vcE51bWJlciA9PT0gMCkge1xyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuaGFzS2V5MCA9IGN0eC5rZXlTdGFjay5wb3AoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pO1xuXG5jb25zdCBjb25maWcgPSB7fTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGNvbmZpZywgXCJtb2RlXCIsIHtcclxuICAgIGdldCgpIHtcclxuICAgICAgICByZXR1cm4gUVdlYi5kZXYgPyBcImRldlwiIDogXCJwcm9kXCI7XHJcbiAgICB9LFxyXG4gICAgc2V0KG1vZGUpIHtcclxuICAgICAgICBRV2ViLmRldiA9IG1vZGUgPT09IFwiZGV2XCI7XHJcbiAgICAgICAgaWYgKFFXZWIuZGV2KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL2dpdGh1Yi5jb20vb2Rvby9vd2wvYmxvYi9tYXN0ZXIvZG9jL3JlZmVyZW5jZS9jb25maWcubWQjbW9kZWA7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgT3dsIGlzIHJ1bm5pbmcgaW4gJ2RldicgbW9kZS4gIFRoaXMgaXMgbm90IHN1aXRhYmxlIGZvciBwcm9kdWN0aW9uIHVzZS4gU2VlICR7dXJsfSBmb3IgbW9yZSBpbmZvcm1hdGlvbi5gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBPd2wgaXMgbm93IHJ1bm5pbmcgaW4gJ3Byb2QnIG1vZGUuYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcblxuLyoqXHJcbiAqIFdlIGRlZmluZSBoZXJlIE93bEV2ZW50LCBhIHN1YmNsYXNzIG9mIEN1c3RvbUV2ZW50LCB3aXRoIGFuIGFkZGl0aW9uYWxcclxuICogYXR0cmlidXRlOlxyXG4gKiAgLSBvcmlnaW5hbENvbXBvbmVudDogdGhlIGNvbXBvbmVudCB0aGF0IHRyaWdnZXJlZCB0aGUgZXZlbnRcclxuICovXHJcbmNsYXNzIE93bEV2ZW50IGV4dGVuZHMgQ3VzdG9tRXZlbnQge1xyXG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50LCBldmVudFR5cGUsIG9wdGlvbnMpIHtcclxuICAgICAgICBzdXBlcihldmVudFR5cGUsIG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMub3JpZ2luYWxDb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICB9XHJcbn1cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdC1jb21wb25lbnRcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuY29uc3QgVF9DT01QT05FTlRfTU9EU19DT0RFID0gT2JqZWN0LmFzc2lnbih7fSwgTU9EU19DT0RFLCB7XHJcbiAgICBzZWxmOiBcImlmIChlLnRhcmdldCAhPT0gdm4uZWxtKSB7cmV0dXJufVwiXHJcbn0pO1xyXG5RV2ViLnV0aWxzLmRlZmluZVByb3h5ID0gZnVuY3Rpb24gZGVmaW5lUHJveHkodGFyZ2V0LCBzb3VyY2UpIHtcclxuICAgIGZvciAobGV0IGsgaW4gc291cmNlKSB7XHJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgaywge1xyXG4gICAgICAgICAgICBnZXQoKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc291cmNlW2tdO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzZXQodmFsKSB7XHJcbiAgICAgICAgICAgICAgICBzb3VyY2Vba10gPSB2YWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxufTtcclxuUVdlYi51dGlscy5hc3NpZ25Ib29rcyA9IGZ1bmN0aW9uIGFzc2lnbkhvb2tzKGRhdGFPYmosIGhvb2tzKSB7XHJcbiAgICBpZiAoXCJob29rXCIgaW4gZGF0YU9iaikge1xyXG4gICAgICAgIGNvbnN0IGhvb2tPYmplY3QgPSBkYXRhT2JqLmhvb2s7XHJcbiAgICAgICAgZm9yIChsZXQgbmFtZSBpbiBob29rcykge1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50ID0gaG9va09iamVjdFtuYW1lXTtcclxuICAgICAgICAgICAgY29uc3QgZm4gPSBob29rc1tuYW1lXTtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnQpIHtcclxuICAgICAgICAgICAgICAgIGhvb2tPYmplY3RbbmFtZV0gPSAoLi4uYXJncykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQoLi4uYXJncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm4oLi4uYXJncyk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaG9va09iamVjdFtuYW1lXSA9IGZuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgZGF0YU9iai5ob29rID0gaG9va3M7XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBUaGUgdC1jb21wb25lbnQgZGlyZWN0aXZlIGlzIGNlcnRhaW5seSBhIGNvbXBsaWNhdGVkIGFuZCBoYXJkIHRvIG1haW50YWluIHBpZWNlXHJcbiAqIG9mIGNvZGUuICBUbyBoZWxwIHlvdSwgZmVsbG93IGRldmVsb3BlciwgaWYgeW91IGhhdmUgdG8gbWFpbnRhaW4gaXQsIEkgb2ZmZXJcclxuICogeW91IHRoaXMgYWR2aWNlOiBHb29kIGx1Y2suLi5cclxuICpcclxuICogU2luY2UgaXQgaXMgbm90ICdkaXJlY3QnIGNvZGUsIGJ1dCByYXRoZXIgY29kZSB0aGF0IGdlbmVyYXRlcyBvdGhlciBjb2RlLCBpdFxyXG4gKiBpcyBub3QgZWFzeSB0byB1bmRlcnN0YW5kLiAgVG8gaGVscCB5b3UsIGhlcmUgIGlzIGEgZGV0YWlsZWQgYW5kIGNvbW1lbnRlZFxyXG4gKiBleHBsYW5hdGlvbiBvZiB0aGUgY29kZSBnZW5lcmF0ZWQgYnkgdGhlIHQtY29tcG9uZW50IGRpcmVjdGl2ZSBmb3IgdGhlIGZvbGxvd2luZ1xyXG4gKiBzaXR1YXRpb246XHJcbiAqIGBgYHhtbFxyXG4gKiAgIDxDaGlsZFxyXG4gKiAgICAgIHQta2V5PVwiJ3NvbWVzdHJpbmcnXCJcclxuICogICAgICBmbGFnPVwic3RhdGUuZmxhZ1wiXHJcbiAqICAgICAgdC10cmFuc2l0aW9uPVwiZmFkZVwiLz5cclxuICogYGBgXHJcbiAqXHJcbiAqIGBgYGpzXHJcbiAqIC8vIHdlIGFzc2lnbiB1dGlscyBvbiB0b3Agb2YgdGhlIGZ1bmN0aW9uIGJlY2F1c2UgaXQgd2lsbCBiZSB1c2VmdWwgZm9yXHJcbiAqIC8vIGVhY2ggY29tcG9uZW50c1xyXG4gKiBsZXQgdXRpbHMgPSB0aGlzLnV0aWxzO1xyXG4gKlxyXG4gKiAvLyB0aGlzIGlzIHRoZSB2aXJ0dWFsIG5vZGUgcmVwcmVzZW50aW5nIHRoZSBwYXJlbnQgZGl2XHJcbiAqIGxldCBjMSA9IFtdLCBwMSA9IHsga2V5OiAxIH07XHJcbiAqIHZhciB2bjEgPSBoKFwiZGl2XCIsIHAxLCBjMSk7XHJcbiAqXHJcbiAqIC8vIHQtY29tcG9uZW50IGRpcmVjdGl2ZTogd2Ugc3RhcnQgYnkgZXZhbHVhdGluZyB0aGUgZXhwcmVzc2lvbiBnaXZlbiBieSB0LWtleTpcclxuICogbGV0IGtleTUgPSBcInNvbWVzdHJpbmdcIjtcclxuICpcclxuICogLy8gZGVmMyBpcyB0aGUgcHJvbWlzZSB0aGF0IHdpbGwgY29udGFpbiBsYXRlciBlaXRoZXIgdGhlIG5ldyBjb21wb25lbnRcclxuICogLy8gY3JlYXRpb24sIG9yIHRoZSBwcm9wcyB1cGRhdGUuLi5cclxuICogbGV0IGRlZjM7XHJcbiAqXHJcbiAqIC8vIHRoaXMgaXMga2luZCBvZiB0cmlja3k6IHdlIG5lZWQgaGVyZSB0byBmaW5kIGlmIHRoZSBjb21wb25lbnQgd2FzIGFscmVhZHlcclxuICogLy8gY3JlYXRlZCBieSBhIHByZXZpb3VzIHJlbmRlcmluZy4gIFRoaXMgaXMgZG9uZSBieSBjaGVja2luZyB0aGUgaW50ZXJuYWxcclxuICogLy8gYGNtYXBgIChjaGlsZHJlbiBtYXApIG9mIHRoZSBwYXJlbnQgY29tcG9uZW50OiBpdCBtYXBzIGtleXMgdG8gY29tcG9uZW50IGlkcyxcclxuICogLy8gYW5kLCB0aGVuLCBpZiB0aGVyZSBpcyBhbiBpZCwgd2UgbG9vayBpbnRvIHRoZSBjaGlsZHJlbiBsaXN0IHRvIGdldCB0aGVcclxuICogLy8gaW5zdGFuY2VcclxuICogbGV0IHc0ID1cclxuICogICBrZXk1IGluIGNvbnRleHQuX19vd2xfXy5jbWFwXHJcbiAqICAgPyBjb250ZXh0Ll9fb3dsX18uY2hpbGRyZW5bY29udGV4dC5fX293bF9fLmNtYXBba2V5NV1dXHJcbiAqICAgOiBmYWxzZTtcclxuICpcclxuICogLy8gV2Uga2VlcCB0aGUgaW5kZXggb2YgdGhlIHBvc2l0aW9uIG9mIHRoZSBjb21wb25lbnQgaW4gdGhlIGNsb3N1cmUuICBXZSBwdXNoXHJcbiAqIC8vIG51bGwgdG8gcmVzZXJ2ZSB0aGUgc2xvdCwgYW5kIHdpbGwgcmVwbGFjZSBpdCBsYXRlciBieSB0aGUgY29tcG9uZW50IHZub2RlLFxyXG4gKiAvLyB3aGVuIGl0IHdpbGwgYmUgcmVhZHkgKGRvIG5vdCBmb3JnZXQgdGhhdCBwcmVwYXJpbmcvcmVuZGVyaW5nIGEgY29tcG9uZW50IGlzXHJcbiAqIC8vIGFzeW5jaHJvbm91cylcclxuICogbGV0IF8yX2luZGV4ID0gYzEubGVuZ3RoO1xyXG4gKiBjMS5wdXNoKG51bGwpO1xyXG4gKlxyXG4gKiAvLyB3ZSBldmFsdWF0ZSBoZXJlIHRoZSBwcm9wcyBnaXZlbiB0byB0aGUgY29tcG9uZW50LiBJdCBpcyBkb25lIGhlcmUgdG8gYmVcclxuICogLy8gYWJsZSB0byBlYXNpbHkgcmVmZXJlbmNlIGl0IGxhdGVyLCBhbmQgYWxzbywgaXQgbWlnaHQgYmUgYW4gZXhwZW5zaXZlXHJcbiAqIC8vIGNvbXB1dGF0aW9uLCBzbyBpdCBpcyBjZXJ0YWlubHkgYmV0dGVyIHRvIGRvIGl0IG9ubHkgb25jZVxyXG4gKiBsZXQgcHJvcHM0ID0geyBmbGFnOiBjb250ZXh0W1wic3RhdGVcIl0uZmxhZyB9O1xyXG4gKlxyXG4gKiAvLyBJZiB3ZSBoYXZlIGEgY29tcG9uZW50LCBjdXJyZW50bHkgcmVuZGVyaW5nLCBidXQgbm90IHJlYWR5IHlldCwgd2UgZG8gbm90IHdhbnRcclxuICogLy8gdG8gd2FpdCBmb3IgaXQgdG8gYmUgcmVhZHkgaWYgd2UgY2FuIGF2b2lkIGl0XHJcbiAqIGlmICh3NCAmJiB3NC5fX293bF9fLnJlbmRlclByb21pc2UgJiYgIXc0Ll9fb3dsX18udm5vZGUpIHtcclxuICogICAvLyB3ZSBjaGVjayBpZiB0aGUgcHJvcHMgYXJlIHRoZSBzYW1lLiAgSW4gdGhhdCBjYXNlLCB3ZSBjYW4gc2ltcGx5IHJldXNlXHJcbiAqICAgLy8gdGhlIHByZXZpb3VzIHJlbmRlcmluZyBhbmQgc2tpcCBhbGwgdXNlbGVzcyB3b3JrXHJcbiAqICAgaWYgKHV0aWxzLnNoYWxsb3dFcXVhbChwcm9wczQsIHc0Ll9fb3dsX18ucmVuZGVyUHJvcHMpKSB7XHJcbiAqICAgICBkZWYzID0gdzQuX19vd2xfXy5yZW5kZXJQcm9taXNlO1xyXG4gKiAgIH0gZWxzZSB7XHJcbiAqICAgICAvLyBpZiB0aGUgcHJvcHMgYXJlIG5vdCB0aGUgc2FtZSwgd2UgZGVzdHJveSB0aGUgY29tcG9uZW50IGFuZCBzdGFydHMgYW5ldy5cclxuICogICAgIC8vIHRoaXMgd2lsbCBiZSBmYXN0ZXIgdGhhbiB3YWl0aW5nIGZvciBpdHMgcmVuZGVyaW5nLCB0aGVuIHVwZGF0aW5nIGl0XHJcbiAqICAgICB3NC5kZXN0cm95KCk7XHJcbiAqICAgICB3NCA9IGZhbHNlO1xyXG4gKiAgIH1cclxuICogfVxyXG4gKlxyXG4gKiBpZiAoIXc0KSB7XHJcbiAqICAgLy8gaW4gdGhpcyBzaXR1YXRpb24sIHdlIG5lZWQgdG8gY3JlYXRlIGEgbmV3IGNvbXBvbmVudC4gIEZpcnN0IHN0ZXAgaXNcclxuICogICAvLyB0byBnZXQgYSByZWZlcmVuY2UgdG8gdGhlIGNsYXNzLCB0aGVuIGNyZWF0ZSBhbiBpbnN0YW5jZSB3aXRoXHJcbiAqICAgLy8gY3VycmVudCBjb250ZXh0IGFzIHBhcmVudCwgYW5kIHRoZSBwcm9wcy5cclxuICogICBsZXQgVzQgPSBjb250ZXh0LmNvbXBvbmVudCAmJiBjb250ZXh0LmNvbXBvbmVudHNbY29tcG9uZW50S2V5NF0gfHwgUVdlYi5jb21wb25lbnRbY29tcG9uZW50S2V5NF07XHJcblxyXG4gKiAgIGlmICghVzQpIHtcclxuICogICAgIHRocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIHRoZSBkZWZpbml0aW9uIG9mIGNvbXBvbmVudCAnY2hpbGQnXCIpO1xyXG4gKiAgIH1cclxuICogICB3NCA9IG5ldyBXNChvd25lciwgcHJvcHM0KTtcclxuICpcclxuICogICAvLyBXaGVuZXZlciB3ZSByZXJlbmRlciB0aGUgcGFyZW50IGNvbXBvbmVudCwgd2UgbmVlZCB0byBiZSBzdXJlIHRoYXQgd2VcclxuICogICAvLyBhcmUgYWJsZSB0byBmaW5kIHRoZSBjb21wb25lbnQgaW5zdGFuY2UuIFRvIGRvIHRoYXQsIHdlIHJlZ2lzdGVyIGl0IHRvXHJcbiAqICAgLy8gdGhlIHBhcmVudCBjbWFwIChjaGlsZHJlbiBtYXApLiAgTm90ZSB0aGF0IHRoZSAndGVtcGxhdGUnIGtleSBpc1xyXG4gKiAgIC8vIHVzZWQgaGVyZSwgc2luY2UgdGhpcyBpcyB3aGF0IGlkZW50aWZ5IHRoZSBjb21wb25lbnQgZnJvbSB0aGUgdGVtcGxhdGVcclxuICogICAvLyBwZXJzcGVjdGl2ZS5cclxuICogICBjb250ZXh0Ll9fb3dsX18uY21hcFtrZXk1XSA9IHc0Ll9fb3dsX18uaWQ7XHJcbiAqXHJcbiAqICAgLy8gX19wcmVwYXJlIGlzIGNhbGxlZCwgdG8gYmFzaWNhbGx5IGNhbGwgd2lsbFN0YXJ0LCB0aGVuIHJlbmRlciB0aGVcclxuICogICAvLyBjb21wb25lbnRcclxuICogICBkZWYzID0gdzQuX19wcmVwYXJlKCk7XHJcbiAqXHJcbiAqICAgZGVmMyA9IGRlZjMudGhlbih2bm9kZSA9PiB7XHJcbiAqICAgICAvLyB3ZSBjcmVhdGUgaGVyZSBhIHZpcnR1YWwgbm9kZSBmb3IgdGhlIHBhcmVudCAoTk9UIHRoZSBjb21wb25lbnQpLiBUaGlzXHJcbiAqICAgICAvLyBtZWFucyB0aGF0IHRoZSB2ZG9tIG9mIHRoZSBwYXJlbnQgd2lsbCBiZSBzdG9wcGVkIGhlcmUsIGFuZCBmcm9tXHJcbiAqICAgICAvLyB0aGUgcGFyZW50J3MgcGVyc3BlY3RpdmUsIGl0IHNpbXBseSBpcyBhIHZub2RlIHdpdGggbm8gY2hpbGRyZW4uXHJcbiAqICAgICAvLyBIb3dldmVyLCBpdCBzaGFyZXMgdGhlIHNhbWUgZG9tIGVsZW1lbnQgd2l0aCB0aGUgY29tcG9uZW50IHJvb3RcclxuICogICAgIC8vIHZub2RlLlxyXG4gKiAgICAgbGV0IHB2bm9kZSA9IGgodm5vZGUuc2VsLCB7IGtleToga2V5NSB9KTtcclxuICpcclxuICogICAgIC8vIHdlIGFkZCBob29rcyB0byB0aGUgcGFyZW50IHZub2RlIHNvIHdlIGNhbiBpbnRlcmFjdCB3aXRoIHRoZSBuZXdcclxuICogICAgIC8vIGNvbXBvbmVudCBhdCB0aGUgcHJvcGVyIHRpbWVcclxuICogICAgIHB2bm9kZS5kYXRhLmhvb2sgPSB7XHJcbiAqICAgICAgIGluc2VydCh2bikge1xyXG4gKiAgICAgICAgIC8vIHRoZSBfX21vdW50IG1ldGhvZCB3aWxsIHBhdGNoIHRoZSBjb21wb25lbnQgdmRvbSBpbnRvIHRoZSBlbG0gdm4uZWxtLFxyXG4gKiAgICAgICAgIC8vIHRoZW4gY2FsbCB0aGUgbW91bnRlZCBob29rcy4gSG93ZXZlciwgc3VwcmlzaW5nbHksIHRoZSBzbmFiYmRvbVxyXG4gKiAgICAgICAgIC8vIHBhdGNoIG1ldGhvZCBhY3R1YWxseSByZXBsYWNlIHRoZSBlbG0gYnkgYSBuZXcgZWxtLCBzbyB3ZSBuZWVkXHJcbiAqICAgICAgICAgLy8gdG8gc3luY2hyb25pc2UgdGhlIHB2bm9kZSBlbG0gd2l0aCB0aGUgcmVzdWx0aW5nIGVsbVxyXG4gKiAgICAgICAgIGxldCBudm4gPSB3NC5fX21vdW50KHZub2RlLCB2bi5lbG0pO1xyXG4gKiAgICAgICAgIHB2bm9kZS5lbG0gPSBudm4uZWxtO1xyXG4gKiAgICAgICAgIC8vIHdoYXQgZm9sbG93cyBpcyBvbmx5IHByZXNlbnQgaWYgdGhlcmUgYXJlIGFuaW1hdGlvbnMgb24gdGhlIGNvbXBvbmVudFxyXG4gKiAgICAgICAgIHV0aWxzLnRyYW5zaXRpb25JbnNlcnQodm4sIFwiZmFkZVwiKTtcclxuICogICAgICAgfSxcclxuICogICAgICAgcmVtb3ZlKCkge1xyXG4gKiAgICAgICAgIC8vIG92ZXJyaWRlIHdpdGggZW1wdHkgZnVuY3Rpb24gdG8gcHJldmVudCBmcm9tIHJlbW92aW5nIHRoZSBub2RlXHJcbiAqICAgICAgICAgLy8gZGlyZWN0bHkuIEl0IHdpbGwgYmUgcmVtb3ZlZCB3aGVuIGRlc3Ryb3kgaXMgY2FsbGVkIGFueXdheSwgd2hpY2hcclxuICogICAgICAgICAvLyBkZWxheXMgdGhlIHJlbW92YWwgaWYgdGhlcmUgYXJlIGFuaW1hdGlvbnMuXHJcbiAqICAgICAgIH0sXHJcbiAqICAgICAgIGRlc3Ryb3koKSB7XHJcbiAqICAgICAgICAgLy8gaWYgdGhlcmUgYXJlIGFuaW1hdGlvbnMsIHdlIGRlbGF5IHRoZSBjYWxsIHRvIGRlc3Ryb3kgb24gdGhlXHJcbiAqICAgICAgICAgLy8gY29tcG9uZW50LCBpZiBub3QsIHdlIGNhbGwgaXQgZGlyZWN0bHkuXHJcbiAqICAgICAgICAgbGV0IGZpbmFsaXplID0gKCkgPT4ge1xyXG4gKiAgICAgICAgICAgdzQuZGVzdHJveSgpO1xyXG4gKiAgICAgICAgIH07XHJcbiAqICAgICAgICAgdXRpbHMudHJhbnNpdGlvblJlbW92ZSh2biwgXCJmYWRlXCIsIGZpbmFsaXplKTtcclxuICogICAgICAgfVxyXG4gKiAgICAgfTtcclxuICogICAgIC8vIHRoZSBwdm5vZGUgaXMgaW5zZXJ0ZWQgYXQgdGhlIGNvcnJlY3QgcG9zaXRpb24gaW4gdGhlIGRpdidzIGNoaWxkcmVuXHJcbiAqICAgICBjMVtfMl9pbmRleF0gPSBwdm5vZGU7XHJcbiAqXHJcbiAqICAgICAvLyB3ZSBrZWVwIGhlcmUgYSByZWZlcmVuY2UgdG8gdGhlIHBhcmVudCB2bm9kZSAocmVwcmVzZW50aW5nIHRoZVxyXG4gKiAgICAgLy8gY29tcG9uZW50LCBzbyB3ZSBjYW4gcmV1c2UgaXQgbGF0ZXIgd2hlbmV2ZXIgd2UgdXBkYXRlIHRoZSBjb21wb25lbnRcclxuICogICAgIHc0Ll9fb3dsX18ucHZub2RlID0gcHZub2RlO1xyXG4gKiAgIH0pO1xyXG4gKiB9IGVsc2Uge1xyXG4gKiAgIC8vIHRoaXMgaXMgdGhlICd1cGRhdGUnIHBhdGggb2YgdGhlIGRpcmVjdGl2ZS5cclxuICogICAvLyB0aGUgY2FsbCB0byBfX3VwZGF0ZVByb3BzIGlzIHRoZSBhY3R1YWwgY29tcG9uZW50IHVwZGF0ZVxyXG4gKiAgIC8vIE5vdGUgdGhhdCB3ZSBvbmx5IHVwZGF0ZSB0aGUgcHJvcHMgaWYgd2UgY2Fubm90IHJldXNlIHRoZSBwcmV2aW91c1xyXG4gKiAgIC8vIHJlbmRlcmluZyB3b3JrIChpbiB0aGUgY2FzZSBpdCB3YXMgcmVuZGVyZWQgd2l0aCB0aGUgc2FtZSBwcm9wcylcclxuICogICBkZWYzID0gZGVmMyB8fCB3NC5fX3VwZGF0ZVByb3BzKHByb3BzNCwgZXh0cmEuZm9yY2VVcGRhdGUsIGV4dHJhLnBhdGNoUXVldWUpO1xyXG4gKiAgIGRlZjMgPSBkZWYzLnRoZW4oKCkgPT4ge1xyXG4gKiAgICAgLy8gaWYgY29tcG9uZW50IHdhcyBkZXN0cm95ZWQgaW4gdGhlIG1lYW50aW1lLCB3ZSBkbyBub3RoaW5nIChzbywgdGhpc1xyXG4gKiAgICAgLy8gbWVhbnMgdGhhdCB0aGUgcGFyZW50J3MgZWxlbWVudCBjaGlsZHJlbiBsaXN0IHdpbGwgaGF2ZSBhIG51bGwgaW5cclxuICogICAgIC8vIHRoZSBjb21wb25lbnQncyBwb3NpdGlvbiwgd2hpY2ggd2lsbCBjYXVzZSB0aGUgcHZub2RlIHRvIGJlIHJlbW92ZWRcclxuICogICAgIC8vIHdoZW4gaXQgaXMgcGF0Y2hlZC5cclxuICogICAgIGlmICh3NC5fX293bF9fLmlzRGVzdHJveWVkKSB7XHJcbiAqICAgICAgIHJldHVybjtcclxuICogICAgIH1cclxuICogICAgIC8vIGxpa2UgYWJvdmUsIHdlIHJlZ2lzdGVyIHRoZSBwdm5vZGUgdG8gdGhlIGNoaWxkcmVuIGxpc3QsIHNvIGl0XHJcbiAqICAgICAvLyB3aWxsIG5vdCBiZSBwYXRjaGVkIG91dCBvZiB0aGUgZG9tLlxyXG4gKiAgICAgbGV0IHB2bm9kZSA9IHc0Ll9fb3dsX18ucHZub2RlO1xyXG4gKiAgICAgYzFbXzJfaW5kZXhdID0gcHZub2RlO1xyXG4gKiAgIH0pO1xyXG4gKiB9XHJcbiAqXHJcbiAqIC8vIHdlIHJlZ2lzdGVyIHRoZSBkZWZlcnJlZCBoZXJlIHNvIHRoZSBwYXJlbnQgY2FuIGNvb3JkaW5hdGUgaXRzIHBhdGNoIG9wZXJhdGlvblxyXG4gKiAvLyB3aXRoIGFsbCB0aGUgY2hpbGRyZW4uXHJcbiAqIGV4dHJhLnByb21pc2VzLnB1c2goZGVmMyk7XHJcbiAqIHJldHVybiB2bjE7XHJcbiAqIGBgYFxyXG4gKi9cclxuUVdlYi5hZGREaXJlY3RpdmUoe1xyXG4gICAgbmFtZTogXCJjb21wb25lbnRcIixcclxuICAgIGV4dHJhTmFtZXM6IFtcInByb3BzXCJdLFxyXG4gICAgcHJpb3JpdHk6IDEwMCxcclxuICAgIGF0Tm9kZUVuY291bnRlcih7IGN0eCwgdmFsdWUsIG5vZGUsIHF3ZWIgfSkge1xyXG4gICAgICAgIGN0eC5hZGRMaW5lKGAvLyBDb21wb25lbnQgJyR7dmFsdWV9J2ApO1xyXG4gICAgICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVRV2ViID0gdHJ1ZTtcclxuICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lUGFyZW50ID0gdHJ1ZTtcclxuICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lVXRpbHMgPSB0cnVlO1xyXG4gICAgICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVTY29wZSA9IHRydWU7XHJcbiAgICAgICAgbGV0IGhhc0R5bmFtaWNQcm9wcyA9IG5vZGUuZ2V0QXR0cmlidXRlKFwidC1wcm9wc1wiKSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICAvLyB0LW9uLSBldmVudHMgYW5kIHQtdHJhbnNpdGlvblxyXG4gICAgICAgIGNvbnN0IGV2ZW50cyA9IFtdO1xyXG4gICAgICAgIGxldCB0cmFuc2l0aW9uID0gXCJcIjtcclxuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gbm9kZS5hdHRyaWJ1dGVzO1xyXG4gICAgICAgIGNvbnN0IHByb3BzID0ge307XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBhdHRyaWJ1dGVzW2ldLm5hbWU7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXR0cmlidXRlc1tpXS50ZXh0Q29udGVudDtcclxuICAgICAgICAgICAgaWYgKG5hbWUuc3RhcnRzV2l0aChcInQtb24tXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudHMucHVzaChbbmFtZSwgdmFsdWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChuYW1lID09PSBcInQtdHJhbnNpdGlvblwiKSB7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoIW5hbWUuc3RhcnRzV2l0aChcInQtXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobmFtZSAhPT0gXCJjbGFzc1wiICYmIG5hbWUgIT09IFwic3R5bGVcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgaXMgYSBwcm9wIVxyXG4gICAgICAgICAgICAgICAgICAgIHByb3BzW25hbWVdID0gY3R4LmZvcm1hdEV4cHJlc3Npb24odmFsdWUpIHx8IFwidW5kZWZpbmVkXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY29tcHV0aW5nIHRoZSBwcm9wcyBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBwcm9wcyBvYmplY3RcclxuICAgICAgICBsZXQgcHJvcFN0ciA9IE9iamVjdC5rZXlzKHByb3BzKVxyXG4gICAgICAgICAgICAubWFwKGsgPT4gayArIFwiOlwiICsgcHJvcHNba10pXHJcbiAgICAgICAgICAgIC5qb2luKFwiLFwiKTtcclxuICAgICAgICBsZXQgY29tcG9uZW50SUQgPSBjdHguZ2VuZXJhdGVJRCgpO1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlS2V5ID0gY3R4LmdlbmVyYXRlVGVtcGxhdGVLZXkoKTtcclxuICAgICAgICBsZXQgcmVmID0gbm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LXJlZlwiKTtcclxuICAgICAgICBsZXQgcmVmRXhwciA9IFwiXCI7XHJcbiAgICAgICAgbGV0IHJlZktleSA9IFwiXCI7XHJcbiAgICAgICAgaWYgKHJlZikge1xyXG4gICAgICAgICAgICBjdHgucm9vdENvbnRleHQuc2hvdWxkRGVmaW5lUmVmcyA9IHRydWU7XHJcbiAgICAgICAgICAgIHJlZktleSA9IGByZWYke2N0eC5nZW5lcmF0ZUlEKCl9YDtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGNvbnN0ICR7cmVmS2V5fSA9ICR7Y3R4LmludGVycG9sYXRlKHJlZil9O2ApO1xyXG4gICAgICAgICAgICByZWZFeHByID0gYGNvbnRleHQuX19vd2xfXy5yZWZzWyR7cmVmS2V5fV0gPSB3JHtjb21wb25lbnRJRH07YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGZpbmFsaXplQ29tcG9uZW50Q29kZSA9IGB3JHtjb21wb25lbnRJRH0uZGVzdHJveSgpO2A7XHJcbiAgICAgICAgaWYgKHJlZikge1xyXG4gICAgICAgICAgICBmaW5hbGl6ZUNvbXBvbmVudENvZGUgKz0gYGRlbGV0ZSBjb250ZXh0Ll9fb3dsX18ucmVmc1ske3JlZktleX1dO2A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIGZpbmFsaXplQ29tcG9uZW50Q29kZSA9IGBsZXQgZmluYWxpemUgPSAoKSA9PiB7XHJcbiAgICAgICAgICAke2ZpbmFsaXplQ29tcG9uZW50Q29kZX1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGRlbGV0ZSB3JHtjb21wb25lbnRJRH0uX19vd2xfXy50cmFuc2l0aW9uSW5zZXJ0ZWQ7XHJcbiAgICAgICAgdXRpbHMudHJhbnNpdGlvblJlbW92ZSh2biwgJyR7dHJhbnNpdGlvbn0nLCBmaW5hbGl6ZSk7YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGNyZWF0ZUhvb2sgPSBcIlwiO1xyXG4gICAgICAgIGxldCBjbGFzc0F0dHIgPSBub2RlLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpO1xyXG4gICAgICAgIGxldCB0YXR0Q2xhc3MgPSBub2RlLmdldEF0dHJpYnV0ZShcInQtYXR0LWNsYXNzXCIpO1xyXG4gICAgICAgIGxldCBzdHlsZUF0dHIgPSBub2RlLmdldEF0dHJpYnV0ZShcInN0eWxlXCIpO1xyXG4gICAgICAgIGxldCB0YXR0U3R5bGUgPSBub2RlLmdldEF0dHJpYnV0ZShcInQtYXR0LXN0eWxlXCIpO1xyXG4gICAgICAgIGlmICh0YXR0U3R5bGUpIHtcclxuICAgICAgICAgICAgY29uc3QgYXR0VmFyID0gYF8ke2N0eC5nZW5lcmF0ZUlEKCl9YDtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGNvbnN0ICR7YXR0VmFyfSA9ICR7Y3R4LmZvcm1hdEV4cHJlc3Npb24odGF0dFN0eWxlKX07YCk7XHJcbiAgICAgICAgICAgIHRhdHRTdHlsZSA9IGF0dFZhcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGNsYXNzT2JqID0gXCJcIjtcclxuICAgICAgICBpZiAoY2xhc3NBdHRyIHx8IHRhdHRDbGFzcyB8fCBzdHlsZUF0dHIgfHwgdGF0dFN0eWxlIHx8IGV2ZW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKGNsYXNzQXR0cikge1xyXG4gICAgICAgICAgICAgICAgbGV0IGNsYXNzRGVmID0gY2xhc3NBdHRyXHJcbiAgICAgICAgICAgICAgICAgICAgLnRyaW0oKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zcGxpdCgvXFxzKy8pXHJcbiAgICAgICAgICAgICAgICAgICAgLm1hcChhID0+IGAnJHthfSc6dHJ1ZWApXHJcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oXCIsXCIpO1xyXG4gICAgICAgICAgICAgICAgY2xhc3NPYmogPSBgXyR7Y3R4LmdlbmVyYXRlSUQoKX1gO1xyXG4gICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCAke2NsYXNzT2JqfSA9IHske2NsYXNzRGVmfX07YCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHRhdHRDbGFzcykge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRhdHRFeHByID0gY3R4LmZvcm1hdEV4cHJlc3Npb24odGF0dENsYXNzKTtcclxuICAgICAgICAgICAgICAgIGlmICh0YXR0RXhwclswXSAhPT0gXCJ7XCIgfHwgdGF0dEV4cHJbdGF0dEV4cHIubGVuZ3RoIC0gMV0gIT09IFwifVwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGF0dEV4cHIgPSBgdXRpbHMudG9PYmooJHt0YXR0RXhwcn0pYDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChjbGFzc0F0dHIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjdHguYWRkTGluZShgT2JqZWN0LmFzc2lnbigke2NsYXNzT2JqfSwgJHt0YXR0RXhwcn0pYCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjbGFzc09iaiA9IGBfJHtjdHguZ2VuZXJhdGVJRCgpfWA7XHJcbiAgICAgICAgICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCAke2NsYXNzT2JqfSA9ICR7dGF0dEV4cHJ9O2ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBldmVudHNDb2RlID0gZXZlbnRzXHJcbiAgICAgICAgICAgICAgICAubWFwKGZ1bmN0aW9uIChbbmFtZSwgdmFsdWVdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYXB0dXJlID0gbmFtZS5tYXRjaCgvXFwuY2FwdHVyZS8pO1xyXG4gICAgICAgICAgICAgICAgbmFtZSA9IGNhcHR1cmUgPyBuYW1lLnJlcGxhY2UoL1xcLmNhcHR1cmUvLCBcIlwiKSA6IG5hbWU7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB7IGV2ZW50LCBoYW5kbGVyIH0gPSBtYWtlSGFuZGxlckNvZGUoY3R4LCBuYW1lLCB2YWx1ZSwgZmFsc2UsIFRfQ09NUE9ORU5UX01PRFNfQ09ERSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2FwdHVyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBgdm4uZWxtLmFkZEV2ZW50TGlzdGVuZXIoJyR7ZXZlbnR9JywgJHtoYW5kbGVyfSwgdHJ1ZSk7YDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBgdm4uZWxtLmFkZEV2ZW50TGlzdGVuZXIoJyR7ZXZlbnR9JywgJHtoYW5kbGVyfSk7YDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5qb2luKFwiXCIpO1xyXG4gICAgICAgICAgICBjb25zdCBzdHlsZUV4cHIgPSB0YXR0U3R5bGUgfHwgKHN0eWxlQXR0ciA/IGAnJHtzdHlsZUF0dHJ9J2AgOiBmYWxzZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHN0eWxlQ29kZSA9IHN0eWxlRXhwciA/IGB2bi5lbG0uc3R5bGUgPSAke3N0eWxlRXhwcn07YCA6IFwiXCI7XHJcbiAgICAgICAgICAgIGNyZWF0ZUhvb2sgPSBgdXRpbHMuYXNzaWduSG9va3Modm5vZGUuZGF0YSwge2NyZWF0ZShfLCB2bil7JHtzdHlsZUNvZGV9JHtldmVudHNDb2RlfX19KTtgO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkTGluZShgbGV0IHcke2NvbXBvbmVudElEfSA9ICR7dGVtcGxhdGVLZXl9IGluIHBhcmVudC5fX293bF9fLmNtYXAgPyBwYXJlbnQuX19vd2xfXy5jaGlsZHJlbltwYXJlbnQuX19vd2xfXy5jbWFwWyR7dGVtcGxhdGVLZXl9XV0gOiBmYWxzZTtgKTtcclxuICAgICAgICBsZXQgc2hvdWxkUHJveHkgPSAhY3R4LnBhcmVudE5vZGU7XHJcbiAgICAgICAgaWYgKHNob3VsZFByb3h5KSB7XHJcbiAgICAgICAgICAgIGxldCBpZCA9IGN0eC5nZW5lcmF0ZUlEKCk7XHJcbiAgICAgICAgICAgIGN0eC5yb290Q29udGV4dC5yb290Tm9kZSA9IGlkO1xyXG4gICAgICAgICAgICBzaG91bGRQcm94eSA9IHRydWU7XHJcbiAgICAgICAgICAgIGN0eC5yb290Q29udGV4dC5zaG91bGREZWZpbmVSZXN1bHQgPSB0cnVlO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IHZuJHtpZH0gPSB7fTtgKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHJlc3VsdCA9IHZuJHtpZH07YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChoYXNEeW5hbWljUHJvcHMpIHtcclxuICAgICAgICAgICAgY29uc3QgZHluYW1pY1Byb3AgPSBjdHguZm9ybWF0RXhwcmVzc2lvbihub2RlLmdldEF0dHJpYnV0ZShcInQtcHJvcHNcIikpO1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShgbGV0IHByb3BzJHtjb21wb25lbnRJRH0gPSBPYmplY3QuYXNzaWduKHske3Byb3BTdHJ9fSwgJHtkeW5hbWljUHJvcH0pO2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGxldCBwcm9wcyR7Y29tcG9uZW50SUR9ID0geyR7cHJvcFN0cn19O2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkSWYoYHcke2NvbXBvbmVudElEfSAmJiB3JHtjb21wb25lbnRJRH0uX19vd2xfXy5jdXJyZW50RmliZXIgJiYgIXcke2NvbXBvbmVudElEfS5fX293bF9fLnZub2RlYCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfS5kZXN0cm95KCk7YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfSA9IGZhbHNlO2ApO1xyXG4gICAgICAgIGN0eC5jbG9zZUlmKCk7XHJcbiAgICAgICAgbGV0IHJlZ2lzdGVyQ29kZSA9IFwiXCI7XHJcbiAgICAgICAgaWYgKHNob3VsZFByb3h5KSB7XHJcbiAgICAgICAgICAgIHJlZ2lzdGVyQ29kZSA9IGB1dGlscy5kZWZpbmVQcm94eSh2biR7Y3R4LnJvb3ROb2RlfSwgcHZub2RlKTtgO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTTE9UU1xyXG4gICAgICAgIGNvbnN0IGhhc1Nsb3RzID0gbm9kZS5jaGlsZE5vZGVzLmxlbmd0aDtcclxuICAgICAgICBsZXQgc2NvcGUgPSBoYXNTbG90cyA/IGBPYmplY3QuYXNzaWduKE9iamVjdC5jcmVhdGUoY29udGV4dCksIHNjb3BlKWAgOiBcInVuZGVmaW5lZFwiO1xyXG4gICAgICAgIGN0eC5hZGRJZihgdyR7Y29tcG9uZW50SUR9YCk7XHJcbiAgICAgICAgLy8gbmVlZCB0byB1cGRhdGUgY29tcG9uZW50XHJcbiAgICAgICAgbGV0IHN0eWxlQ29kZSA9IFwiXCI7XHJcbiAgICAgICAgaWYgKHRhdHRTdHlsZSkge1xyXG4gICAgICAgICAgICBzdHlsZUNvZGUgPSBgLnRoZW4oKCk9PntpZiAodyR7Y29tcG9uZW50SUR9Ll9fb3dsX18uaXNEZXN0cm95ZWQpIHtyZXR1cm59O3cke2NvbXBvbmVudElEfS5lbC5zdHlsZT0ke3RhdHRTdHlsZX07fSk7YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfS5fX3VwZGF0ZVByb3BzKHByb3BzJHtjb21wb25lbnRJRH0sIGV4dHJhLmZpYmVyLCAke3Njb3BlfSkke3N0eWxlQ29kZX07YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBwdm5vZGUgPSB3JHtjb21wb25lbnRJRH0uX19vd2xfXy5wdm5vZGU7YCk7XHJcbiAgICAgICAgaWYgKHJlZ2lzdGVyQ29kZSkge1xyXG4gICAgICAgICAgICBjdHguYWRkTGluZShyZWdpc3RlckNvZGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoY3R4LnBhcmVudE5vZGUpIHtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYGMke2N0eC5wYXJlbnROb2RlfS5wdXNoKHB2bm9kZSk7YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN0eC5hZGRFbHNlKCk7XHJcbiAgICAgICAgLy8gbmV3IGNvbXBvbmVudFxyXG4gICAgICAgIGxldCBkeW5hbWljRmFsbGJhY2sgPSBcIlwiO1xyXG4gICAgICAgIGlmICghdmFsdWUubWF0Y2goSU5URVJQX1JFR0VYUCkpIHtcclxuICAgICAgICAgICAgZHluYW1pY0ZhbGxiYWNrID0gYHx8ICR7Y3R4LmZvcm1hdEV4cHJlc3Npb24odmFsdWUpfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGludGVycFZhbHVlID0gY3R4LmludGVycG9sYXRlKHZhbHVlKTtcclxuICAgICAgICBjdHguYWRkTGluZShgbGV0IGNvbXBvbmVudEtleSR7Y29tcG9uZW50SUR9ID0gJHtpbnRlcnBWYWx1ZX07YCk7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBXJHtjb21wb25lbnRJRH0gPSBjb250ZXh0LmNvbnN0cnVjdG9yLmNvbXBvbmVudHNbY29tcG9uZW50S2V5JHtjb21wb25lbnRJRH1dIHx8IFFXZWIuY29tcG9uZW50c1tjb21wb25lbnRLZXkke2NvbXBvbmVudElEfV0ke2R5bmFtaWNGYWxsYmFja307YCk7XHJcbiAgICAgICAgLy8gbWF5YmUgb25seSBkbyB0aGlzIGluIGRldiBtb2RlLi4uXHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGlmICghVyR7Y29tcG9uZW50SUR9KSB7dGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZmluZCB0aGUgZGVmaW5pdGlvbiBvZiBjb21wb25lbnQgXCInICsgY29tcG9uZW50S2V5JHtjb21wb25lbnRJRH0gKyAnXCInKX1gKTtcclxuICAgICAgICBjdHguYWRkTGluZShgdyR7Y29tcG9uZW50SUR9ID0gbmV3IFcke2NvbXBvbmVudElEfShwYXJlbnQsIHByb3BzJHtjb21wb25lbnRJRH0pO2ApO1xyXG4gICAgICAgIGlmICh0cmFuc2l0aW9uKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBjb25zdCBfX3BhdGNoJHtjb21wb25lbnRJRH0gPSB3JHtjb21wb25lbnRJRH0uX19wYXRjaDtgKTtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfS5fX3BhdGNoID0gKHQsIHZuKSA9PiB7X19wYXRjaCR7Y29tcG9uZW50SUR9LmNhbGwodyR7Y29tcG9uZW50SUR9LCB0LCB2bik7IGlmKCF3JHtjb21wb25lbnRJRH0uX19vd2xfXy50cmFuc2l0aW9uSW5zZXJ0ZWQpe3cke2NvbXBvbmVudElEfS5fX293bF9fLnRyYW5zaXRpb25JbnNlcnRlZCA9IHRydWU7dXRpbHMudHJhbnNpdGlvbkluc2VydCh3JHtjb21wb25lbnRJRH0uX19vd2xfXy52bm9kZSwgJyR7dHJhbnNpdGlvbn0nKTt9fTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHBhcmVudC5fX293bF9fLmNtYXBbJHt0ZW1wbGF0ZUtleX1dID0gdyR7Y29tcG9uZW50SUR9Ll9fb3dsX18uaWQ7YCk7XHJcbiAgICAgICAgaWYgKGhhc1Nsb3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNsb25lID0gbm9kZS5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHNsb3ROb2RlcyA9IEFycmF5LmZyb20oY2xvbmUucXVlcnlTZWxlY3RvckFsbChcIlt0LXNldC1zbG90XVwiKSk7XHJcbiAgICAgICAgICAgIC8vIFRoZSBuZXh0IGNvZGUgaXMgYSBmYWxsYmFjayBmb3IgY29tcGF0aWJpbGl0eSByZWFzb24uIEl0IGFjY2VwdHMgdC1zZXRcclxuICAgICAgICAgICAgLy8gZWxlbWVudHMgdGhhdCBhcmUgZGlyZWN0IGNoaWxkcmVuIHdpdGggYSBub24gZW1wdHkgYm9keSBhcyBub2RlcyBkZWZpbmluZ1xyXG4gICAgICAgICAgICAvLyB0aGUgY29udGVudCBvZiBhIHNsb3QuXHJcbiAgICAgICAgICAgIC8vXHJcbiAgICAgICAgICAgIC8vIFRoaXMgaXMgd3JvbmcsIGJ1dCBpcyBuZWNlc3NhcnkgdG8gcHJldmVudCBicmVha2luZyBhbGwgZXhpc3RpbmcgT3dsXHJcbiAgICAgICAgICAgIC8vIGNvZGUgdXNpbmcgc2xvdHMuIFRoaXMgd2lsbCBiZSByZW1vdmVkIGluIHYyLjAgc29tZWRheS4gTWVhbndoaWxlLFxyXG4gICAgICAgICAgICAvLyBwbGVhc2UgdXNlIHQtc2V0LXNsb3QgZXZlcnl3aGVyZSB5b3UgbmVlZCB0byBzZXQgdGhlIGNvbnRlbnQgb2YgYVxyXG4gICAgICAgICAgICAvLyBzbG90LlxyXG4gICAgICAgICAgICBmb3IgKGxldCBlbCBvZiBjbG9uZS5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsLmdldEF0dHJpYnV0ZShcInQtc2V0XCIpICYmIGVsLmhhc0NoaWxkTm9kZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNsb3ROb2Rlcy5wdXNoKGVsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBzbG90SWQgPSBRV2ViLm5leHRTbG90SWQrKztcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfS5fX293bF9fLnNsb3RJZCA9ICR7c2xvdElkfTtgKTtcclxuICAgICAgICAgICAgaWYgKHNsb3ROb2Rlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW5ndGggPSBzbG90Tm9kZXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzbG90Tm9kZSA9IHNsb3ROb2Rlc1tpXTtcclxuICAgICAgICAgICAgICAgICAgICBzbG90Tm9kZS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHNsb3ROb2RlKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQga2V5ID0gc2xvdE5vZGUuZ2V0QXR0cmlidXRlKFwidC1zZXQtc2xvdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICBzbG90Tm9kZS5yZW1vdmVBdHRyaWJ1dGUoXCJ0LXNldC1zbG90XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGhlcmUgYWdhaW4sIHRoaXMgY29kZSBzaG91bGQgYmUgcmVtb3ZlZCB3aGVuIHdlIHN0b3Agc3VwcG9ydGluZ1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVzaW5nIHQtc2V0IHRvIGRlZmluZSB0aGUgY29udGVudCBvZiBuYW1lZCBzbG90cy5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXkgPSBzbG90Tm9kZS5nZXRBdHRyaWJ1dGUoXCJ0LXNldFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2xvdE5vZGUucmVtb3ZlQXR0cmlidXRlKFwidC1zZXRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNsb3RGbiA9IHF3ZWIuX2NvbXBpbGUoYHNsb3RfJHtrZXl9X3RlbXBsYXRlYCwgc2xvdE5vZGUsIGN0eCk7XHJcbiAgICAgICAgICAgICAgICAgICAgUVdlYi5zbG90c1tgJHtzbG90SWR9XyR7a2V5fWBdID0gc2xvdEZuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjbG9uZS5jaGlsZE5vZGVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGNsb25lLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRcIik7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjaGlsZCBvZiBPYmplY3QudmFsdWVzKGNsb25lLmNoaWxkTm9kZXMpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdC5hcHBlbmRDaGlsZChjaGlsZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzbG90Rm4gPSBxd2ViLl9jb21waWxlKGBzbG90X2RlZmF1bHRfdGVtcGxhdGVgLCB0LCBjdHgpO1xyXG4gICAgICAgICAgICAgICAgUVdlYi5zbG90c1tgJHtzbG90SWR9X2RlZmF1bHRgXSA9IHNsb3RGbjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkTGluZShgbGV0IGZpYmVyID0gdyR7Y29tcG9uZW50SUR9Ll9fcHJlcGFyZShleHRyYS5maWJlciwgJHtzY29wZX0sICgpID0+IHsgY29uc3Qgdm5vZGUgPSBmaWJlci52bm9kZTsgcHZub2RlLnNlbCA9IHZub2RlLnNlbDsgJHtjcmVhdGVIb29rfX0pO2ApO1xyXG4gICAgICAgIC8vIGhhY2s6IHNwZWNpZnkgZW1wdHkgcmVtb3ZlIGhvb2sgdG8gcHJldmVudCB0aGUgbm9kZSBmcm9tIGJlaW5nIHJlbW92ZWQgZnJvbSB0aGUgRE9NXHJcbiAgICAgICAgY29uc3QgaW5zZXJ0SG9vayA9IHJlZkV4cHIgPyBgaW5zZXJ0KHZuKSB7JHtyZWZFeHByfX0sYCA6IFwiXCI7XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYGxldCBwdm5vZGUgPSBoKCdkdW1teScsIHtrZXk6ICR7dGVtcGxhdGVLZXl9LCBob29rOiB7JHtpbnNlcnRIb29rfXJlbW92ZSgpIHt9LGRlc3Ryb3kodm4pIHske2ZpbmFsaXplQ29tcG9uZW50Q29kZX19fX0pO2ApO1xyXG4gICAgICAgIGlmIChyZWdpc3RlckNvZGUpIHtcclxuICAgICAgICAgICAgY3R4LmFkZExpbmUocmVnaXN0ZXJDb2RlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGN0eC5wYXJlbnROb2RlKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGBjJHtjdHgucGFyZW50Tm9kZX0ucHVzaChwdm5vZGUpO2ApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdHguYWRkTGluZShgdyR7Y29tcG9uZW50SUR9Ll9fb3dsX18ucHZub2RlID0gcHZub2RlO2ApO1xyXG4gICAgICAgIGN0eC5jbG9zZUlmKCk7XHJcbiAgICAgICAgaWYgKGNsYXNzT2JqKSB7XHJcbiAgICAgICAgICAgIGN0eC5hZGRMaW5lKGB3JHtjb21wb25lbnRJRH0uX19vd2xfXy5jbGFzc09iaj0ke2NsYXNzT2JqfTtgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY3R4LmFkZExpbmUoYHcke2NvbXBvbmVudElEfS5fX293bF9fLnBhcmVudExhc3RGaWJlcklkID0gZXh0cmEuZmliZXIuaWQ7YCk7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0pO1xuXG5jbGFzcyBTY2hlZHVsZXIge1xyXG4gICAgY29uc3RydWN0b3IocmVxdWVzdEFuaW1hdGlvbkZyYW1lKSB7XHJcbiAgICAgICAgdGhpcy50YXNrcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XHJcbiAgICB9XHJcbiAgICBzdGFydCgpIHtcclxuICAgICAgICB0aGlzLmlzUnVubmluZyA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zY2hlZHVsZVRhc2tzKCk7XHJcbiAgICB9XHJcbiAgICBzdG9wKCkge1xyXG4gICAgICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBhZGRGaWJlcihmaWJlcikge1xyXG4gICAgICAgIC8vIGlmIHRoZSBmaWJlciB3YXMgcmVtYXBwZWQgaW50byBhIGxhcmdlciByZW5kZXJpbmcgZmliZXIsIGl0IG1heSBub3QgYmUgYVxyXG4gICAgICAgIC8vIHJvb3QgZmliZXIuICBCdXQgd2Ugb25seSB3YW50IHRvIHJlZ2lzdGVyIHJvb3QgZmliZXJzXHJcbiAgICAgICAgZmliZXIgPSBmaWJlci5yb290O1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChmaWJlci5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChmaWJlci5lcnJvcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy50YXNrcy5wdXNoKHtcclxuICAgICAgICAgICAgICAgIGZpYmVyLFxyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZmliZXIuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChmaWJlci5lcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5pc1J1bm5pbmcpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhcnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmVqZWN0RmliZXIoZmliZXIsIHJlYXNvbikge1xyXG4gICAgICAgIGZpYmVyID0gZmliZXIucm9vdDtcclxuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMudGFza3MuZmluZEluZGV4KHQgPT4gdC5maWJlciA9PT0gZmliZXIpO1xyXG4gICAgICAgIGlmIChpbmRleCA+PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IFt0YXNrXSA9IHRoaXMudGFza3Muc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgICAgICAgZmliZXIuY2FuY2VsKCk7XHJcbiAgICAgICAgICAgIGZpYmVyLmVycm9yID0gbmV3IEVycm9yKHJlYXNvbik7XHJcbiAgICAgICAgICAgIHRhc2suY2FsbGJhY2soKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFByb2Nlc3MgYWxsIGN1cnJlbnQgdGFza3MuIFRoaXMgb25seSBhcHBsaWVzIHRvIHRoZSBmaWJlcnMgdGhhdCBhcmUgcmVhZHkuXHJcbiAgICAgKiBPdGhlciB0YXNrcyBhcmUgbGVmdCB1bmNoYW5nZWQuXHJcbiAgICAgKi9cclxuICAgIGZsdXNoKCkge1xyXG4gICAgICAgIGxldCB0YXNrcyA9IHRoaXMudGFza3M7XHJcbiAgICAgICAgdGhpcy50YXNrcyA9IFtdO1xyXG4gICAgICAgIHRhc2tzID0gdGFza3MuZmlsdGVyKHRhc2sgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGFzay5maWJlci5pc0NvbXBsZXRlZCkge1xyXG4gICAgICAgICAgICAgICAgdGFzay5jYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICh0YXNrLmZpYmVyLmNvdW50ZXIgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGFzay5maWJlci5lcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhc2suZmliZXIuY29tcGxldGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFzay5maWJlci5oYW5kbGVFcnJvcihlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0YXNrLmNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy50YXNrcyA9IHRhc2tzLmNvbmNhdCh0aGlzLnRhc2tzKTtcclxuICAgICAgICBpZiAodGhpcy50YXNrcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgdGhpcy5zdG9wKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgc2NoZWR1bGVUYXNrcygpIHtcclxuICAgICAgICB0aGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuZmx1c2goKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuaXNSdW5uaW5nKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNjaGVkdWxlVGFza3MoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbmNvbnN0IHNjaGVkdWxlciA9IG5ldyBTY2hlZHVsZXIoYnJvd3Nlci5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUpO1xuXG4vKipcclxuICogT3dsIEZpYmVyIENsYXNzXHJcbiAqXHJcbiAqIEZpYmVycyBhcmUgc21hbGwgYWJzdHJhY3Rpb25zIGRlc2lnbmVkIHRvIGNvbnRhaW4gYWxsIHRoZSBpbnRlcm5hbCBzdGF0ZVxyXG4gKiBhc3NvY2lhdGVkIHdpdGggYSBcInJlbmRlcmluZyB3b3JrIHVuaXRcIiwgcmVsYXRpdmUgdG8gYSBzcGVjaWZpYyBjb21wb25lbnQuXHJcbiAqXHJcbiAqIEEgcmVuZGVyaW5nIHdpbGwgY2F1c2UgdGhlIGNyZWF0aW9uIG9mIGEgZmliZXIgZm9yIGVhY2ggaW1wYWN0ZWQgY29tcG9uZW50cy5cclxuICpcclxuICogRmliZXJzIGNhcHR1cmUgYWxsIHRoYXQgbmVjZXNzYXJ5IGluZm9ybWF0aW9uLCB3aGljaCBpcyBjcml0aWNhbCB0byBvd2xcclxuICogYXN5bmNocm9ub3VzIHJlbmRlcmluZyBwaXBlbGluZS4gRmliZXJzIGNhbiBiZSBjYW5jZWxsZWQsIGNhbiBiZSBpbiBkaWZmZXJlbnRcclxuICogc3RhdGVzIGFuZCBpbiBnZW5lcmFsIGRldGVybWluZSB0aGUgc3RhdGUgb2YgdGhlIHJlbmRlcmluZy5cclxuICovXHJcbmNsYXNzIEZpYmVyIHtcclxuICAgIGNvbnN0cnVjdG9yKHBhcmVudCwgY29tcG9uZW50LCBmb3JjZSwgdGFyZ2V0LCBwb3NpdGlvbikge1xyXG4gICAgICAgIHRoaXMuaWQgPSBGaWJlci5uZXh0SWQrKztcclxuICAgICAgICAvLyBpc0NvbXBsZXRlZCBtZWFucyB0aGF0IHRoZSByZW5kZXJpbmcgY29ycmVzcG9uZGluZyB0byB0aGlzIGZpYmVyJ3Mgd29yayBpc1xyXG4gICAgICAgIC8vIGRvbmUsIGVpdGhlciBiZWNhdXNlIHRoZSBjb21wb25lbnQgaGFzIGJlZW4gbW91bnRlZCBvciBwYXRjaGVkLCBvciBiZWNhdXNlXHJcbiAgICAgICAgLy8gZmliZXIgaGFzIGJlZW4gY2FuY2VsbGVkLlxyXG4gICAgICAgIHRoaXMuaXNDb21wbGV0ZWQgPSBmYWxzZTtcclxuICAgICAgICAvLyB0aGUgZmliZXJzIGNvcnJlc3BvbmRpbmcgdG8gY29tcG9uZW50IHVwZGF0ZXMgKHVwZGF0ZVByb3BzKSBuZWVkIHRvIGNhbGxcclxuICAgICAgICAvLyB0aGUgd2lsbFBhdGNoIGFuZCBwYXRjaGVkIGhvb2tzIGZyb20gdGhlIGNvcnJlc3BvbmRpbmcgY29tcG9uZW50LiBIb3dldmVyLFxyXG4gICAgICAgIC8vIGZpYmVycyBjb3JyZXNwb25kaW5nIHRvIGEgbmV3IGNvbXBvbmVudCBkbyBub3QgbmVlZCB0byBkbyB0aGF0LiBTbywgdGhlXHJcbiAgICAgICAgLy8gc2hvdWxkUGF0Y2ggaG9vayBpcyB0aGUgYm9vbGVhbiB0aGF0IHdlIGNoZWNrIHdoZW5ldmVyIHdlIG5lZWQgdG8gYXBwbHlcclxuICAgICAgICAvLyBhIHBhdGNoLlxyXG4gICAgICAgIHRoaXMuc2hvdWxkUGF0Y2ggPSB0cnVlO1xyXG4gICAgICAgIC8vIGlzUmVuZGVyZWQgaXMgdGhlIGxhc3Qgc3RhdGUgb2YgYSBmaWJlci4gSWYgdHJ1ZSwgdGhpcyBtZWFucyB0aGF0IGl0IGhhc1xyXG4gICAgICAgIC8vIGJlZW4gcmVuZGVyZWQgYW5kIGlzIGluZXJ0IChzbywgaXQgc2hvdWxkIG5vdCBiZSB0YWtlbiBpbnRvIGFjY291bnQgd2hlblxyXG4gICAgICAgIC8vIGNvdW50aW5nIHRoZSBudW1iZXIgb2YgYWN0aXZlIGZpYmVycykuXHJcbiAgICAgICAgdGhpcy5pc1JlbmRlcmVkID0gZmFsc2U7XHJcbiAgICAgICAgLy8gdGhlIGNvdW50ZXIgbnVtYmVyIGlzIGEgY3JpdGljYWwgaW5mb3JtYXRpb24uIEl0IGlzIG9ubHkgbmVjZXNzYXJ5IGZvciBhXHJcbiAgICAgICAgLy8gcm9vdCBmaWJlci4gIEZvciB0aGF0IGZpYmVyLCB0aGlzIG51bWJlciBjb3VudHMgdGhlIG51bWJlciBvZiBhY3RpdmUgc3ViXHJcbiAgICAgICAgLy8gZmliZXJzLiAgV2hlbiB0aGF0IG51bWJlciByZWFjaGVzIDAsIHRoZSBmaWJlciBjYW4gYmUgYXBwbGllZCBieSB0aGVcclxuICAgICAgICAvLyBzY2hlZHVsZXIuXHJcbiAgICAgICAgdGhpcy5jb3VudGVyID0gMDtcclxuICAgICAgICB0aGlzLnZub2RlID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNoaWxkID0gbnVsbDtcclxuICAgICAgICB0aGlzLnNpYmxpbmcgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubGFzdENoaWxkID0gbnVsbDtcclxuICAgICAgICB0aGlzLnBhcmVudCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICAgICAgdGhpcy5mb3JjZSA9IGZvcmNlO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgIHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcclxuICAgICAgICBjb25zdCBfX293bF9fID0gY29tcG9uZW50Ll9fb3dsX187XHJcbiAgICAgICAgdGhpcy5zY29wZSA9IF9fb3dsX18uc2NvcGU7XHJcbiAgICAgICAgdGhpcy5yb290ID0gcGFyZW50ID8gcGFyZW50LnJvb3QgOiB0aGlzO1xyXG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xyXG4gICAgICAgIGxldCBvbGRGaWJlciA9IF9fb3dsX18uY3VycmVudEZpYmVyO1xyXG4gICAgICAgIGlmIChvbGRGaWJlciAmJiAhb2xkRmliZXIuaXNDb21wbGV0ZWQpIHtcclxuICAgICAgICAgICAgaWYgKG9sZEZpYmVyLnJvb3QgPT09IG9sZEZpYmVyICYmICFwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIC8vIGJvdGggb2xkRmliZXIgYW5kIHRoaXMgZmliZXIgYXJlIHJvb3QgZmliZXJzXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXVzZUZpYmVyKG9sZEZpYmVyKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBvbGRGaWJlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbWFwRmliZXIob2xkRmliZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucm9vdC5jb3VudGVyKys7XHJcbiAgICAgICAgX19vd2xfXy5jdXJyZW50RmliZXIgPSB0aGlzO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBXaGVuIHRoZSBvbGRGaWJlciBpcyBub3QgY29tcGxldGVkIHlldCwgYW5kIGJvdGggb2xkRmliZXIgYW5kIHRoaXMgZmliZXJcclxuICAgICAqIGFyZSByb290IGZpYmVycywgd2Ugd2FudCB0byByZXVzZSB0aGUgb2xkRmliZXIgaW5zdGVhZCBvZiBjcmVhdGluZyBhIG5ld1xyXG4gICAgICogb25lLiBEb2luZyBzbyB3aWxsIGd1YXJhbnRlZSB0aGF0IHRoZSBpbml0aWF0b3Iocykgb2YgdGhvc2UgcmVuZGVyaW5ncyB3aWxsXHJcbiAgICAgKiBiZSBub3RpZmllZCAodGhlIHByb21pc2Ugd2lsbCByZXNvbHZlKSB3aGVuIHRoZSBsYXN0IHJlbmRlcmluZyB3aWxsIGJlIGRvbmUuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiB0aHVzIGFzc3VtZXMgdGhhdCBvbGRGaWJlciBpcyBhIHJvb3QgZmliZXIuXHJcbiAgICAgKi9cclxuICAgIF9yZXVzZUZpYmVyKG9sZEZpYmVyKSB7XHJcbiAgICAgICAgb2xkRmliZXIuY2FuY2VsKCk7IC8vIGNhbmNlbCBjaGlsZHJlbiBmaWJlcnNcclxuICAgICAgICBvbGRGaWJlci5pc0NvbXBsZXRlZCA9IGZhbHNlOyAvLyBrZWVwIHRoZSByb290IGZpYmVyIGFsaXZlXHJcbiAgICAgICAgb2xkRmliZXIuaXNSZW5kZXJlZCA9IGZhbHNlOyAvLyB0aGUgZmliZXIgaGFzIHRvIGJlIHJlLXJlbmRlcmVkXHJcbiAgICAgICAgaWYgKG9sZEZpYmVyLmNoaWxkKSB7XHJcbiAgICAgICAgICAgIC8vIHJlbW92ZSByZWxhdGlvbiB0byBjaGlsZHJlblxyXG4gICAgICAgICAgICBvbGRGaWJlci5jaGlsZC5wYXJlbnQgPSBudWxsO1xyXG4gICAgICAgICAgICBvbGRGaWJlci5jaGlsZCA9IG51bGw7XHJcbiAgICAgICAgICAgIG9sZEZpYmVyLmxhc3RDaGlsZCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIG9sZEZpYmVyLmNvdW50ZXIgPSAxOyAvLyByZS1pbml0aWFsaXplIGNvdW50ZXJcclxuICAgICAgICBvbGRGaWJlci5pZCA9IEZpYmVyLm5leHRJZCsrO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJbiBzb21lIGNhc2VzLCBhIHJlbmRlcmluZyBpbml0aWF0ZWQgYXQgc29tZSBjb21wb25lbnQgY2FuIGRldGVjdCB0aGF0IGl0XHJcbiAgICAgKiBzaG91bGQgYmUgcGFydCBvZiBhIGxhcmdlciByZW5kZXJpbmcgaW5pdGlhdGVkIHNvbWV3aGVyZSB1cCB0aGUgY29tcG9uZW50XHJcbiAgICAgKiB0cmVlLiAgSW4gdGhhdCBjYXNlLCBpdCBuZWVkcyB0byBjYW5jZWwgdGhlIHByZXZpb3VzIHJlbmRlcmluZyBhbmRcclxuICAgICAqIHJlbWFwIGl0c2VsZiBhcyBhIHBhcnQgb2YgdGhlIGN1cnJlbnQgcGFyZW50IHJlbmRlcmluZy5cclxuICAgICAqL1xyXG4gICAgX3JlbWFwRmliZXIob2xkRmliZXIpIHtcclxuICAgICAgICBvbGRGaWJlci5jYW5jZWwoKTtcclxuICAgICAgICB0aGlzLnNob3VsZFBhdGNoID0gb2xkRmliZXIuc2hvdWxkUGF0Y2g7XHJcbiAgICAgICAgaWYgKG9sZEZpYmVyID09PSBvbGRGaWJlci5yb290KSB7XHJcbiAgICAgICAgICAgIG9sZEZpYmVyLmNvdW50ZXIrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9sZEZpYmVyLnBhcmVudCAmJiAhdGhpcy5wYXJlbnQpIHtcclxuICAgICAgICAgICAgLy8gcmUtbWFwIGxpbmtzXHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gb2xkRmliZXIucGFyZW50O1xyXG4gICAgICAgICAgICB0aGlzLnJvb3QgPSB0aGlzLnBhcmVudC5yb290O1xyXG4gICAgICAgICAgICB0aGlzLnNpYmxpbmcgPSBvbGRGaWJlci5zaWJsaW5nO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQubGFzdENoaWxkID09PSBvbGRGaWJlcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQubGFzdENoaWxkID0gdGhpcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuY2hpbGQgPT09IG9sZEZpYmVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5jaGlsZCA9IHRoaXM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudCA9IHRoaXMucGFyZW50LmNoaWxkO1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5zaWJsaW5nID09PSBvbGRGaWJlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50LnNpYmxpbmcgPSB0aGlzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQuc2libGluZztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBmdW5jdGlvbiBoYXMgYmVlbiB0YWtlbiBmcm9tXHJcbiAgICAgKiBodHRwczovL21lZGl1bS5jb20vcmVhY3QtaW4tZGVwdGgvdGhlLWhvdy1hbmQtd2h5LW9uLXJlYWN0cy11c2FnZS1vZi1saW5rZWQtbGlzdC1pbi1maWJlci02N2YxMDE0ZDBlYjdcclxuICAgICAqL1xyXG4gICAgX3dhbGsoZG9Xb3JrKSB7XHJcbiAgICAgICAgbGV0IHJvb3QgPSB0aGlzO1xyXG4gICAgICAgIGxldCBjdXJyZW50ID0gdGhpcztcclxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCBjaGlsZCA9IGRvV29yayhjdXJyZW50KTtcclxuICAgICAgICAgICAgaWYgKGNoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50ID0gY2hpbGQ7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY3VycmVudCA9PT0gcm9vdCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHdoaWxlICghY3VycmVudC5zaWJsaW5nKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWN1cnJlbnQucGFyZW50IHx8IGN1cnJlbnQucGFyZW50ID09PSByb290KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGN1cnJlbnQgPSBjdXJyZW50LnNpYmxpbmc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBTdWNjZXNzZnVsbHkgY29tcGxldGUgdGhlIHdvcmsgb2YgdGhlIGZpYmVyOiBjYWxsIHRoZSBtb3VudCBvciBwYXRjaCBob29rc1xyXG4gICAgICogYW5kIHBhdGNoIHRoZSBET00uIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIG9uY2UgdGhlIGZpYmVyIGFuZCBpdHMgY2hpbGRyZW5cclxuICAgICAqIGFyZSByZWFkeSwgYW5kIHRoZSBzY2hlZHVsZXIgZGVjaWRlcyB0byBwcm9jZXNzIGl0LlxyXG4gICAgICovXHJcbiAgICBjb21wbGV0ZSgpIHtcclxuICAgICAgICBsZXQgY29tcG9uZW50ID0gdGhpcy5jb21wb25lbnQ7XHJcbiAgICAgICAgdGhpcy5pc0NvbXBsZXRlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKCF0aGlzLnRhcmdldCAmJiAhY29tcG9uZW50Ll9fb3dsX18uaXNNb3VudGVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gYnVpbGQgcGF0Y2hRdWV1ZVxyXG4gICAgICAgIGNvbnN0IHBhdGNoUXVldWUgPSBbXTtcclxuICAgICAgICBjb25zdCBkb1dvcmsgPSBmdW5jdGlvbiAoZikge1xyXG4gICAgICAgICAgICBwYXRjaFF1ZXVlLnB1c2goZik7XHJcbiAgICAgICAgICAgIHJldHVybiBmLmNoaWxkO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fd2Fsayhkb1dvcmspO1xyXG4gICAgICAgIGNvbnN0IHBhdGNoTGVuID0gcGF0Y2hRdWV1ZS5sZW5ndGg7XHJcbiAgICAgICAgLy8gY2FsbCB3aWxsUGF0Y2ggaG9vayBvbiBlYWNoIGZpYmVyIG9mIHBhdGNoUXVldWVcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBhdGNoTGVuOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgZmliZXIgPSBwYXRjaFF1ZXVlW2ldO1xyXG4gICAgICAgICAgICBpZiAoZmliZXIuc2hvdWxkUGF0Y2gpIHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudCA9IGZpYmVyLmNvbXBvbmVudDtcclxuICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnQuX19vd2xfXy53aWxsUGF0Y2hDQikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5fX293bF9fLndpbGxQYXRjaENCKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQud2lsbFBhdGNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY2FsbCBfX3BhdGNoIG9uIGVhY2ggZmliZXIgb2YgKHJldmVyc2VkKSBwYXRjaFF1ZXVlXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IHBhdGNoTGVuIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgICAgICAgICAgY29uc3QgZmliZXIgPSBwYXRjaFF1ZXVlW2ldO1xyXG4gICAgICAgICAgICBjb21wb25lbnQgPSBmaWJlci5jb21wb25lbnQ7XHJcbiAgICAgICAgICAgIGlmIChmaWJlci50YXJnZXQgJiYgaSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRhcmdldDtcclxuICAgICAgICAgICAgICAgIGlmIChmaWJlci5wb3NpdGlvbiA9PT0gXCJzZWxmXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBmaWJlci50YXJnZXQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgIT09IGZpYmVyLnZub2RlLnNlbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBhdHRhY2ggJyR7Y29tcG9uZW50LmNvbnN0cnVjdG9yLm5hbWV9JyB0byB0YXJnZXQgbm9kZSAobm90IHNhbWUgdGFnIG5hbWUpYCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEluIHNlbGYgbW9kZSwgd2UgKmtub3cqIHdlIGFyZSB0byB0YWtlIHBvc3Nlc3Npb24gb2YgdGhlIHRhcmdldFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEhlbmNlIHdlIG1hbnVhbGx5IGNyZWF0ZSB0aGUgY29ycmVzcG9uZGluZyBWTm9kZSBhbmQgY29weSB0aGUgXCJrZXlcIiBpbiBkYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc2VsZlZub2RlRGF0YSA9IGZpYmVyLnZub2RlLmRhdGEgPyB7IGtleTogZmliZXIudm5vZGUuZGF0YS5rZXkgfSA6IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGZWbm9kZSA9IGgoZmliZXIudm5vZGUuc2VsLCBzZWxmVm5vZGVEYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmVm5vZGUuZWxtID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHNlbGZWbm9kZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IGNvbXBvbmVudC5fX293bF9fLnZub2RlIHx8IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZmliZXIudm5vZGUuc2VsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5fX3BhdGNoKHRhcmdldCwgZmliZXIudm5vZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpYmVyLnNob3VsZFBhdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50Ll9fcGF0Y2goY29tcG9uZW50Ll9fb3dsX18udm5vZGUsIGZpYmVyLnZub2RlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5fX3BhdGNoKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoZmliZXIudm5vZGUuc2VsKSwgZmliZXIudm5vZGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbXBvbmVudC5fX293bF9fLnB2bm9kZS5lbG0gPSBjb21wb25lbnQuX19vd2xfXy52bm9kZS5lbG07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29tcG9uZW50Ll9fb3dsX18uY3VycmVudEZpYmVyID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaW5zZXJ0IGludG8gdGhlIERPTSAobW91bnQgY2FzZSlcclxuICAgICAgICBsZXQgaW5ET00gPSBmYWxzZTtcclxuICAgICAgICBpZiAodGhpcy50YXJnZXQpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0aGlzLnBvc2l0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZmlyc3QtY2hpbGRcIjpcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRhcmdldC5wcmVwZW5kKHRoaXMuY29tcG9uZW50LmVsKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGNhc2UgXCJsYXN0LWNoaWxkXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXQuYXBwZW5kQ2hpbGQodGhpcy5jb21wb25lbnQuZWwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGluRE9NID0gZG9jdW1lbnQuYm9keS5jb250YWlucyh0aGlzLmNvbXBvbmVudC5lbCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50LmVudi5xd2ViLnRyaWdnZXIoXCJkb20tYXBwZW5kZWRcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGNhbGwgcGF0Y2hlZC9tb3VudGVkIGhvb2sgb24gZWFjaCBmaWJlciBvZiAocmV2ZXJzZWQpIHBhdGNoUXVldWVcclxuICAgICAgICBmb3IgKGxldCBpID0gcGF0Y2hMZW4gLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICBjb25zdCBmaWJlciA9IHBhdGNoUXVldWVbaV07XHJcbiAgICAgICAgICAgIGNvbXBvbmVudCA9IGZpYmVyLmNvbXBvbmVudDtcclxuICAgICAgICAgICAgaWYgKGZpYmVyLnNob3VsZFBhdGNoICYmICF0aGlzLnRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50LnBhdGNoZWQoKTtcclxuICAgICAgICAgICAgICAgIGlmIChjb21wb25lbnQuX19vd2xfXy5wYXRjaGVkQ0IpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnQuX19vd2xfXy5wYXRjaGVkQ0IoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLnRhcmdldCA/IGluRE9NIDogdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50Ll9fY2FsbE1vdW50ZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQ2FuY2VsIGEgZmliZXIgYW5kIGFsbCBpdHMgY2hpbGRyZW4uXHJcbiAgICAgKi9cclxuICAgIGNhbmNlbCgpIHtcclxuICAgICAgICB0aGlzLl93YWxrKGYgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIWYuaXNSZW5kZXJlZCkge1xyXG4gICAgICAgICAgICAgICAgZi5yb290LmNvdW50ZXItLTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmLmlzQ29tcGxldGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIGYuY2hpbGQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgaXMgdGhlIGdsb2JhbCBlcnJvciBoYW5kbGVyIGZvciBlcnJvcnMgb2NjdXJyaW5nIGluIE93bCBtYWluIGxpZmVjeWNsZVxyXG4gICAgICogbWV0aG9kcy4gIENhdWdodCBlcnJvcnMgYXJlIHRyaWdnZXJlZCBvbiB0aGUgUVdlYiBpbnN0YW5jZSwgYW5kIGFyZVxyXG4gICAgICogcG90ZW50aWFsbHkgZ2l2ZW4gdG8gc29tZSBwYXJlbnQgY29tcG9uZW50IHdoaWNoIGltcGxlbWVudHMgYGNhdGNoRXJyb3JgLlxyXG4gICAgICpcclxuICAgICAqIElmIHRoZXJlIGFyZSBubyBzdWNoIGNvbXBvbmVudCwgd2UgZGVzdHJveSBldmVyeXRoaW5nLiBUaGlzIGlzIGJldHRlciB0aGFuXHJcbiAgICAgKiBiZWluZyBpbiBhIGNvcnJ1cHRlZCBzdGF0ZS5cclxuICAgICAqL1xyXG4gICAgaGFuZGxlRXJyb3IoZXJyb3IpIHtcclxuICAgICAgICBsZXQgY29tcG9uZW50ID0gdGhpcy5jb21wb25lbnQ7XHJcbiAgICAgICAgdGhpcy52bm9kZSA9IGNvbXBvbmVudC5fX293bF9fLnZub2RlIHx8IGgoXCJkaXZcIik7XHJcbiAgICAgICAgY29uc3QgcXdlYiA9IGNvbXBvbmVudC5lbnYucXdlYjtcclxuICAgICAgICBsZXQgcm9vdCA9IGNvbXBvbmVudDtcclxuICAgICAgICBsZXQgY2FuQ2F0Y2ggPSBmYWxzZTtcclxuICAgICAgICB3aGlsZSAoY29tcG9uZW50ICYmICEoY2FuQ2F0Y2ggPSAhIWNvbXBvbmVudC5jYXRjaEVycm9yKSkge1xyXG4gICAgICAgICAgICByb290ID0gY29tcG9uZW50O1xyXG4gICAgICAgICAgICBjb21wb25lbnQgPSBjb21wb25lbnQuX19vd2xfXy5wYXJlbnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHF3ZWIudHJpZ2dlcihcImVycm9yXCIsIGVycm9yKTtcclxuICAgICAgICBpZiAoY2FuQ2F0Y2gpIHtcclxuICAgICAgICAgICAgY29tcG9uZW50LmNhdGNoRXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gdGhlIDMgbmV4dCBsaW5lcyBhaW0gdG8gbWFyayB0aGUgcm9vdCBmaWJlciBhcyBiZWluZyBpbiBlcnJvciwgYW5kXHJcbiAgICAgICAgICAgIC8vIHRvIGZvcmNlIGl0IHRvIGVuZCwgd2l0aG91dCB3YWl0aW5nIGZvciBpdHMgY2hpbGRyZW5cclxuICAgICAgICAgICAgdGhpcy5yb290LmNvdW50ZXIgPSAwO1xyXG4gICAgICAgICAgICB0aGlzLnJvb3QuZXJyb3IgPSBlcnJvcjtcclxuICAgICAgICAgICAgc2NoZWR1bGVyLmZsdXNoKCk7XHJcbiAgICAgICAgICAgIHJvb3QuZGVzdHJveSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5GaWJlci5uZXh0SWQgPSAxO1xuXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBQcm9wIHZhbGlkYXRpb24gaGVscGVyXHJcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZSB0aGUgY29tcG9uZW50IHByb3BzIChvciBuZXh0IHByb3BzKSBhZ2FpbnN0IHRoZSAoc3RhdGljKSBwcm9wc1xyXG4gKiBkZXNjcmlwdGlvbi4gIFRoaXMgaXMgcG90ZW50aWFsbHkgYW4gZXhwZW5zaXZlIG9wZXJhdGlvbjogaXQgbWF5IG5lZWRzIHRvXHJcbiAqIHZpc2l0IHJlY3Vyc2l2ZWx5IHRoZSBwcm9wcyBhbmQgYWxsIHRoZSBjaGlsZHJlbiB0byBjaGVjayBpZiB0aGV5IGFyZSB2YWxpZC5cclxuICogVGhpcyBpcyB3aHkgaXQgaXMgb25seSBkb25lIGluICdkZXYnIG1vZGUuXHJcbiAqL1xyXG5RV2ViLnV0aWxzLnZhbGlkYXRlUHJvcHMgPSBmdW5jdGlvbiAoV2lkZ2V0LCBwcm9wcykge1xyXG4gICAgY29uc3QgcHJvcHNEZWYgPSBXaWRnZXQucHJvcHM7XHJcbiAgICBpZiAocHJvcHNEZWYgaW5zdGFuY2VvZiBBcnJheSkge1xyXG4gICAgICAgIC8vIGxpc3Qgb2Ygc3RyaW5ncyAocHJvcCBuYW1lcylcclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbCA9IHByb3BzRGVmLmxlbmd0aDsgaSA8IGw7IGkrKykge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9wTmFtZSA9IHByb3BzRGVmW2ldO1xyXG4gICAgICAgICAgICBpZiAocHJvcE5hbWVbcHJvcE5hbWUubGVuZ3RoIC0gMV0gPT09IFwiP1wiKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBvcHRpb25hbCBwcm9wXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIShwcm9wTmFtZSBpbiBwcm9wcykpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBwcm9wcyAnJHtwcm9wc0RlZltpXX0nIChjb21wb25lbnQgJyR7V2lkZ2V0Lm5hbWV9JylgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gcHJvcHMpIHtcclxuICAgICAgICAgICAgaWYgKCFwcm9wc0RlZi5pbmNsdWRlcyhrZXkpICYmICFwcm9wc0RlZi5pbmNsdWRlcyhrZXkgKyBcIj9cIikpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBwcm9wICcke2tleX0nIGdpdmVuIHRvIGNvbXBvbmVudCAnJHtXaWRnZXQubmFtZX0nYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChwcm9wc0RlZikge1xyXG4gICAgICAgIC8vIHByb3BzRGVmIGlzIGFuIG9iamVjdCBub3dcclxuICAgICAgICBmb3IgKGxldCBwcm9wTmFtZSBpbiBwcm9wc0RlZikge1xyXG4gICAgICAgICAgICBpZiAocHJvcHNbcHJvcE5hbWVdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwcm9wc0RlZltwcm9wTmFtZV0gJiYgIXByb3BzRGVmW3Byb3BOYW1lXS5vcHRpb25hbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTWlzc2luZyBwcm9wcyAnJHtwcm9wTmFtZX0nIChjb21wb25lbnQgJyR7V2lkZ2V0Lm5hbWV9JylgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBpc1ZhbGlkO1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWRQcm9wKHByb3BzW3Byb3BOYW1lXSwgcHJvcHNEZWZbcHJvcE5hbWVdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgZS5tZXNzYWdlID0gYEludmFsaWQgcHJvcCAnJHtwcm9wTmFtZX0nIGluIGNvbXBvbmVudCAke1dpZGdldC5uYW1lfSAoJHtlLm1lc3NhZ2V9KWA7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghaXNWYWxpZCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIFByb3AgJyR7cHJvcE5hbWV9JyBpbiBjb21wb25lbnQgJyR7V2lkZ2V0Lm5hbWV9J2ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZvciAobGV0IHByb3BOYW1lIGluIHByb3BzKSB7XHJcbiAgICAgICAgICAgIGlmICghKHByb3BOYW1lIGluIHByb3BzRGVmKSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHByb3AgJyR7cHJvcE5hbWV9JyBnaXZlbiB0byBjb21wb25lbnQgJyR7V2lkZ2V0Lm5hbWV9J2ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogQ2hlY2sgaWYgYW4gaW52aWR1YWwgcHJvcCB2YWx1ZSBtYXRjaGVzIGl0cyAoc3RhdGljKSBwcm9wIGRlZmluaXRpb25cclxuICovXHJcbmZ1bmN0aW9uIGlzVmFsaWRQcm9wKHByb3AsIHByb3BEZWYpIHtcclxuICAgIGlmIChwcm9wRGVmID09PSB0cnVlKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIHByb3BEZWYgPT09IFwiZnVuY3Rpb25cIikge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIGEgdmFsdWUgaXMgY29uc3RydWN0ZWQgYnkgc29tZSBDb25zdHJ1Y3Rvci4gIE5vdGUgdGhhdCB0aGVyZSBpcyBhXHJcbiAgICAgICAgLy8gc2xpZ2h0IGFidXNlIG9mIGxhbmd1YWdlOiB3ZSB3YW50IHRvIGNvbnNpZGVyIHByaW1pdGl2ZSB2YWx1ZXMgYXMgd2VsbC5cclxuICAgICAgICAvL1xyXG4gICAgICAgIC8vIFNvLCBldmVuIHRob3VnaCAxIGlzIG5vdCBhbiBpbnN0YW5jZSBvZiBOdW1iZXIsIHdlIHdhbnQgdG8gY29uc2lkZXIgdGhhdFxyXG4gICAgICAgIC8vIGl0IGlzIHZhbGlkLlxyXG4gICAgICAgIGlmICh0eXBlb2YgcHJvcCA9PT0gXCJvYmplY3RcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJvcCBpbnN0YW5jZW9mIHByb3BEZWY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0eXBlb2YgcHJvcCA9PT0gcHJvcERlZi5uYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChwcm9wRGVmIGluc3RhbmNlb2YgQXJyYXkpIHtcclxuICAgICAgICAvLyBJZiB0aGlzIGNvZGUgaXMgZXhlY3V0ZWQsIHRoaXMgbWVhbnMgdGhhdCB3ZSB3YW50IHRvIGNoZWNrIGlmIGEgcHJvcFxyXG4gICAgICAgIC8vIG1hdGNoZXMgYXQgbGVhc3Qgb25lIG9mIGl0cyBkZXNjcmlwdG9yLlxyXG4gICAgICAgIGxldCByZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgaUxlbiA9IHByb3BEZWYubGVuZ3RoOyBpIDwgaUxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCB8fCBpc1ZhbGlkUHJvcChwcm9wLCBwcm9wRGVmW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIC8vIHByb3BzRGVmIGlzIGFuIG9iamVjdFxyXG4gICAgaWYgKHByb3BEZWYub3B0aW9uYWwgJiYgcHJvcCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbiAgICBsZXQgcmVzdWx0ID0gcHJvcERlZi50eXBlID8gaXNWYWxpZFByb3AocHJvcCwgcHJvcERlZi50eXBlKSA6IHRydWU7XHJcbiAgICBpZiAocHJvcERlZi52YWxpZGF0ZSkge1xyXG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdCAmJiBwcm9wRGVmLnZhbGlkYXRlKHByb3ApO1xyXG4gICAgfVxyXG4gICAgaWYgKHByb3BEZWYudHlwZSA9PT0gQXJyYXkgJiYgcHJvcERlZi5lbGVtZW50KSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGlMZW4gPSBwcm9wLmxlbmd0aDsgaSA8IGlMZW47IGkrKykge1xyXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgJiYgaXNWYWxpZFByb3AocHJvcFtpXSwgcHJvcERlZi5lbGVtZW50KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBpZiAocHJvcERlZi50eXBlID09PSBPYmplY3QgJiYgcHJvcERlZi5zaGFwZSkge1xyXG4gICAgICAgIGNvbnN0IHNoYXBlID0gcHJvcERlZi5zaGFwZTtcclxuICAgICAgICBmb3IgKGxldCBrZXkgaW4gc2hhcGUpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ICYmIGlzVmFsaWRQcm9wKHByb3Bba2V5XSwgc2hhcGVba2V5XSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgcHJvcE5hbWUgaW4gcHJvcCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCEocHJvcE5hbWUgaW4gc2hhcGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGB1bmtub3duIHByb3AgJyR7cHJvcE5hbWV9J2ApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxuXG4vKipcclxuICogT3dsIFN0eWxlIFN5c3RlbVxyXG4gKlxyXG4gKiBUaGlzIGZpbGVzIGNvbnRhaW5zIHRoZSBPd2wgY29kZSByZWxhdGVkIHRvIHByb2Nlc3NpbmcgKGV4dGVuZGVkKSBjc3Mgc3RyaW5nc1xyXG4gKiBhbmQgY3JlYXRpbmcvYWRkaW5nIDxzdHlsZT4gdGFncyB0byB0aGUgZG9jdW1lbnQgaGVhZC5cclxuICovXHJcbmNvbnN0IFNUWUxFU0hFRVRTID0ge307XHJcbmZ1bmN0aW9uIHByb2Nlc3NTaGVldChzdHIpIHtcclxuICAgIGNvbnN0IHRva2VucyA9IHN0ci5zcGxpdCgvKFxce3xcXH18OykvKS5tYXAocyA9PiBzLnRyaW0oKSk7XHJcbiAgICBjb25zdCBzZWxlY3RvclN0YWNrID0gW107XHJcbiAgICBjb25zdCBwYXJ0cyA9IFtdO1xyXG4gICAgbGV0IHJ1bGVzID0gW107XHJcbiAgICBmdW5jdGlvbiBnZW5lcmF0ZVNlbGVjdG9yKHN0YWNrSW5kZXgsIHBhcmVudFNlbGVjdG9yKSB7XHJcbiAgICAgICAgY29uc3QgcGFydHMgPSBbXTtcclxuICAgICAgICBmb3IgKGNvbnN0IHNlbGVjdG9yIG9mIHNlbGVjdG9yU3RhY2tbc3RhY2tJbmRleF0pIHtcclxuICAgICAgICAgICAgbGV0IHBhcnQgPSAocGFyZW50U2VsZWN0b3IgJiYgcGFyZW50U2VsZWN0b3IgKyBcIiBcIiArIHNlbGVjdG9yKSB8fCBzZWxlY3RvcjtcclxuICAgICAgICAgICAgaWYgKHBhcnQuaW5jbHVkZXMoXCImXCIpKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJ0ID0gc2VsZWN0b3IucmVwbGFjZSgvJi9nLCBwYXJlbnRTZWxlY3RvciB8fCBcIlwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoc3RhY2tJbmRleCA8IHNlbGVjdG9yU3RhY2subGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgcGFydCA9IGdlbmVyYXRlU2VsZWN0b3Ioc3RhY2tJbmRleCArIDEsIHBhcnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcnRzLnB1c2gocGFydCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwYXJ0cy5qb2luKFwiLCBcIik7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBnZW5lcmF0ZVJ1bGVzKCkge1xyXG4gICAgICAgIGlmIChydWxlcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgcGFydHMucHVzaChnZW5lcmF0ZVNlbGVjdG9yKDApICsgXCIge1wiKTtcclxuICAgICAgICAgICAgcGFydHMucHVzaCguLi5ydWxlcyk7XHJcbiAgICAgICAgICAgIHBhcnRzLnB1c2goXCJ9XCIpO1xyXG4gICAgICAgICAgICBydWxlcyA9IFtdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHdoaWxlICh0b2tlbnMubGVuZ3RoKSB7XHJcbiAgICAgICAgbGV0IHRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XHJcbiAgICAgICAgaWYgKHRva2VuID09PSBcIn1cIikge1xyXG4gICAgICAgICAgICBnZW5lcmF0ZVJ1bGVzKCk7XHJcbiAgICAgICAgICAgIHNlbGVjdG9yU3RhY2sucG9wKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodG9rZW5zWzBdID09PSBcIntcIikge1xyXG4gICAgICAgICAgICAgICAgZ2VuZXJhdGVSdWxlcygpO1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0b3JTdGFjay5wdXNoKHRva2VuLnNwbGl0KC9cXHMqLFxccyovKSk7XHJcbiAgICAgICAgICAgICAgICB0b2tlbnMuc2hpZnQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodG9rZW5zWzBdID09PSBcIjtcIikge1xyXG4gICAgICAgICAgICAgICAgcnVsZXMucHVzaChcIiAgXCIgKyB0b2tlbiArIFwiO1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBwYXJ0cy5qb2luKFwiXFxuXCIpO1xyXG59XHJcbmZ1bmN0aW9uIHJlZ2lzdGVyU2hlZXQoaWQsIGNzcykge1xyXG4gICAgY29uc3Qgc2hlZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XHJcbiAgICBzaGVldC5pbm5lckhUTUwgPSBwcm9jZXNzU2hlZXQoY3NzKTtcclxuICAgIFNUWUxFU0hFRVRTW2lkXSA9IHNoZWV0O1xyXG59XHJcbmZ1bmN0aW9uIGFjdGl2YXRlU2hlZXQoaWQsIG5hbWUpIHtcclxuICAgIGNvbnN0IHNoZWV0ID0gU1RZTEVTSEVFVFNbaWRdO1xyXG4gICAgaWYgKCFzaGVldCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBjc3Mgc3R5bGVzaGVldCBmb3IgY29tcG9uZW50ICcke25hbWV9Jy4gRGlkIHlvdSBmb3JnZXQgdG8gdXNlIHRoZSAnY3NzJyB0YWcgaGVscGVyP2ApO1xyXG4gICAgfVxyXG4gICAgc2hlZXQuc2V0QXR0cmlidXRlKFwiY29tcG9uZW50XCIsIG5hbWUpO1xyXG4gICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzaGVldCk7XHJcbn1cblxuY29uc3QgcG9ydGFsU3ltYm9sID0gU3ltYm9sKFwicG9ydGFsXCIpOyAvLyBGSVhNRVxyXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyBDb21wb25lbnRcclxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxubGV0IG5leHRJZCA9IDE7XHJcbmNsYXNzIENvbXBvbmVudCB7XHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBMaWZlY3ljbGVcclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8qKlxyXG4gICAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBDb21wb25lbnQuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IG1vc3Qgb2YgdGhlIHRpbWUsIG9ubHkgdGhlIHJvb3QgY29tcG9uZW50IG5lZWRzIHRvIGJlIGNyZWF0ZWQgYnlcclxuICAgICAqIGhhbmQuICBPdGhlciBjb21wb25lbnRzIHNob3VsZCBiZSBjcmVhdGVkIGF1dG9tYXRpY2FsbHkgYnkgdGhlIGZyYW1ld29yayAod2l0aFxyXG4gICAgICogdGhlIHQtY29tcG9uZW50IGRpcmVjdGl2ZSBpbiBhIHRlbXBsYXRlKVxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihwYXJlbnQsIHByb3BzKSB7XHJcbiAgICAgICAgQ29tcG9uZW50LmN1cnJlbnQgPSB0aGlzO1xyXG4gICAgICAgIGxldCBjb25zdHIgPSB0aGlzLmNvbnN0cnVjdG9yO1xyXG4gICAgICAgIGNvbnN0IGRlZmF1bHRQcm9wcyA9IGNvbnN0ci5kZWZhdWx0UHJvcHM7XHJcbiAgICAgICAgaWYgKGRlZmF1bHRQcm9wcykge1xyXG4gICAgICAgICAgICBwcm9wcyA9IHByb3BzIHx8IHt9O1xyXG4gICAgICAgICAgICB0aGlzLl9fYXBwbHlEZWZhdWx0UHJvcHMocHJvcHMsIGRlZmF1bHRQcm9wcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucHJvcHMgPSBwcm9wcztcclxuICAgICAgICBpZiAoUVdlYi5kZXYpIHtcclxuICAgICAgICAgICAgUVdlYi51dGlscy52YWxpZGF0ZVByb3BzKGNvbnN0ciwgdGhpcy5wcm9wcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGlkID0gbmV4dElkKys7XHJcbiAgICAgICAgbGV0IGRlcHRoO1xyXG4gICAgICAgIGlmIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgdGhpcy5lbnYgPSBwYXJlbnQuZW52O1xyXG4gICAgICAgICAgICBjb25zdCBfX3Bvd2xfXyA9IHBhcmVudC5fX293bF9fO1xyXG4gICAgICAgICAgICBfX3Bvd2xfXy5jaGlsZHJlbltpZF0gPSB0aGlzO1xyXG4gICAgICAgICAgICBkZXB0aCA9IF9fcG93bF9fLmRlcHRoICsgMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIHdlIGFyZSB0aGUgcm9vdCBjb21wb25lbnRcclxuICAgICAgICAgICAgdGhpcy5lbnYgPSB0aGlzLmNvbnN0cnVjdG9yLmVudjtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLmVudi5xd2ViKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVudi5xd2ViID0gbmV3IFFXZWIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoIXRoaXMuZW52LmJyb3dzZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZW52LmJyb3dzZXIgPSBicm93c2VyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMuZW52LnF3ZWIub24oXCJ1cGRhdGVcIiwgdGhpcywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX19vd2xfXy5pc01vdW50ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcih0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9fb3dsX18uaXNEZXN0cm95ZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIHVubGlrZWx5IHRvIGhhcHBlbiwgYnV0IGlmIGEgcm9vdCB3aWRnZXQgaXMgZGVzdHJveWVkLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIHdhbnQgdG8gcmVtb3ZlIG91ciBzdWJzY3JpcHRpb24uICBUaGUgdXN1YWwgd2F5IHRvIGRvIHRoYXRcclxuICAgICAgICAgICAgICAgICAgICAvLyB3b3VsZCBiZSB0byBwZXJmb3JtIHNvbWUgY2hlY2sgaW4gdGhlIGRlc3Ryb3kgbWV0aG9kLCBidXQgc2luY2VcclxuICAgICAgICAgICAgICAgICAgICAvLyBpdCBpcyB2ZXJ5IHBlcmZvcm1hbmNlIHNlbnNpdGl2ZSwgYW5kIHNpbmNlIHRoaXMgaXMgYSByYXJlIGV2ZW50LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHdlIHNpbXBseSBkbyBpdCBsYXppbHlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmVudi5xd2ViLm9mZihcInVwZGF0ZVwiLCB0aGlzKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGRlcHRoID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcXdlYiA9IHRoaXMuZW52LnF3ZWI7XHJcbiAgICAgICAgY29uc3QgdGVtcGxhdGUgPSBjb25zdHIudGVtcGxhdGUgfHwgdGhpcy5fX2dldFRlbXBsYXRlKHF3ZWIpO1xyXG4gICAgICAgIHRoaXMuX19vd2xfXyA9IHtcclxuICAgICAgICAgICAgaWQ6IGlkLFxyXG4gICAgICAgICAgICBkZXB0aDogZGVwdGgsXHJcbiAgICAgICAgICAgIHZub2RlOiBudWxsLFxyXG4gICAgICAgICAgICBwdm5vZGU6IG51bGwsXHJcbiAgICAgICAgICAgIGlzTW91bnRlZDogZmFsc2UsXHJcbiAgICAgICAgICAgIGlzRGVzdHJveWVkOiBmYWxzZSxcclxuICAgICAgICAgICAgcGFyZW50OiBwYXJlbnQgfHwgbnVsbCxcclxuICAgICAgICAgICAgY2hpbGRyZW46IHt9LFxyXG4gICAgICAgICAgICBjbWFwOiB7fSxcclxuICAgICAgICAgICAgY3VycmVudEZpYmVyOiBudWxsLFxyXG4gICAgICAgICAgICBwYXJlbnRMYXN0RmliZXJJZDogMCxcclxuICAgICAgICAgICAgYm91bmRIYW5kbGVyczoge30sXHJcbiAgICAgICAgICAgIG1vdW50ZWRDQjogbnVsbCxcclxuICAgICAgICAgICAgd2lsbFVubW91bnRDQjogbnVsbCxcclxuICAgICAgICAgICAgd2lsbFBhdGNoQ0I6IG51bGwsXHJcbiAgICAgICAgICAgIHBhdGNoZWRDQjogbnVsbCxcclxuICAgICAgICAgICAgd2lsbFN0YXJ0Q0I6IG51bGwsXHJcbiAgICAgICAgICAgIHdpbGxVcGRhdGVQcm9wc0NCOiBudWxsLFxyXG4gICAgICAgICAgICBvYnNlcnZlcjogbnVsbCxcclxuICAgICAgICAgICAgcmVuZGVyRm46IHF3ZWIucmVuZGVyLmJpbmQocXdlYiwgdGVtcGxhdGUpLFxyXG4gICAgICAgICAgICBjbGFzc09iajogbnVsbCxcclxuICAgICAgICAgICAgcmVmczogbnVsbCxcclxuICAgICAgICAgICAgc2NvcGU6IG51bGxcclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChjb25zdHIuc3R5bGUpIHtcclxuICAgICAgICAgICAgdGhpcy5fX2FwcGx5U3R5bGVzKGNvbnN0cik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgYGVsYCBpcyB0aGUgcm9vdCBlbGVtZW50IG9mIHRoZSBjb21wb25lbnQuICBOb3RlIHRoYXQgaXQgY291bGQgYmUgbnVsbDpcclxuICAgICAqIHRoaXMgaXMgdGhlIGNhc2UgaWYgdGhlIGNvbXBvbmVudCBpcyBub3QgbW91bnRlZCB5ZXQsIG9yIGlzIGRlc3Ryb3llZC5cclxuICAgICAqL1xyXG4gICAgZ2V0IGVsKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9fb3dsX18udm5vZGUgPyB0aGlzLl9fb3dsX18udm5vZGUuZWxtIDogbnVsbDtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogd2lsbFN0YXJ0IGlzIGFuIGFzeW5jaHJvbm91cyBob29rIHRoYXQgY2FuIGJlIGltcGxlbWVudGVkIHRvIHBlcmZvcm0gc29tZVxyXG4gICAgICogYWN0aW9uIGJlZm9yZSB0aGUgaW5pdGlhbCByZW5kZXJpbmcgb2YgYSBjb21wb25lbnQuXHJcbiAgICAgKlxyXG4gICAgICogSXQgd2lsbCBiZSBjYWxsZWQgZXhhY3RseSBvbmNlIGJlZm9yZSB0aGUgaW5pdGlhbCByZW5kZXJpbmcuIEl0IGlzIHVzZWZ1bFxyXG4gICAgICogaW4gc29tZSBjYXNlcywgZm9yIGV4YW1wbGUsIHRvIGxvYWQgZXh0ZXJuYWwgYXNzZXRzIChzdWNoIGFzIGEgSlMgbGlicmFyeSlcclxuICAgICAqIGJlZm9yZSB0aGUgY29tcG9uZW50IGlzIHJlbmRlcmVkLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCBhIHNsb3cgd2lsbFN0YXJ0IG1ldGhvZCB3aWxsIHNsb3cgZG93biB0aGUgcmVuZGVyaW5nIG9mIHRoZSB1c2VyXHJcbiAgICAgKiBpbnRlcmZhY2UuICBUaGVyZWZvcmUsIHNvbWUgZWZmb3J0IHNob3VsZCBiZSBtYWRlIHRvIG1ha2UgdGhpcyBtZXRob2QgYXNcclxuICAgICAqIGZhc3QgYXMgcG9zc2libGUuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZTogdGhpcyBtZXRob2Qgc2hvdWxkIG5vdCBiZSBjYWxsZWQgbWFudWFsbHkuXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHdpbGxTdGFydCgpIHsgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBtb3VudGVkIGlzIGEgaG9vayB0aGF0IGlzIGNhbGxlZCBlYWNoIHRpbWUgYSBjb21wb25lbnQgaXMgYXR0YWNoZWQgdG8gdGhlXHJcbiAgICAgKiBET00uIFRoaXMgaXMgYSBnb29kIHBsYWNlIHRvIGFkZCBzb21lIGxpc3RlbmVycywgb3IgdG8gaW50ZXJhY3Qgd2l0aCB0aGVcclxuICAgICAqIERPTSwgaWYgdGhlIGNvbXBvbmVudCBuZWVkcyB0byBwZXJmb3JtIHNvbWUgbWVhc3VyZSBmb3IgZXhhbXBsZS5cclxuICAgICAqXHJcbiAgICAgKiBOb3RlOiB0aGlzIG1ldGhvZCBzaG91bGQgbm90IGJlIGNhbGxlZCBtYW51YWxseS5cclxuICAgICAqXHJcbiAgICAgKiBAc2VlIHdpbGxVbm1vdW50XHJcbiAgICAgKi9cclxuICAgIG1vdW50ZWQoKSB7IH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIHdpbGxVcGRhdGVQcm9wcyBpcyBhbiBhc3luY2hyb25vdXMgaG9vaywgY2FsbGVkIGp1c3QgYmVmb3JlIG5ldyBwcm9wc1xyXG4gICAgICogYXJlIHNldC4gVGhpcyBpcyB1c2VmdWwgaWYgdGhlIGNvbXBvbmVudCBuZWVkcyBzb21lIGFzeW5jaHJvbm91cyB0YXNrXHJcbiAgICAgKiBwZXJmb3JtZWQsIGRlcGVuZGluZyBvbiB0aGUgcHJvcHMgKGZvciBleGFtcGxlLCBhc3N1bWluZyB0aGF0IHRoZSBwcm9wcyBhcmVcclxuICAgICAqIHNvbWUgcmVjb3JkIElkLCBmZXRjaGluZyB0aGUgcmVjb3JkIGRhdGEpLlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgaG9vayBpcyBub3QgY2FsbGVkIGR1cmluZyB0aGUgZmlyc3QgcmVuZGVyIChidXQgd2lsbFN0YXJ0IGlzIGNhbGxlZFxyXG4gICAgICogYW5kIHBlcmZvcm1zIGEgc2ltaWxhciBqb2IpLlxyXG4gICAgICovXHJcbiAgICBhc3luYyB3aWxsVXBkYXRlUHJvcHMobmV4dFByb3BzKSB7IH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIHdpbGxQYXRjaCBob29rIGlzIGNhbGxlZCBqdXN0IGJlZm9yZSB0aGUgRE9NIHBhdGNoaW5nIHByb2Nlc3Mgc3RhcnRzLlxyXG4gICAgICogSXQgaXMgbm90IGNhbGxlZCBvbiB0aGUgaW5pdGlhbCByZW5kZXIuICBUaGlzIGlzIHVzZWZ1bCB0byBnZXQgc29tZVxyXG4gICAgICogaW5mb3JtYXRpb24gd2hpY2ggYXJlIGluIHRoZSBET00uICBGb3IgZXhhbXBsZSwgdGhlIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlXHJcbiAgICAgKiBzY3JvbGxiYXJcclxuICAgICAqL1xyXG4gICAgd2lsbFBhdGNoKCkgeyB9XHJcbiAgICAvKipcclxuICAgICAqIFRoaXMgaG9vayBpcyBjYWxsZWQgd2hlbmV2ZXIgYSBjb21wb25lbnQgZGlkIGFjdHVhbGx5IHVwZGF0ZSBpdHMgcHJvcHMsXHJcbiAgICAgKiBzdGF0ZSBvciBlbnYuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBtZXRob2QgaXMgbm90IGNhbGxlZCBvbiB0aGUgaW5pdGlhbCByZW5kZXIuIEl0IGlzIHVzZWZ1bCB0byBpbnRlcmFjdFxyXG4gICAgICogd2l0aCB0aGUgRE9NIChmb3IgZXhhbXBsZSwgdGhyb3VnaCBhbiBleHRlcm5hbCBsaWJyYXJ5KSB3aGVuZXZlciB0aGVcclxuICAgICAqIGNvbXBvbmVudCB3YXMgdXBkYXRlZC5cclxuICAgICAqXHJcbiAgICAgKiBVcGRhdGluZyB0aGUgY29tcG9uZW50IHN0YXRlIGluIHRoaXMgaG9vayBpcyBwb3NzaWJsZSwgYnV0IG5vdCBlbmNvdXJhZ2VkLlxyXG4gICAgICogT25lIG5lZWQgdG8gYmUgY2FyZWZ1bCwgYmVjYXVzZSB1cGRhdGVzIGhlcmUgd2lsbCBjYXVzZSByZXJlbmRlciwgd2hpY2ggaW5cclxuICAgICAqIHR1cm4gd2lsbCBjYXVzZSBvdGhlciBjYWxscyB0byB1cGRhdGVkLiBTbywgd2UgbmVlZCB0byBiZSBwYXJ0aWN1bGFybHlcclxuICAgICAqIGNhcmVmdWwgYXQgYXZvaWRpbmcgZW5kbGVzcyBjeWNsZXMuXHJcbiAgICAgKi9cclxuICAgIHBhdGNoZWQoKSB7IH1cclxuICAgIC8qKlxyXG4gICAgICogd2lsbFVubW91bnQgaXMgYSBob29rIHRoYXQgaXMgY2FsbGVkIGVhY2ggdGltZSBqdXN0IGJlZm9yZSBhIGNvbXBvbmVudCBpc1xyXG4gICAgICogdW5tb3VudGVkIGZyb20gdGhlIERPTS4gVGhpcyBpcyBhIGdvb2QgcGxhY2UgdG8gcmVtb3ZlIHNvbWUgbGlzdGVuZXJzLCBmb3JcclxuICAgICAqIGV4YW1wbGUuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZTogdGhpcyBtZXRob2Qgc2hvdWxkIG5vdCBiZSBjYWxsZWQgbWFudWFsbHkuXHJcbiAgICAgKlxyXG4gICAgICogQHNlZSBtb3VudGVkXHJcbiAgICAgKi9cclxuICAgIHdpbGxVbm1vdW50KCkgeyB9XHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBQdWJsaWNcclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8qKlxyXG4gICAgICogTW91bnQgdGhlIGNvbXBvbmVudCB0byBhIHRhcmdldCBlbGVtZW50LlxyXG4gICAgICpcclxuICAgICAqIFRoaXMgc2hvdWxkIG9ubHkgYmUgZG9uZSBpZiB0aGUgY29tcG9uZW50IHdhcyBjcmVhdGVkIG1hbnVhbGx5LiBDb21wb25lbnRzXHJcbiAgICAgKiBjcmVhdGVkIGRlY2xhcmF0aXZlbHkgaW4gdGVtcGxhdGVzIGFyZSBtYW5hZ2VkIGJ5IHRoZSBPd2wgc3lzdGVtLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCBhIGNvbXBvbmVudCBjYW4gYmUgbW91bnRlZCBhbiB1bm1vdW50ZWQgc2V2ZXJhbCB0aW1lc1xyXG4gICAgICovXHJcbiAgICBhc3luYyBtb3VudCh0YXJnZXQsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gb3B0aW9ucy5wb3NpdGlvbiB8fCBcImxhc3QtY2hpbGRcIjtcclxuICAgICAgICBjb25zdCBfX293bF9fID0gdGhpcy5fX293bF9fO1xyXG4gICAgICAgIGlmIChfX293bF9fLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICBpZiAocG9zaXRpb24gIT09IFwic2VsZlwiICYmIHRoaXMuZWwucGFyZW50Tm9kZSAhPT0gdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpbiB0aGlzIHNpdHVhdGlvbiwgd2UgYXJlIHRyeWluZyB0byBtb3VudCBhIGNvbXBvbmVudCBvbiBhIGRpZmZlcmVudFxyXG4gICAgICAgICAgICAgICAgLy8gdGFyZ2V0LiBJbiB0aGlzIGNhc2UsIHdlIG5lZWQgdG8gdW5tb3VudCBmaXJzdCwgb3RoZXJ3aXNlIGl0IHdpbGxcclxuICAgICAgICAgICAgICAgIC8vIG5vdCB3b3JrLlxyXG4gICAgICAgICAgICAgICAgdGhpcy51bm1vdW50KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKF9fb3dsX18uY3VycmVudEZpYmVyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRGaWJlciA9IF9fb3dsX18uY3VycmVudEZpYmVyO1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudEZpYmVyLnRhcmdldCA9PT0gdGFyZ2V0ICYmIGN1cnJlbnRGaWJlci5wb3NpdGlvbiA9PT0gcG9zaXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzY2hlZHVsZXIuYWRkRmliZXIoY3VycmVudEZpYmVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHNjaGVkdWxlci5yZWplY3RGaWJlcihjdXJyZW50RmliZXIsIFwiTW91bnRpbmcgb3BlcmF0aW9uIGNhbmNlbGxlZFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoISh0YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCB8fCB0YXJnZXQgaW5zdGFuY2VvZiBEb2N1bWVudEZyYWdtZW50KSkge1xyXG4gICAgICAgICAgICBsZXQgbWVzc2FnZSA9IGBDb21wb25lbnQgJyR7dGhpcy5jb25zdHJ1Y3Rvci5uYW1lfScgY2Fubm90IGJlIG1vdW50ZWQ6IHRoZSB0YXJnZXQgaXMgbm90IGEgdmFsaWQgRE9NIG5vZGUuYDtcclxuICAgICAgICAgICAgbWVzc2FnZSArPSBgXFxuTWF5YmUgdGhlIERPTSBpcyBub3QgcmVhZHkgeWV0PyAoaW4gdGhhdCBjYXNlLCB5b3UgY2FuIHVzZSBvd2wudXRpbHMud2hlblJlYWR5KWA7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihtZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZmliZXIgPSBuZXcgRmliZXIobnVsbCwgdGhpcywgZmFsc2UsIHRhcmdldCwgcG9zaXRpb24pO1xyXG4gICAgICAgIGZpYmVyLnNob3VsZFBhdGNoID0gZmFsc2U7XHJcbiAgICAgICAgaWYgKCFfX293bF9fLnZub2RlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX19wcmVwYXJlQW5kUmVuZGVyKGZpYmVyLCAoKSA9PiB7IH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fX3JlbmRlcihmaWJlcik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBzY2hlZHVsZXIuYWRkRmliZXIoZmliZXIpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgdW5tb3VudCBtZXRob2QgaXMgdGhlIG9wcG9zaXRlIG9mIHRoZSBtb3VudCBtZXRob2QuICBJdCBpcyB1c2VmdWxcclxuICAgICAqIHRvIGNhbGwgd2lsbFVubW91bnQgY2FsbHMgYW5kIHJlbW92ZSB0aGUgY29tcG9uZW50IGZyb20gdGhlIERPTS5cclxuICAgICAqL1xyXG4gICAgdW5tb3VudCgpIHtcclxuICAgICAgICBpZiAodGhpcy5fX293bF9fLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9fY2FsbFdpbGxVbm1vdW50KCk7XHJcbiAgICAgICAgICAgIHRoaXMuZWwucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgcmVuZGVyIG1ldGhvZCBpcyB0aGUgbWFpbiBlbnRyeSBwb2ludCB0byByZW5kZXIgYSBjb21wb25lbnQgKG9uY2UgaXRcclxuICAgICAqIGlzIHJlYWR5LiBUaGlzIG1ldGhvZCBpcyBub3QgaW5pdGlhbGx5IGNhbGxlZCB3aGVuIHRoZSBjb21wb25lbnQgaXNcclxuICAgICAqIHJlbmRlcmVkIHRoZSBmaXJzdCB0aW1lKS5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCB3aWxsIGNhdXNlIGFsbCBpdHMgc3ViIGNvbXBvbmVudHMgdG8gcG90ZW50aWFsbHkgcmVyZW5kZXJcclxuICAgICAqIHRoZW1zZWx2ZXMuICBOb3RlIHRoYXQgYHJlbmRlcmAgaXMgbm90IGNhbGxlZCBpZiBhIGNvbXBvbmVudCBpcyB1cGRhdGVkIHZpYVxyXG4gICAgICogaXRzIHByb3BzLlxyXG4gICAgICovXHJcbiAgICBhc3luYyByZW5kZXIoZm9yY2UgPSBmYWxzZSkge1xyXG4gICAgICAgIGNvbnN0IF9fb3dsX18gPSB0aGlzLl9fb3dsX187XHJcbiAgICAgICAgY29uc3QgY3VycmVudEZpYmVyID0gX19vd2xfXy5jdXJyZW50RmliZXI7XHJcbiAgICAgICAgaWYgKCFfX293bF9fLmlzTW91bnRlZCAmJiAhY3VycmVudEZpYmVyKSB7XHJcbiAgICAgICAgICAgIC8vIGlmIHdlIGdldCBoZXJlLCB0aGlzIG1lYW5zIHRoYXQgdGhlIGNvbXBvbmVudCB3YXMgZWl0aGVyIG5ldmVyIG1vdW50ZWQsXHJcbiAgICAgICAgICAgIC8vIG9yIHdhcyB1bm1vdW50ZWQgYW5kIHNvbWUgc3RhdGUgY2hhbmdlICB0cmlnZ2VyZWQgYSByZW5kZXIuIEVpdGhlciB3YXksXHJcbiAgICAgICAgICAgIC8vIHdlIGRvIG5vdCB3YW50IHRvIGFjdHVhbGx5IHJlbmRlciBhbnl0aGluZyBpbiB0aGlzIGNhc2UuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGN1cnJlbnRGaWJlciAmJiAhY3VycmVudEZpYmVyLmlzUmVuZGVyZWQgJiYgIWN1cnJlbnRGaWJlci5pc0NvbXBsZXRlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc2NoZWR1bGVyLmFkZEZpYmVyKGN1cnJlbnRGaWJlci5yb290KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gaWYgd2UgYXJlbid0IG1vdW50ZWQgYXQgdGhpcyBwb2ludCwgaXQgaW1wbGllcyB0aGF0IHRoZXJlIGlzIGFcclxuICAgICAgICAvLyBjdXJyZW50RmliZXIgdGhhdCBpcyBhbHJlYWR5IHJlbmRlcmVkIChpc1JlbmRlcmVkIGlzIHRydWUpLCBzbyB3ZSBhcmVcclxuICAgICAgICAvLyBhYm91dCB0byBiZSBtb3VudGVkXHJcbiAgICAgICAgY29uc3QgaXNNb3VudGVkID0gX19vd2xfXy5pc01vdW50ZWQ7XHJcbiAgICAgICAgY29uc3QgZmliZXIgPSBuZXcgRmliZXIobnVsbCwgdGhpcywgZm9yY2UsIG51bGwsIG51bGwpO1xyXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoX19vd2xfXy5pc01vdW50ZWQgfHwgIWlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpYmVyLmlzQ29tcGxldGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgLy8gd2UgYXJlIG1vdW50ZWQgKF9fb3dsX18uaXNNb3VudGVkKSwgb3IgaWYgd2UgYXJlIGN1cnJlbnRseSBiZWluZ1xyXG4gICAgICAgICAgICAgICAgLy8gbW91bnRlZCAoIWlzTW91bnRlZCksIHNvIHdlIGNhbGwgX19yZW5kZXJcclxuICAgICAgICAgICAgICAgIHRoaXMuX19yZW5kZXIoZmliZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gd2Ugd2VyZSBtb3VudGVkIHdoZW4gcmVuZGVyIHdhcyBjYWxsZWQsIGJ1dCB3ZSBhcmVuJ3QgYW55bW9yZSwgc28gd2VcclxuICAgICAgICAgICAgICAgIC8vIHdlcmUgYWN0dWFsbHkgYWJvdXQgdG8gYmUgdW5tb3VudGVkIDsgd2UgY2FuIHRodXMgZm9yZ2V0IGFib3V0IHRoaXNcclxuICAgICAgICAgICAgICAgIC8vIGZpYmVyXHJcbiAgICAgICAgICAgICAgICBmaWJlci5pc0NvbXBsZXRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBfX293bF9fLmN1cnJlbnRGaWJlciA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gc2NoZWR1bGVyLmFkZEZpYmVyKGZpYmVyKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRGVzdHJveSB0aGUgY29tcG9uZW50LiAgVGhpcyBvcGVyYXRpb24gaXMgcXVpdGUgY29tcGxleDpcclxuICAgICAqICAtIGl0IHJlY3Vyc2l2ZWx5IGRlc3Ryb3kgYWxsIGNoaWxkcmVuXHJcbiAgICAgKiAgLSBjYWxsIHRoZSB3aWxsVW5tb3VudCBob29rcyBpZiBuZWNlc3NhcnlcclxuICAgICAqICAtIHJlbW92ZSB0aGUgZG9tIG5vZGUgZnJvbSB0aGUgZG9tXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBzaG91bGQgb25seSBiZSBjYWxsZWQgbWFudWFsbHkgaWYgeW91IGNyZWF0ZWQgdGhlIGNvbXBvbmVudC4gIE1vc3RcclxuICAgICAqIGNvbXBvbmVudHMgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGRlc3Ryb3llZC5cclxuICAgICAqL1xyXG4gICAgZGVzdHJveSgpIHtcclxuICAgICAgICBjb25zdCBfX293bF9fID0gdGhpcy5fX293bF9fO1xyXG4gICAgICAgIGlmICghX19vd2xfXy5pc0Rlc3Ryb3llZCkge1xyXG4gICAgICAgICAgICBjb25zdCBlbCA9IHRoaXMuZWw7XHJcbiAgICAgICAgICAgIHRoaXMuX19kZXN0cm95KF9fb3dsX18ucGFyZW50KTtcclxuICAgICAgICAgICAgaWYgKGVsKSB7XHJcbiAgICAgICAgICAgICAgICBlbC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhpcyBtZXRob2QgaXMgY2FsbGVkIGJ5IHRoZSBjb21wb25lbnQgc3lzdGVtIHdoZW5ldmVyIGl0cyBwcm9wcyBhcmVcclxuICAgICAqIHVwZGF0ZWQuIElmIGl0IHJldHVybnMgdHJ1ZSwgdGhlbiB0aGUgY29tcG9uZW50IHdpbGwgYmUgcmVuZGVyZWQuXHJcbiAgICAgKiBPdGhlcndpc2UsIGl0IHdpbGwgc2tpcCB0aGUgcmVuZGVyaW5nIChhbHNvLCBpdHMgcHJvcHMgd2lsbCBub3QgYmUgdXBkYXRlZClcclxuICAgICAqL1xyXG4gICAgc2hvdWxkVXBkYXRlKG5leHRQcm9wcykge1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBFbWl0IGEgY3VzdG9tIGV2ZW50IG9mIHR5cGUgJ2V2ZW50VHlwZScgd2l0aCB0aGUgZ2l2ZW4gJ3BheWxvYWQnIG9uIHRoZVxyXG4gICAgICogY29tcG9uZW50J3MgZWwsIGlmIGl0IGV4aXN0cy4gSG93ZXZlciwgbm90ZSB0aGF0IHRoZSBldmVudCB3aWxsIG9ubHkgYnViYmxlXHJcbiAgICAgKiB1cCB0byB0aGUgcGFyZW50IERPTSBub2Rlcy4gVGh1cywgaXQgbXVzdCBiZSBjYWxsZWQgYmV0d2VlbiBtb3VudGVkKCkgYW5kXHJcbiAgICAgKiB3aWxsVW5tb3VudCgpLlxyXG4gICAgICovXHJcbiAgICB0cmlnZ2VyKGV2ZW50VHlwZSwgcGF5bG9hZCkge1xyXG4gICAgICAgIHRoaXMuX190cmlnZ2VyKHRoaXMsIGV2ZW50VHlwZSwgcGF5bG9hZCk7XHJcbiAgICB9XHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvLyBQcml2YXRlXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAvKipcclxuICAgICAqIFByaXZhdGUgaGVscGVyIHRvIHBlcmZvcm0gYSBmdWxsIGRlc3Ryb3ksIGZyb20gdGhlIHBvaW50IG9mIHZpZXcgb2YgYW4gT3dsXHJcbiAgICAgKiBjb21wb25lbnQuIEl0IGRvZXMgbm90IHJlbW92ZSB0aGUgZWwgKHRoaXMgaXMgZG9uZSBvbmx5IG9uY2Ugb24gdGhlIHRvcFxyXG4gICAgICogbGV2ZWwgZGVzdHJveWVkIGNvbXBvbmVudCwgZm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMpLlxyXG4gICAgICpcclxuICAgICAqIFRoZSBqb2Igb2YgdGhpcyBtZXRob2QgaXMgbW9zdGx5IHRvIGNhbGwgd2lsbFVubW91bnQgaG9va3MsIGFuZCB0byBwZXJmb3JtXHJcbiAgICAgKiBhbGwgbmVjZXNzYXJ5IGludGVybmFsIGNsZWFudXAuXHJcbiAgICAgKlxyXG4gICAgICogTm90ZSB0aGF0IGl0IGRvZXMgbm90IGNhbGwgdGhlIF9fY2FsbFdpbGxVbm1vdW50IG1ldGhvZCB0byBhdm9pZCB2aXNpdGluZ1xyXG4gICAgICogYWxsIGNoaWxkcmVuIG1hbnkgdGltZXMuXHJcbiAgICAgKi9cclxuICAgIF9fZGVzdHJveShwYXJlbnQpIHtcclxuICAgICAgICBjb25zdCBfX293bF9fID0gdGhpcy5fX293bF9fO1xyXG4gICAgICAgIGNvbnN0IGlzTW91bnRlZCA9IF9fb3dsX18uaXNNb3VudGVkO1xyXG4gICAgICAgIGlmIChpc01vdW50ZWQpIHtcclxuICAgICAgICAgICAgaWYgKF9fb3dsX18ud2lsbFVubW91bnRDQikge1xyXG4gICAgICAgICAgICAgICAgX19vd2xfXy53aWxsVW5tb3VudENCKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy53aWxsVW5tb3VudCgpO1xyXG4gICAgICAgICAgICBfX293bF9fLmlzTW91bnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IF9fb3dsX18uY2hpbGRyZW47XHJcbiAgICAgICAgZm9yIChsZXQga2V5IGluIGNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIGNoaWxkcmVuW2tleV0uX19kZXN0cm95KHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAocGFyZW50KSB7XHJcbiAgICAgICAgICAgIGxldCBpZCA9IF9fb3dsX18uaWQ7XHJcbiAgICAgICAgICAgIGRlbGV0ZSBwYXJlbnQuX19vd2xfXy5jaGlsZHJlbltpZF07XHJcbiAgICAgICAgICAgIF9fb3dsX18ucGFyZW50ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgX19vd2xfXy5pc0Rlc3Ryb3llZCA9IHRydWU7XHJcbiAgICAgICAgZGVsZXRlIF9fb3dsX18udm5vZGU7XHJcbiAgICAgICAgaWYgKF9fb3dsX18uY3VycmVudEZpYmVyKSB7XHJcbiAgICAgICAgICAgIF9fb3dsX18uY3VycmVudEZpYmVyLmlzQ29tcGxldGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfX2NhbGxNb3VudGVkKCkge1xyXG4gICAgICAgIGNvbnN0IF9fb3dsX18gPSB0aGlzLl9fb3dsX187XHJcbiAgICAgICAgX19vd2xfXy5pc01vdW50ZWQgPSB0cnVlO1xyXG4gICAgICAgIF9fb3dsX18uY3VycmVudEZpYmVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLm1vdW50ZWQoKTtcclxuICAgICAgICBpZiAoX19vd2xfXy5tb3VudGVkQ0IpIHtcclxuICAgICAgICAgICAgX19vd2xfXy5tb3VudGVkQ0IoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBfX2NhbGxXaWxsVW5tb3VudCgpIHtcclxuICAgICAgICBjb25zdCBfX293bF9fID0gdGhpcy5fX293bF9fO1xyXG4gICAgICAgIGlmIChfX293bF9fLndpbGxVbm1vdW50Q0IpIHtcclxuICAgICAgICAgICAgX19vd2xfXy53aWxsVW5tb3VudENCKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMud2lsbFVubW91bnQoKTtcclxuICAgICAgICBfX293bF9fLmlzTW91bnRlZCA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLl9fb3dsX18uY3VycmVudEZpYmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX19vd2xfXy5jdXJyZW50RmliZXIuaXNDb21wbGV0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLl9fb3dsX18uY3VycmVudEZpYmVyLnJvb3QuY291bnRlciA9IDA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gX19vd2xfXy5jaGlsZHJlbjtcclxuICAgICAgICBmb3IgKGxldCBpZCBpbiBjaGlsZHJlbikge1xyXG4gICAgICAgICAgICBjb25zdCBjb21wID0gY2hpbGRyZW5baWRdO1xyXG4gICAgICAgICAgICBpZiAoY29tcC5fX293bF9fLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICAgICAgY29tcC5fX2NhbGxXaWxsVW5tb3VudCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBQcml2YXRlIHRyaWdnZXIgbWV0aG9kLCBhbGxvd3MgdG8gY2hvb3NlIHRoZSBjb21wb25lbnQgd2hpY2ggdHJpZ2dlcmVkXHJcbiAgICAgKiB0aGUgZXZlbnQgaW4gdGhlIGZpcnN0IHBsYWNlXHJcbiAgICAgKi9cclxuICAgIF9fdHJpZ2dlcihjb21wb25lbnQsIGV2ZW50VHlwZSwgcGF5bG9hZCkge1xyXG4gICAgICAgIGlmICh0aGlzLmVsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV2ID0gbmV3IE93bEV2ZW50KGNvbXBvbmVudCwgZXZlbnRUeXBlLCB7XHJcbiAgICAgICAgICAgICAgICBidWJibGVzOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGRldGFpbDogcGF5bG9hZFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgY29uc3QgdHJpZ2dlckhvb2sgPSB0aGlzLmVudltwb3J0YWxTeW1ib2xdO1xyXG4gICAgICAgICAgICBpZiAodHJpZ2dlckhvb2spIHtcclxuICAgICAgICAgICAgICAgIHRyaWdnZXJIb29rKGV2KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmVsLmRpc3BhdGNoRXZlbnQoZXYpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogVGhlIF9fdXBkYXRlUHJvcHMgbWV0aG9kIGlzIGNhbGxlZCBieSB0aGUgdC1jb21wb25lbnQgZGlyZWN0aXZlIHdoZW5ldmVyXHJcbiAgICAgKiBpdCB1cGRhdGVzIGEgY29tcG9uZW50IChzbywgd2hlbiB0aGUgcGFyZW50IHRlbXBsYXRlIGlzIHJlcmVuZGVyZWQpLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBfX3VwZGF0ZVByb3BzKG5leHRQcm9wcywgcGFyZW50RmliZXIsIHNjb3BlKSB7XHJcbiAgICAgICAgdGhpcy5fX293bF9fLnNjb3BlID0gc2NvcGU7XHJcbiAgICAgICAgY29uc3Qgc2hvdWxkVXBkYXRlID0gcGFyZW50RmliZXIuZm9yY2UgfHwgdGhpcy5zaG91bGRVcGRhdGUobmV4dFByb3BzKTtcclxuICAgICAgICBpZiAoc2hvdWxkVXBkYXRlKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IF9fb3dsX18gPSB0aGlzLl9fb3dsX187XHJcbiAgICAgICAgICAgIGNvbnN0IGZpYmVyID0gbmV3IEZpYmVyKHBhcmVudEZpYmVyLCB0aGlzLCBwYXJlbnRGaWJlci5mb3JjZSwgbnVsbCwgbnVsbCk7XHJcbiAgICAgICAgICAgIGlmICghcGFyZW50RmliZXIuY2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIHBhcmVudEZpYmVyLmNoaWxkID0gZmliZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnRGaWJlci5sYXN0Q2hpbGQuc2libGluZyA9IGZpYmVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhcmVudEZpYmVyLmxhc3RDaGlsZCA9IGZpYmVyO1xyXG4gICAgICAgICAgICBjb25zdCBkZWZhdWx0UHJvcHMgPSB0aGlzLmNvbnN0cnVjdG9yLmRlZmF1bHRQcm9wcztcclxuICAgICAgICAgICAgaWYgKGRlZmF1bHRQcm9wcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fX2FwcGx5RGVmYXVsdFByb3BzKG5leHRQcm9wcywgZGVmYXVsdFByb3BzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoUVdlYi5kZXYpIHtcclxuICAgICAgICAgICAgICAgIFFXZWIudXRpbHMudmFsaWRhdGVQcm9wcyh0aGlzLmNvbnN0cnVjdG9yLCBuZXh0UHJvcHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgICAgICAgICAgIHRoaXMud2lsbFVwZGF0ZVByb3BzKG5leHRQcm9wcyksXHJcbiAgICAgICAgICAgICAgICBfX293bF9fLndpbGxVcGRhdGVQcm9wc0NCICYmIF9fb3dsX18ud2lsbFVwZGF0ZVByb3BzQ0IobmV4dFByb3BzKVxyXG4gICAgICAgICAgICBdKTtcclxuICAgICAgICAgICAgaWYgKGZpYmVyLmlzQ29tcGxldGVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5wcm9wcyA9IG5leHRQcm9wcztcclxuICAgICAgICAgICAgdGhpcy5fX3JlbmRlcihmaWJlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBNYWluIHBhdGNoaW5nIG1ldGhvZC4gV2UgY2FsbCB0aGUgdmlydHVhbCBkb20gcGF0Y2ggbWV0aG9kIGhlcmUgdG8gY29udmVydFxyXG4gICAgICogYSB2aXJ0dWFsIGRvbSB2bm9kZSBpbnRvIHNvbWUgYWN0dWFsIGRvbS5cclxuICAgICAqL1xyXG4gICAgX19wYXRjaCh0YXJnZXQsIHZub2RlKSB7XHJcbiAgICAgICAgdGhpcy5fX293bF9fLnZub2RlID0gcGF0Y2godGFyZ2V0LCB2bm9kZSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBfX3ByZXBhcmUgbWV0aG9kIGlzIG9ubHkgY2FsbGVkIGJ5IHRoZSB0LWNvbXBvbmVudCBkaXJlY3RpdmUsIHdoZW4gYVxyXG4gICAgICogc3ViY29tcG9uZW50IGlzIGNyZWF0ZWQuIEl0IGdldHMgaXRzIHNjb3BlLCBpZiBhbnksIGZyb20gdGhlXHJcbiAgICAgKiBwYXJlbnQgdGVtcGxhdGUuXHJcbiAgICAgKi9cclxuICAgIF9fcHJlcGFyZShwYXJlbnRGaWJlciwgc2NvcGUsIGNiKSB7XHJcbiAgICAgICAgdGhpcy5fX293bF9fLnNjb3BlID0gc2NvcGU7XHJcbiAgICAgICAgY29uc3QgZmliZXIgPSBuZXcgRmliZXIocGFyZW50RmliZXIsIHRoaXMsIHBhcmVudEZpYmVyLmZvcmNlLCBudWxsLCBudWxsKTtcclxuICAgICAgICBmaWJlci5zaG91bGRQYXRjaCA9IGZhbHNlO1xyXG4gICAgICAgIGlmICghcGFyZW50RmliZXIuY2hpbGQpIHtcclxuICAgICAgICAgICAgcGFyZW50RmliZXIuY2hpbGQgPSBmaWJlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHBhcmVudEZpYmVyLmxhc3RDaGlsZC5zaWJsaW5nID0gZmliZXI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhcmVudEZpYmVyLmxhc3RDaGlsZCA9IGZpYmVyO1xyXG4gICAgICAgIHRoaXMuX19wcmVwYXJlQW5kUmVuZGVyKGZpYmVyLCBjYik7XHJcbiAgICAgICAgcmV0dXJuIGZpYmVyO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBBcHBseSB0aGUgc3R5bGVzaGVldHMgZGVmaW5lZCBieSB0aGUgY29tcG9uZW50LiBOb3RlIHRoYXQgd2UgbmVlZCB0byBtYWtlXHJcbiAgICAgKiBzdXJlIGFsbCBpbmhlcml0ZWQgc3R5bGVzaGVldHMgYXJlIGFwcGxpZWQgYXMgd2VsbC4gIFdlIHRoZW4gZGVsZXRlIHRoZVxyXG4gICAgICogYHN0eWxlYCBrZXkgZnJvbSB0aGUgY29uc3RydWN0b3IgdG8gbWFrZSBzdXJlIHdlIGRvIG5vdCBhcHBseSBpdCBhZ2Fpbi5cclxuICAgICAqL1xyXG4gICAgX19hcHBseVN0eWxlcyhjb25zdHIpIHtcclxuICAgICAgICB3aGlsZSAoY29uc3RyICYmIGNvbnN0ci5zdHlsZSkge1xyXG4gICAgICAgICAgICBpZiAoY29uc3RyLmhhc093blByb3BlcnR5KFwic3R5bGVcIikpIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2YXRlU2hlZXQoY29uc3RyLnN0eWxlLCBjb25zdHIubmFtZSk7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgY29uc3RyLnN0eWxlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0ciA9IGNvbnN0ci5fX3Byb3RvX187XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgX19nZXRUZW1wbGF0ZShxd2ViKSB7XHJcbiAgICAgICAgbGV0IHAgPSB0aGlzLmNvbnN0cnVjdG9yO1xyXG4gICAgICAgIGlmICghcC5oYXNPd25Qcm9wZXJ0eShcIl90ZW1wbGF0ZVwiKSkge1xyXG4gICAgICAgICAgICAvLyBoZXJlLCB0aGUgY29tcG9uZW50IGFuZCBub25lIG9mIGl0cyBzdXBlcmNsYXNzZXMgZGVmaW5lcyBhIHN0YXRpYyBgdGVtcGxhdGVgXHJcbiAgICAgICAgICAgIC8vIGtleS4gU28gd2UgZmFsbCBiYWNrIG9uIGxvb2tpbmcgZm9yIGEgdGVtcGxhdGUgbWF0Y2hpbmcgaXRzIG5hbWUgKG9yXHJcbiAgICAgICAgICAgIC8vIG9uZSBvZiBpdHMgc3ViY2xhc3MpLlxyXG4gICAgICAgICAgICBsZXQgdGVtcGxhdGUgPSBwLm5hbWU7XHJcbiAgICAgICAgICAgIHdoaWxlICghKHRlbXBsYXRlIGluIHF3ZWIudGVtcGxhdGVzKSAmJiBwICE9PSBDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIHAgPSBwLl9fcHJvdG9fXztcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlID0gcC5uYW1lO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwID09PSBDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgdGVtcGxhdGUgZm9yIGNvbXBvbmVudCBcIiR7dGhpcy5jb25zdHJ1Y3Rvci5uYW1lfVwiYCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBwLl90ZW1wbGF0ZSA9IHRlbXBsYXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBwLl90ZW1wbGF0ZTtcclxuICAgIH1cclxuICAgIGFzeW5jIF9fcHJlcGFyZUFuZFJlbmRlcihmaWJlciwgY2IpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChbdGhpcy53aWxsU3RhcnQoKSwgdGhpcy5fX293bF9fLndpbGxTdGFydENCICYmIHRoaXMuX19vd2xfXy53aWxsU3RhcnRDQigpXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGZpYmVyLmhhbmRsZUVycm9yKGUpO1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLl9fb3dsX18uaXNEZXN0cm95ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWZpYmVyLmlzQ29tcGxldGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX19yZW5kZXIoZmliZXIpO1xyXG4gICAgICAgICAgICBjYigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIF9fcmVuZGVyKGZpYmVyKSB7XHJcbiAgICAgICAgY29uc3QgX19vd2xfXyA9IHRoaXMuX19vd2xfXztcclxuICAgICAgICBpZiAoX19vd2xfXy5vYnNlcnZlcikge1xyXG4gICAgICAgICAgICBfX293bF9fLm9ic2VydmVyLmFsbG93TXV0YXRpb25zID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBlcnJvcjtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBsZXQgdm5vZGUgPSBfX293bF9fLnJlbmRlckZuKHRoaXMsIHtcclxuICAgICAgICAgICAgICAgIGhhbmRsZXJzOiBfX293bF9fLmJvdW5kSGFuZGxlcnMsXHJcbiAgICAgICAgICAgICAgICBmaWJlcjogZmliZXJcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vIHdlIGl0ZXJhdGUgb3ZlciB0aGUgY2hpbGRyZW4gdG8gZGV0ZWN0IHRob3NlIHRoYXQgbm8gbG9uZ2VyIGJlbG9uZyB0byB0aGVcclxuICAgICAgICAgICAgLy8gY3VycmVudCByZW5kZXJpbmc6IHRob3NlIG9uZXMsIGlmIG5vdCBtb3VudGVkIHlldCwgY2FuIChhbmQgaGF2ZSB0bykgYmVcclxuICAgICAgICAgICAgLy8gZGVzdHJveWVkIHJpZ2h0IG5vdywgYmVjYXVzZSB0aGV5IGFyZSBub3QgaW4gdGhlIERPTSwgYW5kIHRodXMgd2Ugd29uJ3RcclxuICAgICAgICAgICAgLy8gYmUgbm90aWZpZWQgbGF0ZXIgb24gKHdoZW4gcGF0Y2hpbmcpLCB0aGF0IHRoZXkgYXJlIHJlbW92ZWQgZnJvbSB0aGUgRE9NXHJcbiAgICAgICAgICAgIGZvciAobGV0IGNoaWxkS2V5IGluIF9fb3dsX18uY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgICAgIGxldCBjaGlsZCA9IF9fb3dsX18uY2hpbGRyZW5bY2hpbGRLZXldO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjaGlsZC5fX293bF9fLmlzTW91bnRlZCAmJiBjaGlsZC5fX293bF9fLnBhcmVudExhc3RGaWJlcklkIDwgZmliZXIuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjaGlsZC5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCF2bm9kZSkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSZW5kZXJpbmcgJyR7dGhpcy5jb25zdHJ1Y3Rvci5uYW1lfScgZGlkIG5vdCByZXR1cm4gYW55dGhpbmdgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmaWJlci52bm9kZSA9IHZub2RlO1xyXG4gICAgICAgICAgICAvLyB3ZSBhcHBseSBoZXJlIHRoZSBjbGFzcyBpbmZvcm1hdGlvbiBkZXNjcmliZWQgb24gdGhlIGNvbXBvbmVudCBieSB0aGVcclxuICAgICAgICAgICAgLy8gdGVtcGxhdGUgKHNvLCBzb21ldGhpbmcgbGlrZSA8TXlDb21wb25lbnQgY2xhc3M9XCIuLi5cIi8+KSB0byB0aGUgYWN0dWFsXHJcbiAgICAgICAgICAgIC8vIHJvb3Qgdm5vZGVcclxuICAgICAgICAgICAgaWYgKF9fb3dsX18uY2xhc3NPYmopIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB2bm9kZS5kYXRhO1xyXG4gICAgICAgICAgICAgICAgZGF0YS5jbGFzcyA9IE9iamVjdC5hc3NpZ24oZGF0YS5jbGFzcyB8fCB7fSwgX19vd2xfXy5jbGFzc09iaik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgZXJyb3IgPSBlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoX19vd2xfXy5vYnNlcnZlcikge1xyXG4gICAgICAgICAgICBfX293bF9fLm9ic2VydmVyLmFsbG93TXV0YXRpb25zID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmliZXIucm9vdC5jb3VudGVyLS07XHJcbiAgICAgICAgZmliZXIuaXNSZW5kZXJlZCA9IHRydWU7XHJcbiAgICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGZpYmVyLmhhbmRsZUVycm9yKGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE9ubHkgY2FsbGVkIGJ5IHF3ZWIgdC1jb21wb25lbnQgZGlyZWN0aXZlICh3aGVuIHQta2VlcGFsaXZlIGlzIHNldClcclxuICAgICAqL1xyXG4gICAgX19yZW1vdW50KCkge1xyXG4gICAgICAgIGNvbnN0IF9fb3dsX18gPSB0aGlzLl9fb3dsX187XHJcbiAgICAgICAgaWYgKCFfX293bF9fLmlzTW91bnRlZCkge1xyXG4gICAgICAgICAgICBfX293bF9fLmlzTW91bnRlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMubW91bnRlZCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQXBwbHkgZGVmYXVsdCBwcm9wcyAob25seSB0b3AgbGV2ZWwpLlxyXG4gICAgICpcclxuICAgICAqIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBkb2VzIG1vZGlmeSBpbiBwbGFjZSB0aGUgcHJvcHNcclxuICAgICAqL1xyXG4gICAgX19hcHBseURlZmF1bHRQcm9wcyhwcm9wcywgZGVmYXVsdFByb3BzKSB7XHJcbiAgICAgICAgZm9yIChsZXQgcHJvcE5hbWUgaW4gZGVmYXVsdFByb3BzKSB7XHJcbiAgICAgICAgICAgIGlmIChwcm9wc1twcm9wTmFtZV0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgcHJvcHNbcHJvcE5hbWVdID0gZGVmYXVsdFByb3BzW3Byb3BOYW1lXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5Db21wb25lbnQudGVtcGxhdGUgPSBudWxsO1xyXG5Db21wb25lbnQuX3RlbXBsYXRlID0gbnVsbDtcclxuQ29tcG9uZW50LmN1cnJlbnQgPSBudWxsO1xyXG5Db21wb25lbnQuY29tcG9uZW50cyA9IHt9O1xyXG5Db21wb25lbnQuZW52ID0ge307XHJcbi8vIGV4cG9zZSBzY2hlZHVsZXIgcy50LiBpdCBjYW4gYmUgbW9ja2VkIGZvciB0ZXN0aW5nIHB1cnBvc2VzXHJcbkNvbXBvbmVudC5zY2hlZHVsZXIgPSBzY2hlZHVsZXI7XG5cbi8qKlxyXG4gKiBUaGUgYENvbnRleHRgIG9iamVjdCBwcm92aWRlcyBhIHdheSB0byBzaGFyZSBkYXRhIGJldHdlZW4gYW4gYXJiaXRyYXJ5IG51bWJlclxyXG4gKiBvZiBjb21wb25lbnQuIFVzdWFsbHksIGRhdGEgaXMgcGFzc2VkIGZyb20gYSBwYXJlbnQgdG8gaXRzIGNoaWxkcmVuIGNvbXBvbmVudCxcclxuICogYnV0IHdoZW4gd2UgaGF2ZSB0byBkZWFsIHdpdGggc29tZSBtb3N0bHkgZ2xvYmFsIGluZm9ybWF0aW9uLCB0aGlzIGNhbiBiZVxyXG4gKiBhbm5veWluZywgc2luY2UgZWFjaCBjb21wb25lbnQgd2lsbCBuZWVkIHRvIHBhc3MgdGhlIGluZm9ybWF0aW9uIHRvIGVhY2hcclxuICogY2hpbGRyZW4sIGV2ZW4gdGhvdWdoIHNvbWUgb3IgbW9zdCBvZiB0aGVtIHdpbGwgbm90IHVzZSB0aGUgaW5mb3JtYXRpb24uXHJcbiAqXHJcbiAqIFdpdGggYSBgQ29udGV4dGAgb2JqZWN0LCBlYWNoIGNvbXBvbmVudCBjYW4gc3Vic2NyaWJlICh3aXRoIHRoZSBgdXNlQ29udGV4dGBcclxuICogaG9vaykgdG8gaXRzIHN0YXRlLCBhbmQgd2lsbCBiZSB1cGRhdGVkIHdoZW5ldmVyIHRoZSBjb250ZXh0IHN0YXRlIGlzIHVwZGF0ZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiBwYXJ0aXRpb25CeShhcnIsIGZuKSB7XHJcbiAgICBsZXQgbGFzdEdyb3VwID0gZmFsc2U7XHJcbiAgICBsZXQgbGFzdFZhbHVlO1xyXG4gICAgcmV0dXJuIGFyci5yZWR1Y2UoKGFjYywgY3VyKSA9PiB7XHJcbiAgICAgICAgbGV0IGN1clZhbCA9IGZuKGN1cik7XHJcbiAgICAgICAgaWYgKGxhc3RHcm91cCkge1xyXG4gICAgICAgICAgICBpZiAoY3VyVmFsID09PSBsYXN0VmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGxhc3RHcm91cC5wdXNoKGN1cik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsYXN0R3JvdXAgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWxhc3RHcm91cCkge1xyXG4gICAgICAgICAgICBsYXN0R3JvdXAgPSBbY3VyXTtcclxuICAgICAgICAgICAgYWNjLnB1c2gobGFzdEdyb3VwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGFzdFZhbHVlID0gY3VyVmFsO1xyXG4gICAgICAgIHJldHVybiBhY2M7XHJcbiAgICB9LCBbXSk7XHJcbn1cclxuY2xhc3MgQ29udGV4dCBleHRlbmRzIEV2ZW50QnVzIHtcclxuICAgIGNvbnN0cnVjdG9yKHN0YXRlID0ge30pIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMucmV2ID0gMTtcclxuICAgICAgICAvLyBtYXBwaW5nIGZyb20gY29tcG9uZW50IGlkIHRvIGxhc3Qgb2JzZXJ2ZWQgY29udGV4dCBpZFxyXG4gICAgICAgIHRoaXMubWFwcGluZyA9IHt9O1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXIgPSBuZXcgT2JzZXJ2ZXIoKTtcclxuICAgICAgICB0aGlzLm9ic2VydmVyLm5vdGlmeUNCID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAvLyBub3RpZnkgY29tcG9uZW50cyBpbiB0aGUgbmV4dCBtaWNyb3Rhc2sgdGljayB0byBlbnN1cmUgdGhhdCBzdWJzY3JpYmVyc1xyXG4gICAgICAgICAgICAvLyBhcmUgbm90aWZpZWQgb25seSBvbmNlIGZvciBhbGwgY2hhbmdlcyB0aGF0IG9jY3VyIGluIHRoZSBzYW1lIG1pY3JvIHRpY2tcclxuICAgICAgICAgICAgbGV0IHJldiA9IHRoaXMucmV2O1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmV2ID09PSB0aGlzLnJldikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX19ub3RpZnlDb21wb25lbnRzKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHRoaXMub2JzZXJ2ZXIub2JzZXJ2ZShzdGF0ZSk7XHJcbiAgICAgICAgdGhpcy5zdWJzY3JpcHRpb25zLnVwZGF0ZSA9IFtdO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJbnN0ZWFkIG9mIHVzaW5nIHRyaWdnZXIgdG8gZW1pdCBhbiB1cGRhdGUgZXZlbnQsIHdlIGFjdHVhbGx5IGltcGxlbWVudFxyXG4gICAgICogb3VyIG93biBmdW5jdGlvbiB0byBkbyB0aGF0LiAgVGhlIHJlYXNvbiBpcyB0aGF0IHdlIG5lZWQgdG8gYmUgc21hcnRlciB0aGFuXHJcbiAgICAgKiBhIHNpbXBsZSB0cmlnZ2VyIGZ1bmN0aW9uOiB3ZSBuZWVkIHRvIHdhaXQgZm9yIHBhcmVudCBjb21wb25lbnRzIHRvIGJlXHJcbiAgICAgKiBkb25lIGJlZm9yZSBkb2luZyBjaGlsZHJlbiBjb21wb25lbnRzLiAgTW9yZSBwcmVjaXNlbHksIGlmIGFuIHVwZGF0ZVxyXG4gICAgICogYXMgYW4gZWZmZWN0IG9mIGRlc3Ryb3lpbmcgYSBjaGlsZHJlbiwgd2UgZG8gbm90IHdhbnQgdG8gY2FsbCBhbnkgY29kZVxyXG4gICAgICogZnJvbSB0aGUgY2hpbGQsIGFuZCBjZXJ0YWlubHkgbm90IHJlbmRlciBpdC5cclxuICAgICAqXHJcbiAgICAgKiBUaGlzIG1ldGhvZCBpbXBsZW1lbnRzIGEgc2ltcGxlIGdyb3VwaW5nIGFsZ29yaXRobSBieSBkZXB0aC4gSWYgd2UgaGF2ZVxyXG4gICAgICogY29ubmVjdGVkIGNvbXBvbmVudHMgb2YgZGVwdGhzIFsyLCA0LDQsNCw0LCAzLDgsOF0sIHRoZSBDb250ZXh0IHdpbGwgbm90aWZ5XHJcbiAgICAgKiB0aGVtIGluIHRoZSBmb2xsb3dpbmcgZ3JvdXBzOiBbMl0sIFs0LDQsNCw0XSwgWzNdLCBbOCw4XS4gRWFjaCBncm91cCB3aWxsXHJcbiAgICAgKiBiZSB1cGRhdGVkIHNlcXVlbnRpYWxseSwgYnV0IGVhY2ggY29tcG9uZW50cyBpbiBhIGdpdmVuIGdyb3VwIHdpbGwgYmUgZG9uZSBpblxyXG4gICAgICogcGFyYWxsZWwuXHJcbiAgICAgKlxyXG4gICAgICogVGhpcyBpcyBhIHZlcnkgc2ltcGxlIGFsZ29yaXRobSwgYnV0IGl0IGF2b2lkcyBjaGVja2luZyBpZiBhIGdpdmVuXHJcbiAgICAgKiBjb21wb25lbnQgaXMgYSBjaGlsZCBvZiBhbm90aGVyLlxyXG4gICAgICovXHJcbiAgICBhc3luYyBfX25vdGlmeUNvbXBvbmVudHMoKSB7XHJcbiAgICAgICAgY29uc3QgcmV2ID0gKyt0aGlzLnJldjtcclxuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb25zID0gdGhpcy5zdWJzY3JpcHRpb25zLnVwZGF0ZTtcclxuICAgICAgICBjb25zdCBncm91cHMgPSBwYXJ0aXRpb25CeShzdWJzY3JpcHRpb25zLCBzID0+IChzLm93bmVyID8gcy5vd25lci5fX293bF9fLmRlcHRoIDogLTEpKTtcclxuICAgICAgICBmb3IgKGxldCBncm91cCBvZiBncm91cHMpIHtcclxuICAgICAgICAgICAgY29uc3QgcHJvbXMgPSBncm91cC5tYXAoc3ViID0+IHN1Yi5jYWxsYmFjay5jYWxsKHN1Yi5vd25lciwgcmV2KSk7XHJcbiAgICAgICAgICAgIC8vIGF0IHRoaXMgcG9pbnQsIGVhY2ggY29tcG9uZW50IGluIHRoZSBjdXJyZW50IGdyb3VwIGhhcyByZWdpc3RlcmVkIGFcclxuICAgICAgICAgICAgLy8gdG9wIGxldmVsIGZpYmVyIGluIHRoZSBzY2hlZHVsZXIuIEl0IGNvdWxkIGhhcHBlbiB0aGF0IHJlbmRlcmluZyB0aGVzZVxyXG4gICAgICAgICAgICAvLyBjb21wb25lbnRzIGlzIGRvbmUgKGlmIHRoZXkgaGF2ZSBubyBjaGlsZHJlbikuICBUaGlzIGlzIHdoeSB3ZSBtYW51YWxseVxyXG4gICAgICAgICAgICAvLyBmbHVzaCB0aGUgc2NoZWR1bGVyLiAgVGhpcyB3aWxsIGZvcmNlIHRoZSBzY2hlZHVsZXIgdG8gY2hlY2tcclxuICAgICAgICAgICAgLy8gaW1tZWRpYXRlbHkgaWYgdGhleSBhcmUgZG9uZSwgd2hpY2ggd2lsbCBjYXVzZSB0aGVpciByZW5kZXJpbmdcclxuICAgICAgICAgICAgLy8gcHJvbWlzZSB0byByZXNvbHZlIGVhcmxpZXIsIHdoaWNoIG1lYW5zIHRoYXQgdGhlcmUgaXMgYSBjaGFuY2Ugb2ZcclxuICAgICAgICAgICAgLy8gcHJvY2Vzc2luZyB0aGUgbmV4dCBncm91cCBpbiB0aGUgc2FtZSBmcmFtZS5cclxuICAgICAgICAgICAgc2NoZWR1bGVyLmZsdXNoKCk7XHJcbiAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21zKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFRoZWB1c2VDb250ZXh0YCBob29rIGlzIHRoZSBub3JtYWwgd2F5IGZvciBhIGNvbXBvbmVudCB0byByZWdpc3RlciB0aGVtc2VsdmVcclxuICogdG8gY29udGV4dCBzdGF0ZSBjaGFuZ2VzLiBUaGUgYHVzZUNvbnRleHRgIG1ldGhvZCByZXR1cm5zIHRoZSBjb250ZXh0IHN0YXRlXHJcbiAqL1xyXG5mdW5jdGlvbiB1c2VDb250ZXh0KGN0eCkge1xyXG4gICAgY29uc3QgY29tcG9uZW50ID0gQ29tcG9uZW50LmN1cnJlbnQ7XHJcbiAgICByZXR1cm4gdXNlQ29udGV4dFdpdGhDQihjdHgsIGNvbXBvbmVudCwgY29tcG9uZW50LnJlbmRlci5iaW5kKGNvbXBvbmVudCkpO1xyXG59XHJcbmZ1bmN0aW9uIHVzZUNvbnRleHRXaXRoQ0IoY3R4LCBjb21wb25lbnQsIG1ldGhvZCkge1xyXG4gICAgY29uc3QgX19vd2xfXyA9IGNvbXBvbmVudC5fX293bF9fO1xyXG4gICAgY29uc3QgaWQgPSBfX293bF9fLmlkO1xyXG4gICAgY29uc3QgbWFwcGluZyA9IGN0eC5tYXBwaW5nO1xyXG4gICAgaWYgKGlkIGluIG1hcHBpbmcpIHtcclxuICAgICAgICByZXR1cm4gY3R4LnN0YXRlO1xyXG4gICAgfVxyXG4gICAgaWYgKCFfX293bF9fLm9ic2VydmVyKSB7XHJcbiAgICAgICAgX19vd2xfXy5vYnNlcnZlciA9IG5ldyBPYnNlcnZlcigpO1xyXG4gICAgICAgIF9fb3dsX18ub2JzZXJ2ZXIubm90aWZ5Q0IgPSBjb21wb25lbnQucmVuZGVyLmJpbmQoY29tcG9uZW50KTtcclxuICAgIH1cclxuICAgIGNvbnN0IGN1cnJlbnRDQiA9IF9fb3dsX18ub2JzZXJ2ZXIubm90aWZ5Q0I7XHJcbiAgICBfX293bF9fLm9ic2VydmVyLm5vdGlmeUNCID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChjdHgucmV2ID4gbWFwcGluZ1tpZF0pIHtcclxuICAgICAgICAgICAgLy8gaW4gdGhpcyBjYXNlLCB0aGUgY29udGV4dCBoYXMgYmVlbiB1cGRhdGVkIHNpbmNlIHdlIHdlcmUgcmVuZGVyaW5nXHJcbiAgICAgICAgICAgIC8vIGxhc3QsIGFuZCB3ZSBkbyBub3QgbmVlZCB0byByZW5kZXIgaGVyZSB3aXRoIHRoZSBvYnNlcnZlci4gQVxyXG4gICAgICAgICAgICAvLyByZW5kZXJpbmcgaXMgY29taW5nIGFueXdheSwgd2l0aCB0aGUgY29ycmVjdCBwcm9wcy5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjdXJyZW50Q0IoKTtcclxuICAgIH07XHJcbiAgICBtYXBwaW5nW2lkXSA9IDA7XHJcbiAgICBjb25zdCByZW5kZXJGbiA9IF9fb3dsX18ucmVuZGVyRm47XHJcbiAgICBfX293bF9fLnJlbmRlckZuID0gZnVuY3Rpb24gKGNvbXAsIHBhcmFtcykge1xyXG4gICAgICAgIG1hcHBpbmdbaWRdID0gY3R4LnJldjtcclxuICAgICAgICByZXR1cm4gcmVuZGVyRm4oY29tcCwgcGFyYW1zKTtcclxuICAgIH07XHJcbiAgICBjdHgub24oXCJ1cGRhdGVcIiwgY29tcG9uZW50LCBhc3luYyAoY29udGV4dFJldikgPT4ge1xyXG4gICAgICAgIGlmIChtYXBwaW5nW2lkXSA8IGNvbnRleHRSZXYpIHtcclxuICAgICAgICAgICAgbWFwcGluZ1tpZF0gPSBjb250ZXh0UmV2O1xyXG4gICAgICAgICAgICBhd2FpdCBtZXRob2QoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIGNvbnN0IF9fZGVzdHJveSA9IGNvbXBvbmVudC5fX2Rlc3Ryb3k7XHJcbiAgICBjb21wb25lbnQuX19kZXN0cm95ID0gcGFyZW50ID0+IHtcclxuICAgICAgICBjdHgub2ZmKFwidXBkYXRlXCIsIGNvbXBvbmVudCk7XHJcbiAgICAgICAgZGVsZXRlIG1hcHBpbmdbaWRdO1xyXG4gICAgICAgIF9fZGVzdHJveS5jYWxsKGNvbXBvbmVudCwgcGFyZW50KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gY3R4LnN0YXRlO1xyXG59XG5cbi8qKlxyXG4gKiBPd2wgSG9vayBTeXN0ZW1cclxuICpcclxuICogVGhpcyBmaWxlIGludHJvZHVjZXMgdGhlIGNvbmNlcHQgb2YgaG9va3MsIHNpbWlsYXIgdG8gUmVhY3Qgb3IgVnVlIGhvb2tzLlxyXG4gKiBXZSBoYXZlIGN1cnJlbnRseSBhbiBpbXBsZW1lbnRhdGlvbiBvZjpcclxuICogLSB1c2VTdGF0ZSAocmVhY3RpdmUgc3RhdGUpXHJcbiAqIC0gb25Nb3VudGVkXHJcbiAqIC0gb25XaWxsVW5tb3VudFxyXG4gKiAtIHVzZVJlZlxyXG4gKi9cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdXNlU3RhdGVcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLyoqXHJcbiAqIFRoaXMgaXMgdGhlIG1haW4gd2F5IGEgY29tcG9uZW50IGNhbiBiZSBtYWRlIHJlYWN0aXZlLiAgVGhlIHVzZVN0YXRlIGhvb2tcclxuICogd2lsbCByZXR1cm4gYW4gb2JzZXJ2ZWQgb2JqZWN0IChvciBhcnJheSkuICBDaGFuZ2VzIHRvIHRoYXQgdmFsdWUgd2lsbCB0aGVuXHJcbiAqIHRyaWdnZXIgYSByZXJlbmRlcmluZyBvZiB0aGUgY3VycmVudCBjb21wb25lbnQuXHJcbiAqL1xyXG5mdW5jdGlvbiB1c2VTdGF0ZShzdGF0ZSkge1xyXG4gICAgY29uc3QgY29tcG9uZW50ID0gQ29tcG9uZW50LmN1cnJlbnQ7XHJcbiAgICBjb25zdCBfX293bF9fID0gY29tcG9uZW50Ll9fb3dsX187XHJcbiAgICBpZiAoIV9fb3dsX18ub2JzZXJ2ZXIpIHtcclxuICAgICAgICBfX293bF9fLm9ic2VydmVyID0gbmV3IE9ic2VydmVyKCk7XHJcbiAgICAgICAgX19vd2xfXy5vYnNlcnZlci5ub3RpZnlDQiA9IGNvbXBvbmVudC5yZW5kZXIuYmluZChjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIF9fb3dsX18ub2JzZXJ2ZXIub2JzZXJ2ZShzdGF0ZSk7XHJcbn1cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gTGlmZSBjeWNsZSBob29rc1xyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5mdW5jdGlvbiBtYWtlTGlmZWN5Y2xlSG9vayhtZXRob2QsIHJldmVyc2UgPSBmYWxzZSkge1xyXG4gICAgaWYgKHJldmVyc2UpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGNiKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IENvbXBvbmVudC5jdXJyZW50O1xyXG4gICAgICAgICAgICBpZiAoY29tcG9uZW50Ll9fb3dsX19bbWV0aG9kXSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudCA9IGNvbXBvbmVudC5fX293bF9fW21ldGhvZF07XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuX19vd2xfX1ttZXRob2RdID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQuY2FsbChjb21wb25lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNiLmNhbGwoY29tcG9uZW50KTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuX19vd2xfX1ttZXRob2RdID0gY2I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjYikge1xyXG4gICAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSBDb21wb25lbnQuY3VycmVudDtcclxuICAgICAgICAgICAgaWYgKGNvbXBvbmVudC5fX293bF9fW21ldGhvZF0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBjb21wb25lbnQuX19vd2xfX1ttZXRob2RdO1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50Ll9fb3dsX19bbWV0aG9kXSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYi5jYWxsKGNvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudC5jYWxsKGNvbXBvbmVudCk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50Ll9fb3dsX19bbWV0aG9kXSA9IGNiO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiBtYWtlQXN5bmNIb29rKG1ldGhvZCkge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChjYikge1xyXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IENvbXBvbmVudC5jdXJyZW50O1xyXG4gICAgICAgIGlmIChjb21wb25lbnQuX19vd2xfX1ttZXRob2RdKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnQgPSBjb21wb25lbnQuX19vd2xfX1ttZXRob2RdO1xyXG4gICAgICAgICAgICBjb21wb25lbnQuX19vd2xfX1ttZXRob2RdID0gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLmFsbChbY3VycmVudC5jYWxsKGNvbXBvbmVudCwgLi4uYXJncyksIGNiLmNhbGwoY29tcG9uZW50LCAuLi5hcmdzKV0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29tcG9uZW50Ll9fb3dsX19bbWV0aG9kXSA9IGNiO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn1cclxuY29uc3Qgb25Nb3VudGVkID0gbWFrZUxpZmVjeWNsZUhvb2soXCJtb3VudGVkQ0JcIiwgdHJ1ZSk7XHJcbmNvbnN0IG9uV2lsbFVubW91bnQgPSBtYWtlTGlmZWN5Y2xlSG9vayhcIndpbGxVbm1vdW50Q0JcIik7XHJcbmNvbnN0IG9uV2lsbFBhdGNoID0gbWFrZUxpZmVjeWNsZUhvb2soXCJ3aWxsUGF0Y2hDQlwiKTtcclxuY29uc3Qgb25QYXRjaGVkID0gbWFrZUxpZmVjeWNsZUhvb2soXCJwYXRjaGVkQ0JcIiwgdHJ1ZSk7XHJcbmNvbnN0IG9uV2lsbFN0YXJ0ID0gbWFrZUFzeW5jSG9vayhcIndpbGxTdGFydENCXCIpO1xyXG5jb25zdCBvbldpbGxVcGRhdGVQcm9wcyA9IG1ha2VBc3luY0hvb2soXCJ3aWxsVXBkYXRlUHJvcHNDQlwiKTtcclxuZnVuY3Rpb24gdXNlUmVmKG5hbWUpIHtcclxuICAgIGNvbnN0IF9fb3dsX18gPSBDb21wb25lbnQuY3VycmVudC5fX293bF9fO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBnZXQgZWwoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZhbCA9IF9fb3dsX18ucmVmcyAmJiBfX293bF9fLnJlZnNbbmFtZV07XHJcbiAgICAgICAgICAgIGlmICh2YWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmICh2YWwgaW5zdGFuY2VvZiBDb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB2YWwuZWw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBnZXQgY29tcCgpIHtcclxuICAgICAgICAgICAgY29uc3QgdmFsID0gX19vd2xfXy5yZWZzICYmIF9fb3dsX18ucmVmc1tuYW1lXTtcclxuICAgICAgICAgICAgcmV0dXJuIHZhbCBpbnN0YW5jZW9mIENvbXBvbmVudCA/IHZhbCA6IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vLyB1c2VTdWJFbnZcclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLyoqXHJcbiAqIFRoaXMgaG9vayBpcyBhIHNpbXBsZSB3YXkgdG8gbGV0IGNvbXBvbmVudHMgdXNlIGEgc3ViIGVudmlyb25tZW50LiAgTm90ZSB0aGF0XHJcbiAqIGxpa2UgZm9yIGFsbCBob29rcywgaXQgaXMgaW1wb3J0YW50IHRoYXQgdGhpcyBpcyBvbmx5IGNhbGxlZCBpbiB0aGVcclxuICogY29uc3RydWN0b3IgbWV0aG9kLlxyXG4gKi9cclxuZnVuY3Rpb24gdXNlU3ViRW52KG5leHRFbnYpIHtcclxuICAgIGNvbnN0IGNvbXBvbmVudCA9IENvbXBvbmVudC5jdXJyZW50O1xyXG4gICAgY29tcG9uZW50LmVudiA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmNyZWF0ZShjb21wb25lbnQuZW52KSwgbmV4dEVudik7XHJcbn1cclxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuLy8gdXNlRXh0ZXJuYWxMaXN0ZW5lclxyXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4vKipcclxuICogV2hlbiBhIGNvbXBvbmVudCBuZWVkcyB0byBsaXN0ZW4gdG8gRE9NIEV2ZW50cyBvbiBlbGVtZW50KHMpIHRoYXQgYXJlIG5vdFxyXG4gKiBwYXJ0IG9mIGhpcyBoaWVyYXJjaHksIHdlIGNhbiB1c2UgdGhlIGB1c2VFeHRlcm5hbExpc3RlbmVyYCBob29rLlxyXG4gKiBJdCB3aWxsIGNvcnJlY3RseSBhZGQgYW5kIHJlbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXIsIHdoZW5ldmVyIHRoZVxyXG4gKiBjb21wb25lbnQgaXMgbW91bnRlZCBhbmQgdW5tb3VudGVkLlxyXG4gKlxyXG4gKiBFeGFtcGxlOlxyXG4gKiAgYSBtZW51IG5lZWRzIHRvIGxpc3RlbiB0byB0aGUgY2xpY2sgb24gd2luZG93IHRvIGJlIGNsb3NlZCBhdXRvbWF0aWNhbGx5XHJcbiAqXHJcbiAqIFVzYWdlOlxyXG4gKiAgaW4gdGhlIGNvbnN0cnVjdG9yIG9mIHRoZSBPV0wgY29tcG9uZW50IHRoYXQgbmVlZHMgdG8gYmUgbm90aWZpZWQsXHJcbiAqICBgdXNlRXh0ZXJuYWxMaXN0ZW5lcih3aW5kb3csICdjbGljaycsIHRoaXMuX2RvU29tZXRoaW5nKTtgXHJcbiAqICovXHJcbmZ1bmN0aW9uIHVzZUV4dGVybmFsTGlzdGVuZXIodGFyZ2V0LCBldmVudE5hbWUsIGhhbmRsZXIsIGV2ZW50UGFyYW1zKSB7XHJcbiAgICBjb25zdCBib3VuZEhhbmRsZXIgPSBoYW5kbGVyLmJpbmQoQ29tcG9uZW50LmN1cnJlbnQpO1xyXG4gICAgb25Nb3VudGVkKCgpID0+IHRhcmdldC5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgYm91bmRIYW5kbGVyLCBldmVudFBhcmFtcykpO1xyXG4gICAgb25XaWxsVW5tb3VudCgoKSA9PiB0YXJnZXQucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGJvdW5kSGFuZGxlciwgZXZlbnRQYXJhbXMpKTtcclxufVxuXG52YXIgX2hvb2tzID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbCxcbiAgICB1c2VTdGF0ZTogdXNlU3RhdGUsXG4gICAgb25Nb3VudGVkOiBvbk1vdW50ZWQsXG4gICAgb25XaWxsVW5tb3VudDogb25XaWxsVW5tb3VudCxcbiAgICBvbldpbGxQYXRjaDogb25XaWxsUGF0Y2gsXG4gICAgb25QYXRjaGVkOiBvblBhdGNoZWQsXG4gICAgb25XaWxsU3RhcnQ6IG9uV2lsbFN0YXJ0LFxuICAgIG9uV2lsbFVwZGF0ZVByb3BzOiBvbldpbGxVcGRhdGVQcm9wcyxcbiAgICB1c2VSZWY6IHVzZVJlZixcbiAgICB1c2VTdWJFbnY6IHVzZVN1YkVudixcbiAgICB1c2VFeHRlcm5hbExpc3RlbmVyOiB1c2VFeHRlcm5hbExpc3RlbmVyXG59KTtcblxuY2xhc3MgU3RvcmUgZXh0ZW5kcyBDb250ZXh0IHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbmZpZykge1xyXG4gICAgICAgIHN1cGVyKGNvbmZpZy5zdGF0ZSk7XHJcbiAgICAgICAgdGhpcy5hY3Rpb25zID0gY29uZmlnLmFjdGlvbnM7XHJcbiAgICAgICAgdGhpcy5lbnYgPSBjb25maWcuZW52O1xyXG4gICAgICAgIHRoaXMuZ2V0dGVycyA9IHt9O1xyXG4gICAgICAgIHRoaXMudXBkYXRlRnVuY3Rpb25zID0gW107XHJcbiAgICAgICAgaWYgKGNvbmZpZy5nZXR0ZXJzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0QXJnID0ge1xyXG4gICAgICAgICAgICAgICAgc3RhdGU6IHRoaXMuc3RhdGUsXHJcbiAgICAgICAgICAgICAgICBnZXR0ZXJzOiB0aGlzLmdldHRlcnNcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgZm9yIChsZXQgZyBpbiBjb25maWcuZ2V0dGVycykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXR0ZXJzW2ddID0gY29uZmlnLmdldHRlcnNbZ10uYmluZCh0aGlzLCBmaXJzdEFyZyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBkaXNwYXRjaChhY3Rpb24sIC4uLnBheWxvYWQpIHtcclxuICAgICAgICBpZiAoIXRoaXMuYWN0aW9uc1thY3Rpb25dKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgW0Vycm9yXSBhY3Rpb24gJHthY3Rpb259IGlzIHVuZGVmaW5lZGApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCByZXN1bHQgPSB0aGlzLmFjdGlvbnNbYWN0aW9uXSh7XHJcbiAgICAgICAgICAgIGRpc3BhdGNoOiB0aGlzLmRpc3BhdGNoLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIGVudjogdGhpcy5lbnYsXHJcbiAgICAgICAgICAgIHN0YXRlOiB0aGlzLnN0YXRlLFxyXG4gICAgICAgICAgICBnZXR0ZXJzOiB0aGlzLmdldHRlcnNcclxuICAgICAgICB9LCAuLi5wYXlsb2FkKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG59XHJcbmNvbnN0IGlzU3RyaWN0RXF1YWwgPSAoYSwgYikgPT4gYSA9PT0gYjtcclxuZnVuY3Rpb24gdXNlU3RvcmUoc2VsZWN0b3IsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgY29uc3QgY29tcG9uZW50ID0gQ29tcG9uZW50LmN1cnJlbnQ7XHJcbiAgICBjb25zdCBjb21wb25lbnRJZCA9IGNvbXBvbmVudC5fX293bF9fLmlkO1xyXG4gICAgY29uc3Qgc3RvcmUgPSBvcHRpb25zLnN0b3JlIHx8IGNvbXBvbmVudC5lbnYuc3RvcmU7XHJcbiAgICBpZiAoIShzdG9yZSBpbnN0YW5jZW9mIFN0b3JlKSkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gc3RvcmUgZm91bmQgd2hlbiBjb25uZWN0aW5nICcke2NvbXBvbmVudC5jb25zdHJ1Y3Rvci5uYW1lfSdgKTtcclxuICAgIH1cclxuICAgIGxldCByZXN1bHQgPSBzZWxlY3RvcihzdG9yZS5zdGF0ZSwgY29tcG9uZW50LnByb3BzKTtcclxuICAgIGNvbnN0IGhhc2hGbiA9IHN0b3JlLm9ic2VydmVyLnJldk51bWJlci5iaW5kKHN0b3JlLm9ic2VydmVyKTtcclxuICAgIGxldCByZXZOdW1iZXIgPSBoYXNoRm4ocmVzdWx0KTtcclxuICAgIGNvbnN0IGlzRXF1YWwgPSBvcHRpb25zLmlzRXF1YWwgfHwgaXNTdHJpY3RFcXVhbDtcclxuICAgIGlmICghc3RvcmUudXBkYXRlRnVuY3Rpb25zW2NvbXBvbmVudElkXSkge1xyXG4gICAgICAgIHN0b3JlLnVwZGF0ZUZ1bmN0aW9uc1tjb21wb25lbnRJZF0gPSBbXTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIHNlbGVjdENvbXBhcmVVcGRhdGUoc3RhdGUsIHByb3BzKSB7XHJcbiAgICAgICAgY29uc3Qgb2xkUmVzdWx0ID0gcmVzdWx0O1xyXG4gICAgICAgIHJlc3VsdCA9IHNlbGVjdG9yKHN0YXRlLCBwcm9wcyk7XHJcbiAgICAgICAgY29uc3QgbmV3UmV2TnVtYmVyID0gaGFzaEZuKHJlc3VsdCk7XHJcbiAgICAgICAgaWYgKChuZXdSZXZOdW1iZXIgPiAwICYmIHJldk51bWJlciAhPT0gbmV3UmV2TnVtYmVyKSB8fCAhaXNFcXVhbChvbGRSZXN1bHQsIHJlc3VsdCkpIHtcclxuICAgICAgICAgICAgcmV2TnVtYmVyID0gbmV3UmV2TnVtYmVyO1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy5vblVwZGF0ZSkge1xyXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5vblVwZGF0ZShyZXN1bHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBzdG9yZS51cGRhdGVGdW5jdGlvbnNbY29tcG9uZW50SWRdLnB1c2goZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiBzZWxlY3RDb21wYXJlVXBkYXRlKHN0b3JlLnN0YXRlLCBjb21wb25lbnQucHJvcHMpO1xyXG4gICAgfSk7XHJcbiAgICB1c2VDb250ZXh0V2l0aENCKHN0b3JlLCBjb21wb25lbnQsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBsZXQgc2hvdWxkUmVuZGVyID0gZmFsc2U7XHJcbiAgICAgICAgZm9yIChsZXQgZm4gb2Ygc3RvcmUudXBkYXRlRnVuY3Rpb25zW2NvbXBvbmVudElkXSkge1xyXG4gICAgICAgICAgICBzaG91bGRSZW5kZXIgPSBmbigpIHx8IHNob3VsZFJlbmRlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHNob3VsZFJlbmRlcikge1xyXG4gICAgICAgICAgICByZXR1cm4gY29tcG9uZW50LnJlbmRlcigpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgb25XaWxsVXBkYXRlUHJvcHMocHJvcHMgPT4ge1xyXG4gICAgICAgIHNlbGVjdENvbXBhcmVVcGRhdGUoc3RvcmUuc3RhdGUsIHByb3BzKTtcclxuICAgIH0pO1xyXG4gICAgY29uc3QgX19kZXN0cm95ID0gY29tcG9uZW50Ll9fZGVzdHJveTtcclxuICAgIGNvbXBvbmVudC5fX2Rlc3Ryb3kgPSBwYXJlbnQgPT4ge1xyXG4gICAgICAgIGRlbGV0ZSBzdG9yZS51cGRhdGVGdW5jdGlvbnNbY29tcG9uZW50SWRdO1xyXG4gICAgICAgIF9fZGVzdHJveS5jYWxsKGNvbXBvbmVudCwgcGFyZW50KTtcclxuICAgIH07XHJcbiAgICBpZiAodHlwZW9mIHJlc3VsdCAhPT0gXCJvYmplY3RcIiB8fCByZXN1bHQgPT09IG51bGwpIHtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIG5ldyBQcm94eShyZXN1bHQsIHtcclxuICAgICAgICBnZXQodGFyZ2V0LCBrKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHRba107XHJcbiAgICAgICAgfSxcclxuICAgICAgICBzZXQodGFyZ2V0LCBrLCB2KSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlN0b3JlIHN0YXRlIHNob3VsZCBvbmx5IGJlIG1vZGlmaWVkIHRocm91Z2ggYWN0aW9uc1wiKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGhhcyh0YXJnZXQsIGspIHtcclxuICAgICAgICAgICAgcmV0dXJuIGsgaW4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHVzZURpc3BhdGNoKHN0b3JlKSB7XHJcbiAgICBzdG9yZSA9IHN0b3JlIHx8IENvbXBvbmVudC5jdXJyZW50LmVudi5zdG9yZTtcclxuICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaC5iaW5kKHN0b3JlKTtcclxufVxyXG5mdW5jdGlvbiB1c2VHZXR0ZXJzKHN0b3JlKSB7XHJcbiAgICBzdG9yZSA9IHN0b3JlIHx8IENvbXBvbmVudC5jdXJyZW50LmVudi5zdG9yZTtcclxuICAgIHJldHVybiBzdG9yZS5nZXR0ZXJzO1xyXG59XG5cbi8qKlxyXG4gKiBPd2wgVGFnc1xyXG4gKlxyXG4gKiBXZSBoYXZlIGhlcmUgYSAodmVyeSkgc21hbGwgY29sbGVjdGlvbiBvZiB0YWcgZnVuY3Rpb25zOlxyXG4gKlxyXG4gKiAtIHhtbFxyXG4gKlxyXG4gKiBUaGUgcGxhbiBpcyB0byBhZGQgYSBmZXcgb3RoZXIgdGFncyBzdWNoIGFzIGNzcywgZ2xvYmFsY3NzLlxyXG4gKi9cclxuLyoqXHJcbiAqIFhNTCB0YWcgaGVscGVyIGZvciBkZWZpbmluZyB0ZW1wbGF0ZXMuICBXaXRoIHRoaXMsIG9uZSBjYW4gc2ltcGx5IGRlZmluZVxyXG4gKiBhbiBpbmxpbmUgdGVtcGxhdGUgd2l0aCBqdXN0IHRoZSB0ZW1wbGF0ZSB4bWw6XHJcbiAqIGBgYGpzXHJcbiAqICAgY2xhc3MgQSBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAqICAgICBzdGF0aWMgdGVtcGxhdGUgPSB4bWxgPGRpdj5zb21lIHRlbXBsYXRlPC9kaXY+YDtcclxuICogICB9XHJcbiAqIGBgYFxyXG4gKi9cclxuZnVuY3Rpb24geG1sKHN0cmluZ3MsIC4uLmFyZ3MpIHtcclxuICAgIGNvbnN0IG5hbWUgPSBgX190ZW1wbGF0ZV9fJHtRV2ViLm5leHRJZCsrfWA7XHJcbiAgICBjb25zdCB2YWx1ZSA9IFN0cmluZy5yYXcoc3RyaW5ncywgLi4uYXJncyk7XHJcbiAgICBRV2ViLnJlZ2lzdGVyVGVtcGxhdGUobmFtZSwgdmFsdWUpO1xyXG4gICAgcmV0dXJuIG5hbWU7XHJcbn1cclxuLyoqXHJcbiAqIENTUyB0YWcgaGVscGVyIGZvciBkZWZpbmluZyBpbmxpbmUgc3R5bGVzaGVldHMuICBXaXRoIHRoaXMsIG9uZSBjYW4gc2ltcGx5IGRlZmluZVxyXG4gKiBhbiBpbmxpbmUgc3R5bGVzaGVldCB3aXRoIGp1c3QgdGhlIGZvbGxvd2luZyBjb2RlOlxyXG4gKiBgYGBqc1xyXG4gKiAgIGNsYXNzIEEgZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gKiAgICAgc3RhdGljIHN0eWxlID0gY3NzYC5jb21wb25lbnQtYSB7IGNvbG9yOiByZWQ7IH1gO1xyXG4gKiAgIH1cclxuICogYGBgXHJcbiAqL1xyXG5mdW5jdGlvbiBjc3Moc3RyaW5ncywgLi4uYXJncykge1xyXG4gICAgY29uc3QgbmFtZSA9IGBfX3NoZWV0X18ke1FXZWIubmV4dElkKyt9YDtcclxuICAgIGNvbnN0IHZhbHVlID0gU3RyaW5nLnJhdyhzdHJpbmdzLCAuLi5hcmdzKTtcclxuICAgIHJlZ2lzdGVyU2hlZXQobmFtZSwgdmFsdWUpO1xyXG4gICAgcmV0dXJuIG5hbWU7XHJcbn1cblxudmFyIF90YWdzID0gLyojX19QVVJFX18qL09iamVjdC5mcmVlemUoe1xuICAgIF9fcHJvdG9fXzogbnVsbCxcbiAgICB4bWw6IHhtbCxcbiAgICBjc3M6IGNzc1xufSk7XG5cbi8qKlxyXG4gKiBBc3luY1Jvb3RcclxuICpcclxuICogT3dsIGlzIGJ5IGRlZmF1bHQgYXN5bmNocm9ub3VzLCBhbmQgdGhlIHVzZXIgaW50ZXJmYWNlIHdpbGwgd2FpdCBmb3IgYWxsIGl0c1xyXG4gKiBzdWJjb21wb25lbnRzIHRvIGJlIHJlbmRlcmVkIGJlZm9yZSB1cGRhdGluZyB0aGUgRE9NLiBUaGlzIGlzIG1vc3Qgb2YgdGhlXHJcbiAqIHRpbWUgd2hhdCB3ZSB3YW50LCBidXQgaW4gc29tZSBjYXNlcywgaXQgbWFrZXMgc2Vuc2UgdG8gXCJkZXRhY2hcIiBhIGNvbXBvbmVudFxyXG4gKiBmcm9tIHRoaXMgY29vcmRpbmF0aW9uLiAgVGhpcyBpcyB0aGUgZ29hbCBvZiB0aGUgQXN5bmNSb290IGNvbXBvbmVudC5cclxuICovXHJcbmNsYXNzIEFzeW5jUm9vdCBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBhc3luYyBfX3VwZGF0ZVByb3BzKG5leHRQcm9wcywgcGFyZW50RmliZXIpIHtcclxuICAgICAgICB0aGlzLnJlbmRlcihwYXJlbnRGaWJlci5mb3JjZSk7XHJcbiAgICB9XHJcbn1cclxuQXN5bmNSb290LnRlbXBsYXRlID0geG1sIGA8dCB0LXNsb3Q9XCJkZWZhdWx0XCIvPmA7XG5cbmNsYXNzIFBvcnRhbCBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3RvcihwYXJlbnQsIHByb3BzKSB7XHJcbiAgICAgICAgc3VwZXIocGFyZW50LCBwcm9wcyk7XHJcbiAgICAgICAgLy8gYm9vbGVhbiB0byBpbmRpY2F0ZSB3aGV0aGVyIG9yIG5vdCB3ZSBtdXN0IGxpc3RlbiB0byAnZG9tLWFwcGVuZGVkJyBldmVudFxyXG4gICAgICAgIC8vIHRvIGhvb2sgb24gdGhlIG1vbWVudCB3aGVuIHRoZSB0YXJnZXQgaXMgaW5zZXJ0ZWQgaW50byB0aGUgRE9NIChiZWNhdXNlIGl0XHJcbiAgICAgICAgLy8gaXMgbm90IHdoZW4gdGhlIHBvcnRhbCBpcyByZW5kZXJlZClcclxuICAgICAgICB0aGlzLmRvVGFyZ2V0TG9va1VwID0gdHJ1ZTtcclxuICAgICAgICAvLyBzZXQgb2YgZW5jb3VudGVyZWQgZXZlbnRzIHRoYXQgbmVlZCB0byBiZSByZWRpcmVjdGVkXHJcbiAgICAgICAgdGhpcy5faGFuZGxlZEV2ZW50cyA9IG5ldyBTZXQoKTtcclxuICAgICAgICAvLyBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgdGhlIGV2ZW50J3MgdHVubmVsIChuZWVkcyB0byBiZSBhbiBhcnJvdyBmdW5jdGlvbiB0b1xyXG4gICAgICAgIC8vIGF2b2lkIGhhdmluZyB0byByZWJpbmQgYHRoaXNgKVxyXG4gICAgICAgIHRoaXMuX2hhbmRsZXJUdW5uZWwgPSAoZXYpID0+IHtcclxuICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX190cmlnZ2VyKGV2Lm9yaWdpbmFsQ29tcG9uZW50LCBldi50eXBlLCBldi5kZXRhaWwpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgLy8gU3RvcmluZyB0aGUgcGFyZW50J3MgZW52XHJcbiAgICAgICAgdGhpcy5wYXJlbnRFbnYgPSBudWxsO1xyXG4gICAgICAgIC8vIHJlcHJlc2VudHMgdGhlIGVsZW1lbnQgdGhhdCBpcyBtb3ZlZCBzb21ld2hlcmUgZWxzZVxyXG4gICAgICAgIHRoaXMucG9ydGFsID0gbnVsbDtcclxuICAgICAgICAvLyB0aGUgdGFyZ2V0IHdoZXJlIHdlIHdpbGwgbW92ZSBgcG9ydGFsYFxyXG4gICAgICAgIHRoaXMudGFyZ2V0ID0gbnVsbDtcclxuICAgICAgICB0aGlzLnBhcmVudEVudiA9IHBhcmVudCA/IHBhcmVudC5lbnYgOiB7fTtcclxuICAgICAgICAvLyBwdXQgYSBjYWxsYmFjayBpbiB0aGUgZW52IHRoYXQgaXMgcHJvcGFnYXRlZCB0byBjaGlsZHJlbiBzLnQuIHBvcnRhbCBjYW5cclxuICAgICAgICAvLyByZWdpc3RlciBhbiBoYW5kbGVyIHRvIHRob3NlIGV2ZW50cyBqdXN0IGJlZm9yZSBjaGlsZHJlbiB3aWxsIHRyaWdnZXIgdGhlbVxyXG4gICAgICAgIHVzZVN1YkVudih7XHJcbiAgICAgICAgICAgIFtwb3J0YWxTeW1ib2xdOiBldiA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2hhbmRsZWRFdmVudHMuaGFzKGV2LnR5cGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wb3J0YWwuZWxtLmFkZEV2ZW50TGlzdGVuZXIoZXYudHlwZSwgdGhpcy5faGFuZGxlclR1bm5lbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlZEV2ZW50cy5hZGQoZXYudHlwZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogT3ZlcnJpZGUgdG8gcmV2ZXJ0IGJhY2sgdG8gYSBjbGFzc2ljIENvbXBvbmVudCdzIHN0cnVjdHVyZVxyXG4gICAgICpcclxuICAgICAqIEBvdmVycmlkZVxyXG4gICAgICovXHJcbiAgICBfX2NhbGxXaWxsVW5tb3VudCgpIHtcclxuICAgICAgICBzdXBlci5fX2NhbGxXaWxsVW5tb3VudCgpO1xyXG4gICAgICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQodGhpcy5wb3J0YWwuZWxtKTtcclxuICAgICAgICB0aGlzLmRvVGFyZ2V0TG9va1VwID0gdHJ1ZTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogQXQgZWFjaCBET00gY2hhbmdlLCB3ZSBtdXN0IGVuc3VyZSB0aGF0IHRoZSBwb3J0YWwgY29udGFpbnMgZXhhY3RseSBvbmVcclxuICAgICAqIGNoaWxkXHJcbiAgICAgKi9cclxuICAgIF9fY2hlY2tWTm9kZVN0cnVjdHVyZSh2bm9kZSkge1xyXG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gdm5vZGUuY2hpbGRyZW47XHJcbiAgICAgICAgbGV0IGNvdW50UmVhbE5vZGVzID0gMDtcclxuICAgICAgICBmb3IgKGxldCBjaGlsZCBvZiBjaGlsZHJlbikge1xyXG4gICAgICAgICAgICBpZiAoY2hpbGQuc2VsKSB7XHJcbiAgICAgICAgICAgICAgICBjb3VudFJlYWxOb2RlcysrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChjb3VudFJlYWxOb2RlcyAhPT0gMSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFBvcnRhbCBtdXN0IGhhdmUgZXhhY3RseSBvbmUgbm9uLXRleHQgY2hpbGQgKGhhcyAke2NvdW50UmVhbE5vZGVzfSlgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEVuc3VyZSB0aGUgdGFyZ2V0IGlzIHN0aWxsIHRoZXJlIGF0IHdoaWNoZXZlciB0aW1lIHdlIHJlbmRlclxyXG4gICAgICovXHJcbiAgICBfX2NoZWNrVGFyZ2V0UHJlc2VuY2UoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnRhcmdldCB8fCAhZG9jdW1lbnQuY29udGFpbnModGhpcy50YXJnZXQpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgYW55IG1hdGNoIGZvciBcIiR7dGhpcy5wcm9wcy50YXJnZXR9XCJgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE1vdmUgdGhlIHBvcnRhbCdzIGVsZW1lbnQgdG8gdGhlIHRhcmdldFxyXG4gICAgICovXHJcbiAgICBfX2RlcGxveVBvcnRhbCgpIHtcclxuICAgICAgICB0aGlzLl9fY2hlY2tUYXJnZXRQcmVzZW5jZSgpO1xyXG4gICAgICAgIHRoaXMudGFyZ2V0LmFwcGVuZENoaWxkKHRoaXMucG9ydGFsLmVsbSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE92ZXJyaWRlIHRvIHJlbW92ZSBmcm9tIHRoZSBET00gdGhlIGVsZW1lbnQgd2UgaGF2ZSB0ZWxlcG9ydGVkXHJcbiAgICAgKlxyXG4gICAgICogQG92ZXJyaWRlXHJcbiAgICAgKi9cclxuICAgIF9fZGVzdHJveShwYXJlbnQpIHtcclxuICAgICAgICBpZiAodGhpcy5wb3J0YWwgJiYgdGhpcy5wb3J0YWwuZWxtKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRpc3BsYWNlZEVsbSA9IHRoaXMucG9ydGFsLmVsbTtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gZGlzcGxhY2VkRWxtLnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnQpIHtcclxuICAgICAgICAgICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChkaXNwbGFjZWRFbG0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHN1cGVyLl9fZGVzdHJveShwYXJlbnQpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBPdmVycmlkZSB0byBwYXRjaCB0aGUgZWxlbWVudCB0aGF0IGhhcyBiZWVuIHRlbGVwb3J0ZWRcclxuICAgICAqXHJcbiAgICAgKiBAb3ZlcnJpZGVcclxuICAgICAqL1xyXG4gICAgX19wYXRjaCh0YXJnZXQsIHZub2RlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZG9UYXJnZXRMb29rVXApIHtcclxuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLnByb3BzLnRhcmdldCk7XHJcbiAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmVudi5xd2ViLm9uKFwiZG9tLWFwcGVuZGVkXCIsIHRoaXMsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRvVGFyZ2V0TG9va1VwID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbnYucXdlYi5vZmYoXCJkb20tYXBwZW5kZWRcIiwgdGhpcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMucHJvcHMudGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9fZGVwbG95UG9ydGFsKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZG9UYXJnZXRMb29rVXAgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMudGFyZ2V0ID0gdGFyZ2V0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX19jaGVja1ZOb2RlU3RydWN0dXJlKHZub2RlKTtcclxuICAgICAgICBjb25zdCBzaG91bGREZXBsb3kgPSAoIXRoaXMucG9ydGFsIHx8IHRoaXMuZWwuY29udGFpbnModGhpcy5wb3J0YWwuZWxtKSkgJiYgIXRoaXMuZG9UYXJnZXRMb29rVXA7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRvVGFyZ2V0TG9va1VwICYmICFzaG91bGREZXBsb3kpIHtcclxuICAgICAgICAgICAgLy8gT25seSBvbiBwdXJlIHBhdGNoaW5nLCBwcm92aWRlZCB0aGVcclxuICAgICAgICAgICAgLy8gdGhpcy50YXJnZXQncyBwYXJlbnQgaGFzIG5vdCBiZWVuIHVubW91bnRlZFxyXG4gICAgICAgICAgICB0aGlzLl9fY2hlY2tUYXJnZXRQcmVzZW5jZSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBwb3J0YWxQYXRjaCA9IHRoaXMucG9ydGFsID8gdGhpcy5wb3J0YWwgOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHZub2RlLmNoaWxkcmVuWzBdLnNlbCk7XHJcbiAgICAgICAgdGhpcy5wb3J0YWwgPSBwYXRjaChwb3J0YWxQYXRjaCwgdm5vZGUuY2hpbGRyZW5bMF0pO1xyXG4gICAgICAgIHZub2RlLmNoaWxkcmVuID0gW107XHJcbiAgICAgICAgc3VwZXIuX19wYXRjaCh0YXJnZXQsIHZub2RlKTtcclxuICAgICAgICBpZiAoc2hvdWxkRGVwbG95KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX19kZXBsb3lQb3J0YWwoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIE92ZXJyaWRlIHRvIHNldCB0aGUgZW52XHJcbiAgICAgKi9cclxuICAgIF9fdHJpZ2dlcihjb21wb25lbnQsIGV2ZW50VHlwZSwgcGF5bG9hZCkge1xyXG4gICAgICAgIGNvbnN0IGVudiA9IHRoaXMuZW52O1xyXG4gICAgICAgIHRoaXMuZW52ID0gdGhpcy5wYXJlbnRFbnY7XHJcbiAgICAgICAgc3VwZXIuX190cmlnZ2VyKGNvbXBvbmVudCwgZXZlbnRUeXBlLCBwYXlsb2FkKTtcclxuICAgICAgICB0aGlzLmVudiA9IGVudjtcclxuICAgIH1cclxufVxyXG5Qb3J0YWwudGVtcGxhdGUgPSB4bWwgYDxwb3J0YWw+PHQgdC1zbG90PVwiZGVmYXVsdFwiLz48L3BvcnRhbD5gO1xyXG5Qb3J0YWwucHJvcHMgPSB7XHJcbiAgICB0YXJnZXQ6IHtcclxuICAgICAgICB0eXBlOiBTdHJpbmdcclxuICAgIH1cclxufTtcblxuY2xhc3MgTGluayBleHRlbmRzIENvbXBvbmVudCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpO1xyXG4gICAgICAgIHRoaXMuaHJlZiA9IHRoaXMuZW52LnJvdXRlci5kZXN0VG9QYXRoKHRoaXMucHJvcHMpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgd2lsbFVwZGF0ZVByb3BzKG5leHRQcm9wcykge1xyXG4gICAgICAgIHRoaXMuaHJlZiA9IHRoaXMuZW52LnJvdXRlci5kZXN0VG9QYXRoKG5leHRQcm9wcyk7XHJcbiAgICB9XHJcbiAgICBnZXQgaXNBY3RpdmUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZW52LnJvdXRlci5tb2RlID09PSBcImhhc2hcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQubG9jYXRpb24uaGFzaCA9PT0gdGhpcy5ocmVmO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZG9jdW1lbnQubG9jYXRpb24ucGF0aG5hbWUgPT09IHRoaXMuaHJlZjtcclxuICAgIH1cclxuICAgIG5hdmlnYXRlKGV2KSB7XHJcbiAgICAgICAgLy8gZG9uJ3QgcmVkaXJlY3Qgd2l0aCBjb250cm9sIGtleXNcclxuICAgICAgICBpZiAoZXYubWV0YUtleSB8fCBldi5hbHRLZXkgfHwgZXYuY3RybEtleSB8fCBldi5zaGlmdEtleSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGRvbid0IHJlZGlyZWN0IG9uIHJpZ2h0IGNsaWNrXHJcbiAgICAgICAgaWYgKGV2LmJ1dHRvbiAhPT0gdW5kZWZpbmVkICYmIGV2LmJ1dHRvbiAhPT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGRvbid0IHJlZGlyZWN0IGlmIGB0YXJnZXQ9XCJfYmxhbmtcImBcclxuICAgICAgICBpZiAoZXYuY3VycmVudFRhcmdldCAmJiBldi5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZSkge1xyXG4gICAgICAgICAgICBjb25zdCB0YXJnZXQgPSBldi5jdXJyZW50VGFyZ2V0LmdldEF0dHJpYnV0ZShcInRhcmdldFwiKTtcclxuICAgICAgICAgICAgaWYgKC9cXGJfYmxhbmtcXGIvaS50ZXN0KHRhcmdldCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRoaXMuZW52LnJvdXRlci5uYXZpZ2F0ZSh0aGlzLnByb3BzKTtcclxuICAgIH1cclxufVxyXG5MaW5rLnRlbXBsYXRlID0geG1sIGBcclxuICAgIDxhICB0LWF0dC1jbGFzcz1cInsncm91dGVyLWxpbmstYWN0aXZlJzogaXNBY3RpdmUgfVwiXHJcbiAgICAgICAgdC1hdHQtaHJlZj1cImhyZWZcIlxyXG4gICAgICAgIHQtb24tY2xpY2s9XCJuYXZpZ2F0ZVwiPlxyXG4gICAgICAgIDx0IHQtc2xvdD1cImRlZmF1bHRcIi8+XHJcbiAgICA8L2E+XHJcbiAgYDtcblxuY2xhc3MgUm91dGVDb21wb25lbnQgZXh0ZW5kcyBDb21wb25lbnQge1xyXG4gICAgZ2V0IHJvdXRlQ29tcG9uZW50KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmVudi5yb3V0ZXIuY3VycmVudFJvdXRlICYmIHRoaXMuZW52LnJvdXRlci5jdXJyZW50Um91dGUuY29tcG9uZW50O1xyXG4gICAgfVxyXG59XHJcblJvdXRlQ29tcG9uZW50LnRlbXBsYXRlID0geG1sIGBcclxuICAgIDx0PlxyXG4gICAgICAgIDx0XHJcbiAgICAgICAgICAgIHQtaWY9XCJyb3V0ZUNvbXBvbmVudFwiXHJcbiAgICAgICAgICAgIHQtY29tcG9uZW50PVwicm91dGVDb21wb25lbnRcIlxyXG4gICAgICAgICAgICB0LWtleT1cImVudi5yb3V0ZXIuY3VycmVudFJvdXRlTmFtZVwiXHJcbiAgICAgICAgICAgIHQtcHJvcHM9XCJlbnYucm91dGVyLmN1cnJlbnRQYXJhbXNcIiAvPlxyXG4gICAgPC90PlxyXG4gIGA7XG5cbmNvbnN0IHBhcmFtUmVnZXhwID0gL1xce1xceyguKj8pXFx9XFx9LztcclxuY2xhc3MgUm91dGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKGVudiwgcm91dGVzLCBvcHRpb25zID0geyBtb2RlOiBcImhpc3RvcnlcIiB9KSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50Um91dGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFBhcmFtcyA9IG51bGw7XHJcbiAgICAgICAgZW52LnJvdXRlciA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5tb2RlID0gb3B0aW9ucy5tb2RlO1xyXG4gICAgICAgIHRoaXMuZW52ID0gZW52O1xyXG4gICAgICAgIHRoaXMucm91dGVzID0ge307XHJcbiAgICAgICAgdGhpcy5yb3V0ZUlkcyA9IFtdO1xyXG4gICAgICAgIGxldCBuZXh0SWQgPSAxO1xyXG4gICAgICAgIGZvciAobGV0IHBhcnRpYWxSb3V0ZSBvZiByb3V0ZXMpIHtcclxuICAgICAgICAgICAgaWYgKCFwYXJ0aWFsUm91dGUubmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcGFydGlhbFJvdXRlLm5hbWUgPSBcIl9fcm91dGVfX1wiICsgbmV4dElkKys7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHBhcnRpYWxSb3V0ZS5jb21wb25lbnQpIHtcclxuICAgICAgICAgICAgICAgIFFXZWIucmVnaXN0ZXJDb21wb25lbnQoXCJfX2NvbXBvbmVudF9fXCIgKyBwYXJ0aWFsUm91dGUubmFtZSwgcGFydGlhbFJvdXRlLmNvbXBvbmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHBhcnRpYWxSb3V0ZS5yZWRpcmVjdCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy52YWxpZGF0ZURlc3RpbmF0aW9uKHBhcnRpYWxSb3V0ZS5yZWRpcmVjdCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGFydGlhbFJvdXRlLnBhcmFtcyA9IHBhcnRpYWxSb3V0ZS5wYXRoID8gZmluZFBhcmFtcyhwYXJ0aWFsUm91dGUucGF0aCkgOiBbXTtcclxuICAgICAgICAgICAgdGhpcy5yb3V0ZXNbcGFydGlhbFJvdXRlLm5hbWVdID0gcGFydGlhbFJvdXRlO1xyXG4gICAgICAgICAgICB0aGlzLnJvdXRlSWRzLnB1c2gocGFydGlhbFJvdXRlLm5hbWUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFB1YmxpYyBBUElcclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIGFzeW5jIHN0YXJ0KCkge1xyXG4gICAgICAgIHRoaXMuX2xpc3RlbmVyID0gZXYgPT4gdGhpcy5fbmF2aWdhdGUodGhpcy5jdXJyZW50UGF0aCgpLCBldik7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJwb3BzdGF0ZVwiLCB0aGlzLl9saXN0ZW5lcik7XHJcbiAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gXCJoYXNoXCIpIHtcclxuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJoYXNoY2hhbmdlXCIsIHRoaXMuX2xpc3RlbmVyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5tYXRjaEFuZEFwcGx5UnVsZXModGhpcy5jdXJyZW50UGF0aCgpKTtcclxuICAgICAgICBpZiAocmVzdWx0LnR5cGUgPT09IFwibWF0Y2hcIikge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3V0ZSA9IHJlc3VsdC5yb3V0ZTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gcmVzdWx0LnBhcmFtcztcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudFBhdGggPSB0aGlzLnJvdXRlVG9QYXRoKHJlc3VsdC5yb3V0ZSwgcmVzdWx0LnBhcmFtcyk7XHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50UGF0aCAhPT0gdGhpcy5jdXJyZW50UGF0aCgpKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldFVybEZyb21QYXRoKGN1cnJlbnRQYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGFzeW5jIG5hdmlnYXRlKHRvKSB7XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IHRoaXMuZGVzdFRvUGF0aCh0byk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX25hdmlnYXRlKHBhdGgpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgX25hdmlnYXRlKHBhdGgsIGV2KSB7XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbE5hbWUgPSB0aGlzLmN1cnJlbnRSb3V0ZU5hbWU7XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbFBhcmFtcyA9IHRoaXMuY3VycmVudFBhcmFtcztcclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLm1hdGNoQW5kQXBwbHlSdWxlcyhwYXRoKTtcclxuICAgICAgICBpZiAocmVzdWx0LnR5cGUgPT09IFwibWF0Y2hcIikge1xyXG4gICAgICAgICAgICBjb25zdCBmaW5hbFBhdGggPSB0aGlzLnJvdXRlVG9QYXRoKHJlc3VsdC5yb3V0ZSwgcmVzdWx0LnBhcmFtcyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzUG9wU3RhdGVFdmVudCA9IGV2ICYmIGV2IGluc3RhbmNlb2YgUG9wU3RhdGVFdmVudDtcclxuICAgICAgICAgICAgaWYgKCFpc1BvcFN0YXRlRXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2V0VXJsRnJvbVBhdGgoZmluYWxQYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRSb3V0ZSA9IHJlc3VsdC5yb3V0ZTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gcmVzdWx0LnBhcmFtcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocmVzdWx0LnR5cGUgPT09IFwibm9tYXRjaFwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFJvdXRlID0gbnVsbDtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFyYW1zID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGlkQ2hhbmdlID0gdGhpcy5jdXJyZW50Um91dGVOYW1lICE9PSBpbml0aWFsTmFtZSB8fCAhc2hhbGxvd0VxdWFsKHRoaXMuY3VycmVudFBhcmFtcywgaW5pdGlhbFBhcmFtcyk7XHJcbiAgICAgICAgaWYgKGRpZENoYW5nZSkge1xyXG4gICAgICAgICAgICB0aGlzLmVudi5xd2ViLmZvcmNlVXBkYXRlKCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbiAgICBkZXN0VG9QYXRoKGRlc3QpIHtcclxuICAgICAgICB0aGlzLnZhbGlkYXRlRGVzdGluYXRpb24oZGVzdCk7XHJcbiAgICAgICAgcmV0dXJuIGRlc3QucGF0aCB8fCB0aGlzLnJvdXRlVG9QYXRoKHRoaXMucm91dGVzW2Rlc3QudG9dLCBkZXN0LnBhcmFtcyk7XHJcbiAgICB9XHJcbiAgICBnZXQgY3VycmVudFJvdXRlTmFtZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50Um91dGUgJiYgdGhpcy5jdXJyZW50Um91dGUubmFtZTtcclxuICAgIH1cclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vIFByaXZhdGUgaGVscGVyc1xyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgc2V0VXJsRnJvbVBhdGgocGF0aCkge1xyXG4gICAgICAgIGNvbnN0IHNlcGFyYXRvciA9IHRoaXMubW9kZSA9PT0gXCJoYXNoXCIgPyBsb2NhdGlvbi5wYXRobmFtZSA6IFwiXCI7XHJcbiAgICAgICAgY29uc3QgdXJsID0gbG9jYXRpb24ub3JpZ2luICsgc2VwYXJhdG9yICsgcGF0aDtcclxuICAgICAgICBpZiAodXJsICE9PSB3aW5kb3cubG9jYXRpb24uaHJlZikge1xyXG4gICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoe30sIHBhdGgsIHVybCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgdmFsaWRhdGVEZXN0aW5hdGlvbihkZXN0KSB7XHJcbiAgICAgICAgaWYgKCghZGVzdC5wYXRoICYmICFkZXN0LnRvKSB8fCAoZGVzdC5wYXRoICYmIGRlc3QudG8pKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBkZXN0aW5hdGlvbjogJHtKU09OLnN0cmluZ2lmeShkZXN0KX1gKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByb3V0ZVRvUGF0aChyb3V0ZSwgcGFyYW1zKSB7XHJcbiAgICAgICAgY29uc3QgcGF0aCA9IHJvdXRlLnBhdGg7XHJcbiAgICAgICAgY29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KFwiL1wiKTtcclxuICAgICAgICBjb25zdCBsID0gcGFydHMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcnQgPSBwYXJ0c1tpXTtcclxuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBwYXJ0Lm1hdGNoKHBhcmFtUmVnZXhwKTtcclxuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBrZXkgPSBtYXRjaFsxXS5zcGxpdChcIi5cIilbMF07XHJcbiAgICAgICAgICAgICAgICBwYXJ0c1tpXSA9IHBhcmFtc1trZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHByZWZpeCA9IHRoaXMubW9kZSA9PT0gXCJoYXNoXCIgPyBcIiNcIiA6IFwiXCI7XHJcbiAgICAgICAgcmV0dXJuIHByZWZpeCArIHBhcnRzLmpvaW4oXCIvXCIpO1xyXG4gICAgfVxyXG4gICAgY3VycmVudFBhdGgoKSB7XHJcbiAgICAgICAgbGV0IHJlc3VsdCA9IHRoaXMubW9kZSA9PT0gXCJoaXN0b3J5XCIgPyB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgOiB3aW5kb3cubG9jYXRpb24uaGFzaC5zbGljZSgxKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0IHx8IFwiL1wiO1xyXG4gICAgfVxyXG4gICAgbWF0Y2gocGF0aCkge1xyXG4gICAgICAgIGZvciAobGV0IHJvdXRlSWQgb2YgdGhpcy5yb3V0ZUlkcykge1xyXG4gICAgICAgICAgICBsZXQgcm91dGUgPSB0aGlzLnJvdXRlc1tyb3V0ZUlkXTtcclxuICAgICAgICAgICAgbGV0IHBhcmFtcyA9IHRoaXMuZ2V0Um91dGVQYXJhbXMocm91dGUsIHBhdGgpO1xyXG4gICAgICAgICAgICBpZiAocGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibWF0Y2hcIixcclxuICAgICAgICAgICAgICAgICAgICByb3V0ZTogcm91dGUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1zOiBwYXJhbXNcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHsgdHlwZTogXCJub21hdGNoXCIgfTtcclxuICAgIH1cclxuICAgIGFzeW5jIG1hdGNoQW5kQXBwbHlSdWxlcyhwYXRoKSB7XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy5tYXRjaChwYXRoKTtcclxuICAgICAgICBpZiAocmVzdWx0LnR5cGUgPT09IFwibWF0Y2hcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hcHBseVJ1bGVzKHJlc3VsdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBhc3luYyBhcHBseVJ1bGVzKG1hdGNoUmVzdWx0KSB7XHJcbiAgICAgICAgY29uc3Qgcm91dGUgPSBtYXRjaFJlc3VsdC5yb3V0ZTtcclxuICAgICAgICBpZiAocm91dGUucmVkaXJlY3QpIHtcclxuICAgICAgICAgICAgY29uc3QgcGF0aCA9IHRoaXMuZGVzdFRvUGF0aChyb3V0ZS5yZWRpcmVjdCk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1hdGNoQW5kQXBwbHlSdWxlcyhwYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHJvdXRlLmJlZm9yZVJvdXRlRW50ZXIpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcm91dGUuYmVmb3JlUm91dGVFbnRlcih7XHJcbiAgICAgICAgICAgICAgICBlbnY6IHRoaXMuZW52LFxyXG4gICAgICAgICAgICAgICAgZnJvbTogdGhpcy5jdXJyZW50Um91dGUsXHJcbiAgICAgICAgICAgICAgICB0bzogcm91dGVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4geyB0eXBlOiBcImNhbmNlbGxlZFwiIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAocmVzdWx0ICE9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAvLyB3ZSB3YW50IHRvIG5hdmlnYXRlIHRvIGFub3RoZXIgZGVzdGluYXRpb25cclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhdGggPSB0aGlzLmRlc3RUb1BhdGgocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm1hdGNoQW5kQXBwbHlSdWxlcyhwYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbWF0Y2hSZXN1bHQ7XHJcbiAgICB9XHJcbiAgICBnZXRSb3V0ZVBhcmFtcyhyb3V0ZSwgcGF0aCkge1xyXG4gICAgICAgIGlmIChyb3V0ZS5wYXRoID09PSBcIipcIikge1xyXG4gICAgICAgICAgICByZXR1cm4ge307XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChwYXRoLnN0YXJ0c1dpdGgoXCIjXCIpKSB7XHJcbiAgICAgICAgICAgIHBhdGggPSBwYXRoLnNsaWNlKDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkZXNjclBhcnRzID0gcm91dGUucGF0aC5zcGxpdChcIi9cIik7XHJcbiAgICAgICAgY29uc3QgdGFyZ2V0UGFydHMgPSBwYXRoLnNwbGl0KFwiL1wiKTtcclxuICAgICAgICBjb25zdCBsID0gZGVzY3JQYXJ0cy5sZW5ndGg7XHJcbiAgICAgICAgaWYgKGwgIT09IHRhcmdldFBhcnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHt9O1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlc2NyID0gZGVzY3JQYXJ0c1tpXTtcclxuICAgICAgICAgICAgbGV0IHRhcmdldCA9IHRhcmdldFBhcnRzW2ldO1xyXG4gICAgICAgICAgICBjb25zdCBtYXRjaCA9IGRlc2NyLm1hdGNoKHBhcmFtUmVnZXhwKTtcclxuICAgICAgICAgICAgaWYgKG1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBba2V5LCBzdWZmaXhdID0gbWF0Y2hbMV0uc3BsaXQoXCIuXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHN1ZmZpeCA9PT0gXCJudW1iZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldCA9IHBhcnNlSW50KHRhcmdldCwgMTApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmVzdWx0W2tleV0gPSB0YXJnZXQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZGVzY3IgIT09IHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZmluZFBhcmFtcyhzdHIpIHtcclxuICAgIGNvbnN0IGdsb2JhbFBhcmFtUmVnZXhwID0gL1xce1xceyguKj8pXFx9XFx9L2c7XHJcbiAgICBjb25zdCByZXN1bHQgPSBbXTtcclxuICAgIGxldCBtO1xyXG4gICAgZG8ge1xyXG4gICAgICAgIG0gPSBnbG9iYWxQYXJhbVJlZ2V4cC5leGVjKHN0cik7XHJcbiAgICAgICAgaWYgKG0pIHtcclxuICAgICAgICAgICAgcmVzdWx0LnB1c2gobVsxXS5zcGxpdChcIi5cIilbMF0pO1xyXG4gICAgICAgIH1cclxuICAgIH0gd2hpbGUgKG0pO1xyXG4gICAgcmV0dXJuIHJlc3VsdDtcclxufVxuXG4vKipcclxuICogVGhpcyBmaWxlIGlzIHRoZSBtYWluIGZpbGUgcGFja2FnZWQgYnkgcm9sbHVwIChzZWUgcm9sbHVwLmNvbmZpZy5qcykuICBGcm9tXHJcbiAqIHRoaXMgZmlsZSwgd2UgZXhwb3J0IGFsbCBwdWJsaWMgb3dsIGVsZW1lbnRzLlxyXG4gKlxyXG4gKiBOb3RlIHRoYXQgZHluYW1pYyB2YWx1ZXMsIHN1Y2ggYXMgYSBkYXRlIG9yIGEgY29tbWl0IGhhc2ggYXJlIGFkZGVkIGJ5IHJvbGx1cFxyXG4gKi9cclxuY29uc3QgQ29udGV4dCQxID0gQ29udGV4dDtcclxuY29uc3QgdXNlU3RhdGUkMSA9IHVzZVN0YXRlO1xyXG5jb25zdCBjb3JlID0geyBFdmVudEJ1cywgT2JzZXJ2ZXIgfTtcclxuY29uc3Qgcm91dGVyID0geyBSb3V0ZXIsIFJvdXRlQ29tcG9uZW50LCBMaW5rIH07XHJcbmNvbnN0IFN0b3JlJDEgPSBTdG9yZTtcclxuY29uc3QgdXRpbHMgPSBfdXRpbHM7XHJcbmNvbnN0IHRhZ3MgPSBfdGFncztcclxuY29uc3QgbWlzYyA9IHsgQXN5bmNSb290LCBQb3J0YWwgfTtcclxuY29uc3QgaG9va3MkMSA9IE9iamVjdC5hc3NpZ24oe30sIF9ob29rcywge1xyXG4gICAgdXNlQ29udGV4dDogdXNlQ29udGV4dCxcclxuICAgIHVzZURpc3BhdGNoOiB1c2VEaXNwYXRjaCxcclxuICAgIHVzZUdldHRlcnM6IHVzZUdldHRlcnMsXHJcbiAgICB1c2VTdG9yZTogdXNlU3RvcmVcclxufSk7XHJcbmNvbnN0IF9faW5mb19fID0ge307XG5cbmV4cG9ydHMuQ29tcG9uZW50ID0gQ29tcG9uZW50O1xuZXhwb3J0cy5Db250ZXh0ID0gQ29udGV4dCQxO1xuZXhwb3J0cy5RV2ViID0gUVdlYjtcbmV4cG9ydHMuU3RvcmUgPSBTdG9yZSQxO1xuZXhwb3J0cy5fX2luZm9fXyA9IF9faW5mb19fO1xuZXhwb3J0cy5jb25maWcgPSBjb25maWc7XG5leHBvcnRzLmNvcmUgPSBjb3JlO1xuZXhwb3J0cy5ob29rcyA9IGhvb2tzJDE7XG5leHBvcnRzLm1pc2MgPSBtaXNjO1xuZXhwb3J0cy5yb3V0ZXIgPSByb3V0ZXI7XG5leHBvcnRzLnRhZ3MgPSB0YWdzO1xuZXhwb3J0cy51c2VTdGF0ZSA9IHVzZVN0YXRlJDE7XG5leHBvcnRzLnV0aWxzID0gdXRpbHM7XG5cbmV4cG9ydHMuX19pbmZvX18udmVyc2lvbiA9ICcxLjAuNyc7XG5leHBvcnRzLl9faW5mb19fLmRhdGUgPSAnMjAyMC0wNC0xN1QxMzo1Mzo1Ny41MDdaJztcbmV4cG9ydHMuX19pbmZvX18uaGFzaCA9ICcyM2NlMTllJztcbmV4cG9ydHMuX19pbmZvX18udXJsID0gJ2h0dHBzOi8vZ2l0aHViLmNvbS9vZG9vL293bCc7XG4iLCIvLyBJbXBvcnRzXG52YXIgX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fID0gcmVxdWlyZShcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIik7XG5leHBvcnRzID0gX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fKGZhbHNlKTtcbi8vIE1vZHVsZVxuZXhwb3J0cy5wdXNoKFttb2R1bGUuaWQsIFwianctZWRpdG9yIHtcXG4gICAgZGlzcGxheTogZmxleDtcXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcXG59XFxuXCIsIFwiXCJdKTtcbi8vIEV4cG9ydHNcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cztcbiIsIi8vIEltcG9ydHNcbnZhciBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gPSByZXF1aXJlKFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiKTtcbmV4cG9ydHMgPSBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18oZmFsc2UpO1xuLy8gTW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCIvKiBHTE9CQUwgKi9cXG5cXG5qdy1kZXZ0b29scyB7XFxuICAgIGJvdHRvbTogMDtcXG4gICAgbWluLWhlaWdodDogMzBweDtcXG4gICAgbWF4LWhlaWdodDogMTAwJTtcXG4gICAgdG9wOiBhdXRvO1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcXG4gICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNkMGQwZDA7XFxuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxuICAgIGRpc3BsYXk6IGZsZXg7XFxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XFxuICAgIGFsaWduLWl0ZW1zOiBzdHJldGNoO1xcbiAgICB1c2VyLXNlbGVjdDogbm9uZTtcXG4gICAgb3V0bGluZTogbm9uZTtcXG59XFxuXFxuZGV2dG9vbHMtdGFibGUge1xcbiAgICBkaXNwbGF5OiB0YWJsZTtcXG59XFxuZGV2dG9vbHMtdGJvZHkge1xcbiAgICBkaXNwbGF5OiB0YWJsZS1yb3ctZ3JvdXA7XFxufVxcbmRldnRvb2xzLXRyIHtcXG4gICAgZGlzcGxheTogdGFibGUtcm93O1xcbn1cXG5kZXZ0b29scy10ZCB7XFxuICAgIGRpc3BsYXk6IHRhYmxlLWNlbGw7XFxuICAgIHBhZGRpbmctcmlnaHQ6IDI1cHg7XFxufVxcbmRldnRvb2xzLWJ1dHRvbiB7XFxuICAgIGRpc3BsYXk6IGlubGluZTtcXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydDtcXG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcXG4gICAgbGluZS1oZWlnaHQ6IDJlbTtcXG4gICAgZm9udC1mYW1pbHk6IGluaXRpYWw7XFxufVxcbmRldnRvb2xzLWxpc3Qge1xcbiAgICBkaXNwbGF5OiBibG9jaztcXG4gICAgbGlzdC1zdHlsZTogbm9uZTtcXG59XFxuZGV2dG9vbHMtbGlzdGl0ZW0ge1xcbiAgICBkaXNwbGF5OiBsaXN0LWl0ZW07XFxufVxcblxcbmp3LWRldnRvb2xzLmNsb3NlZCB7XFxuICAgIG1heC1oZWlnaHQ6IDMxcHg7XFxufVxcblxcbmp3LWRldnRvb2xzIC5ib2xkIHtcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxufVxcblxcbmp3LWRldnRvb2xzIC5pdGFsaWMge1xcbiAgICBmb250LXN0eWxlOiBpdGFsaWM7XFxufVxcblxcbmp3LWRldnRvb2xzIC51bmRlcmxpbmUge1xcbiAgICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTtcXG59XFxuXFxuanctZGV2dG9vbHMgLmxpbmsge1xcbiAgICB0ZXh0LWRlY29yYXRpb246IHVuZGVybGluZTtcXG4gICAgY29sb3I6IGJsdWU7XFxufVxcblxcbmp3LWRldnRvb2xzIC5zdWJzY3JpcHQge1xcbiAgICB2ZXJ0aWNhbC1hbGlnbjogc3ViO1xcbiAgICBmb250LXNpemU6IDAuN2VtO1xcbn1cXG5cXG5qdy1kZXZ0b29scyAuc3VwZXJzY3JpcHQge1xcbiAgICB2ZXJ0aWNhbC1hbGlnbjogc3VwZXI7XFxuICAgIGZvbnQtc2l6ZTogMC43ZW07XFxufVxcblxcbmp3LWRldnRvb2xzIC5tYXJrZXItbm9kZSB7XFxuICAgIGNvbG9yOiByZWQ7XFxufVxcblxcbmRldnRvb2xzLXBhbmVsIHtcXG4gICAgZGlzcGxheTogZmxleDtcXG4gICAgb3ZlcmZsb3c6IGF1dG87XFxufVxcblxcbmRldnRvb2xzLXBhbmVsOm5vdCguYWN0aXZlKSB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbmRldnRvb2xzLXBhbmVsIC5zZWxlY3RhYmxlLWxpbmU6aG92ZXIge1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDExOCwgODIsIDEwOCwgMC4yKTtcXG59XFxuXFxuZGV2dG9vbHMtcGFuZWwgLnNlbGVjdGFibGUtbGluZS5zZWxlY3RlZCB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMTE4LCA4MiwgMTA4LCAwLjMpO1xcbn1cXG5cXG5kZXZ0b29scy1wYW5lbCBkZXZ0b29scy1idXR0b24ubG9nZ2VyIHtcXG4gICAgZmxvYXQ6IHJpZ2h0O1xcbiAgICBib3JkZXI6IG5vbmU7XFxuICAgIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50O1xcbiAgICBjb2xvcjogIzY2NjY2NjtcXG4gICAgcGFkZGluZzogMDtcXG4gICAgbWFyZ2luOiAwO1xcbiAgICBkaXNwbGF5OiBub25lO1xcbiAgICBsaW5lLWhlaWdodDogMC43ZW07XFxufVxcblxcbmRldnRvb2xzLXBhbmVsIGRldnRvb2xzLWFib3V0ID4gZGV2dG9vbHMtYnV0dG9uLmxvZ2dlciB7XFxuICAgIGRpc3BsYXk6IGlubGluZTtcXG4gICAgbWFyZ2luLWxlZnQ6IDFlbTtcXG59XFxuXFxuZGV2dG9vbHMtcGFuZWwgLnNlbGVjdGFibGUtbGluZTpob3ZlciBkZXZ0b29scy1idXR0b24ubG9nZ2VyLCBkZXZ0b29scy1wYW5lbCAuc2VsZWN0ZWQgZGV2dG9vbHMtYnV0dG9uLmxvZ2dlciB7XFxuICAgIGRpc3BsYXk6IGlubGluZTtcXG59XFxuXFxuLyogTkFWQkFSICovXFxuXFxuanctZGV2dG9vbHM6bm90KC5jbG9zZWQpID4gZGV2dG9vbHMtbmF2YmFyIHtcXG4gICAgY3Vyc29yOiByb3ctcmVzaXplO1xcbn1cXG5cXG5kZXZ0b29scy1uYXZiYXIge1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjNmM2YzO1xcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XFxuICAgIGRpc3BsYXk6IGZsZXg7XFxuICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XFxuICAgIGZsZXgtd3JhcDogbm93cmFwO1xcbiAgICBoZWlnaHQ6IDMwcHg7XFxuICAgIG1pbi1oZWlnaHQ6IDMwcHg7XFxuICAgIHdpZHRoOiAxMDAlO1xcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xcbiAgICBib3JkZXI6IDA7XFxuICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZDBkMGQwO1xcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgICB2ZXJ0aWNhbC1hbGlnbjogYmFzZWxpbmU7XFxufVxcblxcbmRldnRvb2xzLW5hdmJhciA+IGRldnRvb2xzLWJ1dHRvbiB7XFxuICAgIHBhZGRpbmc6IDAgMTBweCAwIDEwcHg7XFxuICAgIGJhY2tncm91bmQ6IG5vbmU7XFxuICAgIGJvcmRlcjogMDtcXG4gICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcXG4gICAgb3V0bGluZTogbm9uZTtcXG4gICAgY3Vyc29yOiBhdXRvO1xcbn1cXG5cXG5kZXZ0b29scy1uYXZiYXIgPiBkZXZ0b29scy1idXR0b246aG92ZXIge1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZDZkNmQ2O1xcbn1cXG5cXG5kZXZ0b29scy1uYXZiYXIgPiBkZXZ0b29scy1idXR0b24uc2VsZWN0ZWQge1xcbiAgICBib3JkZXItYm90dG9tOiBzb2xpZCAycHggIzc2NTI2YztcXG59XFxuXFxuLyogQ09OVEVOVFMgKi9cXG5cXG5kZXZ0b29scy1jb250ZW50cyB7XFxuICAgIGRpc3BsYXk6IGZsZXg7XFxuICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XFxuICAgIGZsZXg6IDE7XFxuICAgIG92ZXJmbG93OiBhdXRvO1xcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XFxuICAgIGZvbnQtZmFtaWx5OiAnQ291cmllciBOZXcnLCBDb3VyaWVyLCBtb25vc3BhY2U7XFxufVxcblxcbi8qIG1haW5wYW5lICovXFxuXFxuZGV2dG9vbHMtbWFpbnBhbmUge1xcbiAgICBkaXNwbGF5OiBmbGV4O1xcbiAgICBvdmVyZmxvdzogYXV0bztcXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcXG4gICAgd2lkdGg6IDEwMCU7XFxufVxcblxcbm1haW5wYW5lLWNvbnRlbnRzIHtcXG4gICAgb3ZlcmZsb3c6IGF1dG87XFxuICAgIGZsZXg6IDE7XFxuICAgIHBhZGRpbmc6IDFlbTtcXG59XFxuXFxubWFpbnBhbmUtY29udGVudHMgPiBkZXZ0b29scy10YWJsZSBkZXZ0b29scy10ZDpudGgtY2hpbGQoMSkgIHtcXG4gICAgd2lkdGg6IDEwMHB4O1xcbn1cXG5cXG5kZXZ0b29scy1jb21tYW5kIHtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxufVxcblxcbi8qIHRyZWUgKi9cXG5cXG5kZXZ0b29scy10cmVlIHtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICAgIGZsZXgtZ3JvdzogMTtcXG4gICAgd2lkdGg6IDEwMCU7XFxufVxcblxcbmRldnRvb2xzLXRyZWUgZGV2dG9vbHMtY2hpbGRyZW4ge1xcbiAgICBkaXNwbGF5OiBibG9jaztcXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xcbiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xcbiAgICBwYWRkaW5nOiAxcHggMCAxcHggMS41ZW07XFxuICAgIGJvcmRlci1sZWZ0OiAxcHggc29saWQgI2QwZDBkMDtcXG59XFxuXFxuZGV2dG9vbHMtdHJlZSBkaXYge1xcbiAgICB3aWR0aDogMTAwJTtcXG59XFxuXFxuZGV2dG9vbHMtdHJlZSA+IGRldnRvb2xzLW5vZGUucm9vdCA+IGRldnRvb2xzLW5vZGVuYW1lIHtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzc2NTI2YztcXG4gICAgY29sb3I6IHdoaXRlO1xcbiAgICBwYWRkaW5nLWxlZnQ6IDVweDtcXG4gICAgYm94LXNpemluZzogYm9yZGVyLWJveDtcXG59XFxuXFxuanctZGV2dG9vbHMgZGV2dG9vbHMtbm9kZW5hbWUuaW5saW5lIHtcXG4gICAgZGlzcGxheTogaW5saW5lO1xcbn1cXG5cXG5kZXZ0b29scy10cmVlIGRldnRvb2xzLW5vZGVuYW1lLmJsb2NrIHtcXG4gICAgY29sb3I6ICM3NjUyNmM7XFxuICAgIHdpZHRoOiAxMDAlO1xcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxufVxcblxcbmRldnRvb2xzLXRyZWUgZGV2dG9vbHMtbm9kZW5hbWUubGluZS1icmVhazphZnRlciB7XFxuICAgIGNvbnRlbnQ6ICdcXFxcQSc7XFxuICAgIHdoaXRlLXNwYWNlOiBwcmU7XFxufVxcblxcbmRldnRvb2xzLW5vZGUge1xcbiAgICBvdXRsaW5lOiBub25lO1xcbn1cXG5cXG5kZXZ0b29scy1ub2RlOm5vdCguZm9sZGVkKTpub3QoLnNlbGYtY2xvc2luZyk6bm90KC5yb290KSA+IGRldnRvb2xzLW5vZGVuYW1lLmJsb2NrOmJlZm9yZSB7XFxuICAgIGNvbnRlbnQ6ICfijIQgJztcXG59XFxuXFxuZGV2dG9vbHMtbm9kZS5mb2xkZWQ6bm90KC5zZWxmLWNsb3NpbmcpID4gZGV2dG9vbHMtbm9kZW5hbWUuYmxvY2s6YmVmb3JlIHtcXG4gICAgY29udGVudDogJ+KAuiAnO1xcbn1cXG5cXG5kZXZ0b29scy1ub2RlLmZvbGRlZCBkZXZ0b29scy1jaGlsZHJlbiB7XFxuICAgIGRpc3BsYXk6IG5vbmU7XFxufVxcblxcbmRldnRvb2xzLXBhdGgge1xcbiAgICBkaXNwbGF5OiBibG9jaztcXG4gICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNkMGQwZDA7XFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNkZGRkZGQ7XFxuICAgIC8qIHBvc2l0aW9uOiBmaXhlZDsgKi9cXG4gICAgYm90dG9tOiAwO1xcbiAgICBsZWZ0OiAwO1xcbiAgICByaWdodDogMDtcXG59XFxuXFxuZGV2dG9vbHMtcGF0aG5vZGUge1xcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICAgIHBhZGRpbmc6IC4yZW0gMWVtIC4yZW0gMWVtO1xcbiAgICBjb2xvcjogIzY5Njk2OTtcXG4gICAgZm9udC1zaXplOiAxM3B4O1xcbn1cXG5cXG5kZXZ0b29scy1wYXRobm9kZTpob3ZlciB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNkNmQ2ZDY7XFxufVxcblxcbmRldnRvb2xzLXBhdGhub2RlLnNlbGVjdGVkIHtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2QwZDBkMDtcXG59XFxuXFxuLyogc2lkZXBhbmUgKi9cXG5cXG5kZXZ0b29scy1zaWRlcGFuZSB7XFxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG4gICAgb3ZlcmZsb3c6IGF1dG87XFxuICAgIGRpc3BsYXk6IGJsb2NrO1xcbiAgICBmb250LXNpemU6IDE1cHg7XFxuICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7XFxuICAgIHdpZHRoOiAzMCU7XFxuICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xcbiAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkICNkMGQwZDA7XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLWFib3V0IHtcXG4gICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNkMGQwZDA7XFxuICAgIHBhZGRpbmc6IDEwcHg7XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLWFib3V0IGRldnRvb2xzLXR5cGUge1xcbiAgICBmb250LWZhbWlseTogaW5pdGlhbDtcXG4gICAgZm9udC1zdHlsZTogaXRhbGljO1xcbiAgICBmb250LXNpemU6IHNtYWxsZXI7XFxuICAgIGNvbG9yOiAjNzY1MjZjO1xcbiAgICBwYWRkaW5nLXJpZ2h0OiAuNWVtO1xcbn1cXG5cXG5kZXZ0b29scy1zaWRlcGFuZSBkZXZ0b29scy1wcm9wZXJ0aWVzIHtcXG4gICAgZm9udC1zaXplOiAxMnB4O1xcbiAgICBwYWRkaW5nOiAxMHB4O1xcbiAgICBvdmVyZmxvdzogYXV0bztcXG4gICAgbWFyZ2luLWJvdHRvbTogMzBweDtcXG59XFxuXFxuZGV2dG9vbHMtaW5mb3RpdGxlIHtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLXByb3BlcnRpZXMgZGV2dG9vbHMtaW5mb3RpdGxlIHtcXG4gICAgcGFkZGluZzogMWVtO1xcbiAgICBmb250LWZhbWlseTogaW5pdGlhbDtcXG4gICAgZm9udC1zaXplOiBsYXJnZXI7XFxuICAgIGNvbG9yOiAjMzgyMDM0O1xcbn1cXG5cXG5kZXZ0b29scy1zaWRlcGFuZSBkZXZ0b29scy1wcm9wZXJ0aWVzIGRldnRvb2xzLWluZm90aXRsZTpmaXJzdC1jaGlsZCB7XFxuICAgIHBhZGRpbmctdG9wOiAwZW07XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLXByb3BlcnRpZXMgZGV2dG9vbHMtdGFibGUge1xcbiAgICB3aWR0aDogMTAwJTtcXG4gICAgZm9udC1zaXplOiBpbmhlcml0O1xcbn1cXG5cXG5kZXZ0b29scy1zaWRlcGFuZSBkZXZ0b29scy1wcm9wZXJ0aWVzIGRldnRvb2xzLXRhYmxlIGRldnRvb2xzLXRib2R5e1xcbiAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wO1xcbn1cXG5cXG5kZXZ0b29scy1zaWRlcGFuZSBkZXZ0b29scy1wcm9wZXJ0aWVzIGRldnRvb2xzLXRhYmxlIGRldnRvb2xzLXRkIHtcXG4gICAgcGFkZGluZzogMC4zZW07XFxufVxcblxcbmRldnRvb2xzLXNpZGVwYW5lIGRldnRvb2xzLXByb3BlcnRpZXMgZGV2dG9vbHMtdGFibGUgZGV2dG9vbHMtdGQ6bnRoLWNoaWxkKDEpIHtcXG4gICAgd2lkdGg6IDEwMHB4O1xcbn1cXG5cXG5kZXZ0b29scy1zaWRlcGFuZSBkZXZ0b29scy1wcm9wZXJ0aWVzIGRldnRvb2xzLXRhYmxlIGRldnRvb2xzLWxpc3Qge1xcbiAgICBsaXN0LXN0eWxlLXBvc2l0aW9uOiBpbnNpZGU7XFxuICAgIHBhZGRpbmctbGVmdDogMDtcXG4gICAgbWFyZ2luOiAwO1xcbn1cXG5cXG5kZXZ0b29scy1zaWRlcGFuZSBkZXZ0b29scy1wcm9wZXJ0aWVzID4gZGV2dG9vbHMtdGFibGUgPiBkZXZ0b29scy10Ym9keSA+IGRldnRvb2xzLXRyOm50aC1jaGlsZChldmVuKSB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNmNGY0ZjQ7XFxufVxcblxcbmRldnRvb2xzLWluZm8ge1xcbiAgICBkaXNwbGF5OiBmbGV4O1xcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xcbn1cXG5cXG5kZXZ0b29scy1pbmZvIGRldnRvb2xzLWFib3V0IGRldnRvb2xzLWlkIHtcXG4gICAgZmxvYXQ6IHJpZ2h0O1xcbiAgICBjb2xvcjogIzc2NTI2YztcXG4gICAgZm9udC1zaXplOiBzbWFsbGVyO1xcbn1cXG5cIiwgXCJcIl0pO1xuLy8gRXhwb3J0c1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzO1xuIiwiLy8gSW1wb3J0c1xudmFyIF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyA9IHJlcXVpcmUoXCIuLi8uLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCIpO1xuZXhwb3J0cyA9IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyhmYWxzZSk7XG4vLyBNb2R1bGVcbmV4cG9ydHMucHVzaChbbW9kdWxlLmlkLCBcImp3LWRpYWxvZy1jb250YWluZXIge1xcbiAgICBwb3NpdGlvbjogZml4ZWQ7XFxuICAgIHRvcDogMDtcXG4gICAgbGVmdDogMDtcXG4gICAgd2lkdGg6IDEwMCU7XFxuICAgIGhlaWdodDogMTAwJTtcXG4gICAgZGlzcGxheTogZmxleDtcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XFxufVxcbmp3LWRpYWxvZy1jb250YWluZXIganctYmFja2Ryb3Age1xcbiAgICBwb3NpdGlvbjogZml4ZWQ7XFxuICAgIHRvcDogMDtcXG4gICAgbGVmdDogMDtcXG4gICAgd2lkdGg6IDEwMCU7XFxuICAgIGhlaWdodDogMTAwJTtcXG4gICAgb3BhY2l0eTogMC41O1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDAwMDAwO1xcbn1cXG5qdy1kaWFsb2ctY29udGFpbmVyIGp3LWRpYWxvZyB7XFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gICAgZGlzcGxheTogZmxleDtcXG4gICAgbWF4LXdpZHRoOiA4MCU7XFxufVxcbmp3LWRpYWxvZy1jb250YWluZXIganctZGlhbG9nID4ganctY29udGVudCB7XFxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcXG4gICAgZGlzcGxheTogZmxleDtcXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI0Y3RjdGNztcXG4gICAgcGFkZGluZzogMTBweDtcXG4gICAgYm9yZGVyLXJhZGl1czogMTBweDtcXG59XFxuanctZGlhbG9nLWNvbnRhaW5lciBqdy1kaWFsb2cgPiBqdy1jb250ZW50ID4ganctYnV0dG9uLmNsb3NlIHtcXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgICByaWdodDogMTBweDtcXG4gICAgdG9wOiA0cHg7XFxuICAgIGN1cnNvcjogcG9pbnRlcjtcXG59XFxuanctZGlhbG9nLWNvbnRhaW5lciBqdy1kaWFsb2cgdGFibGUuZm9ybS10YWJsZSB7XFxuICAgIGJvcmRlcjogbm9uZTtcXG59XFxuanctZGlhbG9nLWNvbnRhaW5lciBqdy1kaWFsb2cgdGFibGUuZm9ybS10YWJsZSB0ZCB7XFxuICAgIGJvcmRlcjogbm9uZTtcXG59XFxuXCIsIFwiXCJdKTtcbi8vIEV4cG9ydHNcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0cztcbiIsIi8vIEltcG9ydHNcbnZhciBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gPSByZXF1aXJlKFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiKTtcbmV4cG9ydHMgPSBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18oZmFsc2UpO1xuLy8gTW9kdWxlXG5leHBvcnRzLnB1c2goW21vZHVsZS5pZCwgXCJqdy10b29sYmFyIHtcXG4gICAgZGlzcGxheTogYmxvY2s7XFxuICAgIG1pbi1oZWlnaHQ6IDE0cHg7XFxuICAgIGJhY2tncm91bmQtY29sb3I6ICM4NzVBN0I7XFxuICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjNjg0NjVmO1xcbiAgICBjb2xvcjogd2hpdGU7XFxuICAgIG92ZXJmbG93OiBoaWRkZW47XFxuICAgIGZvbnQtZmFtaWx5OiBcXFwiTW9udHNlcnJhdFxcXCIsIHNhbnMtc2VyaWY7XFxuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcXG4gICAgd2lkdGg6IDEwMCU7XFxufVxcblxcbi5qdy1wcmltYXJ5LWJ1dHRvbiB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6ICMwMEEwOUQ7XFxuICAgIGNvbG9yOiB3aGl0ZTtcXG59XFxuXFxuanctdG9vbGJhciBzcGFuIHtcXG4gICAgZm9udC13ZWlnaHQ6IDYwMDtcXG4gICAgcGFkZGluZzogNXB4O1xcbn1cXG5cXG5qdy10b29sYmFyIC5wcmVzc2VkIHtcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogIzljODg5NztcXG4gICAgY29sb3I6IHdoaXRlO1xcbn1cXG5cXG5qdy10b29sYmFyIGp3LXNlcGFyYXRvciB7XFxuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2MxYThiYTtcXG4gICAgaGVpZ2h0OiAzMHB4O1xcbiAgICB3aWR0aDogMXB4O1xcbiAgICBtYXJnaW4tbGVmdDogMnB4O1xcbiAgICBtYXJnaW4tcmlnaHQ6IDJweDtcXG4gICAgbWFyZ2luLXRvcDogNXB4O1xcbiAgICBtYXJnaW4tYm90dG9tOiA1cHg7XFxuICAgIHZlcnRpY2FsLWFsaWduOiBib3R0b207XFxufVxcblxcbmp3LXRvb2xiYXIgdG9vbGJhci1ncm91cCBqdy1zZXBhcmF0b3Ige1xcbiAgICBtYXJnaW4tdG9wOiAwO1xcbiAgICBtYXJnaW4tYm90dG9tOiAwO1xcbn1cXG5cXG5qdy10b29sYmFyIHRvb2xiYXItZ3JvdXAge1xcbiAgICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XFxuICAgIG1hcmdpbjogNXB4O1xcbn1cXG5cXG5qdy10b29sYmFyIHNlbGVjdCwganctdG9vbGJhciBvcHRpb24ge1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB3aGl0ZTtcXG4gICAgYm9yZGVyOiAxcHggc29saWQgIzY4NDY1ZjtcXG4gICAgcGFkZGluZzogNXB4O1xcbiAgICBoZWlnaHQ6IDMwcHggIWltcG9ydGFudDtcXG59XFxuXFxuanctdG9vbGJhciBvcHRpb246ZGlzYWJsZWQge1xcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjODc1QTdCO1xcbiAgICBjb2xvcjogd2hpdGU7XFxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xcbn1cXG5cXG5qdy10b29sYmFyIGJ1dHRvbiB7XFxuICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlO1xcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjNjg0NjVmO1xcbiAgICBwYWRkaW5nOiA1cHg7XFxuICAgIHdpZHRoOiAzMHB4ICFpbXBvcnRhbnQ7XFxuICAgIGhlaWdodDogMzBweCAhaW1wb3J0YW50O1xcbn1cXG5cXG5qdy10b29sYmFyIC5oMSB7XFxuICAgIGZvbnQtc2l6ZTogMmVtO1xcbiAgICBmb250LXdlaWdodDogYm9sZDtcXG59XFxuanctdG9vbGJhciAuaDIge1xcbiAgICBmb250LXNpemU6IDEuNWVtO1xcbiAgICBmb250LXdlaWdodDogYm9sZDtcXG59XFxuanctdG9vbGJhciAuaDMge1xcbiAgICBmb250LXNpemU6IDEuMTdlbTtcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxufVxcbmp3LXRvb2xiYXIgLmg0IHtcXG4gICAgZm9udC1zaXplOiAxZW07XFxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xcbn1cXG5qdy10b29sYmFyIC5oNSB7XFxuICAgIGZvbnQtc2l6ZTogMC44M2VtO1xcbiAgICBmb250LXdlaWdodDogYm9sZDtcXG59XFxuanctdG9vbGJhciAuaDYge1xcbiAgICBmb250LXNpemU6IDAuNjdlbTtcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxufVxcblwiLCBcIlwiXSk7XG4vLyBFeHBvcnRzXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHM7XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuLypcbiAgTUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcbiAgQXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxuKi9cbi8vIGNzcyBiYXNlIGNvZGUsIGluamVjdGVkIGJ5IHRoZSBjc3MtbG9hZGVyXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZnVuYy1uYW1lc1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAodXNlU291cmNlTWFwKSB7XG4gIHZhciBsaXN0ID0gW107IC8vIHJldHVybiB0aGUgbGlzdCBvZiBtb2R1bGVzIGFzIGNzcyBzdHJpbmdcblxuICBsaXN0LnRvU3RyaW5nID0gZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICB2YXIgY29udGVudCA9IGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcoaXRlbSwgdXNlU291cmNlTWFwKTtcblxuICAgICAgaWYgKGl0ZW1bMl0pIHtcbiAgICAgICAgcmV0dXJuIFwiQG1lZGlhIFwiLmNvbmNhdChpdGVtWzJdLCBcIiB7XCIpLmNvbmNhdChjb250ZW50LCBcIn1cIik7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH0pLmpvaW4oJycpO1xuICB9OyAvLyBpbXBvcnQgYSBsaXN0IG9mIG1vZHVsZXMgaW50byB0aGUgbGlzdFxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZnVuYy1uYW1lc1xuXG5cbiAgbGlzdC5pID0gZnVuY3Rpb24gKG1vZHVsZXMsIG1lZGlhUXVlcnksIGRlZHVwZSkge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlcyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wYXJhbS1yZWFzc2lnblxuICAgICAgbW9kdWxlcyA9IFtbbnVsbCwgbW9kdWxlcywgJyddXTtcbiAgICB9XG5cbiAgICB2YXIgYWxyZWFkeUltcG9ydGVkTW9kdWxlcyA9IHt9O1xuXG4gICAgaWYgKGRlZHVwZSkge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBwcmVmZXItZGVzdHJ1Y3R1cmluZ1xuICAgICAgICB2YXIgaWQgPSB0aGlzW2ldWzBdO1xuXG4gICAgICAgIGlmIChpZCAhPSBudWxsKSB7XG4gICAgICAgICAgYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IG1vZHVsZXMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICB2YXIgaXRlbSA9IFtdLmNvbmNhdChtb2R1bGVzW19pXSk7XG5cbiAgICAgIGlmIChkZWR1cGUgJiYgYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpdGVtWzBdXSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29udGludWVcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChtZWRpYVF1ZXJ5KSB7XG4gICAgICAgIGlmICghaXRlbVsyXSkge1xuICAgICAgICAgIGl0ZW1bMl0gPSBtZWRpYVF1ZXJ5O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGl0ZW1bMl0gPSBcIlwiLmNvbmNhdChtZWRpYVF1ZXJ5LCBcIiBhbmQgXCIpLmNvbmNhdChpdGVtWzJdKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBsaXN0LnB1c2goaXRlbSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBsaXN0O1xufTtcblxuZnVuY3Rpb24gY3NzV2l0aE1hcHBpbmdUb1N0cmluZyhpdGVtLCB1c2VTb3VyY2VNYXApIHtcbiAgdmFyIGNvbnRlbnQgPSBpdGVtWzFdIHx8ICcnOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWRlc3RydWN0dXJpbmdcblxuICB2YXIgY3NzTWFwcGluZyA9IGl0ZW1bM107XG5cbiAgaWYgKCFjc3NNYXBwaW5nKSB7XG4gICAgcmV0dXJuIGNvbnRlbnQ7XG4gIH1cblxuICBpZiAodXNlU291cmNlTWFwICYmIHR5cGVvZiBidG9hID09PSAnZnVuY3Rpb24nKSB7XG4gICAgdmFyIHNvdXJjZU1hcHBpbmcgPSB0b0NvbW1lbnQoY3NzTWFwcGluZyk7XG4gICAgdmFyIHNvdXJjZVVSTHMgPSBjc3NNYXBwaW5nLnNvdXJjZXMubWFwKGZ1bmN0aW9uIChzb3VyY2UpIHtcbiAgICAgIHJldHVybiBcIi8qIyBzb3VyY2VVUkw9XCIuY29uY2F0KGNzc01hcHBpbmcuc291cmNlUm9vdCB8fCAnJykuY29uY2F0KHNvdXJjZSwgXCIgKi9cIik7XG4gICAgfSk7XG4gICAgcmV0dXJuIFtjb250ZW50XS5jb25jYXQoc291cmNlVVJMcykuY29uY2F0KFtzb3VyY2VNYXBwaW5nXSkuam9pbignXFxuJyk7XG4gIH1cblxuICByZXR1cm4gW2NvbnRlbnRdLmpvaW4oJ1xcbicpO1xufSAvLyBBZGFwdGVkIGZyb20gY29udmVydC1zb3VyY2UtbWFwIChNSVQpXG5cblxuZnVuY3Rpb24gdG9Db21tZW50KHNvdXJjZU1hcCkge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcbiAgdmFyIGJhc2U2NCA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHNvdXJjZU1hcCkpKSk7XG4gIHZhciBkYXRhID0gXCJzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04O2Jhc2U2NCxcIi5jb25jYXQoYmFzZTY0KTtcbiAgcmV0dXJuIFwiLyojIFwiLmNvbmNhdChkYXRhLCBcIiAqL1wiKTtcbn0iLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIGlzT2xkSUUgPSBmdW5jdGlvbiBpc09sZElFKCkge1xuICB2YXIgbWVtbztcbiAgcmV0dXJuIGZ1bmN0aW9uIG1lbW9yaXplKCkge1xuICAgIGlmICh0eXBlb2YgbWVtbyA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIC8vIFRlc3QgZm9yIElFIDw9IDkgYXMgcHJvcG9zZWQgYnkgQnJvd3NlcmhhY2tzXG4gICAgICAvLyBAc2VlIGh0dHA6Ly9icm93c2VyaGFja3MuY29tLyNoYWNrLWU3MWQ4NjkyZjY1MzM0MTczZmVlNzE1YzIyMmNiODA1XG4gICAgICAvLyBUZXN0cyBmb3IgZXhpc3RlbmNlIG9mIHN0YW5kYXJkIGdsb2JhbHMgaXMgdG8gYWxsb3cgc3R5bGUtbG9hZGVyXG4gICAgICAvLyB0byBvcGVyYXRlIGNvcnJlY3RseSBpbnRvIG5vbi1zdGFuZGFyZCBlbnZpcm9ubWVudHNcbiAgICAgIC8vIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2stY29udHJpYi9zdHlsZS1sb2FkZXIvaXNzdWVzLzE3N1xuICAgICAgbWVtbyA9IEJvb2xlYW4od2luZG93ICYmIGRvY3VtZW50ICYmIGRvY3VtZW50LmFsbCAmJiAhd2luZG93LmF0b2IpO1xuICAgIH1cblxuICAgIHJldHVybiBtZW1vO1xuICB9O1xufSgpO1xuXG52YXIgZ2V0VGFyZ2V0ID0gZnVuY3Rpb24gZ2V0VGFyZ2V0KCkge1xuICB2YXIgbWVtbyA9IHt9O1xuICByZXR1cm4gZnVuY3Rpb24gbWVtb3JpemUodGFyZ2V0KSB7XG4gICAgaWYgKHR5cGVvZiBtZW1vW3RhcmdldF0gPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICB2YXIgc3R5bGVUYXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRhcmdldCk7IC8vIFNwZWNpYWwgY2FzZSB0byByZXR1cm4gaGVhZCBvZiBpZnJhbWUgaW5zdGVhZCBvZiBpZnJhbWUgaXRzZWxmXG5cbiAgICAgIGlmICh3aW5kb3cuSFRNTElGcmFtZUVsZW1lbnQgJiYgc3R5bGVUYXJnZXQgaW5zdGFuY2VvZiB3aW5kb3cuSFRNTElGcmFtZUVsZW1lbnQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBUaGlzIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uIGlmIGFjY2VzcyB0byBpZnJhbWUgaXMgYmxvY2tlZFxuICAgICAgICAgIC8vIGR1ZSB0byBjcm9zcy1vcmlnaW4gcmVzdHJpY3Rpb25zXG4gICAgICAgICAgc3R5bGVUYXJnZXQgPSBzdHlsZVRhcmdldC5jb250ZW50RG9jdW1lbnQuaGVhZDtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIC8vIGlzdGFuYnVsIGlnbm9yZSBuZXh0XG4gICAgICAgICAgc3R5bGVUYXJnZXQgPSBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIG1lbW9bdGFyZ2V0XSA9IHN0eWxlVGFyZ2V0O1xuICAgIH1cblxuICAgIHJldHVybiBtZW1vW3RhcmdldF07XG4gIH07XG59KCk7XG5cbnZhciBzdHlsZXNJbkRvbSA9IFtdO1xuXG5mdW5jdGlvbiBnZXRJbmRleEJ5SWRlbnRpZmllcihpZGVudGlmaWVyKSB7XG4gIHZhciByZXN1bHQgPSAtMTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0eWxlc0luRG9tLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHN0eWxlc0luRG9tW2ldLmlkZW50aWZpZXIgPT09IGlkZW50aWZpZXIpIHtcbiAgICAgIHJlc3VsdCA9IGk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBtb2R1bGVzVG9Eb20obGlzdCwgb3B0aW9ucykge1xuICB2YXIgaWRDb3VudE1hcCA9IHt9O1xuICB2YXIgaWRlbnRpZmllcnMgPSBbXTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgaXRlbSA9IGxpc3RbaV07XG4gICAgdmFyIGlkID0gb3B0aW9ucy5iYXNlID8gaXRlbVswXSArIG9wdGlvbnMuYmFzZSA6IGl0ZW1bMF07XG4gICAgdmFyIGNvdW50ID0gaWRDb3VudE1hcFtpZF0gfHwgMDtcbiAgICB2YXIgaWRlbnRpZmllciA9IFwiXCIuY29uY2F0KGlkLCBcIiBcIikuY29uY2F0KGNvdW50KTtcbiAgICBpZENvdW50TWFwW2lkXSA9IGNvdW50ICsgMTtcbiAgICB2YXIgaW5kZXggPSBnZXRJbmRleEJ5SWRlbnRpZmllcihpZGVudGlmaWVyKTtcbiAgICB2YXIgb2JqID0ge1xuICAgICAgY3NzOiBpdGVtWzFdLFxuICAgICAgbWVkaWE6IGl0ZW1bMl0sXG4gICAgICBzb3VyY2VNYXA6IGl0ZW1bM11cbiAgICB9O1xuXG4gICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgc3R5bGVzSW5Eb21baW5kZXhdLnJlZmVyZW5jZXMrKztcbiAgICAgIHN0eWxlc0luRG9tW2luZGV4XS51cGRhdGVyKG9iaik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0eWxlc0luRG9tLnB1c2goe1xuICAgICAgICBpZGVudGlmaWVyOiBpZGVudGlmaWVyLFxuICAgICAgICB1cGRhdGVyOiBhZGRTdHlsZShvYmosIG9wdGlvbnMpLFxuICAgICAgICByZWZlcmVuY2VzOiAxXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZGVudGlmaWVycy5wdXNoKGlkZW50aWZpZXIpO1xuICB9XG5cbiAgcmV0dXJuIGlkZW50aWZpZXJzO1xufVxuXG5mdW5jdGlvbiBpbnNlcnRTdHlsZUVsZW1lbnQob3B0aW9ucykge1xuICB2YXIgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpO1xuICB2YXIgYXR0cmlidXRlcyA9IG9wdGlvbnMuYXR0cmlidXRlcyB8fCB7fTtcblxuICBpZiAodHlwZW9mIGF0dHJpYnV0ZXMubm9uY2UgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgdmFyIG5vbmNlID0gdHlwZW9mIF9fd2VicGFja19ub25jZV9fICE9PSAndW5kZWZpbmVkJyA/IF9fd2VicGFja19ub25jZV9fIDogbnVsbDtcblxuICAgIGlmIChub25jZSkge1xuICAgICAgYXR0cmlidXRlcy5ub25jZSA9IG5vbmNlO1xuICAgIH1cbiAgfVxuXG4gIE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIHN0eWxlLnNldEF0dHJpYnV0ZShrZXksIGF0dHJpYnV0ZXNba2V5XSk7XG4gIH0pO1xuXG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5pbnNlcnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICBvcHRpb25zLmluc2VydChzdHlsZSk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHRhcmdldCA9IGdldFRhcmdldChvcHRpb25zLmluc2VydCB8fCAnaGVhZCcpO1xuXG4gICAgaWYgKCF0YXJnZXQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkNvdWxkbid0IGZpbmQgYSBzdHlsZSB0YXJnZXQuIFRoaXMgcHJvYmFibHkgbWVhbnMgdGhhdCB0aGUgdmFsdWUgZm9yIHRoZSAnaW5zZXJ0JyBwYXJhbWV0ZXIgaXMgaW52YWxpZC5cIik7XG4gICAgfVxuXG4gICAgdGFyZ2V0LmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgfVxuXG4gIHJldHVybiBzdHlsZTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlU3R5bGVFbGVtZW50KHN0eWxlKSB7XG4gIC8vIGlzdGFuYnVsIGlnbm9yZSBpZlxuICBpZiAoc3R5bGUucGFyZW50Tm9kZSA9PT0gbnVsbCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHN0eWxlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc3R5bGUpO1xufVxuLyogaXN0YW5idWwgaWdub3JlIG5leHQgICovXG5cblxudmFyIHJlcGxhY2VUZXh0ID0gZnVuY3Rpb24gcmVwbGFjZVRleHQoKSB7XG4gIHZhciB0ZXh0U3RvcmUgPSBbXTtcbiAgcmV0dXJuIGZ1bmN0aW9uIHJlcGxhY2UoaW5kZXgsIHJlcGxhY2VtZW50KSB7XG4gICAgdGV4dFN0b3JlW2luZGV4XSA9IHJlcGxhY2VtZW50O1xuICAgIHJldHVybiB0ZXh0U3RvcmUuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJ1xcbicpO1xuICB9O1xufSgpO1xuXG5mdW5jdGlvbiBhcHBseVRvU2luZ2xldG9uVGFnKHN0eWxlLCBpbmRleCwgcmVtb3ZlLCBvYmopIHtcbiAgdmFyIGNzcyA9IHJlbW92ZSA/ICcnIDogb2JqLm1lZGlhID8gXCJAbWVkaWEgXCIuY29uY2F0KG9iai5tZWRpYSwgXCIge1wiKS5jb25jYXQob2JqLmNzcywgXCJ9XCIpIDogb2JqLmNzczsgLy8gRm9yIG9sZCBJRVxuXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAgKi9cblxuICBpZiAoc3R5bGUuc3R5bGVTaGVldCkge1xuICAgIHN0eWxlLnN0eWxlU2hlZXQuY3NzVGV4dCA9IHJlcGxhY2VUZXh0KGluZGV4LCBjc3MpO1xuICB9IGVsc2Uge1xuICAgIHZhciBjc3NOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzKTtcbiAgICB2YXIgY2hpbGROb2RlcyA9IHN0eWxlLmNoaWxkTm9kZXM7XG5cbiAgICBpZiAoY2hpbGROb2Rlc1tpbmRleF0pIHtcbiAgICAgIHN0eWxlLnJlbW92ZUNoaWxkKGNoaWxkTm9kZXNbaW5kZXhdKTtcbiAgICB9XG5cbiAgICBpZiAoY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICAgIHN0eWxlLmluc2VydEJlZm9yZShjc3NOb2RlLCBjaGlsZE5vZGVzW2luZGV4XSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0eWxlLmFwcGVuZENoaWxkKGNzc05vZGUpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBhcHBseVRvVGFnKHN0eWxlLCBvcHRpb25zLCBvYmopIHtcbiAgdmFyIGNzcyA9IG9iai5jc3M7XG4gIHZhciBtZWRpYSA9IG9iai5tZWRpYTtcbiAgdmFyIHNvdXJjZU1hcCA9IG9iai5zb3VyY2VNYXA7XG5cbiAgaWYgKG1lZGlhKSB7XG4gICAgc3R5bGUuc2V0QXR0cmlidXRlKCdtZWRpYScsIG1lZGlhKTtcbiAgfSBlbHNlIHtcbiAgICBzdHlsZS5yZW1vdmVBdHRyaWJ1dGUoJ21lZGlhJyk7XG4gIH1cblxuICBpZiAoc291cmNlTWFwICYmIGJ0b2EpIHtcbiAgICBjc3MgKz0gXCJcXG4vKiMgc291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247YmFzZTY0LFwiLmNvbmNhdChidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShzb3VyY2VNYXApKSkpLCBcIiAqL1wiKTtcbiAgfSAvLyBGb3Igb2xkIElFXG5cbiAgLyogaXN0YW5idWwgaWdub3JlIGlmICAqL1xuXG5cbiAgaWYgKHN0eWxlLnN0eWxlU2hlZXQpIHtcbiAgICBzdHlsZS5zdHlsZVNoZWV0LmNzc1RleHQgPSBjc3M7XG4gIH0gZWxzZSB7XG4gICAgd2hpbGUgKHN0eWxlLmZpcnN0Q2hpbGQpIHtcbiAgICAgIHN0eWxlLnJlbW92ZUNoaWxkKHN0eWxlLmZpcnN0Q2hpbGQpO1xuICAgIH1cblxuICAgIHN0eWxlLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGNzcykpO1xuICB9XG59XG5cbnZhciBzaW5nbGV0b24gPSBudWxsO1xudmFyIHNpbmdsZXRvbkNvdW50ZXIgPSAwO1xuXG5mdW5jdGlvbiBhZGRTdHlsZShvYmosIG9wdGlvbnMpIHtcbiAgdmFyIHN0eWxlO1xuICB2YXIgdXBkYXRlO1xuICB2YXIgcmVtb3ZlO1xuXG4gIGlmIChvcHRpb25zLnNpbmdsZXRvbikge1xuICAgIHZhciBzdHlsZUluZGV4ID0gc2luZ2xldG9uQ291bnRlcisrO1xuICAgIHN0eWxlID0gc2luZ2xldG9uIHx8IChzaW5nbGV0b24gPSBpbnNlcnRTdHlsZUVsZW1lbnQob3B0aW9ucykpO1xuICAgIHVwZGF0ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZSwgc3R5bGVJbmRleCwgZmFsc2UpO1xuICAgIHJlbW92ZSA9IGFwcGx5VG9TaW5nbGV0b25UYWcuYmluZChudWxsLCBzdHlsZSwgc3R5bGVJbmRleCwgdHJ1ZSk7XG4gIH0gZWxzZSB7XG4gICAgc3R5bGUgPSBpbnNlcnRTdHlsZUVsZW1lbnQob3B0aW9ucyk7XG4gICAgdXBkYXRlID0gYXBwbHlUb1RhZy5iaW5kKG51bGwsIHN0eWxlLCBvcHRpb25zKTtcblxuICAgIHJlbW92ZSA9IGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgIHJlbW92ZVN0eWxlRWxlbWVudChzdHlsZSk7XG4gICAgfTtcbiAgfVxuXG4gIHVwZGF0ZShvYmopO1xuICByZXR1cm4gZnVuY3Rpb24gdXBkYXRlU3R5bGUobmV3T2JqKSB7XG4gICAgaWYgKG5ld09iaikge1xuICAgICAgaWYgKG5ld09iai5jc3MgPT09IG9iai5jc3MgJiYgbmV3T2JqLm1lZGlhID09PSBvYmoubWVkaWEgJiYgbmV3T2JqLnNvdXJjZU1hcCA9PT0gb2JqLnNvdXJjZU1hcCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHVwZGF0ZShvYmogPSBuZXdPYmopO1xuICAgIH0gZWxzZSB7XG4gICAgICByZW1vdmUoKTtcbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGxpc3QsIG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307IC8vIEZvcmNlIHNpbmdsZS10YWcgc29sdXRpb24gb24gSUU2LTksIHdoaWNoIGhhcyBhIGhhcmQgbGltaXQgb24gdGhlICMgb2YgPHN0eWxlPlxuICAvLyB0YWdzIGl0IHdpbGwgYWxsb3cgb24gYSBwYWdlXG5cbiAgaWYgKCFvcHRpb25zLnNpbmdsZXRvbiAmJiB0eXBlb2Ygb3B0aW9ucy5zaW5nbGV0b24gIT09ICdib29sZWFuJykge1xuICAgIG9wdGlvbnMuc2luZ2xldG9uID0gaXNPbGRJRSgpO1xuICB9XG5cbiAgbGlzdCA9IGxpc3QgfHwgW107XG4gIHZhciBsYXN0SWRlbnRpZmllcnMgPSBtb2R1bGVzVG9Eb20obGlzdCwgb3B0aW9ucyk7XG4gIHJldHVybiBmdW5jdGlvbiB1cGRhdGUobmV3TGlzdCkge1xuICAgIG5ld0xpc3QgPSBuZXdMaXN0IHx8IFtdO1xuXG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChuZXdMaXN0KSAhPT0gJ1tvYmplY3QgQXJyYXldJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGFzdElkZW50aWZpZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaWRlbnRpZmllciA9IGxhc3RJZGVudGlmaWVyc1tpXTtcbiAgICAgIHZhciBpbmRleCA9IGdldEluZGV4QnlJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xuICAgICAgc3R5bGVzSW5Eb21baW5kZXhdLnJlZmVyZW5jZXMtLTtcbiAgICB9XG5cbiAgICB2YXIgbmV3TGFzdElkZW50aWZpZXJzID0gbW9kdWxlc1RvRG9tKG5ld0xpc3QsIG9wdGlvbnMpO1xuXG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGxhc3RJZGVudGlmaWVycy5sZW5ndGg7IF9pKyspIHtcbiAgICAgIHZhciBfaWRlbnRpZmllciA9IGxhc3RJZGVudGlmaWVyc1tfaV07XG5cbiAgICAgIHZhciBfaW5kZXggPSBnZXRJbmRleEJ5SWRlbnRpZmllcihfaWRlbnRpZmllcik7XG5cbiAgICAgIGlmIChzdHlsZXNJbkRvbVtfaW5kZXhdLnJlZmVyZW5jZXMgPT09IDApIHtcbiAgICAgICAgc3R5bGVzSW5Eb21bX2luZGV4XS51cGRhdGVyKCk7XG5cbiAgICAgICAgc3R5bGVzSW5Eb20uc3BsaWNlKF9pbmRleCwgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGFzdElkZW50aWZpZXJzID0gbmV3TGFzdElkZW50aWZpZXJzO1xuICB9O1xufTsiLCJpbXBvcnQgeyBCYXNpY0VkaXRvciB9IGZyb20gJy4vLi4vLi4vYnVuZGxlcy9CYXNpY0VkaXRvcic7XG5pbXBvcnQgeyBEZXZUb29scyB9IGZyb20gJy4uL3BsdWdpbi1kZXZ0b29scy9zcmMvRGV2VG9vbHMnO1xuaW1wb3J0IHsgT2Rvb1dlYnNpdGVFZGl0b3IgfSBmcm9tICcuLi8uLi9idW5kbGVzL09kb29XZWJzaXRlRWRpdG9yJztcbmltcG9ydCB7IFZSYW5nZSwgd2l0aFJhbmdlIH0gZnJvbSAnLi4vY29yZS9zcmMvVlJhbmdlJztcbmltcG9ydCB7IERvbUxheW91dEVuZ2luZSB9IGZyb20gJy4uL3BsdWdpbi1kb20tbGF5b3V0L3NyYy91aS9Eb21MYXlvdXRFbmdpbmUnO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBJbWFnZU5vZGUgfSBmcm9tICcuLi9wbHVnaW4taW1hZ2Uvc3JjL0ltYWdlTm9kZSc7XG5pbXBvcnQgeyBjcmVhdGVFeGVjQ29tbWFuZEhlbHBlcnNGb3JPZG9vIH0gZnJvbSAnLi4vcGx1Z2luLW9kb28tc25pcHBldHMvc3JjL09kb29CaW5kaW5ncyc7XG5cbmV4cG9ydCB7XG4gICAgT2Rvb1dlYnNpdGVFZGl0b3IsXG4gICAgQmFzaWNFZGl0b3IsXG4gICAgRGV2VG9vbHMsXG4gICAgTGF5b3V0LFxuICAgIERvbUxheW91dEVuZ2luZSxcbiAgICBSZW5kZXJlcixcbiAgICBJbWFnZU5vZGUsXG4gICAgd2l0aFJhbmdlLFxuICAgIFZSYW5nZSxcbiAgICBjcmVhdGVFeGVjQ29tbWFuZEhlbHBlcnNGb3JPZG9vLFxufTtcbiIsImltcG9ydCBKV0VkaXRvciBmcm9tICcuL0pXRWRpdG9yJztcbmltcG9ydCB7IFZSYW5nZSB9IGZyb20gJy4vVlJhbmdlJztcbmltcG9ydCB7IFByZWRpY2F0ZSwgVk5vZGUgfSBmcm9tICcuL1ZOb2Rlcy9WTm9kZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29udGV4dCB7XG4gICAgcmFuZ2U/OiBWUmFuZ2U7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hlY2tpbmdDb250ZXh0IGV4dGVuZHMgQ29udGV4dCB7XG4gICAgc2VsZWN0b3I/OiBWTm9kZVtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbnRleHR1YWwge1xuICAgIGNvbnRleHQ/OiBDb250ZXh0O1xuICAgIHNlbGVjdG9yPzogUHJlZGljYXRlW107XG4gICAgLy8gSWYgdGhlIHNlbGVjdG9yIG1hdGNoIGFuZCBhIGBjaGVja2AgY2FsbGJhY2sgaGFzIGJlZW4gcHJvdmlkZWQsIGNhbGxcbiAgICAvLyBpdCB3aXRoIHRoZSBjdXJyZW50IGNvbnRleHQgdG8gcGVyZm9ybSBhbiBhZGRpdGlvbmFsIGNoZWNraW5nLlxuICAgIGNoZWNrPzogKGNvbnRleHQ6IENoZWNraW5nQ29udGV4dCkgPT4gYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNsYXNzIENvbnRleHRNYW5hZ2VyIHtcbiAgICBlZGl0b3I6IEpXRWRpdG9yO1xuICAgIGRlZmF1bHRDb250ZXh0OiBDb250ZXh0O1xuXG4gICAgY29uc3RydWN0b3IoZWRpdG9yOiBKV0VkaXRvcikge1xuICAgICAgICB0aGlzLmVkaXRvciA9IGVkaXRvcjtcbiAgICAgICAgdGhpcy5kZWZhdWx0Q29udGV4dCA9IHtcbiAgICAgICAgICAgIHJhbmdlOiB0aGlzLmVkaXRvci5zZWxlY3Rpb24ucmFuZ2UsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIE1hdGNoIGEgY29tbWFuZCBmcm9tIHRoZSBjdXJyZW50IGNvbnRleHQgKHRoZSBgdkRvY3VtZW50YCBzZWxlY3Rpb24pLlxuICAgICAqXG4gICAgICogU2VhcmNoIHRocm91Z2ggYWxsIGNvbW1hbmQgd2l0aCBgY29tbWFuZElkYCBhbmQgcmV0dXJuIHRoZSBsYXN0XG4gICAgICogYENvbW1hbmRJbXBsZW1lbnRhdGlvbmAgdGhhdCBtYXRjaCBhIHBhcnRpY3VsYXIgY29udGV4dC5cbiAgICAgKlxuICAgICAqIENvbW1hbmRzIHdpdGggbW9yZSBzcGVjaWZpY2l0eSB3aWxsIGhhdmUgcHJpb3JpdHkuICBJZiB0aGVyZSBpcyBtdWx0aXBsZXNcbiAgICAgKiBjb21tYW5kcyB3aXRoIHRoZSBzYW1lIHNwZWNpZmljaXR5LCB0aGUgbGFzdCBkZWZpbmVkIHdpbGwgYmUgcmV0dXJlZC5cbiAgICAgKlxuICAgICAqIFRoZSBjb250ZXh0IGlzIHRoZSBgZWRpdG9yLnNlbGVjdGlvbi5yYW5nZS5zdGFydC5hbmNlc3RvcnMoKWAuXG4gICAgICpcbiAgICAgKiBTcGVjaWZpY2l0eSBpcyBkZWZpbmVkIHdpdGg6XG4gICAgICogLSBgbHZsMmA6IGlmIHRoZSBsYXN0IHByZWRpY2F0ZSBvZiBhIGNvbW1hbmQgXCJhXCIncyBzZWxlY3RvciBpcyBkZWVwZXIgaW5cbiAgICAgKiAgIHRoZSB0cmVlIHRoYW4gdGhlIGxhc3QgcHJlZGljYXRlIG9mIGEgY29tbWFuZCBcImJcIidzIHNlbGVjdG9yOyBjb21tYW5kXG4gICAgICogICBcImFcIiBoYXZlIG1vcmUgc3BlY2lmaWNpdHlcbiAgICAgKiAtIGBsdmwxYDogaWYgdHdvIG9yIG1vcmUgY29tbWFuZHMgaGF2ZSB0aGUgc2FtZSBgbHZsMmAgc3BlY2lmaWNpdHk7IHRoZVxuICAgICAqICAgY29tbWFuZCB3aXRoIHRoZSBsb25nZXN0IHNlbGVjdG9yIHdpbGwgaGF2ZSBtb3JlIHNwZWNpZmljaXR5XG4gICAgICogLSBgbHZsMGA6IGlmIHRoZSBjb21tYW5kIGhhcyBubyBzZWxlY3RvciwgdGhlcmUgaXMgbm8gc3BlY2lmaWNpdHlcbiAgICAgKlxuICAgICAqIEZvciBleGFtcGxlOlxuICAgICAqIGBgYHR5cGVzY3JpcHRcbiAgICAgKiBjb25zdCBjb21tYW5kVWxQOiBDb21tYW5kSW1wbGVtZW50YXRpb24gPSB7XG4gICAgICogICAgIHNlbGVjdG9yOiBbaXNVbCwgaXNQXSxcbiAgICAgKiAgICAgaGFuZGxlcjogKCkgPT57fSxcbiAgICAgKiB9XG4gICAgICogY29uc3QgY29tbWFuZFA6IENvbW1hbmRJbXBsZW1lbnRhdGlvbiA9IHtcbiAgICAgKiAgICAgc2VsZWN0b3I6IFtpc1BdLFxuICAgICAqICAgICBoYW5kbGVyOiAoKSA9Pnt9LFxuICAgICAqIH1cbiAgICAgKiBjb25zdCBjb21tYW5kVWw6IENvbW1hbmRJbXBsZW1lbnRhdGlvbiA9IHtcbiAgICAgKiAgICAgc2VsZWN0b3I6IFtpc1VsXSxcbiAgICAgKiAgICAgaGFuZGxlcjogKCkgPT57fSxcbiAgICAgKiB9XG4gICAgICogY29uc3QgY29tbWFuZEltYWdlOiBDb21tYW5kSW1wbGVtZW50YXRpb24gPSB7XG4gICAgICogICAgIHNlbGVjdG9yOiBbaXNJbWFnZV0sXG4gICAgICogICAgIGhhbmRsZXI6ICgpID0+e30sXG4gICAgICogfVxuICAgICAqIGNvbnN0IGNvbW1hbmRBbnk6IENvbW1hbmRJbXBsZW1lbnRhdGlvbiA9IHtcbiAgICAgKiAgICAgc2VsZWN0b3I6IFtdLFxuICAgICAqICAgICBoYW5kbGVyOiAoKSA9Pnt9LFxuICAgICAqIH1cbiAgICAgKiBkaXNwYXRjaGVyLnJlZ2lzdGVyQ29tbWFuZCgnY29tbWFuZCcsIGNvbW1hbmRVbFApXG4gICAgICogZGlzcGF0Y2hlci5yZWdpc3RlckNvbW1hbmQoJ2NvbW1hbmQnLCBjb21tYW5kUClcbiAgICAgKiBkaXNwYXRjaGVyLnJlZ2lzdGVyQ29tbWFuZCgnY29tbWFuZCcsIGNvbW1hbmRVbClcbiAgICAgKiBkaXNwYXRjaGVyLnJlZ2lzdGVyQ29tbWFuZCgnY29tbWFuZCcsIGNvbW1hbmRJbWFnZSlcbiAgICAgKiBkaXNwYXRjaGVyLnJlZ2lzdGVyQ29tbWFuZCgnY29tbWFuZCcsIGNvbW1hbmRBbnkpXG4gICAgICogY29uc3QgcmVzdWx0ID0gZGlzcGF0Y2hlci5fbWFjaCgnY29tbWFuZCcpXG4gICAgICogYGBgXG4gICAgICpcbiAgICAgKiBJZiB0aGUgZG9jdW1lbnQgbG9va3MgbGlrZTpcbiAgICAgKiBgYGBodG1sXG4gICAgICogPHVsPlxuICAgICAqICAgICA8bGk+XG4gICAgICogICAgICAgICA8IS0tIFRoZSBjaGFyIFwiW11cIiByZXByZXNlbnQgdGhlIGNvbGxhcHNlZCBzZWxlY3Rpb24gLS0+XG4gICAgICogICAgICAgICA8cD5bXWE8L3A+XG4gICAgICogICAgIDwvbGk+XG4gICAgICogPC91bD5cbiAgICAgKiBgYGBcbiAgICAgKlxuICAgICAqIFRoZSBhbmNlc3RvcnMgbGlzdCBpcyBgWyd1bCcsICdsaScsICdwJ11gLlxuICAgICAqXG4gICAgICogVGhlIDQgY29tbWFuZCBgY29tbWFuZFVsUGAsIGBjb21tYW5kUGAsIGBjb21tYW5kVWxgLCBgY29tbWFuZEFueWAgY291bGRcbiAgICAgKiBtYXRjaCB0aGUgYGNvbW1hbmRgIGlkZW50aWZpZXIgYnV0IG5vdCBgY29tbWFuZEltYWdlYC5cbiAgICAgKlxuICAgICAqIFRoZSBwcmlvcml0eSBpcyBjYWxjdWxhdGVkIHdpdGggXCJgbHZsMmAsYGx2bDFgXCIuXG4gICAgICogLSBgY29tbWFuZFVsUGAgc3BlY2lmaWNpdHk6IDIsMiBgbHZsMmA6IDIgbWVhbnMgdGhlIGxhc3QgcHJlZGljYXRlXG4gICAgICogICAoYGlzUGApIGlzIGZvdW5kIGF0IGRlcHRoIDIgaW4gYW5jZXN0b3JzIGBsdmwxYDogMiBtZWFucyB0aGVyZSBhcmUgMlxuICAgICAqICAgcHJlZGljYXRlcyBpbiBgY29tbWFuZFVsUGAncyBzZWxlY3RvclxuICAgICAqIC0gYGNvbW1hbmRQYCBzcGVjaWZpY2l0eTogMiwxIGBsdmwyYDogMiBtZWFucyB0aGUgbGFzdCBwcmVkaWNhdGUgKGBpc1BgKVxuICAgICAqICAgaXMgZm91bmQgYXQgZGVwdGggMiBpbiBhbmNlc3RvcnMgYGx2bDFgOiAxIG1lYW5zIHRoZXJlIGlzIDEgcHJlZGljYXRlXG4gICAgICogICBpbiBgY29tbWFuZFBgJ3Mgc2VsZWN0b3JcbiAgICAgKiAtIGBjb21tYW5kVWxgIHNwZWNpZmljaXR5OiAwLDEgYGx2bDBgOiAwIG1lYW5zIHRoZSBsYXN0IHByZWRpY2F0ZVxuICAgICAqICAgKGBpc1VsYCkgaXMgZm91bmQgYXQgZGVwdGggMCBpbiBhbmNlc3RvcnMgYGx2bDFgOiAxIG1lYW5zIHRoZXJlIGlzIDFcbiAgICAgKiAgIHByZWRpY2F0ZSBpbiBgY29tbWFuZFBgJ3Mgc2VsZWN0b3JcbiAgICAgKiAtIGBjb21tYW5kQW55YCBzcGVjaWZpY2l0eTogLTEsMCBObyBzZWxlY3RvciBtZWFucyBubyBzcGVjaWZpY2l0eS5cbiAgICAgKiAgIGBsdmwwYDogLTEgbWVhbnMgaXQgaGFzIG5vIGRlcHRoLiAgYGx2bDFgOiAwIG1lYW5zIHRoZXJlIGlzIDBcbiAgICAgKiAgIHByZWRpY2F0ZXMgaW4gYGNvbW1hbmRBbnlgJ3Mgc2VsZWN0b3JcbiAgICAgKlxuICAgICAqIFRoZSByZXN1bHQgd2lsbCBiZSBgY29tbWFuZFVsUGAgYmVjYXVzZSBpdCBoYXMgdGhlIGhpZ2hlc3Qgc3BlY2lmaWNpdHkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbXNcbiAgICAgKiBAcGFyYW0gcGFyYW1zQ29udGV4dFxuICAgICAqL1xuICAgIG1hdGNoPFQgZXh0ZW5kcyBDb250ZXh0dWFsPihpdGVtczogVFtdLCBwYXJhbXNDb250ZXh0PzogQ29udGV4dCk6IFtULCBDb250ZXh0XSB7XG4gICAgICAgIGxldCBtYXhGaXJzdE1hdGNoRGVwdGggPSAtMTtcbiAgICAgICAgbGV0IG1heFNlbGVjdG9yTGVuZ3RoID0gMDtcbiAgICAgICAgbGV0IG1hdGNoaW5nSXRlbTogVDtcbiAgICAgICAgbGV0IG1hdGNoaW5nQ29udGV4dDogQ29udGV4dDtcblxuICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbnRleHQgPSB7IC4uLnRoaXMuZGVmYXVsdENvbnRleHQsIC4uLml0ZW0uY29udGV4dCwgLi4ucGFyYW1zQ29udGV4dCB9O1xuICAgICAgICAgICAgbGV0IGZpcnN0TWF0Y2hEZXB0aCA9IC0xO1xuICAgICAgICAgICAgbGV0IGluZGV4ID0gMDtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdG9yID0gaXRlbS5zZWxlY3RvciB8fCBbXTtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gY29udGV4dC5yYW5nZS5zdGFydDtcbiAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gc3RhcnQuYW5jZXN0b3JzKCk7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gc3RhcnQucHJldmlvdXNTaWJsaW5nKCkgfHwgc3RhcnQubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgICAgIGlmIChub2RlKSB7XG4gICAgICAgICAgICAgICAgbm9kZXMudW5zaGlmdChub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IG1heGltdW1EZXB0aCA9IG5vZGVzLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHByZWRpY2F0ZSBvZiBbLi4uc2VsZWN0b3JdLnJldmVyc2UoKSkge1xuICAgICAgICAgICAgICAgIGxldCBtYXRjaEZvdW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgd2hpbGUgKCFtYXRjaEZvdW5kICYmIGluZGV4IDwgbm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChub2Rlc1tpbmRleF0udGVzdChwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaEZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMudW5zaGlmdChub2Rlc1tpbmRleF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZpcnN0TWF0Y2hEZXB0aCA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEZWVwZXIgbWF0Y2ggaGFzIGhpZ2hlciBzcGVjaWZpY2l0eS4gU28gbG93ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbmRleCBpbiBhbmNlc3RvcnMsIG1lYW5zIGhpZ2hlciBzcGVjaWZpY2l0eS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdE1hdGNoRGVwdGggPSBtYXhpbXVtRGVwdGggLSBpbmRleDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpbmRleCsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBTdG9wIGNoZWNraW5nIHRoZSBwcmVkaWNhdGVzIG9mIHRoaXMgcGFydGljdWxhciBjb21tYW5kXG4gICAgICAgICAgICAgICAgLy8gc2luY2UgYXQgbGVhc3Qgb25lIG9mIHRoZW0gZG9uJ3QgbWF0Y2ggdGhlIGNvbnRleHQuXG4gICAgICAgICAgICAgICAgaWYgKCFtYXRjaEZvdW5kKSBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIG1hdGNoZXMubGVuZ3RoID09PSBzZWxlY3Rvci5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICBtYXhGaXJzdE1hdGNoRGVwdGggPD0gZmlyc3RNYXRjaERlcHRoICYmXG4gICAgICAgICAgICAgICAgbWF4U2VsZWN0b3JMZW5ndGggPD0gc2VsZWN0b3IubGVuZ3RoICYmXG4gICAgICAgICAgICAgICAgKCFpdGVtLmNoZWNrIHx8IGl0ZW0uY2hlY2soeyAuLi5jb250ZXh0LCBzZWxlY3RvcjogbWF0Y2hlcyB9KSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIG1heEZpcnN0TWF0Y2hEZXB0aCA9IGZpcnN0TWF0Y2hEZXB0aDtcbiAgICAgICAgICAgICAgICBtYXhTZWxlY3Rvckxlbmd0aCA9IHNlbGVjdG9yLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBtYXRjaGluZ0l0ZW0gPSBpdGVtO1xuICAgICAgICAgICAgICAgIG1hdGNoaW5nQ29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFttYXRjaGluZ0l0ZW0sIG1hdGNoaW5nQ29udGV4dF07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi9KV1BsdWdpbic7XG5pbXBvcnQgSldFZGl0b3IgZnJvbSAnLi9KV0VkaXRvcic7XG5pbXBvcnQgeyBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi9EaXNwYXRjaGVyJztcbmltcG9ydCB7IFZTZWxlY3Rpb25EZXNjcmlwdGlvbiB9IGZyb20gJy4vVlNlbGVjdGlvbic7XG5pbXBvcnQgeyBWTm9kZSwgUmVsYXRpdmVQb3NpdGlvbiB9IGZyb20gJy4vVk5vZGVzL1ZOb2RlJztcblxuZXhwb3J0IHR5cGUgSW5zZXJ0UGFyYWdyYXBoQnJlYWtQYXJhbXMgPSBDb21tYW5kUGFyYW1zO1xuZXhwb3J0IHR5cGUgRGVsZXRlQmFja3dhcmRQYXJhbXMgPSBDb21tYW5kUGFyYW1zO1xuZXhwb3J0IHR5cGUgRGVsZXRlRm9yd2FyZFBhcmFtcyA9IENvbW1hbmRQYXJhbXM7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5zZXJ0UGFyYW1zIGV4dGVuZHMgQ29tbWFuZFBhcmFtcyB7XG4gICAgbm9kZTogVk5vZGU7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVlNlbGVjdGlvblBhcmFtcyB7XG4gICAgdlNlbGVjdGlvbjogVlNlbGVjdGlvbkRlc2NyaXB0aW9uO1xufVxuXG5leHBvcnQgY2xhc3MgQ29yZTxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgZWRpdG9yOiBKV0VkaXRvcjtcbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgaW5zZXJ0OiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmluc2VydCxcbiAgICAgICAgfSxcbiAgICAgICAgaW5zZXJ0UGFyYWdyYXBoQnJlYWs6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuaW5zZXJ0UGFyYWdyYXBoQnJlYWssXG4gICAgICAgIH0sXG4gICAgICAgIHNldFNlbGVjdGlvbjoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5zZXRTZWxlY3Rpb24sXG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZUJhY2t3YXJkOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmRlbGV0ZUJhY2t3YXJkLFxuICAgICAgICB9LFxuICAgICAgICBkZWxldGVGb3J3YXJkOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmRlbGV0ZUZvcndhcmQsXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgYSBwYXJhZ3JhcGggYnJlYWsuXG4gICAgICovXG4gICAgaW5zZXJ0UGFyYWdyYXBoQnJlYWsocGFyYW1zOiBJbnNlcnRQYXJhZ3JhcGhCcmVha1BhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICAvLyBSZW1vdmUgdGhlIGNvbnRlbnRzIG9mIHRoZSByYW5nZSBpZiBuZWVkZWQuXG4gICAgICAgIGlmICghcmFuZ2UuaXNDb2xsYXBzZWQoKSkge1xuICAgICAgICAgICAgcmFuZ2UuZW1wdHkoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmFuZ2Uuc3RhcnRDb250YWluZXIuYnJlYWthYmxlKSB7XG4gICAgICAgICAgICByYW5nZS5zdGFydENvbnRhaW5lci5zcGxpdEF0KHJhbmdlLnN0YXJ0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFVzZSBhIHNlcGFyYXRvciB0byBicmVhayBwYXJhZ3JhcGhzIGluIGFuIHVuYnJlYWthYmxlLlxuICAgICAgICAgICAgY29uc3QgU2VwYXJhdG9yID0gdGhpcy5lZGl0b3IuY29uZmlndXJhdGlvbi5kZWZhdWx0cy5TZXBhcmF0b3I7XG4gICAgICAgICAgICByYW5nZS5zdGFydC5iZWZvcmUobmV3IFNlcGFyYXRvcigpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgYSBWTm9kZSBhdCB0aGUgY3VycmVudCBwb3NpdGlvbiBvZiB0aGUgc2VsZWN0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGluc2VydChwYXJhbXM6IEluc2VydFBhcmFtcyk6IHZvaWQge1xuICAgICAgICAvLyBSZW1vdmUgdGhlIGNvbnRlbnRzIG9mIHRoZSByYW5nZSBpZiBuZWVkZWQuXG4gICAgICAgIGlmICghcGFyYW1zLmNvbnRleHQucmFuZ2UuaXNDb2xsYXBzZWQoKSkge1xuICAgICAgICAgICAgcGFyYW1zLmNvbnRleHQucmFuZ2UuZW1wdHkoKTtcbiAgICAgICAgfVxuICAgICAgICBwYXJhbXMuY29udGV4dC5yYW5nZS5zdGFydC5iZWZvcmUocGFyYW1zLm5vZGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgaW4gdGhlIGJhY2t3YXJkIGRpcmVjdGlvbiAoYmFja3NwYWNlIGtleSBleHBlY3RlZCBiZWhhdmlvcikuXG4gICAgICovXG4gICAgZGVsZXRlQmFja3dhcmQocGFyYW1zOiBEZWxldGVGb3J3YXJkUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGlmIChyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICAvLyBCYXNpYyBjYXNlOiByZW1vdmUgdGhlIG5vZGUgZGlyZWN0bHkgcHJlY2VkaW5nIHRoZSByYW5nZS5cbiAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzU2libGluZyA9IHJhbmdlLnN0YXJ0LnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIHByZXZpb3VzU2libGluZyAmJlxuICAgICAgICAgICAgICAgIHJhbmdlLnN0YXJ0Q29udGFpbmVyLmJyZWFrYWJsZSAmJlxuICAgICAgICAgICAgICAgIHJhbmdlLnN0YXJ0Q29udGFpbmVyLmVkaXRhYmxlXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBwcmV2aW91c1NpYmxpbmcucmVtb3ZlQmFja3dhcmQoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocmFuZ2Uuc3RhcnRDb250YWluZXIuYnJlYWthYmxlICYmIHJhbmdlLnN0YXJ0Q29udGFpbmVyLmVkaXRhYmxlKSB7XG4gICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIHNldCByYW5nZSBzdGFydCBhdCBwcmV2aW91cyB2YWxpZCBsZWFmLlxuICAgICAgICAgICAgICAgIGxldCBhbmNlc3RvciA9IHJhbmdlLnN0YXJ0LnBhcmVudDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoYW5jZXN0b3I/LmJyZWFrYWJsZSAmJiBhbmNlc3Rvci5lZGl0YWJsZSAmJiAhYW5jZXN0b3IucHJldmlvdXNTaWJsaW5nKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhbmNlc3Rvcj8uYnJlYWthYmxlICYmIGFuY2VzdG9yLmVkaXRhYmxlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHByZXZpb3VzID0gYW5jZXN0b3IucHJldmlvdXNTaWJsaW5nKCkubGFzdExlYWYoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRTdGFydChwcmV2aW91cywgUmVsYXRpdmVQb3NpdGlvbi5BRlRFUik7XG4gICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5lbXB0eSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmFuZ2UuZW1wdHkoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgaW4gdGhlIGZvcndhcmQgZGlyZWN0aW9uIChkZWxldGUga2V5IGV4cGVjdGVkIGJlaGF2aW9yKS5cbiAgICAgKi9cbiAgICBkZWxldGVGb3J3YXJkKHBhcmFtczogRGVsZXRlRm9yd2FyZFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBpZiAocmFuZ2UuaXNDb2xsYXBzZWQoKSkge1xuICAgICAgICAgICAgLy8gQmFzaWMgY2FzZTogcmVtb3ZlIHRoZSBub2RlIGRpcmVjdGx5IGZvbGxvd2luZyB0aGUgcmFuZ2UuXG4gICAgICAgICAgICBjb25zdCBuZXh0U2libGluZyA9IHJhbmdlLmVuZC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgaWYgKG5leHRTaWJsaW5nICYmIHJhbmdlLmVuZENvbnRhaW5lci5icmVha2FibGUgJiYgcmFuZ2UuZW5kQ29udGFpbmVyLmVkaXRhYmxlKSB7XG4gICAgICAgICAgICAgICAgbmV4dFNpYmxpbmcucmVtb3ZlRm9yd2FyZCgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChyYW5nZS5lbmRDb250YWluZXIuYnJlYWthYmxlICYmIHJhbmdlLmVuZENvbnRhaW5lci5lZGl0YWJsZSkge1xuICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSBzZXQgcmFuZ2UgZW5kIGF0IG5leHQgdmFsaWQgbGVhZi5cbiAgICAgICAgICAgICAgICBsZXQgYW5jZXN0b3IgPSByYW5nZS5lbmQucGFyZW50O1xuICAgICAgICAgICAgICAgIHdoaWxlIChhbmNlc3Rvcj8uYnJlYWthYmxlICYmIGFuY2VzdG9yLmVkaXRhYmxlICYmICFhbmNlc3Rvci5uZXh0U2libGluZygpKSB7XG4gICAgICAgICAgICAgICAgICAgIGFuY2VzdG9yID0gYW5jZXN0b3IucGFyZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYW5jZXN0b3I/LmJyZWFrYWJsZSAmJiBhbmNlc3Rvci5lZGl0YWJsZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0ID0gYW5jZXN0b3IubmV4dFNpYmxpbmcoKS5maXJzdExlYWYoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldEVuZChuZXh0LCBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5lbXB0eSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmFuZ2UuZW1wdHkoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBOYXZpZ2F0ZSB0byBhIGdpdmVuIHJhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIHNldFNlbGVjdGlvbihwYXJhbXM6IFZTZWxlY3Rpb25QYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnNldChwYXJhbXMudlNlbGVjdGlvbik7XG4gICAgfVxufVxuIiwiaW1wb3J0IEpXRWRpdG9yIGZyb20gJy4vSldFZGl0b3InO1xuaW1wb3J0IHsgQ29udGV4dCwgQ29udGV4dHVhbCB9IGZyb20gJy4vQ29udGV4dE1hbmFnZXInO1xuXG5leHBvcnQgdHlwZSBDb21tYW5kSWRlbnRpZmllciA9IHN0cmluZztcbmV4cG9ydCBpbnRlcmZhY2UgQ29tbWFuZEltcGxlbWVudGF0aW9uIGV4dGVuZHMgQ29udGV4dHVhbCB7XG4gICAgdGl0bGU/OiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb24/OiBzdHJpbmc7XG4gICAgaGFuZGxlcjogQ29tbWFuZEhhbmRsZXI7XG59XG5leHBvcnQgaW50ZXJmYWNlIENvbW1hbmRQYXJhbXMge1xuICAgIGNvbnRleHQ/OiBDb250ZXh0O1xufVxuZXhwb3J0IHR5cGUgQ29tbWFuZEhhbmRsZXIgPSAoYXJncykgPT4gYW55O1xuZXhwb3J0IHR5cGUgQ29tbWFuZEhvb2sgPSAocGFyYW1zOiBDb21tYW5kUGFyYW1zLCBjb21tYW5kSWQ6IHN0cmluZykgPT4gdm9pZDtcblxuZXhwb3J0IGNsYXNzIERpc3BhdGNoZXIge1xuICAgIF9fbmV4dEhhbmRsZXJUb2tlbklEID0gMDtcbiAgICBlZGl0b3I6IEpXRWRpdG9yO1xuICAgIGNvbW1hbmRzOiBSZWNvcmQ8Q29tbWFuZElkZW50aWZpZXIsIENvbW1hbmRJbXBsZW1lbnRhdGlvbltdPiA9IHt9O1xuICAgIGNvbW1hbmRIb29rczogUmVjb3JkPENvbW1hbmRJZGVudGlmaWVyLCBDb21tYW5kSG9va1tdPiA9IHt9O1xuXG4gICAgY29uc3RydWN0b3IoZWRpdG9yOiBKV0VkaXRvcikge1xuICAgICAgICB0aGlzLmVkaXRvciA9IGVkaXRvcjtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQ2FsbCBhbGwgaG9va3MgcmVnaXN0cmVkIGZvciB0aGUgY29tbWFuZCBgaWRgLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbW1hbmRJZCBUaGUgaWRlbnRpZmllciBvZiB0aGUgY29tbWFuZC5cbiAgICAgKiBAcGFyYW0gcGFyYW1zIFRoZSBwYXJhbWV0ZXJzIG9mIHRoZSBjb21tYW5kLlxuICAgICAqL1xuICAgIGFzeW5jIGRpc3BhdGNoKGNvbW1hbmRJZDogQ29tbWFuZElkZW50aWZpZXIsIHBhcmFtczogQ29tbWFuZFBhcmFtcyA9IHt9KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNvbW1hbmRzID0gdGhpcy5jb21tYW5kc1tjb21tYW5kSWRdO1xuICAgICAgICBpZiAoIWNvbW1hbmRzKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYENvbW1hbmQgJyR7Y29tbWFuZElkfScgbm90IGZvdW5kLmApO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IHJlc3VsdDogYW55O1xuICAgICAgICBjb25zdCBbY29tbWFuZCwgY29udGV4dF0gPSB0aGlzLmVkaXRvci5jb250ZXh0TWFuYWdlci5tYXRjaChjb21tYW5kcywgcGFyYW1zLmNvbnRleHQpO1xuICAgICAgICBpZiAoY29tbWFuZCkge1xuICAgICAgICAgICAgLy8gVXBkYXRlIGNvbW1hbmQgYXJndW1lbnRzIHdpdGggdGhlIGNvbXB1dGVkIGV4ZWN1dGlvbiBjb250ZXh0LlxuICAgICAgICAgICAgY29uc3QgYXJncyA9IHsgLi4ucGFyYW1zLCBjb250ZXh0IH07XG5cbiAgICAgICAgICAgIC8vIENhbGwgY29tbWFuZCBoYW5kbGVyLlxuICAgICAgICAgICAgcmVzdWx0ID0gYXdhaXQgY29tbWFuZC5oYW5kbGVyKGFyZ3MpO1xuXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9kaXNwYXRjaEhvb2tzKGNvbW1hbmRJZCwgYXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyIHRoZSBkaXNwYXRjaGVyIGZvciBhIGN1c3RvbSBjb21tYW5kLlxuICAgICAqL1xuICAgIGFzeW5jIGRpc3BhdGNoQ3VzdG9tKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGlzcGF0Y2hIb29rcygnQGN1c3RvbScpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIGFsbCBoYW5kbGVycyBkZWNsYXJlZCBpbiBhIHBsdWdpbiwgYW5kIG1hdGNoIHRoZW0gd2l0aCB0aGVpclxuICAgICAqIGNvcnJlc3BvbmRpbmcgY29tbWFuZC5cbiAgICAgKlxuICAgICAqL1xuICAgIHJlZ2lzdGVyQ29tbWFuZChpZDogQ29tbWFuZElkZW50aWZpZXIsIGltcGw6IENvbW1hbmRJbXBsZW1lbnRhdGlvbik6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuY29tbWFuZHNbaWRdKSB7XG4gICAgICAgICAgICB0aGlzLmNvbW1hbmRzW2lkXSA9IFtpbXBsXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZHNbaWRdLnB1c2goaW1wbCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciBhIGNhbGxiYWNrIHRoYXQgd2lsbCBiZSBleGVjdXRlZCBmb3IgZWFjaCBgZXhlY0NvbW1hbmRgIGNhbGwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaWQgVGhlIGlkZW50aWZpZXIgb2YgdGhlIGNvbW1hbmQgdG8gaG9vay5cbiAgICAgKiBAcGFyYW0gaG9vayBUaGUgY2FsbGJhY2sgdGhhdCB3aWxsIGJlIGV4ZWN1dGVkLlxuICAgICAqL1xuICAgIHJlZ2lzdGVyQ29tbWFuZEhvb2soaWQ6IENvbW1hbmRJZGVudGlmaWVyLCBob29rPzogQ29tbWFuZEhvb2spOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLmNvbW1hbmRIb29rc1tpZF0pIHtcbiAgICAgICAgICAgIHRoaXMuY29tbWFuZEhvb2tzW2lkXSA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29tbWFuZEhvb2tzW2lkXS5wdXNoKGhvb2spO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERpc3BhdGNoIHRvIGFsbCByZWdpc3RyZWQgYGNvbW1hbmRIb29rc2AuXG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBfZGlzcGF0Y2hIb29rcyhjb21tYW5kSWQ6IENvbW1hbmRJZGVudGlmaWVyLCBhcmdzPyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBob29rcyA9IHRoaXMuY29tbWFuZEhvb2tzW2NvbW1hbmRJZF0gfHwgW107XG4gICAgICAgIGNvbnN0IGdsb2JhbEhvb2tzID0gdGhpcy5jb21tYW5kSG9va3NbJyonXSB8fCBbXTtcbiAgICAgICAgZm9yIChjb25zdCBob29rQ2FsbGJhY2sgb2YgWy4uLmhvb2tzLCAuLi5nbG9iYWxIb29rc10pIHtcbiAgICAgICAgICAgIGF3YWl0IGhvb2tDYWxsYmFjayhhcmdzLCBjb21tYW5kSWQpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRGlzcGF0Y2hlciB9IGZyb20gJy4vRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuL0pXUGx1Z2luJztcbmltcG9ydCB7IENvcmUgfSBmcm9tICcuL0NvcmUnO1xuaW1wb3J0IHsgQ29udGV4dE1hbmFnZXIgfSBmcm9tICcuL0NvbnRleHRNYW5hZ2VyJztcbmltcG9ydCB7IFZTZWxlY3Rpb24gfSBmcm9tICcuL1ZTZWxlY3Rpb24nO1xuaW1wb3J0IHsgaXNDb25zdHJ1Y3RvciB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgTW9kZUVycm9yIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL2Vycm9ycyc7XG5pbXBvcnQgeyBDb250YWluZXJOb2RlIH0gZnJvbSAnLi9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBBdG9taWNOb2RlIH0gZnJvbSAnLi9WTm9kZXMvQXRvbWljTm9kZSc7XG5pbXBvcnQgeyBTZXBhcmF0b3JOb2RlIH0gZnJvbSAnLi9WTm9kZXMvU2VwYXJhdG9yTm9kZSc7XG5cbmV4cG9ydCBlbnVtIE1vZGUge1xuICAgIENPTkZJR1VSQVRJT04gPSAnY29uZmlndXJhdGlvbicsXG4gICAgRURJVElPTiA9ICdlZGl0aW9uJyxcbn1cblxuZXhwb3J0IHR5cGUgTG9hZGFibGUgPSB7fTtcbmV4cG9ydCB0eXBlIExvYWRlcjxMIGV4dGVuZHMgTG9hZGFibGUgPSBMb2FkYWJsZT4gPSAoXG4gICAgbG9hZGFibGVzOiBMW10sXG4gICAgc291cmNlPzogSldQbHVnaW4gfCB7fSxcbikgPT4gdm9pZDtcbmV4cG9ydCB0eXBlIExvYWRhYmxlczxUIGV4dGVuZHMgSldQbHVnaW4gPSBKV1BsdWdpbj4gPSB7XG4gICAgW2tleSBpbiBrZXlvZiBUWydsb2FkZXJzJ11dPzogUGFyYW1ldGVyczxUWydsb2FkZXJzJ11ba2V5XT5bMF07XG59O1xuXG50eXBlIENvbW1hbmRzPFQgZXh0ZW5kcyBKV1BsdWdpbj4gPSBFeHRyYWN0PGtleW9mIFRbJ2NvbW1hbmRzJ10sIHN0cmluZz47XG50eXBlIENvbW1hbmRQYXJhbXM8VCBleHRlbmRzIEpXUGx1Z2luLCBLIGV4dGVuZHMgc3RyaW5nPiA9IEsgZXh0ZW5kcyBDb21tYW5kczxUPlxuICAgID8gUGFyYW1ldGVyczxUWydjb21tYW5kcyddW0tdWydoYW5kbGVyJ10+WzBdXG4gICAgOiBuZXZlcjtcblxuZXhwb3J0IGludGVyZmFjZSBKV0VkaXRvckNvbmZpZyB7XG4gICAgZGVmYXVsdHM/OiB7XG4gICAgICAgIENvbnRhaW5lcj86IG5ldyAoKSA9PiBDb250YWluZXJOb2RlO1xuICAgICAgICBBdG9taWM/OiBuZXcgKCkgPT4gQXRvbWljTm9kZTtcbiAgICAgICAgU2VwYXJhdG9yPzogbmV3ICgpID0+IFNlcGFyYXRvck5vZGU7XG4gICAgfTtcbiAgICBwbHVnaW5zPzogW3R5cGVvZiBKV1BsdWdpbiwgSldQbHVnaW5Db25maWc/XVtdO1xuICAgIGxvYWRhYmxlcz86IExvYWRhYmxlcztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQbHVnaW5NYXAgZXh0ZW5kcyBNYXA8dHlwZW9mIEpXUGx1Z2luLCBKV1BsdWdpbj4ge1xuICAgIGdldDxUIGV4dGVuZHMgdHlwZW9mIEpXUGx1Z2luPihjb25zdHJ1Y3RvcjogVCk6IEluc3RhbmNlVHlwZTxUPjtcbn1cblxuZXhwb3J0IGNsYXNzIEpXRWRpdG9yIHtcbiAgICBwcml2YXRlIF9tb2RlOiBNb2RlID0gTW9kZS5DT05GSUdVUkFUSU9OO1xuICAgIGRpc3BhdGNoZXI6IERpc3BhdGNoZXI7XG4gICAgY29udGV4dE1hbmFnZXI6IENvbnRleHRNYW5hZ2VyO1xuICAgIHBsdWdpbnM6IFBsdWdpbk1hcCA9IG5ldyBNYXAoKTtcbiAgICBjb25maWd1cmF0aW9uOiBKV0VkaXRvckNvbmZpZyA9IHtcbiAgICAgICAgZGVmYXVsdHM6IHtcbiAgICAgICAgICAgIENvbnRhaW5lcjogQ29udGFpbmVyTm9kZSxcbiAgICAgICAgICAgIEF0b21pYzogQXRvbWljTm9kZSxcbiAgICAgICAgICAgIFNlcGFyYXRvcjogU2VwYXJhdG9yTm9kZSxcbiAgICAgICAgfSxcbiAgICAgICAgcGx1Z2luczogW10sXG4gICAgICAgIGxvYWRhYmxlczoge30sXG4gICAgfTtcbiAgICBzZWxlY3Rpb24gPSBuZXcgVlNlbGVjdGlvbigpO1xuICAgIGxvYWRlcnM6IFJlY29yZDxzdHJpbmcsIExvYWRlcj4gPSB7fTtcbiAgICBwcml2YXRlIG11dGV4ID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgLy8gdXNlIGEgc2V0IHNvIHRoYXQgd2hlbiBhc3luYyBmdW5jdGlvbiBhcmUgY2FsbGVkLCB3YWl0IHVudGlsIGV2ZXJ5IGJhdGNoXG4gICAgLy8gY29tbWFuZHMgZmluaXNoLlxuICAgIHByZXZlbnRSZW5kZXJzOiBTZXQ8RnVuY3Rpb24+ID0gbmV3IFNldCgpO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuZGlzcGF0Y2hlciA9IG5ldyBEaXNwYXRjaGVyKHRoaXMpO1xuICAgICAgICB0aGlzLnBsdWdpbnMgPSBuZXcgTWFwKCk7XG4gICAgICAgIHRoaXMuY29udGV4dE1hbmFnZXIgPSBuZXcgQ29udGV4dE1hbmFnZXIodGhpcyk7XG5cbiAgICAgICAgdGhpcy5uZXh0RXZlbnRNdXRleCA9IHRoaXMubmV4dEV2ZW50TXV0ZXguYmluZCh0aGlzKTtcblxuICAgICAgICAvLyBDb3JlIGlzIGEgc3BlY2lhbCBtYW5kYXRvcnkgcGx1Z2luIHRoYXQgaGFuZGxlcyB0aGUgbWF0Y2hpbmcgYmV0d2VlblxuICAgICAgICAvLyB0aGUgY29tbWFuZHMgc3VwcG9ydGVkIGluIHRoZSBjb3JlIG9mIHRoZSBlZGl0b3IgYW5kIHRoZSBWRG9jdW1lbnQuXG4gICAgICAgIHRoaXMubG9hZChDb3JlKTtcbiAgICAgICAgdGhpcy5sb2FkKEtleW1hcCk7XG4gICAgfVxuXG4gICAgYXN5bmMgbmV4dEV2ZW50TXV0ZXgobmV4dDogKC4uLmFyZ3MpID0+IHZvaWQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuICh0aGlzLm11dGV4ID0gdGhpcy5tdXRleC50aGVuKG5leHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU3RhcnQgdGhlIGVkaXRvciBvbiB0aGUgZWRpdGFibGUgRE9NIG5vZGUgc2V0IG9uIHRoaXMgZWRpdG9yIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGFzeW5jIHN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLl9tb2RlID0gTW9kZS5FRElUSU9OO1xuICAgICAgICB0aGlzLl9sb2FkUGx1Z2lucygpO1xuXG4gICAgICAgIC8vIExvYWQgZWRpdG9yLWxldmVsIGxvYWRhYmxlcy5cbiAgICAgICAgaWYgKHRoaXMuY29uZmlndXJhdGlvbi5sb2FkYWJsZXMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbG9hZGFibGVJZCBvZiBPYmplY3Qua2V5cyh0aGlzLmxvYWRlcnMpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9hZGFibGUgPSB0aGlzLmNvbmZpZ3VyYXRpb24ubG9hZGFibGVzW2xvYWRhYmxlSWRdO1xuICAgICAgICAgICAgICAgIGlmIChsb2FkYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWRlcnNbbG9hZGFibGVJZF0obG9hZGFibGUsIHRoaXMuY29uZmlndXJhdGlvbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChjb25zdCBwbHVnaW4gb2YgdGhpcy5wbHVnaW5zLnZhbHVlcygpKSB7XG4gICAgICAgICAgICBhd2FpdCBwbHVnaW4uc3RhcnQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBMb2FkIHRoZSBnaXZlbiBwbHVnaW4gd2l0aCBnaXZlbiBjb25maWd1cmF0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIFBsdWdpblxuICAgICAqIEBwYXJhbSBjb25maWdcbiAgICAgKi9cbiAgICBsb2FkKGxvYWRhYmxlczogTG9hZGFibGVzKTogdm9pZDtcbiAgICBsb2FkPFAgZXh0ZW5kcyB0eXBlb2YgSldQbHVnaW4+KFBsdWdpbjogUCwgY29uZmlnPzogQ29uc3RydWN0b3JQYXJhbWV0ZXJzPFA+WzFdKTogdm9pZDtcbiAgICBsb2FkPFAgZXh0ZW5kcyB0eXBlb2YgSldQbHVnaW4+KFxuICAgICAgICBQbHVnaW5PckxvYWRhYmxlczogUCB8IExvYWRhYmxlcyxcbiAgICAgICAgY29uZmlnPzogQ29uc3RydWN0b3JQYXJhbWV0ZXJzPFA+WzFdLFxuICAgICk6IHZvaWQge1xuICAgICAgICAvLyBBY3R1YWwgbG9hZGluZyBpcyBkZWZlcnJlZCB0byBgc3RhcnRgLlxuICAgICAgICBpZiAodGhpcy5fbW9kZSAhPT0gTW9kZS5DT05GSUdVUkFUSU9OKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgTW9kZUVycm9yKE1vZGUuQ09ORklHVVJBVElPTik7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNDb25zdHJ1Y3RvcihQbHVnaW5PckxvYWRhYmxlcywgSldQbHVnaW4pKSB7XG4gICAgICAgICAgICAvLyBBZGQgdGhlIHBsdWdpbiB0byB0aGUgY29uZmlndXJhdGlvbi5cbiAgICAgICAgICAgIGNvbnN0IFBsdWdpbiA9IFBsdWdpbk9yTG9hZGFibGVzO1xuICAgICAgICAgICAgY29uc3QgcGx1Z2lucyA9IHRoaXMuY29uZmlndXJhdGlvbi5wbHVnaW5zO1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBwbHVnaW5zLmZpbmRJbmRleCgoW3BdKSA9PiBwID09PSBQbHVnaW4pO1xuICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGlzIG1vZHVsZSBmcm9tIHRoZSBjb25maWcgdG8gYXZvaWQgbG9hZGluZyBpdCB0d2ljZS5cbiAgICAgICAgICAgICAgICBwbHVnaW5zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwbHVnaW5zLnB1c2goW1BsdWdpbiwgY29uZmlnIHx8IHt9XSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBBZGQgdGhlIGxvYWRhYmxlcyB0byB0aGUgY29uZmlndXJhdGlvbi5cbiAgICAgICAgICAgIGNvbnN0IGNvbmZpZ3VyZWRMb2FkYWJsZXMgPSB0aGlzLmNvbmZpZ3VyYXRpb24ubG9hZGFibGVzO1xuICAgICAgICAgICAgZm9yIChjb25zdCBsb2FkYWJsZUlkZW50aWZpZXIgb2YgT2JqZWN0LmtleXMoUGx1Z2luT3JMb2FkYWJsZXMpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9hZGFibGVzID0gUGx1Z2luT3JMb2FkYWJsZXNbbG9hZGFibGVJZGVudGlmaWVyXTtcbiAgICAgICAgICAgICAgICBpZiAoY29uZmlndXJlZExvYWRhYmxlc1tsb2FkYWJsZUlkZW50aWZpZXJdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyZWRMb2FkYWJsZXNbbG9hZGFibGVJZGVudGlmaWVyXS5wdXNoKC4uLmxvYWRhYmxlcyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJlZExvYWRhYmxlc1tsb2FkYWJsZUlkZW50aWZpZXJdID0gWy4uLmxvYWRhYmxlc107XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTG9hZCB0aGUgcGx1Z2lucyBzcGVjaWZpZWQgaW4gdGhlIGVkaXRvciBjb25maWd1cmF0aW9uLlxuICAgICAqXG4gICAgICovXG4gICAgcHJpdmF0ZSBfbG9hZFBsdWdpbnMoKTogdm9pZCB7XG4gICAgICAgIC8vIFJlc29sdmUgZGVwZW5kZW5jaWVzLlxuICAgICAgICBjb25zdCBQbHVnaW5zID0gWy4uLnRoaXMuY29uZmlndXJhdGlvbi5wbHVnaW5zXTtcbiAgICAgICAgZm9yIChsZXQgb2Zmc2V0ID0gMTsgb2Zmc2V0IDw9IFBsdWdpbnMubGVuZ3RoOyBvZmZzZXQrKykge1xuICAgICAgICAgICAgY29uc3QgaW5kZXggPSBQbHVnaW5zLmxlbmd0aCAtIG9mZnNldDtcbiAgICAgICAgICAgIGNvbnN0IFtQbHVnaW5dID0gUGx1Z2luc1tpbmRleF07XG4gICAgICAgICAgICBmb3IgKGNvbnN0IERlcGVuZGVuY3kgb2YgWy4uLlBsdWdpbi5kZXBlbmRlbmNpZXNdLnJldmVyc2UoKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGRlcEluZGV4ID0gUGx1Z2lucy5maW5kSW5kZXgoKFtQXSkgPT4gUCA9PT0gRGVwZW5kZW5jeSk7XG4gICAgICAgICAgICAgICAgaWYgKGRlcEluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIHRoZSBtaXNzaW5nIGRlcGVuZGVuY3kgd2l0aCBubyBjb25maWcgcGFyYW1ldGVycy5cbiAgICAgICAgICAgICAgICAgICAgUGx1Z2lucy5zcGxpY2UoaW5kZXgsIDAsIFtEZXBlbmRlbmN5LCB7fV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVwSW5kZXggPiBpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBMb2FkIHRoZSBkZXBlbmRlbmN5IGJlZm9yZSB0aGUgcGx1Z2luIGRlcGVuZGluZyBvbiBpdC5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgW1tEZXAsIGNvbmZpZ11dID0gUGx1Z2lucy5zcGxpY2UoZGVwSW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICBQbHVnaW5zLnNwbGljZShpbmRleCwgMCwgW0RlcCwgY29uZmlnXSk7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldC0tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIExvYWQgcGx1Z2lucy5cbiAgICAgICAgZm9yIChjb25zdCBbUGx1Z2luQ2xhc3MsIGNvbmZpZ3VyYXRpb25dIG9mIFBsdWdpbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHBsdWdpbiA9IG5ldyBQbHVnaW5DbGFzcyh0aGlzLCBjb25maWd1cmF0aW9uKTtcblxuICAgICAgICAgICAgdGhpcy5wbHVnaW5zLnNldChQbHVnaW5DbGFzcywgcGx1Z2luKTtcblxuICAgICAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIGNvbW1hbmRzIG9mIHRoaXMgcGx1Z2luLlxuICAgICAgICAgICAgT2JqZWN0LmtleXMocGx1Z2luLmNvbW1hbmRzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW1wbGVtZW50YXRpb24gPSB7IC4uLnBsdWdpbi5jb21tYW5kc1trZXldIH07XG4gICAgICAgICAgICAgICAgLy8gQmluZCBoYW5kbGVycyB0byB0aGUgcGx1Z2luIGl0c2VsZi4gVGhpcyBwcmVzZXJ2ZXMgdGhlXG4gICAgICAgICAgICAgICAgLy8gdHlwaW5nIG9mIHRoZSBoYW5kbGVyIHBhcmFtZXRlcnMgd2hpY2ggd291bGQgYmUgbG9zdCBpZlxuICAgICAgICAgICAgICAgIC8vIHRoZSBiaW5kaW5nIHdhcyBkb25lIGluIHRoZSBwbHVnaW4gZGVmaW5pdGlvbi5cbiAgICAgICAgICAgICAgICBpbXBsZW1lbnRhdGlvbi5oYW5kbGVyID0gaW1wbGVtZW50YXRpb24uaGFuZGxlci5iaW5kKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaGVyLnJlZ2lzdGVyQ29tbWFuZChrZXksIGltcGxlbWVudGF0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gUmVnaXN0ZXIgdGhlIGhvb2tzIG9mIHRoaXMgcGx1Z2luLlxuICAgICAgICAgICAgZm9yIChjb25zdCBbaWQsIGhvb2tdIG9mIE9iamVjdC5lbnRyaWVzKHBsdWdpbi5jb21tYW5kSG9va3MpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXNwYXRjaGVyLnJlZ2lzdGVyQ29tbWFuZEhvb2soaWQsIGhvb2suYmluZChwbHVnaW4pKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTG9hZCBsb2FkZXJzLlxuICAgICAgICAgICAgZm9yIChjb25zdCBsb2FkYWJsZUlkIG9mIE9iamVjdC5rZXlzKHBsdWdpbi5sb2FkZXJzKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxvYWRlcnNbbG9hZGFibGVJZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBNdWx0aXBsZSBsb2FkZXJzIGZvciAnJHtsb2FkYWJsZUlkfScuYCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQmluZCBsb2FkZXJzIHRvIHRoZSBwbHVnaW4gaXRzZWxmLiBUaGlzIHByZXNlcnZlcyB0aGVcbiAgICAgICAgICAgICAgICAgICAgLy8gdHlwaW5nIG9mIHRoZSBsb2FkZXIgcGFyYW1ldGVycyB3aGljaCB3b3VsZCBiZSBsb3N0IGlmXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBiaW5kaW5nIHdhcyBkb25lIGluIHRoZSBwbHVnaW4gZGVmaW5pdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbG9hZGVyID0gcGx1Z2luLmxvYWRlcnNbbG9hZGFibGVJZF07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZGVyc1tsb2FkYWJsZUlkXSA9IGxvYWRlci5iaW5kKHBsdWdpbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gTG9hZCBsb2FkYWJsZXMuXG4gICAgICAgIGZvciAoY29uc3QgbG9hZGFibGVJZGVudGlmaWVyIG9mIE9iamVjdC5rZXlzKHRoaXMubG9hZGVycykpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcGx1Z2luIG9mIHRoaXMucGx1Z2lucy52YWx1ZXMoKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxvYWRhYmxlQXJyYXkgPSBwbHVnaW4ubG9hZGFibGVzW2xvYWRhYmxlSWRlbnRpZmllcl07XG4gICAgICAgICAgICAgICAgaWYgKGxvYWRhYmxlQXJyYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkZXJzW2xvYWRhYmxlSWRlbnRpZmllcl0obG9hZGFibGVBcnJheSwgcGx1Z2luKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb25maWd1cmUgdGhpcyBlZGl0b3IgaW5zdGFuY2Ugd2l0aCB0aGUgZ2l2ZW4gYGNvbmZpZ2Agb2JqZWN0LCBvclxuICAgICAqIGNvbmZpZ3VyZSB0aGUgZ2l2ZW4gcGx1Z2luIHdpdGggdGhlIGdpdmVuIGNvbmZpZ3VyYXRpb24gb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIGVkaXRvckNvbmZpZyB8IFBsdWdpblxuICAgICAqIEBwYXJhbSBbUGx1Z2luQ29uZmlnXVxuICAgICAqL1xuICAgIGNvbmZpZ3VyZShlZGl0b3JDb25maWc6IEpXRWRpdG9yQ29uZmlnKTogdm9pZDtcbiAgICBjb25maWd1cmU8VCBleHRlbmRzIHR5cGVvZiBKV1BsdWdpbj4oXG4gICAgICAgIFBsdWdpbjogVCxcbiAgICAgICAgcGx1Z2luQ29uZmlnOiBDb25zdHJ1Y3RvclBhcmFtZXRlcnM8VD5bMV0sXG4gICAgKTogdm9pZDtcbiAgICBjb25maWd1cmU8VCBleHRlbmRzIHR5cGVvZiBKV1BsdWdpbj4oXG4gICAgICAgIFBsdWdpbk9yRWRpdG9yQ29uZmlnOiBKV0VkaXRvckNvbmZpZyB8IFQsXG4gICAgICAgIHBsdWdpbkNvbmZpZz86IENvbnN0cnVjdG9yUGFyYW1ldGVyczxUPlsxXSxcbiAgICApOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuX21vZGUgIT09IE1vZGUuQ09ORklHVVJBVElPTikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IE1vZGVFcnJvcihNb2RlLkNPTkZJR1VSQVRJT04pO1xuICAgICAgICB9IGVsc2UgaWYgKGlzQ29uc3RydWN0b3IoUGx1Z2luT3JFZGl0b3JDb25maWcsIEpXUGx1Z2luKSkge1xuICAgICAgICAgICAgLy8gQ29uZmlndXJlIHRoZSBwbHVnaW4uXG4gICAgICAgICAgICBjb25zdCBQbHVnaW4gPSBQbHVnaW5PckVkaXRvckNvbmZpZztcbiAgICAgICAgICAgIGNvbnN0IGNvbmYgPSB0aGlzLmNvbmZpZ3VyYXRpb24ucGx1Z2lucy5maW5kKChbUF0pID0+IFAgPT09IFBsdWdpbik7XG4gICAgICAgICAgICBpZiAoY29uZikge1xuICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgcHJldmlvdXMgY29uZmlnIGlmIHRoZSBwbHVnaW4gd2FzIGFscmVhZHkgYWRkZWQuXG4gICAgICAgICAgICAgICAgY29uZlsxXSA9IHsgLi4uY29uZlsxXSwgLi4ucGx1Z2luQ29uZmlnIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgbmV3IHBsdWdpbiBjb25zdHJ1Y3RvciBhbmQgaGlzIGNvbmZpZ3VyYXRpb24uXG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uLnBsdWdpbnMucHVzaChbUGx1Z2luLCBwbHVnaW5Db25maWddKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIENvbmZpZ3VyZSB0aGUgZWRpdG9yLlxuICAgICAgICAgICAgY29uc3QgcHJlY29uZiA9IHRoaXMuY29uZmlndXJhdGlvbjtcbiAgICAgICAgICAgIGNvbnN0IGNvbmYgPSBQbHVnaW5PckVkaXRvckNvbmZpZztcbiAgICAgICAgICAgIHRoaXMuY29uZmlndXJhdGlvbiA9IHsgLi4ucHJlY29uZiwgLi4uY29uZiB9O1xuICAgICAgICAgICAgLy8gTWVyZ2Ugc3BlY2lhbCBgZGVmYXVsdHNgIGNvbmZpZ3VyYXRpb24ga2V5LlxuICAgICAgICAgICAgaWYgKGNvbmYuZGVmYXVsdHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24uZGVmYXVsdHMgPSB7XG4gICAgICAgICAgICAgICAgICAgIC4uLnByZWNvbmYuZGVmYXVsdHMsXG4gICAgICAgICAgICAgICAgICAgIC4uLmNvbmYuZGVmYXVsdHMsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEhhbmRsZSBzcGVjaWFsIGBwbHVnaW5zYCBjb25maWd1cmF0aW9uIGtleSB0aHJvdWdoIGBsb2FkYC5cbiAgICAgICAgICAgIGlmIChjb25mLnBsdWdpbnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNvbmZpZ3VyYXRpb24ucGx1Z2lucyA9IFsuLi5wcmVjb25mLnBsdWdpbnNdO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW1BsdWdpbiwgcGx1Z2luQ29uZmlndXJhdGlvbl0gb2YgY29uZi5wbHVnaW5zKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubG9hZChQbHVnaW4sIHBsdWdpbkNvbmZpZ3VyYXRpb24gfHwge30pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEhhbmRsZSBzcGVjaWFsIGBsb2FkYWJsZXNgIGNvbmZpZ3VyYXRpb24ga2V5IHRocm91Z2ggYGxvYWRgLlxuICAgICAgICAgICAgaWYgKGNvbmYubG9hZGFibGVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWd1cmF0aW9uLmxvYWRhYmxlcyA9IHsgLi4ucHJlY29uZi5sb2FkYWJsZXMgfTtcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQoY29uZi5sb2FkYWJsZXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgZXhlY0JhdGNoKGNhbGxiYWNrOiAoKSA9PiBQcm9taXNlPHZvaWQ+KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGlzLnByZXZlbnRSZW5kZXJzOicsIHRoaXMucHJldmVudFJlbmRlcnMpO1xuICAgICAgICB0aGlzLnByZXZlbnRSZW5kZXJzLmFkZChjYWxsYmFjayk7XG4gICAgICAgIGF3YWl0IGNhbGxiYWNrKCk7XG4gICAgICAgIHRoaXMucHJldmVudFJlbmRlcnMuZGVsZXRlKGNhbGxiYWNrKTtcbiAgICAgICAgLy8gY29uc3QgZG9tID0gdGhpcy5wbHVnaW5zLmdldChEb20pO1xuICAgICAgICAvLyByZXR1cm4gZG9tLl9yZW5kZXJJbkVkaXRhYmxlKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRXhlY3V0ZSB0aGUgZ2l2ZW4gY29tbWFuZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpZCBuYW1lIGlkZW50aWZpZXIgb2YgdGhlIGNvbW1hbmQgdG8gZXhlY3V0ZVxuICAgICAqIEBwYXJhbSBwYXJhbXMgYXJndW1lbnRzIG9iamVjdCBvZiB0aGUgY29tbWFuZCB0byBleGVjdXRlXG4gICAgICovXG4gICAgYXN5bmMgZXhlY0NvbW1hbmQ8UCBleHRlbmRzIEpXUGx1Z2luLCBDIGV4dGVuZHMgQ29tbWFuZHM8UD4gPSBDb21tYW5kczxQPj4oXG4gICAgICAgIGNvbW1hbmROYW1lOiBDLFxuICAgICAgICBwYXJhbXM/OiBDb21tYW5kUGFyYW1zPFAsIEM+LFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5kaXNwYXRjaGVyLmRpc3BhdGNoKGNvbW1hbmROYW1lLCBwYXJhbXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGUgYXJiaXRyYXJ5IGNvZGUgaW4gYGNhbGxiYWNrYCwgdGhlbiBkaXNwYXRjaCB0aGUgZXZlbnQuXG4gICAgICovXG4gICAgYXN5bmMgZXhlY0N1c3RvbUNvbW1hbmQ8UCBleHRlbmRzIEpXUGx1Z2luLCBDIGV4dGVuZHMgQ29tbWFuZHM8UD4gPSBDb21tYW5kczxQPj4oXG4gICAgICAgIGNhbGxiYWNrOiAoKSA9PiBQcm9taXNlPHZvaWQ+LFxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBhd2FpdCBjYWxsYmFjaygpO1xuICAgICAgICBhd2FpdCB0aGlzLmRpc3BhdGNoZXIuZGlzcGF0Y2hDdXN0b20oKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wIHRoaXMgZWRpdG9yIGluc3RhbmNlLlxuICAgICAqL1xuICAgIGFzeW5jIHN0b3AoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGZvciAoY29uc3QgcGx1Z2luIG9mIHRoaXMucGx1Z2lucy52YWx1ZXMoKSkge1xuICAgICAgICAgICAgYXdhaXQgcGx1Z2luLnN0b3AoKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBDbGVhciBsb2FkZXJzLlxuICAgICAgICB0aGlzLmxvYWRlcnMgPSB7fTtcbiAgICAgICAgdGhpcy5fbW9kZSA9IE1vZGUuQ09ORklHVVJBVElPTjtcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IEpXRWRpdG9yO1xuIiwiaW1wb3J0IEpXRWRpdG9yLCB7IExvYWRlciwgUGx1Z2luTWFwLCBMb2FkYWJsZXMgfSBmcm9tICcuL0pXRWRpdG9yJztcbmltcG9ydCB7IENvbW1hbmRJZGVudGlmaWVyLCBDb21tYW5kSW1wbGVtZW50YXRpb24sIENvbW1hbmRIb29rIH0gZnJvbSAnLi9EaXNwYXRjaGVyJztcblxuZXhwb3J0IHR5cGUgSldQbHVnaW5Db25maWcgPSB7fTtcblxuZXhwb3J0IGNsYXNzIEpXUGx1Z2luPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IHt9PiB7XG4gICAgc3RhdGljIHJlYWRvbmx5IGRlcGVuZGVuY2llczogQXJyYXk8dHlwZW9mIEpXUGx1Z2luPiA9IFtdO1xuICAgIHJlYWRvbmx5IGRlcGVuZGVuY2llczogUGx1Z2luTWFwID0gbmV3IE1hcCgpO1xuICAgIHJlYWRvbmx5IGxvYWRlcnM6IFJlY29yZDxzdHJpbmcsIExvYWRlcj4gPSB7fTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlcyA9IHt9O1xuICAgIG5hbWU6IHN0cmluZztcbiAgICBjb21tYW5kczogUmVjb3JkPENvbW1hbmRJZGVudGlmaWVyLCBDb21tYW5kSW1wbGVtZW50YXRpb24+ID0ge307XG4gICAgY29tbWFuZEhvb2tzOiBSZWNvcmQ8Q29tbWFuZElkZW50aWZpZXIsIENvbW1hbmRIb29rPiA9IHt9O1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIGVkaXRvcjogSldFZGl0b3IsIHB1YmxpYyBjb25maWd1cmF0aW9uOiBQYXJ0aWFsPFQ+ID0ge30pIHtcbiAgICAgICAgLy8gUG9wdWxhdGUgaW5zdGFudGlhdGVkIGRlcGVuZGVuY2llcy5cbiAgICAgICAgZm9yIChjb25zdCBEZXBlbmRlbmN5IG9mIHRoaXMuY29uc3RydWN0b3IuZGVwZW5kZW5jaWVzKSB7XG4gICAgICAgICAgICB0aGlzLmRlcGVuZGVuY2llcy5zZXQoRGVwZW5kZW5jeSwgZWRpdG9yLnBsdWdpbnMuZ2V0KERlcGVuZGVuY3kpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0YXJ0IHRoZSBwbHVnaW4uIENhbGxlZCB3aGVuIHRoZSBlZGl0b3Igc3RhcnRzLlxuICAgICAqL1xuICAgIGFzeW5jIHN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBUaGlzIGlzIHdoZXJlIHBsdWdpbnMgY2FuIGRvIGFzeW5jaHJvbm91cyB3b3JrIHdoZW4gdGhlIGVkaXRvciBpc1xuICAgICAgICAvLyBzdGFydGluZyAoZS5nLiByZXRyaWV2ZSBkYXRhIGZyb20gYSBzZXJ2ZXIsIHJlbmRlciBzdHVmZiwgZXRjKS5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdG9wIHRoZSBwbHVnaW4uIENhbGxlZCB3aGVuIHRoZSBlZGl0b3Igc3RvcHMuXG4gICAgICovXG4gICAgYXN5bmMgc3RvcCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gVGhpcyBpcyB3aGVyZSBwbHVnaW5zIGNhbiBkbyBhc3luY2hyb25vdXMgd29yayB3aGVuIHRoZSBlZGl0b3IgaXNcbiAgICAgICAgLy8gc3RvcHBpbmcgKGUuZy4gc2F2ZSBvbiBhIHNlcnZlciwgY2xvc2UgY29ubmVjdGlvbnMsIGV0YykuXG4gICAgfVxufVxuZXhwb3J0IGludGVyZmFjZSBKV1BsdWdpbiB7XG4gICAgY29uc3RydWN0b3I6IHtcbiAgICAgICAgbmV3ICguLi5hcmdzOiBDb25zdHJ1Y3RvclBhcmFtZXRlcnM8dHlwZW9mIEpXUGx1Z2luPik6IEpXUGx1Z2luO1xuICAgICAgICBkZXBlbmRlbmNpZXM6IEFycmF5PHR5cGVvZiBKV1BsdWdpbj47XG4gICAgfTtcbn1cbiIsImltcG9ydCB7IENvbnN0cnVjdG9yIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi9WTm9kZXMvVk5vZGUnO1xuXG5pbnRlcmZhY2UgTW9kaWZpZXJDb25zdHJ1Y3RvciB7XG4gICAgbmV3IDxUIGV4dGVuZHMgQ29uc3RydWN0b3I8TW9kaWZpZXI+PiguLi5hcmdzOiBDb25zdHJ1Y3RvclBhcmFtZXRlcnM8VD4pOiB0aGlzO1xufVxuZXhwb3J0IGludGVyZmFjZSBNb2RpZmllciB7XG4gICAgY29uc3RydWN0b3I6IE1vZGlmaWVyQ29uc3RydWN0b3IgJiB0aGlzO1xufVxuZXhwb3J0IGNsYXNzIE1vZGlmaWVyIHtcbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWU7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIGFwcGx5VG8obm9kZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgbm9kZS5tb2RpZmllcnMucHJlcGVuZCh0aGlzKTtcbiAgICB9XG4gICAgaXNTYW1lQXMob3RoZXJNb2RpZmllcjogTW9kaWZpZXIpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMgPT09IG90aGVyTW9kaWZpZXI7XG4gICAgfVxuICAgIGNsb25lKCk6IHRoaXMge1xuICAgICAgICByZXR1cm4gbmV3IHRoaXMuY29uc3RydWN0b3IoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBNb2RpZmllciB9IGZyb20gJy4vTW9kaWZpZXInO1xuaW1wb3J0IHsgQ29uc3RydWN0b3IsIGlzQ29uc3RydWN0b3IgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgTW9kaWZpZXJzIHtcbiAgICBwcml2YXRlIF9jb250ZW50czogTW9kaWZpZXJbXSA9IFtdO1xuICAgIGNvbnN0cnVjdG9yKC4uLm1vZGlmaWVyczogQXJyYXk8TW9kaWZpZXIgfCBDb25zdHJ1Y3RvcjxNb2RpZmllcj4+KSB7XG4gICAgICAgIGNvbnN0IGNsb25lZE1vZGlmaWVycyA9IG1vZGlmaWVycy5tYXAobW9kID0+IHtcbiAgICAgICAgICAgIHJldHVybiBtb2QgaW5zdGFuY2VvZiBNb2RpZmllciA/IG1vZC5jbG9uZSgpIDogbW9kO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5hcHBlbmQoLi4uY2xvbmVkTW9kaWZpZXJzKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gR2V0dGVyc1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbGVuZ3RoIG9mIHRoZSBhcnJheS5cbiAgICAgKi9cbiAgICBnZXQgbGVuZ3RoKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50cy5sZW5ndGg7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIExpZmVjeWNsZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgTW9kaWZpZXJzIGNsYXNzIGNvbnRhaW5pbmcgdGhlIHNhbWVcbiAgICAgKiBtb2RpZmllcnMuXG4gICAgICovXG4gICAgY2xvbmUoKTogTW9kaWZpZXJzIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNb2RpZmllcnMoLi4udGhpcy5fY29udGVudHMubWFwKG1vZCA9PiBtb2QuY2xvbmUoKSkpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBBcHBlbmQgb25lIG9yIG1vcmUgbW9kaWZpZXJzIHRvIHRoZSBhcnJheS4gSWYgb25lIG9mIHRoZSBnaXZlbiBtb2RpZmllcnNcbiAgICAgKiBpcyBhIG1vZGlmaWVyIGNsYXNzIGNvbnN0cnVjdG9yLCBpbnN0YW50aWF0ZSBpdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBtb2RpZmllcnNcbiAgICAgKi9cbiAgICBhcHBlbmQoLi4ubW9kaWZpZXJzOiBBcnJheTxNb2RpZmllciB8IENvbnN0cnVjdG9yPE1vZGlmaWVyPj4pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBtb2RpZmllciBvZiBtb2RpZmllcnMpIHtcbiAgICAgICAgICAgIGlmIChtb2RpZmllciBpbnN0YW5jZW9mIE1vZGlmaWVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udGVudHMucHVzaChtb2RpZmllcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRzLnB1c2gobmV3IG1vZGlmaWVyKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByZXBlbmQgb25lIG9yIG1vcmUgbW9kaWZpZXJzIHRvIHRoZSBhcnJheS4gSWYgb25lIG9mIHRoZSBnaXZlbiBtb2RpZmllcnNcbiAgICAgKiBpcyBhIG1vZGlmaWVyIGNsYXNzIGNvbnN0cnVjdG9yLCBpbnN0YW50aWF0ZSBpdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBtb2RpZmllcnNcbiAgICAgKi9cbiAgICBwcmVwZW5kKC4uLm1vZGlmaWVyczogQXJyYXk8TW9kaWZpZXIgfCBDb25zdHJ1Y3RvcjxNb2RpZmllcj4+KTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgbW9kaWZpZXIgb2YgbW9kaWZpZXJzKSB7XG4gICAgICAgICAgICBpZiAobW9kaWZpZXIgaW5zdGFuY2VvZiBNb2RpZmllcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRzLnVuc2hpZnQobW9kaWZpZXIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250ZW50cy51bnNoaWZ0KG5ldyBtb2RpZmllcigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGZpcnN0IG1vZGlmaWVyIGluIHRoZSBhcnJheSB0aGF0IGlzIGFuIGluc3RhbmNlIG9mIHRoZSBnaXZlblxuICAgICAqIE1vZGlmaWVyIGNsYXNzLCBpZiBhbnkuXG4gICAgICogSWYgdGhlIG1vZGlmaWVyIHBhc3NlZCBpcyBhIE1vZGlmaWVyIGluc3RhbmNlLCByZXR1cm4gaXQgaWYgaXQgd2FzXG4gICAgICogcHJlc2VudCBpbiB0aGUgYXJyYXkuXG4gICAgICogVGhpcyBhbHNvIGZ1bmN0aW9ucyBhcyBhIHByb3h5IHRvIHRoZSBuYXRpdmUgYGZpbmRgIG1ldGhvZCBvZiBgQXJyYXlgLFxuICAgICAqIGZvciBgdGhpcy5fY29udGVudHNgLlxuICAgICAqXG4gICAgICogQHNlZSBBcnJheS5maW5kXG4gICAgICogQHBhcmFtIG1vZGlmaWVyXG4gICAgICovXG4gICAgZmluZDxUIGV4dGVuZHMgTW9kaWZpZXI+KGNhbGxiYWNrOiAobW9kaWZpZXI6IFQpID0+IGJvb2xlYW4pOiBUO1xuICAgIGZpbmQ8VCBleHRlbmRzIE1vZGlmaWVyPihtb2RpZmllcjogVCB8IENvbnN0cnVjdG9yPFQ+KTogVDtcbiAgICBmaW5kPFQgZXh0ZW5kcyBNb2RpZmllcj4obW9kaWZpZXI6ICgobW9kaWZpZXI6IFQpID0+IGJvb2xlYW4pIHwgVCB8IENvbnN0cnVjdG9yPFQ+KTogVCB7XG4gICAgICAgIGlmIChtb2RpZmllciBpbnN0YW5jZW9mIE1vZGlmaWVyKSB7XG4gICAgICAgICAgICAvLyBgbW9kaWZpZXJgIGlzIGFuIGluc3RhbmNlIG9mIGBNb2RpZmllcmAgLT4gZmluZCBpdCBpbiB0aGUgYXJyYXkuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGVudHMuZmluZChpbnN0YW5jZSA9PiBpbnN0YW5jZSA9PT0gbW9kaWZpZXIpIGFzIFQ7XG4gICAgICAgIH0gZWxzZSBpZiAoaXNDb25zdHJ1Y3Rvcjx0eXBlb2YgTW9kaWZpZXI+KG1vZGlmaWVyLCBNb2RpZmllcikpIHtcbiAgICAgICAgICAgIC8vIGBtb2RpZmllcmAgaXMgYSBgTW9kaWZpZXJgIGNsYXNzIC0+IGZpbmQgaXRzIGZpcnN0IGluc3RhbmNlIGluXG4gICAgICAgICAgICAvLyB0aGUgYXJyYXkuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGVudHMuZmluZChtb2QgPT4gbW9kLmNvbnN0cnVjdG9yLm5hbWUgPT09IG1vZGlmaWVyLm5hbWUpIGFzIFQ7XG4gICAgICAgIH0gZWxzZSBpZiAobW9kaWZpZXIgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgICAgICAgICAgLy8gYG1vZGlmaWVyYCBpcyBhIGNhbGxiYWNrIC0+IGNhbGwgYGZpbmRgIG5hdGl2ZWx5IG9uIHRoZSBhcnJheS5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50cy5maW5kKG1vZGlmaWVyKSBhcyBUO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgZmlyc3QgbW9kaWZpZXIgaW4gdGhlIGFycmF5IHRoYXQgaXMgYW4gaW5zdGFuY2Ugb2YgdGhlIGdpdmVuXG4gICAgICogbW9kaWZpZXIgY2xhc3Mgb3IgY3JlYXRlIG9uZSwgYXBwZW5kIGl0IGFuZCByZXR1cm4gaXQuXG4gICAgICogSWYgdGhlIG1vZGlmaWVyIHBhc3NlZCBpcyBhIG1vZGlmaWVyIGluc3RhbmNlLCByZXR1cm4gaXQgaWYgaXQgd2FzXG4gICAgICogcHJlc2VudCBpbiB0aGUgYXJyYXkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbW9kaWZpZXJcbiAgICAgKi9cbiAgICBnZXQ8VCBleHRlbmRzIE1vZGlmaWVyPihtb2RpZmllcjogVCB8IENvbnN0cnVjdG9yPFQ+KTogVCB7XG4gICAgICAgIGxldCBmb3VuZCA9IHRoaXMuZmluZChtb2RpZmllcik7XG4gICAgICAgIGlmICghZm91bmQgJiYgaXNDb25zdHJ1Y3Rvcjx0eXBlb2YgTW9kaWZpZXI+KG1vZGlmaWVyLCBNb2RpZmllcikpIHtcbiAgICAgICAgICAgIGZvdW5kID0gbmV3IG1vZGlmaWVyKCk7XG4gICAgICAgICAgICB0aGlzLmFwcGVuZChmb3VuZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYWxsIHRoZSBtb2RpZmllcnMgaW5zdGFuY2VzIHRoYXQgYXJlIGhvbGQgYnkgYHRoaXNgLlxuICAgICAqL1xuICAgIGdldENvbnRlbnQoKTogTW9kaWZpZXJbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50cztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFsbCBtb2RpZmllcnMgaW4gdGhlIGFycmF5IHRoYXQgYXJlIGFuIGluc3RhbmNlIG9mIHRoZSBnaXZlblxuICAgICAqIG1vZGlmaWVyIGNsYXNzLCBpZiBhbnkuXG4gICAgICogVGhpcyBhbHNvIGZ1bmN0aW9ucyBhcyBhIHByb3h5IHRvIHRoZSBuYXRpdmUgYGZpbHRlcmAgbWV0aG9kIG9mIGBBcnJheWAsXG4gICAgICogZm9yIGB0aGlzLl9jb250ZW50c2AuXG4gICAgICpcbiAgICAgKiBAc2VlIEFycmF5LmZpbHRlclxuICAgICAqIEBwYXJhbSBtb2RpZmllclxuICAgICAqL1xuICAgIGZpbHRlcjxUIGV4dGVuZHMgTW9kaWZpZXI+KFxuICAgICAgICBjYWxsYmFja2ZuOiAodmFsdWU6IE1vZGlmaWVyLCBpbmRleDogbnVtYmVyLCBhcnJheTogTW9kaWZpZXJbXSkgPT4gYm9vbGVhbixcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgdGhpc0FyZz86IGFueSxcbiAgICApOiBUW107XG4gICAgZmlsdGVyPFQgZXh0ZW5kcyBNb2RpZmllcj4obW9kaWZpZXI6IENvbnN0cnVjdG9yPFQ+KTogVFtdO1xuICAgIGZpbHRlcjxUIGV4dGVuZHMgTW9kaWZpZXI+KFxuICAgICAgICBtb2RpZmllcjogKCh2YWx1ZTogTW9kaWZpZXIsIGluZGV4OiBudW1iZXIsIGFycmF5OiBNb2RpZmllcltdKSA9PiBib29sZWFuKSB8IENvbnN0cnVjdG9yPFQ+LFxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICB0aGlzQXJnPzogYW55LFxuICAgICk6IFRbXSB7XG4gICAgICAgIGlmIChtb2RpZmllciBpbnN0YW5jZW9mIE1vZGlmaWVyKSB7XG4gICAgICAgICAgICAvLyBgbW9kaWZpZXJgIGlzIGFuIGluc3RhbmNlIG9mIGBNb2RpZmllcmAgLT4gZmluZCBpdCBpbiB0aGUgYXJyYXlcbiAgICAgICAgICAgIC8vIGFuZCByZXR1cm4gaXQgaW4gYSBuZXcgYXJyYXkuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udGVudHMuZmlsdGVyKG0gPT4gbSA9PT0gbW9kaWZpZXIpIGFzIFRbXTtcbiAgICAgICAgfSBlbHNlIGlmIChpc0NvbnN0cnVjdG9yPHR5cGVvZiBNb2RpZmllcj4obW9kaWZpZXIsIE1vZGlmaWVyKSkge1xuICAgICAgICAgICAgLy8gYG1vZGlmaWVyYCBpcyBhIGBNb2RpZmllcmAgY2xhc3MgLT4gcmV0dXJuIGFsbCBpbnN0YW5jZXMgb2YgaXQgaW5cbiAgICAgICAgICAgIC8vIHRoZSBhcnJheS5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50cy5maWx0ZXIobSA9PiBtIGluc3RhbmNlb2YgbW9kaWZpZXIpIGFzIFRbXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGBtb2RpZmllcmAgaXMgYSBjYWxsYmFjayAtPiBjYWxsIGBmaWx0ZXJgIG5hdGl2ZWx5IG9uIHRoZSBhcnJheS5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50cy5maWx0ZXIobW9kaWZpZXIsIHRoaXNBcmcpIGFzIFRbXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIGZpcnN0IG1vZGlmaWVyIGluIHRoZSBhcnJheSB0aGF0IGlzIGFuIGluc3RhbmNlIG9mIHRoZSBnaXZlblxuICAgICAqIG1vZGlmaWVyIGNsYXNzLiBJZiBhIG1vZGlmaWVyIGluc3RhbmNlIGlzIGdpdmVuLCByZW1vdmUgdGhhdCBwYXJ0aWN1YXJcbiAgICAgKiBpbnN0YW5jZSBmcm9tIHRoZSBhcnJheS4gUmV0dXJuIHRydWUgaWYgYSBtb2RpZmllciB3YXMgcmVtb3ZlZCwgZmFsc2VcbiAgICAgKiBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbW9kaWZpZXJcbiAgICAgKi9cbiAgICByZW1vdmUobW9kaWZpZXI6IE1vZGlmaWVyIHwgQ29uc3RydWN0b3I8TW9kaWZpZXI+KTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IG1vZGlmaWVySW5kZXggPSB0aGlzLl9jb250ZW50cy5maW5kSW5kZXgobW9kaWZpZXJJbnN0YW5jZSA9PiB7XG4gICAgICAgICAgICBpZiAobW9kaWZpZXIgaW5zdGFuY2VvZiBNb2RpZmllcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2RpZmllckluc3RhbmNlID09PSBtb2RpZmllcjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZGlmaWVySW5zdGFuY2UgaW5zdGFuY2VvZiBtb2RpZmllcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChtb2RpZmllckluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fY29udGVudHMuc3BsaWNlKG1vZGlmaWVySW5kZXgsIDEpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVwbGFjZSB0aGUgZmlyc3QgbW9kaWZpZXIgaW4gdGhlIGFycmF5IHRoYXQgaXMgYW4gaW5zdGFuY2Ugb2YgdGhlIGdpdmVuXG4gICAgICogbW9kaWZpZXIgY2xhc3Mgb3IgdGhhdCBtYXRjaGVzIHRoZSBwYXJ0aWN1bGFyIGluc3RhbmNlIHBhc3NlZCB3aXRoIHRoZVxuICAgICAqIGdpdmVuIG1vZGlmaWVyIGluc3RhbmNlLiBJZiB0aGUgbmV3IG1vZGlmaWVyIHBhc3NlZCBpcyBhIGNsYXNzLFxuICAgICAqIGluc3RhbnRpYXRlIGl0LiBJZiBubyBtb2RpZmllciB3YXMgZm91bmQsIHNpbXBseSBwdXNoIHRoZSBuZXcgbW9kaWZpZXIgb25cbiAgICAgKiB0aGUgYXJyYXkuXG4gICAgICpcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiBhIG1vZGlmaWVyIHdhcyByZXBsYWNlZCwgZmFsc2UgaWYgdGhlIG1vZGlmaWVyIHdhcyBzaW1wbHlcbiAgICAgKiBhZGRlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvbGRNb2RpZmllclxuICAgICAqIEBwYXJhbSBuZXdNb2RpZmllclxuICAgICAqL1xuICAgIHJlcGxhY2UoXG4gICAgICAgIG9sZE1vZGlmaWVyOiBNb2RpZmllciB8IENvbnN0cnVjdG9yPE1vZGlmaWVyPixcbiAgICAgICAgbmV3TW9kaWZpZXI6IE1vZGlmaWVyIHwgQ29uc3RydWN0b3I8TW9kaWZpZXI+LFxuICAgICk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBvbGRNb2RpZmllckluZGV4ID0gdGhpcy5fY29udGVudHMuZmluZEluZGV4KG1vZGlmaWVySW5zdGFuY2UgPT4ge1xuICAgICAgICAgICAgaWYgKG9sZE1vZGlmaWVyIGluc3RhbmNlb2YgTW9kaWZpZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbW9kaWZpZXJJbnN0YW5jZSA9PT0gb2xkTW9kaWZpZXI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBtb2RpZmllckluc3RhbmNlIGluc3RhbmNlb2Ygb2xkTW9kaWZpZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAob2xkTW9kaWZpZXJJbmRleCA9PT0gLTEpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kKG5ld01vZGlmaWVyKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG1vZGlmaWVyID0gbmV3TW9kaWZpZXIgaW5zdGFuY2VvZiBNb2RpZmllciA/IG5ld01vZGlmaWVyIDogbmV3IG5ld01vZGlmaWVyKCk7XG4gICAgICAgICAgICB0aGlzW29sZE1vZGlmaWVySW5kZXhdID0gbW9kaWZpZXI7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXBsYWNlIHRoZSBtb2RpZmllcnMgdGhhdCBoYXZlIHRoZSBzYW1lIGNvbnN0cnVjdG9yLiBPdGhlcndpc2UgYXBwZW5kXG4gICAgICogdGhlbS5cbiAgICAgKi9cbiAgICByZXBsYWNlT3JBcHBlbmQobW9kaWZpZXJzOiBNb2RpZmllcnMpOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBtb2RpZmllciBvZiBtb2RpZmllcnMuZ2V0Q29udGVudCgpKSB7XG4gICAgICAgICAgICBjb25zdCBmb3VuZE1vZGlmaWVyID0gdGhpcy5maW5kKG1vZGlmaWVyLmNvbnN0cnVjdG9yKTtcbiAgICAgICAgICAgIGlmIChmb3VuZE1vZGlmaWVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXBsYWNlKGZvdW5kTW9kaWZpZXIsIG1vZGlmaWVyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmQobW9kaWZpZXIuY2xvbmUoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIHRoZSBmaXJzdCBtb2RpZmllciBpbiB0aGUgYXJyYXkgdGhhdCBpcyBhbiBpbnN0YW5jZSBvZiB0aGUgZ2l2ZW5cbiAgICAgKiBtb2RpZmllciBjbGFzcyBvciB0aGF0IG1hdGNoZXMgdGhlIHBhcnRpY3VsYXIgaW5zdGFuY2UgcGFzc2VkLlxuICAgICAqIElmIG5vIG1vZGlmaWVyIHdhcyBmb3VuZCwgYWRkIHRoZSBnaXZlbiBtb2RpZmllciBpbnN0ZWFkLlxuICAgICAqIElmIHRoZSBnaXZlbiBuZXcgbW9kaWZpZXIgaXMgYSBjbGFzcywgaW5zdGFudGlhdGUgaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbW9kaWZpZXJcbiAgICAgKi9cbiAgICB0b2dnbGUobW9kaWZpZXI6IE1vZGlmaWVyIHwgQ29uc3RydWN0b3I8TW9kaWZpZXI+KTogdm9pZCB7XG4gICAgICAgIHRoaXMucmVtb3ZlKG1vZGlmaWVyKSB8fCB0aGlzLmFwcGVuZChtb2RpZmllcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBtb2RpZmllcnMgaW4gdGhpcyBhcnJheSBhcmUgdGhlIHNhbWUgYXMgdGhlIG1vZGlmaWVyc1xuICAgICAqIGluIHRoZSBnaXZlbiBhcnJheSAoYXMgZGVmaW5lZCBieSB0aGUgYGlzU2FtZUFzYCBtZXRob2RzIG9mIHRoZVxuICAgICAqIG1vZGlmaWVycykuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXJNb2RpZmllcnNcbiAgICAgKi9cbiAgICBhcmVTYW1lQXMob3RoZXJNb2RpZmllcnM6IE1vZGlmaWVycyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBtb2RpZmllcnNNYXAgPSBuZXcgTWFwKFxuICAgICAgICAgICAgdGhpcy5fY29udGVudHMubWFwKGEgPT4gW2EsIG90aGVyTW9kaWZpZXJzLmZpbmQoYiA9PiBhLmlzU2FtZUFzKGIpKV0pLFxuICAgICAgICApO1xuICAgICAgICBjb25zdCBhTW9kaWZpZXJzID0gQXJyYXkuZnJvbShtb2RpZmllcnNNYXAua2V5cygpKTtcbiAgICAgICAgY29uc3QgYk1vZGlmaWVycyA9IEFycmF5LmZyb20obW9kaWZpZXJzTWFwLnZhbHVlcygpKTtcblxuICAgICAgICBjb25zdCBhbGxBaW5CID0gYU1vZGlmaWVycy5ldmVyeShhID0+IGEuaXNTYW1lQXMobW9kaWZpZXJzTWFwLmdldChhKSkpO1xuICAgICAgICBjb25zdCBhbGxCaW5BID0gb3RoZXJNb2RpZmllcnMuZXZlcnkoXG4gICAgICAgICAgICBiID0+IGJNb2RpZmllcnMuaW5jbHVkZXMoYikgfHwgYi5pc1NhbWVBcyh0aGlzLmZpbmQoYikpLFxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gYWxsQWluQiAmJiBhbGxCaW5BO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm94eSBmb3IgdGhlIG5hdGl2ZSBgc29tZWAgbWV0aG9kIG9mIGBBcnJheWAsIGNhbGxlZCBvbiBgdGhpcy5fY29udGVudHNgLlxuICAgICAqXG4gICAgICogQHNlZSBBcnJheS5zb21lXG4gICAgICogQHBhcmFtIGNhbGxiYWNrZm5cbiAgICAgKi9cbiAgICBzb21lKGNhbGxiYWNrZm46ICh2YWx1ZTogTW9kaWZpZXIsIGluZGV4OiBudW1iZXIsIGFycmF5OiBNb2RpZmllcltdKSA9PiB1bmtub3duKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50cy5zb21lKGNhbGxiYWNrZm4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcm94eSBmb3IgdGhlIG5hdGl2ZSBgZXZlcnlgIG1ldGhvZCBvZiBgQXJyYXlgLCBjYWxsZWQgb24gYHRoaXMuX2NvbnRlbnRzYC5cbiAgICAgKlxuICAgICAqIEBzZWUgQXJyYXkuZXZlcnlcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2tmblxuICAgICAqL1xuICAgIGV2ZXJ5KGNhbGxiYWNrZm46ICh2YWx1ZTogTW9kaWZpZXIsIGluZGV4OiBudW1iZXIsIGFycmF5OiBNb2RpZmllcltdKSA9PiB1bmtub3duKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50cy5ldmVyeShjYWxsYmFja2ZuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJveHkgZm9yIHRoZSBuYXRpdmUgYG1hcGAgbWV0aG9kIG9mIGBBcnJheWAsIGNhbGxlZCBvbiBgdGhpcy5fY29udGVudHNgLlxuICAgICAqXG4gICAgICogQHNlZSBBcnJheS5tYXBcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2tmblxuICAgICAqL1xuICAgIG1hcDxUPihjYWxsYmFja2ZuOiAodmFsdWU6IE1vZGlmaWVyLCBpbmRleDogbnVtYmVyLCBhcnJheTogTW9kaWZpZXJbXSkgPT4gVCk6IFRbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jb250ZW50cy5tYXAoY2FsbGJhY2tmbik7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUsIFJlbGF0aXZlUG9zaXRpb24sIFByZWRpY2F0ZSwgVHlwZWd1YXJkLCBpc0xlYWYgfSBmcm9tICcuL1ZOb2RlJztcbmltcG9ydCB7IENvbnN0cnVjdG9yLCBub2RlTGVuZ3RoIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuL0NvbnRhaW5lck5vZGUnO1xuaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4vQXRvbWljTm9kZSc7XG5pbXBvcnQgeyBNb2RpZmllcnMgfSBmcm9tICcuLi9Nb2RpZmllcnMnO1xuXG5sZXQgaWQgPSAwO1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0Tm9kZSB7XG4gICAgcmVhZG9ubHkgaWQgPSBpZDtcbiAgICBlZGl0YWJsZSA9IHRydWU7XG4gICAgdGFuZ2libGUgPSB0cnVlO1xuICAgIGJyZWFrYWJsZSA9IHRydWU7XG4gICAgcGFyZW50OiBWTm9kZTtcbiAgICBtb2RpZmllcnMgPSBuZXcgTW9kaWZpZXJzKCk7XG4gICAgY2hpbGRWTm9kZXM6IFZOb2RlW107XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHdoZXRoZXIgdGhlIGdpdmVuIHByZWRpY2F0ZSBpcyBhIGNvbnN0cnVjdG9yIG9mIGEgVk5vZGUgY2xhc3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcHJlZGljYXRlIFRoZSBwcmVkaWNhdGUgdG8gY2hlY2suXG4gICAgICovXG4gICAgc3RhdGljIGlzQ29uc3RydWN0b3IoXG4gICAgICAgIHByZWRpY2F0ZTogUHJlZGljYXRlLFxuICAgICk6IHByZWRpY2F0ZSBpcyBDb25zdHJ1Y3RvcjxDb250YWluZXJOb2RlPiB8IENvbnN0cnVjdG9yPEF0b21pY05vZGU+IHtcbiAgICAgICAgcmV0dXJuIHByZWRpY2F0ZS5wcm90b3R5cGUgaW5zdGFuY2VvZiBBYnN0cmFjdE5vZGU7XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIGlkKys7XG4gICAgfVxuXG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IubmFtZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSB0ZXh0IGNvbnRlbnQgb2YgdGhpcyBub2RlLlxuICAgICAqL1xuICAgIGdldCB0ZXh0Q29udGVudCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbigpXG4gICAgICAgICAgICAubWFwKGNoaWxkID0+IGNoaWxkLnRleHRDb250ZW50KVxuICAgICAgICAgICAgLmpvaW4oJycpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5uYW1lO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBUcmFuc2Zvcm0gdGhlIGdpdmVuIERPTSBsb2NhdGlvbiBpbnRvIGl0cyBWRG9jdW1lbnQgY291bnRlcnBhcnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9tTm9kZSBET00gbm9kZSBjb3JyZXNwb25kaW5nIHRvIHRoaXMgVk5vZGVcbiAgICAgKiBAcGFyYW0gb2Zmc2V0IFRoZSBvZmZzZXQgb2YgdGhlIGxvY2F0aW9uIGluIHRoZSBnaXZlbiBkb21Ob2RlXG4gICAgICovXG4gICAgbG9jYXRlKGRvbU5vZGU6IE5vZGUsIG9mZnNldDogbnVtYmVyKTogW3RoaXMsIFJlbGF0aXZlUG9zaXRpb25dIHtcbiAgICAgICAgLy8gUG9zaXRpb24gYEJFRk9SRWAgaXMgcHJlZmVycmVkIG92ZXIgYEFGVEVSYCwgdW5sZXNzIHRoZSBvZmZzZXRcbiAgICAgICAgLy8gb3ZlcmZsb3dzIHRoZSBjaGlsZHJlbiBsaXN0LCBpbiB3aGljaCBjYXNlIGBBRlRFUmAgaXMgbmVlZGVkLlxuICAgICAgICBsZXQgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRTtcbiAgICAgICAgY29uc3QgZG9tTm9kZUxlbmd0aCA9IG5vZGVMZW5ndGgoZG9tTm9kZSk7XG4gICAgICAgIGlmIChkb21Ob2RlTGVuZ3RoICYmIG9mZnNldCA+PSBkb21Ob2RlTGVuZ3RoKSB7XG4gICAgICAgICAgICBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQUZURVI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFt0aGlzLCBwb3NpdGlvbl07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgbmV3IFZOb2RlIHdpdGggdGhlIHNhbWUgdHlwZSBhbmQgYXR0cmlidXRlcyBhcyB0aGlzIFZOb2RlLlxuICAgICAqL1xuICAgIGNsb25lKHBhcmFtcz86IHt9KTogdGhpcyB7XG4gICAgICAgIGNvbnN0IGNsb25lID0gbmV3IHRoaXMuY29uc3RydWN0b3IocGFyYW1zKTtcbiAgICAgICAgY2xvbmUubW9kaWZpZXJzID0gdGhpcy5tb2RpZmllcnMuY2xvbmUoKTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlcGxhY2UgdGhpcyBWTm9kZSB3aXRoIHRoZSBnaXZlbiBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgcmVwbGFjZVdpdGgobm9kZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5iZWZvcmUobm9kZSk7XG4gICAgICAgIHRoaXMubWVyZ2VXaXRoKG5vZGUpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcm9wZXJ0aWVzXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBsZW5ndGggb2YgdGhpcyBWTm9kZS5cbiAgICAgKi9cbiAgICBnZXQgbGVuZ3RoKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuKCkubGVuZ3RoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gd2hldGhlciB0aGlzIG5vZGUgaXMgYW4gaW5zdGFuY2Ugb2YgdGhlIGdpdmVuIFZOb2RlIGNsYXNzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHByZWRpY2F0ZSBUaGUgc3ViY2xhc3Mgb2YgVk5vZGUgdG8gdGVzdCB0aGlzIG5vZGUgYWdhaW5zdC5cbiAgICAgKi9cbiAgICBpczxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZTogQ29uc3RydWN0b3I8VD4gfCBUeXBlZ3VhcmQ8VD4pOiB0aGlzIGlzIFQ7XG4gICAgaXMocHJlZGljYXRlOiBQcmVkaWNhdGUpOiBmYWxzZTtcbiAgICBpcyhwcmVkaWNhdGU6IFByZWRpY2F0ZSk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAoQWJzdHJhY3ROb2RlLmlzQ29uc3RydWN0b3IocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMgaW5zdGFuY2VvZiBwcmVkaWNhdGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gcHJlZGljYXRlKHRoaXMgYXMgVk5vZGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRlc3QgdGhpcyBub2RlIGFnYWluc3QgdGhlIGdpdmVuIHByZWRpY2F0ZS5cbiAgICAgKlxuICAgICAqIElmIHRoZSBwcmVkaWNhdGUgaXMgZmFsc3ksIHJldHVybiB0cnVlLiBJZiB0aGUgcHJlZGljYXRlIGlzIGEgY29uc3RydWN0b3JcbiAgICAgKiBvZiBhIFZOb2RlIGNsYXNzLCByZXR1cm4gd2hldGhlciB0aGlzIG5vZGUgaXMgYW4gaW5zdGFuY2Ugb2YgdGhhdCBjbGFzcy5cbiAgICAgKiBJZiB0aGUgcHJlZGljYXRlIGlzIGEgc3RhbmRhcmQgZnVuY3Rpb24sIHJldHVybiB0aGUgcmVzdWx0IG9mIHRoaXNcbiAgICAgKiBmdW5jdGlvbiB3aGVuIGNhbGxlZCB3aXRoIHRoZSBub2RlIGFzIHBhcmFtZXRlci5cbiAgICAgKlxuICAgICAqXG4gICAgICogQHBhcmFtIHByZWRpY2F0ZSBUaGUgcHJlZGljYXRlIHRvIHRlc3QgdGhpcyBub2RlIGFnYWluc3QuXG4gICAgICovXG4gICAgdGVzdChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCFwcmVkaWNhdGUpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2UgaWYgKEFic3RyYWN0Tm9kZS5pc0NvbnN0cnVjdG9yKHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzIGluc3RhbmNlb2YgcHJlZGljYXRlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHByZWRpY2F0ZSh0aGlzIGFzIFZOb2RlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGlzIFZOb2RlIGNvbWVzIGJlZm9yZSB0aGUgZ2l2ZW4gVk5vZGUgaW4gdGhlIHByZS1vcmRlclxuICAgICAqIHRyYXZlcnNhbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2Tm9kZVxuICAgICAqL1xuICAgIGlzQmVmb3JlKHZOb2RlOiBWTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB0aGlzUGF0aCA9IFt0aGlzIGFzIFZOb2RlLCAuLi50aGlzLmFuY2VzdG9ycygpXTtcbiAgICAgICAgY29uc3Qgbm9kZVBhdGggPSBbdk5vZGUsIC4uLnZOb2RlLmFuY2VzdG9ycygpXTtcbiAgICAgICAgLy8gRmluZCB0aGUgbGFzdCBkaXN0aW5jdCBhbmNlc3RvcnMgaW4gdGhlIHBhdGggdG8gdGhlIHJvb3QuXG4gICAgICAgIGxldCB0aGlzQW5jZXN0b3I6IFZOb2RlO1xuICAgICAgICBsZXQgbm9kZUFuY2VzdG9yOiBWTm9kZTtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdGhpc0FuY2VzdG9yID0gdGhpc1BhdGgucG9wKCk7XG4gICAgICAgICAgICBub2RlQW5jZXN0b3IgPSBub2RlUGF0aC5wb3AoKTtcbiAgICAgICAgfSB3aGlsZSAodGhpc0FuY2VzdG9yICYmIG5vZGVBbmNlc3RvciAmJiB0aGlzQW5jZXN0b3IgPT09IG5vZGVBbmNlc3Rvcik7XG5cbiAgICAgICAgaWYgKHRoaXNBbmNlc3RvciAmJiBub2RlQW5jZXN0b3IpIHtcbiAgICAgICAgICAgIGNvbnN0IHRoaXNQYXJlbnQgPSB0aGlzQW5jZXN0b3IucGFyZW50O1xuICAgICAgICAgICAgY29uc3Qgbm9kZVBhcmVudCA9IG5vZGVBbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgICAgICBpZiAodGhpc1BhcmVudCAmJiB0aGlzUGFyZW50ID09PSBub2RlUGFyZW50KSB7XG4gICAgICAgICAgICAgICAgLy8gQ29tcGFyZSB0aGUgaW5kaWNlcyBvZiBib3RoIGFuY2VzdG9ycyBpbiB0aGVpciBzaGFyZWQgcGFyZW50LlxuICAgICAgICAgICAgICAgIGNvbnN0IHRoaXNJbmRleCA9IHRoaXNQYXJlbnQuY2hpbGRWTm9kZXMuaW5kZXhPZih0aGlzQW5jZXN0b3IpO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVJbmRleCA9IG5vZGVQYXJlbnQuY2hpbGRWTm9kZXMuaW5kZXhPZihub2RlQW5jZXN0b3IpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzSW5kZXggPCBub2RlSW5kZXg7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFRoZSB2ZXJ5IGZpcnN0IGFuY2VzdG9yIG9mIGJvdGggbm9kZXMgYXJlIGRpZmZlcmVudCBzb1xuICAgICAgICAgICAgICAgIC8vIHRoZXkgYWN0dWFsbHkgY29tZSBmcm9tIHR3byBkaWZmZXJlbnQgdHJlZXMgYWx0b2dldGhlci5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBPbmUgb2YgdGhlIG5vZGVzIHdhcyBpbiB0aGUgYW5jZXN0b3JzIHBhdGggb2YgdGhlIG90aGVyLlxuICAgICAgICAgICAgcmV0dXJuICF0aGlzQW5jZXN0b3IgJiYgISFub2RlQW5jZXN0b3I7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhpcyBWTm9kZSBjb21lcyBhZnRlciB0aGUgZ2l2ZW4gVk5vZGUgaW4gdGhlIHByZS1vcmRlclxuICAgICAqIHRyYXZlcnNhbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2Tm9kZVxuICAgICAqL1xuICAgIGlzQWZ0ZXIodk5vZGU6IFZOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB2Tm9kZS5pc0JlZm9yZSh0aGlzIGFzIFZOb2RlKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQnJvd3NpbmcgYW5jZXN0b3JzIGFuZCBzaWJsaW5ncy5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGNsb3Nlc3Qgbm9kZSBmcm9tIHRoaXMgbm9kZSB0aGF0IG1hdGNoZXMgdGhlIGdpdmVuIHByZWRpY2F0ZS5cbiAgICAgKiBTdGFydCB3aXRoIHRoaXMgbm9kZSB0aGVuIGdvIHVwIHRoZSBhbmNlc3RvcnMgdHJlZSB1bnRpbCBmaW5kaW5nIGEgbWF0Y2guXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcHJlZGljYXRlXG4gICAgICovXG4gICAgY2xvc2VzdDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZTogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBjbG9zZXN0KHByZWRpY2F0ZTogUHJlZGljYXRlKTogVk5vZGU7XG4gICAgY2xvc2VzdChwcmVkaWNhdGU6IFByZWRpY2F0ZSk6IFZOb2RlIHtcbiAgICAgICAgaWYgKHRoaXMudGVzdChwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcyBhcyBWTm9kZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmFuY2VzdG9yKHByZWRpY2F0ZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBmaXJzdCBhbmNlc3RvciBvZiB0aGlzIFZOb2RlIHRoYXQgc2F0aXNmaWVzIHRoZSBnaXZlblxuICAgICAqIHByZWRpY2F0ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIGFuY2VzdG9yPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBhbmNlc3RvcihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBhbmNlc3RvcihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIGxldCBhbmNlc3RvciA9IHRoaXMucGFyZW50O1xuICAgICAgICB3aGlsZSAoYW5jZXN0b3IgJiYgIWFuY2VzdG9yLnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFuY2VzdG9yO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYWxsIGFuY2VzdG9ycyBvZiB0aGUgY3VycmVudCBub2RlIHRoYXQgc2F0aXNmeSB0aGUgZ2l2ZW5cbiAgICAgKiBwcmVkaWNhdGUuIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiByZXR1cm4gYWxsIHRoZSBhbmNlc3RvcnMgb2YgdGhlXG4gICAgICogY3VycmVudCBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgYW5jZXN0b3JzPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVFtdO1xuICAgIGFuY2VzdG9ycyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIGFuY2VzdG9ycyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdIHtcbiAgICAgICAgY29uc3QgYW5jZXN0b3JzOiBWTm9kZVtdID0gW107XG4gICAgICAgIGxldCBwYXJlbnQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgd2hpbGUgKHBhcmVudCkge1xuICAgICAgICAgICAgaWYgKHBhcmVudC50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgICAgICBhbmNlc3RvcnMucHVzaChwYXJlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYW5jZXN0b3JzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxvd2VzdCBjb21tb24gYW5jZXN0b3IgYmV0d2VlbiB0aGlzIFZOb2RlIGFuZCB0aGUgZ2l2ZW4gb25lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBjb21tb25BbmNlc3RvcjxUIGV4dGVuZHMgVk5vZGU+KG5vZGU6IFZOb2RlLCBwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIGNvbW1vbkFuY2VzdG9yKG5vZGU6IFZOb2RlLCBwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBjb21tb25BbmNlc3Rvcihub2RlOiBWTm9kZSwgcHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGUge1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5wYXJlbnQgPT09IG5vZGUucGFyZW50ICYmIHRoaXMucGFyZW50LnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHRoaXNQYXRoID0gW3RoaXMgYXMgVk5vZGUsIC4uLnRoaXMuYW5jZXN0b3JzKHByZWRpY2F0ZSldO1xuICAgICAgICBjb25zdCBub2RlUGF0aCA9IFtub2RlLCAuLi5ub2RlLmFuY2VzdG9ycyhwcmVkaWNhdGUpXTtcbiAgICAgICAgbGV0IGNvbW1vbkFuY2VzdG9yOiBWTm9kZTtcbiAgICAgICAgd2hpbGUgKHRoaXNQYXRoW3RoaXNQYXRoLmxlbmd0aCAtIDFdID09PSBub2RlUGF0aC5wb3AoKSkge1xuICAgICAgICAgICAgY29tbW9uQW5jZXN0b3IgPSB0aGlzUGF0aC5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29tbW9uQW5jZXN0b3I7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgc2libGluZ3Mgb2YgdGhpcyBWTm9kZSB3aGljaCBzYXRpc2Z5IHRoZSBnaXZlbiBwcmVkaWNhdGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBzaWJsaW5nczxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFRbXTtcbiAgICBzaWJsaW5ncyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIHNpYmxpbmdzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBzaWJsaW5nczogVk5vZGVbXSA9IFtdO1xuICAgICAgICBsZXQgc2libGluZzogVk5vZGUgPSB0aGlzLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICB3aGlsZSAoc2libGluZykge1xuICAgICAgICAgICAgaWYgKHNpYmxpbmcudGVzdChwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICAgICAgc2libGluZ3MudW5zaGlmdChzaWJsaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICB9XG4gICAgICAgIHNpYmxpbmcgPSB0aGlzLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIHdoaWxlIChzaWJsaW5nKSB7XG4gICAgICAgICAgICBpZiAoc2libGluZy50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgICAgICBzaWJsaW5ncy5wdXNoKHNpYmxpbmcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc2libGluZyA9IHNpYmxpbmcubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2libGluZ3M7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbm9kZXMgYWRqYWNlbnQgdG8gdGhpcyBWTm9kZSB0aGF0IHNhdGlzZnkgdGhlIGdpdmVuIHByZWRpY2F0ZS5cbiAgICAgKi9cbiAgICBhZGphY2VudHM8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUW107XG4gICAgYWRqYWNlbnRzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW107XG4gICAgYWRqYWNlbnRzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBhZGphY2VudHM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgbGV0IHNpYmxpbmc6IFZOb2RlID0gdGhpcy5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgd2hpbGUgKHNpYmxpbmcgJiYgc2libGluZy50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgIGFkamFjZW50cy51bnNoaWZ0KHNpYmxpbmcpO1xuICAgICAgICAgICAgc2libGluZyA9IHNpYmxpbmcucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgc2libGluZyA9IHRoaXMubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgd2hpbGUgKHNpYmxpbmcgJiYgc2libGluZy50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgIGFkamFjZW50cy5wdXNoKHNpYmxpbmcpO1xuICAgICAgICAgICAgc2libGluZyA9IHNpYmxpbmcubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWRqYWNlbnRzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHByZXZpb3VzIHNpYmxpbmcgb2YgdGhpcyBWTm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgcHJlZGljYXRlLlxuICAgICAqIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiwgcmV0dXJuIHRoZSBwcmV2aW91cyBzaWJsaW5nIG9mIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBwcmV2aW91c1NpYmxpbmc8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIHByZXZpb3VzU2libGluZyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBwcmV2aW91c1NpYmxpbmcocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGUge1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50KSByZXR1cm47XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5wYXJlbnQuY2hpbGRWTm9kZXMuaW5kZXhPZih0aGlzIGFzIFZOb2RlKTtcbiAgICAgICAgbGV0IHNpYmxpbmcgPSB0aGlzLnBhcmVudC5jaGlsZFZOb2Rlc1tpbmRleCAtIDFdO1xuICAgICAgICAvLyBTa2lwIGlnbm9yZWQgc2libGluZ3MgYW5kIHRob3NlIGZhaWxpbmcgdGhlIHByZWRpY2F0ZSB0ZXN0LlxuICAgICAgICB3aGlsZSAoc2libGluZyAmJiAhKHNpYmxpbmcudGFuZ2libGUgJiYgc2libGluZy50ZXN0KHByZWRpY2F0ZSkpKSB7XG4gICAgICAgICAgICBzaWJsaW5nID0gc2libGluZy5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc2libGluZztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBuZXh0IHNpYmxpbmcgb2YgdGhpcyBWTm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgZ2l2ZW4gcHJlZGljYXRlLlxuICAgICAqIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiwgcmV0dXJuIHRoZSBuZXh0IHNpYmxpbmcgb2YgdGhpcyBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIG5leHRTaWJsaW5nPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBuZXh0U2libGluZyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBuZXh0U2libGluZyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIGlmICghdGhpcy5wYXJlbnQpIHJldHVybjtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnBhcmVudC5jaGlsZFZOb2Rlcy5pbmRleE9mKHRoaXMgYXMgVk5vZGUpO1xuICAgICAgICBsZXQgc2libGluZyA9IHRoaXMucGFyZW50LmNoaWxkVk5vZGVzW2luZGV4ICsgMV07XG4gICAgICAgIC8vIFNraXAgaWdub3JlZCBzaWJsaW5ncyBhbmQgdGhvc2UgZmFpbGluZyB0aGUgcHJlZGljYXRlIHRlc3QuXG4gICAgICAgIHdoaWxlIChzaWJsaW5nICYmICEoc2libGluZy50YW5naWJsZSAmJiBzaWJsaW5nLnRlc3QocHJlZGljYXRlKSkpIHtcbiAgICAgICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNpYmxpbmc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgcHJldmlvdXMgbm9kZSBpbiBhIGRlcHRoLWZpcnN0IHByZS1vcmRlciB0cmF2ZXJzYWwgb2YgdGhlXG4gICAgICogdHJlZSB0aGF0IHNhdGlzZmllcyB0aGUgZ2l2ZW4gcHJlZGljYXRlLiBJZiBubyBwcmVkaWNhdGUgaXMgZ2l2ZW4gcmV0dXJuXG4gICAgICogdGhlIHByZXZpb3VzIG5vZGUgaW4gYSBkZXB0aC1maXJzdCBwcmUtb3JkZXIgdHJhdmVyc2FsIG9mIHRoZSB0cmVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgcHJldmlvdXM8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIHByZXZpb3VzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIHByZXZpb3VzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlIHtcbiAgICAgICAgbGV0IHByZXZpb3VzID0gdGhpcy5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgaWYgKHByZXZpb3VzKSB7XG4gICAgICAgICAgICAvLyBUaGUgcHJldmlvdXMgbm9kZSBpcyB0aGUgbGFzdCBsZWFmIG9mIHRoZSBwcmV2aW91cyBzaWJsaW5nLlxuICAgICAgICAgICAgcHJldmlvdXMgPSBwcmV2aW91cy5sYXN0TGVhZigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gSWYgaXQgaGFzIG5vIHByZXZpb3VzIHNpYmxpbmcgdGhlbiBjbGltYiB1cCB0byB0aGUgcGFyZW50LlxuICAgICAgICAgICAgcHJldmlvdXMgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAocHJldmlvdXMgJiYgIXByZXZpb3VzLnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgcHJldmlvdXMgPSBwcmV2aW91cy5wcmV2aW91cygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmV2aW91cztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBuZXh0IG5vZGUgaW4gYSBkZXB0aC1maXJzdCBwcmUtb3JkZXIgdHJhdmVyc2FsIG9mIHRoZSB0cmVlXG4gICAgICogdGhhdCBzYXRpc2ZpZXMgdGhlIGdpdmVuIHByZWRpY2F0ZS4gSWYgbm8gcHJlZGljYXRlIGlzIGdpdmVuIHJldHVybiB0aGVcbiAgICAgKiBuZXh0IG5vZGUgaW4gYSBkZXB0aC1maXJzdCBwcmUtb3JkZXIgdHJhdmVyc2FsIG9mIHRoZSB0cmVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgbmV4dDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgbmV4dChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBuZXh0KHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlIHtcbiAgICAgICAgLy8gVGhlIG5vZGUgYWZ0ZXIgbm9kZSBpcyBpdHMgZmlyc3QgY2hpbGQuXG4gICAgICAgIGxldCBuZXh0ID0gdGhpcy5maXJzdENoaWxkKCk7XG4gICAgICAgIGlmICghbmV4dCkge1xuICAgICAgICAgICAgLy8gSWYgaXQgaGFzIG5vIGNoaWxkcmVuIHRoZW4gaXQgaXMgaXRzIG5leHQgc2libGluZy5cbiAgICAgICAgICAgIG5leHQgPSB0aGlzLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFuZXh0KSB7XG4gICAgICAgICAgICAvLyBJZiBpdCBoYXMgbm8gc2libGluZ3MgZWl0aGVyIHRoZW4gY2xpbWIgdXAgdG8gdGhlIGNsb3Nlc3QgcGFyZW50XG4gICAgICAgICAgICAvLyB3aGljaCBoYXMgYSBuZXh0IHNpYmlsaW5nLlxuICAgICAgICAgICAgbGV0IGFuY2VzdG9yID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICB3aGlsZSAoYW5jZXN0b3IgJiYgIWFuY2VzdG9yLm5leHRTaWJsaW5nKCkpIHtcbiAgICAgICAgICAgICAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5leHQgPSBhbmNlc3RvciAmJiBhbmNlc3Rvci5uZXh0U2libGluZygpO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlIChuZXh0ICYmICFuZXh0LnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgbmV4dCA9IG5leHQubmV4dCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXh0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHByZXZpb3VzIGxlYWYgaW4gYSBkZXB0aC1maXJzdCBwcmUtb3JkZXIgdHJhdmVyc2FsIG9mIHRoZVxuICAgICAqIHRyZWUgdGhhdCBzYXRpc2ZpZXMgdGhlIGdpdmVuIHByZWRpY2F0ZS4gSWYgbm8gcHJlZGljYXRlIGlzIGdpdmVuIHJldHVyblxuICAgICAqIHRoZSBwcmV2aW91cyBsZWFmIGluIGEgZGVwdGgtZmlyc3QgcHJlLW9yZGVyIHRyYXZlcnNhbCBvZiB0aGUgdHJlZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIHByZXZpb3VzTGVhZjxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgcHJldmlvdXNMZWFmKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIHByZXZpb3VzTGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByZXZpb3VzKChub2RlOiBWTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGlzTGVhZihub2RlKSAmJiBub2RlLnRlc3QocHJlZGljYXRlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbmV4dCBsZWFmIGluIGEgZGVwdGgtZmlyc3QgcHJlLW9yZGVyIHRyYXZlcnNhbCBvZiB0aGUgdHJlZVxuICAgICAqIHRoYXQgc2F0aXNmaWVzIHRoZSBnaXZlbiBwcmVkaWNhdGUuIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiByZXR1cm4gdGhlXG4gICAgICogbmV4dCBsZWFmIGluIGEgZGVwdGgtZmlyc3QgcHJlLW9yZGVyIHRyYXZlcnNhbCBvZiB0aGUgdHJlZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIG5leHRMZWFmPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBuZXh0TGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBuZXh0TGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5leHQoKG5vZGU6IFZOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgICAgICByZXR1cm4gaXNMZWFmKG5vZGUpICYmIG5vZGUudGVzdChwcmVkaWNhdGUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFsbCBwcmV2aW91cyBzaWJsaW5ncyBvZiB0aGUgY3VycmVudCBub2RlIHRoYXQgc2F0aXNmeSB0aGUgZ2l2ZW5cbiAgICAgKiBwcmVkaWNhdGUuIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiByZXR1cm4gYWxsIHRoZSBwcmV2aW91cyBzaWJsaW5ncyBvZlxuICAgICAqIHRoZSBjdXJyZW50IG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBwcmV2aW91c1NpYmxpbmdzPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVFtdO1xuICAgIHByZXZpb3VzU2libGluZ3MocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXTtcbiAgICBwcmV2aW91c1NpYmxpbmdzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBwcmV2aW91c1NpYmxpbmdzOiBWTm9kZVtdID0gW107XG4gICAgICAgIGxldCBzaWJsaW5nID0gdGhpcy5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgd2hpbGUgKHNpYmxpbmcpIHtcbiAgICAgICAgICAgIGlmIChzaWJsaW5nLnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgICAgIHByZXZpb3VzU2libGluZ3MucHVzaChzaWJsaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwcmV2aW91c1NpYmxpbmdzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYWxsIG5leHQgc2libGluZ3Mgb2YgdGhlIGN1cnJlbnQgbm9kZSB0aGF0IHNhdGlzZnkgdGhlIGdpdmVuXG4gICAgICogcHJlZGljYXRlLiBJZiBubyBwcmVkaWNhdGUgaXMgZ2l2ZW4gcmV0dXJuIGFsbCB0aGUgbmV4dCBzaWJsaW5ncyBvZiB0aGVcbiAgICAgKiBjdXJyZW50IG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBuZXh0U2libGluZ3M8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUW107XG4gICAgbmV4dFNpYmxpbmdzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW107XG4gICAgbmV4dFNpYmxpbmdzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBuZXh0U2libGluZ3M6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgbGV0IHNpYmxpbmcgPSB0aGlzLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIHdoaWxlIChzaWJsaW5nKSB7XG4gICAgICAgICAgICBpZiAoc2libGluZy50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgICAgICBuZXh0U2libGluZ3MucHVzaChzaWJsaW5nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNpYmxpbmcgPSBzaWJsaW5nLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5leHRTaWJsaW5ncztcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gVXBkYXRpbmdcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnQgdGhlIGdpdmVuIFZOb2RlIGJlZm9yZSB0aGlzIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBiZWZvcmUobm9kZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhcmVudCkge1xuICAgICAgICAgICAgdGhyb3cgJ0Nhbm5vdCBpbnNlcnQgYSBWTm9kZSBiZWZvcmUgYSBWTm9kZSB3aXRoIG5vIHBhcmVudC4nO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucGFyZW50Lmluc2VydEJlZm9yZShub2RlLCB0aGlzIGFzIFZOb2RlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5zZXJ0IHRoZSBnaXZlbiBWTm9kZSBhZnRlciB0aGlzIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBhZnRlcihub2RlOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICB0aHJvdyAnQ2Fubm90IGluc2VydCBhIFZOb2RlIGFmdGVyIGEgVk5vZGUgd2l0aCBubyBwYXJlbnQuJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBhcmVudC5pbnNlcnRBZnRlcihub2RlLCB0aGlzIGFzIFZOb2RlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JhcCB0aGlzIG5vZGUgaW4gdGhlIGdpdmVuIG5vZGUgYnkgaW5zZXJ0aW5nIHRoZSBnaXZlbiBub2RlIGF0IHRoaXNcbiAgICAgKiBub2RlJ3MgcG9zaXRpb24gaW4gaXRzIHBhcmVudCBhbmQgYXBwZW5kaW5nIHRoaXMgbm9kZSB0byB0aGUgZ2l2ZW4gbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgd3JhcChub2RlOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICB0aGlzLmJlZm9yZShub2RlKTtcbiAgICAgICAgbm9kZS5hcHBlbmQodGhpcyBhcyBWTm9kZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGlzIG5vZGUuXG4gICAgICovXG4gICAgcmVtb3ZlKCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5wYXJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50LnJlbW92ZUNoaWxkKHRoaXMgYXMgVk5vZGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGlzIG5vZGUgaW4gZm9yd2FyZCBkaXJlY3Rpb24uIChlLmcuIGBEZWxldGVgIGtleSlcbiAgICAgKi9cbiAgICByZW1vdmVGb3J3YXJkKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlbW92ZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhpcyBub2RlIGluIGJhY2t3YXJkIGRpcmVjdGlvbi4gKGUuZy4gYEJhY2tzcGFjZWAga2V5KVxuICAgICAqL1xuICAgIHJlbW92ZUJhY2t3YXJkKCk6IHZvaWQge1xuICAgICAgICB0aGlzLnJlbW92ZSgpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBCcm93c2luZyBjaGlsZHJlbi4gVG8gYmUgaW1wbGVtZW50ZWQgYnkgdGhlIGNvbmNyZXRlIHN1YmNsYXNzLlxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgY2hpbGRyZW4gb2YgdGhpcyBWTm9kZSB3aGljaCBzYXRpc2Z5IHRoZSBnaXZlbiBwcmVkaWNhdGUuXG4gICAgICovXG4gICAgYWJzdHJhY3QgY2hpbGRyZW48VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUW107XG4gICAgYWJzdHJhY3QgY2hpbGRyZW4ocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGlzIFZOb2RlIGhhcyBjaGlsZHJlbi5cbiAgICAgKi9cbiAgICBhYnN0cmFjdCBoYXNDaGlsZHJlbigpOiBib29sZWFuO1xuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbnRoIGNoaWxkIG9mIHRoaXMgbm9kZS4gVGhlIGdpdmVuIGBuYCBhcmd1bWVudCBpcyB0aGUgMS1iYXNlZFxuICAgICAqIGluZGV4IG9mIHRoZSBwb3NpdGlvbiBvZiB0aGUgY2hpbGQgaW5zaWRlIHRoaXMgbm9kZSwgZXhjbHVkaW5nIG1hcmtlcnMuXG4gICAgICpcbiAgICAgKiBFeGFtcGxlczpcbiAgICAgKiBudGhDaGlsZCgxKSByZXR1cm5zIHRoZSBmaXJzdCAoMXN0KSBjaGlsZC5cbiAgICAgKiBudGhDaGlsZCgyKSByZXR1cm5zIHRoZSBzZWNvbmQgKDJuZCkgY2hpbGQuXG4gICAgICogbnRoQ2hpbGQoMykgcmV0dXJucyB0aGUgc2Vjb25kICgzcmQpIGNoaWxkLlxuICAgICAqIG50aENoaWxkKDQpIHJldHVybnMgdGhlIHNlY29uZCAoNHRoKSBjaGlsZC5cbiAgICAgKiAuLi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBuXG4gICAgICovXG4gICAgYWJzdHJhY3QgbnRoQ2hpbGQobjogbnVtYmVyKTogVk5vZGU7XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBmaXJzdCBjaGlsZCBvZiB0aGlzIFZOb2RlIHRoYXQgc2F0aXNmaWVzIHRoZSBnaXZlbiBwcmVkaWNhdGUuXG4gICAgICogSWYgbm8gcHJlZGljYXRlIGlzIGdpdmVuLCByZXR1cm4gdGhlIGZpcnN0IGNoaWxkIG9mIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBhYnN0cmFjdCBmaXJzdENoaWxkPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBhYnN0cmFjdCBmaXJzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbGFzdCBjaGlsZCBvZiB0aGlzIFZOb2RlIHRoYXQgc2F0aXNmaWVzIHRoZSBnaXZlbiBwcmVkaWNhdGUuXG4gICAgICogSWYgbm8gcHJlZGljYXRlIGlzIGdpdmVuLCByZXR1cm4gdGhlIGxhc3QgY2hpbGQgb2YgdGhpcyBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIGFic3RyYWN0IGxhc3RDaGlsZDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgYWJzdHJhY3QgbGFzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgZmlyc3QgbGVhZiBvZiB0aGlzIFZOb2RlIHRoYXQgc2F0aXNmaWVzIHRoZSBnaXZlbiBwcmVkaWNhdGUuXG4gICAgICogSWYgbm8gcHJlZGljYXRlIGlzIGdpdmVuLCByZXR1cm4gdGhlIGZpcnN0IGxlYWYgb2YgdGhpcyBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBbcHJlZGljYXRlXVxuICAgICAqL1xuICAgIGFic3RyYWN0IGZpcnN0TGVhZjxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgYWJzdHJhY3QgZmlyc3RMZWFmKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbGFzdCBsZWFmIG9mIHRoaXMgVk5vZGUgdGhhdCBzYXRpc2ZpZXMgdGhlIGdpdmVuIHByZWRpY2F0ZS5cbiAgICAgKiBJZiBubyBwcmVkaWNhdGUgaXMgZ2l2ZW4sIHJldHVybiB0aGUgbGFzdCBsZWFmIG9mIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBhYnN0cmFjdCBsYXN0TGVhZjxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgYWJzdHJhY3QgbGFzdExlYWYocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGU7XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFsbCBkZXNjZW5kYW50cyBvZiB0aGUgY3VycmVudCBub2RlIHRoYXQgc2F0aXNmeSB0aGUgZ2l2ZW5cbiAgICAgKiBwcmVkaWNhdGUuIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiByZXR1cm4gYWxsIHRoZSBhbmNlc3RvcnMgb2YgdGhlXG4gICAgICogY3VycmVudCBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgYWJzdHJhY3QgZGVzY2VuZGFudHM8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUW107XG4gICAgYWJzdHJhY3QgZGVzY2VuZGFudHMocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGZpcnN0IGRlc2NlbmRhbnQgb2YgdGhpcyBWTm9kZSB0aGF0IHNhdGlzZmllcyB0aGUgcHJlZGljYXRlLlxuICAgICAqIElmIG5vIHByZWRpY2F0ZSBpcyBnaXZlbiwgcmV0dXJuIHRoZSBmaXJzdCBkZXNjZW5kYW50IG9mIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW3ByZWRpY2F0ZV1cbiAgICAgKi9cbiAgICBhYnN0cmFjdCBmaXJzdERlc2NlbmRhbnQ8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIGFic3RyYWN0IGZpcnN0RGVzY2VuZGFudChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxhc3QgZGVzY2VuZGFudCBvZiB0aGlzIFZOb2RlIHRoYXQgc2F0aXNmaWVzIHRoZSBwcmVkaWNhdGUuXG4gICAgICogSWYgbm8gcHJlZGljYXRlIGlzIGdpdmVuLCByZXR1cm4gdGhlIGxhc3QgZGVzY2VuZGFudCBvZiB0aGlzIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtwcmVkaWNhdGVdXG4gICAgICovXG4gICAgYWJzdHJhY3QgbGFzdERlc2NlbmRhbnQ8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIGFic3RyYWN0IGxhc3REZXNjZW5kYW50KHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFVwZGF0aW5nIGNoaWxkcmVuLiBUbyBiZSBpbXBsZW1lbnRlZCBieSB0aGUgY29uY3JldGUgc3ViY2xhc3MuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUHJlcGVuZCBhIGNoaWxkIHRvIHRoaXMgbm9kZS5cbiAgICAgKi9cbiAgICBhYnN0cmFjdCBwcmVwZW5kKC4uLmNoaWxkcmVuOiBWTm9kZVtdKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiBBcHBlbmQgYSBjaGlsZCB0byB0aGlzIFZOb2RlLlxuICAgICAqL1xuICAgIGFic3RyYWN0IGFwcGVuZCguLi5jaGlsZHJlbjogVk5vZGVbXSk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICogSW5zZXJ0IHRoZSBnaXZlbiBub2RlIGJlZm9yZSB0aGUgZ2l2ZW4gcmVmZXJlbmNlICh3aGljaCBpcyBhIGNoaWxkIG9mXG4gICAgICogdGhpcyBWTm9kZSkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqIEBwYXJhbSByZWZlcmVuY2VcbiAgICAgKi9cbiAgICBhYnN0cmFjdCBpbnNlcnRCZWZvcmUobm9kZTogVk5vZGUsIHJlZmVyZW5jZTogVk5vZGUpOiB2b2lkO1xuICAgIC8qKlxuICAgICAqIEluc2VydCB0aGUgZ2l2ZW4gbm9kZSBhZnRlciB0aGUgZ2l2ZW4gcmVmZXJlbmNlIChhIGNoaWxkIG9mIHRoaXMgVk5vZGUpLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKiBAcGFyYW0gcmVmZXJlbmNlXG4gICAgICovXG4gICAgYWJzdHJhY3QgaW5zZXJ0QWZ0ZXIobm9kZTogVk5vZGUsIHJlZmVyZW5jZTogVk5vZGUpOiB2b2lkO1xuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGUgZ2l2ZW4gY2hpbGQgZnJvbSB0aGlzIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNoaWxkXG4gICAgICovXG4gICAgYWJzdHJhY3QgcmVtb3ZlQ2hpbGQoY2hpbGQ6IFZOb2RlKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYWxsIGNoaWxkcmVuIG9mIHRoaXMgVk5vZGUuXG4gICAgICovXG4gICAgYWJzdHJhY3QgZW1wdHkoKTogdm9pZDtcbiAgICAvKipcbiAgICAgKiBVbndyYXAgdGhpcyBub2RlIGJ5IG1vdmluZyBpdHMgY2hpbGRyZW4gYmVmb3JlIGl0IHRoZW4gcmVtb3ZpbmcgaXQuXG4gICAgICovXG4gICAgYWJzdHJhY3QgdW53cmFwKCk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICogU3BsaXQgdGhpcyBub2RlIGF0IHRoZSBnaXZlbiBjaGlsZCwgbW92aW5nIGl0IGFuZCBpdHMgbmV4dCBzaWJsaW5ncyBpbnRvXG4gICAgICogYSBkdXBsaWNhdGUgb2YgdGhpcyBWTm9kZSB0aGF0IGlzIGluc2VydGVkIGFmdGVyIHRoZSBvcmlnaW5hbC4gUmV0dXJuIHRoZVxuICAgICAqIGR1cGxpY2F0ZWQgVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2hpbGRcbiAgICAgKi9cbiAgICBhYnN0cmFjdCBzcGxpdEF0KGNoaWxkOiBWTm9kZSk6IHRoaXM7XG4gICAgLyoqXG4gICAgICogTWVyZ2UgdGhpcyBub2RlIHdpdGggdGhlIGdpdmVuIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5ld0NvbnRhaW5lciB0aGUgbmV3IGNvbnRhaW5lciBmb3IgdGhpcyBub2RlJ3MgY2hpbGRyZW5cbiAgICAgKi9cbiAgICBhYnN0cmFjdCBtZXJnZVdpdGgobmV3Q29udGFpbmVyOiBWTm9kZSk6IHZvaWQ7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZS5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBjb252ZW5pZW50IHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGlzIG5vZGUgYW5kIGl0c1xuICAgICAqIGRlc2NlbmRhbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIF9fcmVwclxuICAgICAqIEBwYXJhbSBsZXZlbFxuICAgICAqL1xuICAgIF9yZXByKF9fcmVwciA9ICcnLCBsZXZlbCA9IDApOiBzdHJpbmcge1xuICAgICAgICBfX3JlcHIgKz0gQXJyYXkobGV2ZWwgKiA0ICsgMSkuam9pbignICcpICsgdGhpcy5uYW1lICsgJyAoJyArIHRoaXMuaWQgKyAnKScgKyAnXFxuJztcbiAgICAgICAgdGhpcy5jaGlsZFZOb2Rlcy5mb3JFYWNoKGNoaWxkID0+IHtcbiAgICAgICAgICAgIF9fcmVwciA9IGNoaWxkLl9yZXByKF9fcmVwciwgbGV2ZWwgKyAxKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBfX3JlcHI7XG4gICAgfVxufVxuZXhwb3J0IGludGVyZmFjZSBBYnN0cmFjdE5vZGUge1xuICAgIGNvbnN0cnVjdG9yOiBuZXcgPFQgZXh0ZW5kcyBDb25zdHJ1Y3RvcjxWTm9kZT4+KC4uLmFyZ3M6IENvbnN0cnVjdG9yUGFyYW1ldGVyczxUPikgPT4gdGhpcztcbn1cbiIsImltcG9ydCB7IEFic3RyYWN0Tm9kZSB9IGZyb20gJy4vQWJzdHJhY3ROb2RlJztcbmltcG9ydCB7IFZOb2RlLCBQcmVkaWNhdGUgfSBmcm9tICcuL1ZOb2RlJztcbmltcG9ydCB7IEF0b21pY2l0eUVycm9yIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvc3JjL2Vycm9ycyc7XG5cbi8qKlxuICogVGhpcyBjbGFzcyBwcm92aWRlcyB0eXBpbmcgb3ZlcnJpZGVzIGZvciBtdWx0aXBsZSBWTm9kZSBtZXRob2RzIHdoaWNoIGFyZVxuICogc3VwcG9zZWQgdG8gdGFrZSBwYXJhbWV0ZXJzIGJ1dCB0aGF0IGFyZSB1bnVzZWQgaW4gdGhlIGNhc2Ugb2YgYXRvbWljIG5vZGVzLlxuICovXG4vKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW51c2VkLXZhcnMgKi9cbmV4cG9ydCBjbGFzcyBBdG9taWNOb2RlIGV4dGVuZHMgQWJzdHJhY3ROb2RlIHtcbiAgICBnZXQgY2hpbGRWTm9kZXMoKTogVk5vZGVbXSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQnJvd3NpbmcgY2hpbGRyZW4uXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuY2hpbGRyZW59LlxuICAgICAqXG4gICAgICogQHJldHVybiBSZXR1cm5zIGFuIGVtcHR5IGFycmF5IHNpbmNlIGFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIGNoaWxkcmVuPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVk5vZGVbXTtcbiAgICBjaGlsZHJlbihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIGNoaWxkcmVuKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmhhc0NoaWxkcmVufS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gUmV0dXJucyBgZmFsc2VgIHNpbmNlIGFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIGhhc0NoaWxkcmVuKCk6IGZhbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5udGhDaGlsZH0uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFJldHVybnMgYHVuZGVmaW5lZGAgc2luY2UgYW4gYXRvbWljIG5vZGUgY2Fubm90IGhhdmUgY2hpbGRyZW4uXG4gICAgICovXG4gICAgbnRoQ2hpbGQobjogbnVtYmVyKTogdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuZmlyc3RDaGlsZH0uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFJldHVybnMgYHVuZGVmaW5lZGAgc2luY2UgYW4gYXRvbWljIG5vZGUgY2Fubm90IGhhdmUgY2hpbGRyZW4uXG4gICAgICovXG4gICAgZmlyc3RDaGlsZDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IHVuZGVmaW5lZDtcbiAgICBmaXJzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHVuZGVmaW5lZDtcbiAgICBmaXJzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmxhc3RDaGlsZH0uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFJldHVybnMgYHVuZGVmaW5lZGAgc2luY2UgYW4gYXRvbWljIG5vZGUgY2Fubm90IGhhdmUgY2hpbGRyZW4uXG4gICAgICovXG4gICAgbGFzdENoaWxkPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogdW5kZWZpbmVkO1xuICAgIGxhc3RDaGlsZChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiB1bmRlZmluZWQ7XG4gICAgbGFzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmZpcnN0TGVhZn0uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFJldHVybnMgYHRoaXNgIHNpbmNlIGFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIGZpcnN0TGVhZjxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IHRoaXM7XG4gICAgZmlyc3RMZWFmKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHRoaXM7XG4gICAgZmlyc3RMZWFmKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHRoaXMge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUubGFzdExlYWZ9LlxuICAgICAqXG4gICAgICogQHJldHVybiBSZXR1cm5zIGB0aGlzYCBzaW5jZSBhbiBhdG9taWMgbm9kZSBjYW5ub3QgaGF2ZSBjaGlsZHJlbi5cbiAgICAgKi9cbiAgICBsYXN0TGVhZjxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IHRoaXM7XG4gICAgbGFzdExlYWYocHJlZGljYXRlPzogUHJlZGljYXRlKTogdGhpcztcbiAgICBsYXN0TGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiB0aGlzIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmZpcnN0RGVzY2VuZGFudH0uXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFJldHVybnMgYHVuZGVmaW5lZGAgc2luY2UgYW4gYXRvbWljIG5vZGUgY2Fubm90IGhhdmUgY2hpbGRyZW4uXG4gICAgICovXG4gICAgZmlyc3REZXNjZW5kYW50PFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogdW5kZWZpbmVkO1xuICAgIGZpcnN0RGVzY2VuZGFudChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiB1bmRlZmluZWQ7XG4gICAgZmlyc3REZXNjZW5kYW50KHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmxhc3REZXNjZW5kYW50fS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gUmV0dXJucyBgdW5kZWZpbmVkYCBzaW5jZSBhbiBhdG9taWMgbm9kZSBjYW5ub3QgaGF2ZSBjaGlsZHJlbi5cbiAgICAgKi9cbiAgICBsYXN0RGVzY2VuZGFudDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IHVuZGVmaW5lZDtcbiAgICBsYXN0RGVzY2VuZGFudChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiB1bmRlZmluZWQ7XG4gICAgbGFzdERlc2NlbmRhbnQocHJlZGljYXRlPzogUHJlZGljYXRlKTogdW5kZWZpbmVkIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuZGVzY2VuZGFudHN9LlxuICAgICAqXG4gICAgICogQHJldHVybiBSZXR1cm5zIGFuIGVtcHR5IGFycmF5IHNpbmNlIGFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIGRlc2NlbmRhbnRzPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVk5vZGVbXTtcbiAgICBkZXNjZW5kYW50cyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIGRlc2NlbmRhbnRzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFVwZGF0aW5nIGNoaWxkcmVuLlxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLnByZXBlbmR9LlxuICAgICAqXG4gICAgICogQHRocm93cyBBdG9taWNpdHlFcnJvciBBbiBhdG9taWMgbm9kZSBjYW5ub3QgaGF2ZSBjaGlsZHJlbi5cbiAgICAgKi9cbiAgICBwcmVwZW5kKC4uLmNoaWxkcmVuOiBWTm9kZVtdKTogdm9pZCB7XG4gICAgICAgIHRocm93IG5ldyBBdG9taWNpdHlFcnJvcih0aGlzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUucHJlcGVuZH0uXG4gICAgICpcbiAgICAgKiBAdGhyb3dzIEF0b21pY2l0eUVycm9yIEFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIGFwcGVuZCguLi5jaGlsZHJlbjogVk5vZGVbXSk6IHZvaWQge1xuICAgICAgICB0aHJvdyBuZXcgQXRvbWljaXR5RXJyb3IodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuaW5zZXJ0QmVmb3JlfS5cbiAgICAgKlxuICAgICAqIEB0aHJvd3MgQXRvbWljaXR5RXJyb3IgQW4gYXRvbWljIG5vZGUgY2Fubm90IGhhdmUgY2hpbGRyZW4uXG4gICAgICovXG4gICAgaW5zZXJ0QmVmb3JlKG5vZGU6IFZOb2RlLCByZWZlcmVuY2U6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIHRocm93IG5ldyBBdG9taWNpdHlFcnJvcih0aGlzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuaW5zZXJ0QWZ0ZXJ9LlxuICAgICAqXG4gICAgICogQHRocm93cyBBdG9taWNpdHlFcnJvciBBbiBhdG9taWMgbm9kZSBjYW5ub3QgaGF2ZSBjaGlsZHJlbi5cbiAgICAgKi9cbiAgICBpbnNlcnRBZnRlcihub2RlOiBWTm9kZSwgcmVmZXJlbmNlOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICB0aHJvdyBuZXcgQXRvbWljaXR5RXJyb3IodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmVtcHR5fS5cbiAgICAgKi9cbiAgICBlbXB0eSgpOiB2b2lkIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5yZW1vdmVDaGlsZH0uXG4gICAgICpcbiAgICAgKiBAdGhyb3dzIEF0b21pY2l0eUVycm9yIEFuIGF0b21pYyBub2RlIGNhbm5vdCBoYXZlIGNoaWxkcmVuLlxuICAgICAqL1xuICAgIHJlbW92ZUNoaWxkKGNoaWxkOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICB0aHJvdyBuZXcgQXRvbWljaXR5RXJyb3IodGhpcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLnNwbGl0QXR9LlxuICAgICAqXG4gICAgICogQHRocm93cyBBdG9taWNpdHlFcnJvciBBbiBhdG9taWMgbm9kZSBjYW5ub3QgYmUgc3BsaXQuXG4gICAgICovXG4gICAgc3BsaXRBdChjaGlsZDogVk5vZGUpOiB0aGlzIHtcbiAgICAgICAgdGhyb3cgbmV3IEF0b21pY2l0eUVycm9yKHRoaXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5tZXJnZVdpdGh9LlxuICAgICAqL1xuICAgIG1lcmdlV2l0aChuZXdDb250YWluZXI6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUudW53cmFwfS5cbiAgICAgKi9cbiAgICB1bndyYXAoKTogdm9pZCB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdE5vZGUgfSBmcm9tICcuL0Fic3RyYWN0Tm9kZSc7XG5pbXBvcnQgeyBWTm9kZSwgUHJlZGljYXRlLCBpc0xlYWYgfSBmcm9tICcuL1ZOb2RlJztcbmltcG9ydCB7IENoaWxkRXJyb3IgfSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvZXJyb3JzJztcblxuZXhwb3J0IGNsYXNzIENvbnRhaW5lck5vZGUgZXh0ZW5kcyBBYnN0cmFjdE5vZGUge1xuICAgIHJlYWRvbmx5IGNoaWxkVk5vZGVzOiBWTm9kZVtdID0gW107XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQnJvd3NpbmcgY2hpbGRyZW4uXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuY2hpbGRyZW59LlxuICAgICAqL1xuICAgIGNoaWxkcmVuPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVFtdO1xuICAgIGNoaWxkcmVuKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW107XG4gICAgY2hpbGRyZW4ocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkVk5vZGVzLmZpbHRlcihjaGlsZCA9PiB7XG4gICAgICAgICAgICByZXR1cm4gY2hpbGQudGFuZ2libGUgJiYgY2hpbGQudGVzdChwcmVkaWNhdGUpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuaGFzQ2hpbGRyZW59LlxuICAgICAqL1xuICAgIGhhc0NoaWxkcmVuKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbigpLmxlbmd0aCA+IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLm50aENoaWxkfS5cbiAgICAgKi9cbiAgICBudGhDaGlsZChuOiBudW1iZXIpOiBWTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuKClbbiAtIDFdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5maXJzdENoaWxkfS5cbiAgICAgKi9cbiAgICBmaXJzdENoaWxkPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBmaXJzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIGZpcnN0Q2hpbGQocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGUge1xuICAgICAgICBsZXQgY2hpbGQgPSB0aGlzLmNoaWxkVk5vZGVzWzBdO1xuICAgICAgICB3aGlsZSAoY2hpbGQgJiYgIShjaGlsZC50YW5naWJsZSAmJiBjaGlsZC50ZXN0KHByZWRpY2F0ZSkpKSB7XG4gICAgICAgICAgICBjaGlsZCA9IGNoaWxkLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNoaWxkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5sYXN0Q2hpbGR9LlxuICAgICAqL1xuICAgIGxhc3RDaGlsZDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgbGFzdENoaWxkKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlO1xuICAgIGxhc3RDaGlsZChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIGxldCBjaGlsZCA9IHRoaXMuY2hpbGRWTm9kZXNbdGhpcy5jaGlsZFZOb2Rlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgd2hpbGUgKGNoaWxkICYmICEoY2hpbGQudGFuZ2libGUgJiYgY2hpbGQudGVzdChwcmVkaWNhdGUpKSkge1xuICAgICAgICAgICAgY2hpbGQgPSBjaGlsZC5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2hpbGQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmZpcnN0TGVhZn0uXG4gICAgICovXG4gICAgZmlyc3RMZWFmPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBmaXJzdExlYWYocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGU7XG4gICAgZmlyc3RMZWFmKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlIHtcbiAgICAgICAgY29uc3QgaXNWYWxpZExlYWYgPSAobm9kZTogVk5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgIHJldHVybiBpc0xlYWYobm9kZSkgJiYgbm9kZS50ZXN0KHByZWRpY2F0ZSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChpc1ZhbGlkTGVhZih0aGlzKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5maXJzdERlc2NlbmRhbnQoKG5vZGU6IFZOb2RlKSA9PiBpc1ZhbGlkTGVhZihub2RlKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUubGFzdExlYWZ9LlxuICAgICAqL1xuICAgIGxhc3RMZWFmPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogUHJlZGljYXRlPFQ+KTogVDtcbiAgICBsYXN0TGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBsYXN0TGVhZihwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZSB7XG4gICAgICAgIGNvbnN0IGlzVmFsaWRMZWFmID0gKG5vZGU6IFZOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgICAgICByZXR1cm4gaXNMZWFmKG5vZGUpICYmIG5vZGUudGVzdChwcmVkaWNhdGUpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAoaXNWYWxpZExlYWYodGhpcykpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGFzdERlc2NlbmRhbnQoKG5vZGU6IFZOb2RlKSA9PiBpc1ZhbGlkTGVhZihub2RlKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuZmlyc3REZXNjZW5kYW50fS5cbiAgICAgKi9cbiAgICBmaXJzdERlc2NlbmRhbnQ8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBQcmVkaWNhdGU8VD4pOiBUO1xuICAgIGZpcnN0RGVzY2VuZGFudChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZTtcbiAgICBmaXJzdERlc2NlbmRhbnQocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGUge1xuICAgICAgICBsZXQgZmlyc3REZXNjZW5kYW50ID0gdGhpcy5maXJzdENoaWxkKCk7XG4gICAgICAgIHdoaWxlIChmaXJzdERlc2NlbmRhbnQgJiYgIWZpcnN0RGVzY2VuZGFudC50ZXN0KHByZWRpY2F0ZSkpIHtcbiAgICAgICAgICAgIGZpcnN0RGVzY2VuZGFudCA9IHRoaXMuX2Rlc2NlbmRhbnRBZnRlcihmaXJzdERlc2NlbmRhbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmaXJzdERlc2NlbmRhbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmxhc3REZXNjZW5kYW50fS5cbiAgICAgKi9cbiAgICBsYXN0RGVzY2VuZGFudDxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFQ7XG4gICAgbGFzdERlc2NlbmRhbnQocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGU7XG4gICAgbGFzdERlc2NlbmRhbnQocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGUge1xuICAgICAgICBsZXQgbGFzdERlc2NlbmRhbnQgPSB0aGlzLmxhc3RDaGlsZCgpO1xuICAgICAgICB3aGlsZSAobGFzdERlc2NlbmRhbnQgJiYgbGFzdERlc2NlbmRhbnQuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgbGFzdERlc2NlbmRhbnQgPSBsYXN0RGVzY2VuZGFudC5sYXN0Q2hpbGQoKTtcbiAgICAgICAgfVxuICAgICAgICB3aGlsZSAobGFzdERlc2NlbmRhbnQgJiYgIWxhc3REZXNjZW5kYW50LnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgbGFzdERlc2NlbmRhbnQgPSB0aGlzLl9kZXNjZW5kYW50QmVmb3JlKGxhc3REZXNjZW5kYW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbGFzdERlc2NlbmRhbnQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmRlc2NlbmRhbnRzfS5cbiAgICAgKi9cbiAgICBkZXNjZW5kYW50czxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IFByZWRpY2F0ZTxUPik6IFRbXTtcbiAgICBkZXNjZW5kYW50cyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIGRlc2NlbmRhbnRzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCBkZXNjZW5kYW50cyA9IFtdO1xuICAgICAgICBsZXQgY3VycmVudERlc2NlbmRhbnQgPSB0aGlzLmZpcnN0Q2hpbGQoKTtcbiAgICAgICAgd2hpbGUgKGN1cnJlbnREZXNjZW5kYW50KSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudERlc2NlbmRhbnQudGVzdChwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICAgICAgZGVzY2VuZGFudHMucHVzaChjdXJyZW50RGVzY2VuZGFudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50RGVzY2VuZGFudCA9IHRoaXMuX2Rlc2NlbmRhbnRBZnRlcihjdXJyZW50RGVzY2VuZGFudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRlc2NlbmRhbnRzO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBVcGRhdGluZ1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIG5ldyBWTm9kZSB3aXRoIHRoZSBzYW1lIHR5cGUgYW5kIGF0dHJpYnV0ZXMgYXMgdGhpcyBWTm9kZS5cbiAgICAgKi9cbiAgICBjbG9uZShkZWVwQ2xvbmU/OiBib29sZWFuLCBwYXJhbXM/OiB7fSk6IHRoaXMge1xuICAgICAgICBjb25zdCBjbG9uZSA9IHN1cGVyLmNsb25lKHBhcmFtcyk7XG4gICAgICAgIGlmIChkZWVwQ2xvbmUpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5jaGlsZFZOb2Rlcykge1xuICAgICAgICAgICAgICAgIGNsb25lLmFwcGVuZChjaGlsZC5jbG9uZSh0cnVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5wcmVwZW5kfS5cbiAgICAgKi9cbiAgICBwcmVwZW5kKC4uLmNoaWxkcmVuOiBWTm9kZVtdKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIHRoaXMuX2luc2VydEF0SW5kZXgoY2hpbGQsIDApO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLmFwcGVuZH0uXG4gICAgICovXG4gICAgYXBwZW5kKC4uLmNoaWxkcmVuOiBWTm9kZVtdKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIHRoaXMuX2luc2VydEF0SW5kZXgoY2hpbGQsIHRoaXMuY2hpbGRWTm9kZXMubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZWUge0BsaW5rIEFic3RyYWN0Tm9kZS5pbnNlcnRCZWZvcmV9LlxuICAgICAqL1xuICAgIGluc2VydEJlZm9yZShub2RlOiBWTm9kZSwgcmVmZXJlbmNlOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuY2hpbGRWTm9kZXMuaW5kZXhPZihyZWZlcmVuY2UpO1xuICAgICAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQ2hpbGRFcnJvcih0aGlzLCBub2RlKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9pbnNlcnRBdEluZGV4KG5vZGUsIGluZGV4KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuaW5zZXJ0QWZ0ZXJ9LlxuICAgICAqL1xuICAgIGluc2VydEFmdGVyKG5vZGU6IFZOb2RlLCByZWZlcmVuY2U6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5jaGlsZFZOb2Rlcy5pbmRleE9mKHJlZmVyZW5jZSk7XG4gICAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBDaGlsZEVycm9yKHRoaXMsIG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2luc2VydEF0SW5kZXgobm9kZSwgaW5kZXggKyAxKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUuZW1wdHl9LlxuICAgICAqL1xuICAgIGVtcHR5KCk6IHZvaWQge1xuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRoaXMuY2hpbGRWTm9kZXMpIHtcbiAgICAgICAgICAgIGNoaWxkLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLnJlbW92ZUNoaWxkfS5cbiAgICAgKi9cbiAgICByZW1vdmVDaGlsZChjaGlsZDogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmNoaWxkVk5vZGVzLmluZGV4T2YoY2hpbGQpO1xuICAgICAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQ2hpbGRFcnJvcih0aGlzLCBjaGlsZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fcmVtb3ZlQXRJbmRleChpbmRleCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLnNwbGl0QXR9LlxuICAgICAqL1xuICAgIHNwbGl0QXQoY2hpbGQ6IFZOb2RlKTogdGhpcyB7XG4gICAgICAgIGlmIChjaGlsZC5wYXJlbnQgIT09IHRoaXMpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBDaGlsZEVycm9yKHRoaXMsIGNoaWxkKTtcbiAgICAgICAgfSBlbHNlIGlmICghdGhpcy5icmVha2FibGUpIHtcbiAgICAgICAgICAgIC8vIFVuYnJlYWthYmxlIG5vZGVzIGRvIG5vdCBzcGxpdC5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGR1cGxpY2F0ZSA9IHRoaXMuY2xvbmUoKTtcbiAgICAgICAgY29uc3QgaW5kZXggPSBjaGlsZC5wYXJlbnQuY2hpbGRWTm9kZXMuaW5kZXhPZihjaGlsZCk7XG4gICAgICAgIHdoaWxlICh0aGlzLmNoaWxkVk5vZGVzLmxlbmd0aCA+IGluZGV4KSB7XG4gICAgICAgICAgICBkdXBsaWNhdGUuYXBwZW5kKHRoaXMuY2hpbGRWTm9kZXNbaW5kZXhdKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFmdGVyKGR1cGxpY2F0ZSk7XG4gICAgICAgIHJldHVybiBkdXBsaWNhdGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlZSB7QGxpbmsgQWJzdHJhY3ROb2RlLm1lcmdlV2l0aH0uXG4gICAgICovXG4gICAgbWVyZ2VXaXRoKG5ld0NvbnRhaW5lcjogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKG5ld0NvbnRhaW5lciAhPT0gdGhpcykge1xuICAgICAgICAgICAgaWYgKG5ld0NvbnRhaW5lci5jaGlsZFZOb2Rlcy5pbmNsdWRlcyh0aGlzKSkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5jaGlsZFZOb2Rlcy5zbGljZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRhaW5lci5pbnNlcnRCZWZvcmUoY2hpbGQsIHRoaXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3Q29udGFpbmVyLmFwcGVuZCguLi50aGlzLmNoaWxkVk5vZGVzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VlIHtAbGluayBBYnN0cmFjdE5vZGUudW53cmFwfS5cbiAgICAgKi9cbiAgICB1bndyYXAoKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGhpcy5jaGlsZFZOb2Rlcy5zbGljZSgpKSB7XG4gICAgICAgICAgICB0aGlzLmJlZm9yZShjaGlsZCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgZGVzY2VuZGFudCBvZiB0aGlzIG5vZGUgdGhhdCBkaXJlY3RseSBwcmVjZWRlcyB0aGUgZ2l2ZW4gbm9kZVxuICAgICAqIGluIGRlcHRoLWZpcnN0IHByZS1vcmRlciB0cmF2ZXJzYWwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIF9kZXNjZW5kYW50QmVmb3JlKG5vZGU6IFZOb2RlKTogVk5vZGUge1xuICAgICAgICBsZXQgcHJldmlvdXMgPSBub2RlLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICBpZiAocHJldmlvdXMpIHtcbiAgICAgICAgICAgIC8vIFRoZSBub2RlIGJlZm9yZSBub2RlIGlzIHRoZSBsYXN0IGxlYWYgb2YgaXRzIHByZXZpb3VzIHNpYmxpbmcuXG4gICAgICAgICAgICBwcmV2aW91cyA9IHByZXZpb3VzLmxhc3RMZWFmKCk7XG4gICAgICAgIH0gZWxzZSBpZiAobm9kZS5wYXJlbnQgIT09IHRoaXMpIHtcbiAgICAgICAgICAgIC8vIElmIGl0IGhhcyBubyBwcmV2aW91cyBzaWJsaW5nIHRoZW4gY2xpbWIgdXAgdG8gdGhlIHBhcmVudC5cbiAgICAgICAgICAgIC8vIFRoaXMgaXMgc2ltaWxhciB0byBgcHJldmlvdXNgIGJ1dCBjYW4ndCBnbyBmdXJ0aGVyIHRoYW4gYHRoaXNgLlxuICAgICAgICAgICAgcHJldmlvdXMgPSBub2RlLnBhcmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJldmlvdXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgZGVzY2VuZGFudCBvZiB0aGlzIG5vZGUgdGhhdCBkaXJlY3RseSBmb2xsb3dzIHRoZSBnaXZlbiBub2RlXG4gICAgICogaW4gZGVwdGgtZmlyc3QgcHJlLW9yZGVyIHRyYXZlcnNhbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgX2Rlc2NlbmRhbnRBZnRlcihub2RlOiBWTm9kZSk6IFZOb2RlIHtcbiAgICAgICAgLy8gVGhlIG5vZGUgYWZ0ZXIgbm9kZSBpcyBpdHMgZmlyc3QgY2hpbGQuXG4gICAgICAgIGxldCBuZXh0ID0gbm9kZS5maXJzdENoaWxkKCk7XG4gICAgICAgIGlmICghbmV4dCkge1xuICAgICAgICAgICAgLy8gSWYgaXQgaGFzIG5vIGNoaWxkcmVuIHRoZW4gaXQgaXMgaXRzIG5leHQgc2libGluZy5cbiAgICAgICAgICAgIG5leHQgPSBub2RlLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFuZXh0KSB7XG4gICAgICAgICAgICAvLyBJZiBpdCBoYXMgbm8gc2libGluZ3MgZWl0aGVyIHRoZW4gY2xpbWIgdXAgdG8gdGhlIGNsb3Nlc3QgcGFyZW50XG4gICAgICAgICAgICAvLyB3aGljaCBoYXMgYSBuZXh0IHNpYmlsaW5nLlxuICAgICAgICAgICAgLy8gVGhpcyBpcyBzaW1pbGFyIHRvIGBuZXh0YCBidXQgY2FuJ3QgZ28gZnVydGhlciB0aGFuIGB0aGlzYC5cbiAgICAgICAgICAgIGxldCBhbmNlc3RvciA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgd2hpbGUgKGFuY2VzdG9yICE9PSB0aGlzICYmICFhbmNlc3Rvci5uZXh0U2libGluZygpKSB7XG4gICAgICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYW5jZXN0b3IgIT09IHRoaXMpIHtcbiAgICAgICAgICAgICAgICBuZXh0ID0gYW5jZXN0b3IubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV4dDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW5zZXJ0IGEgVk5vZGUgYXQgdGhlIGdpdmVuIGluZGV4IHdpdGhpbiB0aGlzIFZOb2RlJ3MgY2hpbGRyZW4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2hpbGRcbiAgICAgKiBAcGFyYW0gaW5kZXggVGhlIGluZGV4IGF0IHdoaWNoIHRoZSBpbnNlcnRpb24gbXVzdCB0YWtlIHBsYWNlIHdpdGhpbiB0aGlzXG4gICAgICogVk5vZGUncyBwYXJlbnQsIGhvbGRpbmcgbWFya2VyIG5vZGVzIGludG8gYWNjb3VudC5cbiAgICAgKi9cbiAgICBfaW5zZXJ0QXRJbmRleChjaGlsZDogVk5vZGUsIGluZGV4OiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgaWYgKGNoaWxkLnBhcmVudCkge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudEluZGV4ID0gY2hpbGQucGFyZW50LmNoaWxkVk5vZGVzLmluZGV4T2YoY2hpbGQpO1xuICAgICAgICAgICAgaWYgKGluZGV4ICYmIGNoaWxkLnBhcmVudCA9PT0gdGhpcyAmJiBjdXJyZW50SW5kZXggPCBpbmRleCkge1xuICAgICAgICAgICAgICAgIGluZGV4LS07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjaGlsZC5wYXJlbnQucmVtb3ZlQ2hpbGQoY2hpbGQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY2hpbGRWTm9kZXMuc3BsaWNlKGluZGV4LCAwLCBjaGlsZCk7XG4gICAgICAgIGNoaWxkLnBhcmVudCA9IHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGUgbnRoIGNoaWxkIGZyb20gdGhpcyBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGluZGV4IFRoZSBpbmRleCBvZiB0aGUgY2hpbGQgdG8gcmVtb3ZlIGluY2x1ZGluZyBtYXJrZXIgbm9kZXMuXG4gICAgICovXG4gICAgX3JlbW92ZUF0SW5kZXgoaW5kZXg6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMuY2hpbGRWTm9kZXMuc3BsaWNlKGluZGV4LCAxKVswXTtcbiAgICAgICAgY2hpbGQucGFyZW50ID0gdW5kZWZpbmVkO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuL0NvbnRhaW5lck5vZGUnO1xuXG5leHBvcnQgY2xhc3MgRnJhZ21lbnROb2RlIGV4dGVuZHMgQ29udGFpbmVyTm9kZSB7XG4gICAgcmVhZG9ubHkgZWRpdGFibGUgPSB0cnVlO1xuICAgIHJlYWRvbmx5IGJyZWFrYWJsZSA9IGZhbHNlO1xuXG4gICAgc2V0IHBhcmVudChwYXJlbnQ6IENvbnRhaW5lck5vZGUpIHtcbiAgICAgICAgdGhpcy5tZXJnZVdpdGgocGFyZW50KTtcbiAgICAgICAgcGFyZW50LnJlbW92ZUNoaWxkKHRoaXMpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEF0b21pY05vZGUgfSBmcm9tICcuL0F0b21pY05vZGUnO1xuXG5leHBvcnQgY2xhc3MgTWFya2VyTm9kZSBleHRlbmRzIEF0b21pY05vZGUge1xuICAgIHN0YXRpYyByZWFkb25seSBhdG9taWMgPSB0cnVlO1xuICAgIHRhbmdpYmxlID0gZmFsc2U7XG59XG4iLCJpbXBvcnQgeyBBdG9taWNOb2RlIH0gZnJvbSAnLi9BdG9taWNOb2RlJztcblxuLyoqXG4gKiBUaGlzIGNsYXNzIHJlcHJlc2VudHMgYW4gYXRvbWljIG5vZGUgdGhhdCBpcyB1c2VkIGFzIGEgY29udGVudCBzZXBhcmF0b3IuXG4gKi9cbmV4cG9ydCBjbGFzcyBTZXBhcmF0b3JOb2RlIGV4dGVuZHMgQXRvbWljTm9kZSB7fVxuIiwiaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4vQ29udGFpbmVyTm9kZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgVkVsZW1lbnRQYXJhbXMge1xuICAgIGh0bWxUYWc6IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFZFbGVtZW50IGV4dGVuZHMgQ29udGFpbmVyTm9kZSB7XG4gICAgaHRtbFRhZzogc3RyaW5nO1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtczogVkVsZW1lbnRQYXJhbXMpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5odG1sVGFnID0gcGFyYW1zLmh0bWxUYWc7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIExpZmVjeWNsZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIG5ldyBWTm9kZSB3aXRoIHRoZSBzYW1lIHR5cGUgYW5kIGF0dHJpYnV0ZXMgYXMgdGhpcyBWTm9kZS5cbiAgICAgKi9cbiAgICBjbG9uZShkZWVwQ2xvbmU/OiBib29sZWFuLCBwYXJhbXM/OiB7fSk6IHRoaXMge1xuICAgICAgICBjb25zdCBkZWZhdWx0czogQ29uc3RydWN0b3JQYXJhbWV0ZXJzPHR5cGVvZiBWRWxlbWVudD5bMF0gPSB7XG4gICAgICAgICAgICBodG1sVGFnOiB0aGlzLmh0bWxUYWcsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBzdXBlci5jbG9uZShkZWVwQ2xvbmUsIHsgLi4uZGVmYXVsdHMsIC4uLnBhcmFtcyB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb25zdHJ1Y3RvciB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBDb250YWluZXJOb2RlIH0gZnJvbSAnLi9Db250YWluZXJOb2RlJztcbmltcG9ydCB7IEF0b21pY05vZGUgfSBmcm9tICcuL0F0b21pY05vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3ROb2RlIH0gZnJvbSAnLi9BYnN0cmFjdE5vZGUnO1xuXG5leHBvcnQgZW51bSBSZWxhdGl2ZVBvc2l0aW9uIHtcbiAgICBCRUZPUkUgPSAnQkVGT1JFJyxcbiAgICBBRlRFUiA9ICdBRlRFUicsXG4gICAgSU5TSURFID0gJ0lOU0lERScsXG59XG5cbmV4cG9ydCB0eXBlIFZOb2RlID0gQWJzdHJhY3ROb2RlICYgKENvbnRhaW5lck5vZGUgfCBBdG9taWNOb2RlKTtcblxuZXhwb3J0IHR5cGUgVHlwZWd1YXJkPFQgZXh0ZW5kcyBWTm9kZT4gPSAobm9kZTogVk5vZGUpID0+IG5vZGUgaXMgVDtcbmV4cG9ydCB0eXBlIFByZWRpY2F0ZTxUID0gVk5vZGUgfCBib29sZWFuPiA9IFQgZXh0ZW5kcyBWTm9kZVxuICAgID8gQ29uc3RydWN0b3I8VD4gfCBUeXBlZ3VhcmQ8VD5cbiAgICA6IChub2RlOiBWTm9kZSkgPT4gYm9vbGVhbjtcblxuZXhwb3J0IHR5cGUgUG9pbnQgPSBbVk5vZGUsIFJlbGF0aXZlUG9zaXRpb25dO1xuXG4vKipcbiAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBub2RlIGlzIGEgbGVhZiBpbiB0aGUgVkRvY3VtZW50LCB0aGF0IGlzIGEgbm9kZSB0aGF0XG4gKiBoYXMgbm8gY2hpbGRyZW4uXG4gKlxuICogQHBhcmFtIG5vZGUgbm9kZSB0byBjaGVja1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNMZWFmKG5vZGU6IFZOb2RlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICFub2RlLmhhc0NoaWxkcmVuKCk7XG59XG4iLCJpbXBvcnQgeyBWTm9kZSwgUmVsYXRpdmVQb3NpdGlvbiwgUG9pbnQgfSBmcm9tICcuL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBQcmVkaWNhdGUgfSBmcm9tICcuL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBNYXJrZXJOb2RlIH0gZnJvbSAnLi9WTm9kZXMvTWFya2VyTm9kZSc7XG5pbXBvcnQgeyBDb25zdHJ1Y3RvciB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBGcmFnbWVudE5vZGUgfSBmcm9tICcuL1ZOb2Rlcy9GcmFnbWVudE5vZGUnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4vVk5vZGVzL0NvbnRhaW5lck5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3ROb2RlIH0gZnJvbSAnLi9WTm9kZXMvQWJzdHJhY3ROb2RlJztcblxuZXhwb3J0IGNsYXNzIFZSYW5nZSB7XG4gICAgcmVhZG9ubHkgc3RhcnQgPSBuZXcgTWFya2VyTm9kZSgpO1xuICAgIHJlYWRvbmx5IGVuZCA9IG5ldyBNYXJrZXJOb2RlKCk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGNvbnRleHQgb2YgYSBjb2xsYXBzZWQgcmFuZ2UgYXQgdGhlIGdpdmVuIGxvY2F0aW9uLCB0YXJnZXR0aW5nXG4gICAgICogYSByZWZlcmVuY2UgVk5vZGUgYW5kIHNwZWNpZnlpbmcgdGhlIHBvc2l0aW9uIHJlbGF0aXZlIHRvIHRoYXQgVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcmVmZXJlbmNlXG4gICAgICogQHBhcmFtIHBvc2l0aW9uXG4gICAgICovXG4gICAgc3RhdGljIGF0KHJlZmVyZW5jZTogVk5vZGUsIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpOiBbUG9pbnQsIFBvaW50XSB7XG4gICAgICAgIHJldHVybiBWUmFuZ2Uuc2VsZWN0aW5nKHJlZmVyZW5jZSwgcG9zaXRpb24sIHJlZmVyZW5jZSwgcG9zaXRpb24pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGNvbnRleHQgb2YgYSByYW5nZSBhdCB0aGUgbG9jYXRpb24gb2YgdGhlIGdpdmVuIHJhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJhbmdlXG4gICAgICovXG4gICAgc3RhdGljIGNsb25lKHJhbmdlOiBWUmFuZ2UpOiBbUG9pbnQsIFBvaW50XSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICBbcmFuZ2Uuc3RhcnQsIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFXSxcbiAgICAgICAgICAgIFtyYW5nZS5lbmQsIFJlbGF0aXZlUG9zaXRpb24uQUZURVJdLFxuICAgICAgICBdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGNvbnRleHQgb2YgYSByYW5nZSBzZWxlY3RpbmcgdGhlIGdpdmVuIG5vZGVzLlxuICAgICAqIENvbnNpZGVyIGBhYmAgKGBbYCA9IHN0YXJ0LCBgXWAgPSBlbmQpOlxuICAgICAqIGBzZWxlY3QoYSlgID0+IGBbYV1iYFxuICAgICAqIGBzZWxlY3QoYSwgYilgID0+IGBbYWJdYFxuICAgICAqIGBzZWxlY3QoYSwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUsIGIsIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFKWAgPT4gYFthXWJgXG4gICAgICogYHNlbGVjdChhLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSLCBiLCBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSlgID0+IGBhW11iYFxuICAgICAqIGBzZWxlY3QoYSwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUsIGIsIFJlbGF0aXZlUG9zaXRpb24uQUZURVIpYCA9PiBgW2FiXWBcbiAgICAgKiBgc2VsZWN0KGEsIFJlbGF0aXZlUG9zaXRpb24uQUZURVIsIGIsIFJlbGF0aXZlUG9zaXRpb24uQUZURVIpYCA9PiBgYVtiXWBcbiAgICAgKlxuICAgICAqIEBwYXJhbSBzdGFydE5vZGVcbiAgICAgKiBAcGFyYW0gW3N0YXJ0UG9zaXRpb25dIGRlZmF1bHQ6IGBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRWBcbiAgICAgKiBAcGFyYW0gW2VuZE5vZGVdIGRlZmF1bHQ6IGBzdGFydE5vZGVgXG4gICAgICogQHBhcmFtIFtlbmRQb3NpdGlvbl0gZGVmYXVsdDogYFJlbGF0aXZlUG9zaXRpb24uQUZURVJgXG4gICAgICovXG4gICAgc3RhdGljIHNlbGVjdGluZyhzdGFydE5vZGU6IFZOb2RlLCBlbmROb2RlPzogVk5vZGUpOiBbUG9pbnQsIFBvaW50XTtcbiAgICBzdGF0aWMgc2VsZWN0aW5nKFxuICAgICAgICBzdGFydE5vZGU6IFZOb2RlLFxuICAgICAgICBzdGFydFBvc2l0aW9uOiBSZWxhdGl2ZVBvc2l0aW9uLFxuICAgICAgICBlbmROb2RlOiBWTm9kZSxcbiAgICAgICAgZW5kUG9zaXRpb246IFJlbGF0aXZlUG9zaXRpb24sXG4gICAgKTogW1BvaW50LCBQb2ludF07XG4gICAgc3RhdGljIHNlbGVjdGluZyhcbiAgICAgICAgc3RhcnROb2RlOiBWTm9kZSxcbiAgICAgICAgc3RhcnRQb3NpdGlvbjogUmVsYXRpdmVQb3NpdGlvbiB8IFZOb2RlID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUsXG4gICAgICAgIGVuZE5vZGU6IFZOb2RlID0gc3RhcnROb2RlLFxuICAgICAgICBlbmRQb3NpdGlvbjogUmVsYXRpdmVQb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQUZURVIsXG4gICAgKTogW1BvaW50LCBQb2ludF0ge1xuICAgICAgICBpZiAoc3RhcnRQb3NpdGlvbiBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkge1xuICAgICAgICAgICAgZW5kTm9kZSA9IHN0YXJ0UG9zaXRpb247XG4gICAgICAgICAgICBzdGFydFBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIFtzdGFydE5vZGUsIHN0YXJ0UG9zaXRpb25dLFxuICAgICAgICAgICAgW2VuZE5vZGUsIGVuZFBvc2l0aW9uXSxcbiAgICAgICAgXTtcbiAgICB9XG5cbiAgICBjb25zdHJ1Y3Rvcihib3VuZGFyeVBvaW50cz86IFtQb2ludCwgUG9pbnRdKSB7XG4gICAgICAgIC8vIElmIGEgcmFuZ2UgY29udGV4dCBpcyBnaXZlbiwgYWRhcHQgdGhpcyByYW5nZSB0byBtYXRjaCBpdC5cbiAgICAgICAgaWYgKGJvdW5kYXJ5UG9pbnRzKSB7XG4gICAgICAgICAgICBjb25zdCBbc3RhcnQsIGVuZF0gPSBib3VuZGFyeVBvaW50cztcbiAgICAgICAgICAgIGNvbnN0IFtzdGFydE5vZGUsIHN0YXJ0UG9zaXRpb25dID0gc3RhcnQ7XG4gICAgICAgICAgICBjb25zdCBbZW5kTm9kZSwgZW5kUG9zaXRpb25dID0gZW5kO1xuICAgICAgICAgICAgaWYgKGVuZFBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRFbmQoZW5kTm9kZSwgZW5kUG9zaXRpb24pO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnQoc3RhcnROb2RlLCBzdGFydFBvc2l0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydChzdGFydE5vZGUsIHN0YXJ0UG9zaXRpb24pO1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0RW5kKGVuZE5vZGUsIGVuZFBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBnZXQgc3RhcnRDb250YWluZXIoKTogVk5vZGUge1xuICAgICAgICByZXR1cm4gdGhpcy5zdGFydC5wYXJlbnQ7XG4gICAgfVxuXG4gICAgZ2V0IGVuZENvbnRhaW5lcigpOiBWTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVuZC5wYXJlbnQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIHJhbmdlIGlzIGNvbGxhcHNlZC5cbiAgICAgKi9cbiAgICBpc0NvbGxhcHNlZCgpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKCF0aGlzLnN0YXJ0Q29udGFpbmVyIHx8ICF0aGlzLmVuZENvbnRhaW5lcikgcmV0dXJuO1xuICAgICAgICBjb25zdCBzdGFydEluZGV4ID0gdGhpcy5zdGFydC5wYXJlbnQuY2hpbGRWTm9kZXMuaW5kZXhPZih0aGlzLnN0YXJ0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnRDb250YWluZXIuY2hpbGRWTm9kZXNbc3RhcnRJbmRleCArIDFdID09PSB0aGlzLmVuZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgbGlzdCBvZiBhbGwgbm9kZXMgdGhhdCBhcmUgZnVsbHkgc2VsZWN0ZWQgYnkgdGhpcyByYW5nZS5cbiAgICAgKi9cbiAgICBzZWxlY3RlZE5vZGVzPFQgZXh0ZW5kcyBWTm9kZT4ocHJlZGljYXRlPzogQ29uc3RydWN0b3I8VD4pOiBUW107XG4gICAgc2VsZWN0ZWROb2RlcyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIHNlbGVjdGVkTm9kZXMocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZXM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgbGV0IG5vZGUgPSB0aGlzLnN0YXJ0O1xuICAgICAgICBjb25zdCBib3VuZCA9IHRoaXMuZW5kLm5leHQoKTtcbiAgICAgICAgY29uc3QgZW5kQ29udGFpbmVycyA9IHRoaXMuZW5kLmFuY2VzdG9ycygpO1xuICAgICAgICB3aGlsZSAoKG5vZGUgPSBub2RlLm5leHQoKSkgJiYgbm9kZSAhPT0gYm91bmQpIHtcbiAgICAgICAgICAgIGlmICghZW5kQ29udGFpbmVycy5pbmNsdWRlcyhub2RlKSkge1xuICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZE5vZGU6IFZOb2RlID0gbm9kZTtcbiAgICAgICAgICAgICAgICB3aGlsZSAoIXNlbGVjdGVkTm9kZT8udGVzdChGcmFnbWVudE5vZGUpICYmIHNlbGVjdGVkTm9kZT8udGVzdChwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZE5vZGUuZWRpdGFibGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkTm9kZXMucHVzaChzZWxlY3RlZE5vZGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbmQgdGhlIG5leHQgYW5jZXN0b3Igd2hvc2UgY2hpbGRyZW4gYXJlIGFsbCBzZWxlY3RlZFxuICAgICAgICAgICAgICAgICAgICAvLyBhbmQgYWRkIGl0IHRvIHRoZSBsaXN0LlxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZE5vZGUgPSBzZWxlY3RlZE5vZGUuYW5jZXN0b3IoYW5jZXN0b3IgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFuY2VzdG9yLmNoaWxkcmVuKCkuZXZlcnkoY2hpbGQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3RlZE5vZGVzLmluY2x1ZGVzKGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlbGVjdGVkTm9kZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIGxpc3Qgb2YgYWxsIHRoZSBub2RlcyBjdXJyZW50bHkgdGFyZ2V0ZWQgYnkgdGhlIHJhbmdlLiBJZiB0aGVcbiAgICAgKiByYW5nZSBpcyBjb2xsYXBzZWQsIHRoZSB0YXJnZXRlZCBub2RlIGlzIHRoZSBjb250YWluZXIgb2YgdGhlIHJhbmdlLlxuICAgICAqIE90aGVyd2lzZSwgdGhlIHRhcmdldGVkIG5vZGVzIGFyZSB0aGUgb25lcyBlbmNvdW50ZXJlZCBieSB0cmF2ZXJzaW5nIHRoZVxuICAgICAqIHRyZWUgZnJvbSB0aGUgc3RhcnQgdG8gZW5kIG9mIHRoaXMgcmFuZ2UuXG4gICAgICovXG4gICAgdGFyZ2V0ZWROb2RlczxUIGV4dGVuZHMgVk5vZGU+KHByZWRpY2F0ZT86IENvbnN0cnVjdG9yPFQ+KTogVFtdO1xuICAgIHRhcmdldGVkTm9kZXMocHJlZGljYXRlPzogUHJlZGljYXRlKTogVk5vZGVbXTtcbiAgICB0YXJnZXRlZE5vZGVzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCB0YXJnZXRlZE5vZGVzOiBWTm9kZVtdID0gdGhpcy50cmF2ZXJzZWROb2RlcyhwcmVkaWNhdGUpO1xuICAgICAgICBjb25zdCBjbG9zZXN0U3RhcnRBbmNlc3RvciA9IHRoaXMuc3RhcnQuYW5jZXN0b3IocHJlZGljYXRlKTtcbiAgICAgICAgaWYgKGNsb3Nlc3RTdGFydEFuY2VzdG9yPy5lZGl0YWJsZSkge1xuICAgICAgICAgICAgdGFyZ2V0ZWROb2Rlcy51bnNoaWZ0KGNsb3Nlc3RTdGFydEFuY2VzdG9yKTtcbiAgICAgICAgfSBlbHNlIGlmIChjbG9zZXN0U3RhcnRBbmNlc3Rvcikge1xuICAgICAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBbLi4uY2xvc2VzdFN0YXJ0QW5jZXN0b3IuY2hpbGRWTm9kZXNdLnJldmVyc2UoKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgY2hpbGRyZW4pIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRhcmdldGVkTm9kZXMuaW5jbHVkZXMoY2hpbGQpICYmIGNoaWxkLnRlc3QocHJlZGljYXRlKSkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXRlZE5vZGVzLnVuc2hpZnQoY2hpbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGFyZ2V0ZWROb2RlcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBsaXN0IG9mIGFsbCB0aGUgbm9kZXMgdHJhdmVyc2VkIGZyb20gc3RhcnQgdG8gZW5kIG9mIHRoaXMgcmFuZ2UuXG4gICAgICovXG4gICAgdHJhdmVyc2VkTm9kZXM8VCBleHRlbmRzIFZOb2RlPihwcmVkaWNhdGU/OiBDb25zdHJ1Y3RvcjxUPik6IFRbXTtcbiAgICB0cmF2ZXJzZWROb2RlcyhwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdO1xuICAgIHRyYXZlcnNlZE5vZGVzKHByZWRpY2F0ZT86IFByZWRpY2F0ZSk6IFZOb2RlW10ge1xuICAgICAgICBjb25zdCB0cmF2ZXJzZWROb2RlcyA9IFtdO1xuICAgICAgICBsZXQgbm9kZSA9IHRoaXMuc3RhcnQ7XG4gICAgICAgIGNvbnN0IGJvdW5kID0gdGhpcy5lbmQubmV4dCgpO1xuICAgICAgICB3aGlsZSAoKG5vZGUgPSBub2RlLm5leHQoKSkgJiYgbm9kZSAhPT0gYm91bmQpIHtcbiAgICAgICAgICAgIGlmIChub2RlLmVkaXRhYmxlICYmIG5vZGUudGVzdChwcmVkaWNhdGUpKSB7XG4gICAgICAgICAgICAgICAgdHJhdmVyc2VkTm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJhdmVyc2VkTm9kZXM7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBDb2xsYXBzZSB0aGUgcmFuZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gW2VkZ2VdIHJhbmdlIGVkZ2Ugb24gd2hpY2ggdG8gY29sbGFwc2VcbiAgICAgKi9cbiAgICBjb2xsYXBzZShlZGdlID0gdGhpcy5zdGFydCk6IHZvaWQge1xuICAgICAgICBpZiAoZWRnZSA9PT0gdGhpcy5zdGFydCkge1xuICAgICAgICAgICAgdGhpcy5zZXRFbmQoZWRnZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoZWRnZSA9PT0gdGhpcy5lbmQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhcnQoZWRnZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSByYW5nZSdzIHN0YXJ0IHBvaW50IChpbiB0cmF2ZXJzYWwgb3JkZXIpIGF0IHRoZSBnaXZlbiBsb2NhdGlvbixcbiAgICAgKiB0YXJnZXR0aW5nIGEgYHJlZmVyZW5jZWAgVk5vZGUgYW5kIHNwZWNpZnlpbmcgdGhlIGBwb3NpdGlvbmAgaW4gcmVmZXJlbmNlXG4gICAgICogdG8gdGhhdCBWTm9kZSAoJ0JFRk9SRScsICdBRlRFUicpLCBsaWtlIGluIGFuIGB4cGF0aC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZWZlcmVuY2VcbiAgICAgKiBAcGFyYW0gW3Bvc2l0aW9uXVxuICAgICAqL1xuICAgIHNldFN0YXJ0KHJlZmVyZW5jZTogVk5vZGUsIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpOiB2b2lkIHtcbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSkge1xuICAgICAgICAgICAgcmVmZXJlbmNlID0gcmVmZXJlbmNlLmZpcnN0TGVhZigpO1xuICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKSB7XG4gICAgICAgICAgICByZWZlcmVuY2UgPSByZWZlcmVuY2UubGFzdExlYWYoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVmZXJlbmNlLmlzKENvbnRhaW5lck5vZGUpICYmICFyZWZlcmVuY2UuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgcmVmZXJlbmNlLnByZXBlbmQodGhpcy5zdGFydCk7XG4gICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09IFJlbGF0aXZlUG9zaXRpb24uQUZURVIgJiYgcmVmZXJlbmNlICE9PSB0aGlzLmVuZCkge1xuICAgICAgICAgICAgLy8gV2UgY2hlY2sgdGhhdCBgcmVmZXJlbmNlYCBpc24ndCBgdGhpcy5lbmRgIHRvIGF2b2lkIGEgYmFja3dhcmRcbiAgICAgICAgICAgIC8vIGNvbGxhcHNlZCByYW5nZS5cbiAgICAgICAgICAgIHJlZmVyZW5jZS5hZnRlcih0aGlzLnN0YXJ0KTtcbiAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gUmVsYXRpdmVQb3NpdGlvbi5JTlNJREUpIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZS5hcHBlbmQodGhpcy5zdGFydCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWZlcmVuY2UuYmVmb3JlKHRoaXMuc3RhcnQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgcmFuZ2UncyBlbmQgcG9pbnQgKGluIHRyYXZlcnNhbCBvcmRlcikgYXQgdGhlIGdpdmVuIGxvY2F0aW9uLFxuICAgICAqIHRhcmdldHRpbmcgYSBgcmVmZXJlbmNlYCBWTm9kZSBhbmQgc3BlY2lmeWluZyB0aGUgYHBvc2l0aW9uYCBpbiByZWZlcmVuY2VcbiAgICAgKiB0byB0aGF0IFZOb2RlICgnQkVGT1JFJywgJ0FGVEVSJyksIGxpa2UgaW4gYW4gYHhwYXRoLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlZmVyZW5jZVxuICAgICAqIEBwYXJhbSBbcG9zaXRpb25dXG4gICAgICovXG4gICAgc2V0RW5kKHJlZmVyZW5jZTogVk5vZGUsIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUik6IHZvaWQge1xuICAgICAgICBpZiAocG9zaXRpb24gPT09IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFKSB7XG4gICAgICAgICAgICByZWZlcmVuY2UgPSByZWZlcmVuY2UuZmlyc3RMZWFmKCk7XG4gICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09IFJlbGF0aXZlUG9zaXRpb24uQUZURVIpIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZSA9IHJlZmVyZW5jZS5sYXN0TGVhZigpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZWZlcmVuY2UuaXMoQ29udGFpbmVyTm9kZSkgJiYgIXJlZmVyZW5jZS5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICByZWZlcmVuY2UuYXBwZW5kKHRoaXMuZW5kKTtcbiAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUgJiYgcmVmZXJlbmNlICE9PSB0aGlzLnN0YXJ0KSB7XG4gICAgICAgICAgICAvLyBXZSBjaGVjayB0aGF0IGByZWZlcmVuY2VgIGlzbid0IGB0aGlzLnN0YXJ0YCB0byBhdm9pZCBhIGJhY2t3YXJkXG4gICAgICAgICAgICAvLyBjb2xsYXBzZWQgcmFuZ2UuXG4gICAgICAgICAgICByZWZlcmVuY2UuYmVmb3JlKHRoaXMuZW5kKTtcbiAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gUmVsYXRpdmVQb3NpdGlvbi5JTlNJREUpIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZS5hcHBlbmQodGhpcy5lbmQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVmZXJlbmNlLmFmdGVyKHRoaXMuZW5kKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBFeHRlbmQgdGhpcyByYW5nZSBpbiBzdWNoIGEgd2F5IHRoYXQgaXQgaW5jbHVkZXMgdGhlIGdpdmVuIG5vZGUuXG4gICAgICpcbiAgICAgKiBUaGlzIG1ldGhvZCBtb3ZlcyB0aGUgYm91bmRhcnkgbWFya2VyIHRoYXQgaXMgY2xvc2VzdCB0byB0aGUgZ2l2ZW4gbm9kZVxuICAgICAqIHVwIG9yIGRvd24gdGhlIHRyZWUgaW4gb3JkZXIgdG8gaW5jbHVkZSB0aGUgZ2l2ZW4gbm9kZSBpbnRvIHRoZSByYW5nZS5cbiAgICAgKiBCZWNhdXNlIG9mIHRoYXQsIGNhbGxpbmcgdGhpcyBtZXRob2Qgd2lsbCBhbHdheXMgcmVzdWx0IGluIGEgcmFuZ2UgdGhhdFxuICAgICAqIGlzIGF0IGxlYXN0IHRoZSBzaXplIHRoYXQgaXQgd2FzIHByaW9yIHRvIGNhbGxpbmcgaXQsIGFuZCB1c3VhbGx5IGJpZ2dlci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0YXJnZXROb2RlIFRoZSBub2RlIHRvIGV4dGVuZCB0aGUgcmFuZ2UgdG8uXG4gICAgICovXG4gICAgZXh0ZW5kVG8odGFyZ2V0Tm9kZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgbGV0IHBvc2l0aW9uOiBSZWxhdGl2ZVBvc2l0aW9uO1xuICAgICAgICBpZiAodGFyZ2V0Tm9kZS5pc0JlZm9yZSh0aGlzLnN0YXJ0KSkge1xuICAgICAgICAgICAgdGFyZ2V0Tm9kZSA9IHRhcmdldE5vZGUucHJldmlvdXMoKTtcbiAgICAgICAgICAgIGlmICh0YXJnZXROb2RlLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXROb2RlID0gdGFyZ2V0Tm9kZS5maXJzdExlYWYoKTtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQUZURVI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGFyZ2V0Tm9kZSAmJiB0aGlzLmVuZC5uZXh0U2libGluZygpICE9PSB0YXJnZXROb2RlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydCh0YXJnZXROb2RlLCBwb3NpdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0Tm9kZS5pc0FmdGVyKHRoaXMuZW5kKSkge1xuICAgICAgICAgICAgaWYgKHRhcmdldE5vZGUuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgICAgIHRhcmdldE5vZGUgPSB0YXJnZXROb2RlLm5leHQoKTtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQUZURVI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGFyZ2V0Tm9kZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0RW5kKHRhcmdldE5vZGUsIHBvc2l0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTcGxpdCB0aGUgcmFuZ2UgY29udGFpbmVycyB1cCB0byB0aGVpciBjb21tb24gYW5jZXN0b3IuIFJldHVybiBhbGxcbiAgICAgKiBjaGlsZHJlbiBvZiB0aGUgY29tbW9uIGFuY2VzdG9yIHRoYXQgYXJlIHRhcmdldGVkIGJ5IHRoZSByYW5nZSBhZnRlciB0aGVcbiAgICAgKiBzcGxpdC4gSWYgYSBwcmVkaWNhdGUgaXMgZ2l2ZW4sIHNwbGl0dGluZyBjb250aW51ZXMgdXAgdG8gYW5kIGluY2x1ZGluZ1xuICAgICAqIHRoZSBub2RlIGNsb3Nlc3QgdG8gdGhlIGNvbW1vbiBhbmNlc3RvciB0aGF0IG1hdGNoZXMgdGhlIHByZWRpY2F0ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwcmVkaWNhdGVcbiAgICAgKi9cbiAgICBzcGxpdChwcmVkaWNhdGU/OiBQcmVkaWNhdGUpOiBWTm9kZVtdIHtcbiAgICAgICAgY29uc3QgYW5jZXN0b3IgPSB0aGlzLnN0YXJ0Q29udGFpbmVyLmNvbW1vbkFuY2VzdG9yKHRoaXMuZW5kQ29udGFpbmVyKTtcbiAgICAgICAgY29uc3QgY2xvc2VzdCA9IGFuY2VzdG9yLmNsb3Nlc3QocHJlZGljYXRlKTtcbiAgICAgICAgY29uc3QgY29udGFpbmVyID0gY2xvc2VzdCA/IGNsb3Nlc3QucGFyZW50IDogYW5jZXN0b3I7XG5cbiAgICAgICAgLy8gU3BsaXQgdGhlIHN0YXJ0IGFuY2VzdG9ycy5cbiAgICAgICAgbGV0IHN0YXJ0OiBWTm9kZSA9IHRoaXMuc3RhcnQ7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGxldCBzdGFydEFuY2VzdG9yID0gc3RhcnQucGFyZW50O1xuICAgICAgICAgICAgLy8gRG8gbm90IHNwbGl0IGF0IHRoZSBzdGFydCBlZGdlIG9mIGEgbm9kZS5cbiAgICAgICAgICAgIGlmIChzdGFydC5wcmV2aW91c1NpYmxpbmcoKSkge1xuICAgICAgICAgICAgICAgIHN0YXJ0QW5jZXN0b3IgPSBzdGFydEFuY2VzdG9yLnNwbGl0QXQoc3RhcnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc3RhcnQgPSBzdGFydEFuY2VzdG9yO1xuICAgICAgICB9IHdoaWxlIChzdGFydC5wYXJlbnQgIT09IGNvbnRhaW5lcik7XG5cbiAgICAgICAgLy8gU3BsaXQgdGhlIGVuZCBhbmNlc3RvcnMuXG4gICAgICAgIGxldCBlbmQ6IFZOb2RlID0gdGhpcy5lbmQ7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIGNvbnN0IGVuZEFuY2VzdG9yID0gZW5kLnBhcmVudDtcbiAgICAgICAgICAgIC8vIERvIG5vdCBzcGxpdCBhdCB0aGUgZW5kIGVkZ2Ugb2YgYSBub2RlLlxuICAgICAgICAgICAgaWYgKGVuZC5uZXh0U2libGluZygpKSB7XG4gICAgICAgICAgICAgICAgZW5kQW5jZXN0b3Iuc3BsaXRBdChlbmQpO1xuICAgICAgICAgICAgICAgIGVuZEFuY2VzdG9yLmFwcGVuZChlbmQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZW5kID0gZW5kQW5jZXN0b3I7XG4gICAgICAgIH0gd2hpbGUgKGVuZC5wYXJlbnQgIT09IGNvbnRhaW5lcik7XG5cbiAgICAgICAgLy8gUmV0dXJuIGFsbCB0b3AtbW9zdCBzcGxpdCBub2RlcyBiZXR3ZWVuIGFuZCBpbmNsdWRpbmcgc3RhcnQgYW5kIGVuZC5cbiAgICAgICAgY29uc3Qgbm9kZXMgPSBbXTtcbiAgICAgICAgbGV0IG5vZGUgPSBzdGFydDtcbiAgICAgICAgd2hpbGUgKG5vZGUgIT09IGVuZCkge1xuICAgICAgICAgICAgbm9kZXMucHVzaChub2RlKTtcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgbm9kZXMucHVzaChlbmQpO1xuICAgICAgICByZXR1cm4gbm9kZXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEVtcHR5IHRoZSByYW5nZSBieSByZW1vdmluZyBzZWxlY3RlZCBub2RlcyBhbmQgY29sbGFwc2luZyBpdCBieSBtZXJnaW5nXG4gICAgICogbm9kZXMgYmV0d2VlbiBzdGFydCBhbmQgZW5kLlxuICAgICAqL1xuICAgIGVtcHR5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCByZW1vdmFibGVOb2RlcyA9IHRoaXMuc2VsZWN0ZWROb2Rlcyhub2RlID0+IHtcbiAgICAgICAgICAgIC8vIFRPRE86IFJlcGxhY2UgdGhpcyBjaGVjayBieSBjb21wbGV4IHRhYmxlIHNlbGVjdGlvbiBzdXBwb3J0LlxuICAgICAgICAgICAgcmV0dXJuIG5vZGUuYnJlYWthYmxlIHx8IG5vZGUucGFyZW50Py5icmVha2FibGUgfHwgbm9kZS5wYXJlbnQ/LmlzKEZyYWdtZW50Tm9kZSk7XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBSZW1vdmUgc2VsZWN0ZWQgbm9kZXMgd2l0aG91dCB0b3VjaGluZyB0aGUgc3RhcnQgcmFuZ2UncyBhbmNlc3RvcnMuXG4gICAgICAgIGNvbnN0IHN0YXJ0QW5jZXN0b3JzID0gdGhpcy5zdGFydC5hbmNlc3RvcnMoKTtcbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHJlbW92YWJsZU5vZGVzLmZpbHRlcihub2RlID0+ICFzdGFydEFuY2VzdG9ycy5pbmNsdWRlcyhub2RlKSkpIHtcbiAgICAgICAgICAgIG5vZGUucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ29sbGFwc2UgdGhlIHJhbmdlIGJ5IG1lcmdpbmcgbm9kZXMgYmV0d2VlbiBzdGFydCBhbmQgZW5kLlxuICAgICAgICBpZiAodGhpcy5zdGFydENvbnRhaW5lciAhPT0gdGhpcy5lbmRDb250YWluZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbW1vbkFuY2VzdG9yID0gdGhpcy5zdGFydC5jb21tb25BbmNlc3Rvcih0aGlzLmVuZCk7XG4gICAgICAgICAgICBsZXQgYW5jZXN0b3IgPSB0aGlzLmVuZENvbnRhaW5lci5wYXJlbnQ7XG4gICAgICAgICAgICB3aGlsZSAoYW5jZXN0b3IgIT09IGNvbW1vbkFuY2VzdG9yKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFuY2VzdG9yLmNoaWxkcmVuKCkubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICBhbmNlc3Rvci5zcGxpdEF0KHRoaXMuZW5kQ29udGFpbmVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZW5kQ29udGFpbmVyLmJyZWFrYWJsZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZENvbnRhaW5lci5tZXJnZVdpdGgoYW5jZXN0b3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhbmNlc3RvciA9IGFuY2VzdG9yLnBhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmVuZENvbnRhaW5lci5icmVha2FibGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZENvbnRhaW5lci5tZXJnZVdpdGgodGhpcy5zdGFydENvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlIHRoaXMgcmFuZ2UgZnJvbSBpdHMgVkRvY3VtZW50LlxuICAgICAqL1xuICAgIHJlbW92ZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGFydC5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy5lbmQucmVtb3ZlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSBhIHRlbXBvcmFyeSByYW5nZSBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlbiBib3VuZGFyeSBwb2ludHMgYW5kXG4gKiBjYWxsIHRoZSBnaXZlbiBjYWxsYmFjayB3aXRoIHRoZSBuZXdseSBjcmVhdGVkIHJhbmdlIGFzIGFyZ3VtZW50LiBUaGVcbiAqIHJhbmdlIGlzIGF1dG9tYXRpY2FsbHkgZGVzdHJveWVkIGFmdGVyIGNhbGxpbmcgdGhlIGNhbGxiYWNrLlxuICpcbiAqIEBwYXJhbSBib3VuZHMgVGhlIHBvaW50cyBjb3JyZXNwb25kaW5nIHRvIHRoZSByYW5nZSBib3VuZGFyaWVzLlxuICogQHBhcmFtIGNhbGxiYWNrIFRoZSBjYWxsYmFjayB0byBjYWxsIHdpdGggdGhlIG5ld2x5IGNyZWF0ZWQgcmFuZ2UuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoUmFuZ2U8VD4oXG4gICAgYm91bmRzOiBbUG9pbnQsIFBvaW50XSxcbiAgICBjYWxsYmFjazogKHJhbmdlOiBWUmFuZ2UpID0+IFQsXG4pOiBQcm9taXNlPFQ+IHtcbiAgICBjb25zdCByYW5nZSA9IG5ldyBWUmFuZ2UoYm91bmRzKTtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsYmFjayhyYW5nZSk7XG4gICAgcmFuZ2UucmVtb3ZlKCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiIsImltcG9ydCB7IFZSYW5nZSB9IGZyb20gJy4vVlJhbmdlJztcbmltcG9ydCB7IFZOb2RlLCBSZWxhdGl2ZVBvc2l0aW9uIH0gZnJvbSAnLi9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgTWFya2VyTm9kZSB9IGZyb20gJy4vVk5vZGVzL01hcmtlck5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3ROb2RlIH0gZnJvbSAnLi9WTm9kZXMvQWJzdHJhY3ROb2RlJztcblxuZXhwb3J0IGNvbnN0IEFOQ0hPUl9DSEFSID0gJ1snO1xuZXhwb3J0IGNvbnN0IEZPQ1VTX0NIQVIgPSAnXSc7XG5cbmV4cG9ydCBlbnVtIERpcmVjdGlvbiB7XG4gICAgQkFDS1dBUkQgPSAnQkFDS1dBUkQnLFxuICAgIEZPUldBUkQgPSAnRk9SV0FSRCcsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVlNlbGVjdGlvbkRlc2NyaXB0aW9uIHtcbiAgICBhbmNob3JOb2RlOiBWTm9kZTtcbiAgICBhbmNob3JQb3NpdGlvbj86IFJlbGF0aXZlUG9zaXRpb247XG4gICAgZm9jdXNOb2RlPzogVk5vZGU7XG4gICAgZm9jdXNQb3NpdGlvbj86IFJlbGF0aXZlUG9zaXRpb247XG4gICAgZGlyZWN0aW9uOiBEaXJlY3Rpb247XG59XG5cbmV4cG9ydCBjbGFzcyBWU2VsZWN0aW9uIHtcbiAgICByZWFkb25seSByYW5nZTogVlJhbmdlID0gbmV3IFZSYW5nZSgpO1xuICAgIF9kaXJlY3Rpb246IERpcmVjdGlvbiA9IERpcmVjdGlvbi5GT1JXQVJEO1xuXG4gICAgZ2V0IGFuY2hvcigpOiBNYXJrZXJOb2RlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uRk9SV0FSRCA/IHRoaXMucmFuZ2Uuc3RhcnQgOiB0aGlzLnJhbmdlLmVuZDtcbiAgICB9XG5cbiAgICBnZXQgZm9jdXMoKTogTWFya2VyTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGlvbiA9PT0gRGlyZWN0aW9uLkZPUldBUkQgPyB0aGlzLnJhbmdlLmVuZCA6IHRoaXMucmFuZ2Uuc3RhcnQ7XG4gICAgfVxuXG4gICAgZ2V0IGRpcmVjdGlvbigpOiBEaXJlY3Rpb24ge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGlyZWN0aW9uO1xuICAgIH1cblxuICAgIGlzQ29sbGFwc2VkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5yYW5nZS5pc0NvbGxhcHNlZCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIHNlbGVjdGlvbiBhY2NvcmRpbmcgdG8gdGhlIGdpdmVuIGRlc2NyaXB0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNlbGVjdGlvblxuICAgICAqL1xuICAgIHNldChzZWxlY3Rpb246IFZTZWxlY3Rpb25EZXNjcmlwdGlvbik6IHZvaWQge1xuICAgICAgICB0aGlzLl9kaXJlY3Rpb24gPSBzZWxlY3Rpb24uZGlyZWN0aW9uO1xuICAgICAgICB0aGlzLnNlbGVjdChcbiAgICAgICAgICAgIHNlbGVjdGlvbi5hbmNob3JOb2RlLFxuICAgICAgICAgICAgc2VsZWN0aW9uLmFuY2hvclBvc2l0aW9uLFxuICAgICAgICAgICAgc2VsZWN0aW9uLmZvY3VzTm9kZSxcbiAgICAgICAgICAgIHNlbGVjdGlvbi5mb2N1c1Bvc2l0aW9uLFxuICAgICAgICApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgYSBjb2xsYXBzZWQgc2VsZWN0aW9uIGF0IHRoZSBnaXZlbiBsb2NhdGlvbiwgdGFyZ2V0dGluZyBhIGByZWZlcmVuY2VgXG4gICAgICogVk5vZGUgYW5kIHNwZWNpZnlpbmcgdGhlIGBwb3NpdGlvbmAgaW4gcmVmZXJlbmNlIHRvIHRoYXQgVk5vZGUgKCdCRUZPUkUnLFxuICAgICAqICdBRlRFUicpLCBsaWtlIGluIGFuIGB4cGF0aGAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcG9zaXRpb25cbiAgICAgKiBAcGFyYW0gcmVmZXJlbmNlXG4gICAgICovXG4gICAgc2V0QXQocmVmZXJlbmNlOiBWTm9kZSwgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSk6IHZvaWQge1xuICAgICAgICB0aGlzLnNldEFuY2hvcihyZWZlcmVuY2UsIHBvc2l0aW9uKTtcbiAgICAgICAgdGhpcy5jb2xsYXBzZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGUgdGhlIHNlbGVjdGlvbiB0byBzZWxlY3QgdGhlIGdpdmVuIG5vZGVzLlxuICAgICAqIENvbnNpZGVyIGBhYmAgKFsgPSBgdGhpcy5fc3RhcnRgLCBdID0gYHRoaXMuX2VuZGApOlxuICAgICAqIGBzZWxlY3QoYSlgID0+IGBbYV1iYFxuICAgICAqIGBzZWxlY3QoYSwgYilgID0+IGBbYWJdYFxuICAgICAqIGBzZWxlY3QoYSwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUsIGIsIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFKWAgPT4gYFthXWJgXG4gICAgICogYHNlbGVjdChhLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSLCBiLCBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSlgID0+IGBhW11iYFxuICAgICAqIGBzZWxlY3QoYSwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUsIGIsIFJlbGF0aXZlUG9zaXRpb24uQUZURVIpYCA9PiBgW2FiXWBcbiAgICAgKiBgc2VsZWN0KGEsIFJlbGF0aXZlUG9zaXRpb24uQUZURVIsIGIsIFJlbGF0aXZlUG9zaXRpb24uQUZURVIpYCA9PiBgYVtiXWBcbiAgICAgKlxuICAgICAqIEBwYXJhbSBhbmNob3JOb2RlXG4gICAgICogQHBhcmFtIFthbmNob3JQb3NpdGlvbl0gZGVmYXVsdDogYFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFYFxuICAgICAqIEBwYXJhbSBbZm9jdXNOb2RlXSBkZWZhdWx0OiBgc3RhcnROb2RlYFxuICAgICAqIEBwYXJhbSBbZm9jdXNQb3NpdGlvbl0gZGVmYXVsdDogYFJlbGF0aXZlUG9zaXRpb24uQUZURVJgXG4gICAgICovXG4gICAgc2VsZWN0KGFuY2hvck5vZGU6IFZOb2RlLCBmb2N1c05vZGU/OiBWTm9kZSk6IHZvaWQ7XG4gICAgc2VsZWN0KFxuICAgICAgICBhbmNob3JOb2RlOiBWTm9kZSxcbiAgICAgICAgYW5jaG9yUG9zaXRpb246IFJlbGF0aXZlUG9zaXRpb24sXG4gICAgICAgIGZvY3VzTm9kZTogVk5vZGUsXG4gICAgICAgIGZvY3VzUG9zaXRpb246IFJlbGF0aXZlUG9zaXRpb24sXG4gICAgKTogdm9pZDtcbiAgICBzZWxlY3QoXG4gICAgICAgIGFuY2hvck5vZGU6IFZOb2RlLFxuICAgICAgICBhbmNob3JQb3NpdGlvbjogUmVsYXRpdmVQb3NpdGlvbiB8IFZOb2RlID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUsXG4gICAgICAgIGZvY3VzTm9kZTogVk5vZGUgPSBhbmNob3JOb2RlLFxuICAgICAgICBmb2N1c1Bvc2l0aW9uOiBSZWxhdGl2ZVBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUixcbiAgICApOiB2b2lkIHtcbiAgICAgICAgaWYgKGFuY2hvclBvc2l0aW9uIGluc3RhbmNlb2YgQWJzdHJhY3ROb2RlKSB7XG4gICAgICAgICAgICBmb2N1c05vZGUgPSBhbmNob3JQb3NpdGlvbjtcbiAgICAgICAgICAgIGFuY2hvclBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZvY3VzUG9zaXRpb24gPT09IFJlbGF0aXZlUG9zaXRpb24uQUZURVIpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Rm9jdXMoZm9jdXNOb2RlLCBmb2N1c1Bvc2l0aW9uKTtcbiAgICAgICAgICAgIHRoaXMuc2V0QW5jaG9yKGFuY2hvck5vZGUsIGFuY2hvclBvc2l0aW9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2V0QW5jaG9yKGFuY2hvck5vZGUsIGFuY2hvclBvc2l0aW9uKTtcbiAgICAgICAgICAgIHRoaXMuc2V0Rm9jdXMoZm9jdXNOb2RlLCBmb2N1c1Bvc2l0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGFuY2hvciBvZiB0aGUgc2VsZWN0aW9uIGJ5IHRhcmdldHRpbmcgYSBgcmVmZXJlbmNlYCBWTm9kZSBhbmRcbiAgICAgKiBzcGVjaWZ5aW5nIHRoZSBgcG9zaXRpb25gIGluIHJlZmVyZW5jZSB0byB0aGF0IFZOb2RlICgnQkVGT1JFJywgJ0FGVEVSJyksXG4gICAgICogbGlrZSBpbiBhbiBgeHBhdGhgLiBJZiBubyByZWxhdGl2ZSBwb3NpdGlvbiBpZiBnaXZlbiwgaW5jbHVkZSB0aGVcbiAgICAgKiByZWZlcmVuY2Ugbm9kZSBpbiB0aGUgc2VsZWN0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlZmVyZW5jZVxuICAgICAqIEBwYXJhbSBbcG9zaXRpb25dXG4gICAgICovXG4gICAgc2V0QW5jaG9yKHJlZmVyZW5jZTogVk5vZGUsIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uRk9SV0FSRCkge1xuICAgICAgICAgICAgdGhpcy5yYW5nZS5zZXRTdGFydChyZWZlcmVuY2UsIHBvc2l0aW9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmFuZ2Uuc2V0RW5kKHJlZmVyZW5jZSwgcG9zaXRpb24pO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgZm9jdXMgb2YgdGhlIHNlbGVjdGlvbiBieSB0YXJnZXR0aW5nIGEgYHJlZmVyZW5jZWAgVk5vZGUgYW5kXG4gICAgICogc3BlY2lmeWluZyB0aGUgYHBvc2l0aW9uYCBpbiByZWZlcmVuY2UgdG8gdGhhdCBWTm9kZSAoJ0JFRk9SRScsICdBRlRFUicpLFxuICAgICAqIGxpa2UgaW4gYW4gYHhwYXRoYC4gSWYgbm8gcmVsYXRpdmUgcG9zaXRpb24gaWYgZ2l2ZW4sIGluY2x1ZGUgdGhlXG4gICAgICogcmVmZXJlbmNlIG5vZGUgaW4gdGhlIHNlbGVjdGlvbi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByZWZlcmVuY2VcbiAgICAgKiBAcGFyYW0gW3Bvc2l0aW9uXVxuICAgICAqL1xuICAgIHNldEZvY3VzKHJlZmVyZW5jZTogVk5vZGUsIHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUik6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5GT1JXQVJEKSB7XG4gICAgICAgICAgICB0aGlzLnJhbmdlLnNldEVuZChyZWZlcmVuY2UsIHBvc2l0aW9uKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmFuZ2Uuc2V0U3RhcnQocmVmZXJlbmNlLCBwb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRXh0ZW5kIHRoZSBzZWxlY3Rpb24gZnJvbSBpdHMgYW5jaG9yIHRvIHRoZSBnaXZlbiBsb2NhdGlvbiwgdGFyZ2V0dGluZyBhXG4gICAgICogYHJlZmVyZW5jZWAgVk5vZGUgYW5kIHNwZWNpZnlpbmcgdGhlIGBkaXJlY3Rpb25gIG9mIHRoZSBleHRlbnNpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcmVmZXJlbmNlXG4gICAgICogQHBhcmFtIFtkaXJlY3Rpb25dIGRlZmF1bHQ6IERpcmVjdGlvbi5GT1JXQVJEXG4gICAgICovXG4gICAgZXh0ZW5kVG8ocmVmZXJlbmNlOiBWTm9kZSwgZGlyZWN0aW9uID0gRGlyZWN0aW9uLkZPUldBUkQpOiB2b2lkIHtcbiAgICAgICAgbGV0IHBvc2l0aW9uOiBSZWxhdGl2ZVBvc2l0aW9uO1xuICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uRk9SV0FSRCkge1xuICAgICAgICAgICAgaWYgKHJlZmVyZW5jZS5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICAgICAgcmVmZXJlbmNlID0gcmVmZXJlbmNlLm5leHQoKTtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2UgPSByZWZlcmVuY2UuZmlyc3RMZWFmKCk7XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVmZXJlbmNlID0gcmVmZXJlbmNlLnByZXZpb3VzKCk7XG4gICAgICAgICAgICBpZiAocmVmZXJlbmNlLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2UgPSByZWZlcmVuY2UuZmlyc3RMZWFmKCk7XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChyZWZlcmVuY2UpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Rm9jdXMocmVmZXJlbmNlLCBwb3NpdGlvbik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29sbGFwc2UgdGhlIHNlbGVjdGlvbiBvbiBpdHMgYW5jaG9yLlxuICAgICAqXG4gICAgICovXG4gICAgY29sbGFwc2UoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucmFuZ2UuY29sbGFwc2UodGhpcy5hbmNob3IpO1xuICAgIH1cbn1cbiIsImltcG9ydCBKV0VkaXRvciwgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGVudW0gQWxpZ25UeXBlIHtcbiAgICBMRUZUID0gJ2xlZnQnLFxuICAgIENFTlRFUiA9ICdjZW50ZXInLFxuICAgIFJJR0hUID0gJ3JpZ2h0JyxcbiAgICBKVVNUSUZZID0gJ2p1c3RpZnknLFxufVxuZXhwb3J0IHR5cGUgQWxpZ25QYXJhbXMgPSBDb21tYW5kUGFyYW1zICYge1xuICAgIHR5cGU6IEFsaWduVHlwZTtcbn07XG5cbmV4cG9ydCBjbGFzcyBBbGlnbjxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtdO1xuICAgIGVkaXRvcjogSldFZGl0b3I7XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIGFsaWduOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmFsaWduLmJpbmQodGhpcyksXG4gICAgICAgIH0sXG4gICAgfTtcbiAgICBsb2FkYWJsZXM6IExvYWRhYmxlczxLZXltYXA+ID0ge1xuICAgICAgICBzaG9ydGN1dHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ3RybCtTaGlmdCtMJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdhbGlnbicsXG4gICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgdHlwZTogQWxpZ25UeXBlLkxFRlQgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0N0cmwrU2hpZnQrRScsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnYWxpZ24nLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IHR5cGU6IEFsaWduVHlwZS5DRU5URVIgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0N0cmwrU2hpZnQrUicsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnYWxpZ24nLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IHR5cGU6IEFsaWduVHlwZS5SSUdIVCB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ3RybCtTaGlmdCtKJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdhbGlnbicsXG4gICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgdHlwZTogQWxpZ25UeXBlLkpVU1RJRlkgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgfTtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gbm9kZSBoYXMgdGhlIGdpdmVuIGFsaWdubWVudCBzdHlsZS4gSWYgbm8gdHlwZVxuICAgICAqIGlzIHBhc3NlZCwgcmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIG5vZGUgaGFzIGFuIGFsaWdubWVudCBzdHlsZSBhdCBhbGwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqIEBwYXJhbSBbdHlwZV1cbiAgICAgKi9cbiAgICBzdGF0aWMgaXNBbGlnbmVkKG5vZGU6IFZOb2RlLCB0eXBlPzogQWxpZ25UeXBlKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGFsaWduID0gbm9kZS5tb2RpZmllcnMuZmluZChBdHRyaWJ1dGVzKT8uc3R5bGUuZ2V0KCd0ZXh0LWFsaWduJyk7XG4gICAgICAgIHJldHVybiB0eXBlID8gYWxpZ24/LmluY2x1ZGVzKHR5cGUpIDogISFhbGlnbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWxpZ24gdGV4dC5cbiAgICAgKi9cbiAgICBhbGlnbihwYXJhbXM6IEFsaWduUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG5vZGVzID0gcGFyYW1zLmNvbnRleHQucmFuZ2UudGFyZ2V0ZWROb2Rlcygobm9kZTogVk5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgIHJldHVybiBub2RlLmlzKENvbnRhaW5lck5vZGUpIHx8IChub2RlLnBhcmVudCAmJiAhbm9kZS5wYXJlbnQuZWRpdGFibGUpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgdHlwZSA9IHBhcmFtcy50eXBlO1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGFsaWduZWRBbmNlc3RvciA9IG5vZGUuYW5jZXN0b3IoQWxpZ24uaXNBbGlnbmVkKTtcblxuICAgICAgICAgICAgLy8gQ29tcHV0ZSBjdXJyZW50IGFsaWdubWVudC5cbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRBbGlnbm1lbnQgPSBhbGlnbmVkQW5jZXN0b3I/Lm1vZGlmaWVyc1xuICAgICAgICAgICAgICAgID8uZmluZChBdHRyaWJ1dGVzKVxuICAgICAgICAgICAgICAgID8uc3R5bGUuZ2V0KCd0ZXh0LWFsaWduJyk7XG5cbiAgICAgICAgICAgIGlmICghYWxpZ25lZEFuY2VzdG9yIHx8IGN1cnJlbnRBbGlnbm1lbnQgIT09IHR5cGUpIHtcbiAgICAgICAgICAgICAgICBub2RlLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc3R5bGUuc2V0KCd0ZXh0LWFsaWduJywgdHlwZS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IEJ1dHRvbiB9IGZyb20gJy4uLy4uL3BsdWdpbi10b29sYmFyL3NyYy9Ub29sYmFyJztcbmltcG9ydCB7IEFsaWduVHlwZSwgQWxpZ25QYXJhbXMsIEFsaWduIH0gZnJvbSAnLi9BbGlnbic7XG5pbXBvcnQgSldFZGl0b3IgZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcblxuZnVuY3Rpb24gaXNBbGlnbmVkKG5vZGU6IFZOb2RlLCB0eXBlOiBBbGlnblR5cGUpOiBib29sZWFuIHtcbiAgICBjb25zdCBhbGlnbmVkQW5jZXN0b3IgPSBub2RlLmFuY2VzdG9yKEFsaWduLmlzQWxpZ25lZCk7XG4gICAgcmV0dXJuIEFsaWduLmlzQWxpZ25lZChhbGlnbmVkQW5jZXN0b3IgfHwgbm9kZSwgdHlwZSk7XG59XG5cbmV4cG9ydCBjb25zdCBBbGlnbkxlZnRCdXR0b246IEJ1dHRvbiA9IHtcbiAgICB0aXRsZTogJ0FsaWduIGxlZnQnLFxuICAgIGNsYXNzOiAnZmEtYWxpZ24tbGVmdCcsXG4gICAgY29tbWFuZElkOiAnYWxpZ24nLFxuICAgIGNvbW1hbmRBcmdzOiB7IHR5cGU6IEFsaWduVHlwZS5MRUZUIH0gYXMgQWxpZ25QYXJhbXMsXG4gICAgc2VsZWN0ZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBlZGl0b3Iuc2VsZWN0aW9uLnJhbmdlXG4gICAgICAgICAgICAudGFyZ2V0ZWROb2Rlcyhub2RlID0+IG5vZGUuaXMoQ29udGFpbmVyTm9kZSkpXG4gICAgICAgICAgICAuZXZlcnkobm9kZSA9PiBpc0FsaWduZWQobm9kZSwgQWxpZ25UeXBlLkxFRlQpKTtcbiAgICB9LFxufTtcbmV4cG9ydCBjb25zdCBBbGlnbkNlbnRlckJ1dHRvbjogQnV0dG9uID0ge1xuICAgIHRpdGxlOiAnQWxpZ24gY2VudGVyJyxcbiAgICBjbGFzczogJ2ZhLWFsaWduLWNlbnRlcicsXG4gICAgY29tbWFuZElkOiAnYWxpZ24nLFxuICAgIGNvbW1hbmRBcmdzOiB7IHR5cGU6IEFsaWduVHlwZS5DRU5URVIgfSBhcyBBbGlnblBhcmFtcyxcbiAgICBzZWxlY3RlZDogKGVkaXRvcjogSldFZGl0b3IpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGVkaXRvci5zZWxlY3Rpb24ucmFuZ2VcbiAgICAgICAgICAgIC50YXJnZXRlZE5vZGVzKG5vZGUgPT4gbm9kZS5pcyhDb250YWluZXJOb2RlKSlcbiAgICAgICAgICAgIC5ldmVyeShub2RlID0+IGlzQWxpZ25lZChub2RlLCBBbGlnblR5cGUuQ0VOVEVSKSk7XG4gICAgfSxcbn07XG5leHBvcnQgY29uc3QgQWxpZ25SaWdodEJ1dHRvbjogQnV0dG9uID0ge1xuICAgIHRpdGxlOiAnQWxpZ24gcmlnaHQnLFxuICAgIGNsYXNzOiAnZmEtYWxpZ24tcmlnaHQnLFxuICAgIGNvbW1hbmRJZDogJ2FsaWduJyxcbiAgICBjb21tYW5kQXJnczogeyB0eXBlOiBBbGlnblR5cGUuUklHSFQgfSBhcyBBbGlnblBhcmFtcyxcbiAgICBzZWxlY3RlZDogKGVkaXRvcjogSldFZGl0b3IpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGVkaXRvci5zZWxlY3Rpb24ucmFuZ2VcbiAgICAgICAgICAgIC50YXJnZXRlZE5vZGVzKG5vZGUgPT4gbm9kZS5pcyhDb250YWluZXJOb2RlKSlcbiAgICAgICAgICAgIC5ldmVyeShub2RlID0+IGlzQWxpZ25lZChub2RlLCBBbGlnblR5cGUuUklHSFQpKTtcbiAgICB9LFxufTtcbmV4cG9ydCBjb25zdCBBbGlnbkp1c3RpZnlCdXR0b246IEJ1dHRvbiA9IHtcbiAgICB0aXRsZTogJ0FsaWduIGp1c3RpZnknLFxuICAgIGNsYXNzOiAnZmEtYWxpZ24tanVzdGlmeScsXG4gICAgY29tbWFuZElkOiAnYWxpZ24nLFxuICAgIGNvbW1hbmRBcmdzOiB7IHR5cGU6IEFsaWduVHlwZS5KVVNUSUZZIH0gYXMgQWxpZ25QYXJhbXMsXG4gICAgc2VsZWN0ZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBlZGl0b3Iuc2VsZWN0aW9uLnJhbmdlXG4gICAgICAgICAgICAudGFyZ2V0ZWROb2Rlcyhub2RlID0+IG5vZGUuaXMoQ29udGFpbmVyTm9kZSkpXG4gICAgICAgICAgICAuZXZlcnkobm9kZSA9PiBpc0FsaWduZWQobm9kZSwgQWxpZ25UeXBlLkpVU1RJRlkpKTtcbiAgICB9LFxufTtcbiIsImltcG9ydCB7IENvbG9yLCBDb2xvckNvbmZpZyB9IGZyb20gJy4uLy4uL3BsdWdpbi1jb2xvci9zcmMvQ29sb3InO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgS2V5bWFwIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcblxuZXhwb3J0IGNsYXNzIEJhY2tncm91bmRDb2xvcjxUIGV4dGVuZHMgQ29sb3JDb25maWcgPSBDb2xvckNvbmZpZz4gZXh0ZW5kcyBDb2xvcjxUPiB7XG4gICAgc3R5bGVOYW1lID0gJ2JhY2tncm91bmQtY29sb3InO1xuICAgIGNvbmZpZ3VyYXRpb24gPSB7IGRlZmF1bHRDb2xvcjogJ3doaXRlJywgLi4udGhpcy5jb25maWd1cmF0aW9uIH07XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIGNvbG9yQmFja2dyb3VuZDoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5jb2xvcixcbiAgICAgICAgfSxcbiAgICAgICAgdW5jb2xvckJhY2tncm91bmQ6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMudW5jb2xvcixcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPEtleW1hcD4gPSB7XG4gICAgICAgIHNob3J0Y3V0czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK0gnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2NvbG9yQmFja2dyb3VuZCcsXG4gICAgICAgICAgICAgICAgLy8gVE9ETzogdXNlIGRpYWxvZyB0byBnZXQgcGFyYW1zXG4gICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICd5ZWxsb3cnLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1NISUZUK0gnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3VuY29sb3JCYWNrZ3JvdW5kJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IEJsb2NrcXVvdGVYbWxEb21QYXJzZXIgfSBmcm9tICcuL0Jsb2NrcXVvdGVYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcblxuZXhwb3J0IGNsYXNzIEJsb2NrcXVvdGU8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlcj4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtCbG9ja3F1b3RlWG1sRG9tUGFyc2VyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuXG5leHBvcnQgY2xhc3MgQmxvY2txdW90ZU5vZGUgZXh0ZW5kcyBWRWxlbWVudCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKHsgaHRtbFRhZzogJ0JMT0NLUVVPVEUnIH0pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQmxvY2txdW90ZU5vZGUgfSBmcm9tICcuL0Jsb2NrcXVvdGVOb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIEJsb2NrcXVvdGVYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgbm9kZU5hbWUoaXRlbSkgPT09ICdCTE9DS1FVT1RFJztcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8QmxvY2txdW90ZU5vZGVbXT4ge1xuICAgICAgICBjb25zdCBibG9ja3F1b3RlID0gbmV3IEJsb2NrcXVvdGVOb2RlKCk7XG4gICAgICAgIGJsb2NrcXVvdGUubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSkpO1xuICAgICAgICBjb25zdCBub2RlcyA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIGJsb2NrcXVvdGUuYXBwZW5kKC4uLm5vZGVzKTtcbiAgICAgICAgcmV0dXJuIFtibG9ja3F1b3RlXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBCb2xkRm9ybWF0IH0gZnJvbSAnLi9Cb2xkRm9ybWF0JztcbmltcG9ydCB7IEZvcm1hdFBhcmFtcywgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IEJvbGRYbWxEb21QYXJzZXIgfSBmcm9tICcuL0JvbGRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IEtleW1hcCB9IGZyb20gJy4uLy4uL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5cbmV4cG9ydCBjbGFzcyBCb2xkPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW0lubGluZV07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgS2V5bWFwPiA9IHtcbiAgICAgICAgcGFyc2VyczogW0JvbGRYbWxEb21QYXJzZXJdLFxuICAgICAgICBzaG9ydGN1dHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtCJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd0b2dnbGVGb3JtYXQnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IEZvcm1hdENsYXNzOiBCb2xkRm9ybWF0IH0gYXMgRm9ybWF0UGFyYW1zLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IEpXRWRpdG9yIGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IEJvbGRGb3JtYXQgfSBmcm9tICcuL0JvbGRGb3JtYXQnO1xuaW1wb3J0IHsgRm9ybWF0UGFyYW1zLCBJbmxpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmUnO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXRvb2xiYXIvc3JjL1Rvb2xiYXInO1xuXG5leHBvcnQgY29uc3QgQm9sZEJ1dHRvbjogQnV0dG9uID0ge1xuICAgIHRpdGxlOiAnVG9nZ2xlIGJvbGQnLFxuICAgIGNsYXNzOiAnZmEtYm9sZCcsXG4gICAgY29tbWFuZElkOiAndG9nZ2xlRm9ybWF0JyxcbiAgICBjb21tYW5kQXJnczogeyBGb3JtYXRDbGFzczogQm9sZEZvcm1hdCB9IGFzIEZvcm1hdFBhcmFtcyxcbiAgICBzZWxlY3RlZDogKGVkaXRvcjogSldFZGl0b3IpOiBib29sZWFuID0+IGVkaXRvci5wbHVnaW5zLmdldChJbmxpbmUpLmlzQWxsRm9ybWF0KEJvbGRGb3JtYXQpLFxufTtcbiIsImltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdCc7XG5cbmV4cG9ydCBjbGFzcyBCb2xkRm9ybWF0IGV4dGVuZHMgRm9ybWF0IHtcbiAgICBjb25zdHJ1Y3RvcihodG1sVGFnOiAnQicgfCAnU1RST05HJyA9ICdCJykge1xuICAgICAgICBzdXBlcihodG1sVGFnKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBGb3JtYXRQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9Gb3JtYXRQYXJzZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQm9sZEZvcm1hdCB9IGZyb20gJy4vQm9sZEZvcm1hdCc7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBCb2xkWG1sRG9tUGFyc2VyIGV4dGVuZHMgRm9ybWF0UGFyc2VyIHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiAobm9kZU5hbWUoaXRlbSkgPT09ICdCJyB8fCBub2RlTmFtZShpdGVtKSA9PT0gJ1NUUk9ORycpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIGJvbGQgbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICovXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBib2xkID0gbmV3IEJvbGRGb3JtYXQobm9kZU5hbWUoaXRlbSkgYXMgJ0InIHwgJ1NUUk9ORycpO1xuICAgICAgICBib2xkLm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KGJvbGQsIGNoaWxkcmVuKTtcblxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgQ2hhck5vZGUgfSBmcm9tICcuL0NoYXJOb2RlJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IElubGluZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBDaGFyRm9ybWF0SHRtbERvbVJlbmRlcmVyIH0gZnJvbSAnLi9DaGFyRm9ybWF0SHRtbERvbVJlbmRlcmVyJztcbmltcG9ydCB7IENoYXJIdG1sRG9tUmVuZGVyZXIgfSBmcm9tICcuL0NoYXJIdG1sRG9tUmVuZGVyZXInO1xuaW1wb3J0IHsgQ2hhclhtbERvbVBhcnNlciB9IGZyb20gJy4vQ2hhclhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBNb2RpZmllcnMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RpZmllcnMnO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmltcG9ydCB7IFBvaW50LCBSZWxhdGl2ZVBvc2l0aW9uLCBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSW5zZXJ0VGV4dFBhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIHRleHQ6IHN0cmluZztcbiAgICBzZWxlY3Q/OiBib29sZWFuO1xuICAgIGZvcm1hdHM/OiBNb2RpZmllcnM7XG59XG5leHBvcnQgaW50ZXJmYWNlIEluc2VydEh0bWxQYXJhbXMgZXh0ZW5kcyBDb21tYW5kUGFyYW1zIHtcbiAgICByYW5nZVBvaW50PzogUG9pbnQ7XG4gICAgaHRtbDogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgQ2hhcjxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtJbmxpbmVdO1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW0NoYXJYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtDaGFyRm9ybWF0SHRtbERvbVJlbmRlcmVyLCBDaGFySHRtbERvbVJlbmRlcmVyXSxcbiAgICB9O1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBpbnNlcnRUZXh0OiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmluc2VydFRleHQsXG4gICAgICAgIH0sXG4gICAgICAgIGluc2VydEh0bWw6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuaW5zZXJ0SHRtbC5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0IHRleHQgYXQgdGhlIGN1cnJlbnQgcG9zaXRpb24gb2YgdGhlIHNlbGVjdGlvbi5cbiAgICAgKlxuICAgICAqIElmIHRoZSBzZWxlY3Rpb24gaXMgY29sbGFwc2VkLCBhZGQgYHRleHRgIHRvIHRoZSB2RG9jdW1lbnQgYW5kIGNvcHkgdGhlXG4gICAgICogZm9ybWF0aW5nIG9mIHRoZSBwcmV2aW91cyBjaGFyIG9yIHRoZSBuZXh0IGNoYXIuXG4gICAgICpcbiAgICAgKiBJZiB0aGUgc2VsZWN0aW9uIGlzIG5vdCBjb2xsYXBzZWQsIHJlcGxhY2UgdGhlIHRleHQgd2l0aCB0aGUgZm9ybWF0aW5nXG4gICAgICogdGhhdCB3YXMgcHJlc2VudCBpbiB0aGUgc2VsZWN0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGluc2VydFRleHQocGFyYW1zOiBJbnNlcnRUZXh0UGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IHRleHQgPSBwYXJhbXMudGV4dDtcbiAgICAgICAgY29uc3QgaW5saW5lID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoSW5saW5lKTtcbiAgICAgICAgY29uc3QgbW9kaWZpZXJzID0gaW5saW5lLmdldEN1cnJlbnRNb2RpZmllcnMocmFuZ2UpO1xuICAgICAgICBpZiAocGFyYW1zLmZvcm1hdHMpIHtcbiAgICAgICAgICAgIG1vZGlmaWVycy5yZXBsYWNlT3JBcHBlbmQocGFyYW1zLmZvcm1hdHMpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0eWxlID0gaW5saW5lLmdldEN1cnJlbnRTdHlsZShyYW5nZSk7XG4gICAgICAgIC8vIFJlbW92ZSB0aGUgY29udGVudHMgb2YgdGhlIHJhbmdlIGlmIG5lZWRlZC5cbiAgICAgICAgY29uc29sZS5sb2coJyFyYW5nZS5pc0NvbGxhcHNlZCgpOicsICFyYW5nZS5pc0NvbGxhcHNlZCgpKTtcbiAgICAgICAgaWYgKCFyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICByYW5nZS5lbXB0eSgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNwbGl0IHRoZSB0ZXh0IGludG8gQ0hBUiBub2RlcyBhbmQgaW5zZXJ0IHRoZW0gYXQgdGhlIHJhbmdlLlxuICAgICAgICBjb25zdCBjaGFyYWN0ZXJzID0gdGV4dC5zcGxpdCgnJyk7XG4gICAgICAgIGNvbnN0IGNoYXJOb2RlcyA9IGNoYXJhY3RlcnMubWFwKGNoYXIgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDaGFyTm9kZSh7IGNoYXI6IGNoYXIsIG1vZGlmaWVyczogbW9kaWZpZXJzLmNsb25lKCkgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICBjaGFyTm9kZXMuZm9yRWFjaChjaGFyTm9kZSA9PiB7XG4gICAgICAgICAgICBjaGFyTm9kZS5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnN0eWxlID0gc3R5bGU7XG4gICAgICAgICAgICByYW5nZS5zdGFydC5iZWZvcmUoY2hhck5vZGUpO1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKHBhcmFtcy5zZWxlY3QgJiYgY2hhck5vZGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnNlbGVjdChjaGFyTm9kZXNbMF0sIGNoYXJOb2Rlc1tjaGFyTm9kZXMubGVuZ3RoIC0gMV0pO1xuICAgICAgICB9XG4gICAgICAgIGlubGluZS5yZXNldENhY2hlKCk7XG4gICAgfVxuICAgIGFzeW5jIGluc2VydEh0bWwocGFyYW1zOiBJbnNlcnRIdG1sUGFyYW1zKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHBhcnNlciA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFBhcnNlcik7XG4gICAgICAgIGNvbnN0IGRvbVBhcnNlciA9IHBhcnNlciAmJiBwYXJzZXIuZW5naW5lc1snZG9tL2h0bWwnXTtcbiAgICAgICAgaWYgKCFkb21QYXJzZXIpIHtcbiAgICAgICAgICAgIC8vIFRPRE86IHJlbW92ZSB0aGlzIHdoZW4gdGhlIGVkaXRvciBjYW4gYmUgaW5zdGFudGlhdGVkIG9uXG4gICAgICAgICAgICAvLyBzb21ldGhpbmcgZWxzZSB0aGFuIERPTS5cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gRE9NIHBhcnNlciBpbnN0YWxsZWQuYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGRpdi5pbm5lckhUTUwgPSBwYXJhbXMuaHRtbDtcbiAgICAgICAgY29uc3QgcGFyc2VkRWRpdGFibGUgPSBhd2FpdCBkb21QYXJzZXIucGFyc2UoZGl2KTtcbiAgICAgICAgY29uc3QgbmV3Tm9kZXMgPSBwYXJzZWRFZGl0YWJsZVswXS5jaGlsZHJlbigpO1xuXG4gICAgICAgIC8vIFJlbW92ZSB0aGUgY29udGVudHMgb2YgdGhlIHJhbmdlIGlmIG5lZWRlZC5cbiAgICAgICAgLy8gdG9kbzogdXNlIFBvaW50IG9yIFJhbmdlIGJ1dCBub3QgYm90aC5cbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgaWYgKCFyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICByYW5nZS5lbXB0eSgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXJhbXMucmFuZ2VQb2ludCkge1xuICAgICAgICAgICAgY29uc3QgW25vZGUsIHBvc2l0aW9uXSA9IHBhcmFtcy5yYW5nZVBvaW50O1xuICAgICAgICAgICAgc3dpdGNoIChwb3NpdGlvbikge1xuICAgICAgICAgICAgICAgIGNhc2UgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkU6XG4gICAgICAgICAgICAgICAgICAgIG5ld05vZGVzLmZvckVhY2gobm9kZS5iZWZvcmUuYmluZChub2RlKSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgUmVsYXRpdmVQb3NpdGlvbi5BRlRFUjpcbiAgICAgICAgICAgICAgICAgICAgWy4uLm5ld05vZGVzXS5yZXZlcnNlKCkuZm9yRWFjaChub2RlLmFmdGVyLmJpbmQobm9kZSkpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFJlbGF0aXZlUG9zaXRpb24uSU5TSURFOlxuICAgICAgICAgICAgICAgICAgICBub2RlLmFwcGVuZCguLi5uZXdOb2Rlcyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3Tm9kZXMuZm9yRWFjaChyYW5nZS5zdGFydC5iZWZvcmUuYmluZChyYW5nZS5zdGFydCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdOb2RlcztcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBGb3JtYXREb21SZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdERvbVJlbmRlcmVyJztcbmltcG9ydCB7IENoYXJOb2RlIH0gZnJvbSAnLi9DaGFyTm9kZSc7XG5pbXBvcnQgeyBIdG1sRG9tUmVuZGVyaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWh0bWwvc3JjL0h0bWxEb21SZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgRm9ybWF0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvRm9ybWF0JztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIENoYXJGb3JtYXRIdG1sRG9tUmVuZGVyZXIgZXh0ZW5kcyBGb3JtYXREb21SZW5kZXJlciB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gQ2hhck5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogQ2hhck5vZGUpOiBQcm9taXNlPE5vZGVbXT4ge1xuICAgICAgICBjb25zdCBwcmV2aW91c1NpYmxpbmcgPSBub2RlLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICBpZiAocHJldmlvdXNTaWJsaW5nICYmIG5vZGUuaXNTYW1lVGV4dE5vZGUocHJldmlvdXNTaWJsaW5nKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZW5naW5lLnJlbmRlcihwcmV2aW91c1NpYmxpbmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdGV4dE5vZGUgPSBhd2FpdCB0aGlzLnN1cGVyLnJlbmRlcihub2RlKTtcblxuICAgICAgICAvLyBJZiB0aGUgbm9kZSBoYXMgYXR0cmlidXRlcywgd3JhcCBpdCBpbnNpZGUgYSBzcGFuIHdpdGggdGhvc2VcbiAgICAgICAgLy8gYXR0cmlidXRlcy5cbiAgICAgICAgbGV0IHJlbmRlcmluZzogTm9kZVtdO1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gbm9kZS5tb2RpZmllcnMuZmluZChBdHRyaWJ1dGVzKTtcbiAgICAgICAgaWYgKGF0dHJpYnV0ZXM/Lmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3Qgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgIHRoaXMuZW5naW5lLnJlbmRlckF0dHJpYnV0ZXMoQXR0cmlidXRlcywgbm9kZSwgc3Bhbik7XG4gICAgICAgICAgICB0ZXh0Tm9kZS5mb3JFYWNoKGNoaWxkID0+IHNwYW4uYXBwZW5kQ2hpbGQoY2hpbGQpKTtcbiAgICAgICAgICAgIHJlbmRlcmluZyA9IFtzcGFuXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlbmRlcmluZyA9IHRleHROb2RlO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyRm9ybWF0cyhub2RlLm1vZGlmaWVycy5maWx0ZXIoRm9ybWF0KSwgcmVuZGVyaW5nKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IENoYXJOb2RlIH0gZnJvbSAnLi9DaGFyTm9kZSc7XG5pbXBvcnQgeyBJbmxpbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lTm9kZSc7XG5pbXBvcnQgeyBIdG1sRG9tUmVuZGVyaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWh0bWwvc3JjL0h0bWxEb21SZW5kZXJpbmdFbmdpbmUnO1xuXG5leHBvcnQgY2xhc3MgQ2hhckh0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBwcmVkaWNhdGUgPSBDaGFyTm9kZTtcblxuICAgIGFzeW5jIHJlbmRlcihub2RlOiBDaGFyTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIC8vIENvbnNlY3V0aXZlIGNvbXBhdGlibGUgY2hhciBub2RlcyBhcmUgcmVuZGVyZWQgYXMgYSBzaW5nbGUgdGV4dCBub2RlLlxuICAgICAgICBsZXQgdGV4dCA9ICcnICsgbm9kZS5jaGFyO1xuICAgICAgICBsZXQgbmV4dCA9IG5vZGUubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgY29uc3QgY2hhck5vZGVzID0gW25vZGVdO1xuICAgICAgICB3aGlsZSAobmV4dCAmJiBub2RlLmlzU2FtZVRleHROb2RlKG5leHQpKSB7XG4gICAgICAgICAgICBpZiAobmV4dCBpbnN0YW5jZW9mIENoYXJOb2RlKSB7XG4gICAgICAgICAgICAgICAgY2hhck5vZGVzLnB1c2gobmV4dCk7XG4gICAgICAgICAgICAgICAgaWYgKG5leHQuY2hhciA9PT0gJyAnICYmIHRleHRbdGV4dC5sZW5ndGggLSAxXSA9PT0gJyAnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEJyb3dzZXJzIGRvbid0IHJlbmRlciBjb25zZWN1dGl2ZSBzcGFjZSBjaGFycyBvdGhlcndpc2UuXG4gICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJ1xcdTAwQTAnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQgKz0gbmV4dC5jaGFyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5leHQgPSBuZXh0Lm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUmVuZGVyIGJsb2NrIGVkZ2Ugc3BhY2VzIGFzIG5vbi1icmVha2FibGUgc3BhY2UgKG90aGVyd2lzZSBicm93c2Vyc1xuICAgICAgICAvLyB3b24ndCByZW5kZXIgdGhlbSkuXG4gICAgICAgIGNvbnN0IHByZXZpb3VzID0gbm9kZS5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgaWYgKCFwcmV2aW91cyB8fCAhcHJldmlvdXMuaXMoSW5saW5lTm9kZSkpIHtcbiAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UoL14gL2csICdcXHUwMEEwJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFuZXh0IHx8ICFuZXh0LmlzKElubGluZU5vZGUpKSB7XG4gICAgICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC8gJC9nLCAnXFx1MDBBMCcpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlbmRlcmluZyA9IFByb21pc2UucmVzb2x2ZShbZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGV4dCldKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5naW5lLnJlbmRlcmVkKGNoYXJOb2RlcywgW3RoaXMsIHJlbmRlcmluZ10pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE1hcmtlck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvTWFya2VyTm9kZSc7XG5pbXBvcnQgeyBJbmxpbmVOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lTm9kZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBNb2RpZmllcnMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RpZmllcnMnO1xuXG5leHBvcnQgY2xhc3MgQ2hhck5vZGUgZXh0ZW5kcyBJbmxpbmVOb2RlIHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgYXRvbWljID0gdHJ1ZTtcbiAgICByZWFkb25seSBjaGFyOiBzdHJpbmc7XG4gICAgY29uc3RydWN0b3IocGFyYW1zOiB7IGNoYXI6IHN0cmluZzsgbW9kaWZpZXJzPzogTW9kaWZpZXJzIH0pIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgaWYgKHBhcmFtcy5jaGFyLmxlbmd0aCAhPT0gMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgICAgICdDYW5ub3QgbWFrZSBhIENoYXJOb2RlIG91dCBvZiBhbnl0aGluZyBlbHNlIHRoYW4gYSBzdHJpbmcgb2YgbGVuZ3RoIDEuJyxcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jaGFyID0gcGFyYW1zLmNoYXI7XG4gICAgICAgIGlmIChwYXJhbXMubW9kaWZpZXJzKSB7XG4gICAgICAgICAgICB0aGlzLm1vZGlmaWVycyA9IHBhcmFtcy5tb2RpZmllcnM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gTGlmZWN5Y2xlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hhcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgbmV3IFZOb2RlIHdpdGggdGhlIHNhbWUgdHlwZSBhbmQgYXR0cmlidXRlcyBhcyB0aGlzIFZOb2RlLlxuICAgICAqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgY2xvbmUocGFyYW1zPzoge30pOiB0aGlzIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdHM6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgQ2hhck5vZGU+WzBdID0ge1xuICAgICAgICAgICAgY2hhcjogdGhpcy5jaGFyLFxuICAgICAgICAgICAgbW9kaWZpZXJzOiB0aGlzLm1vZGlmaWVycy5jbG9uZSgpLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc3VwZXIuY2xvbmUoeyAuLi5kZWZhdWx0cywgLi4ucGFyYW1zIH0pO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGxlbmd0aCBvZiB0aGlzIFZOb2RlLlxuICAgICAqL1xuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgdGV4dCBjb250ZW50IG9mIHRoaXMgbm9kZS5cbiAgICAgKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIGdldCB0ZXh0Q29udGVudCgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5jaGFyO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiBgYWAgaGFzIHRoZSBzYW1lIGZvcm1hdCBwcm9wZXJ0aWVzIGFzIGBiYC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBhXG4gICAgICogQHBhcmFtIGJcbiAgICAgKi9cbiAgICBpc1NhbWVUZXh0Tm9kZShub2RlOiBWTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodGhpcy5pcyhDaGFyTm9kZSkgJiYgbm9kZS5pcyhDaGFyTm9kZSkpIHtcbiAgICAgICAgICAgIC8vIENoYXIgVk5vZGVzIGFyZSB0aGUgc2FtZSB0ZXh0IG5vZGUgaWYgdGhleSBoYXZlIHRoZSBzYW1lXG4gICAgICAgICAgICAvLyBtb2RpZmllcnMuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5tb2RpZmllcnMuYXJlU2FtZUFzKG5vZGUubW9kaWZpZXJzKTtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLmlzKE1hcmtlck5vZGUpIHx8IG5vZGUuaXMoTWFya2VyTm9kZSkpIHtcbiAgICAgICAgICAgIC8vIEEgTWFya2VyIG5vZGUgaXMgYWx3YXlzIGNvbnNpZGVyZWQgdG8gYmUgcGFydCBvZiB0aGUgc2FtZSB0ZXh0XG4gICAgICAgICAgICAvLyBub2RlIGFzIGFub3RoZXIgbm9kZSBpbiB0aGUgc2Vuc2UgdGhhdCB0aGUgdGV4dCBub2RlIG11c3Qgbm90XG4gICAgICAgICAgICAvLyBiZSBicm9rZW4gdXAganVzdCBiZWNhdXNlIGl0IGNvbnRhaW5zIGEgbWFya2VyLlxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBOb2RlcyB0aGF0IGFyZSBub3QgdmFsaWQgaW4gYSB0ZXh0IG5vZGUgbXVzdCBlbmQgdGhlIHRleHQgbm9kZS5cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IHJlbW92ZUZvcm1hdHRpbmdTcGFjZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy9mb3JtYXR0aW5nU3BhY2UnO1xuaW1wb3J0IHsgQ2hhck5vZGUgfSBmcm9tICcuL0NoYXJOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuXG5leHBvcnQgY2xhc3MgQ2hhclhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERTtcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogTm9kZSk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBub2RlczogVk5vZGVbXSA9IFtdO1xuICAgICAgICBjb25zdCB0ZXh0ID0gcmVtb3ZlRm9ybWF0dGluZ1NwYWNlKGl0ZW0pO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGNoYXIgPSB0ZXh0LmNoYXJBdChpKTtcbiAgICAgICAgICAgIGxldCBwYXJzZWRWTm9kZTogVk5vZGU7XG4gICAgICAgICAgICBpZiAoY2hhciA9PT0gJ1xcbicpIHtcbiAgICAgICAgICAgICAgICBwYXJzZWRWTm9kZSA9IG5ldyB0aGlzLmVuZ2luZS5lZGl0b3IuY29uZmlndXJhdGlvbi5kZWZhdWx0cy5TZXBhcmF0b3IoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFyc2VkVk5vZGUgPSBuZXcgQ2hhck5vZGUoeyBjaGFyOiBjaGFyIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9kZXMucHVzaChwYXJzZWRWTm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGVzO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IElubGluZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdE5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQWJzdHJhY3ROb2RlJztcbmltcG9ydCB7IElubGluZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmVOb2RlJztcbmltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdCc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBDc3NTdHlsZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0Nzc1N0eWxlJztcblxuZXhwb3J0IGludGVyZmFjZSBDb2xvclBhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIGNvbG9yPzogc3RyaW5nOyAvLyBjc3MtdmFsaWQgY29sb3IgbmFtZVxufVxuZXhwb3J0IGludGVyZmFjZSBDb2xvckNvbmZpZyBleHRlbmRzIEpXUGx1Z2luQ29uZmlnIHtcbiAgICBkZWZhdWx0Q29sb3I/OiBzdHJpbmc7IC8vIGNzcy12YWxpZCBjb2xvciBuYW1lXG59XG5cbmV4cG9ydCBjbGFzcyBDb2xvcjxUIGV4dGVuZHMgQ29sb3JDb25maWcgPSBDb2xvckNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtJbmxpbmVdO1xuICAgIHN0eWxlTmFtZTogc3RyaW5nOyAvLyBjc3MtdmFsaWQgc3R5bGUgcHJvcGVydHkgbmFtZSAoZWc6ICdiYWNrZ3JvdW5kLWNvbG9yJylcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gbm9kZSBoYXMgdGhlIGdpdmVuIGNvbG9yLlxuICAgICAqIElmIG5vIGNvbG9yIGlzIHBhc3NlZCwgcmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIG5vZGUgaGFzIGFueSBjb2xvci5cbiAgICAgKiBSZXR1cm4gZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqL1xuICAgIGhhc0NvbG9yKG5vZGU6IFZOb2RlKTogYm9vbGVhbjtcbiAgICBoYXNDb2xvcihjb2xvcjogc3RyaW5nLCBub2RlOiBWTm9kZSk6IGJvb2xlYW47XG4gICAgaGFzQ29sb3IoY29sb3I6IHN0cmluZyB8IFZOb2RlLCBub2RlPzogVk5vZGUpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKGNvbG9yIGluc3RhbmNlb2YgQWJzdHJhY3ROb2RlKSB7XG4gICAgICAgICAgICBub2RlID0gY29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgbm9kZUJhY2tncm91bmRDb2xvciA9IG5vZGUubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk/LnN0eWxlLmdldCh0aGlzLnN0eWxlTmFtZSk7XG4gICAgICAgIGlmIChjb2xvciBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuICEhbm9kZUJhY2tncm91bmRDb2xvcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBub2RlQmFja2dyb3VuZENvbG9yID09PSBjb2xvcjtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBseSB0aGUgZ2l2ZW4gY29sb3IgdG8gdGhlIHJhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGNvbG9yKHBhcmFtczogQ29sb3JQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY29sb3IgPSBwYXJhbXMuY29sb3I7XG4gICAgICAgIGlmIChwYXJhbXMuY29udGV4dC5yYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICAvLyBTZXQgdGhlIHN0eWxlIGNhY2hlLlxuICAgICAgICAgICAgY29uc3QgaW5saW5lID0gdGhpcy5kZXBlbmRlbmNpZXMuZ2V0KElubGluZSk7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50Q2FjaGUgPSBpbmxpbmUuY2FjaGUuc3R5bGUgfHwge307XG4gICAgICAgICAgICBpbmxpbmUuY2FjaGUuc3R5bGUgPSBuZXcgQ3NzU3R5bGUoeyAuLi5jdXJyZW50Q2FjaGUsIFt0aGlzLnN0eWxlTmFtZV06IGNvbG9yIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3Qgc2VsZWN0ZWROb2RlcyA9IHBhcmFtcy5jb250ZXh0LnJhbmdlLnNlbGVjdGVkTm9kZXMoKTtcbiAgICAgICAgICAgIC8vIFNraXAgaWYgdGhlIG5vZGUgYWxyZWFkeSBoYXMgdGhlIHJpZ2h0IGNvbG9yLCB0aHJvdWdoIGFuXG4gICAgICAgICAgICAvLyBhbmNlc3RvciBvciBhIGZvcm1hdC5cbiAgICAgICAgICAgIGNvbnN0IG5vdENvbG9yZWRZZXQgPSBzZWxlY3RlZE5vZGVzLmZpbHRlcihub2RlID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oYXNDb2xvcihjb2xvciwgbm9kZSkpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICBjb25zdCBjb2xvckFuY2VzdG9yID0gbm9kZS5hbmNlc3Rvcih0aGlzLmhhc0NvbG9yLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIHJldHVybiAhY29sb3JBbmNlc3RvciB8fCAhdGhpcy5oYXNDb2xvcihjb2xvciwgY29sb3JBbmNlc3Rvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub3RDb2xvcmVkWWV0KSB7XG4gICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIHN0eWxlIHRvIHRoZSBub2RlIG9yIGl0cyBmaXJzdCBmb3JtYXQuXG4gICAgICAgICAgICAgICAgdGhpcy5fbm9kZU9yRmlyc3RGb3JtYXQobm9kZSlcbiAgICAgICAgICAgICAgICAgICAgLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcylcbiAgICAgICAgICAgICAgICAgICAgLnN0eWxlLnNldCh0aGlzLnN0eWxlTmFtZSwgY29sb3IpO1xuXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIGFuY2VzdG9ycyBvZiB0aGlzIG5vZGUgd2hvc2UgY2hpbGRyZW4gYWxsIGhhdmVcbiAgICAgICAgICAgICAgICAvLyB0aGlzIHN0eWxlLCBzdHlsZSB0aGVzZSBhbmNlc3RvcnMgaW5zdGVhZCBvZiB0aGVpclxuICAgICAgICAgICAgICAgIC8vIGRlc2NlbmRhbnRzLlxuICAgICAgICAgICAgICAgIGxldCBwYXJlbnQgPSBub2RlLnBhcmVudDtcbiAgICAgICAgICAgICAgICB3aGlsZSAocGFyZW50ICYmIHBhcmVudC5lZGl0YWJsZSAmJiB0aGlzLl9pc0FsbENvbG9yZWQocGFyZW50LCBjb2xvcikpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyZW50Lm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc3R5bGUuc2V0KHRoaXMuc3R5bGVOYW1lLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IG5vdCByZW1vdmUgdGhlIGNoaWxkcmVuJ3Mgc3R5bGVzIHdoZW4gd2UgaGF2ZSBtb2RpZmllcnMuXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgcGFyZW50LmNoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpPy5zdHlsZS5yZW1vdmUodGhpcy5zdHlsZU5hbWUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGUgY3VycmVudCBjb2xvciBmcm9tIHRoZSByYW5nZS4gSWYgdGhlIGNvbG9yIHdhcyBhcHBsaWVkIHRvXG4gICAgICogYW4gYW5jZXN0b3IsIGFwcGx5IHRoZSBkZWZhdWx0IGNvbG9yIHRvIGl0cyByZWxldmFudCBpbmxpbmUgZGVzY2VuZGFudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgdW5jb2xvcihwYXJhbXM6IENvbW1hbmRQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3QgZGVmYXVsdENvbG9yID0gdGhpcy5jb25maWd1cmF0aW9uLmRlZmF1bHRDb2xvcjtcbiAgICAgICAgY29uc3QgaGFzQ29sb3IgPSB0aGlzLmhhc0NvbG9yLmJpbmQodGhpcyk7XG5cbiAgICAgICAgaWYgKHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGlubGluZSA9IHRoaXMuZGVwZW5kZW5jaWVzLmdldChJbmxpbmUpO1xuXG4gICAgICAgICAgICBpZiAocmFuZ2Uuc3RhcnQuYW5jZXN0b3IoaGFzQ29sb3IpKSB7XG4gICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBjb2xvciBzdHlsZSBjYWNoZSB0byB0aGUgZGVmYXVsdCBjb2xvci5cbiAgICAgICAgICAgICAgICBpZiAoIWlubGluZS5jYWNoZS5zdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICBpbmxpbmUuY2FjaGUuc3R5bGUgPSBuZXcgQ3NzU3R5bGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaW5saW5lLmNhY2hlLnN0eWxlLnNldCh0aGlzLnN0eWxlTmFtZSwgZGVmYXVsdENvbG9yKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaW5saW5lLmNhY2hlLnN0eWxlKSB7XG4gICAgICAgICAgICAgICAgLy8gVW5zZXQgdGhlIGNvbG9yIHN0eWxlIGNhY2hlLlxuICAgICAgICAgICAgICAgIGlubGluZS5jYWNoZS5zdHlsZS5yZW1vdmUodGhpcy5zdHlsZU5hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHBhcmFtcy5jb250ZXh0LnJhbmdlLnNlbGVjdGVkTm9kZXMoKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IHRoaXMuX25vZGVPckZpcnN0Rm9ybWF0KG5vZGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDb2xvciA9IHRhcmdldC5tb2RpZmllcnMuZmluZChBdHRyaWJ1dGVzKT8uc3R5bGUuZ2V0KHRoaXMuc3R5bGVOYW1lKTtcblxuICAgICAgICAgICAgICAgIGlmICghY3VycmVudENvbG9yIHx8IGN1cnJlbnRDb2xvciA9PT0gZGVmYXVsdENvbG9yIHx8IG5vZGUuYW5jZXN0b3IoaGFzQ29sb3IpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgY29sb3IgdG8gdGhlIGRlZmF1bHQgY29sb3IuXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnN0eWxlLnNldCh0aGlzLnN0eWxlTmFtZSwgZGVmYXVsdENvbG9yKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGNvbG9yLlxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk/LnN0eWxlLnJlbW92ZSh0aGlzLnN0eWxlTmFtZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gVW5jb2xvciB0aGUgY2hpbGRyZW4gYW5kIHRoZWlyIGZvcm1hdHMgYXMgd2VsbC5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG5vZGUuY2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZC5tb2RpZmllcnMuZmluZChBdHRyaWJ1dGVzKT8uc3R5bGUucmVtb3ZlKHRoaXMuc3R5bGVOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoaWxkLmlzKElubGluZU5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGZvcm1hdCBvZiBjaGlsZC5tb2RpZmllcnMuZmlsdGVyKEZvcm1hdCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk/LnN0eWxlLnJlbW92ZSh0aGlzLnN0eWxlTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbm9kZSdzIGZpcnN0IGZvcm1hdCBpZiBhbnksIGl0c2VsZiBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIF9ub2RlT3JGaXJzdEZvcm1hdChub2RlOiBWTm9kZSk6IFZOb2RlIHwgRm9ybWF0IHtcbiAgICAgICAgcmV0dXJuIG5vZGUubW9kaWZpZXJzLmZpbHRlcihGb3JtYXQpWzBdIHx8IG5vZGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIGFsbCB0aGUgY2hpbGRyZW4gb2YgdGhlIGdpdmVuIG5vZGUgaGF2ZSB0aGUgZ2l2ZW4gY29sb3IuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqIEBwYXJhbSBjb2xvclxuICAgICAqL1xuICAgIF9pc0FsbENvbG9yZWQobm9kZTogVk5vZGUsIGNvbG9yOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIG5vZGUuY2hpbGRyZW4oKS5ldmVyeShjaGlsZCA9PiB0aGlzLmhhc0NvbG9yKGNvbG9yLCBjaGlsZCkpO1xuICAgIH1cbn1cbiIsInZhciBhcGkgPSByZXF1aXJlKFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9EZXZUb29scy5jc3NcIik7XG5cbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50Ll9fZXNNb2R1bGUgPyBjb250ZW50LmRlZmF1bHQgOiBjb250ZW50O1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbiAgICAgICAgICAgIH1cblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5pbnNlcnQgPSBcImhlYWRcIjtcbm9wdGlvbnMuc2luZ2xldG9uID0gZmFsc2U7XG5cbnZhciB1cGRhdGUgPSBhcGkoY29udGVudCwgb3B0aW9ucyk7XG5cbnZhciBleHBvcnRlZCA9IGNvbnRlbnQubG9jYWxzID8gY29udGVudC5sb2NhbHMgOiB7fTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0ZWQ7IiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZXM+XFxuICAgIDwhLS0gSU5TUEVDVE9SIC0tPlxcbiAgICA8ZGV2dG9vbHMtcGFuZWwgY2xhc3M9XFxcImluc3BlY3RvclxcXCIgdC1uYW1lPVxcXCJJbnNwZWN0b3JDb21wb25lbnRcXFwiIHQtYXR0LWNsYXNzPVxcXCJ7YWN0aXZlOiBwcm9wcy5pc09wZW59XFxcIlxcbiAgICAgICAgdC1vbi1ub2RlLXNlbGVjdGVkPVxcXCJzZWxlY3ROb2RlXFxcIlxcbiAgICAgICAgdC1vbi1rZXlkb3duPVxcXCJvbktleWRvd25cXFwiPlxcbiAgICAgICAgPGRldnRvb2xzLWNvbnRlbnRzIHQtaWY9XFxcInByb3BzLmlzT3BlblxcXCI+XFxuICAgICAgICAgICAgPGRldnRvb2xzLW1haW5wYW5lPlxcbiAgICAgICAgICAgICAgICA8bWFpbnBhbmUtY29udGVudHM+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHJlZT5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8VHJlZUNvbXBvbmVudFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2Tm9kZT1cXFwiZG9tRW5naW5lLnJvb3RcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUm9vdD1cXFwidHJ1ZVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRQYXRoPVxcXCJnZXRQYXRoKHNlbGVjdGVkTm9kZSlcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkSUQ9XFxcInN0YXRlLnNlbGVjdGVkSURcXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHJlZT5cXG4gICAgICAgICAgICAgICAgPC9tYWlucGFuZS1jb250ZW50cz5cXG4gICAgICAgICAgICAgICAgPFBhdGhDb21wb25lbnRcXG4gICAgICAgICAgICAgICAgICAgIHBhdGg9XFxcImdldFBhdGgoc2VsZWN0ZWROb2RlKVxcXCJcXG4gICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkSUQ9XFxcInN0YXRlLnNlbGVjdGVkSURcXFwiLz5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLW1haW5wYW5lPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1zaWRlcGFuZT5cXG4gICAgICAgICAgICAgICAgPEluZm9Db21wb25lbnQgdk5vZGU9XFxcInNlbGVjdGVkTm9kZVxcXCIvPlxcbiAgICAgICAgICAgIDwvZGV2dG9vbHMtc2lkZXBhbmU+XFxuICAgICAgICA8L2RldnRvb2xzLWNvbnRlbnRzPlxcbiAgICA8L2RldnRvb2xzLXBhbmVsPlxcblxcbiAgICA8IS0tIElOU1BFQ1RPUi5UcmVlIC0tPlxcbiAgICA8ZGV2dG9vbHMtbm9kZSB0LW5hbWU9XFxcIlRyZWVDb21wb25lbnRcXFwiXFxuICAgICAgICB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgIGJsb2NrOiBwcm9wcy52Tm9kZS5sZW5ndGggYW5kICFwcm9wcy52Tm9kZS5jaGFyLFxcbiAgICAgICAgICAgIGZvbGRlZDogc3RhdGUuZm9sZGVkLFxcbiAgICAgICAgICAgIHJvb3Q6IHByb3BzLmlzUm9vdCxcXG4gICAgICAgICAgICAnc2VsZi1jbG9zaW5nJzogIXByb3BzLnZOb2RlLmhhc0NoaWxkcmVuKCksXFxuICAgICAgICB9XFxcIlxcbiAgICAgICAgdGFiaW5kZXg9XFxcIjFcXFwiXFxuICAgICAgICB0LW9uLWtleWRvd249XFxcIm9uS2V5ZG93blxcXCJcXG4gICAgICAgIHQtb24tbm9kZS1zZWxlY3RlZD1cXFwic2VsZWN0Tm9kZVxcXCI+XFxuICAgICAgICA8dCB0LWlmPVxcXCJwcm9wcy5pc1Jvb3RcXFwiPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy1ub2RlbmFtZSBjbGFzcz1cXFwic2VsZWN0YWJsZS1saW5lIGJsb2NrXFxcIlxcbiAgICAgICAgICAgICAgICB0LW9uLWNsaWNrPVxcXCJvbkNsaWNrTm9kZVxcXCIgdC1vbi1kYmxjbGljaz1cXFwib25EYmxDbGlja05vZGVcXFwiXFxuICAgICAgICAgICAgICAgIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogcHJvcHMuc2VsZWN0ZWRJRCA9PSBwcm9wcy52Tm9kZS5pZCxcXG4gICAgICAgICAgICAgICAgfVxcXCI+cm9vdDwvZGV2dG9vbHMtbm9kZW5hbWU+XFxuICAgICAgICAgICAgPHQgdC1jYWxsPVxcXCJ0cmVlQ2hpbGRyZW5cXFwiLz5cXG4gICAgICAgIDwvdD5cXG4gICAgICAgIDx0IHQtZWxzZT1cXFwiXFxcIj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtbm9kZW5hbWUgdC1pZj1cXFwiIXByb3BzLnZOb2RlLnRhbmdpYmxlXFxcIlxcbiAgICAgICAgICAgICAgICB0LW9uLWNsaWNrPVxcXCJvbkNsaWNrTm9kZVxcXCIgdC1vbi1kYmxjbGljaz1cXFwib25EYmxDbGlja05vZGVcXFwiXFxuICAgICAgICAgICAgICAgIGNsYXNzPVxcXCJzZWxlY3RhYmxlLWxpbmUgaW5saW5lIG1hcmtlci1ub2RlXFxcIiB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IHByb3BzLnNlbGVjdGVkSUQgPT0gcHJvcHMudk5vZGUuaWQsXFxuICAgICAgICAgICAgICAgIH1cXFwiPlxcbiAgICAgICAgICAgICAgICA8Yj48dCB0LWVzYz1cXFwicmVwcigpXFxcIi8+PC9iPlxcbiAgICAgICAgICAgIDwvZGV2dG9vbHMtbm9kZW5hbWU+XFxuICAgICAgICAgICAgPGRldnRvb2xzLW5vZGVuYW1lIHQtZWxpZj1cXFwicHJvcHMudk5vZGUuY2hhclxcXCIgdC1vbi1jbGljaz1cXFwib25DbGlja05vZGVcXFwiXFxuICAgICAgICAgICAgICAgIHQtb24tZGJsY2xpY2s9XFxcIm9uRGJsQ2xpY2tOb2RlXFxcIlxcbiAgICAgICAgICAgICAgICBjbGFzcz1cXFwic2VsZWN0YWJsZS1saW5lIGlubGluZVxcXCIgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICAgICAgICAgIGJvbGQ6IGlzRm9ybWF0KHByb3BzLnZOb2RlLCAnYicpLFxcbiAgICAgICAgICAgICAgICAgICAgaXRhbGljOiBpc0Zvcm1hdChwcm9wcy52Tm9kZSwgJ2knKSxcXG4gICAgICAgICAgICAgICAgICAgIHVuZGVybGluZTogaXNGb3JtYXQocHJvcHMudk5vZGUsICd1JyksXFxuICAgICAgICAgICAgICAgICAgICBsaW5rOiBpc0Zvcm1hdChwcm9wcy52Tm9kZSwgJ2xpbmsnKSxcXG4gICAgICAgICAgICAgICAgICAgIHN1YnNjcmlwdDogaXNGb3JtYXQocHJvcHMudk5vZGUsICdzdWJzY3JpcHQnKSxcXG4gICAgICAgICAgICAgICAgICAgIHN1cGVyc2NyaXB0OiBpc0Zvcm1hdChwcm9wcy52Tm9kZSwgJ3N1cGVyc2NyaXB0JyksXFxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogcHJvcHMuc2VsZWN0ZWRJRCA9PSBwcm9wcy52Tm9kZS5pZCxcXG4gICAgICAgICAgICAgICAgfVxcXCI+XFxuICAgICAgICAgICAgICAgIDx0IHQtZXNjPVxcXCJyZXByKClcXFwiLz5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLW5vZGVuYW1lPlxcbiAgICAgICAgICAgIDx0IHQtZWxzZT1cXFwiXFxcIj5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLW5vZGVuYW1lIGNsYXNzPVxcXCJzZWxlY3RhYmxlLWxpbmUgYmxvY2tcXFwiIHQtb24tY2xpY2s9XFxcIm9uQ2xpY2tOb2RlXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgdC1vbi1kYmxjbGljaz1cXFwib25EYmxDbGlja05vZGVcXFwiXFxuICAgICAgICAgICAgICAgICAgICB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvbGQ6IGlzRm9ybWF0KHByb3BzLnZOb2RlLCAnYicpLFxcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0YWxpYzogaXNGb3JtYXQocHJvcHMudk5vZGUsICdpJyksXFxuICAgICAgICAgICAgICAgICAgICAgICAgdW5kZXJsaW5lOiBpc0Zvcm1hdChwcm9wcy52Tm9kZSwgJ3UnKSxcXG4gICAgICAgICAgICAgICAgICAgICAgICBsaW5rOiBpc0Zvcm1hdChwcm9wcy52Tm9kZSwgJ2xpbmsnKSxcXG4gICAgICAgICAgICAgICAgICAgICAgICBzdWJzY3JpcHQ6IGlzRm9ybWF0KHByb3BzLnZOb2RlLCAnc3Vic2NyaXB0JyksXFxuICAgICAgICAgICAgICAgICAgICAgICAgc3VwZXJzY3JpcHQ6IGlzRm9ybWF0KHByb3BzLnZOb2RlLCAnc3VwZXJzY3JpcHQnKSxcXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogcHJvcHMuc2VsZWN0ZWRJRCA9PSBwcm9wcy52Tm9kZS5pZCxcXG4gICAgICAgICAgICAgICAgICAgICAgICAnbGluZS1icmVhayc6IHByb3BzLnZOb2RlLmh0bWxUYWcgPT09ICdCUicsXFxuICAgICAgICAgICAgICAgICAgICB9XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDx0IHQtZXNjPVxcXCJyZXByKClcXFwiLz5cXG4gICAgICAgICAgICAgICAgPC9kZXZ0b29scy1ub2RlbmFtZT5cXG4gICAgICAgICAgICAgICAgPHQgdC1jYWxsPVxcXCJ0cmVlQ2hpbGRyZW5cXFwiLz5cXG4gICAgICAgICAgICA8L3Q+XFxuICAgICAgICA8L3Q+XFxuICAgIDwvZGV2dG9vbHMtbm9kZT5cXG5cXG4gICAgPHQgdC1uYW1lPVxcXCJ0cmVlQ2hpbGRyZW5cXFwiPlxcbiAgICAgICAgPGRldnRvb2xzLWNoaWxkcmVuPlxcbiAgICAgICAgICAgIDxUcmVlQ29tcG9uZW50IHQtaWY9XFxcIiFzdGF0ZS5mb2xkZWRcXFwiXFxuICAgICAgICAgICAgICAgIHQtZm9yZWFjaD1cXFwicHJvcHMudk5vZGUuY2hpbGRWTm9kZXMuc2xpY2UoKVxcXCIgdC1hcz1cXFwiY2hpbGRcXFwiXFxuICAgICAgICAgICAgICAgIHQta2V5PVxcXCJjaGlsZC5pZFxcXCJcXG4gICAgICAgICAgICAgICAgdk5vZGU9XFxcImNoaWxkXFxcIlxcbiAgICAgICAgICAgICAgICBzZWxlY3RlZFBhdGg9XFxcInByb3BzLnNlbGVjdGVkUGF0aFxcXCJcXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRJRD1cXFwicHJvcHMuc2VsZWN0ZWRJRFxcXCIvPlxcbiAgICAgICAgPC9kZXZ0b29scy1jaGlsZHJlbj5cXG4gICAgPC90PlxcblxcbiAgICA8IS0tIElOU1BFQ1RPUi5QYXRoIC0tPlxcbiAgICA8ZGV2dG9vbHMtcGF0aCB0LW5hbWU9XFxcIlBhdGhDb21wb25lbnRcXFwiPlxcbiAgICAgICAgPGRldnRvb2xzLXBhdGhub2RlIHQtZm9yZWFjaD1cXFwicHJvcHMucGF0aFxcXCIgdC1hcz1cXFwidk5vZGVcXFwiXFxuICAgICAgICAgICAgdC1rZXk9XFxcInZOb2RlLmlkXFxcIlxcbiAgICAgICAgICAgIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkOiB2Tm9kZS5pZCA9PSBwcm9wcy5zZWxlY3RlZElEXFxuICAgICAgICAgICAgfVxcXCJcXG4gICAgICAgICAgICB0LW9uLWNsaWNrPVxcXCJzZWxlY3ROb2RlKHZOb2RlKVxcXCI+XFxuICAgICAgICAgICAgPHQgdC1lc2M9XFxcImdldE5vZGVSZXByKHZOb2RlKVxcXCIvPlxcbiAgICAgICAgPC9kZXZ0b29scy1wYXRobm9kZT5cXG4gICAgPC9kZXZ0b29scy1wYXRoPlxcblxcbiAgICA8IS0tIElOU1BFQ1RPUi5JbmZvIC0tPlxcbiAgICA8ZGV2dG9vbHMtaW5mbyB0LW5hbWU9XFxcIkluZm9Db21wb25lbnRcXFwiPlxcbiAgICAgICAgPGRldnRvb2xzLW5hdmJhcj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtYnV0dG9uIHQtb24tY2xpY2s9XFxcIm9wZW5UYWIoJ3ZOb2RlJylcXFwiIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBzdGF0ZS5jdXJyZW50VGFiID09ICd2Tm9kZScsXFxuICAgICAgICAgICAgfVxcXCI+Vk5vZGU8L2RldnRvb2xzLWJ1dHRvbj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtYnV0dG9uIHQtb24tY2xpY2s9XFxcIm9wZW5UYWIoJ3NlbGVjdGlvbicpXFxcIiB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICBzZWxlY3RlZDogc3RhdGUuY3VycmVudFRhYiA9PSAnc2VsZWN0aW9uJyxcXG4gICAgICAgICAgICB9XFxcIj5TZWxlY3Rpb248L2RldnRvb2xzLWJ1dHRvbj5cXG4gICAgICAgIDwvZGV2dG9vbHMtbmF2YmFyPlxcbiAgICAgICAgPHQgdC1jYWxsPVxcXCJpbmZvVk5vZGVcXFwiIHQtaWY9XFxcInN0YXRlLmN1cnJlbnRUYWIgPT0gJ3ZOb2RlJ1xcXCIvPlxcbiAgICAgICAgPHQgdC1jYWxsPVxcXCJpbmZvU2VsZWN0aW9uXFxcIiB0LWlmPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICdzZWxlY3Rpb24nXFxcIi8+XFxuICAgIDwvZGV2dG9vbHMtaW5mbz5cXG5cXG4gICAgPCEtLSBJTlNQRUNUT1IuSW5mby52Tm9kZSAtLT5cXG4gICAgPHQgdC1uYW1lPVxcXCJpbmZvVk5vZGVcXFwiPlxcbiAgICAgICAgPGRldnRvb2xzLWFib3V0PlxcbiAgICAgICAgICAgIDxkZXZ0b29scy10eXBlPjx0IHQtZXNjPVxcXCJjbGFzc05hbWUocHJvcHMudk5vZGUpXFxcIi8+PC9kZXZ0b29scy10eXBlPiA8dCB0LWVzYz1cXFwicHJvcHMudk5vZGUubmFtZVxcXCIvPlxcbiAgICAgICAgICAgIDx0IHQtaWY9XFxcInByb3BzLnZOb2RlLmNoYXJcXFwiPjpcXG4gICAgICAgICAgICAgICAgXFxcIjx0IHQtZXNjPVxcXCJwcm9wcy52Tm9kZS5jaGFyXFxcIi8+XFxcIlxcbiAgICAgICAgICAgIDwvdD5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtYnV0dG9uIGNsYXNzPVxcXCJsb2dnZXJcXFwiIHQtb24tY2xpY2s9XFxcImxvZ1ZOb2RlKHByb3BzLnZOb2RlKVxcXCI+Jmd0O188L2RldnRvb2xzLWJ1dHRvbj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtaWQ+PHQgdC1lc2M9XFxcInByb3BzLnZOb2RlLmlkXFxcIi8+PC9kZXZ0b29scy1pZD5cXG4gICAgICAgIDwvZGV2dG9vbHMtYWJvdXQ+XFxuICAgICAgICA8ZGV2dG9vbHMtcHJvcGVydGllcz5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtaW5mb3RpdGxlPvCfkaQgQWJvdXQgbWU8L2RldnRvb2xzLWluZm90aXRsZT5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtdGFibGU+XFxuICAgICAgICAgICAgICAgIDxkZXZ0b29scy10Ym9keT5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ciB0LWZvcmVhY2g9XFxcImFib3V0TWVQcm9wc1xcXCIgdC1hcz1cXFwicHJvcE5hbWVcXFwiIHQta2V5PVxcXCJwcm9wTmFtZV9pbmRleFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJwcm9wTmFtZVxcXCIvPjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJwcm9wUmVwcihwcm9wcy52Tm9kZSwgcHJvcE5hbWUpXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPnRvdGFsIGxlbmd0aDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJ0b3RhbExlbmd0aChwcm9wcy52Tm9kZSlcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+dGV4dCBjb250ZW50PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHQgdC1lc2M9XFxcInByb3BzLnZOb2RlLnRleHRDb250ZW50XFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGJvZHk+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtaW5mb3RpdGxlPvCfk5YgTXkgUHJvcGVydGllczwvZGV2dG9vbHMtaW5mb3RpdGxlPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyIHQtZm9yZWFjaD1cXFwibm9kZVByb3BlcnRpZXMocHJvcHMudk5vZGUpXFxcIiB0LWFzPVxcXCJwcm9wXFxcIiB0LWtleT1cXFwicHJvcF9pbmRleFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJwcm9wLmtleVxcXCIvPjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJwcm9wLnZhbHVlXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGJvZHk+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtaW5mb3RpdGxlPvCfkaogTXkgRmFtaWx5PC9kZXZ0b29scy1pbmZvdGl0bGU+XFxuICAgICAgICAgICAgPGRldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGJvZHk+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHIgdC1mb3JlYWNoPVxcXCJmYW1pbHlQcm9wc1xcXCIgdC1hcz1cXFwicHJvcE5hbWVcXFwiXFxuICAgICAgICAgICAgICAgICAgICB0LWtleT1cXFwicHJvcE5hbWVfaW5kZXhcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwicHJvcE5hbWVcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZCB0LWlmPVxcXCJwcm9wTmFtZSA9PT0gJ3BhcmVudCdcXFwiIHQtb24tY2xpY2s9XFxcInNlbGVjdE5vZGUocHJvcHMudk5vZGUucGFyZW50KVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtZXNjPVxcXCJwcm9wUmVwcihwcm9wcy52Tm9kZSwgcHJvcE5hbWUpXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQgdC1lbGlmPVxcXCJwcm9wTmFtZSA9PT0gJ3NpYmxpbmdzJ1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1saXN0PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLWxpc3RpdGVtIHQtaWY9XFxcInByb3BzLnZOb2RlLnByZXZpb3VzU2libGluZygpXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtb24tY2xpY2s9XFxcInNlbGVjdE5vZGUocHJvcHMudk5vZGUucHJldmlvdXNTaWJsaW5nKCkpXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2aW91czogPHQgdC1lc2M9XFxcInByb3BzLnZOb2RlLnByZXZpb3VzU2libGluZygpLm5hbWVcXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtbGlzdGl0ZW0+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtbGlzdGl0ZW0gdC1lbHNlPVxcXCJcXFwiPnByZXZpb3VzOiBub25lPC9kZXZ0b29scy1saXN0aXRlbT5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1saXN0aXRlbSB0LWlmPVxcXCJwcm9wcy52Tm9kZS5uZXh0U2libGluZygpXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtb24tY2xpY2s9XFxcInNlbGVjdE5vZGUocHJvcHMudk5vZGUubmV4dFNpYmxpbmcoKSlcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQ6IDx0IHQtZXNjPVxcXCJwcm9wcy52Tm9kZS5uZXh0U2libGluZygpLm5hbWVcXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtbGlzdGl0ZW0+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtbGlzdGl0ZW0gdC1lbHNlPVxcXCJcXFwiPm5leHQ6IG5vbmU8L2RldnRvb2xzLWxpc3RpdGVtPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLWxpc3Q+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQgdC1lbGlmPVxcXCJwcm9wTmFtZSA9PT0gJ2NoaWxkcmVuJ1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1saXN0IHQtaWY9XFxcInByb3BzLnZOb2RlLmNoaWxkVk5vZGVzLmxlbmd0aFxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtbGlzdGl0ZW0gdC1mb3JlYWNoPVxcXCJwcm9wcy52Tm9kZS5jaGlsZHJlbigpXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtYXM9XFxcImNoaWxkXFxcIiB0LWtleT1cXFwiY2hpbGQuaWRcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1vbi1jbGljaz1cXFwic2VsZWN0Tm9kZShjaGlsZClcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtZXNjPVxcXCJjaGlsZC5uYW1lXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLWxpc3RpdGVtPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLWxpc3Q+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtZWxzZT1cXFwiXFxcIj5ub25lPC90PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkIHQtZWxzZT1cXFwiXFxcIj48dCB0LWVzYz1cXFwicHJvcFJlcHIocHJvcHMudk5vZGUsIHByb3BOYW1lKVxcXCIvPjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgIDwvZGV2dG9vbHMtdGFibGU+XFxuICAgICAgICA8L2RldnRvb2xzLXByb3BlcnRpZXM+XFxuICAgIDwvdD5cXG5cXG4gICAgPCEtLSBJTlNQRUNUT1IuSW5mby5zZWxlY3Rpb24gLS0+XFxuICAgIDx0IHQtbmFtZT1cXFwiaW5mb1NlbGVjdGlvblxcXCI+XFxuICAgICAgICA8ZGV2dG9vbHMtYWJvdXQ+XFxuICAgICAgICAgICAgPGRldnRvb2xzLXR5cGU+VlNlbGVjdGlvbjwvZGV2dG9vbHMtdHlwZT4gU2VsZWN0aW9uXFxuICAgICAgICA8L2RldnRvb2xzLWFib3V0PlxcbiAgICAgICAgPGRldnRvb2xzLXByb3BlcnRpZXM+XFxuICAgICAgICAgICAgPGRldnRvb2xzLWluZm90aXRsZT7wn5GkIEFib3V0IG1lPC9kZXZ0b29scy1pbmZvdGl0bGU+XFxuICAgICAgICAgICAgPGRldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGJvZHk+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPmRpcmVjdGlvbjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJlbnYuZWRpdG9yLnNlbGVjdGlvbi5kaXJlY3Rpb25cXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHN0cm9uZyBjbGFzcz1cXFwibWFya2VyLW5vZGVcXFwiPls8L3N0cm9uZz4gYW5jaG9yPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHQgdC1lc2M9XFxcIl9yZXByKGVudi5lZGl0b3Iuc2VsZWN0aW9uLmFuY2hvcilcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHN0cm9uZyBjbGFzcz1cXFwibWFya2VyLW5vZGVcXFwiPl08L3N0cm9uZz4gZm9jdXM8L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD48dCB0LWVzYz1cXFwiX3JlcHIoZW52LmVkaXRvci5zZWxlY3Rpb24uZm9jdXMpXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGJvZHk+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgIDwvZGV2dG9vbHMtcHJvcGVydGllcz5cXG4gICAgPC90PlxcblxcbiAgICA8ZGV2dG9vbHMtcGFuZWwgdC1uYW1lPVxcXCJDb21tYW5kc0NvbXBvbmVudFxcXCJcXG4gICAgICAgIHQtYXR0LWNsYXNzPVxcXCJ7YWN0aXZlOiBwcm9wcy5pc09wZW59XFxcIiB0YWJpbmRleD1cXFwiMVxcXCJcXG4gICAgICAgIHQtb24ta2V5ZG93bj1cXFwib25LZXlkb3duXFxcIj5cXG4gICAgICAgIDxkZXZ0b29scy1jb250ZW50cyB0LWlmPVxcXCJwcm9wcy5pc09wZW5cXFwiPlxcbiAgICAgICAgICAgIDx0IHQtc2V0PVxcXCJzZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbnNcXFwiIHQtdmFsdWU9XFxcInN0YXRlLnJlZ2lzdHJ5W3N0YXRlLnNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXJdXFxcIi8+XFxuICAgICAgICAgICAgPGRldnRvb2xzLW1haW5wYW5lIHN0eWxlPVxcXCJvdmVyZmxvdzogaGlkZGVuXFxcIj5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLW5hdmJhcj5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1idXR0b24gdC1vbi1jbGljaz1cXFwib3BlblRhYigncXVldWUnKVxcXCIgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogc3RhdGUuY3VycmVudFRhYiA9PSAncXVldWUnLFxcbiAgICAgICAgICAgICAgICAgICAgfVxcXCI+UXVldWU8L2RldnRvb2xzLWJ1dHRvbj5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1idXR0b24gdC1vbi1jbGljaz1cXFwib3BlblRhYigncmVnaXN0cnknKVxcXCIgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogc3RhdGUuY3VycmVudFRhYiA9PSAncmVnaXN0cnknLFxcbiAgICAgICAgICAgICAgICAgICAgfVxcXCI+UmVnaXN0cnk8L2RldnRvb2xzLWJ1dHRvbj5cXG4gICAgICAgICAgICAgICAgPC9kZXZ0b29scy1uYXZiYXI+XFxuICAgICAgICAgICAgICAgIDxtYWlucGFuZS1jb250ZW50cyB0LWlmPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICdxdWV1ZSdcXFwiIHN0eWxlPVxcXCJvdmVyZmxvdzogYXV0b1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGFibGUgc3R5bGU9XFxcIndpZHRoOiAxMDAlO1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHIgdC1mb3JlYWNoPVxcXCJBcnJheS5mcm9tKHByb3BzLmNvbW1hbmRzLmtleXMoKSkucmV2ZXJzZSgpXFxcIiB0LWFzPVxcXCJjb21tYW5kSW5kZXhcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LWtleT1cXFwiY29tbWFuZEluZGV4X2luZGV4XFxcIiBjbGFzcz1cXFwic2VsZWN0YWJsZS1saW5lXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1hdHQtY2xhc3M9XFxcIntcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZDogc3RhdGUuc2VsZWN0ZWRDb21tYW5kSW5kZXggPT0gY29tbWFuZEluZGV4LFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtb24tY2xpY2s9XFxcInNlbGVjdENvbW1hbmRCeUluZGV4KGNvbW1hbmRJbmRleClcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJwcm9wcy5jb21tYW5kc1tjb21tYW5kSW5kZXhdWzBdXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgPC9tYWlucGFuZS1jb250ZW50cz5cXG4gICAgICAgICAgICAgICAgPG1haW5wYW5lLWNvbnRlbnRzIHQtZWxpZj1cXFwic3RhdGUuY3VycmVudFRhYiA9PSAncmVnaXN0cnknXFxcIiBzdHlsZT1cXFwib3ZlcmZsb3c6IGF1dG9cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLWNvbW1hbmQgdC1mb3JlYWNoPVxcXCJPYmplY3Qua2V5cyhzdGF0ZS5yZWdpc3RyeSkuc29ydCgpXFxcIiB0LWFzPVxcXCJjb21tYW5kSWRlbnRpZmllclxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICB0LWtleT1cXFwicmVjb3JkX2luZGV4XFxcIiBjbGFzcz1cXFwic2VsZWN0YWJsZS1saW5lXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBzdGF0ZS5zZWxlY3RlZENvbW1hbmRJZGVudGlmaWVyID09IGNvbW1hbmRJZGVudGlmaWVyLFxcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgdC1vbi1jbGljaz1cXFwic2VsZWN0Q29tbWFuZChjb21tYW5kSWRlbnRpZmllcilcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtZXNjPVxcXCJjb21tYW5kSWRlbnRpZmllclxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy1jb21tYW5kPlxcbiAgICAgICAgICAgICAgICA8L21haW5wYW5lLWNvbnRlbnRzPlxcbiAgICAgICAgICAgIDwvZGV2dG9vbHMtbWFpbnBhbmU+XFxuICAgICAgICAgICAgPGRldnRvb2xzLXNpZGVwYW5lPlxcbiAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtaW5mbyB0LWlmPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICdxdWV1ZSdcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPHQgdC1zZXQ9XFxcInNlbGVjdGVkQ29tbWFuZFxcXCIgdC12YWx1ZT1cXFwicHJvcHMuY29tbWFuZHNbc3RhdGUuc2VsZWN0ZWRDb21tYW5kSW5kZXhdXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtYWJvdXQgdC1pZj1cXFwic2VsZWN0ZWRDb21tYW5kXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHlwZT5Db21tYW5kPC9kZXZ0b29scy10eXBlPiA8dCB0LWVzYz1cXFwic2VsZWN0ZWRDb21tYW5kWzBdXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLWFib3V0PlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXByb3BlcnRpZXMgdC1pZj1cXFwic2VsZWN0ZWRDb21tYW5kXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtaW5mb3RpdGxlPkFyZ3VtZW50czwvZGV2dG9vbHMtaW5mb3RpdGxlPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1wcm9wZXJ0aWVzPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWlmPVxcXCJzZWxlY3RlZENvbW1hbmRcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1zZXQ9XFxcInBheWxvYWRcXFwiIHQtdmFsdWU9XFxcInNlbGVjdGVkQ29tbWFuZFsxXVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1jYWxsPVxcXCJjb21tYW5kQXJnc1xcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtY2FsbD1cXFwic2VsZWN0ZWRDb21tYW5kVGFibGVcXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXByb3BlcnRpZXM+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXByb3BlcnRpZXM+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtaW5mbz5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLWluZm8gdC1lbGlmPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICdyZWdpc3RyeSdcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPHQgdC1pZj1cXFwic3RhdGUucmVnaXN0cnlcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1hYm91dCB0LWlmPVxcXCJzdGF0ZS5zZWxlY3RlZENvbW1hbmRJZGVudGlmaWVyXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXR5cGU+Q29tbWFuZDwvZGV2dG9vbHMtdHlwZT4gPHQgdC1lc2M9XFxcInN0YXRlLnNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXJcXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLWFib3V0PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy1wcm9wZXJ0aWVzIHQtaWY9XFxcInN0YXRlLnNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXJcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWNhbGw9XFxcInNlbGVjdGVkQ29tbWFuZFRhYmxlXFxcIi8+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy1wcm9wZXJ0aWVzPlxcbiAgICAgICAgICAgICAgICAgICAgPC90PlxcbiAgICAgICAgICAgICAgICA8L2RldnRvb2xzLWluZm8+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy1zaWRlcGFuZT5cXG4gICAgICAgIDwvZGV2dG9vbHMtY29udGVudHM+XFxuICAgIDwvZGV2dG9vbHMtcGFuZWw+XFxuXFxuICAgIDx0IHQtbmFtZT1cXFwiY29tbWFuZEFyZ3NcXFwiPlxcbiAgICAgICAgPGRldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy10Ym9keT5cXG4gICAgICAgICAgICAgICAgPHQgdC1mb3JlYWNoPVxcXCJPYmplY3Qua2V5cyhwYXlsb2FkKVxcXCIgdC1hcz1cXFwia2V5XFxcIiB0LWtleT1cXFwia2V5X2luZGV4XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ciB0LWlmPVxcXCJrZXkgIT09ICdjb250ZXh0J1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1zZXQ9XFxcInZhbHVlXFxcIiB0LXZhbHVlPVxcXCJwYXlsb2FkW2tleV1cXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtZXNjPVxcXCJrZXlcXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1pZj1cXFwidmFsdWUgYW5kIGtleSA9PSAndlNlbGVjdGlvbidcXFwiIHQtY2FsbD1cXFwicGF5bG9hZFZTZWxlY3Rpb25cXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1lbHNlPVxcXCJcXFwiPjx0IHQtZXNjPVxcXCJmb3JtYXRQYXlsb2FkVmFsdWUodmFsdWUpXFxcIi8+PC90PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy10Ym9keT5cXG4gICAgICAgIDwvZGV2dG9vbHMtdGFibGU+XFxuICAgIDwvdD5cXG5cXG4gICAgPHQgdC1uYW1lPVxcXCJwYXlsb2FkVlNlbGVjdGlvblxcXCI+XFxuICAgICAgICA8ZGV2dG9vbHMtdGFibGU+XFxuICAgICAgICAgICAgPGRldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uXFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtZXNjPVxcXCJ2YWx1ZS5kaXJlY3Rpb24gb3IgJ3Vuc2V0J1xcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvclxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDxkZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWVzYz1cXFwidmFsdWUuYW5jaG9yUG9zaXRpb25cXFwiLz4gPHQgdC1lc2M9XFxcInZhbHVlLmFuY2hvck5vZGUuaWRcXFwiLz4gKDx0IHQtZXNjPVxcXCJ2YWx1ZS5hbmNob3JOb2RlLm5hbWVcXFwiLz4pXFxuICAgICAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICA8L2RldnRvb2xzLXRyPlxcbiAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNcXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1lc2M9XFxcInZhbHVlLmZvY3VzUG9zaXRpb25cXFwiLz4gPHQgdC1lc2M9XFxcInZhbHVlLmZvY3VzTm9kZS5pZFxcXCIvPiAoPHQgdC1lc2M9XFxcInZhbHVlLmZvY3VzTm9kZS5uYW1lXFxcIi8+KVxcbiAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLXRib2R5PlxcbiAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgPC90PlxcblxcbiAgICA8dCB0LW5hbWU9XFxcInNlbGVjdGVkQ29tbWFuZFRhYmxlXFxcIj5cXG4gICAgICAgIDxkZXZ0b29scy1pbmZvdGl0bGU+Q29tbWFuZCBkZWZpbml0aW9uczwvZGV2dG9vbHMtaW5mb3RpdGxlPlxcbiAgICAgICAgPGRldnRvb2xzLXRhYmxlPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy10Ym9keT5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyIHQtZm9yZWFjaD1cXFwic2VsZWN0ZWRDb21tYW5kSW1wbGVtZW50YXRpb25zXFxcIlxcbiAgICAgICAgICAgICAgICAgICAgdC1hcz1cXFwic2VsZWN0ZWRDb21tYW5kSW1wbGVtZW50YXRpb25cXFwiIHQta2V5PVxcXCJzZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbl9pbmRleFxcXCJcXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVxcXCJzZWxlY3RhYmxlLWxpbmVcXFwiXFxuICAgICAgICAgICAgICAgICAgICB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBzdGF0ZS5zZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbkluZGV4ID09IGhhbmRsZXJJbmRleCxcXG4gICAgICAgICAgICAgICAgICAgIH1cXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJzZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbi5oYW5kbGVyLm5hbWVcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJzZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbi5oYW5kbGVyXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICA8L2RldnRvb2xzLXRib2R5PlxcbiAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgIDx0IHQtc2V0PVxcXCJtYXBwaW5nc1xcXCIgdC12YWx1ZT1cXFwibWF0Y2hpbmdNYXBwaW5ncyhzdGF0ZS5zZWxlY3RlZENvbW1hbmRJZGVudGlmaWVyKVxcXCIvPlxcbiAgICAgICAgPHQgdC1pZj1cXFwibWFwcGluZ3MubGVuZ3RoXFxcIj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtaW5mb3RpdGxlPlNob3J0Y3V0czwvZGV2dG9vbHMtaW5mb3RpdGxlPlxcbiAgICAgICAgICAgIDxkZXZ0b29scy10YWJsZT5cXG4gICAgICAgICAgICAgICAgPGRldnRvb2xzLXRib2R5PlxcbiAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyIHQtZm9yZWFjaD1cXFwibWFwcGluZ3NcXFwiIHQtYXM9XFxcIm1hcHBpbmdcXFwiIHQta2V5PVxcXCJtYXBwaW5nX2luZGV4XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQgc3R5bGU9XFxcIndpZHRoOiA1MCU7XFxcIj48dCB0LWVzYz1cXFwic3RyaW5naWZ5UGF0dGVybihtYXBwaW5nLnBhdHRlcm4pXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHQgdC1lc2M9XFxcImFyZ3NSZXByKG1hcHBpbmcuY29uZmlndXJlZENvbW1hbmQuY29tbWFuZEFyZ3MpXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdHI+XFxuICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGJvZHk+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy10YWJsZT5cXG4gICAgICAgIDwvdD5cXG4gICAgPC90PlxcblxcbiAgICA8IS0tIFNIT1JUQ1VUUyAtLT5cXG4gICAgPGRldnRvb2xzLXBhbmVsIHQtbmFtZT1cXFwiU2hvcnRjdXRzQ29tcG9uZW50XFxcIlxcbiAgICAgICAgdC1hdHQtY2xhc3M9XFxcInthY3RpdmU6IHByb3BzLmlzT3Blbn1cXFwiIHRhYmluZGV4PVxcXCIxXFxcIlxcbiAgICAgICAgdC1vbi1rZXlkb3duPVxcXCJvbktleWRvd25cXFwiPlxcbiAgICAgICAgPGRldnRvb2xzLWNvbnRlbnRzIHQtaWY9XFxcInByb3BzLmlzT3BlblxcXCI+XFxuICAgICAgICAgICAgPGRldnRvb2xzLW1haW5wYW5lIHN0eWxlPVxcXCJvdmVyZmxvdzogaGlkZGVuXFxcIj5cXG4gICAgICAgICAgICAgICAgPG1haW5wYW5lLWNvbnRlbnRzIHN0eWxlPVxcXCJvdmVyZmxvdzogYXV0b1xcXCI+XFxuICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGFibGU+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRyIHQtZm9yZWFjaD1cXFwibWFwcGluZ3NcXFwiIHQtYXM9XFxcIm1hcHBpbmdcXFwiIHQta2V5PVxcXCJtYXBwaW5nX2luZGV4XFxcIiBjbGFzcz1cXFwic2VsZWN0YWJsZS1saW5lXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJzdHJpbmdpZnlQYXR0ZXJuKG1hcHBpbmcucGF0dGVybilcXFwiLz48L2RldnRvb2xzLXRkPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGV2dG9vbHMtdGQ+PHQgdC1lc2M9XFxcIm1hcHBpbmcuY29uZmlndXJlZENvbW1hbmQuY29tbWFuZElkXFxcIi8+PC9kZXZ0b29scy10ZD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRldnRvb2xzLXRkPjx0IHQtZXNjPVxcXCJhcmdzUmVwcihtYXBwaW5nLmNvbmZpZ3VyZWRDb21tYW5kLmNvbW1hbmRBcmdzKVxcXCIvPjwvZGV2dG9vbHMtdGQ+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPC9kZXZ0b29scy10cj5cXG4gICAgICAgICAgICAgICAgICAgIDwvZGV2dG9vbHMtdGFibGU+XFxuICAgICAgICAgICAgICAgIDwvbWFpbnBhbmUtY29udGVudHM+XFxuICAgICAgICAgICAgPC9kZXZ0b29scy1tYWlucGFuZT5cXG4gICAgICAgIDwvZGV2dG9vbHMtY29udGVudHM+XFxuICAgIDwvZGV2dG9vbHMtcGFuZWw+XFxuXFxuICAgIDwhLS0gTUFJTiAtLT5cXG4gICAgPGp3LWRldnRvb2xzIHQtbmFtZT1cXFwiZGV2dG9vbHNcXFwiXFxuICAgICAgICB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgIGNsb3NlZDogc3RhdGUuY2xvc2VkLFxcbiAgICAgICAgfVxcXCJcXG4gICAgICAgIHQtYXR0Zi1zdHlsZT1cXFwiaGVpZ2h0OiB7e3N0YXRlLmhlaWdodH19cHhcXFwiXFxuICAgICAgICB0YWJpbmRleD1cXFwiMlxcXCI+XFxuICAgICAgICA8ZGV2dG9vbHMtbmF2YmFyXFxuICAgICAgICAgICAgdC1vbi1jbGljaz1cXFwidG9nZ2xlQ2xvc2VkXFxcIlxcbiAgICAgICAgICAgIHQtb24tbW91c2Vkb3duPVxcXCJzdGFydFJlc2l6ZVxcXCJcXG4gICAgICAgICAgICB0LW9uLXRvdWNoc3RhcnQ9XFxcInN0YXJ0UmVzaXplXFxcIj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtYnV0dG9uIHQtb24tY2xpY2s9XFxcIm9wZW5UYWIoJ2luc3BlY3RvcicpXFxcIiB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICBzZWxlY3RlZDogc3RhdGUuY3VycmVudFRhYiA9PSAnaW5zcGVjdG9yJyxcXG4gICAgICAgICAgICB9XFxcIj5JbnNwZWN0b3I8L2RldnRvb2xzLWJ1dHRvbj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtYnV0dG9uIHQtb24tY2xpY2s9XFxcIm9wZW5UYWIoJ2NvbW1hbmRzJylcXFwiIHQtYXR0LWNsYXNzPVxcXCJ7XFxuICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBzdGF0ZS5jdXJyZW50VGFiID09ICdjb21tYW5kcycsXFxuICAgICAgICAgICAgfVxcXCI+Q29tbWFuZHM8L2RldnRvb2xzLWJ1dHRvbj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtYnV0dG9uIHQtb24tY2xpY2s9XFxcIm9wZW5UYWIoJ3Nob3J0Y3V0cycpXFxcIiB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICBzZWxlY3RlZDogc3RhdGUuY3VycmVudFRhYiA9PSAnc2hvcnRjdXRzJyxcXG4gICAgICAgICAgICB9XFxcIj5TaG9ydGN1dHM8L2RldnRvb2xzLWJ1dHRvbj5cXG4gICAgICAgICAgICA8ZGV2dG9vbHMtYnV0dG9uIHQtb24tY2xpY2s9XFxcImlucGVjdERvbSgpXFxcIj4mIzEyODI2OTs8L2RldnRvb2xzLWJ1dHRvbj5cXG4gICAgICAgIDwvZGV2dG9vbHMtbmF2YmFyPlxcbiAgICAgICAgPHQgdC1pZj1cXFwiIXN0YXRlLmNsb3NlZFxcXCI+XFxuICAgICAgICAgICAgPEluc3BlY3RvckNvbXBvbmVudCBpc09wZW49XFxcInN0YXRlLmN1cnJlbnRUYWIgPT0gJ2luc3BlY3RvcidcXFwiIHQtcmVmPVxcXCJpbnNwZWN0b3JcXFwiLz5cXG4gICAgICAgICAgICA8Q29tbWFuZHNDb21wb25lbnQgaXNPcGVuPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICdjb21tYW5kcydcXFwiXFxuICAgICAgICAgICAgICAgIGNvbW1hbmRzPVxcXCJzdGF0ZS5jb21tYW5kc1xcXCIvPlxcbiAgICAgICAgICAgIDxTaG9ydGN1dHNDb21wb25lbnQgaXNPcGVuPVxcXCJzdGF0ZS5jdXJyZW50VGFiID09ICdzaG9ydGN1dHMnXFxcIi8+XFxuICAgICAgICA8L3Q+XFxuICAgIDwvanctZGV2dG9vbHM+XFxuXFxuPC90ZW1wbGF0ZXM+XFxuXCIiLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBPd2wgfSBmcm9tICcuLi8uLi9wbHVnaW4tb3dsL3NyYy9Pd2wnO1xuaW1wb3J0IHsgT3dsTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1vd2wvc3JjL3VpL093bE5vZGUnO1xuaW1wb3J0IHsgRGV2VG9vbHNDb21wb25lbnQgfSBmcm9tICcuL2NvbXBvbmVudHMvRGV2VG9vbHNDb21wb25lbnQnO1xuaW1wb3J0IHsgSHRtbCB9IGZyb20gJy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sJztcbmltcG9ydCB7IERvbUxheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9Eb21MYXlvdXQnO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcblxuaW1wb3J0IGRldnRvb2xzVGVtcGxhdGVzIGZyb20gJy4uL2Fzc2V0cy9EZXZUb29scy54bWwnO1xuaW1wb3J0ICcuLi9hc3NldHMvRGV2VG9vbHMuY3NzJztcblxuZXhwb3J0IGNsYXNzIERldlRvb2xzPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW093bCwgSHRtbCwgRG9tTGF5b3V0XTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxMYXlvdXQgJiBPd2w+ID0ge1xuICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdkZXZUb29scycsXG4gICAgICAgICAgICAgICAgYXN5bmMgcmVuZGVyKCk6IFByb21pc2U8T3dsTm9kZVtdPiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbbmV3IE93bE5vZGUoRGV2VG9vbHNDb21wb25lbnQsIHt9KV07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgICAgIGNvbXBvbmVudFpvbmVzOiBbWydkZXZUb29scycsICdkZWJ1ZyddXSxcbiAgICAgICAgb3dsVGVtcGxhdGVzOiBbZGV2dG9vbHNUZW1wbGF0ZXNdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBPd2xDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tb3dsL3NyYy91aS9Pd2xDb21wb25lbnQnO1xuaW1wb3J0IHsgQ29tbWFuZElkZW50aWZpZXIgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IENvbW1hbmRJbXBsZW1lbnRhdGlvbiB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgS2V5bWFwLCBNYXBwaW5nIH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcbmltcG9ydCB7IGFyZ3NSZXByIH0gZnJvbSAnLi4vdXRpbHMnO1xuXG5pbnRlcmZhY2UgQ29tbWFuZHNTdGF0ZSB7XG4gICAgY3VycmVudFRhYjogc3RyaW5nO1xuICAgIHJlZ2lzdHJ5OiBSZWNvcmQ8Q29tbWFuZElkZW50aWZpZXIsIENvbW1hbmRJbXBsZW1lbnRhdGlvbltdPjtcbiAgICBzZWxlY3RlZENvbW1hbmRJbmRleDogbnVtYmVyO1xuICAgIHNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXI6IHN0cmluZztcbiAgICBzZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbkluZGV4OiBudW1iZXI7XG59XG5pbnRlcmZhY2UgQ29tbWFuZHNQcm9wcyB7XG4gICAgLy8gU3RhY2sgb2YgYWxsIGNvbW1hbmRzIGV4ZWN1dGVkIHNpbmNlIGluaXQuXG4gICAgY29tbWFuZHM6IEFycmF5PFtDb21tYW5kSWRlbnRpZmllciwgQ29tbWFuZFBhcmFtc10+O1xufVxuXG5leHBvcnQgY2xhc3MgQ29tbWFuZHNDb21wb25lbnQgZXh0ZW5kcyBPd2xDb21wb25lbnQ8Q29tbWFuZHNQcm9wcz4ge1xuICAgIHN0YXRlOiBDb21tYW5kc1N0YXRlID0ge1xuICAgICAgICBjdXJyZW50VGFiOiAncXVldWUnLFxuICAgICAgICByZWdpc3RyeTogdGhpcy5lbnYuZWRpdG9yLmRpc3BhdGNoZXIuY29tbWFuZHMsXG4gICAgICAgIHNlbGVjdGVkQ29tbWFuZEluZGV4OiBudWxsLCAvLyBJbmRleCBvZiB0aGUgc2VsZWN0ZWQgY29tbWFuZCBpbiB0aGUgc3RhY2tcbiAgICAgICAgc2VsZWN0ZWRDb21tYW5kSWRlbnRpZmllcjogbnVsbCwgLy8gSWRlbnRpZmllciBvZiB0aGUgc2VsZWN0ZWQgY29tbWFuZFxuICAgICAgICBzZWxlY3RlZENvbW1hbmRJbXBsZW1lbnRhdGlvbkluZGV4OiBudWxsLCAvLyBJbmRleCBvZiB0aGUgc2VsZWN0ZWQgY29tbWFuZCBkZWZpbml0aW9uXG4gICAgfTtcbiAgICBsb2NhbFN0b3JhZ2UgPSBbJ2N1cnJlbnRUYWInXTtcbiAgICBhcmdzUmVwciA9IGFyZ3NSZXByO1xuICAgIHN0cmluZ2lmeVBhdHRlcm4gPSB0aGlzLmVudi5lZGl0b3IucGx1Z2lucy5nZXQoS2V5bWFwKS5zdHJpbmdpZnlQYXR0ZXJuO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFRha2UgYSBwYXlsb2FkIHZhbHVlIGFuZCBmb3JtYXQgaXQgZm9yIGRpc3BsYXkgKG1vc3RseSB0byBlbnN1cmUgdGhhdFxuICAgICAqIHdlIGNhbiBkaXNwbGF5IGl0IHByb3Blcmx5IGFzIGEgc3RyaW5nKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2YWx1ZVxuICAgICAqL1xuICAgIGZvcm1hdFBheWxvYWRWYWx1ZSh2YWx1ZTogTm9kZSB8IHN0cmluZyB8IGJvb2xlYW4gfCBudW1iZXIgfCBvYmplY3QpOiBzdHJpbmcge1xuICAgICAgICBpZiAodmFsdWUgJiYgdmFsdWUgaW5zdGFuY2VvZiBOb2RlICYmIG5vZGVOYW1lKHZhbHVlKSkge1xuICAgICAgICAgICAgcmV0dXJuICc8JyArIG5vZGVOYW1lKHZhbHVlKS50b0xvd2VyQ2FzZSgpICsgJz4nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAnJyArIHZhbHVlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGUga2V5ZG93biBldmVudCB0byBuYXZpZ2F0ZSBpbiB0aGUgY29tbWFuZCBzdGFjay5cbiAgICAgKi9cbiAgICBvbktleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuY3VycmVudFRhYiA9PT0gJ3F1ZXVlJykge1xuICAgICAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09ICdBcnJvd0Rvd24nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZENvbW1hbmRJbmRleCA9IE1hdGgubWF4KHRoaXMuc3RhdGUuc2VsZWN0ZWRDb21tYW5kSW5kZXggLSAxLCAwKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuY29kZSA9PT0gJ0Fycm93VXAnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZENvbW1hbmRJbmRleCA9IE1hdGgubWluKFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkQ29tbWFuZEluZGV4ICsgMSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm9wcy5jb21tYW5kcy5sZW5ndGggLSAxLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnN0YXRlLmN1cnJlbnRUYWIgPT09ICdyZWdpc3RyeScpIHtcbiAgICAgICAgICAgIGNvbnN0IGlkZW50aWZpZXJzID0gT2JqZWN0LmtleXModGhpcy5zdGF0ZS5yZWdpc3RyeSkuc29ydCgpO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudEluZGV4ID0gaWRlbnRpZmllcnMuaW5kZXhPZih0aGlzLnN0YXRlLnNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXIpO1xuICAgICAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09ICdBcnJvd0Rvd24nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZENvbW1hbmRJZGVudGlmaWVyID1cbiAgICAgICAgICAgICAgICAgICAgaWRlbnRpZmllcnNbTWF0aC5taW4oY3VycmVudEluZGV4ICsgMSwgaWRlbnRpZmllcnMubGVuZ3RoIC0gMSldO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudC5jb2RlID09PSAnQXJyb3dVcCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXIgPSBpZGVudGlmaWVyc1tNYXRoLm1heChjdXJyZW50SW5kZXggLSAxLCAwKV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBldmVudC5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogT3BlbiB0aGUgdGFiIHdpdGggdGhlIGdpdmVuIHRhYk5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGFiTmFtZVxuICAgICAqL1xuICAgIG9wZW5UYWIodGFiTmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuY3VycmVudFRhYiA9IHRhYk5hbWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNlbGVjdCB0aGUgY29tbWFuZCBhdCBnaXZlbiBpbmRleC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpbmRleFxuICAgICAqL1xuICAgIHNlbGVjdENvbW1hbmRCeUluZGV4KGluZGV4OiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5zZWxlY3RlZENvbW1hbmRJbmRleCA9IGluZGV4O1xuICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXIgPSB0aGlzLnByb3BzLmNvbW1hbmRzW2luZGV4XVswXTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VsZWN0IHRoZSBjb21tYW5kIHdpdGggZ2l2ZW4gaWRlbnRpZmllci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21tYW5kSWRlbnRpZmllclxuICAgICAqL1xuICAgIHNlbGVjdENvbW1hbmQoY29tbWFuZElkZW50aWZpZXI6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkQ29tbWFuZElkZW50aWZpZXIgPSBjb21tYW5kSWRlbnRpZmllcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBrZXkgbWFwcGluZ3MgbWF0Y2hpbmcgdGhlIGdpdmVuIGNvbW1hbmQgaWRlbnRpZmllci5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21tYW5kSWRlbnRpZmllclxuICAgICAqL1xuICAgIG1hdGNoaW5nTWFwcGluZ3MoY29tbWFuZElkZW50aWZpZXI6IHN0cmluZyk6IE1hcHBpbmdbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVudi5lZGl0b3IucGx1Z2luc1xuICAgICAgICAgICAgLmdldChLZXltYXApXG4gICAgICAgICAgICAubWFwcGluZ3MuZmxhdCgpXG4gICAgICAgICAgICAuZmlsdGVyKG1hcHBpbmcgPT4gbWFwcGluZy5jb25maWd1cmVkQ29tbWFuZC5jb21tYW5kSWQgPT09IGNvbW1hbmRJZGVudGlmaWVyKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb21tYW5kc0NvbXBvbmVudCB9IGZyb20gJy4vQ29tbWFuZHNDb21wb25lbnQnO1xuaW1wb3J0IHsgSW5zcGVjdG9yQ29tcG9uZW50IH0gZnJvbSAnLi9JbnNwZWN0b3JDb21wb25lbnQnO1xuaW1wb3J0IHsgU2hvcnRjdXRzQ29tcG9uZW50IH0gZnJvbSAnLi9TaG9ydGN1dHNDb21wb25lbnQnO1xuaW1wb3J0IHsgT3dsQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLW93bC9zcmMvdWkvT3dsQ29tcG9uZW50JztcbmltcG9ydCB7IENvbW1hbmRJZGVudGlmaWVyLCBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBob29rcyB9IGZyb20gJ0BvZG9vL293bCc7XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLyB0b2RvOiB1c2UgQVBJIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbmludGVyZmFjZSBEZXZUb29sc1N0YXRlIHtcbiAgICBjbG9zZWQ6IGJvb2xlYW47IC8vIEFyZSB0aGUgZGV2dG9vbHMgb3Blbj9cbiAgICBoZWlnaHQ6IG51bWJlcjsgLy8gSW4gcHhcbiAgICBjdXJyZW50VGFiOiBzdHJpbmc7IC8vIE5hbWUgb2YgdGhlIGN1cnJlbnQgdGFiXG4gICAgY29tbWFuZHM6IEFycmF5PFtDb21tYW5kSWRlbnRpZmllciwgQ29tbWFuZFBhcmFtc10+O1xufVxuXG5leHBvcnQgY2xhc3MgRGV2VG9vbHNDb21wb25lbnQ8VCA9IHt9PiBleHRlbmRzIE93bENvbXBvbmVudDxUPiB7XG4gICAgc3RhdGljIGNvbXBvbmVudHMgPSB7XG4gICAgICAgIENvbW1hbmRzQ29tcG9uZW50OiBDb21tYW5kc0NvbXBvbmVudCxcbiAgICAgICAgSW5zcGVjdG9yQ29tcG9uZW50LFxuICAgICAgICBTaG9ydGN1dHNDb21wb25lbnQsXG4gICAgfTtcbiAgICBzdGF0aWMgdGVtcGxhdGUgPSAnZGV2dG9vbHMnO1xuICAgIGluc3BlY3RvclJlZiA9IGhvb2tzLnVzZVJlZignaW5zcGVjdG9yJyk7XG5cbiAgICBzdGF0ZTogRGV2VG9vbHNTdGF0ZSA9IHtcbiAgICAgICAgY2xvc2VkOiB0cnVlLFxuICAgICAgICBjdXJyZW50VGFiOiAnaW5zcGVjdG9yJyxcbiAgICAgICAgaGVpZ2h0OiAzMDAsXG4gICAgICAgIGNvbW1hbmRzOiBbXSwgLy8gU3RhY2sgb2YgYWxsIGNvbW1hbmRzIGV4ZWN1dGVkIHNpbmNlIGluaXQuXG4gICAgfTtcbiAgICBsb2NhbFN0b3JhZ2UgPSBbJ2Nsb3NlZCcsICdjdXJyZW50VGFiJywgJ2hlaWdodCddO1xuICAgIC8vIEZvciByZXNpemluZy9vcGVuaW5nIChzZWUgdG9nZ2xlQ2xvc2VkKVxuICAgIF9oZWlnaHRPbkxhc3RNb3VzZWRvd246IG51bWJlcjtcblxuICAgIGFzeW5jIHdpbGxTdGFydCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy5lbnYuZWRpdG9yLmRpc3BhdGNoZXIucmVnaXN0ZXJDb21tYW5kSG9vaygnKicsIHRoaXMucmVmcmVzaC5iaW5kKHRoaXMpKTtcbiAgICAgICAgcmV0dXJuIHN1cGVyLndpbGxTdGFydCgpO1xuICAgIH1cbiAgICB3aWxsVW5tb3VudCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5jb21tYW5kcyA9IFtdO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLyoqXG4gICAgICogT3BlbiB0aGUgdGFiIHdpdGggdGhlIGdpdmVuIGB0YWJOYW1lYFxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHRhYk5hbWVcbiAgICAgKi9cbiAgICBvcGVuVGFiKHRhYk5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLnN0YXRlLmN1cnJlbnRUYWIgPSB0YWJOYW1lO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBCaW5kIG1vdXNlIGhhbmRsZXIgdG8gYWxsb3cgdGhlIHNlbGVjdGlvbiBvZiB0aGUgbm9kZSBpbiB0aGUgZGV2dG9vbHMgaW5zcGVjdG9yLlxuICAgICAqIFdoZW4gdGhlIG1vdXNlIHdpbGwgbW92ZSwgd2UgYWRkIGEgY2xhc3MgdG8gaGlnaGxpZ2h0IHRoZSB0YXJnZXRlZCBub2RlIChsaW5rZWQgdG8gVk5vZGUpLlxuICAgICAqIFdpbGwgYmUgdW5iaW5kIHdoZW4gdGhlIHVzZXIgY2xpY2sgaW5zaWRlIHRoZSBkb20uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZcbiAgICAgKi9cbiAgICBpbnBlY3REb20oKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuY3VycmVudFRhYiA9ICdpbnNwZWN0b3InO1xuICAgICAgICAodGhpcy5pbnNwZWN0b3JSZWYuY29tcCBhcyBJbnNwZWN0b3JDb21wb25lbnQpLmlucGVjdERvbSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWZyZXNoIHRoaXMgY29tcG9uZW50IHdpdGggcmVzcGVjdCB0byB0aGUgcmVjZW50IGRpc3BhdGNoaW5nIG9mIHRoZVxuICAgICAqIGdpdmVuIGNvbW1hbmQgd2l0aCB0aGUgZ2l2ZW4gYXJndW1lbnRzLlxuICAgICAqL1xuICAgIHJlZnJlc2gocGFyYW1zOiBDb21tYW5kUGFyYW1zLCBpZDogQ29tbWFuZElkZW50aWZpZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5jb21tYW5kcy5wdXNoKFtpZCwgcGFyYW1zXSk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERyYWcgdGhlIERldlRvb2xzIHRvIHJlc2l6ZSB0aGVtXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge01vdXNlRXZlbnR9IGV2ZW50XG4gICAgICovXG4gICAgc3RhcnRSZXNpemUoZXZlbnQ6IE1vdXNlRXZlbnQgfCBUb3VjaEV2ZW50KTogdm9pZCB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuX2hlaWdodE9uTGFzdE1vdXNlZG93biA9IHRoaXMuc3RhdGUuaGVpZ2h0O1xuICAgICAgICBpZiAodGhpcy5zdGF0ZS5jbG9zZWQpIHtcbiAgICAgICAgICAgIHJldHVybjsgLy8gRG8gbm90IHJlc2l6ZSBpZiB0aGUgRGV2VG9vbHMgYXJlIGNsb3NlZFxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHN0YXJ0WTogbnVtYmVyID1cbiAgICAgICAgICAgIGV2ZW50IGluc3RhbmNlb2YgTW91c2VFdmVudCA/IGV2ZW50LnBhZ2VZIDogZXZlbnQudGFyZ2V0VG91Y2hlc1swXS5wYWdlWTsgLy8gWSBwb3NpdGlvbiBvZiB0aGUgbW91c2Vkb3duXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFBlcmZvcm0gdGhlIHJlc2l6aW5nIG9uIGV2ZXJ5IG1vdXNlIG1vdXZlbWVudFxuICAgICAgICAgKlxuICAgICAgICAgKiBAcGFyYW0gZXZcbiAgICAgICAgICovXG4gICAgICAgIGNvbnN0IGRvUmVzaXplID0gKGV2OiBNb3VzZUV2ZW50IHwgVG91Y2hFdmVudCk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFk6IG51bWJlciA9XG4gICAgICAgICAgICAgICAgZXYgaW5zdGFuY2VvZiBNb3VzZUV2ZW50ID8gZXYucGFnZVkgOiBldi50YXJnZXRUb3VjaGVzWzBdLnBhZ2VZO1xuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0OiBudW1iZXIgPSBzdGFydFkgLSBjdXJyZW50WTtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuaGVpZ2h0ID0gdGhpcy5faGVpZ2h0T25MYXN0TW91c2Vkb3duICsgb2Zmc2V0O1xuICAgICAgICB9O1xuICAgICAgICAvKipcbiAgICAgICAgICogU3RvcCByZXNpemluZyBvbiBtb3VzZSB1cFxuICAgICAgICAgKi9cbiAgICAgICAgY29uc3Qgc3RvcFJlc2l6ZSA9ICgpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCBkb1Jlc2l6ZSwgZmFsc2UpO1xuICAgICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBzdG9wUmVzaXplLCBmYWxzZSk7XG4gICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZG9SZXNpemUsIGZhbHNlKTtcbiAgICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHN0b3BSZXNpemUsIGZhbHNlKTtcbiAgICAgICAgfTtcblxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgZG9SZXNpemUpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHN0b3BSZXNpemUpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgZG9SZXNpemUpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBzdG9wUmVzaXplKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVG9nZ2xlIHRoZSBgY2xvc2VkYCBzdGF0ZSBvZiB0aGUgRGV2VG9vbHMgKG9ubHkgb24gYSBzaW1wbGUgY2xpY2s6IG5vdFxuICAgICAqIGlmIHNvbWUgcmVzaXppbmcgb2NjdXJyZWQgYmV0d2VlbiBtb3VzZWRvd24gYW5kIG1vdXNldXApXG4gICAgICovXG4gICAgdG9nZ2xlQ2xvc2VkKGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGRpZEp1c3RSZXNpemUgPSB0aGlzLl9oZWlnaHRPbkxhc3RNb3VzZWRvd24gIT09IHRoaXMuc3RhdGUuaGVpZ2h0O1xuICAgICAgICBjb25zdCBpc09uQnV0dG9uID0gbm9kZU5hbWUoZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50KSA9PT0gJ0RFVlRPT0xTLUJVVFRPTic7XG4gICAgICAgIGlmICghZGlkSnVzdFJlc2l6ZSAmJiAhKGlzT25CdXR0b24gJiYgIXRoaXMuc3RhdGUuY2xvc2VkKSkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5jbG9zZWQgPSAhdGhpcy5zdGF0ZS5jbG9zZWQ7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBPd2xDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tb3dsL3NyYy91aS9Pd2xDb21wb25lbnQnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5cbmludGVyZmFjZSBJbmZvU3RhdGUge1xuICAgIGN1cnJlbnRUYWI6IHN0cmluZztcbn1cbmV4cG9ydCBjbGFzcyBJbmZvQ29tcG9uZW50IGV4dGVuZHMgT3dsQ29tcG9uZW50PHt9PiB7XG4gICAgYWJvdXRNZVByb3BzID0gWydpZCcsICduYW1lJywgJ2xlbmd0aCcsICdhdG9taWMnLCAnbW9kaWZpZXJzJ107XG4gICAgZmFtaWx5UHJvcHMgPSBbJ3BhcmVudCcsICdjaGlsZHJlbicsICdzaWJsaW5ncyddO1xuICAgIGN1c3RvbVByb3BzQmxhY2tsaXN0ID0gdGhpcy5hYm91dE1lUHJvcHMuY29uY2F0KHRoaXMuZmFtaWx5UHJvcHMpLmNvbmNhdChbJ2NoaWxkVk5vZGVzJ10pO1xuICAgIHN0YXRlOiBJbmZvU3RhdGUgPSB7XG4gICAgICAgIGN1cnJlbnRUYWI6ICd2Tm9kZScsXG4gICAgfTtcbiAgICBsb2NhbFN0b3JhZ2UgPSBbJ2N1cnJlbnRUYWInXTtcbiAgICAvKipcbiAgICAgKiBPcGVuIHRoZSB0YWIgd2l0aCB0aGUgZ2l2ZW4gYHRhYk5hbWVgXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGFiTmFtZVxuICAgICAqL1xuICAgIG9wZW5UYWIodGFiTmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuY3VycmVudFRhYiA9IHRhYk5hbWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRyaWdnZXIgYSAnbm9kZS1zZWxlY3RlZCcgY3VzdG9tIGV2ZW50XG4gICAgICogd2l0aCB0aGUgZ2l2ZW4gYHZOb2RlYCB0byBzZWxlY3QgaXRcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Vk5vZGV9IHZOb2RlXG4gICAgICovXG4gICAgc2VsZWN0Tm9kZSh2Tm9kZTogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy50cmlnZ2VyKCdub2RlLXNlbGVjdGVkJywge1xuICAgICAgICAgICAgdk5vZGU6IHZOb2RlLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBuYW1lIG9mIHRoZSBjbGFzcyBvZiB0aGUgZ2l2ZW4gVk5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdk5vZGVcbiAgICAgKi9cbiAgICBjbGFzc05hbWUodk5vZGU6IFZOb2RlKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHZOb2RlLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGNvbnRlbnRzIG9mIGEgcHJvcGVydHkgb2YgYSBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2Tm9kZVxuICAgICAqIEBwYXJhbSBwcm9wTmFtZVxuICAgICAqL1xuICAgIHByb3BSZXByKHZOb2RlOiBWTm9kZSwgcHJvcE5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBwcm9wID0gdk5vZGVbcHJvcE5hbWVdO1xuICAgICAgICBpZiAocHJvcE5hbWUgPT09ICdhdG9taWMnKSB7XG4gICAgICAgICAgICBpZiAodk5vZGUuaXMoQXRvbWljTm9kZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJ3RydWUnO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh2Tm9kZS5pcyhDb250YWluZXJOb2RlKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAnZmFsc2UnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJz8nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHByb3BOYW1lID09PSAnbW9kaWZpZXJzJykge1xuICAgICAgICAgICAgaWYgKCF2Tm9kZS5tb2RpZmllcnMubGVuZ3RoKSByZXR1cm4gJ1tdJztcbiAgICAgICAgICAgIHJldHVybiBgWyAke3ZOb2RlLm1vZGlmaWVycy5tYXAobSA9PiBtLnRvU3RyaW5nKCkpLmpvaW4oJywgJyl9IF1gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHt9LnRvU3RyaW5nLmNhbGwocHJvcCkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXScpIHtcbiAgICAgICAgICAgICAgICBwcm9wID0gdk5vZGVbcHJvcE5hbWVdKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJvcFJlcHIocHJvcCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFuIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIGdpdmVuIFZOb2RlJ3MgcHVibGljIHByb3BlcnRpZXMgYXNcbiAgICAgKiBhbHBoYWJldGljYWxseSBzb3J0ZWQgcGFpcnMgb2Yga2V5IGFuZCB2YWx1ZSBzdHJpbmdzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHZOb2RlXG4gICAgICovXG4gICAgbm9kZVByb3BlcnRpZXModk5vZGU6IFZOb2RlKTogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfVtdIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHZOb2RlKVxuICAgICAgICAgICAgLmZpbHRlcihrZXkgPT4gIWtleS5zdGFydHNXaXRoKCdfJykgJiYgIXRoaXMuY3VzdG9tUHJvcHNCbGFja2xpc3QuaW5jbHVkZXMoa2V5KSlcbiAgICAgICAgICAgIC5zb3J0KClcbiAgICAgICAgICAgIC5tYXAoa2V5ID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBrZXk6IGtleSwgdmFsdWU6IHRoaXMuX3Byb3BSZXByKHZOb2RlW2tleV0pIH07XG4gICAgICAgICAgICB9KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBsZW5ndGggb2YgdGhpcyBub2RlIGFuZCBhbGwgaXRzIGRlc2NlbmRlbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIF9fY3VycmVudFxuICAgICAqL1xuICAgIHRvdGFsTGVuZ3RoKHZOb2RlOiBWTm9kZSwgX19jdXJyZW50ID0gMCk6IG51bWJlciB7XG4gICAgICAgIF9fY3VycmVudCArPSB2Tm9kZS5sZW5ndGg7XG4gICAgICAgIHZOb2RlLmNoaWxkcmVuKCkuZm9yRWFjaCgoY2hpbGQ6IFZOb2RlKTogdm9pZCA9PiB7XG4gICAgICAgICAgICBpZiAoY2hpbGQuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgICAgIF9fY3VycmVudCA9IHRoaXMudG90YWxMZW5ndGgoY2hpbGQsIF9fY3VycmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gX19jdXJyZW50O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb2cgYSBgVk5vZGVgIHRvIHRoZSBjb25zb2xlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHZOb2RlXG4gICAgICovXG4gICAgbG9nVk5vZGUodk5vZGU6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIGNvbnNvbGUubG9nKHZOb2RlKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIF9yZXByKHZOb2RlOiBWTm9kZSk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IG5leHRTaWJsaW5nID0gdk5vZGUubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgY29uc3QgcHJldlNpYmxpbmcgPSB2Tm9kZS5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgY29uc3QgcG9zaXRpb24gPSBuZXh0U2libGluZyA/ICdCRUZPUkUnIDogcHJldlNpYmxpbmcgPyAnQUZURVInIDogJ0lOU0lERSc7XG4gICAgICAgIGNvbnN0IHJlZmVyZW5jZSA9IG5leHRTaWJsaW5nIHx8IHByZXZTaWJsaW5nIHx8IHZOb2RlLnBhcmVudDtcbiAgICAgICAgaWYgKHJlZmVyZW5jZSkge1xuICAgICAgICAgICAgcmV0dXJuIGAke3Bvc2l0aW9ufSAke3JlZmVyZW5jZS5pZH0gKCR7cmVmZXJlbmNlLm5hbWV9KWA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gJ05vdCBpbiBWRG9jdW1lbnQnO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGNvbnRlbnRzIG9mIGEgcHJvcGVydHkgb2YgYSBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2Tm9kZVxuICAgICAqIEBwYXJhbSBwcm9wTmFtZVxuICAgICAqL1xuICAgIF9wcm9wUmVwcihwcm9wKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IHZhbHVlID0gJycgKyBwcm9wO1xuICAgICAgICBpZiAodHlwZW9mIHByb3AgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwcm9wKSAmJiAhcHJvcC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9ICdbXSc7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByb3AgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9ICdudWxsJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvcCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSAndW5kZWZpbmVkJztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHJvcCBpbnN0YW5jZW9mIFNldCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1zID0gW107XG4gICAgICAgICAgICAgICAgcHJvcC5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtcy5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHZhbHVlID0gaXRlbXMuam9pbignXFxuJyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFwcm9wIHx8ICFPYmplY3Qua2V5cyhwcm9wKS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9ICd7fSc7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHByb3AudG9TdHJpbmcgPT09IHt9LnRvU3RyaW5nKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSB0aGlzLl9vYmplY3RSZXByKHByb3ApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBwcm9wID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdmFsdWUgPSAnXCInICsgdmFsdWUgKyAnXCInO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgc3RyaW5nIHJlcHJlc2VudGluZyBhbGwga2V5L3ZhbHVlIHBhaXJzIG9mIGFuIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2Tm9kZVxuICAgICAqIEBwYXJhbSBwcm9wTmFtZVxuICAgICAqL1xuICAgIF9vYmplY3RSZXByKG9iajogb2JqZWN0KTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKG9iailcbiAgICAgICAgICAgIC5maWx0ZXIoa2V5ID0+IGtleSAhPT0gJ3RvU3RyaW5nJylcbiAgICAgICAgICAgIC5tYXAoa2V5ID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4ga2V5ICsgJzogJyArIG9ialtrZXldO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5qb2luKCdcXG4nKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBJbmZvQ29tcG9uZW50IH0gZnJvbSAnLi9JbmZvQ29tcG9uZW50JztcbmltcG9ydCB7IFBhdGhDb21wb25lbnQgfSBmcm9tICcuL1BhdGhDb21wb25lbnQnO1xuaW1wb3J0IHsgVHJlZUNvbXBvbmVudCB9IGZyb20gJy4vVHJlZUNvbXBvbmVudCc7XG5pbXBvcnQgeyBPd2xDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tb3dsL3NyYy91aS9Pd2xDb21wb25lbnQnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IERvbUxheW91dEVuZ2luZSB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1kb20tbGF5b3V0L3NyYy91aS9Eb21MYXlvdXRFbmdpbmUnO1xuaW1wb3J0IHsgY2FyZXRQb3NpdGlvbkZyb21Qb2ludCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL3NyYy9wb2x5ZmlsbCc7XG5pbXBvcnQgeyBDaGFyTm9kZSB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1jaGFyL3NyYy9DaGFyTm9kZSc7XG5cbmNvbnN0IGhvdmVyU3R5bGUgPSAnYm94LXNoYWRvdzogaW5zZXQgMCAwIDAgMTAwdmggcmdiYSg5NSwgMTQ2LCAyMDQsIDAuNSk7IGN1cnNvcjogcG9pbnRlcjsnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEluc3BlY3RvclN0YXRlIHtcbiAgICBzZWxlY3RlZElEOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBJbnNwZWN0b3JDb21wb25lbnRQcm9wcyBleHRlbmRzIEluc3BlY3RvclN0YXRlIHtcbiAgICByb290OiBWTm9kZTtcbn1cblxuZXhwb3J0IGNsYXNzIEluc3BlY3RvckNvbXBvbmVudCBleHRlbmRzIE93bENvbXBvbmVudDxJbnNwZWN0b3JDb21wb25lbnRQcm9wcz4ge1xuICAgIHN0YXRpYyBjb21wb25lbnRzID0geyBJbmZvQ29tcG9uZW50LCBQYXRoQ29tcG9uZW50LCBUcmVlQ29tcG9uZW50IH07XG4gICAgZG9tRW5naW5lID0gdGhpcy5lbnYuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCkuZW5naW5lcy5kb20gYXMgRG9tTGF5b3V0RW5naW5lO1xuXG4gICAgcHJpdmF0ZSBfaG92ZXJlZFRhcmdldHM6IHtcbiAgICAgICAgZWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gICAgICAgIG9sZFN0eWxlOiBzdHJpbmc7XG4gICAgfVtdID0gW107XG5cbiAgICBzdGF0ZTogSW5zcGVjdG9yU3RhdGUgPSB7XG4gICAgICAgIHNlbGVjdGVkSUQ6IHRoaXMuZG9tRW5naW5lLmNvbXBvbmVudHMuZ2V0KCdlZGl0YWJsZScpWzBdPy5pZCxcbiAgICB9O1xuICAgIHNlbGVjdGVkTm9kZSA9IHRoaXMuZ2V0Tm9kZSh0aGlzLnN0YXRlLnNlbGVjdGVkSUQpO1xuXG4gICAgY29uc3RydWN0b3IocGFyZW50PzogT3dsQ29tcG9uZW50PHt9PiwgcHJvcHM/OiBJbnNwZWN0b3JDb21wb25lbnRQcm9wcykge1xuICAgICAgICBzdXBlcihwYXJlbnQsIHByb3BzKTtcbiAgICAgICAgdGhpcy5fb25JbnNwZWN0b3JNb3VzZU1vdmUgPSB0aGlzLl9vbkluc3BlY3Rvck1vdXNlTW92ZS5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9vbkluc3BlY3Rvck1vdXNlTGVhdmUgPSB0aGlzLl9vbkluc3BlY3Rvck1vdXNlTGVhdmUuYmluZCh0aGlzKTtcbiAgICAgICAgdGhpcy5fb25JbnNwZWN0b3JNb3VzZURvd24gPSB0aGlzLl9vbkluc3BlY3Rvck1vdXNlRG93bi5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9vbkluc3BlY3RvckNsaWNrID0gdGhpcy5fb25JbnNwZWN0b3JDbGljay5iaW5kKHRoaXMpO1xuICAgIH1cbiAgICB3aWxsVW5tb3VudCgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5faG92ZXJlZFRhcmdldHMgPSBbXTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUgPSBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSBrZXlib2FyZCBuYXZpZ2F0aW9uIGluIERldlRvb2xzIChhcnJvd3MgdG8gbW92ZSBpbiB0aGUgdHJlZSlcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZlbnRcbiAgICAgKi9cbiAgICBvbktleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWQ6IFZOb2RlID0gdGhpcy5nZXROb2RlKHRoaXMuc3RhdGUuc2VsZWN0ZWRJRCk7XG4gICAgICAgIGxldCBuZXdTZWxlY3Rpb246IFZOb2RlO1xuICAgICAgICBzd2l0Y2ggKGV2ZW50LmNvZGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ0Fycm93RG93bic6XG4gICAgICAgICAgICAgICAgbmV3U2VsZWN0aW9uID0gc2VsZWN0ZWQubmV4dFNpYmxpbmcoKSB8fCBzZWxlY3RlZC5maXJzdENoaWxkKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdBcnJvd1VwJzpcbiAgICAgICAgICAgICAgICBuZXdTZWxlY3Rpb24gPSBzZWxlY3RlZC5wcmV2aW91c1NpYmxpbmcoKSB8fCBzZWxlY3RlZC5wYXJlbnQ7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdBcnJvd0xlZnQnOlxuICAgICAgICAgICAgICAgIG5ld1NlbGVjdGlvbiA9IHNlbGVjdGVkLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnQXJyb3dSaWdodCc6XG4gICAgICAgICAgICAgICAgbmV3U2VsZWN0aW9uID0gc2VsZWN0ZWQubmV4dFNpYmxpbmcoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChuZXdTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkSUQgPSBuZXdTZWxlY3Rpb24uaWQ7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZSA9IHRoaXMuZ2V0Tm9kZSh0aGlzLnN0YXRlLnNlbGVjdGVkSUQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aGUgc2VsZWN0aW9uIG9mIGEgbm9kZS4gQSBzdWJjb21wb25lbnQgdHJpZ2dlcnMgYSAnc2VsZWN0LW5vZGUnXG4gICAgICogY3VzdG9tIGV2ZW50IGFuZCB0aGlzIG1ldGhvZCBsaXN0ZW5zIHRvIGl0LCByZXRyaWV2ZXMgdGhlIGB2Tm9kZWAgdGhhdCBpdFxuICAgICAqIHBhc3NlcyBpbiBpdHMgYGRldGFpbGAga2V5LCBhbmQgbW9kaWZpZXMgaXRzIHN0YXRlIHRvIGFjY291bnQgZm9yIHRoZVxuICAgICAqIGNoYW5nZSBpbiBzZWxlY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0N1c3RvbUV2ZW50fSBldmVudFxuICAgICAqIEBwYXJhbSB7Vk5vZGV9IGV2ZW50LmRldGFpbC52Tm9kZVxuICAgICAqL1xuICAgIHNlbGVjdE5vZGUoZXZlbnQ6IEN1c3RvbUV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuc2VsZWN0ZWRJRCA9IGV2ZW50LmRldGFpbC52Tm9kZS5pZDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGUgPSB0aGlzLmdldE5vZGUodGhpcy5zdGF0ZS5zZWxlY3RlZElEKTtcbiAgICB9XG4gICAgZ2V0Tm9kZShpZDogbnVtYmVyKTogVk5vZGUge1xuICAgICAgICByZXR1cm4gdGhpcy5kb21FbmdpbmUucm9vdC5kZXNjZW5kYW50cyhub2RlID0+IG5vZGUuaWQgPT09IGlkKVswXSB8fCB0aGlzLmRvbUVuZ2luZS5yb290O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHBhdGggYmV0d2VlbiB0aGUgZ2l2ZW4gYHZOb2RlYCBhbmQgdGhlIHJvb3Qgdk5vZGUsIGFzIGFuIGFycmF5XG4gICAgICogb2YgVk5vZGUsIHNvcnRlZCBmcm9tIHRoZSBoaWdoZXN0IHBhcmVudCAodGhlIHJvb3QpIHRvIHRoZSBnaXZlbiB2Tm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Vk5vZGV9IHZOb2RlXG4gICAgICogQHJldHVybnMge1ZOb2RlIFtdfVxuICAgICAqL1xuICAgIGdldFBhdGgodk5vZGU6IFZOb2RlKTogVk5vZGVbXSB7XG4gICAgICAgIGNvbnN0IHBhdGg6IFZOb2RlW10gPSBbdk5vZGVdO1xuICAgICAgICBsZXQgcGFyZW50OiBWTm9kZSA9IHZOb2RlLnBhcmVudDtcbiAgICAgICAgd2hpbGUgKHBhcmVudCkge1xuICAgICAgICAgICAgcGF0aC51bnNoaWZ0KHBhcmVudCk7XG4gICAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwYXRoO1xuICAgIH1cblxuICAgIHBhdGNoZWQoKTogdm9pZCB7XG4gICAgICAgIHN1cGVyLnBhdGNoZWQoKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zZWxlY3RlZCcpO1xuICAgICAgICBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgIC8vc2VsZWN0ZWQuc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJpbmQgbW91c2UgaGFuZGxlciB0byBhbGxvdyB0aGUgc2VsZWN0aW9uIG9mIHRoZSBub2RlIGluIHRoZSBkZXZ0b29scyBpbnNwZWN0b3IuXG4gICAgICogV2hlbiB0aGUgbW91c2Ugd2lsbCBtb3ZlLCB3ZSBhZGQgYSBjbGFzcyB0byBoaWdobGlnaHQgdGhlIHRhcmdldGVkIG5vZGUgKGxpbmtlZCB0byBWTm9kZSkuXG4gICAgICogV2lsbCBiZSB1bmJpbmQgd2hlbiB0aGUgdXNlciBjbGljayBpbnNpZGUgdGhlIGRvbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldlxuICAgICAqL1xuICAgIGlucGVjdERvbSgpOiB2b2lkIHtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX29uSW5zcGVjdG9yTW91c2VNb3ZlLCB0cnVlKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCB0aGlzLl9vbkluc3BlY3Rvck1vdXNlTGVhdmUsIHRydWUpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgdGhpcy5fb25JbnNwZWN0b3JNb3VzZURvd24sIHRydWUpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkluc3BlY3RvckNsaWNrLCB0cnVlKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIEFkZCBhIGNsYXNzIHRvIGhpZ2hsaWdodCB0aGUgdGFyZ2V0ZWQgbm9kZSAobGlrZSB0byBWTm9kZSkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZcbiAgICAgKi9cbiAgICBwcml2YXRlIGFzeW5jIF9vbkluc3BlY3Rvck1vdXNlTW92ZShldjogTW91c2VFdmVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBldi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZm9yIChjb25zdCBpbnNwZWN0ZWQgb2YgdGhpcy5faG92ZXJlZFRhcmdldHMpIHtcbiAgICAgICAgICAgIGluc3BlY3RlZC5lbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBpbnNwZWN0ZWQub2xkU3R5bGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2hvdmVyZWRUYXJnZXRzID0gW107XG5cbiAgICAgICAgY29uc3QgZWxlbWVudHM6IEhUTUxFbGVtZW50W10gPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHRoaXMuX2dldE5vZGVGcm9tUG9zaXRpb24oZXYuY2xpZW50WCwgZXYuY2xpZW50WSkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZG9tTm9kZSBvZiB0aGlzLmRvbUVuZ2luZS5nZXREb21Ob2Rlcyhub2RlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBkb21Ob2RlIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgPyBkb21Ob2RlIDogZG9tTm9kZS5wYXJlbnRFbGVtZW50O1xuICAgICAgICAgICAgICAgIGlmICghZWxlbWVudHMuaW5jbHVkZXMoZWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHMucHVzaChlbGVtZW50KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIGVsZW1lbnRzKSB7XG4gICAgICAgICAgICBjb25zdCBzdHlsZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdzdHlsZScpIHx8ICcnO1xuICAgICAgICAgICAgdGhpcy5faG92ZXJlZFRhcmdldHMucHVzaCh7XG4gICAgICAgICAgICAgICAgZWxlbWVudDogZWxlbWVudCxcbiAgICAgICAgICAgICAgICBvbGRTdHlsZTogc3R5bGUsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdzdHlsZScsIHN0eWxlICsgJzsnICsgaG92ZXJTdHlsZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogcmVtb3ZlIGNsYXNzIHRvIHJlbW92ZSB0aGUgaGlnaGxpZ2h0LlxuICAgICAqXG4gICAgICogQHBhcmFtIGV2XG4gICAgICovXG4gICAgcHJpdmF0ZSBfb25JbnNwZWN0b3JNb3VzZUxlYXZlKGV2OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGV2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBmb3IgKGNvbnN0IGluc3BlY3RlZCBvZiB0aGlzLl9ob3ZlcmVkVGFyZ2V0cykge1xuICAgICAgICAgICAgaWYgKGluc3BlY3RlZC5lbGVtZW50ID09PSBldi50YXJnZXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9ob3ZlcmVkVGFyZ2V0cy5zcGxpY2UodGhpcy5faG92ZXJlZFRhcmdldHMuaW5kZXhPZihpbnNwZWN0ZWQpLCAxKTtcbiAgICAgICAgICAgICAgICBpbnNwZWN0ZWQuZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgaW5zcGVjdGVkLm9sZFN0eWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQcmV2ZW50IGRlZmF1bHQgYmVoYXZpb3IgKGRvbUVkaXRhYmxlIG5vcm1hbGlzYXRpb24pLlxuICAgICAqXG4gICAgICogQHBhcmFtIGV2XG4gICAgICovXG4gICAgcHJpdmF0ZSBfb25JbnNwZWN0b3JNb3VzZURvd24oZXY6IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgZXYuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICAgIHByaXZhdGUgX2dldE5vZGVGcm9tUG9zaXRpb24oY2xpZW50WDogbnVtYmVyLCBjbGllbnRZOiBudW1iZXIpOiBWTm9kZVtdIHtcbiAgICAgICAgY29uc3QgY2FyZXRQb3NpdGlvbiA9IGNhcmV0UG9zaXRpb25Gcm9tUG9pbnQoY2xpZW50WCwgY2xpZW50WSk7XG4gICAgICAgIGxldCBub2RlID0gY2FyZXRQb3NpdGlvbj8ub2Zmc2V0Tm9kZTtcbiAgICAgICAgbGV0IG5vZGVzID0gW107XG4gICAgICAgIHdoaWxlICghbm9kZXMubGVuZ3RoICYmIG5vZGUpIHtcbiAgICAgICAgICAgIG5vZGVzID0gdGhpcy5kb21FbmdpbmUuZ2V0Tm9kZXMobm9kZSk7XG4gICAgICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2Rlcy5sZW5ndGggJiYgbm9kZXNbMF0uaXMoQ2hhck5vZGUpICYmIG5vZGVzW2NhcmV0UG9zaXRpb24ub2Zmc2V0XSkge1xuICAgICAgICAgICAgcmV0dXJuIFtub2Rlc1tjYXJldFBvc2l0aW9uLm9mZnNldF1dO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VsZWN0IHRoZSB0YXJnZXRlZCBub2RlIGluIHRoZSBkZXZ0b29scyBpbnNwZWN0b3IgYW5kIHVuYmluZCB0aGUgbW91c2UgaGFuZGxlclxuICAgICAqXG4gICAgICogQHBhcmFtIGV2XG4gICAgICovXG4gICAgcHJpdmF0ZSBhc3luYyBfb25JbnNwZWN0b3JDbGljayhldjogTW91c2VFdmVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdGhpcy5fb25JbnNwZWN0b3JNb3VzZU1vdmUsIHRydWUpO1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIHRoaXMuX29uSW5zcGVjdG9yTW91c2VMZWF2ZSwgdHJ1ZSk7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9vbkluc3BlY3Rvck1vdXNlRG93biwgdHJ1ZSk7XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uSW5zcGVjdG9yQ2xpY2ssIHRydWUpO1xuICAgICAgICBldi5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZm9yIChjb25zdCBpbnNwZWN0ZWQgb2YgdGhpcy5faG92ZXJlZFRhcmdldHMpIHtcbiAgICAgICAgICAgIGluc3BlY3RlZC5lbGVtZW50LnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBpbnNwZWN0ZWQub2xkU3R5bGUpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX2hvdmVyZWRUYXJnZXRzID0gW107XG5cbiAgICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLl9nZXROb2RlRnJvbVBvc2l0aW9uKGV2LmNsaWVudFgsIGV2LmNsaWVudFkpO1xuICAgICAgICBpZiAobm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLnNlbGVjdGVkSUQgPSBub2Rlc1swXS5pZDtcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlID0gdGhpcy5nZXROb2RlKHRoaXMuc3RhdGUuc2VsZWN0ZWRJRCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBPd2xDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tb3dsL3NyYy91aS9Pd2xDb21wb25lbnQnO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgRm9ybWF0IH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvRm9ybWF0JztcblxuZXhwb3J0IGNsYXNzIFBhdGhDb21wb25lbnQgZXh0ZW5kcyBPd2xDb21wb25lbnQ8e30+IHtcbiAgICBnZXROb2RlUmVwcih2Tm9kZTogVk5vZGUpOiBzdHJpbmcge1xuICAgICAgICBsZXQgcmVwcjogc3RyaW5nID0gdk5vZGUubmFtZSB8fCAnPyc7XG4gICAgICAgIGZvciAoY29uc3QgZm9ybWF0IG9mIHZOb2RlLm1vZGlmaWVycy5maWx0ZXIoRm9ybWF0KSkge1xuICAgICAgICAgICAgcmVwciArPSAnLicgKyBmb3JtYXQubmFtZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVwcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVHJpZ2dlciBhICdub2RlLXNlbGVjdGVkJyBjdXN0b20gZXZlbnRcbiAgICAgKiB3aXRoIHRoZSBnaXZlbiBgdk5vZGVgIHRvIHNlbGVjdCBpdFxuICAgICAqXG4gICAgICogQHBhcmFtIHtWTm9kZX0gdk5vZGVcbiAgICAgKi9cbiAgICBzZWxlY3ROb2RlKHZOb2RlOiBWTm9kZSk6IHZvaWQge1xuICAgICAgICB0aGlzLnRyaWdnZXIoJ25vZGUtc2VsZWN0ZWQnLCB7XG4gICAgICAgICAgICB2Tm9kZTogdk5vZGUsXG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE93bENvbXBvbmVudCB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1vd2wvc3JjL3VpL093bENvbXBvbmVudCc7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgYXJnc1JlcHIgfSBmcm9tICcuLi91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBTaG9ydGN1dHNDb21wb25lbnQgZXh0ZW5kcyBPd2xDb21wb25lbnQ8e30+IHtcbiAgICBtYXBwaW5ncyA9IHRoaXMuZW52LmVkaXRvci5wbHVnaW5zXG4gICAgICAgIC5nZXQoS2V5bWFwKVxuICAgICAgICAubWFwcGluZ3MuZmxhdCgpXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgICAgICBpZiAoYS5jb25maWd1cmVkQ29tbWFuZC5jb21tYW5kSWQgPCBiLmNvbmZpZ3VyZWRDb21tYW5kLmNvbW1hbmRJZCkgcmV0dXJuIC0xO1xuICAgICAgICAgICAgaWYgKGEuY29uZmlndXJlZENvbW1hbmQuY29tbWFuZElkID4gYi5jb25maWd1cmVkQ29tbWFuZC5jb21tYW5kSWQpIHJldHVybiAxO1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0pO1xuICAgIGxvY2FsU3RvcmFnZSA9IFsnY3VycmVudFRhYiddO1xuICAgIGFyZ3NSZXByID0gYXJnc1JlcHI7XG4gICAgc3RyaW5naWZ5UGF0dGVybiA9IHRoaXMuZW52LmVkaXRvci5wbHVnaW5zLmdldChLZXltYXApLnN0cmluZ2lmeVBhdHRlcm47XG59XG4iLCJpbXBvcnQgeyB0b1VuaWNvZGUgfSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgT3dsQ29tcG9uZW50IH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLW93bC9zcmMvdWkvT3dsQ29tcG9uZW50JztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFZTZWxlY3Rpb25EZXNjcmlwdGlvbiwgRGlyZWN0aW9uIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvVlNlbGVjdGlvbic7XG5pbXBvcnQgeyBBTkNIT1JfQ0hBUiwgRk9DVVNfQ0hBUiB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL1ZTZWxlY3Rpb24nO1xuaW1wb3J0IHsgSW5saW5lTm9kZSB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZU5vZGUnO1xuaW1wb3J0IHsgQ29yZSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL0NvcmUnO1xuXG5pbnRlcmZhY2UgTm9kZVByb3BzIHtcbiAgICBpc1Jvb3Q6IGJvb2xlYW47XG4gICAgdk5vZGU6IFZOb2RlO1xuICAgIHNlbGVjdGVkUGF0aDogVk5vZGVbXTtcbn1cblxuaW50ZXJmYWNlIE5vZGVTdGF0ZSB7XG4gICAgZm9sZGVkOiBib29sZWFuO1xufVxuXG4vKipcbiAqIE5vdGU6IGBUcmVlQ29tcG9uZW50YCByZXF1aXJlcyB0aHJlZSBwcm9wZXJ0aWVzIHBhc3NlZCBieSB0aGUgcGFyZW50XG4gKiAgICAgICBDb21wb25lbnQgKGBEZXZUb29sc0NvbXBvbmVudGApIHZpYSB0aGUgdGVtcGxhdGUgKHNlZSBgRGV2VG9vbHMueG1sYCk6XG4gKiAgICAgICAtIHZOb2RlOiBWTm9kZVxuICogICAgICAgLSBpc1Jvb3Q6IGJvb2xlYW5cbiAqICAgICAgIC0gc2VsZWN0ZWRJRDogbnVtYmVyICh0aGUgSUQgb2YgdGhlIHNlbGVjdGVkIFZOb2RlKVxuICovXG5leHBvcnQgY2xhc3MgVHJlZUNvbXBvbmVudCBleHRlbmRzIE93bENvbXBvbmVudDxOb2RlUHJvcHM+IHtcbiAgICAvLyBUaGlzIGlzIGEgcmVjdXJzaXZlIENvbXBvbmVudDogZWFjaCBub2RlIG9mIHRoZSB0cmVlIGlzIGl0c2VsZiBhIHRyZWVcbiAgICBzdGF0aWMgY29tcG9uZW50cyA9IHsgVHJlZUNvbXBvbmVudCB9O1xuICAgIC8vIFVzZXItZnJpZW5kbHkgcmVwcmVzZW50YXRpb24gb2YgdGhlIG5vZGVcbiAgICBfcmVwcjogc3RyaW5nID0gdGhpcy5fZ2V0Tm9kZVJlcHIodGhpcy5wcm9wcy52Tm9kZSk7XG4gICAgc3RhdGU6IE5vZGVTdGF0ZSA9IHtcbiAgICAgICAgLy8gU2hvdyB0aGUgc2VsZWN0ZWQgbm9kZSBhbmQgcm9vdCBieSBkZWZhdWx0XG4gICAgICAgIGZvbGRlZDogIXRoaXMucHJvcHMuaXNSb290ICYmICF0aGlzLnByb3BzLnNlbGVjdGVkUGF0aC5pbmNsdWRlcyh0aGlzLnByb3BzLnZOb2RlKSxcbiAgICB9O1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSBgc3RhdGUuZm9sZGVkYCB3aGVuIGBwcm9wcy5zZWxlY3RlZFBhdGhgIGNoYW5nZXMgaWYgYHByb3BzLnZOb2RlYFxuICAgICAqIGlzIGluIGBwcm9wcy5zZWxlY3RlZFBhdGhgLCB1bmxlc3MgaXQgaXMgdGhlIGxhc3QgaXRlbS4gQWxzbyB1cGRhdGVcbiAgICAgKiBgc3RhdGUuZm9sZGVkYCBmb3IgdGhlIGFuY2VzdG9ycyBvZiB0aGUgc2VsZWN0aW9uIG1hcmtlciBub2Rlcy5cbiAgICAgKi9cbiAgICBhc3luYyB3aWxsVXBkYXRlUHJvcHMobmV4dFByb3BzOiBOb2RlUHJvcHMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gVGhlIHNlbGVjdGVkIG5vZGUgaXRzZWxmIHNob3VsZCBzdGF5IGZvbGRlZCBldmVuIHdoZW4gc2VsZWN0ZWQuIE9ubHlcbiAgICAgICAgLy8gdGhlIG5vZGVzIGluIHRoZSBwYXRoIGxlYWRpbmcgdG8gaXQgc2hvdWxkIGFjdHVhbGx5IGJlIHVuZm9sZGVkLiBCeVxuICAgICAgICAvLyBjb25zdHJ1Y3Rpb24sIHRoZSBsYXN0IGl0ZW0gb2YgYHNlbGVjdGVkIHBhdGhgIGlzIGFsd2F5cyB0aGUgc2VsZWN0ZWRcbiAgICAgICAgLy8gbm9kZSBpdHNlbGYgc28gaXQgY2FuIHNhZmVseSBiZSBvbWl0dGVkIGZyb20gdGhlIGNoZWNrLlxuICAgICAgICBjb25zdCBwYXRoID0gbmV4dFByb3BzLnNlbGVjdGVkUGF0aC5zbGljZSgwLCAtMSk7XG4gICAgICAgIGlmIChwYXRoLnNvbWUobm9kZSA9PiBub2RlLmlkID09PSBuZXh0UHJvcHMudk5vZGUuaWQpKSB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlLmZvbGRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbk1hcmtlcnNQYXRoID0gdGhpcy5fZ2V0U2VsZWN0aW9uTWFya2Vyc0FuY2VzdG9ycygpO1xuICAgICAgICBpZiAoc2VsZWN0aW9uTWFya2Vyc1BhdGguaGFzKG5leHRQcm9wcy52Tm9kZS5pZCkpIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZm9sZGVkID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgYSBjbGljayBldmVudCBvbiBhIG5vZGUgb2YgdGhlIHRyZWU6IHRvZ2dsZSBpdHMgZm9sZCBvbiBjbGljayBpdHNcbiAgICAgKiBjYXJldCwgc2VsZWN0IGl0IG90aGVyd2lzZVxuICAgICAqXG4gICAgICogQHBhcmFtIHtNb3VzZUV2ZW50fSBldmVudFxuICAgICAqL1xuICAgIG9uQ2xpY2tOb2RlKGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGRpZENsaWNrQ2FyZXQ6IGJvb2xlYW4gPSBldmVudC5vZmZzZXRYIDwgMTA7XG4gICAgICAgIGlmIChkaWRDbGlja0NhcmV0KSB7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUZvbGRlZCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdub2RlLXNlbGVjdGVkJywge1xuICAgICAgICAgICAgICAgIHZOb2RlOiB0aGlzLnByb3BzLnZOb2RlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgb25EYmxDbGlja05vZGUoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGxvY2F0aW9uOiBWU2VsZWN0aW9uRGVzY3JpcHRpb24gPSB7XG4gICAgICAgICAgICBhbmNob3JOb2RlOiB0aGlzLnByb3BzLnZOb2RlLFxuICAgICAgICAgICAgZm9jdXNOb2RlOiB0aGlzLnByb3BzLnZOb2RlLFxuICAgICAgICAgICAgZGlyZWN0aW9uOiBEaXJlY3Rpb24uRk9SV0FSRCxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5lbnYuZWRpdG9yLmV4ZWNDb21tYW5kPENvcmU+KCdzZXRTZWxlY3Rpb24nLCB7IHZTZWxlY3Rpb246IGxvY2F0aW9uIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgZm9sZGluZy91bmZvbGRpbmcgb24gcHJlc3MgRW50ZXJcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7S2V5Ym9hcmRFdmVudH0gZXZlbnRcbiAgICAgKi9cbiAgICBvbktleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKGV2ZW50LmNvZGUgPT09ICdFbnRlcicpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUZvbGRlZCgpO1xuICAgICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVwcigpOiBzdHJpbmcge1xuICAgICAgICBpZiAodGhpcy5wcm9wcy52Tm9kZS50YW5naWJsZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlcHI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBSZXByZXNlbnRhdGlvbiBvZiBpbnRhbmdpYmxlIG5vZGVzIChlLmcuIG1hcmtlcnMpIG1pZ2h0IGNoYW5nZVxuICAgICAgICAgICAgLy8gZGVwZW5kaW5nIG9uIHRoZSBjb250ZXh0IGluIHdoaWNoIHRoZXkgYXJlIHJlZmVyZW5jZWQsIGV2ZW5cbiAgICAgICAgICAgIC8vIHRob3VnaCB0aGV5IGRpZCBub3QgYWN0dWFsbHkgY2hhbmdlIHBlciBzZS5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9nZXROb2RlUmVwcih0aGlzLnByb3BzLnZOb2RlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbmZvbGQgYWxsIG9mIGEgbm9kZSdzIGRpcmVjdCBhbmNlc3RvcnMgb24gc2VsZWN0IGl0XG4gICAgICogVE9ETzogZmluZCBhIHdheSB0byBkbyB0aGlzIGNyb3NzLWNvbXBvbmVudHNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Q3VzdG9tRXZlbnR9IGV2ZW50XG4gICAgICovXG4gICAgc2VsZWN0Tm9kZShldmVudDogQ3VzdG9tRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKGV2ZW50LmRldGFpbC52Tm9kZS5pZCAhPT0gdGhpcy5wcm9wcy52Tm9kZS5pZCkge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS5mb2xkZWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBUb2dnbGUgdGhlIGBmb2xkZWRgIHByb3BvZXJ0eSBvZiB0aGUgc3RhdGVcbiAgICAgKi9cbiAgICB0b2dnbGVGb2xkZWQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuc3RhdGUuZm9sZGVkID0gIXRoaXMuc3RhdGUuZm9sZGVkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gbm9kZSBoYXMgdGhlIGdpdmVuIGZvcm1hdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgaXNGb3JtYXQobm9kZTogVk5vZGUsIGZvcm1hdE5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gbm9kZS5pcyhJbmxpbmVOb2RlKSAmJiAhIW5vZGUubW9kaWZpZXJzLmZpbmQoZm9ybWF0ID0+IGZvcm1hdC5uYW1lID09PSBmb3JtYXROYW1lKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIHVzZXItZnJpZW5kbHkgcmVwcmVzZW50YXRpb24gb2YgdGhlIG5vZGVcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Vk5vZGV9IG5vZGVcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICAqL1xuICAgIF9nZXROb2RlUmVwcihub2RlOiBWTm9kZSk6IHN0cmluZyB7XG4gICAgICAgIGlmIChub2RlID09PSB0aGlzLmVudi5lZGl0b3Iuc2VsZWN0aW9uLmFuY2hvcikge1xuICAgICAgICAgICAgcmV0dXJuIEFOQ0hPUl9DSEFSO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlID09PSB0aGlzLmVudi5lZGl0b3Iuc2VsZWN0aW9uLmZvY3VzKSB7XG4gICAgICAgICAgICByZXR1cm4gRk9DVVNfQ0hBUjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZS5uYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gdG9Vbmljb2RlKG5vZGUubmFtZSkucmVwbGFjZSgvTm9kZS8sICcnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJz8nO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBzZXQgb2YgdGhlIElEcyBvZiBhbGwgYW5jZXN0b3JzIG9mIGJvdGggc2VsZWN0aW9uIG1hcmtlciBub2Rlcy5cbiAgICAgKi9cbiAgICBfZ2V0U2VsZWN0aW9uTWFya2Vyc0FuY2VzdG9ycygpOiBTZXQ8bnVtYmVyPiB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbk1hcmtlcnNBbmNlc3RvcnMgPSBuZXcgU2V0PG51bWJlcj4oKTtcbiAgICAgICAgbGV0IGFuY2VzdG9yID0gdGhpcy5lbnYuZWRpdG9yLnNlbGVjdGlvbi5hbmNob3IucGFyZW50O1xuICAgICAgICB3aGlsZSAoYW5jZXN0b3IpIHtcbiAgICAgICAgICAgIHNlbGVjdGlvbk1hcmtlcnNBbmNlc3RvcnMuYWRkKGFuY2VzdG9yLmlkKTtcbiAgICAgICAgICAgIGFuY2VzdG9yID0gYW5jZXN0b3IucGFyZW50O1xuICAgICAgICB9XG4gICAgICAgIGFuY2VzdG9yID0gdGhpcy5lbnYuZWRpdG9yLnNlbGVjdGlvbi5mb2N1cy5wYXJlbnQ7XG4gICAgICAgIHdoaWxlIChhbmNlc3Rvcikge1xuICAgICAgICAgICAgc2VsZWN0aW9uTWFya2Vyc0FuY2VzdG9ycy5hZGQoYW5jZXN0b3IuaWQpO1xuICAgICAgICAgICAgYW5jZXN0b3IgPSBhbmNlc3Rvci5wYXJlbnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlbGVjdGlvbk1hcmtlcnNBbmNlc3RvcnM7XG4gICAgfVxufVxuIiwiZXhwb3J0IGZ1bmN0aW9uIGFyZ3NSZXByKGFyZ3M6IHt9KTogc3RyaW5nIHtcbiAgICBpZiAoYXJncyA9PT0gdW5kZWZpbmVkKSByZXR1cm4gJyc7XG4gICAgcmV0dXJuIGB7ICR7T2JqZWN0LmtleXMoYXJncylcbiAgICAgICAgLm1hcChrZXkgPT4ga2V5ICsgJzogJyArIGFyZ3Nba2V5XSlcbiAgICAgICAgLmpvaW4oJywgJyl9IH1gO1xufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IERpYWxvZ1pvbmVIdG1sRG9tUmVuZGVyZXIgfSBmcm9tICcuL3VpL0RpYWxvZ1pvbmVIdG1sRG9tUmVuZGVyZXInO1xuaW1wb3J0IHsgRGlhbG9nWm9uZVhtbERvbVBhcnNlciB9IGZyb20gJy4vdWkvRGlhbG9nWm9uZVhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgRG9tTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWRvbS1sYXlvdXQvc3JjL0RvbUxheW91dCc7XG5cbmV4cG9ydCBjbGFzcyBEaWFsb2c8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbUGFyc2VyLCBSZW5kZXJlciwgRG9tTGF5b3V0XTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlcj4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtEaWFsb2dab25lWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbRGlhbG9nWm9uZUh0bWxEb21SZW5kZXJlcl0sXG4gICAgfTtcbn1cbiIsInZhciBhcGkgPSByZXF1aXJlKFwiIS4uLy4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiKTtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gcmVxdWlyZShcIiEhLi4vLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9EaWFsb2cuY3NzXCIpO1xuXG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5fX2VzTW9kdWxlID8gY29udGVudC5kZWZhdWx0IDogY29udGVudDtcblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICBjb250ZW50ID0gW1ttb2R1bGUuaWQsIGNvbnRlbnQsICcnXV07XG4gICAgICAgICAgICB9XG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuaW5zZXJ0ID0gXCJoZWFkXCI7XG5vcHRpb25zLnNpbmdsZXRvbiA9IGZhbHNlO1xuXG52YXIgdXBkYXRlID0gYXBpKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG52YXIgZXhwb3J0ZWQgPSBjb250ZW50LmxvY2FscyA/IGNvbnRlbnQubG9jYWxzIDoge307XG5cblxuXG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydGVkOyIsIm1vZHVsZS5leHBvcnRzID0gXCI8anctZGlhbG9nPlxcbiAgICA8anctYmFja2Ryb3AgY2xhc3M9XFxcImp3LWNsb3NlXFxcIj48L2p3LWJhY2tkcm9wPlxcbiAgICA8anctY29udGVudD5cXG4gICAgICAgIDxqdy1idXR0b24gY2xhc3M9XFxcImp3LWNsb3NlXFxcIj7inYw8L2p3LWJ1dHRvbj5cXG4gICAgPC9qdy1jb250ZW50PlxcbjwvanctZGlhbG9nPlxcblwiIiwiaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL0Fic3RyYWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgRGlhbG9nWm9uZU5vZGUgfSBmcm9tICcuL0RpYWxvZ1pvbmVOb2RlJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB0ZW1wbGF0ZSBmcm9tICcuL0RpYWxvZy54bWwnO1xuaW1wb3J0ICcuL0RpYWxvZy5jc3MnO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IENvbXBvbmVudElkIH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0RW5naW5lJztcblxuY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnanctY29udGFpbmVyJyk7XG5jb250YWluZXIuaW5uZXJIVE1MID0gdGVtcGxhdGU7XG5jb25zdCBkaWFsb2cgPSBjb250YWluZXIuZmlyc3RFbGVtZW50Q2hpbGQ7XG5cbmV4cG9ydCBjbGFzcyBEaWFsb2dab25lSHRtbERvbVJlbmRlcmVyIGV4dGVuZHMgQWJzdHJhY3RSZW5kZXJlcjxOb2RlW10+IHtcbiAgICBzdGF0aWMgaWQgPSBIdG1sRG9tUmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogSHRtbERvbVJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSBEaWFsb2dab25lTm9kZTtcblxuICAgIGFzeW5jIHJlbmRlcihub2RlOiBEaWFsb2dab25lTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGZsb2F0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnanctZGlhbG9nLWNvbnRhaW5lcicpO1xuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG5vZGUuY2hpbGRWTm9kZXMpIHtcbiAgICAgICAgICAgIGlmICghbm9kZS5oaWRkZW4uZ2V0KGNoaWxkKSkge1xuICAgICAgICAgICAgICAgIGZsb2F0LmFwcGVuZENoaWxkKGF3YWl0IHRoaXMuX3JlbmRlckRpYWxvZyhjaGlsZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmbG9hdC5jaGlsZE5vZGVzLmxlbmd0aCA/IFtmbG9hdF0gOiBbZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpXTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIF9yZW5kZXJEaWFsb2cobm9kZTogVk5vZGUpOiBQcm9taXNlPEVsZW1lbnQ+IHtcbiAgICAgICAgY29uc3QgY2xvbmUgPSBkaWFsb2cuY2xvbmVOb2RlKHRydWUpIGFzIEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBjbG9uZS5xdWVyeVNlbGVjdG9yKCdqdy1jb250ZW50Jyk7XG4gICAgICAgIGZvciAoY29uc3QgZG9tTm9kZSBvZiBhd2FpdCB0aGlzLmVuZ2luZS5yZW5kZXIobm9kZSkpIHtcbiAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kQ2hpbGQoZG9tTm9kZSk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY29tcG9uZW50SWQ6IENvbXBvbmVudElkO1xuICAgICAgICBjb25zdCBjb21wb25lbnRzID0gdGhpcy5lbmdpbmUuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCkuZW5naW5lcy5kb20uY29tcG9uZW50cztcbiAgICAgICAgZm9yIChjb25zdCBbaWQsIG5vZGVzXSBvZiBjb21wb25lbnRzKSB7XG4gICAgICAgICAgICBpZiAobm9kZXMuaW5jbHVkZXMobm9kZSkpIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnRJZCA9IGlkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY2xvbmUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXY6IE1vdXNlRXZlbnQpOiB2b2lkID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldCA9IGV2LnRhcmdldCBhcyBFbGVtZW50O1xuICAgICAgICAgICAgaWYgKHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2p3LWNsb3NlJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IuZXhlY0NvbW1hbmQoJ2hpZGUnLCB7IGNvbXBvbmVudElEOiBjb21wb25lbnRJZCB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFpvbmVOb2RlIH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvWm9uZU5vZGUnO1xuXG5leHBvcnQgY2xhc3MgRGlhbG9nWm9uZU5vZGUgZXh0ZW5kcyBab25lTm9kZSB7fVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBEaWFsb2dab25lTm9kZSB9IGZyb20gJy4vRGlhbG9nWm9uZU5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgRGlhbG9nWm9uZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1QtRElBTE9HJztcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCB6b25lcyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGl0ZW0ucXVlcnlTZWxlY3RvckFsbCgndFt0LXpvbmVdJykpIHtcbiAgICAgICAgICAgIHpvbmVzLnB1c2goY2hpbGQuZ2V0QXR0cmlidXRlKCd0LXpvbmUnKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtuZXcgRGlhbG9nWm9uZU5vZGUoem9uZXMpXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBEaXZpZGVyWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9EaXZpZGVyWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5cbmV4cG9ydCBjbGFzcyBEaXZpZGVyPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbRGl2aWRlclhtbERvbVBhcnNlcl0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IFZFbGVtZW50IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZFbGVtZW50JztcblxuZXhwb3J0IGNsYXNzIERpdmlkZXJOb2RlIGV4dGVuZHMgVkVsZW1lbnQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcih7IGh0bWxUYWc6ICdESVYnIH0pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgRGl2aWRlck5vZGUgfSBmcm9tICcuL0RpdmlkZXJOb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIERpdmlkZXJYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgbm9kZU5hbWUoaXRlbSkgPT09ICdESVYnO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxEaXZpZGVyTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGRpdmlkZXIgPSBuZXcgRGl2aWRlck5vZGUoKTtcbiAgICAgICAgZGl2aWRlci5tb2RpZmllcnMuYXBwZW5kKHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKSk7XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgZGl2aWRlci5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW2RpdmlkZXJdO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IERvbUxheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1kb20tbGF5b3V0L3NyYy9Eb21MYXlvdXQnO1xuaW1wb3J0IHsgRGlyZWN0aW9uIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVlNlbGVjdGlvbic7XG5pbXBvcnQgeyBFdmVudE5vcm1hbGl6ZXIsIEV2ZW50QmF0Y2gsIE5vcm1hbGl6ZWRBY3Rpb24gfSBmcm9tICcuL0V2ZW50Tm9ybWFsaXplcic7XG5pbXBvcnQgeyBDb21tYW5kSWRlbnRpZmllciB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgSW5zZXJ0VGV4dFBhcmFtcyB9IGZyb20gJy4uLy4uL3BsdWdpbi1jaGFyL3NyYy9DaGFyJztcbmltcG9ydCB7IFZTZWxlY3Rpb25QYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Db3JlJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgeyBEb21MYXlvdXRFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4tZG9tLWxheW91dC9zcmMvdWkvRG9tTGF5b3V0RW5naW5lJztcbmltcG9ydCB7IEpXRWRpdG9yLCBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgUmVsYXRpdmVQb3NpdGlvbiwgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIERvbUVkaXRhYmxlQ29uZmlnIGV4dGVuZHMgSldQbHVnaW5Db25maWcge1xuICAgIGF1dG9Gb2N1cz86IGJvb2xlYW47XG4gICAgc291cmNlPzogSFRNTEVsZW1lbnQ7XG59XG5cbmV4cG9ydCBjbGFzcyBEb21FZGl0YWJsZTxUIGV4dGVuZHMgRG9tRWRpdGFibGVDb25maWcgPSBEb21FZGl0YWJsZUNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtEb21MYXlvdXQsIExheW91dF07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UmVuZGVyZXIgJiBMYXlvdXQgJiBEb21MYXlvdXQ+ID0ge1xuICAgICAgICByZW5kZXJlcnM6IFtdLFxuICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICdlZGl0YWJsZScsXG4gICAgICAgICAgICAgICAgcmVuZGVyOiBhc3luYyAoKTogUHJvbWlzZTxWTm9kZVtdPiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlRWxlbWVudCA9IHRoaXMuY29uZmlndXJhdGlvbi5zb3VyY2U7XG4gICAgICAgICAgICAgICAgICAgIGxldCByb290OiBWTm9kZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5kZXBlbmRlbmNpZXMuZ2V0KExheW91dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkb21MYXlvdXRFbmdpbmUgPSBsYXlvdXQuZW5naW5lcy5kb20gYXMgRG9tTGF5b3V0RW5naW5lO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZSA9IGF3YWl0IGRvbUxheW91dEVuZ2luZS5wYXJzZUVsZW1lbnQocGFyc2VFbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QgPSBub2RlWzBdO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcm9vdCA9IG5ldyBWRWxlbWVudCh7IGh0bWxUYWc6ICdqdy1lZGl0YWJsZScgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTZW1hbnRpYyBlbGVtZW50cyBhcmUgaW5saW5lIGJ5IGRlZmF1bHQuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGd1YXJhbnRlZSBpdCdzIGEgYmxvY2sgc28gaXQgY2FuIGNvbnRhaW5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIG90aGVyIGJsb2Nrcy5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5zZXQoJ3N0eWxlJywgJ2Rpc3BsYXk6IGJsb2NrOycpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJvb3QuZWRpdGFibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcm9vdC5icmVha2FibGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgcm9vdC5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnNldCgnY29udGVudEVkaXRhYmxlJywgJ3RydWUnKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZWRpdG9yLnNlbGVjdGlvbi5hbmNob3IucGFyZW50ICYmIHRoaXMuY29uZmlndXJhdGlvbi5hdXRvRm9jdXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNlbGVjdGlvbi5zZXRBdChyb290LCBSZWxhdGl2ZVBvc2l0aW9uLklOU0lERSk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW3Jvb3RdO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRab25lczogW1snZWRpdGFibGUnLCAnbWFpbiddXSxcbiAgICB9O1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBzZWxlY3RBbGw6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuc2VsZWN0QWxsLFxuICAgICAgICB9LFxuICAgIH07XG5cbiAgICBldmVudE5vcm1hbGl6ZXI6IEV2ZW50Tm9ybWFsaXplcjtcblxuICAgIGNvbnN0cnVjdG9yKGVkaXRvcjogSldFZGl0b3IsIGNvbmZpZ3VyYXRpb246IFQpIHtcbiAgICAgICAgc3VwZXIoZWRpdG9yLCBjb25maWd1cmF0aW9uKTtcbiAgICAgICAgdGhpcy5fcHJvY2Vzc0tleWRvd24gPSB0aGlzLl9wcm9jZXNzS2V5ZG93bi5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIGFzeW5jIHN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmV2ZW50Tm9ybWFsaXplciA9IG5ldyBFdmVudE5vcm1hbGl6ZXIoXG4gICAgICAgICAgICB0aGlzLl9pc0luRWRpdGFibGUuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIHRoaXMuX29uTm9ybWFsaXplZEV2ZW50LmJpbmQodGhpcyksXG4gICAgICAgICk7XG5cbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9wcm9jZXNzS2V5ZG93bik7XG4gICAgfVxuICAgIGFzeW5jIHN0b3AoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuZXZlbnROb3JtYWxpemVyLmRlc3Ryb3koKTtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9wcm9jZXNzS2V5ZG93bik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBzZWxlY3Rpb24gaW4gc3VjaCBhIHdheSB0aGF0IGl0IHNlbGVjdHMgdGhlIGVudGlyZSBkb2N1bWVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBzZWxlY3RBbGwoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGRvbUVuZ2luZSA9IHRoaXMuZGVwZW5kZW5jaWVzLmdldChMYXlvdXQpLmVuZ2luZXMuZG9tO1xuICAgICAgICBjb25zdCBlZGl0YWJsZSA9IGRvbUVuZ2luZS5jb21wb25lbnRzLmdldCgnZWRpdGFibGUnKVswXTtcbiAgICAgICAgdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnNldCh7XG4gICAgICAgICAgICBhbmNob3JOb2RlOiBlZGl0YWJsZS5maXJzdExlYWYoKSxcbiAgICAgICAgICAgIGFuY2hvclBvc2l0aW9uOiBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSxcbiAgICAgICAgICAgIGZvY3VzTm9kZTogZWRpdGFibGUubGFzdExlYWYoKSxcbiAgICAgICAgICAgIGZvY3VzUG9zaXRpb246IFJlbGF0aXZlUG9zaXRpb24uQUZURVIsXG4gICAgICAgICAgICBkaXJlY3Rpb246IERpcmVjdGlvbi5GT1JXQVJELFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIHByaXZhdGUgX2lzSW5FZGl0YWJsZSh0YXJnZXQ6IE5vZGUpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5kZXBlbmRlbmNpZXMuZ2V0KExheW91dCk7XG4gICAgICAgIGNvbnN0IGRvbUxheW91dEVuZ2luZSA9IGxheW91dC5lbmdpbmVzLmRvbSBhcyBEb21MYXlvdXRFbmdpbmU7XG4gICAgICAgIGxldCBub2RlcyA9IGRvbUxheW91dEVuZ2luZS5nZXROb2Rlcyh0YXJnZXQpO1xuICAgICAgICB3aGlsZSAoIW5vZGVzLmxlbmd0aCAmJiB0YXJnZXQpIHtcbiAgICAgICAgICAgIGlmICh0YXJnZXQucHJldmlvdXNTaWJsaW5nKSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub2RlcyA9IGRvbUxheW91dEVuZ2luZS5nZXROb2Rlcyh0YXJnZXQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5vZGUgPSBub2Rlcz8ucG9wKCk7XG4gICAgICAgIGNvbnN0IGFuY2VzdG9yQ29udGVudEVkaXRhYmxlID0gbm9kZT8uY2xvc2VzdChcbiAgICAgICAgICAgIG5vZGUgPT4gISFub2RlLm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpPy5nZXQoJ2NvbnRlbnRFZGl0YWJsZScpLFxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgYW5jZXN0b3JDb250ZW50RWRpdGFibGU/Lm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpLmdldCgnY29udGVudEVkaXRhYmxlJykgPT09ICd0cnVlJ1xuICAgICAgICApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZSB0aGUgcmVjZWl2ZWQgc2lnbmFsIGFuZCBkaXNwYXRjaCB0aGUgY29ycmVzcG9uZGluZyBlZGl0b3IgY29tbWFuZCxcbiAgICAgKiBiYXNlZCBvbiB0aGUgdXNlcidzIGNvbmZpZ3VyYXRpb24gYW5kIGNvbnRleHQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gYWN0aW9uXG4gICAgICovXG4gICAgcHJpdmF0ZSBfbWF0Y2hDb21tYW5kKGFjdGlvbjogTm9ybWFsaXplZEFjdGlvbik6IFtDb21tYW5kSWRlbnRpZmllciwgb2JqZWN0XSB7XG4gICAgICAgIHN3aXRjaCAoYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgJ2luc2VydExpbmVCcmVhayc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsnaW5zZXJ0TGluZUJyZWFrJywge31dO1xuICAgICAgICAgICAgY2FzZSAnaW5zZXJ0VGV4dCc6XG4gICAgICAgICAgICBjYXNlICdpbnNlcnRIdG1sJzoge1xuICAgICAgICAgICAgICAgIGNvbnN0IHBhcmFtczogSW5zZXJ0VGV4dFBhcmFtcyA9IHsgdGV4dDogYWN0aW9uLnRleHQgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gWydpbnNlcnRUZXh0JywgcGFyYW1zXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ3NlbGVjdEFsbCc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsnc2VsZWN0QWxsJywge31dO1xuICAgICAgICAgICAgY2FzZSAnc2V0U2VsZWN0aW9uJzoge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxheW91dCA9IHRoaXMuZGVwZW5kZW5jaWVzLmdldChMYXlvdXQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRvbUxheW91dEVuZ2luZSA9IGxheW91dC5lbmdpbmVzLmRvbSBhcyBEb21MYXlvdXRFbmdpbmU7XG4gICAgICAgICAgICAgICAgY29uc3QgdlNlbGVjdGlvblBhcmFtczogVlNlbGVjdGlvblBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgdlNlbGVjdGlvbjogZG9tTGF5b3V0RW5naW5lLnBhcnNlU2VsZWN0aW9uKGFjdGlvbi5kb21TZWxlY3Rpb24pLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsnc2V0U2VsZWN0aW9uJywgdlNlbGVjdGlvblBhcmFtc107XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlICdpbnNlcnRQYXJhZ3JhcGhCcmVhayc6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFsnaW5zZXJ0UGFyYWdyYXBoQnJlYWsnLCB7fV07XG4gICAgICAgICAgICBjYXNlICdkZWxldGVXb3JkJzpcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBleHRyYWN0IHJhbmdlXG4gICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5GT1JXQVJEKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbJ2RlbGV0ZUZvcndhcmQnLCB7IHJhbmdlOiB7fSB9XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWydkZWxldGVCYWNrd2FyZCcsIHsgcmFuZ2U6IHt9IH1dO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgJ2RlbGV0ZUNvbnRlbnQnOiB7XG4gICAgICAgICAgICAgICAgaWYgKGFjdGlvbi5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5GT1JXQVJEKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBbJ2RlbGV0ZUZvcndhcmQnLCB7fV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFsnZGVsZXRlQmFja3dhcmQnLCB7fV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGUgdGhlIHJlY2VpdmVkIHNpZ25hbCBhbmQgZGlzcGF0Y2ggdGhlIGNvcnJlc3BvbmRpbmcgZWRpdG9yIGNvbW1hbmQsXG4gICAgICogYmFzZWQgb24gdGhlIHVzZXIncyBjb25maWd1cmF0aW9uIGFuZCBjb250ZXh0LlxuICAgICAqXG4gICAgICogQHBhcmFtIGJhdGNoUHJvbWlzZVxuICAgICAqL1xuICAgIGFzeW5jIF9vbk5vcm1hbGl6ZWRFdmVudChiYXRjaFByb21pc2U6IFByb21pc2U8RXZlbnRCYXRjaD4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWRpdG9yLm5leHRFdmVudE11dGV4KFxuICAgICAgICAgICAgYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGJhdGNoID0gYXdhaXQgYmF0Y2hQcm9taXNlO1xuICAgICAgICAgICAgICAgIGxldCBwcm9jZXNzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoYmF0Y2guaW5mZXJyZWRLZXlkb3duRXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZG9tTGF5b3V0ID0gdGhpcy5kZXBlbmRlbmNpZXMuZ2V0KERvbUxheW91dCk7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NlZCA9ICEhKGF3YWl0IGRvbUxheW91dC5wcm9jZXNzS2V5ZG93bihcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBLZXlib2FyZEV2ZW50KCdrZXlkb3duJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC4uLmJhdGNoLmluZmVycmVkS2V5ZG93bkV2ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGtleTogYmF0Y2guaW5mZXJyZWRLZXlkb3duRXZlbnQua2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IGJhdGNoLmluZmVycmVkS2V5ZG93bkV2ZW50LmNvZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghcHJvY2Vzc2VkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgYWN0aW9uIG9mIGJhdGNoLmFjdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29tbWFuZFNwZWMgPSB0aGlzLl9tYXRjaENvbW1hbmQoYWN0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29tbWFuZFNwZWMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5lZGl0b3IuZXhlY0NvbW1hbmQoLi4uY29tbWFuZFNwZWMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdpbXBvc3NpYmxlIHRvIGxhdW5jaCBhY3Rpb24nLCBhY3Rpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW4gRG9tTGF5b3V0LCBLZXlib2FyZEV2ZW50IGxpc3RlbmVyIHRvIGJlIGFkZGVkIHRvIHRoZSBET00gdGhhdCBjYWxsc1xuICAgICAqIGBleGVjQ29tbWFuZGAgaWYgdGhlIGtleXMgcHJlc3NlZCBtYXRjaCBvbmUgb2YgdGhlIHNob3J0Y3V0IHJlZ2lzdGVyZWRcbiAgICAgKiBpbiB0aGUga2V5bWFwLlxuICAgICAqIEluIGNhc2Ugb2YgdGhlIGtleWRvdyBhcmUgZGVmYXVsdFByZXZlbnRlZCBpdCdzIG1lYW5zIHdlIGV4ZWN1dGVkIGEgbmV3XG4gICAgICogY29tbWFuZC4gV2Ugc3BsaXQgdGhlIGV2ZW50IGFncmFnYXRpb24gb2Ygbm9ybWFsaXplciB0byBlbnN1cmUgdG8gaGF2ZVxuICAgICAqIHRoZSBuZXh0IGV4ZWNDb21tYW5kIGF0IHRoZSByaWdodCB0aW1lLlxuICAgICAqXG4gICAgICogQHBhcmFtIGV2ZW50XG4gICAgICovXG4gICAgcHJpdmF0ZSBfcHJvY2Vzc0tleWRvd24oZXZlbnQ6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgaWYgKGV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuZXZlbnROb3JtYWxpemVyLmluaXROZXh0T2JzZXJ2YXRpb24oKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IERpcmVjdGlvbiB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZTZWxlY3Rpb24nO1xuaW1wb3J0IHsgTXV0YXRpb25Ob3JtYWxpemVyIH0gZnJvbSAnLi9NdXRhdGlvbk5vcm1hbGl6ZXInO1xuaW1wb3J0IHsgY2FyZXRQb3NpdGlvbkZyb21Qb2ludCwgZWxlbWVudEZyb21Qb2ludCB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy9wb2x5ZmlsbCc7XG5pbXBvcnQgeyB0YXJnZXREZWVwZXN0IH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL0RvbSc7XG5pbXBvcnQgeyBub2RlTmFtZSwgZ2V0RG9jdW1lbnQgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5jb25zdCBuYXZpZ2F0aW9uS2V5ID0gbmV3IFNldChbXG4gICAgJ0Fycm93VXAnLFxuICAgICdBcnJvd0Rvd24nLFxuICAgICdBcnJvd0xlZnQnLFxuICAgICdBcnJvd1JpZ2h0JyxcbiAgICAnUGFnZVVwJyxcbiAgICAnUGFnZURvd24nLFxuICAgICdFbmQnLFxuICAgICdIb21lJyxcbl0pO1xuXG5leHBvcnQgaW50ZXJmYWNlIERvbVNlbGVjdGlvbkRlc2NyaXB0aW9uIHtcbiAgICByZWFkb25seSBhbmNob3JOb2RlOiBOb2RlO1xuICAgIHJlYWRvbmx5IGFuY2hvck9mZnNldDogbnVtYmVyO1xuICAgIHJlYWRvbmx5IGZvY3VzTm9kZTogTm9kZTtcbiAgICByZWFkb25seSBmb2N1c09mZnNldDogbnVtYmVyO1xuICAgIHJlYWRvbmx5IGRpcmVjdGlvbjogRGlyZWN0aW9uO1xuICAgIG9yaWdpbj86IHN0cmluZzsgLy8gb3JpZ2luIG9mIHRoZSBzZWxlY3Rpb24gY2hhbmdlXG59XG5cbmNvbnN0IGlucHV0VHlwZUNvbW1hbmRzID0gbmV3IFNldChbXG4gICAgJ2hpc3RvcnlVbmRvJyxcbiAgICAnaGlzdG9yeVJlZG8nLFxuICAgICdmb3JtYXRCb2xkJyxcbiAgICAnZm9ybWF0SXRhbGljJyxcbiAgICAnZm9ybWF0VW5kZXJsaW5lJyxcbiAgICAnZm9ybWF0U3RyaWtlVGhyb3VnaCcsXG4gICAgJ2Zvcm1hdFN1cGVyc2NyaXB0JyxcbiAgICAnZm9ybWF0U3Vic2NyaXB0JyxcbiAgICAnZm9ybWF0SnVzdGlmeUZ1bGwnLFxuICAgICdmb3JtYXRKdXN0aWZ5Q2VudGVyJyxcbiAgICAnZm9ybWF0SnVzdGlmeVJpZ2h0JyxcbiAgICAnZm9ybWF0SnVzdGlmeUxlZnQnLFxuICAgICdmb3JtYXRJbmRlbnQnLFxuICAgICdmb3JtYXRPdXRkZW50JyxcbiAgICAnZm9ybWF0UmVtb3ZlJyxcbiAgICAnZm9ybWF0U2V0QmxvY2tUZXh0RGlyZWN0aW9uJyxcbiAgICAnZm9ybWF0U2V0SW5saW5lVGV4dERpcmVjdGlvbicsXG4gICAgJ2Zvcm1hdEJhY2tDb2xvcicsXG4gICAgJ2Zvcm1hdEZvbnRDb2xvcicsXG4gICAgJ2Zvcm1hdEZvbnROYW1lJyxcbl0pO1xuXG4vKlxuICogUmVnZXhwIHRvIHRlc3QgaWYgYSBjaGFyYWN0ZXIgaXMgd2l0aGluIGFuIGFscGhhYmV0IGtub3duIGJ5IHVzLlxuICpcbiAqIE5vdGU6IE5vdCBhbGwgYWxwaGFiZXRzIGFyZSB0YWtlbiBpbnRvIGNvbnNpZGVyYXRpb24gYW5kIHRoaXMgUmVnRXhwIGlzIHN1YmplY3QgdG8gYmUgY29tcGxldGVkXG4gKiAgICAgICBhcyBtb3JlIGFscGhhYmV0cyB3aWxsIGJlIGNvdmVyZWQuXG4gKlxuICogVW5pY29kZSByYW5nZSBzb3VyY2U6XG4gKiAtIHdpa2lwZWRpYVxuICogLSBnb29nbGUgdHJhbnNsYXRlXG4gKiAtIGh0dHBzOi8vanJncmFwaGl4Lm5ldC9yL1VuaWNvZGUvXG4gKlxuICogVG9vbCB0byBnZW5lcmF0ZSBSZWdFeHAgcmFuZ2U6XG4gKiAtIGh0dHBzOi8vYXBwcy50aW13aGl0bG9jay5pbmZvL2pzL3JlZ2V4XG4gKlxuICogVGhlIHN0cmF0ZWd5IGlzIHRvIHNlcGFyYXRlIGFueSB3b3JkIGJ5IHNlbGVjdGluZyBzdWJzZXF1ZW50IGNoYXJhY3RlcnMgb2YgYSBjb21tb24gYWxwaGFiZXQuXG4gKi9cbmNvbnN0IGFscGhhYmV0c0NvbnRhaW5pbmdTcGFjZXMgPSBuZXcgUmVnRXhwKFxuICAgICcoJyArXG4gICAgICAgIFtcbiAgICAgICAgICAgICdb0LAt0Y/QkC3Qr9CALdO/1IAt1K9dKycsIC8vIGN5cmlsbGljXG4gICAgICAgICAgICAnW82wLc++4byALeG/vl0rJywgLy8gZ3JlZWsgJiBjb3B0aWNcbiAgICAgICAgICAgICdbXFx1MDUzMC1cXHUwNThGXSsnLCAvLyBhcm1lbmlhblxuICAgICAgICAgICAgJ1tcXHUwNjAwLdu+3ZAt3b5cXHUwOGEwLVxcdTA4ZmVdKycsIC8vIGFyYWJpY1xuICAgICAgICAgICAgJ1tcXHUwOTAwLVxcdTBERkZdKycsIC8vIEluZGlhXG4gICAgICAgICAgICAnW2EtekEtWl0rJywgLy8gbGF0aW5cbiAgICAgICAgICAgICdbYS16QS1aw4Atw79dKycsIC8vIGxhdGluLTFcbiAgICAgICAgICAgICdbYS16QS1axIAtxb9dKycsIC8vIExhdGluIEV4dGVuZGVkLUFcbiAgICAgICAgICAgICdbYS16QS1axoAtyY9dKycsIC8vIExhdGluIEV4dGVuZGVkLUJcbiAgICAgICAgXS5qb2luKCd8JykgK1xuICAgICAgICAnKSQnLFxuKTtcblxuLyoqXG4gKiBUaGVzZSBqYXZhc2NyaXB0IGV2ZW50IHR5cGVzIG1pZ2h0LCBpbiBjYXNlIG9mIHNhZmFyaSBvciBzcGVsbC1jaGVja2luZ1xuICoga2V5Ym9hcmQsIHRyaWdnZXIgZG9tIGV2ZW50cyBpbiBtdWx0aXBsZSBqYXZhc2NyaXB0IHN0YWNrcy4gVGhleSB3aWxsIHJlcXVpcmVcbiAqIHRvIG9ic2VydmUgZXZlbnRzIGR1cmluZyB0d28gdGlja3MgcmF0aGVyIHRoYW4gYWZ0ZXIgYSBzaW5nbGUgdGljay5cbiAqL1xuY29uc3QgTXVsdGlTdGFja0V2ZW50VHlwZXMgPSBbJ2lucHV0JywgJ2NvbXBvc2l0aW9uZW5kJywgJ3NlbGVjdEFsbCddO1xuXG5pbnRlcmZhY2UgSW5zZXJ0VGV4dEFjdGlvbiB7XG4gICAgdHlwZTogJ2luc2VydFRleHQnO1xuICAgIHRleHQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIEluc2VydEh0bWxBY3Rpb24ge1xuICAgIHR5cGU6ICdpbnNlcnRIdG1sJztcbiAgICBodG1sOiBzdHJpbmc7XG4gICAgdGV4dDogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgSW5zZXJ0UGFyYWdyYXBoQnJlYWtBY3Rpb24ge1xuICAgIHR5cGU6ICdpbnNlcnRQYXJhZ3JhcGhCcmVhayc7XG59XG5cbmludGVyZmFjZSBJbnNlcnRMaW5lQnJlYWtBY3Rpb24ge1xuICAgIHR5cGU6ICdpbnNlcnRMaW5lQnJlYWsnO1xufVxuXG5pbnRlcmZhY2UgSW5zZXJ0RmlsZXNBY3Rpb24ge1xuICAgIHR5cGU6ICdpbnNlcnRGaWxlcyc7XG4gICAgZmlsZXM6IEZpbGVbXTtcbn1cblxuaW50ZXJmYWNlIERlbGV0ZUNvbnRlbnRBY3Rpb24ge1xuICAgIHR5cGU6ICdkZWxldGVDb250ZW50JztcbiAgICBkaXJlY3Rpb246IERpcmVjdGlvbjtcbn1cbmV4cG9ydCBpbnRlcmZhY2UgRGVsZXRlV29yZEFjdGlvbiB7XG4gICAgdHlwZTogJ2RlbGV0ZVdvcmQnO1xuICAgIGRpcmVjdGlvbjogRGlyZWN0aW9uO1xuICAgIHRleHQ6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIERlbGV0ZUhhcmRMaW5lQWN0aW9uIHtcbiAgICB0eXBlOiAnZGVsZXRlSGFyZExpbmUnO1xuICAgIGRpcmVjdGlvbjogRGlyZWN0aW9uO1xuICAgIGRvbVNlbGVjdGlvbjogRG9tU2VsZWN0aW9uRGVzY3JpcHRpb247XG59XG5cbmludGVyZmFjZSBTZWxlY3RBbGxBY3Rpb24ge1xuICAgIHR5cGU6ICdzZWxlY3RBbGwnO1xufVxuXG5pbnRlcmZhY2UgU2V0U2VsZWN0aW9uQWN0aW9uIHtcbiAgICB0eXBlOiAnc2V0U2VsZWN0aW9uJztcbiAgICBkb21TZWxlY3Rpb246IERvbVNlbGVjdGlvbkRlc2NyaXB0aW9uO1xufVxuXG5pbnRlcmZhY2UgQXBwbHlGb3JtYXRBY3Rpb24ge1xuICAgIHR5cGU6ICdhcHBseUZvcm1hdCc7XG4gICAgZm9ybWF0OiBzdHJpbmc7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBkYXRhOiBhbnk7XG59XG5cbmludGVyZmFjZSBIaXN0b3J5QWN0aW9uIHtcbiAgICB0eXBlOiAnaGlzdG9yeVVuZG8nIHwgJ2hpc3RvcnlSZWRvJztcbn1cblxuZXhwb3J0IHR5cGUgTm9ybWFsaXplZEFjdGlvbiA9XG4gICAgfCBJbnNlcnRUZXh0QWN0aW9uXG4gICAgfCBJbnNlcnRIdG1sQWN0aW9uXG4gICAgfCBJbnNlcnRMaW5lQnJlYWtBY3Rpb25cbiAgICB8IEluc2VydFBhcmFncmFwaEJyZWFrQWN0aW9uXG4gICAgfCBJbnNlcnRGaWxlc0FjdGlvblxuICAgIHwgRGVsZXRlQ29udGVudEFjdGlvblxuICAgIHwgRGVsZXRlV29yZEFjdGlvblxuICAgIHwgRGVsZXRlSGFyZExpbmVBY3Rpb25cbiAgICB8IFNlbGVjdEFsbEFjdGlvblxuICAgIHwgU2V0U2VsZWN0aW9uQWN0aW9uXG4gICAgfCBBcHBseUZvcm1hdEFjdGlvblxuICAgIHwgSGlzdG9yeUFjdGlvbjtcblxuZXhwb3J0IGludGVyZmFjZSBDYXJldFBvc2l0aW9uIHtcbiAgICBvZmZzZXROb2RlOiBOb2RlO1xuICAgIG9mZnNldDogbnVtYmVyO1xufVxuXG4vKipcbiAqIFRoZSBtb2RpZmllcnMga2V5cyBiZWluZyBwdXNoZWQgYXQgYSBwYXJ0aWN1bGFyIHRpbWUuXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgTW9kaWZpZXJLZXlzIHtcbiAgICBjdHJsS2V5OiBib29sZWFuO1xuICAgIGFsdEtleTogYm9vbGVhbjtcbiAgICBtZXRhS2V5OiBib29sZWFuO1xuICAgIHNoaWZ0S2V5OiBib29sZWFuO1xufVxuXG4vKipcbiAqIFRoZSBjb2RlIHRoYXQgd2UgaW5mZXIgZm9yIHZpcnR1YWwga2V5Ym9hcmQgdGhhdCBkbyBub3QgcHJvdmlkZSB0aGVtLlxuICovXG50eXBlIEluZmVycmVkQ29kZVZhbHVlID0gJ0VudGVyJyB8ICdCYWNrc3BhY2UnIHwgJ0RlbGV0ZSc7XG5cbi8qKlxuICogVGhlIGluZmVyZWQga2V5ZG93biBldmVudCBmb3IgdmlydHVhbCBrZWJvYXJkLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEluZmVycmVkS2V5ZG93bkV2ZW50IGV4dGVuZHMgTW9kaWZpZXJLZXlzIHtcbiAgICBrZXk6IEluZmVycmVkQ29kZVZhbHVlO1xuICAgIGNvZGU6IEluZmVycmVkQ29kZVZhbHVlO1xufVxuXG4vKipcbiAqIE9uZSBldmVudEJhdGNoIGNvbnRhaW4gYWxsIGVsZW1lbnQgYmVpbmcgdHJpZ2dlcmVkIGFuZCBub3JtYWxpemVkIGZyb20gb25lIG9yIG1vcmUgZXZlbnRzIHN0YWNrc1xuICogKGluIGNhc2Ugb2Ygc2FmYXJpKVxuICovXG5leHBvcnQgaW50ZXJmYWNlIEV2ZW50QmF0Y2gge1xuICAgIC8vIFdlIGN1cnJlbnRseSBvbmx5IG5lZWQgYW4gYXJyYXkgb2YgZXZlbnQgaW4gY2FzZSBvZiBtdWx0aWtleXByZXNzLlxuICAgIGFjdGlvbnM6IE5vcm1hbGl6ZWRBY3Rpb25bXTtcbiAgICBtdXRhdGVkRWxlbWVudHM/OiBTZXQ8Tm9kZT47XG4gICAgLyoqXG4gICAgICogSW4gdGhlIGNhc2Ugb2YgdmlydHVhbCBrZXlib2FyZCwgaW5mZXIgdGhlIGtleSBiZWluZyBwdXNoZWQgZm9yICdFbnRlcicsXG4gICAgICogJ0JhY2tzcGFjZScsICdEZWxldGUnLlxuICAgICAqL1xuICAgIGluZmVycmVkS2V5ZG93bkV2ZW50PzogSW5mZXJyZWRLZXlkb3duRXZlbnQ7XG59XG5cbmludGVyZmFjZSBEYXRhVHJhbnNmZXJEZXRhaWxzIHtcbiAgICB0eXBlOiAnZHJvcCcgfCAncGFzdGUnIHwgJ2N1dCc7XG4gICAgJ3RleHQvcGxhaW4nOiBzdHJpbmc7XG4gICAgJ3RleHQvaHRtbCc6IHN0cmluZztcbiAgICAndGV4dC91cmktbGlzdCc6IHN0cmluZztcbiAgICBmaWxlczogRmlsZVtdO1xuICAgIG9yaWdpbmFsRXZlbnQ6IEV2ZW50O1xuICAgIGRyYWdnaW5nRnJvbUVkaXRhYmxlOiBib29sZWFuO1xuICAgIGNhcmV0UG9zaXRpb246IENhcmV0UG9zaXRpb247XG4gICAgc2VsZWN0aW9uOiBEb21TZWxlY3Rpb25EZXNjcmlwdGlvbjtcbn1cbi8qKlxuICogVGhlIGV2ZW50IHRvIHByb2Nlc3MgaW4gYF9wcm9jZXNzRXZlbnRzYCBjb3VsZCBiZSBhIG5hdGl2ZSBgRXZlbnRgIG9yIGEgY3VzdG9tIGV2ZW50IHRoYXQgd2VcbiAqIGNyZWF0ZWQgKGBEYXRhVHJhbnNmZXJEZXRhaWxzYCkuXG4gKi9cbnR5cGUgRXZlbnRUb1Byb2Nlc3MgPSBFdmVudCB8IERhdGFUcmFuc2ZlckRldGFpbHM7XG5cbmludGVyZmFjZSBFdmVudExpc3RlbmVyRGVjbGFyYXRpb24ge1xuICAgIHJlYWRvbmx5IHRhcmdldDogRG9jdW1lbnQgfCBTaGFkb3dSb290O1xuICAgIHJlYWRvbmx5IHR5cGU6IHN0cmluZztcbiAgICByZWFkb25seSBsaXN0ZW5lcjogRXZlbnRMaXN0ZW5lcjtcbn1cblxuaW50ZXJmYWNlIENvbXBvc2l0aW9uRGF0YSB7XG4gICAgY29tcG9zaXRpb25Gcm9tOiBzdHJpbmc7XG4gICAgY29tcG9zaXRpb25Ubzogc3RyaW5nO1xuICAgIGFjdGlvbnM6IE5vcm1hbGl6ZWRBY3Rpb25bXTtcbn1cblxuLyoqXG4gKiBPYmplY3QgY29udGFpbmluZyBhbGwgZXZlbnRzIHByZXNlbnQgaW4gb25lIHN0YWNrLlxuICovXG5pbnRlcmZhY2UgQ3VycmVudFN0YWNrT2JzZXJ2YXRpb25zIHtcbiAgICAvKipcbiAgICAgKiBFdmVudHMgZmlyZWQgZHVyaW5nIHRoZSBjdXJyZW50IHRpY2suXG4gICAgICogX2V2ZW50cyB3aXRoIHZhbHVlIG51bGwgbWVhbiB0aGF0IHdlIGFyZSBub3QgY3VycmVudGx5IG9ic2VydmluZyBjaGFuZ2VzLlxuICAgICAqL1xuICAgIF9ldmVudHM6IEV2ZW50VG9Qcm9jZXNzW107XG4gICAgLyoqXG4gICAgICogTWFwIGlzIHVzZWQgdG8gZ2F0aGVyIGluZm9ybWF0aW9ucyB3aGVuIG11bHRpcGxlcyBrZXlzIGFyZSBmb3VuZCBpbiB0aGVcbiAgICAgKiBzYW1lIHN0YWNrLlxuICAgICAqL1xuICAgIF9tdWx0aUtleVN0YWNrOiB7XG4gICAgICAgIGtleWRvd24/OiBLZXlib2FyZEV2ZW50O1xuICAgICAgICBrZXlwcmVzcz86IEtleWJvYXJkRXZlbnQ7XG4gICAgICAgIGlucHV0PzogSW5wdXRFdmVudDtcbiAgICB9W107XG4gICAgLyoqXG4gICAgICogTWFwIHVzZWQgdG8gY29sbGVjdCBpbmZvcm1hdGlvbiBhYm91dCB0aGUgbGFzdCBldmVudHMgb2YgYSB0eXBlIHRoYXRcbiAgICAgKiBoYXBwZW5lZCBpbiBvbmUgb3IgdHdvIHRpY2tzLlxuICAgICAqL1xuICAgIF9ldmVudHNNYXA6IHtcbiAgICAgICAga2V5ZG93bj86IEtleWJvYXJkRXZlbnQ7XG4gICAgICAgIGtleXByZXNzPzogS2V5Ym9hcmRFdmVudDtcbiAgICAgICAgaW5wdXQ/OiBJbnB1dEV2ZW50O1xuICAgICAgICBsYXN0Q29tcG9zaXRpb24/OiBDb21wb3NpdGlvbkV2ZW50O1xuICAgICAgICBjb21wb3NpdGlvbnN0YXJ0PzogQ29tcG9zaXRpb25FdmVudDtcbiAgICAgICAgY29tcG9zaXRpb251cGRhdGU/OiBDb21wb3NpdGlvbkV2ZW50O1xuICAgICAgICBjb21wb3NpdGlvbmVuZD86IENvbXBvc2l0aW9uRXZlbnQ7XG4gICAgICAgIGN1dD86IERhdGFUcmFuc2ZlckRldGFpbHM7XG4gICAgICAgIGRyb3A/OiBEYXRhVHJhbnNmZXJEZXRhaWxzO1xuICAgICAgICBwYXN0ZT86IERhdGFUcmFuc2ZlckRldGFpbHM7XG4gICAgICAgIGtleWJvYXJkU2VsZWN0QWxsPzogQ3VzdG9tRXZlbnQ7XG4gICAgfTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBwcm9taXNlIHRoYXQgcmVzb2x2ZSBvbmNlIGEgdGltZW91dCBmaW5pc2ggb3Igd2hlbiBjYWxsaW5nXG4gKiBgZXhlY3V0ZUFuZENsZWFyYC5cbiAqL1xuY2xhc3MgVGltZW91dDxUID0gdm9pZD4ge1xuICAgIGlkOiBudW1iZXI7XG4gICAgcGVuZGluZyA9IHRydWU7XG4gICAgcHJvbWlzZTogUHJvbWlzZTxUPjtcbiAgICBwcml2YXRlIF9yZXNvbHZlOiBGdW5jdGlvbjtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBmbjogKCkgPT4gVCB8IFByb21pc2U8VD4sIGludGVydmFsID0gMCkge1xuICAgICAgICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgICAgICAgICB0aGlzLmlkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGVuZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJlc29sdmUoZm4oKSk7XG4gICAgICAgICAgICB9LCBpbnRlcnZhbCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBmaXJlKHJlc3VsdD86IFQpOiB2b2lkIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuaWQpO1xuICAgICAgICB0aGlzLnBlbmRpbmcgPSBmYWxzZTtcbiAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fcmVzb2x2ZSh0aGlzLmZuKCkpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG50eXBlIFRyaWdnZXJFdmVudEJhdGNoQ2FsbGJhY2sgPSAoYmF0Y2g6IFByb21pc2U8RXZlbnRCYXRjaD4pID0+IHZvaWQ7XG5cbi8qKlxuICogIyMgVGhlIHByb2JsZW1zIHRoZSBub3JtYWxpemVyIHNvbHZlXG4gKiBCcm93c2VyIGFuZCB2aXJ0dWFsIGtleWJvYXJkcyBvbiBtb2JpbGUgZG9lcyBub3QgaW1wbGVtZW50IHByb3Blcmx5IHRoZSB3M2NcbiAqIGNvbnRlbnRlZGl0YWJsZSBzcGVjaWZpY2F0aW9uIGFuZCBhcmUgaW5jb25zaXN0ZW50LlxuICpcbiAqICMjIEdvYWwgb2YgdGhlIG5vcm1hbGl6ZXJcbiAqIDEuIEhvb2sgYW55IGNoYW5nZSB0aGF0IGhhcHBlbmQgaW4gYW4gZWxlbWVudCBjYWxsZWQgdGhlIGBlZGl0YWJsZWAuXG4gKiAyLiBUcmlnZ2VyIHRoZSBzYW1lIGV2ZW50IGZvciB0aGUgc2FtZSBhY3Rpb24gYWNjcm9zcyBhbGwgYnJvd3NlcnMgYW5kXG4gKiAgICBkZXZpY2VzLlxuICpcbiAqICMjIFN0cmF0ZWd5XG4gKiBIb29rIGFsbCBqYXZhc2NyaXB0IGV2ZW50cyB0aGF0IG1vZGlmeSB0aGUgYGVkaXRhYmxlYCBlbGVtZW50LiBUaGVuLCB0cmlnZ2VyXG4gKiBub3JtYWxpemVkIGV2ZW50cy5cbiAqXG4gKiAjIyBIb3cgdG8gdXNlIHRoaXMgbm9ybWFsaXplcj9cbiAqIDEuIEphdmFzY3JpcHQgRXZlbnRzIG9jY3Vyc1xuICogMi4gTm9ybWFsaXplIGphdmFzY3JpcHQgb25lIG9yIG1vcmUgYEV2ZW50YCB0byBvbmUgb3IgbW9yZVxuICogICAgYE5vcm1hbGl6ZWRBY3Rpb25gLlxuICogMy4gVXBkYXRlIG91ciBgVkRvY3VtZW50YCBpbiByZWdhcmQgb2YgdHJpZ2dlcmVkIG5vcm1hbGl6ZWQgYWN0aW9ucy5cbiAqIDQuIFJlbmRlciB3aGF0IGNoYW5nZWQgaW4gdGhlIGBWRG9jdW1lbnRgIEhUTUwgaW4gdGhlIGBlZGl0YWJsZWAuXG4gKlxuICogVGhlIG5vcm1hbGl6ZXIgZG9lcyBub3QgcHJldmVudERlZmF1bHQgbW9zdCBvZiB0aGUgY2hhbmdlIGluIHRoZSBlZGl0YWJsZVxuICogaGFwcGVuICh0aGUgZXhjZXB0aW9uIGZvciBcInBhc3RlXCIgYW5kIFwiZHJvcFwiIGphdmFzY3JpcHQgZXZlbnQpLlxuICpcbiAqXG4gKiAjIyBIYW5kZWxpbmcgamF2YXNjcmlwdCBldmVudHNcbiAqIEEgamF2YXNjcmlwdCBldmVudCBpcyBhbG1vc3QgbmV2ZXIgcHJldmVudGVkIGFuZCBhbG1vc3QgYWx3YXlzIGFsdGVyIHRoZVxuICogZWRpdGFibGUgaW4gdGhlIERPTS5cbiAqXG4gKiBUaGUgcmVhc29uIHRoYXQgd2UgZG8gbm90IHByZXZlbnQgZGVmYXVsdCBpcyBiZWNhdXNlIHdlIG5lZWQgbW9yZVxuICogaW5mb3JtYXRpb25zLiBUaGUgaW5mb3JtYXRpb24gbW9kaWZpZWQgaW4gdGhlIGRvbSAoYnkgb2JzZXJ2aW5nIG9ic2VydmluZ1xuICogbXV0YXRpb25zKS5cbiAqXG4gKiBUaGVyZSBpcyBhbiBleGNlcHRpb24gZm9yIHRoZSBldmVudCAncGFzdGUnIGFuZCAnZHJvcCcuXG4gKlxuICogVGhlIHJlYXNvbiB0byBwcmV2ZW50RGVmYXVsdCAncGFzdGUnIGlzIGJlY2F1c2UgbW9zdCBvZiB0aGUgdGltZSwgYnJvd3NlcnNcbiAqIHBhc3RlIGNvbnRlbnQgdGhhdCBuZWVkIHRvIGJlIGNsZWFuZWQuIEZvciB0aGF0IHJlYXNvbiB3ZSBwcmV2ZW50IGl0IGZyb21cbiAqIGJlaW5nIGluc2VydGVkIGluIHRoZSBlZGl0YWJsZSBlbGVtZW50IGJ1dCB0aGUgaW5mb3JtYXRpb25zIGNhbiBiZSBmb3VuZCBpblxuICogdGhlIHRyaWdnZXJlZCBub3JtYWxpemVkIGV2ZW50cyBhY3Rpb25zLlxuICpcbiAqIFRoZSByZWFzb24gdG8gcHJldmVudERlZmF1bHQgJ2Ryb3AnIGlzIGJlY2F1c2Ugc29tZSBicm93c2VycyBjaGFuZ2UgcGFnZSB3aGVuXG4gKiBkcm9wcGluZyBhbiBpbWFnZSBvciBhbiB1cmwgdGhhdCBjb21lcyBmcm9tIHRoZSBhZGRyZXNzIGJhciAoZS5nLiBjaHJvbWUpLlxuICpcbiAqICMjIFN1cHBvcnRlZCBicm93c2VyIGFuZCB2aXJ0dWFsIGtleWJvYXJkXG4gKiAtIE1hY1xuICogICAtIENocm9tZVxuICogICAtIEZpcmVmb3hcbiAqICAgLSBFZGdlXG4gKiAgIC0gU2FmYXJpXG4gKiAtIFdpbmRvd3NcbiAqICAgLSBDaHJvbWVcbiAqICAgLSBGaXJlZm94XG4gKiAgIC0gRWRnZVxuICogICAtIFNhZmFyaVxuICogLSBMaW51eFxuICogICAtIENocm9tZVxuICogICAtIEZpcmVmb3hcbiAqIC0gQW5kcm9pZFxuICogICAtIENocm9tZVxuICogICAtIEZpcmVmb3hcbiAqICAgLSBHb29nbGUga2V5Ym9hcmRcbiAqICAgLSBTd2lmdCBrZXlib2FyZFxuICogLSBJT1NcbiAqICAgLSBTYWZhcmlcbiAqICAgLSBDaHJvbWVcbiAqICAgLSBGaXJlZm94XG4gKi9cbmV4cG9ydCBjbGFzcyBFdmVudE5vcm1hbGl6ZXIge1xuICAgIC8qKlxuICAgICAqIEV2ZW50IGxpc3RlbmVycyB0aGF0IGFyZSBib3VuZCBpbiB0aGUgRE9NIGJ5IHRoZSBub3JtYWxpemVyIG9uIGNyZWF0aW9uXG4gICAgICogYW5kIHVuYm91bmQgb24gZGVzdHJveS5cbiAgICAgKi9cbiAgICBfZXZlbnRMaXN0ZW5lcnM6IEV2ZW50TGlzdGVuZXJEZWNsYXJhdGlvbltdID0gW107XG4gICAgLyoqXG4gICAgICogVGhlIE11dGF0aW9uTm9ybWFsaXplciB1c2VkIGJ5IHRoZSBub3JtYWxpemVyIHRvIHdhdGNoIHRoZSBub2RlcyB0aGF0IGFyZVxuICAgICAqIGJlaW5nIG1vZGlmaWVkIHNpbmNlIHRoZSBub3JtYWxpemVyIGNyZWF0aW9uIHVudGlsIGl0IGlzIGRyZXN0cm95ZWQuXG4gICAgICovXG4gICAgX211dGF0aW9uTm9ybWFsaXplcjogTXV0YXRpb25Ob3JtYWxpemVyO1xuXG4gICAgY3VycmVudFN0YWNrT2JzZXJ2YXRpb246IEN1cnJlbnRTdGFja09ic2VydmF0aW9ucztcblxuICAgIC8qKlxuICAgICAqIFVzZWQgaW4gYF9vblNlbGVjdGlvbkNoYW5nZWAgZm9yIHRoZSBoZXVyaXNpYyB0aGF0IGNoZWNrIGlmIHdlIG1pZ2h0XG4gICAgICogc2VsZWN0IGFsbCB0aGUgYGVkaXRhYmxlYFxuICAgICAqL1xuICAgIF9mb2xsb3dzUG9pbnRlckFjdGlvbjogYm9vbGVhbjtcbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIHRoZSBjdXJyZW50IHN0YXRlIG9mIHRoZSBzZWxlY3Rpb24gaXMgYWxyZWFkeSByZWNvZ25pemVkIGFzIGJlaW5nXG4gICAgICogYSBcInNlbGVjdCBhbGxcIi5cbiAgICAgKi9cbiAgICBfY3VycmVudGx5U2VsZWN0aW5nQWxsOiBib29sZWFuO1xuICAgIC8qKlxuICAgICAqIE9yaWdpbmFsIG1vdXNlZG93biBldmVudCBmcm9tIHdoaWNoIHRoZSBjdXJyZW50IHNlbGVjdGlvbiB3YXMgbWFkZS5cbiAgICAgKi9cbiAgICBfbW91c2Vkb3duSW5FZGl0YWJsZTogYm9vbGVhbjtcbiAgICAvKipcbiAgICAgKiBPcmlnaW5hbCBzZWxlY3Rpb24gdGFyZ2V0IGJlZm9yZSB0aGUgY3VycmVudCBzZWxlY3Rpb24gaXMgdXBkYXRlZC5cbiAgICAgKi9cbiAgICBfaW5pdGlhbENhcmV0UG9zaXRpb246IENhcmV0UG9zaXRpb247XG4gICAgLyoqXG4gICAgICogU2V0IHRvIHRydWUgd2hlbiBgX29uU2VsZWN0aW9uQ2hhbmdlYC4gSWYgc2V0LCBkb24ndCBwcm9jZXNzXG4gICAgICogYF9vbkNvbnRleHRNZW51YC5cbiAgICAgKi9cbiAgICBfc2VsZWN0aW9uSGFzQ2hhbmdlZDogYm9vbGVhbjtcbiAgICAvKipcbiAgICAgKiBXaGV0aGVyIHRoZSBjdXJyZW50IGRyYWdnaW5nIG9wZXJhdGlvbiBzdGFydGVkIGZyb20gaW5zaWRlIHRoZSBlZGl0YWJsZS5cbiAgICAgKiBGYWxzZSBpZiB0aGUgZHJhZ2dpbmcgc3RhcnRlZCBvdXRzaWRlIG9mIHRoZSBlZGl0YWJsZS5cbiAgICAgKi9cbiAgICBfZHJhZ2dpbmdGcm9tRWRpdGFibGU6IGJvb2xlYW47XG4gICAgLyoqXG4gICAgICogQ2FjaGUgdGhlIHN0YXRlIG9mIG1vZGlmaWVycyBrZXlzIG9uIGVhY2gga2V5c3Ryb2tlcy5cbiAgICAgKi9cbiAgICBfbW9kaWZpZXJLZXlzOiBNb2RpZmllcktleXMgPSB7XG4gICAgICAgIGN0cmxLZXk6IGZhbHNlLFxuICAgICAgICBhbHRLZXk6IGZhbHNlLFxuICAgICAgICBtZXRhS2V5OiBmYWxzZSxcbiAgICAgICAgc2hpZnRLZXk6IGZhbHNlLFxuICAgIH07XG4gICAgLyoqXG4gICAgICogVGhlIGN1cnJlbnQgc2VsZWN0aW9uIGhhcyB0byBiZSBvYnNlcnZlZCBhcyBhIHJlc3VsdCBvZiBhIG1vdXNlZG93biBiZWluZ1xuICAgICAqIHRyaWdnZXJlZC4gSG93ZXZlciwgdGhpcyBjYW5ub3QgYmUgZG9uZSBhdCB0aGUgdGltZSBvZiB0aGUgbW91c2Vkb3duXG4gICAgICogaXRzZWxmIHNpbmNlIHRoZSBicm93c2VyIGhhc24ndCB1cGRhdGVkIHRoZSBzZWxlY3Rpb24gaW4gdGhlIERPTSB5ZXQuXG4gICAgICogVGhpcyBvYnNlcnZhdGlvbiBpcyB0aHVzIGRlZmVycmVkIGluc2lkZSBhIGBzZXRUaW1lb3V0YC4gSWYgdGhlIGJyb3dzZXJcbiAgICAgKiBnZXRzIG92ZXJsb2FkZWQsIGl0IG1pZ2h0IGZpcmUgdGhlIHRpbWVvdXQgYWZ0ZXIgb3RoZXIgZXZlbnRzIGhhdmVcbiAgICAgKiBoYXBwZW5lZCwgdGh1cyByZW5kZXJpbmcgdGhlIG9ic2VydmF0aW9uIG1lYW5pbmdsZXNzIHNpbmNlIHRoZSBzZWxlY3Rpb25cbiAgICAgKiB3b3VsZCBoYXZlIGNoYW5nZWQgeWV0IGFnYWluLiBUaGUgb2JzZXJ2YXRpb24gdGltZW91dCBpcyBzdG9yZWQgaW4gdGhpc1xuICAgICAqIHZhcmlhYmxlIGluIG9yZGVyIHRvIG1hbnVhbGx5IGZpcmUgaXRzIGV4ZWN1dGlvbiB3aGVuIGFuIGV2ZW50IHRoYXQgbWlnaHRcbiAgICAgKiBjaGFuZ2UgdGhlIHNlbGVjdGlvbiBpcyB0cmlnZ2VyZWQgYmVmb3JlIHRoZSBicm93c2VyIGV4ZWN1dGVkIHRoZSB0aW1lci5cbiAgICAgKi9cbiAgICBfcG9pbnRlclNlbGVjdGlvblRpbWVvdXQ6IFRpbWVvdXQ8RXZlbnRCYXRjaD47XG4gICAgLyoqXG4gICAgICogVGhlIGN1cnJlbnQgc2VsZWN0aW9uIGhhcyB0byBiZSBvYnNlcnZlZCBhcyBhIHJlc3VsdCBvZiBhIG5hZ2l2YXRpb24ga2V5XG4gICAgICogYmVpbmcgcHJlc3NlZC4gSG93ZXZlciwgdGhpcyBjYW5ub3QgYmUgZG9uZSBhdCB0aGUgdGltZSBvZiB0aGUga2V5ZG93blxuICAgICAqIGl0c2VsZiBzaW5jZSB0aGUgYnJvd3NlciBoYXNuJ3QgdXBkYXRlZCB0aGUgc2VsZWN0aW9uIGluIHRoZSBET00geWV0LlxuICAgICAqIFRoaXMgb2JzZXJ2YXRpb24gaXMgdGh1cyBkZWZlcnJlZCBpbnNpZGUgYSBgc2V0VGltZW91dGAuIElmIHRoZSBicm93c2VyXG4gICAgICogZ2V0cyBvdmVybG9hZGVkLCBpdCBtaWdodCBmaXJlIHRoZSB0aW1lb3V0IGFmdGVyIG90aGVyIGV2ZW50cyBoYXZlXG4gICAgICogaGFwcGVuZWQsIHRodXMgcmVuZGVyaW5nIHRoZSBvYnNlcnZhdGlvbiBtZWFuaW5nbGVzcyBzaW5jZSB0aGUgc2VsZWN0aW9uXG4gICAgICogd291bGQgaGF2ZSBjaGFuZ2VkIHlldCBhZ2Fpbi4gVGhlIG9ic2VydmF0aW9uIHRpbWVvdXQgaXMgc3RvcmVkIGluIHRoaXNcbiAgICAgKiB2YXJpYWJsZSBpbiBvcmRlciB0byBtYW51YWxseSBmaXJlIGl0cyBleGVjdXRpb24gd2hlbiBhbiBldmVudCB0aGF0IG1pZ2h0XG4gICAgICogY2hhbmdlIHRoZSBzZWxlY3Rpb24gaXMgdHJpZ2dlcmVkIGJlZm9yZSB0aGUgYnJvd3NlciBleGVjdXRlZCB0aGUgdGltZXIuXG4gICAgICovXG4gICAgX2tleWJvYXJkU2VsZWN0aW9uVGltZW91dDogVGltZW91dDxFdmVudEJhdGNoPjtcbiAgICAvKipcbiAgICAgKiBUaGUgY3VycmVudCBzZWxlY3Rpb24gaGFzIHRvIGJlIG9ic2VydmVkIGFzIGEgcmVzdWx0IG9mIGEgbmFnaXZhdGlvbiBrZXlcbiAgICAgKiBiZWluZyBwcmVzc2VkLiBIb3dldmVyLCB0aGlzIGNhbm5vdCBiZSBkb25lIGF0IHRoZSB0aW1lIG9mIHRoZSBrZXlkb3duXG4gICAgICogaXRzZWxmIHNpbmNlIHRoZSBicm93c2VyIGhhc24ndCB1cGRhdGVkIHRoZSBzZWxlY3Rpb24gaW4gdGhlIERPTSB5ZXQuXG4gICAgICogVGhpcyBvYnNlcnZhdGlvbiBpcyB0aHVzIGRlZmVycmVkIGluc2lkZSBhIGBzZXRUaW1lb3V0YC4gSWYgdGhlIGJyb3dzZXJcbiAgICAgKiBnZXRzIG92ZXJsb2FkZWQsIGl0IHdpbGwgdHJpZ2dlciBhbGwgdGhlIHN1YnNlcXVlbnQgZXZlbnRzIGluIHRoZSBzYW1lXG4gICAgICogZXZlbnQgc3RhY2ssIHRodXMgcHJldmVudGluZyB0aGUgb2JzZXJ2YXRpb24gb2YgdGhlIHNlbGVjdGlvbiBiZXR3ZWVuXG4gICAgICogbXVsdGlwbGUga2V5cy4gU2luY2UgbmF2aWdhdGlvbiBrZXlzIGFyZSBpcnJlbGV2YW50IGZvciBzcGVsbC1jaGVja2luZ1xuICAgICAqIGtleWJvYXJkIGNvbmNlcm5zLCB0aGUgY3VycmVudCBzdGFjayBjYW4gYmUgcHJvY2Vzc2VkIGFzIHNvb24gYXMgYVxuICAgICAqIG5hdmlnYXRpb24ga2V5IGlzIHByZXNzZWQgaW5zdGVhZCBvZiBjb250aW51aW5nIHRvIGJhdGNoIHRoZW0gdG9nZXRoZXIuXG4gICAgICogVGhlIHByZXZpb3VzIHN0YWNrIHRpbWVvdXQgaXMgc3RvcmVkIGluIHRoaXMgdmFyaWFibGUgaW4gb3JkZXIgdG9cbiAgICAgKiBtYW51YWxseSBmaXJlIGl0cyBleGVjdXRpb24gd2hlbiBhIG5hdmlnYXRpb24ga2V5IGlzIHByZXNzZWQuXG4gICAgICovXG4gICAgX3N0YWNrVGltZW91dDogVGltZW91dDxFdmVudEJhdGNoPjtcbiAgICAvKipcbiAgICAgKiBNYXAgb2YgdGhlIHNoYWRvdyBkb20gZXZlbnQgbm9ybWFsaXplci5cbiAgICAgKiBJZiBhbiBldmVudCBpcyB0cmlnZ2VyZWQgaW5zaWRlIGEgc2hhZG93IGRvbSwgd2UgaW5zdGFuY2lhdGUgYSBuZXdcbiAgICAgKiBFdmVudE5vcm1hbGl6ZXIgaW4gdGhlIHNoYWRvdyBkb20uXG4gICAgICovXG4gICAgcHJpdmF0ZSBfc2hhZG93Tm9ybWFsaXplcnMgPSBuZXcgTWFwPFNoYWRvd1Jvb3QsIEV2ZW50Tm9ybWFsaXplcj4oKTtcblxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHBhcmFtIF9pc0luRWRpdGFibGUgQ2FsbGJhY2sgdG8gY2hlY2sgaWYgdGhlIG5vZGUgaXMgaW4gZWRpdGFibGUuXG4gICAgICogQHBhcmFtIF90cmlnZ2VyRXZlbnRCYXRjaCBDYWxsYmFjayB0byB0cmlnZ2VyIGZvciBlYWNoIHVzZXIgYWN0aW9uLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIF9pc0luRWRpdGFibGU6IChub2RlOiBOb2RlKSA9PiBib29sZWFuLFxuICAgICAgICBwcml2YXRlIF90cmlnZ2VyRXZlbnRCYXRjaDogVHJpZ2dlckV2ZW50QmF0Y2hDYWxsYmFjayxcbiAgICAgICAgcm9vdDogRG9jdW1lbnQgfCBTaGFkb3dSb290ID0gZG9jdW1lbnQsXG4gICAgKSB7XG4gICAgICAgIHRoaXMuaW5pdE5leHRPYnNlcnZhdGlvbigpO1xuXG4gICAgICAgIC8vIGNvbnN0IGRvY3VtZW50ID0gdGhpcy5lZGl0YWJsZS5vd25lckRvY3VtZW50O1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnRJbkVkaXRhYmxlKHJvb3QsICdjb21wb3NpdGlvbnN0YXJ0JywgdGhpcy5fcmVnaXN0ZXJFdmVudCk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudEluRWRpdGFibGUocm9vdCwgJ2NvbXBvc2l0aW9udXBkYXRlJywgdGhpcy5fcmVnaXN0ZXJFdmVudCk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudEluRWRpdGFibGUocm9vdCwgJ2NvbXBvc2l0aW9uZW5kJywgdGhpcy5fcmVnaXN0ZXJFdmVudCk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudEluRWRpdGFibGUocm9vdCwgJ2JlZm9yZWlucHV0JywgdGhpcy5fcmVnaXN0ZXJFdmVudCk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudEluRWRpdGFibGUocm9vdCwgJ2lucHV0JywgdGhpcy5fcmVnaXN0ZXJFdmVudCk7XG5cbiAgICAgICAgdGhpcy5fYmluZEV2ZW50KGRvY3VtZW50LCAnc2VsZWN0aW9uY2hhbmdlJywgdGhpcy5fb25TZWxlY3Rpb25DaGFuZ2UpO1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnRJbkVkaXRhYmxlKHJvb3QsICdjb250ZXh0bWVudScsIHRoaXMuX29uQ29udGV4dE1lbnUpO1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnQocm9vdCwgJ21vdXNlZG93bicsIHRoaXMuX29uUG9pbnRlckRvd24pO1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnQocm9vdCwgJ3RvdWNoc3RhcnQnLCB0aGlzLl9vblBvaW50ZXJEb3duKTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50KHJvb3QsICdtb3VzZXVwJywgdGhpcy5fb25Qb2ludGVyVXApO1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnQocm9vdCwgJ3RvdWNoZW5kJywgdGhpcy5fb25Qb2ludGVyVXApO1xuICAgICAgICB0aGlzLl9iaW5kRXZlbnRJbkVkaXRhYmxlKHJvb3QsICdrZXlkb3duJywgdGhpcy5fb25LZXlEb3duT3JLZXlQcmVzcyk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudEluRWRpdGFibGUocm9vdCwgJ2tleXByZXNzJywgdGhpcy5fb25LZXlEb3duT3JLZXlQcmVzcyk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudChyb290LCAnb25rZXl1cCcsIHRoaXMuX3VwZGF0ZU1vZGlmaWVyc0tleXMpO1xuXG4gICAgICAgIHRoaXMuX2JpbmRFdmVudEluRWRpdGFibGUocm9vdCwgJ2N1dCcsIHRoaXMuX29uQ2xpcGJvYXJkKTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50SW5FZGl0YWJsZShyb290LCAncGFzdGUnLCB0aGlzLl9vbkNsaXBib2FyZCk7XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudEluRWRpdGFibGUocm9vdCwgJ2RyYWdzdGFydCcsIHRoaXMuX29uRHJhZ1N0YXJ0KTtcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50SW5FZGl0YWJsZShyb290LCAnZHJvcCcsIHRoaXMuX29uRHJvcCk7XG5cbiAgICAgICAgdGhpcy5fbXV0YXRpb25Ob3JtYWxpemVyID0gbmV3IE11dGF0aW9uTm9ybWFsaXplcihcbiAgICAgICAgICAgIHJvb3QgaW5zdGFuY2VvZiBEb2N1bWVudCA/IHJvb3QuYm9keSA6IHJvb3QubGFzdEVsZW1lbnRDaGlsZCxcbiAgICAgICAgKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gZGVzdHJveSB0aGUgZXZlbnQgbm9ybWFsaXplci5cbiAgICAgKiBSZW1vdmUgYWxsIGFkZGVkIGhhbmRsZXJzLlxuICAgICAqXG4gICAgICovXG4gICAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fbXV0YXRpb25Ob3JtYWxpemVyLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5fdW5iaW5kRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuX3NoYWRvd05vcm1hbGl6ZXJzLmZvckVhY2goZXZlbnROb3JtYWxpemVyID0+IGV2ZW50Tm9ybWFsaXplci5kZXN0cm95KCkpO1xuICAgICAgICB0aGlzLl90cmlnZ2VyRXZlbnRCYXRjaCA9IG51bGw7XG4gICAgICAgIHRoaXMuX2lzSW5FZGl0YWJsZSA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBCaW5kIHRoZSBvY2N1cmVuY2Ugb2YgZ2l2ZW4gZXZlbiB0eXBlIG9uIHRoZSBnaXZlbiB0YXJnZXQgZWxlbWVudCB0byB0aGVcbiAgICAgKiBnaXZlbiBsaXN0ZW5lciBmdW5jdGlvbi4gU2VlIF91bmJpbmRFdmVudHMgdG8gdW5iaW5kIGFsbCBldmVudHMgYm91bmQgYnlcbiAgICAgKiBjYWxsaW5nIHRoaXMgZnVuY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGFyZ2V0IGVsZW1lbnQgb24gd2hpY2ggdG8gbGlzdGVuIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0gdHlwZSBvZiB0aGUgZXZlbnQgdG8gbGlzdGVuXG4gICAgICogQHBhcmFtIGxpc3RlbmVyIHRvIGNhbGwgd2hlbiB0aGUgZXZlbiBvY2N1cnMgb24gdGhlIHRhcmdldFxuICAgICAqL1xuICAgIF9iaW5kRXZlbnQodGFyZ2V0OiBEb2N1bWVudCB8IFNoYWRvd1Jvb3QsIHR5cGU6IHN0cmluZywgbGlzdGVuZXI6IEZ1bmN0aW9uKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGJvdW5kTGlzdGVuZXIgPSBsaXN0ZW5lci5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9ldmVudExpc3RlbmVycy5wdXNoKHtcbiAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0LFxuICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgIGxpc3RlbmVyOiBib3VuZExpc3RlbmVyLFxuICAgICAgICB9KTtcbiAgICAgICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgYm91bmRMaXN0ZW5lciwgdHJ1ZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpbHRlciBldmVudCBmcm9tIGVkaXRhYmxlLlxuICAgICAqXG4gICAgICogQHNlZSBfYmluZEV2ZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGFyZ2V0IGVsZW1lbnQgb24gd2hpY2ggdG8gbGlzdGVuIGZvciBldmVudHNcbiAgICAgKiBAcGFyYW0gdHlwZSBvZiB0aGUgZXZlbnQgdG8gbGlzdGVuXG4gICAgICogQHBhcmFtIGxpc3RlbmVyIHRvIGNhbGwgd2hlbiB0aGUgZXZlbiBvY2N1cnMgb24gdGhlIHRhcmdldFxuICAgICAqL1xuICAgIF9iaW5kRXZlbnRJbkVkaXRhYmxlKHRhcmdldDogRG9jdW1lbnQgfCBTaGFkb3dSb290LCB0eXBlOiBzdHJpbmcsIGxpc3RlbmVyOiBGdW5jdGlvbik6IHZvaWQge1xuICAgICAgICBjb25zdCBib3VuZExpc3RlbmVyID0gKGV2OiBFdmVudFRvUHJvY2Vzcyk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZXZlbnRUYXJnZXQgPSAndGFyZ2V0JyBpbiBldiAmJiAoZXYudGFyZ2V0IGFzIEVsZW1lbnQpO1xuICAgICAgICAgICAgY29uc3Qgc2hhZG93Um9vdCA9IGV2ZW50VGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudCAmJiBldmVudFRhcmdldC5zaGFkb3dSb290O1xuICAgICAgICAgICAgaWYgKHNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3NoYWRvd05vcm1hbGl6ZXJzLmdldChzaGFkb3dSb290KSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBldmVudE5vcm1hbGl6ZXIgPSBuZXcgRXZlbnROb3JtYWxpemVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faXNJbkVkaXRhYmxlLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJpZ2dlckV2ZW50QmF0Y2gsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGFkb3dSb290LFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zaGFkb3dOb3JtYWxpemVycy5zZXQoc2hhZG93Um9vdCwgZXZlbnROb3JtYWxpemVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCFldmVudFRhcmdldCB8fCB0aGlzLl9pc0luRWRpdGFibGUoZXZlbnRUYXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgbGlzdGVuZXIuY2FsbCh0aGlzLCBldik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX2JpbmRFdmVudCh0YXJnZXQsIHR5cGUsIGJvdW5kTGlzdGVuZXIpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbmJpbmQgYWxsIGV2ZW50cyBib3VuZCBieSBjYWxscyB0byBfYmluZEV2ZW50LlxuICAgICAqXG4gICAgICovXG4gICAgX3VuYmluZEV2ZW50cygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fZXZlbnRMaXN0ZW5lcnMuZm9yRWFjaCgoeyB0YXJnZXQsIHR5cGUsIGxpc3RlbmVyIH0pID0+IHtcbiAgICAgICAgICAgIHRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGxpc3RlbmVyLCB0cnVlKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIGdpdmVuIGV2ZW50IG9uIHRoZSB0aGlzLmN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9ldmVudHMgcXVldWUuIElmIHRoZSBxdWV1ZSBpcyBub3QgeWV0XG4gICAgICogaW5pdGlhbGl6ZWQgb3IgaGFzIGJlZW4gY2xlYXJlZCBwcmlvciB0byB0aGlzIGNhbGwsIHJlLWluaXRpYWxpemUgaXQuXG4gICAgICogQWZ0ZXIgYSB0aWNrIChzZXRUaW1lb3V0IDBtcykgdGhlICdfcHJvY2Vzc0V2ZW50cycgbWV0aG9kIGlzIGNhbGxlZC4gQWxsXG4gICAgICogZXZlbnRzIHRoYXQgaGFwcGVuZWQgZHVyaW5nIHRoZSB0aWNrIGFyZSByZWFkIGZyb20gdGhlIHF1ZXVlIGFuZCB0aGVcbiAgICAgKiBhbmFseXNpcyB0cmllcyB0byBleHRyYWN0IHRoZSBhY3Rpb25zIGRlc2lyZWQgYnkgdGhlIHVzZXIgc3VjaCBhcyBpbnNlcnQsXG4gICAgICogZGVsZXRlLCBiYWNrc3BhY2UsIHNwZWxsIGNoZWNraW5nLCBzcGVjaWFsIGNoYXJhY3RlcnMsIGV0Yy5cbiAgICAgKlxuICAgICAqIEBzZWUgX3Byb2Nlc3NFdmVudHNcbiAgICAgKi9cbiAgICBfcmVnaXN0ZXJFdmVudChldjogRXZlbnRUb1Byb2Nlc3MpOiB2b2lkIHtcbiAgICAgICAgLy8gU2VlIGNvbW1lbnQgb24gYF9rZXlib2FyZFNlbGVjdGlvblRpbWVvdXRgLlxuICAgICAgICBpZiAodGhpcy5fa2V5Ym9hcmRTZWxlY3Rpb25UaW1lb3V0Py5wZW5kaW5nKSB7XG4gICAgICAgICAgICB0aGlzLl9rZXlib2FyZFNlbGVjdGlvblRpbWVvdXQuZmlyZSgpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFNlZSBjb21tZW50IG9uIGBfcG9pbnRlclNlbGVjdGlvblRpbWVvdXRgLlxuICAgICAgICBpZiAodGhpcy5fcG9pbnRlclNlbGVjdGlvblRpbWVvdXQ/LnBlbmRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX3BvaW50ZXJTZWxlY3Rpb25UaW1lb3V0LmZpcmUoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGlzTmF2aWdhdGlvbkV2ZW50ID1cbiAgICAgICAgICAgIGV2IGluc3RhbmNlb2YgS2V5Ym9hcmRFdmVudCAmJiBldi50eXBlID09PSAna2V5ZG93bicgJiYgbmF2aWdhdGlvbktleS5oYXMoZXYua2V5KTtcblxuICAgICAgICBpZiAoaXNOYXZpZ2F0aW9uRXZlbnQpIHtcbiAgICAgICAgICAgIC8vIE1hbnVhbGx5IHRyaWdnZXJpbmcgdGhlIHByb2Nlc3Npbmcgb2YgdGhlIGN1cnJlbnQgc3RhY2sgYXQgdGhpc1xuICAgICAgICAgICAgLy8gcG9pbnQgZm9yY2VzIHRoZSByZW5kZXJpbmcgaW4gdGhlIERPTSBvZiB0aGUgcmVzdWx0IG9mIHRoZVxuICAgICAgICAgICAgLy8gb2JzZXJ2ZWQgZXZlbnRzLiBUaGlzIGVuc3VyZXMgdGhhdCB0aGUgbmV3IHNlbGVjdGlvbiB0aGF0IGlzXG4gICAgICAgICAgICAvLyBldmVudHVhbGx5IGdvaW5nIHRvIGJlIHNldCBieSB0aGUgYnJvd3NlciBhY3R1YWxseSB0YXJnZXRzIG5vZGVzXG4gICAgICAgICAgICAvLyB0aGF0IGFyZSBwcm9wZXJseSByZWNvZ25pemVkIGluIG91ciBhYnN0cmF0aW9uLCB3aGljaCB3b3VsZCBub3RcbiAgICAgICAgICAgIC8vIGJlIHRoZSBjYXNlIG90aGVyd2lzZS4gU2VlIGNvbW1lbnQgb24gYF9zdGFja1RpbWVvdXRgLlxuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YWNrVGltZW91dD8ucGVuZGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YWNrVGltZW91dC5maXJlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBUT0RPOiBubyByZW5kZXJpbmcgaW4gZWRpdGFibGUgY2FuIGhhcHBlbiBiZWZvcmUgdGhlIGFuYWx5c2lzIG9mXG4gICAgICAgICAgICAvLyB0aGUgc2VsZWN0aW9uLiBUaGVyZSBzaG91bGQgYmUgYSBtZWNoYW5pc20gaGVyZSB0aGF0IGNhbiBiZSB1c2VkXG4gICAgICAgICAgICAvLyBieSB0aGUgbm9ybWFsaXplciB0byBibG9jayB0aGUgcmVuZGVyaW5nIHVudGlsIHRoaXMgcmVzb2x2ZXMuXG4gICAgICAgICAgICB0aGlzLl9rZXlib2FyZFNlbGVjdGlvblRpbWVvdXQgPSBuZXcgVGltZW91dDxFdmVudEJhdGNoPihcbiAgICAgICAgICAgICAgICBhc3luYyAoKTogUHJvbWlzZTxFdmVudEJhdGNoPiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNldFNlbGVjdGlvbkFjdGlvbjogU2V0U2VsZWN0aW9uQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NldFNlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgICAgICAgICBkb21TZWxlY3Rpb246IHRoaXMuX2dldFNlbGVjdGlvbigpLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBhY3Rpb25zOiBbc2V0U2VsZWN0aW9uQWN0aW9uXSwgbXV0YXRlZEVsZW1lbnRzOiBuZXcgU2V0KFtdKSB9O1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgdGhpcy5fdHJpZ2dlckV2ZW50QmF0Y2godGhpcy5fa2V5Ym9hcmRTZWxlY3Rpb25UaW1lb3V0LnByb21pc2UpO1xuICAgICAgICAgICAgdGhpcy5pbml0TmV4dE9ic2VydmF0aW9uKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vIFRoZSBxdWV1ZSBpcyBub3QgaW5pdGlhbGl6ZWQgb3IgaGFzIGJlZW4gcmVzZXQsIHNvIHRoaXMgaXMgYVxuICAgICAgICAgICAgICAgIC8vIG5ldyB1c2VyIGFjdGlvbi4gUmUtaW5pdGlhbGl6ZSB0aGUgcXVldWUgc3VjaCB0aGF0IHRoZVxuICAgICAgICAgICAgICAgIC8vIGFuYWx5c2lzIGlzIG5vdCBwb2xsdXRlZCBieSBwcmV2aW91cyBvYnNlcnZhdGlvbnMuXG5cbiAgICAgICAgICAgICAgICAvLyB0aGlzLmluaXROZXh0T2JzZXJ2YXRpb24oKTtcbiAgICAgICAgICAgICAgICBjb25zdCBzdGFjayA9IHRoaXMuY3VycmVudFN0YWNrT2JzZXJ2YXRpb247XG5cbiAgICAgICAgICAgICAgICAvLyBTdGFydCBvYnNlcnZpbmcgbXV0YXRpb25zLlxuICAgICAgICAgICAgICAgIHRoaXMuX211dGF0aW9uTm9ybWFsaXplci5zdGFydCgpO1xuXG4gICAgICAgICAgICAgICAgLy8gQWxsIGV2ZW50cyBvZiB0aGlzIHRpY2sgd2lsbCBiZSBwcm9jZXNzZWQgaW4gdGhlIG5leHQgb25lLlxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YWNrVGltZW91dCA9IG5ldyBUaW1lb3V0PEV2ZW50QmF0Y2g+KFxuICAgICAgICAgICAgICAgICAgICAoKTogUHJvbWlzZTxFdmVudEJhdGNoPiA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fcHJvY2Vzc0V2ZW50cyhzdGFjayk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB0aGlzLl90cmlnZ2VyRXZlbnRCYXRjaCh0aGlzLl9zdGFja1RpbWVvdXQucHJvbWlzZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEl0IGlzIHBvc3NpYmxlIHRvIGhhdmUgbXVsdGlwbGVzIGtleXMgdGhhdCBtdXN0IHRyaWdnZXIgbXVsdGlwbGVzXG4gICAgICAgICAgICAvLyB0aW1lcyB0aGF0IGFyZSBiZWluZyBwdXNoIGluIHRoZSBzYW1lIHRpY2suIFRvIGJlIGFibGUgdG8gaGFuZGxlXG4gICAgICAgICAgICAvLyB0aGlzIGNhc2UgaW4gYF9wcm9jZXNzRXZlbnRzYCwgd2UgYWdncmVnYXRlIHRoZSBpbmZvcm1hdGlvbnMgaW5cbiAgICAgICAgICAgIC8vIGBfbXVsdGlLZXlTdGFja2AuXG4gICAgICAgICAgICBpZiAoWydrZXlkb3duJywgJ2tleXByZXNzJywgJ2lucHV0J10uaW5jbHVkZXMoZXYudHlwZSkpIHtcbiAgICAgICAgICAgICAgICAvLyBJbiB0aGUgbXVsdGlwbGUga2V5IGNhc2UsIGEgJ2tleWRvd24nIGlzIGFsd2F5cyB0aGUgZmlyc3RcbiAgICAgICAgICAgICAgICAvLyBldmVudCB0cmlnZ2VyZWQgYmV0d2VlbiB0aGUgdGhyZWUgKGtleWRvd24sIGtleXByZXNzLCBpbnB1dCkuXG4gICAgICAgICAgICAgICAgLy8gU28gd2UgY3JlYXRlIGEgbmV3IG1hcCBlYWNoIHRpbWUgYSAna2V5ZG93bicgaXMgcmVnaXN0cmVkLlxuICAgICAgICAgICAgICAgIGlmIChldi50eXBlID09PSAna2V5ZG93bicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fbXVsdGlLZXlTdGFjay5wdXNoKHt9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29uc3QgbGFzdE11bHRpS2V5cyA9IHRoaXMuY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX211bHRpS2V5U3RhY2tbXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX211bHRpS2V5U3RhY2subGVuZ3RoIC0gMVxuICAgICAgICAgICAgICAgIF07XG4gICAgICAgICAgICAgICAgaWYgKGxhc3RNdWx0aUtleXMpIHtcbiAgICAgICAgICAgICAgICAgICAgbGFzdE11bHRpS2V5c1tldi50eXBlXSA9IGV2O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzTWFwW2V2LnR5cGVdID0gZXY7XG4gICAgICAgICAgICBpZiAoZXYudHlwZS5zdGFydHNXaXRoKCdjb21wb3NpdGlvbicpKSB7XG4gICAgICAgICAgICAgICAgLy8gSW4gbW9zdCBjYXNlcyB3ZSBvbmx5IG5lZWQgdGhlIGxhc3QgY29tcG9zaXRpb24gb2YgdGhlXG4gICAgICAgICAgICAgICAgLy8gcmVnaXN0cmVkIGV2ZW50c1xuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX2V2ZW50c01hcC5sYXN0Q29tcG9zaXRpb24gPSBldiBhcyBDb21wb3NpdGlvbkV2ZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzLnB1c2goZXYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gaXMgdGhlIHJvb3Qgb2YgdGhlIG5vcm1hbGl6YXRpb24gZm9yIG1vc3QgZXZlbnRzLlxuICAgICAqXG4gICAgICogUHJvY2VzcyB0aGUgZXZlbnRzIHJlZ2lzdGVyZWQgd2l0aCBgX3JlZ2l0ZXJFdmVudGAgYW5kIGNhbGxcbiAgICAgKiBgX3RyaWdnZXJFdmVudEJhdGNoYCB3aXRoIG9uZSBvciBtb3JlIGBOb3JtYWxpemVkRXZlbnRgIHdoZW4gc3VmZmljaWVudFxuICAgICAqIGluZm9ybWF0aW9uIGhhcyBiZWVuIGdhdGhlcmVkIGZyb20gYWxsIHJlZ2lzdHJlZCBldmVudHMuXG4gICAgICpcbiAgICAgKiBJdCBjb3VsZCB0YWtlIHVwIHRvIHR3byB0aWNrIGluIHRoZSBicm93c2VyIHRvIGdhdGhlciBhbGwgdGhlIHN1ZmZpY2llbnRcbiAgICAgKiBpbmZvcm1hdGlvbi4gKGUuZy4gU2FmYXJpKVxuICAgICAqXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBJbiBzb21lIGNhc2VzLCB0aGUgb2JzZXJ2YXRpb24gbXVzdCBiZSBkZWxheWVkIHRvIHRoZSBuZXh0IHRpY2suIEluIHRoZXNlXG4gICAgICogY2FzZXMsIHRoaXMgY29udHJvbCB2YXJpYWJsZSB3aWxsIGJlIHNldCB0byB0cnVlIHN1Y2ggdGhhdCB0aGUgYW5hbHlzaXNcbiAgICAgKiBwcm9jZXNzIGtub3dzIHRoZSBjdXJyZW50IGV2ZW50IHF1ZXVlIHByb2Nlc3NpbmcgaGFzIGJlZW4gZGVsYXllZC5cbiAgICAgKi9cbiAgICBhc3luYyBfcHJvY2Vzc0V2ZW50cyhcbiAgICAgICAgY3VycmVudFN0YWNrT2JzZXJ2YXRpb246IEN1cnJlbnRTdGFja09ic2VydmF0aW9ucyxcbiAgICAgICAgc2Vjb25kVGlja09ic2VydmF0aW9uID0gZmFsc2UsXG4gICAgKTogUHJvbWlzZTxFdmVudEJhdGNoPiB7XG4gICAgICAgIC8vIEluIHNvbWUgY2FzZXMsIGZvciBleGFtcGxlIGN1dHRpbmcgd2l0aCBDbWQrWCBvbiBTYWZhcmksIHRoZSBicm93c2VyXG4gICAgICAgIC8vIHRyaWdnZXJzIGV2ZW50cyBpbiB0d28gZGlmZmVyZW50IHN0YWNrcy4gSW4gc3VjaCBjYXNlcywgb2JzZXJ2aW5nXG4gICAgICAgIC8vIGV2ZW50cyBvY2N1cmluZyBkdXJpbmcgb25lIHRpY2sgaXMgbm90IGVub3VnaCBzbyB3ZSBuZWVkIHRvIGRlbGF5IHRoZVxuICAgICAgICAvLyBhbmFseXNpcyBhZnRlciB3ZSBvYnNlcnZlIGV2ZW50cyBkdXJpbmcgdHdvIHRpY2tzIGluc3RlYWQuXG4gICAgICAgIGNvbnN0IG5lZWRTZWNvbmRUaWNrT2JzZXJ2YXRpb24gPSBjdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzLmV2ZXJ5KGV2ID0+IHtcbiAgICAgICAgICAgIHJldHVybiAhTXVsdGlTdGFja0V2ZW50VHlwZXMuaW5jbHVkZXMoZXYudHlwZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAobmVlZFNlY29uZFRpY2tPYnNlcnZhdGlvbiAmJiAhc2Vjb25kVGlja09ic2VydmF0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpOiB2b2lkID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLl9wcm9jZXNzRXZlbnRzKGN1cnJlbnRTdGFja09ic2VydmF0aW9uLCB0cnVlKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBub3JtYWxpemVkQWN0aW9uczogTm9ybWFsaXplZEFjdGlvbltdID0gW107XG5cbiAgICAgICAgY29uc3Qga2V5ZG93bkV2ZW50ID0gY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX2V2ZW50c01hcC5rZXlkb3duO1xuICAgICAgICBjb25zdCBrZXlwcmVzc0V2ZW50ID0gY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX2V2ZW50c01hcC5rZXlwcmVzcztcbiAgICAgICAgY29uc3QgaW5wdXRFdmVudCA9IGN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9ldmVudHNNYXAuaW5wdXQ7XG4gICAgICAgIGNvbnN0IGtleWJvYXJkU2VsZWN0QWxsRXZlbnQgPSBjdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fZXZlbnRzTWFwLmtleWJvYXJkU2VsZWN0QWxsO1xuICAgICAgICBjb25zdCBjb21wb3NpdGlvbkV2ZW50ID0gY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX2V2ZW50c01hcC5sYXN0Q29tcG9zaXRpb247XG4gICAgICAgIGNvbnN0IGN1dEV2ZW50ID0gY3VycmVudFN0YWNrT2JzZXJ2YXRpb24uX2V2ZW50c01hcC5jdXQ7XG4gICAgICAgIGNvbnN0IGRyb3BFdmVudCA9IGN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9ldmVudHNNYXAuZHJvcDtcbiAgICAgICAgY29uc3QgcGFzdGVFdmVudCA9IGN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9ldmVudHNNYXAucGFzdGU7XG5cbiAgICAgICAgY29uc3QgY29tcG9zaXRpb25EYXRhID0gdGhpcy5fZ2V0Q29tcG9zaXRpb25EYXRhKGNvbXBvc2l0aW9uRXZlbnQsIGlucHV0RXZlbnQpO1xuXG4gICAgICAgIGNvbnN0IGlzR29vZ2xlS2V5Ym9hcmRCYWNrc3BhY2UgPVxuICAgICAgICAgICAgY29tcG9zaXRpb25EYXRhICYmXG4gICAgICAgICAgICBjb21wb3NpdGlvbkRhdGEuY29tcG9zaXRpb25Gcm9tLnNsaWNlKDAsIC0xKSA9PT0gY29tcG9zaXRpb25EYXRhLmNvbXBvc2l0aW9uVG8gJiZcbiAgICAgICAgICAgIGtleWRvd25FdmVudCAmJlxuICAgICAgICAgICAga2V5ZG93bkV2ZW50LmtleSA9PT0gJ1VuaWRlbnRpZmllZCc7XG5cbiAgICAgICAgY29uc3QgaW5mZXJyZWRLZXlkb3duRXZlbnQ6IEluZmVycmVkS2V5ZG93bkV2ZW50ID1cbiAgICAgICAgICAgIGtleWRvd25FdmVudCAmJlxuICAgICAgICAgICAga2V5ZG93bkV2ZW50LmtleSA9PT0gJ1VuaWRlbnRpZmllZCcgJiZcbiAgICAgICAgICAgIHRoaXMuX2luZmVyS2V5ZG93bkV2ZW50KGlucHV0RXZlbnQpO1xuICAgICAgICAvL1xuICAgICAgICAvLyBGaXJzdCBwYXNzIHRvIGdldCB0aGUgaW5mb3JtYXRpb25zXG4gICAgICAgIC8vXG4gICAgICAgIGNvbnN0IGtleTogc3RyaW5nID1cbiAgICAgICAgICAgIChrZXlwcmVzc0V2ZW50ICYmXG4gICAgICAgICAgICAgICAga2V5cHJlc3NFdmVudC5rZXkgIT09ICdVbmlkZW50aWZpZWQnICYmXG4gICAgICAgICAgICAgICAga2V5cHJlc3NFdmVudC5rZXkgIT09ICdEZWFkJyAmJlxuICAgICAgICAgICAgICAgIGtleXByZXNzRXZlbnQua2V5KSB8fFxuICAgICAgICAgICAgKGlucHV0RXZlbnQgJiZcbiAgICAgICAgICAgICAgICBpbnB1dEV2ZW50LmRhdGEgIT09IG51bGwgJiZcbiAgICAgICAgICAgICAgICBpbnB1dEV2ZW50LmRhdGEubGVuZ3RoID09PSAxICYmXG4gICAgICAgICAgICAgICAgaW5wdXRFdmVudC5kYXRhKSB8fFxuICAgICAgICAgICAgKGtleWRvd25FdmVudCAmJlxuICAgICAgICAgICAgICAgIGtleWRvd25FdmVudC5rZXkgIT09ICdVbmlkZW50aWZpZWQnICYmXG4gICAgICAgICAgICAgICAga2V5ZG93bkV2ZW50LmtleSAhPT0gJ0RlYWQnICYmXG4gICAgICAgICAgICAgICAga2V5ZG93bkV2ZW50LmtleSkgfHxcbiAgICAgICAgICAgIChpc0dvb2dsZUtleWJvYXJkQmFja3NwYWNlICYmICdCYWNrc3BhY2UnKSB8fFxuICAgICAgICAgICAgKGtleWRvd25FdmVudCAmJlxuICAgICAgICAgICAgICAgIGtleWRvd25FdmVudC5rZXkgPT09ICdVbmlkZW50aWZpZWQnICYmXG4gICAgICAgICAgICAgICAgaW5mZXJyZWRLZXlkb3duRXZlbnQgJiZcbiAgICAgICAgICAgICAgICBpbmZlcnJlZEtleWRvd25FdmVudC5jb2RlKTtcbiAgICAgICAgY29uc3QgaW5wdXRUeXBlID1cbiAgICAgICAgICAgIChjdXRFdmVudCAmJiAnZGVsZXRlQnlDdXQnKSB8fFxuICAgICAgICAgICAgKGRyb3BFdmVudCAmJiAnaW5zZXJ0RnJvbURyb3AnKSB8fFxuICAgICAgICAgICAgKHBhc3RlRXZlbnQgJiYgJ2luc2VydEZyb21QYXN0ZScpIHx8XG4gICAgICAgICAgICAoaW5wdXRFdmVudCAmJiBpbnB1dEV2ZW50LmlucHV0VHlwZSk7XG5cbiAgICAgICAgLy8gSW4gY2FzZSBvZiBhY2NlbnQgaW5zZXJ0ZWQgZnJvbSBhIE1hYywgY2hlY2sgdGhhdCB0aGUgY2hhciBiZWZvcmUgd2FzXG4gICAgICAgIC8vIG9uZSBvZiB0aGUgc3BlY2lhbCBhY2NlbnQgdGVtcG9yYXJpbHkgaW5zZXJ0ZWQgaW4gdGhlIERPTSAoZS5nLiAnXicsXG4gICAgICAgIC8vICdgJywgLi4uKS5cbiAgICAgICAgLy9cbiAgICAgICAgY29uc3QgY29tcG9zaXRpb25SZXBsYWNlT25lQ2hhciA9XG4gICAgICAgICAgICBjb21wb3NpdGlvbkRhdGEgJiZcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uRGF0YS5jb21wb3NpdGlvbkZyb20ubGVuZ3RoID09PSAxICYmXG4gICAgICAgICAgICBjb21wb3NpdGlvbkRhdGEuY29tcG9zaXRpb25Uby5sZW5ndGggPT09IDE7XG4gICAgICAgIGNvbnN0IGNvbXBvc2l0aW9uQWRkT25lQ2hhciA9XG4gICAgICAgICAgICBjb21wb3NpdGlvbkRhdGEgJiZcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uRGF0YS5jb21wb3NpdGlvbkZyb20gPT09ICcnICYmXG4gICAgICAgICAgICBjb21wb3NpdGlvbkRhdGEuY29tcG9zaXRpb25Uby5sZW5ndGggPT09IDE7XG4gICAgICAgIGNvbnN0IGlzQ29tcG9zaXRpb25LZXlib2FyZCA9IGNvbXBvc2l0aW9uQWRkT25lQ2hhciB8fCBjb21wb3NpdGlvblJlcGxhY2VPbmVDaGFyO1xuXG4gICAgICAgIGNvbnN0IGlzVmlydHVhbEtleWJvYXJkID0gY29tcG9zaXRpb25FdmVudCAmJiBrZXkgJiYga2V5Lmxlbmd0aCAhPT0gMTtcblxuICAgICAgICAvLyBDb21wdXRlIHRoZSBzZXQgb2YgbXV0YXRlZCBlbGVtZW50cyBhY2Nyb3NzIGFsbCBvYnNlcnZlZCBldmVudHMuXG4gICAgICAgIGNvbnN0IG11dGF0ZWRFbGVtZW50cyA9IHRoaXMuX211dGF0aW9uTm9ybWFsaXplci5nZXRNdXRhdGVkRWxlbWVudHMoKTtcbiAgICAgICAgdGhpcy5fbXV0YXRpb25Ob3JtYWxpemVyLnN0b3AoKTtcblxuICAgICAgICAvLyBXaGVuIHRoZSBicm93c2VyIHRyaWdnZXIgbXVsdGlwbGVzIGtleWRvd24gYXQgb25jZSwgZm9yIGVhY2gga2V5ZG93blxuICAgICAgICAvLyB0aGVyZSBpcyBhbHdheXMgYWxzbyBhIGtleXByZXNzIGFuZCBhbiBpbnB1dCB0aGF0IG11c3QgYmUgcHJlc2VudC5cbiAgICAgICAgY29uc3QgcG9zc2libGVNdWx0aUtleWRvd24gPSBjdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fbXVsdGlLZXlTdGFjay5ldmVyeShcbiAgICAgICAgICAgIGtleWRvd25NYXAgPT5cbiAgICAgICAgICAgICAgICBrZXlkb3duTWFwLmtleWRvd24gJiZcbiAgICAgICAgICAgICAgICBrZXlkb3duTWFwLmtleWRvd24ua2V5ICE9PSAnVW5pZGVudGlmaWVkJyAmJlxuICAgICAgICAgICAgICAgIChrZXlkb3duTWFwLmlucHV0IHx8IGtleWRvd25NYXAua2V5ZG93bi5rZXkubGVuZ3RoID4gMSksXG4gICAgICAgICk7XG4gICAgICAgIC8vIGlmIHRoZXJlIGlzIG9ubHkgb25lIF9tdWx0aUtleU1hcCwgaXQgbWVhbnMgdGhhdCB0aGVyZSBpcyBub1xuICAgICAgICAvLyBtdWx0aXBsZXMga2V5cyBwdXNoZWQuXG4gICAgICAgIGlmIChjdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fbXVsdGlLZXlTdGFjay5sZW5ndGggPiAxICYmIHBvc3NpYmxlTXVsdGlLZXlkb3duKSB7XG4gICAgICAgICAgICBjdXJyZW50U3RhY2tPYnNlcnZhdGlvbi5fbXVsdGlLZXlTdGFjay5tYXAoa2V5ZG93bk1hcCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qga2V5Ym9hcmRBY3Rpb24gPSB0aGlzLl9nZXRLZXlib2FyZEFjdGlvbihcbiAgICAgICAgICAgICAgICAgICAga2V5ZG93bk1hcC5rZXlkb3duLmtleSxcbiAgICAgICAgICAgICAgICAgICAgKGtleWRvd25NYXAuaW5wdXQgJiYga2V5ZG93bk1hcC5pbnB1dC5pbnB1dFR5cGUpIHx8ICcnLFxuICAgICAgICAgICAgICAgICAgICAhIW11dGF0ZWRFbGVtZW50cy5zaXplLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgaWYgKGtleWJvYXJkQWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWRBY3Rpb25zLnB1c2goa2V5Ym9hcmRBY3Rpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGN1dEV2ZW50KSB7XG4gICAgICAgICAgICBjb25zdCBkZWxldGVDb250ZW50QWN0aW9uOiBEZWxldGVDb250ZW50QWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdkZWxldGVDb250ZW50JyxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IERpcmVjdGlvbi5GT1JXQVJELFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIC8vIHJlbW92ZSBwcmV2aW91c2x5IHBhcnNlZCBrZXlib2FyZCBhY3Rpb24gYXMgd2Ugb25seSB3YW50IHRvIHJlbW92ZVxuICAgICAgICAgICAgbm9ybWFsaXplZEFjdGlvbnMucHVzaChkZWxldGVDb250ZW50QWN0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmIChkcm9wRXZlbnQpIHtcbiAgICAgICAgICAgIG5vcm1hbGl6ZWRBY3Rpb25zLnB1c2goLi4udGhpcy5fZ2V0RHJvcEFjdGlvbnMoZHJvcEV2ZW50KSk7XG4gICAgICAgIH0gZWxzZSBpZiAocGFzdGVFdmVudCkge1xuICAgICAgICAgICAgbm9ybWFsaXplZEFjdGlvbnMucHVzaCh0aGlzLl9nZXREYXRhVHJhbnNmZXJBY3Rpb24ocGFzdGVFdmVudCkpO1xuICAgICAgICB9IGVsc2UgaWYgKGtleWJvYXJkU2VsZWN0QWxsRXZlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdEFsbEFjdGlvbjogU2VsZWN0QWxsQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3RBbGwnLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG5vcm1hbGl6ZWRBY3Rpb25zLnB1c2goc2VsZWN0QWxsQWN0aW9uKTtcbiAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICAgIG5vcm1hbGl6ZWRBY3Rpb25zLmxlbmd0aCA9PT0gMCAmJlxuICAgICAgICAgICAgKCghY29tcG9zaXRpb25FdmVudCAmJiBrZXkpIHx8IGlzQ29tcG9zaXRpb25LZXlib2FyZCB8fCBpc1ZpcnR1YWxLZXlib2FyZClcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBjb25zdCBrZXlib2FyZEFjdGlvbiA9IHRoaXMuX2dldEtleWJvYXJkQWN0aW9uKGtleSwgaW5wdXRUeXBlLCAhIW11dGF0ZWRFbGVtZW50cy5zaXplKTtcbiAgICAgICAgICAgIGlmIChrZXlib2FyZEFjdGlvbikge1xuICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWRBY3Rpb25zLnB1c2goa2V5Ym9hcmRBY3Rpb24pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY29tcG9zaXRpb25SZXBsYWNlT25lQ2hhcikge1xuICAgICAgICAgICAgICAgIG5vcm1hbGl6ZWRBY3Rpb25zID0gY29tcG9zaXRpb25EYXRhLmFjdGlvbnM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAobm9ybWFsaXplZEFjdGlvbnMubGVuZ3RoID09PSAwICYmIGNvbXBvc2l0aW9uRGF0YSkge1xuICAgICAgICAgICAgbm9ybWFsaXplZEFjdGlvbnMucHVzaCguLi5jb21wb3NpdGlvbkRhdGEuYWN0aW9ucyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaW5wdXRFdmVudCAmJiBpbnB1dEV2ZW50LmlucHV0VHlwZSAmJiBpbnB1dEV2ZW50LmlucHV0VHlwZS5pbmRleE9mKCdmb3JtYXQnKSA9PT0gMCkge1xuICAgICAgICAgICAgY29uc3QgZm9ybWF0TmFtZSA9IGlucHV0RXZlbnQuaW5wdXRUeXBlLnJlcGxhY2UoJ2Zvcm1hdCcsICcnKS50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgICAgICBjb25zdCBhcHBseUZvcm1hdEFjdGlvbjogQXBwbHlGb3JtYXRBY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2FwcGx5Rm9ybWF0JyxcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IGZvcm1hdE5hbWUsXG4gICAgICAgICAgICAgICAgZGF0YTogaW5wdXRFdmVudC5kYXRhLFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgbm9ybWFsaXplZEFjdGlvbnMucHVzaChhcHBseUZvcm1hdEFjdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXRFdmVudCAmJiBbJ2hpc3RvcnlVbmRvJywgJ2hpc3RvcnlSZWRvJ10uaW5jbHVkZXMoaW5wdXRFdmVudC5pbnB1dFR5cGUpKSB7XG4gICAgICAgICAgICBjb25zdCBoaXN0b3J5QWN0aW9uOiBIaXN0b3J5QWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6IGlucHV0RXZlbnQuaW5wdXRUeXBlIGFzICdoaXN0b3J5VW5kbycgfCAnaGlzdG9yeVJlZG8nLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIG5vcm1hbGl6ZWRBY3Rpb25zLnB1c2goaGlzdG9yeUFjdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmluaXROZXh0T2JzZXJ2YXRpb24oKTtcblxuICAgICAgICBpZiAobm9ybWFsaXplZEFjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgYmF0Y2g6IEV2ZW50QmF0Y2ggPSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uczogbm9ybWFsaXplZEFjdGlvbnMsXG4gICAgICAgICAgICAgICAgbXV0YXRlZEVsZW1lbnRzLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChpbmZlcnJlZEtleWRvd25FdmVudCkge1xuICAgICAgICAgICAgICAgIGJhdGNoLmluZmVycmVkS2V5ZG93bkV2ZW50ID0gaW5mZXJyZWRLZXlkb3duRXZlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gYmF0Y2g7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgYWN0aW9uczogW10gfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIG5leHQgb2JzZXJ2YXRpb24uXG4gICAgICovXG4gICAgaW5pdE5leHRPYnNlcnZhdGlvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fZm9sbG93c1BvaW50ZXJBY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5jdXJyZW50U3RhY2tPYnNlcnZhdGlvbiA9IHtcbiAgICAgICAgICAgIF9ldmVudHM6IFtdLFxuICAgICAgICAgICAgX211bHRpS2V5U3RhY2s6IFtdLFxuICAgICAgICAgICAgX2V2ZW50c01hcDoge30sXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgX2dldENvbXBvc2l0aW9uRGF0YShcbiAgICAgICAgY29tcG9zaXRpb25FdmVudDogQ29tcG9zaXRpb25FdmVudCB8IHVuZGVmaW5lZCxcbiAgICAgICAgaW5wdXRFdmVudDogSW5wdXRFdmVudCB8IHVuZGVmaW5lZCxcbiAgICApOiBDb21wb3NpdGlvbkRhdGEgfCB1bmRlZmluZWQge1xuICAgICAgICBpZiAoY29tcG9zaXRpb25FdmVudCAmJiBpbnB1dEV2ZW50KSB7XG4gICAgICAgICAgICBsZXQgY29tcG9zaXRpb25EYXRhU3RyaW5nOiBzdHJpbmcgPSBjb21wb3NpdGlvbkV2ZW50LmRhdGE7XG5cbiAgICAgICAgICAgIC8vIFNwZWNpZmljIGNhc2UgZm9yIFN3aWZ0S2V5LiBTd2lmdGtleSBhZGQgYSBzcGFjZSBpbiB0aGVcbiAgICAgICAgICAgIC8vIGlucHV0RXZlbnQgYnV0IG5vdCBpbiB0aGUgY29tcG9zaXRpb24gZXZlbnQuXG4gICAgICAgICAgICBjb25zdCBpc1N3aWZ0S2V5QXV0b2NvcnJlY3QgPVxuICAgICAgICAgICAgICAgIGlucHV0RXZlbnQuaW5wdXRUeXBlID09PSAnaW5zZXJ0VGV4dCcgJiZcbiAgICAgICAgICAgICAgICBpbnB1dEV2ZW50LmRhdGEgJiZcbiAgICAgICAgICAgICAgICBpbnB1dEV2ZW50LmRhdGEubGVuZ3RoID09PSAxICYmXG4gICAgICAgICAgICAgICAgaW5wdXRFdmVudC5kYXRhICE9PSBjb21wb3NpdGlvbkRhdGFTdHJpbmcgJiZcbiAgICAgICAgICAgICAgICBpbnB1dEV2ZW50LmRhdGEgPT09ICcgJztcbiAgICAgICAgICAgIGlmIChpc1N3aWZ0S2V5QXV0b2NvcnJlY3QpIHtcbiAgICAgICAgICAgICAgICBjb21wb3NpdGlvbkRhdGFTdHJpbmcgKz0gJyAnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q29tcG9zaXRpb25Gcm9tU3RyaW5nKGNvbXBvc2l0aW9uRGF0YVN0cmluZyk7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXRFdmVudCAmJiBpbnB1dEV2ZW50LmlucHV0VHlwZSA9PT0gJ2luc2VydFJlcGxhY2VtZW50VGV4dCcpIHtcbiAgICAgICAgICAgIC8vIHNhZmFyaSB0cmlnZ2VyIGFuIGlucHV0IHdpdGggJ2luc2VydFJlcGxhY2VtZW50VGV4dCcgd2hlbiBpdFxuICAgICAgICAgICAgLy8gY29ycmVjdCBhIHdvcmQuXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0Q29tcG9zaXRpb25Gcm9tU3RyaW5nKGlucHV0RXZlbnQuZGF0YSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbmZlciBhIGBLZXlib2FyZEV2ZW50YCBgY29kZWAgZnJvbSBhbiBgSW5wdXRFdmVudGBcbiAgICAgKi9cbiAgICBfaW5mZXJLZXlkb3duRXZlbnQoaW5wdXRFdmVudDogSW5wdXRFdmVudCk6IEluZmVycmVkS2V5ZG93bkV2ZW50IHtcbiAgICAgICAgbGV0IGNvZGU6IEluZmVycmVkQ29kZVZhbHVlO1xuICAgICAgICBpZiAoaW5wdXRFdmVudC5pbnB1dFR5cGUgPT09ICdpbnNlcnRQYXJhZ3JhcGgnKSB7XG4gICAgICAgICAgICBjb2RlID0gJ0VudGVyJztcbiAgICAgICAgfSBlbHNlIGlmIChpbnB1dEV2ZW50LmlucHV0VHlwZSA9PT0gJ2RlbGV0ZUNvbnRlbnRCYWNrd2FyZCcpIHtcbiAgICAgICAgICAgIGNvZGUgPSAnQmFja3NwYWNlJztcbiAgICAgICAgfSBlbHNlIGlmIChpbnB1dEV2ZW50LmlucHV0VHlwZSA9PT0gJ2RlbGV0ZUNvbnRlbnRGb3J3YXJkJykge1xuICAgICAgICAgICAgY29kZSA9ICdEZWxldGUnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIC4uLnRoaXMuX21vZGlmaWVyS2V5cyxcbiAgICAgICAgICAgICAgICBrZXk6IGNvZGUsXG4gICAgICAgICAgICAgICAgY29kZTogY29kZSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IGEga2V5Ym9hcmQgYWN0aW9uIGlmIHNvbWV0aGluZyBoYXMgaGFwcG5lZCBpbiB0aGUgRE9NIChpbnNlcnQsXG4gICAgICogZGVsZXRlLCBuYXZpZ2F0aW9uKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBrZXlcbiAgICAgKiBAcGFyYW0gaW5wdXRUeXBlXG4gICAgICogQHBhcmFtIGhhc011dGF0YWVkRWxlbWVudHNcbiAgICAgKiBAcGFyYW0gaXNNdWx0aUtleVxuICAgICAqL1xuICAgIF9nZXRLZXlib2FyZEFjdGlvbihcbiAgICAgICAga2V5OiBzdHJpbmcsXG4gICAgICAgIGlucHV0VHlwZTogc3RyaW5nLFxuICAgICAgICBoYXNNdXRhdGVkRWxlbWVudHM6IGJvb2xlYW4sXG4gICAgKTpcbiAgICAgICAgfCBJbnNlcnRMaW5lQnJlYWtBY3Rpb25cbiAgICAgICAgfCBJbnNlcnRQYXJhZ3JhcGhCcmVha0FjdGlvblxuICAgICAgICB8IEluc2VydFRleHRBY3Rpb25cbiAgICAgICAgfCBTZXRTZWxlY3Rpb25BY3Rpb25cbiAgICAgICAgfCBEZWxldGVXb3JkQWN0aW9uXG4gICAgICAgIHwgRGVsZXRlSGFyZExpbmVBY3Rpb25cbiAgICAgICAgfCBEZWxldGVDb250ZW50QWN0aW9uIHtcbiAgICAgICAgY29uc3QgaXNJbnNlcnRPclJlbW92ZUFjdGlvbiA9IGhhc011dGF0ZWRFbGVtZW50cyAmJiAhaW5wdXRUeXBlQ29tbWFuZHMuaGFzKGlucHV0VHlwZSk7XG4gICAgICAgIGlmIChpc0luc2VydE9yUmVtb3ZlQWN0aW9uKSB7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSAnQmFja3NwYWNlJyB8fCBrZXkgPT09ICdEZWxldGUnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2dldFJlbW92ZUFjdGlvbihrZXksIGlucHV0VHlwZSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgICAgICAgIGlmIChpbnB1dFR5cGUgPT09ICdpbnNlcnRMaW5lQnJlYWsnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGluc2VydExpbmVCcmVha0FjdGlvbjogSW5zZXJ0TGluZUJyZWFrQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2luc2VydExpbmVCcmVhaycsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnNlcnRMaW5lQnJlYWtBY3Rpb247XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5zZXJ0UGFyYWdyYXBoQWN0aW9uOiBJbnNlcnRQYXJhZ3JhcGhCcmVha0FjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbnNlcnRQYXJhZ3JhcGhCcmVhaycsXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpbnNlcnRQYXJhZ3JhcGhBY3Rpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChrZXkubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5zZXJ0VGV4dEFjdGlvbjogSW5zZXJ0VGV4dEFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2luc2VydFRleHQnLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBrZXksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5zZXJ0VGV4dEFjdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXQgdGhlIGFjdGlvbnMgZm9yIGEgZXZlbnQgYGV2YCBvZiB0eXBlIGRyb3AuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZcbiAgICAgKi9cbiAgICBfZ2V0RHJvcEFjdGlvbnMoZXY6IERhdGFUcmFuc2ZlckRldGFpbHMpOiAoRGVsZXRlQ29udGVudEFjdGlvbiB8IFNldFNlbGVjdGlvbkFjdGlvbilbXSB7XG4gICAgICAgIGNvbnN0IGFjdGlvbnMgPSBbXTtcbiAgICAgICAgaWYgKGV2LmRyYWdnaW5nRnJvbUVkaXRhYmxlICYmICFldi5maWxlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IGRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xuICAgICAgICAgICAgaWYgKCFzZWxlY3Rpb24uaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkZWxldGVDb250ZW50QWN0aW9uOiBEZWxldGVDb250ZW50QWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZGVsZXRlQ29udGVudCcsXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogRGlyZWN0aW9uLkZPUldBUkQsXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBhY3Rpb25zLnB1c2goZGVsZXRlQ29udGVudEFjdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzZXRTZWxlY3Rpb25BY3Rpb246IFNldFNlbGVjdGlvbkFjdGlvbiA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdzZXRTZWxlY3Rpb24nLFxuICAgICAgICAgICAgZG9tU2VsZWN0aW9uOiBldi5zZWxlY3Rpb24sXG4gICAgICAgIH07XG4gICAgICAgIGFjdGlvbnMucHVzaChzZXRTZWxlY3Rpb25BY3Rpb24pO1xuICAgICAgICBhY3Rpb25zLnB1c2godGhpcy5fZ2V0RGF0YVRyYW5zZmVyQWN0aW9uKGV2KSk7XG4gICAgICAgIHJldHVybiBhY3Rpb25zO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGluZm9ybWF0aW9ucyBmcm9tIGRhdGFUcmFuc2VyIHRvIGtub3cgd2hhdCBoYXMgYmVlbiBkb25lIGluIHRoZVxuICAgICAqIERPTSBhbmQgcmV0dXJuIGl0IGEgbm9ybWFsaXplZEFjdGlvbi5cbiAgICAgKlxuICAgICAqIHdoZW4gZHJhZyBhbmQgZHJvcHBpbmcsIG1vc3QgYnJvd3NlcnMgd3JhcCB0aGUgZWxlbWVudCB3aXRoIHRhZ3MgYW5kXG4gICAgICogc3R5bGVzLiAgQW5kIHdoZW4gZHJvcHBpbmcgaW4gdGhlIChzYW1lIG9yIGRpZmZlcmVudCkgYnJvd3NlciwgdGhlcmUgaXNcbiAgICAgKiBtYW55IGRpZmZlcmVudHMgYmVoYXZpb3IuXG4gICAgICpcbiAgICAgKiBTb21lIGJyb3dzZXIgcmVsb2FkIHRoZSBwYWdlIHdoZW4gZHJvcHBpbmcgKGltZyBvciBsaW5rIChmcm9tIHN0YXR1c1xuICAgICAqIGJhcikpLiAgRm9yIHRoaXMgcmVhc29uLCB3ZSBibG9jayBhbGwgdGhlIGNvbnRlbnQgZnJvbSBiZWluZyBhZGRlZCBpbiB0aGVcbiAgICAgKiBlZGl0YWJsZS4gKG90aGVyd2lzZSByZWxvYWRpbmcgaGFwcGVuKS5cbiAgICAgKlxuICAgICAqIE5vdGU6IFRoZSB1c2VyIGNhbiBkcmFnIGFuZCBkcm9wIGEgbGluayBvciBhbiBpbWcsIGZyb20gdGhlIGJyb3dzZXJcbiAgICAgKiBuYXZpZ2F0aW9uIGJhci5cbiAgICAgKlxuICAgICAqL1xuICAgIF9nZXREYXRhVHJhbnNmZXJBY3Rpb24oXG4gICAgICAgIGRhdGFUcmFuc2ZlcjogRGF0YVRyYW5zZmVyRGV0YWlscyxcbiAgICApOiBJbnNlcnRGaWxlc0FjdGlvbiB8IEluc2VydEh0bWxBY3Rpb24gfCBJbnNlcnRUZXh0QWN0aW9uIHtcbiAgICAgICAgaWYgKGRhdGFUcmFuc2Zlci5maWxlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnN0IGluc2VydEZpbGVzQWN0aW9uOiBJbnNlcnRGaWxlc0FjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnaW5zZXJ0RmlsZXMnLFxuICAgICAgICAgICAgICAgIGZpbGVzOiBkYXRhVHJhbnNmZXIuZmlsZXMsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGluc2VydEZpbGVzQWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVyaSA9IGRhdGFUcmFuc2ZlclsndGV4dC91cmktbGlzdCddO1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29udHJvbC1yZWdleFxuICAgICAgICBjb25zdCBodG1sID0gZGF0YVRyYW5zZmVyWyd0ZXh0L2h0bWwnXS5yZXBsYWNlKC9cXHgwMC9nLCAnJyk7IC8vIHJlcGxhY2UgZm9yIGRyYWcmZHJvcCBmcm9tIGZpcmVmb3ggdG8gY2hyb21lXG4gICAgICAgIGNvbnN0IHRleHQgPSBkYXRhVHJhbnNmZXJbJ3RleHQvcGxhaW4nXTtcblxuICAgICAgICBpZiAoaHRtbCAmJiB1cmkpIHtcbiAgICAgICAgICAgIGNvbnN0IHRlbXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZW1wJyk7XG4gICAgICAgICAgICB0ZW1wLmlubmVySFRNTCA9IGh0bWw7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdGVtcC5xdWVyeVNlbGVjdG9yKCdhLCBpbWcnKTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAhZGF0YVRyYW5zZmVyLmRyYWdnaW5nRnJvbUVkaXRhYmxlICYmXG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lKGVsZW1lbnQpID09PSAnQScgJiZcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPT09ICcnXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCBkZWZhdWx0IGNvbnRlbnQgaWYgaXQncyBleHRlcm5hbCBsaW5rXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gdXJpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBpbnNlcnRIdG1sQWN0aW9uOiBJbnNlcnRIdG1sQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaW5zZXJ0SHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGh0bWw6IGVsZW1lbnQub3V0ZXJIVE1MLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB1cmksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5zZXJ0SHRtbEFjdGlvbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaW5zZXJ0SHRtbEFjdGlvbjogSW5zZXJ0SHRtbEFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2luc2VydEh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBodG1sOiBodG1sLFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB1cmksXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5zZXJ0SHRtbEFjdGlvbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChodG1sKSB7XG4gICAgICAgICAgICBjb25zdCBpbnNlcnRIdG1sQWN0aW9uOiBJbnNlcnRIdG1sQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdpbnNlcnRIdG1sJyxcbiAgICAgICAgICAgICAgICAvLyBDcm9zcyBicm93c2VyIGRyYWcgJiBkcm9wIHdpbGwgYWRkIHVzZWxlc3MgbWV0YSB0YWcgYXQgdGhlXG4gICAgICAgICAgICAgICAgLy8gYmVnaW5uaW5nIG9mIHRoZSBodG1sLlxuICAgICAgICAgICAgICAgIGh0bWw6IGh0bWwgJiYgaHRtbC5yZXBsYWNlKC9ePG1ldGFbXj5dKz4vLCAnJyksXG4gICAgICAgICAgICAgICAgdGV4dDogdGV4dCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gaW5zZXJ0SHRtbEFjdGlvbjtcbiAgICAgICAgfSBlbHNlIGlmICh1cmkpIHtcbiAgICAgICAgICAgIGNvbnN0IGluc2VydEh0bWxBY3Rpb246IEluc2VydEh0bWxBY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2luc2VydEh0bWwnLFxuICAgICAgICAgICAgICAgIGh0bWw6ICc8YSBocmVmPVwiJyArIHVyaSArICdcIj4nICsgdXJpICsgJzwvYT4nLFxuICAgICAgICAgICAgICAgIHRleHQ6IHVyaSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gaW5zZXJ0SHRtbEFjdGlvbjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGluc2VydFRleHRBY3Rpb246IEluc2VydFRleHRBY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2luc2VydFRleHQnLFxuICAgICAgICAgICAgICAgIHRleHQ6IHRleHQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIGluc2VydFRleHRBY3Rpb247XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJvY2VzcyB0aGUgY29tcG9zaXRpb24gdG8gaWRlbnRpZnkgdGhlIHRleHQgdGhhdCB3YXMgaW5zZXJ0ZWQuXG4gICAgICpcbiAgICAgKiBBdHRlbnRpb24sIHRoZXJlIGlzIGEgY2FzZSBpbXBvc3NpYmxlIHRvIHJldHJpZXZlIHRoZSBjb21wbGV0ZVxuICAgICAqIGluZm9ybWF0aW9uLiBJbiB0aGUgY2FzZSBvZiB3ZSBkb24ndCBoYXZlIHRoZSBldmVudCBkYXRhIGFuZCBtdXRhdGlvblxuICAgICAqIGFuZCB3ZSBtaWdodCBoYXZlIFwiYSBiXCIgY2hhbmdlIGZyb20gYSBjb21wb3NpdGlvbiB0byBcImEgY1wiLiBXZSByZWNlaXZlXG4gICAgICogdGhlIHdvcmQgY2hhbmdlIFwiYlwiIHRvIFwiY1wiIGluc3RlYWQgb2YgXCJhIGJcIiB0byBcImEgY1wiLlxuICAgICAqXG4gICAgICovXG4gICAgX2dldENvbXBvc2l0aW9uRnJvbVN0cmluZyhjb21wb3NpdGlvbkRhdGE6IHN0cmluZyk6IENvbXBvc2l0aW9uRGF0YSB7XG4gICAgICAgIGNvbnN0IGNoYXJNYXAgPSB0aGlzLl9tdXRhdGlvbk5vcm1hbGl6ZXIuZ2V0Q2hhcmFjdGVyc01hcHBpbmcoKTtcblxuICAgICAgICAvLyBUaGUgZ29hbCBvZiB0aGlzIGZ1bmN0aW9uIGlzIHRvIHByZWNpc2VseSBmaW5kIHdoYXQgd2FzIGluc2VydGVkIGJ5XG4gICAgICAgIC8vIGEga2V5Ym9hcmQgc3VwcG9ydGluZyBzcGVsbC1jaGVja2luZyBhbmQgc3VnZ2VzdGlvbnMuXG4gICAgICAgIC8vIEV4YW1wbGUgKGB8YCByZXByZXNlbnRzIHRoZSB0ZXh0IGN1cnNvcik6XG4gICAgICAgIC8vICAgUHJldmlvdXMgY29udGVudDogJ015IGZyaWVuZCBDaHJpc3RvZmV8IHdhcyBoZXJlLidcbiAgICAgICAgLy8gICBDdXJyZW50IGNvbnRlbnQ6ICAnTXkgZnJpZW5kIENocmlzdG9waGUgTWF0dGhpZXV8IHdhcyBoZXJlLidcbiAgICAgICAgLy8gICBBY3R1YWwgdGV4dCBpbnNlcnRlZCBieSB0aGUga2V5Ym9hcmQ6ICdDaHJpc3RvcGhlIE1hdHRoaWV1J1xuXG4gICAgICAgIGxldCBpbmRleCA9IGNoYXJNYXAuaW5kZXg7XG4gICAgICAgIGxldCBpbnNlcnQgPSBjaGFyTWFwLmluc2VydDtcbiAgICAgICAgbGV0IHJlbW92ZSA9IGNoYXJNYXAucmVtb3ZlO1xuXG4gICAgICAgIGlmIChpbnNlcnQgPT09IHJlbW92ZSAmJiBjb21wb3NpdGlvbkRhdGEpIHtcbiAgICAgICAgICAgIGluc2VydCA9IGNvbXBvc2l0aW9uRGF0YTtcbiAgICAgICAgICAgIHJlbW92ZSA9IGNvbXBvc2l0aW9uRGF0YTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEluIG11dGF0aW9uOlxuICAgICAgICAvLyAtIHdlIGdldCB0aGUgY2hhbmdlc1xuICAgICAgICAvLyAtIHRyeSB0byBleHRyYWN0IHRoZSB3b3JkIG9yIGEgcGFydCBvZiB0aGUgd29yZCAod2l0aCBvciB3aXRob3V0XG4gICAgICAgIC8vICAgcG9zaXRpb24pXG4gICAgICAgIC8vIC0gbG9jYXRlOiB3aGVyZSB0aGUgY2hhbmdlIGhhcyBiZWVuIG1hZGVcblxuICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSB0aGlzLl9nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgLy8gaWYgaW5kZXggPT09IC0xIGl0IG1lYW5zIHdlIGNvdWxkIG5vdCBmaW5kIHRoZSBwb3NpdGlvbiBpbiB0aGUgbXV0YXRlZCBlbGVtZW50c1xuICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICAvLyBJdCBpcyBwb3NzaWJsZSB0aGF0IHRoZSBpbmRleCBvZiB0aGUgb2JzZXJ2ZWQgY2hhbmdlIGFyZVxuICAgICAgICAgICAgLy8gdW5kZWZpbmVkXG4gICAgICAgICAgICAvLyBFeGFtcGxlIChgfGAgcmVwcmVzZW50cyB0aGUgY29sbGFwc2VkIHNlbGVjdGlvbik6XG4gICAgICAgICAgICAvLyAgIFByZXZpb3VzIGNvbnRlbnQ6ICdhYSBhYSBhYXwgYWEgYWEnXG4gICAgICAgICAgICAvLyAgIEN1cnJlbnQgY29udGVudDogICdhYSBhYSBhYSBhYXwgYWEgYWEnXG4gICAgICAgICAgICAvLyAgIEFjdHVhbCB0ZXh0IGluc2VydGVkIGJ5IHRoZSBrZXlib2FyZDogJ2FhICdcbiAgICAgICAgICAgIC8vICAgT2JzZXJ2ZWQgY2hhbmdlOiAgJ2FhIF1hYSBhYSBhYSBhYVsgYWEnXG4gICAgICAgICAgICAvLyBUT0RPIENITTogdGhlIGJlbG93IG1pbi9tYXggZG9lcyBub3QgY292ZXIgYWxsIGNhc2VzXG5cbiAgICAgICAgICAgIC8vIFdpdGggbW9zdCBzcGVsbC1jaGVja2luZyBtb2JpbGUga2V5Ym9hcmRzLCB0aGUgcmFuZ2UgaXMgc2V0IHJpZ2h0XG4gICAgICAgICAgICAvLyBhZnRlciB0aGUgaW5zZXJ0ZWQgdGV4dC4gSXQgY2FuIHRoZW4gYmUgdXNlZCBhcyBhIG1hcmtlciB0b1xuICAgICAgICAgICAgLy8gaWRlbnRpZnkgdGhlIGVuZCBvZiB0aGUgY2hhbmdlLlxuICAgICAgICAgICAgbGV0IGluc2VydEVuZCA9IDA7XG4gICAgICAgICAgICAvLyBUaGUgdGV4dCBoYXMgYmVlbiBmbGF0dGVuZWQgaW4gdGhlIGNoYXJhY3RlcnMgbWFwcGluZy4gV2hlblxuICAgICAgICAgICAgLy8gdGhlIGluZGV4IG9mIHRoZSBub2RlIGhhcyBiZWVuIGZvdW5kLCB1c2UgdGhlIHJhbmdlIG9mZnNldFxuICAgICAgICAgICAgLy8gdG8gZmluZCB0aGUgaW5kZXggb2YgdGhlIGNoYXJhY3RlciBwcm9wZXIuXG4gICAgICAgICAgICBpbnNlcnRFbmQgKz0gc2VsZWN0aW9uLmZvY3VzT2Zmc2V0O1xuICAgICAgICAgICAgaW5kZXggPSBpbnNlcnRFbmQgLSBpbnNlcnQubGVuZ3RoO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGV0IG9mZnNldCA9IGluZGV4ICsgaW5zZXJ0Lmxlbmd0aCAtIDE7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgY2hhck1hcC5jdXJyZW50Lm5vZGVzW29mZnNldF0gJiZcbiAgICAgICAgICAgICAgICAoc2VsZWN0aW9uLmZvY3VzTm9kZSAhPT0gY2hhck1hcC5jdXJyZW50Lm5vZGVzW29mZnNldF0gfHxcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmZvY3VzT2Zmc2V0ICE9PSBjaGFyTWFwLmN1cnJlbnQub2Zmc2V0c1tvZmZzZXRdICsgMSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIG9mZnNldCsrO1xuICAgICAgICAgICAgICAgIHdoaWxlIChcbiAgICAgICAgICAgICAgICAgICAgY2hhck1hcC5jdXJyZW50Lm5vZGVzW29mZnNldF0gJiZcbiAgICAgICAgICAgICAgICAgICAgKHNlbGVjdGlvbi5mb2N1c05vZGUgIT09IGNoYXJNYXAuY3VycmVudC5ub2Rlc1tvZmZzZXRdIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uZm9jdXNPZmZzZXQgPiBjaGFyTWFwLmN1cnJlbnQub2Zmc2V0c1tvZmZzZXRdKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gY2hhck1hcC5jdXJyZW50LmNoYXJzW29mZnNldF07XG4gICAgICAgICAgICAgICAgICAgIGluc2VydCArPSB0ZXh0O1xuICAgICAgICAgICAgICAgICAgICByZW1vdmUgKz0gdGV4dDtcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYmVmb3JlID0gY2hhck1hcC5wcmV2aW91cy5jaGFycy5zbGljZSgwLCBpbmRleCk7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gYmVmb3JlLm1hdGNoKGFscGhhYmV0c0NvbnRhaW5pbmdTcGFjZXMpO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICBtYXRjaCAmJlxuICAgICAgICAgICAgKGluc2VydCA9PT0gJycgfHwgYWxwaGFiZXRzQ29udGFpbmluZ1NwYWNlcy50ZXN0KGluc2VydCkpICYmXG4gICAgICAgICAgICAocmVtb3ZlID09PSAnJyB8fCBhbHBoYWJldHNDb250YWluaW5nU3BhY2VzLnRlc3QocmVtb3ZlKSlcbiAgICAgICAgKSB7XG4gICAgICAgICAgICAvLyB0aGUgd29yZCBpcyB3cml0ZSBpbiBhIGFscGhhYmV0IHdobyBjb250YWluIHNwYWNlLCBzZWFyY2hcbiAgICAgICAgICAgIC8vIHRvIGNvbXBsZXRlIHRoZSBjaGFuZ2UgYW5kIGluY2x1ZGUgdGhlIHJlc3Qgb2YgdGhlIHdvcmRcbiAgICAgICAgICAgIGNvbnN0IGJlZ2luV29yZCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgcmVtb3ZlID0gYmVnaW5Xb3JkICsgcmVtb3ZlO1xuICAgICAgICAgICAgaW5zZXJ0ID0gYmVnaW5Xb3JkICsgaW5zZXJ0O1xuICAgICAgICAgICAgaW5kZXggLT0gYmVnaW5Xb3JkLmxlbmd0aDtcbiAgICAgICAgICAgIC8vIFNvbWUgdmlydHVhbCBrZXlib2FyZHMgKGUuZy4gU3dpZnRLZXkpIGFkZCBhIHNwYWNlIGF0IHRoZSBlbmQgb2ZcbiAgICAgICAgICAgIC8vIGVhY2ggY29tcG9zaXRpb24gc3VjaCB0aGF0IHRoZSBpbnNlcnQgaXMgJyAnLiBXZSBmaWx0ZXIgb3V0IHRob3NlXG4gICAgICAgICAgICAvLyBldmVudHMuXG4gICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICBjb21wb3NpdGlvbkRhdGEgJiZcbiAgICAgICAgICAgIGluc2VydCAmJlxuICAgICAgICAgICAgKHJlbW92ZSB8fCBpbnNlcnQgIT09ICcgJykgJiZcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uRGF0YSAhPT0gaW5zZXJ0XG4gICAgICAgICkge1xuICAgICAgICAgICAgY29uc3QgY2hhckluZGV4ID0gY29tcG9zaXRpb25EYXRhLmxhc3RJbmRleE9mKGluc2VydCk7XG4gICAgICAgICAgICBpZiAoY2hhckluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIGluZGV4IC09IGNoYXJJbmRleDtcbiAgICAgICAgICAgICAgICBpbnNlcnQgPSBjb21wb3NpdGlvbkRhdGE7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVuID0gcmVtb3ZlLmxlbmd0aCArIGNoYXJJbmRleDtcbiAgICAgICAgICAgICAgICByZW1vdmUgPSBjaGFyTWFwLnByZXZpb3VzLmNoYXJzLnNsaWNlKGluZGV4LCBpbmRleCArIGxlbiArIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVHJpbSB0aGUgdHJhaWxpbmcgc3BhY2UgYWRkZWQgYnkgc29tZSB2aXJ0dWFsIGtleWJvYXJkcyAoZS5nLlxuICAgICAgICAvLyBTd2lmdEtleSkuXG4gICAgICAgIGNvbnN0IHJlbW92ZWRFbmRTcGFjZSA9IHJlbW92ZVtyZW1vdmUubGVuZ3RoIC0gMV0gPT09ICcgJztcbiAgICAgICAgY29uc3QgaW5zZXJ0ZWRFbmRTcGFjZSA9IGluc2VydFtpbnNlcnQubGVuZ3RoIC0gMV0gPT09ICcgJztcbiAgICAgICAgbGV0IHJhd1JlbW92ZSA9IHJlbW92ZTtcbiAgICAgICAgbGV0IHJhd0luc2VydCA9IGluc2VydDtcbiAgICAgICAgaWYgKGluc2VydGVkRW5kU3BhY2UgJiYgcmVtb3ZlZEVuZFNwYWNlKSB7XG4gICAgICAgICAgICByYXdSZW1vdmUgPSByYXdSZW1vdmUuc2xpY2UoMCwgLTEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbnNlcnRlZEVuZFNwYWNlKSB7XG4gICAgICAgICAgICByYXdJbnNlcnQgPSByYXdJbnNlcnQuc2xpY2UoMCwgLTEpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcHJldmlvdXNOb2RlcyA9IGNoYXJNYXAucHJldmlvdXMubm9kZXM7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzT2Zmc2V0cyA9IGNoYXJNYXAucHJldmlvdXMub2Zmc2V0cztcbiAgICAgICAgY29uc3QgbGFzdFByZXZpb3VzTm9kZSA9IHByZXZpb3VzTm9kZXNbcHJldmlvdXNOb2Rlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgY29uc3QgbGFzdFByZXZpb3VzT2Zmc2V0ID0gcHJldmlvdXNPZmZzZXRzW3ByZXZpb3VzT2Zmc2V0cy5sZW5ndGggLSAxXSArIDE7XG4gICAgICAgIGNvbnN0IG9mZnNldEVuZCA9IGluZGV4ICsgcmF3UmVtb3ZlLmxlbmd0aDtcbiAgICAgICAgY29uc3Qgc2V0U2VsZWN0aW9uQWN0aW9uOiBTZXRTZWxlY3Rpb25BY3Rpb24gPSB7XG4gICAgICAgICAgICB0eXBlOiAnc2V0U2VsZWN0aW9uJyxcbiAgICAgICAgICAgIGRvbVNlbGVjdGlvbjoge1xuICAgICAgICAgICAgICAgIGFuY2hvck5vZGU6IHByZXZpb3VzTm9kZXNbaW5kZXhdIHx8IGxhc3RQcmV2aW91c05vZGUsXG4gICAgICAgICAgICAgICAgYW5jaG9yT2Zmc2V0OlxuICAgICAgICAgICAgICAgICAgICBpbmRleCBpbiBwcmV2aW91c09mZnNldHMgPyBwcmV2aW91c09mZnNldHNbaW5kZXhdIDogbGFzdFByZXZpb3VzT2Zmc2V0LFxuICAgICAgICAgICAgICAgIGZvY3VzTm9kZTogcHJldmlvdXNOb2Rlc1tvZmZzZXRFbmRdIHx8IGxhc3RQcmV2aW91c05vZGUsXG4gICAgICAgICAgICAgICAgZm9jdXNPZmZzZXQ6XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldEVuZCBpbiBwcmV2aW91c09mZnNldHMgPyBwcmV2aW91c09mZnNldHNbb2Zmc2V0RW5kXSA6IGxhc3RQcmV2aW91c09mZnNldCxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IERpcmVjdGlvbi5GT1JXQVJELFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaW5zZXJ0VGV4dEFjdGlvbjogSW5zZXJ0VGV4dEFjdGlvbiA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdpbnNlcnRUZXh0JyxcbiAgICAgICAgICAgIHRleHQ6IHJhd0luc2VydCxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgYWN0aW9ucyA9IFtzZXRTZWxlY3Rpb25BY3Rpb24sIGluc2VydFRleHRBY3Rpb25dO1xuXG4gICAgICAgIGlmIChpbnNlcnRlZEVuZFNwYWNlKSB7XG4gICAgICAgICAgICBpZiAocmVtb3ZlZEVuZFNwYWNlKSB7XG4gICAgICAgICAgICAgICAgaW5kZXggKz0gcmF3UmVtb3ZlLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIGNvbnN0IHNldFNlbGVjdGlvbkFjdGlvbjogU2V0U2VsZWN0aW9uQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2V0U2VsZWN0aW9uJyxcbiAgICAgICAgICAgICAgICAgICAgZG9tU2VsZWN0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhbmNob3JOb2RlOiBwcmV2aW91c05vZGVzW2luZGV4XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvck9mZnNldDogcHJldmlvdXNPZmZzZXRzW2luZGV4XSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvY3VzTm9kZTogcHJldmlvdXNOb2Rlc1tvZmZzZXRFbmRdLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9jdXNPZmZzZXQ6IHByZXZpb3VzT2Zmc2V0c1tpbmRleCArIDFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBEaXJlY3Rpb24uRk9SV0FSRCxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGFjdGlvbnMucHVzaChzZXRTZWxlY3Rpb25BY3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgaW5zZXJ0VGV4dEFjdGlvbjogSW5zZXJ0VGV4dEFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnaW5zZXJ0VGV4dCcsXG4gICAgICAgICAgICAgICAgdGV4dDogJyAnLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGFjdGlvbnMucHVzaChpbnNlcnRUZXh0QWN0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb21wb3NpdGlvbkZyb206IHJlbW92ZSxcbiAgICAgICAgICAgIGNvbXBvc2l0aW9uVG86IGluc2VydCxcbiAgICAgICAgICAgIGFjdGlvbnM6IGFjdGlvbnMsXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFByb2Nlc3MgdGhlIGdpdmVuIGNvbXBpbGVkIGV2ZW50IGFzIGEgYmFja3NwYWNlL2RlbGV0ZSB0byBpZGVudGlmeSB0aGVcbiAgICAgKiB0ZXh0IHRoYXQgd2FzIHJlbW92ZWQgYW5kIHJldHVybiBhbiBhcnJheSBvZiB0aGUgY29ycmVzcG9uZGluZ1xuICAgICAqIE5vcm1hbGl6ZWRBY3Rpb24uXG4gICAgICpcbiAgICAgKiBJbiB0aGUgY2FzZSBvZiBjdXQgZXZlbnQsIHRoZSBkaXJlY3Rpb24gd2lsbCBiZSBgRGlyZWN0aW9uLkZPUldBUkRgLlxuICAgICAqXG4gICAgICovXG4gICAgX2dldFJlbW92ZUFjdGlvbihcbiAgICAgICAga2V5OiBzdHJpbmcsXG4gICAgICAgIGlucHV0VHlwZTogc3RyaW5nLFxuICAgICk6IERlbGV0ZVdvcmRBY3Rpb24gfCBEZWxldGVIYXJkTGluZUFjdGlvbiB8IERlbGV0ZUNvbnRlbnRBY3Rpb24ge1xuICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBrZXkgPT09ICdCYWNrc3BhY2UnID8gRGlyZWN0aW9uLkJBQ0tXQVJEIDogRGlyZWN0aW9uLkZPUldBUkQ7XG4gICAgICAgIC8vIEdldCBjaGFyYWN0ZXJNYXBwaW5nIHRvIHJldHJpZXZlIHdoaWNoIHdvcmQgaGFzIGJlZW4gZGVsZXRlZC5cbiAgICAgICAgY29uc3QgY2hhcmFjdGVyTWFwcGluZyA9IHRoaXMuX211dGF0aW9uTm9ybWFsaXplci5nZXRDaGFyYWN0ZXJzTWFwcGluZygpO1xuXG4gICAgICAgIGNvbnN0IGlzU3dpZnRLZXlEZWxldGVXb3JkID1cbiAgICAgICAgICAgIChpbnB1dFR5cGUgPT09ICdkZWxldGVDb250ZW50Rm9yd2FyZCcgfHwgaW5wdXRUeXBlID09PSAnZGVsZXRlQ29udGVudEJhY2t3YXJkJykgJiZcbiAgICAgICAgICAgIGNoYXJhY3Rlck1hcHBpbmcucmVtb3ZlLmxlbmd0aCA+IDE7XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgaW5wdXRUeXBlID09PSAnZGVsZXRlV29yZEZvcndhcmQnIHx8XG4gICAgICAgICAgICBpbnB1dFR5cGUgPT09ICdkZWxldGVXb3JkQmFja3dhcmQnIHx8XG4gICAgICAgICAgICBpc1N3aWZ0S2V5RGVsZXRlV29yZFxuICAgICAgICApIHtcbiAgICAgICAgICAgIGNvbnN0IGRlbGV0ZVdvcmRBY3Rpb246IERlbGV0ZVdvcmRBY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2RlbGV0ZVdvcmQnLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLFxuICAgICAgICAgICAgICAgIHRleHQ6IGNoYXJhY3Rlck1hcHBpbmcucmVtb3ZlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBkZWxldGVXb3JkQWN0aW9uO1xuICAgICAgICB9XG4gICAgICAgIGlmIChcbiAgICAgICAgICAgIGlucHV0VHlwZSA9PT0gJ2RlbGV0ZUhhcmRMaW5lRm9yd2FyZCcgfHxcbiAgICAgICAgICAgIGlucHV0VHlwZSA9PT0gJ2RlbGV0ZUhhcmRMaW5lQmFja3dhcmQnIHx8XG4gICAgICAgICAgICBpbnB1dFR5cGUgPT09ICdkZWxldGVTb2Z0TGluZUZvcndhcmQnIHx8XG4gICAgICAgICAgICBpbnB1dFR5cGUgPT09ICdkZWxldGVTb2Z0TGluZUJhY2t3YXJkJ1xuICAgICAgICApIHtcbiAgICAgICAgICAgIGNvbnN0IGRlbGV0ZUhhcmRMaW5lQWN0aW9uOiBEZWxldGVIYXJkTGluZUFjdGlvbiA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnZGVsZXRlSGFyZExpbmUnLFxuICAgICAgICAgICAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLFxuICAgICAgICAgICAgICAgIGRvbVNlbGVjdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBhbmNob3JOb2RlOiBjaGFyYWN0ZXJNYXBwaW5nLnByZXZpb3VzLm5vZGVzW2NoYXJhY3Rlck1hcHBpbmcuaW5kZXhdLFxuICAgICAgICAgICAgICAgICAgICBhbmNob3JPZmZzZXQ6IGNoYXJhY3Rlck1hcHBpbmcucHJldmlvdXMub2Zmc2V0c1tjaGFyYWN0ZXJNYXBwaW5nLmluZGV4XSxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNOb2RlOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyTWFwcGluZy5wcmV2aW91cy5ub2Rlc1tcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJNYXBwaW5nLmluZGV4ICsgY2hhcmFjdGVyTWFwcGluZy5yZW1vdmUubGVuZ3RoIC0gMVxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNPZmZzZXQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFyYWN0ZXJNYXBwaW5nLnByZXZpb3VzLm9mZnNldHNbXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhcmFjdGVyTWFwcGluZy5pbmRleCArIGNoYXJhY3Rlck1hcHBpbmcucmVtb3ZlLmxlbmd0aCAtIDFcbiAgICAgICAgICAgICAgICAgICAgICAgIF0gKyAxLFxuICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246IGRpcmVjdGlvbixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBkZWxldGVIYXJkTGluZUFjdGlvbjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkZWxldGVDb250ZW50QWN0aW9uOiBEZWxldGVDb250ZW50QWN0aW9uID0ge1xuICAgICAgICAgICAgdHlwZTogJ2RlbGV0ZUNvbnRlbnQnLFxuICAgICAgICAgICAgZGlyZWN0aW9uOiBkaXJlY3Rpb24sXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkZWxldGVDb250ZW50QWN0aW9uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gbm9kZSBjYW4gYmUgY29uc2lkZXJlZCBhIHRleHR1YWwgbm9kZSwgdGhhdCBpc1xuICAgICAqIGEgdGV4dCBub2RlIG9yIGEgQlIgbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgX2lzVGV4dHVhbE5vZGUobm9kZTogTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUgfHwgbm9kZU5hbWUobm9kZSkgPT09ICdCUic7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgY3VycmVudCBzZWxlY3Rpb24gZnJvbSB0aGUgRE9NLiBJZiB0aGVyZSBpcyBubyBzZWxlY3Rpb24gaW4gdGhlXG4gICAgICogRE9NLCByZXR1cm4gYSBmYWtlIG9uZSBhdCBvZmZzZXQgMCBvZiB0aGUgZWRpdGFibGUgZWxlbWVudC5cbiAgICAgKiBJZiBhbiBldmVudCBpcyBnaXZlbiwgdGhlbiB0aGUgc2VsZWN0aW9uIG11c3QgYmUgYXQgbGVhc3QgcGFydGlhbGx5XG4gICAgICogY29udGFpbmVkIGluIHRoZSB0YXJnZXQgb2YgdGhlIGV2ZW50LCBvdGhlcndpc2UgaXQgbWVhbnMgaXQgdG9vayBub1xuICAgICAqIHBhcnQgaW4gaXQuIEluIHRoaXMgY2FzZSwgcmV0dXJuIHRoZSBjYXJldCBwb3NpdGlvbiBpbnN0ZWFkLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtldl1cbiAgICAgKi9cbiAgICBfZ2V0U2VsZWN0aW9uKGV2PzogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpOiBEb21TZWxlY3Rpb25EZXNjcmlwdGlvbiB7XG4gICAgICAgIGxldCBzZWxlY3Rpb25EZXNjcmlwdGlvbjogRG9tU2VsZWN0aW9uRGVzY3JpcHRpb247XG4gICAgICAgIGxldCB0YXJnZXQ6IE5vZGU7XG4gICAgICAgIGxldCByb290OiBEb2N1bWVudCB8IFNoYWRvd1Jvb3Q7XG4gICAgICAgIGlmIChldikge1xuICAgICAgICAgICAgdGFyZ2V0ID0gdGhpcy5fZ2V0RXZlbnRUYXJnZXQoZXYpO1xuICAgICAgICAgICAgcm9vdCA9IGdldERvY3VtZW50KHRhcmdldCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5faW5pdGlhbENhcmV0UG9zaXRpb24/Lm9mZnNldE5vZGUpIHtcbiAgICAgICAgICAgIHJvb3QgPSBnZXREb2N1bWVudCh0aGlzLl9pbml0aWFsQ2FyZXRQb3NpdGlvbi5vZmZzZXROb2RlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJvb3QgPSBkb2N1bWVudDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IHJvb3QuZ2V0U2VsZWN0aW9uKCk7XG5cbiAgICAgICAgbGV0IGZvcndhcmQ6IGJvb2xlYW47XG4gICAgICAgIGlmICghc2VsZWN0aW9uIHx8IHNlbGVjdGlvbi5yYW5nZUNvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAvLyBObyBzZWxlY3Rpb24gaW4gdGhlIERPTS4gQ3JlYXRlIGEgZmFrZSBvbmUuXG4gICAgICAgICAgICBzZWxlY3Rpb25EZXNjcmlwdGlvbiA9IHtcbiAgICAgICAgICAgICAgICBhbmNob3JOb2RlOiBkb2N1bWVudC5ib2R5LFxuICAgICAgICAgICAgICAgIGFuY2hvck9mZnNldDogMCxcbiAgICAgICAgICAgICAgICBmb2N1c05vZGU6IGRvY3VtZW50LmJvZHksXG4gICAgICAgICAgICAgICAgZm9jdXNPZmZzZXQ6IDAsXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBEaXJlY3Rpb24uRk9SV0FSRCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBUaGUgc2VsZWN0aW9uIGRpcmVjdGlvbiBpcyBzb3JlbHkgbWlzc2luZyBmcm9tIHRoZSBET00gYXBpLlxuICAgICAgICAgICAgY29uc3QgbmF0aXZlUmFuZ2UgPSBzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKTtcbiAgICAgICAgICAgIGlmIChzZWxlY3Rpb24uYW5jaG9yTm9kZSA9PT0gc2VsZWN0aW9uLmZvY3VzTm9kZSkge1xuICAgICAgICAgICAgICAgIGZvcndhcmQgPSBzZWxlY3Rpb24uYW5jaG9yT2Zmc2V0IDw9IHNlbGVjdGlvbi5mb2N1c09mZnNldDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yd2FyZCA9IHNlbGVjdGlvbi5hbmNob3JOb2RlID09PSBuYXRpdmVSYW5nZS5zdGFydENvbnRhaW5lcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNlbGVjdGlvbkRlc2NyaXB0aW9uID0ge1xuICAgICAgICAgICAgICAgIGFuY2hvck5vZGU6IHNlbGVjdGlvbi5hbmNob3JOb2RlLFxuICAgICAgICAgICAgICAgIGFuY2hvck9mZnNldDogc2VsZWN0aW9uLmFuY2hvck9mZnNldCxcbiAgICAgICAgICAgICAgICBmb2N1c05vZGU6IHNlbGVjdGlvbi5mb2N1c05vZGUsXG4gICAgICAgICAgICAgICAgZm9jdXNPZmZzZXQ6IHNlbGVjdGlvbi5mb2N1c09mZnNldCxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IGZvcndhcmQgPyBEaXJlY3Rpb24uRk9SV0FSRCA6IERpcmVjdGlvbi5CQUNLV0FSRCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBhbiBldmVudCBpcyBnaXZlbiwgdGhlbiB0aGUgcmFuZ2UgbXVzdCBiZSBhdCBsZWFzdCBwYXJ0aWFsbHlcbiAgICAgICAgLy8gY29udGFpbmVkIGluIHRoZSB0YXJnZXQgb2YgdGhlIGV2ZW50LCBvdGhlcndpc2UgaXQgbWVhbnMgaXQgdG9vayBub1xuICAgICAgICAvLyBwYXJ0IGluIGl0LiBJbiB0aGlzIGNhc2UsIGNvbnNpZGVyIHRoZSBjYXJldCBwb3NpdGlvbiBpbnN0ZWFkLlxuICAgICAgICAvLyBUaGlzIGNhbiBoYXBwZW4gd2hlbiB0YXJnZXQgaXMgYW4gaW5wdXQgb3IgYSBjb250ZW50ZWRpdGFibGU9ZmFsc2UuXG4gICAgICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBOb2RlKSB7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgIXRhcmdldC5jb250YWlucyhzZWxlY3Rpb25EZXNjcmlwdGlvbi5hbmNob3JOb2RlKSAmJlxuICAgICAgICAgICAgICAgICF0YXJnZXQuY29udGFpbnMoc2VsZWN0aW9uRGVzY3JpcHRpb24uZm9jdXNOb2RlKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FyZXRQb3NpdGlvbiA9IHRoaXMuX2dldEV2ZW50Q2FyZXRQb3NpdGlvbihldik7XG4gICAgICAgICAgICAgICAgc2VsZWN0aW9uRGVzY3JpcHRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIGFuY2hvck5vZGU6IGNhcmV0UG9zaXRpb24ub2Zmc2V0Tm9kZSxcbiAgICAgICAgICAgICAgICAgICAgYW5jaG9yT2Zmc2V0OiBjYXJldFBvc2l0aW9uLm9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgZm9jdXNOb2RlOiBjYXJldFBvc2l0aW9uLm9mZnNldE5vZGUsXG4gICAgICAgICAgICAgICAgICAgIGZvY3VzT2Zmc2V0OiBjYXJldFBvc2l0aW9uLm9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0aW9uOiBEaXJlY3Rpb24uRk9SV0FSRCxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlbGVjdGlvbkRlc2NyaXB0aW9uO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiB0aGUgZ2l2ZW4gcmFuZ2UgaXMgc2VsZWN0aW5nIHRoZSB3aG9sZSBlZGl0YWJsZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzZWxlY3Rpb25cbiAgICAgKi9cbiAgICBfaXNTZWxlY3RBbGwoc2VsZWN0aW9uOiBEb21TZWxlY3Rpb25EZXNjcmlwdGlvbik6IGJvb2xlYW4ge1xuICAgICAgICAvLyBUaGUgc2VsZWN0aW9uIGZyb20gdGhlIGNvbnRleHQgbWVudSBvciBhIHNob3J0Y3V0IG5ldmVyIGhhdmVcbiAgICAgICAgLy8gZGlyZWN0aW9uIGZvcndhcmQuXG4gICAgICAgIGlmIChzZWxlY3Rpb24uZGlyZWN0aW9uID09PSBEaXJlY3Rpb24uQkFDS1dBUkQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBzdGFydENvbnRhaW5lciA9IHNlbGVjdGlvbi5hbmNob3JOb2RlO1xuICAgICAgICBsZXQgc3RhcnRPZmZzZXQgPSBzZWxlY3Rpb24uYW5jaG9yT2Zmc2V0O1xuICAgICAgICBsZXQgZW5kQ29udGFpbmVyID0gc2VsZWN0aW9uLmZvY3VzTm9kZTtcbiAgICAgICAgbGV0IGVuZE9mZnNldCA9IHNlbGVjdGlvbi5mb2N1c09mZnNldDtcblxuICAgICAgICAvLyBUaGUgc2VsZWN0aW9uIG1pZ2h0IHN0aWxsIGJlIG9uIGEgbm9kZSB3aGljaCBoYXMgc2luY2UgYmVlbiByZW1vdmVkLlxuICAgICAgICBsZXQgaW52YWxpZFN0YXJ0ID0gdHJ1ZTtcbiAgICAgICAgbGV0IGRvbU5vZGUgPSBzdGFydENvbnRhaW5lcjtcbiAgICAgICAgd2hpbGUgKGRvbU5vZGUgJiYgaW52YWxpZFN0YXJ0KSB7XG4gICAgICAgICAgICBpZiAoZG9tTm9kZSBpbnN0YW5jZW9mIFNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgICAgICBkb21Ob2RlID0gZG9tTm9kZS5ob3N0O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5ib2R5LmNvbnRhaW5zKGRvbU5vZGUpKSB7XG4gICAgICAgICAgICAgICAgaW52YWxpZFN0YXJ0ID0gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRvbU5vZGUgPSBkb21Ob2RlLnBhcmVudE5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGludmFsaWRFbmQgPSB0cnVlO1xuICAgICAgICBkb21Ob2RlID0gZW5kQ29udGFpbmVyO1xuICAgICAgICB3aGlsZSAoZG9tTm9kZSAmJiBpbnZhbGlkRW5kKSB7XG4gICAgICAgICAgICBpZiAoZG9tTm9kZSBpbnN0YW5jZW9mIFNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgICAgICBkb21Ob2RlID0gZG9tTm9kZS5ob3N0O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkb2N1bWVudC5ib2R5LmNvbnRhaW5zKGRvbU5vZGUpKSB7XG4gICAgICAgICAgICAgICAgaW52YWxpZEVuZCA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkb21Ob2RlID0gZG9tTm9kZS5wYXJlbnROb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGludmFsaWRTZWxlY3Rpb24gPSBpbnZhbGlkU3RhcnQgfHwgaW52YWxpZEVuZDtcblxuICAgICAgICAvLyBUaGUgc2VsZWN0aW9uIG1pZ2h0IGJlIGNvbGxhcHNlZCBpbiB3aGljaCBjYXNlIHRoZXJlIGlzIG5vIHNlbGVjdGlvbi5cbiAgICAgICAgY29uc3Qgb25seU9uZU5vZGVTZWxlY3RlZCA9IHN0YXJ0Q29udGFpbmVyID09PSBlbmRDb250YWluZXI7XG4gICAgICAgIGNvbnN0IG5vQ2hhcmFjdGVyU2VsZWN0ZWQgPSBzdGFydE9mZnNldCA9PT0gZW5kT2Zmc2V0O1xuICAgICAgICBjb25zdCBpc0NvbGxhcHNlZCA9IG9ubHlPbmVOb2RlU2VsZWN0ZWQgJiYgbm9DaGFyYWN0ZXJTZWxlY3RlZDtcblxuICAgICAgICAvLyBJZiB0aGUgc2VsZWN0aW9uIGlzIGludmFsaWQgb3IgdGhlIHNlbGVjdGlvbiBpcyBjb2xsYXBzZWQsIGl0XG4gICAgICAgIC8vIGRlZmluaXRlbHkgZG9lcyBub3QgY29ycmVzcG9uZCB0byBhIHNlbGVjdCBhbGwgYWN0aW9uLlxuICAgICAgICBpZiAoaW52YWxpZFNlbGVjdGlvbiB8fCBpc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgW3N0YXJ0Q29udGFpbmVyLCBzdGFydE9mZnNldF0gPSB0YXJnZXREZWVwZXN0KHN0YXJ0Q29udGFpbmVyLCBzdGFydE9mZnNldCk7XG4gICAgICAgIFtlbmRDb250YWluZXIsIGVuZE9mZnNldF0gPSB0YXJnZXREZWVwZXN0KGVuZENvbnRhaW5lciwgZW5kT2Zmc2V0KTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBzdGFydE9mZnNldCAhPT0gMCB8fFxuICAgICAgICAgICAgKGVuZENvbnRhaW5lci5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUgJiZcbiAgICAgICAgICAgICAgICBlbmRPZmZzZXQgIT09IGVuZENvbnRhaW5lci50ZXh0Q29udGVudC5sZW5ndGgpXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTG9vayBmb3IgdmlzaWJsZSBub2RlcyBpbiBlZGl0YWJsZSB0aGF0IHdvdWxkIGJlIG91dHNpZGUgdGhlIHNlbGVjdGlvbi5cbiAgICAgICAgY29uc3Qgc3RhcnRJbnNpZGUgPSB0aGlzLl9pc0luRWRpdGFibGUoc3RhcnRDb250YWluZXIpO1xuICAgICAgICBjb25zdCBlbmRJbnNpZGUgPSB0aGlzLl9pc0luRWRpdGFibGUoZW5kQ29udGFpbmVyKTtcbiAgICAgICAgY29uc3Qgc3RhcnRFZGdlID0gc3RhcnRJbnNpZGUgJiYgdGhpcy5faXNBdFZpc2libGVFZGdlKHN0YXJ0Q29udGFpbmVyLCAnc3RhcnQnKTtcbiAgICAgICAgY29uc3QgZW5kRWRnZSA9IGVuZEluc2lkZSAmJiB0aGlzLl9pc0F0VmlzaWJsZUVkZ2UoZW5kQ29udGFpbmVyLCAnZW5kJyk7XG4gICAgICAgIHJldHVybiAoc3RhcnRFZGdlICYmIGVuZEVkZ2UpIHx8IChzdGFydEVkZ2UgJiYgIWVuZEluc2lkZSkgfHwgKCFzdGFydEluc2lkZSAmJiBlbmRFZGdlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIGVsZW1lbnQgaXMgYXQgdGhlIGVkZ2Ugb2YgdGhlIGVkaXRhYmxlIG5vZGUgaW5cbiAgICAgKiB0aGUgZ2l2ZW4gZGlyZWN0aW9uLiBBbiBlbGVtZW50IGlzIGNvbnNpZGVyZWQgYXQgdGhlIGVkZ2Ugb2YgdGhlIGVkaXRhYmxlXG4gICAgICogbm9kZSBpZiB0aGVyZSBpcyBubyBvdGhlciB2aXNpYmxlIGVsZW1lbnQgaW4gZWRpdGFibGUgdGhhdCBpcyBsb2NhdGVkXG4gICAgICogYmV5b25kIGl0IGluIHRoZSBnaXZlbiBkaXJlY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZSB0byBjaGVjayB3aGV0aGVyIGl0IGlzIGF0IHRoZSB2aXNpYmxlIGVkZ2VcbiAgICAgKiBAcGFyYW0gc2lkZSBmcm9tIHdoaWNoIHRvIGxvb2sgZm9yIHRleHR1YWwgbm9kZXMgKCdzdGFydCcgb3IgJ2VuZCcpXG4gICAgICovXG4gICAgX2lzQXRWaXNpYmxlRWRnZShub2RlOiBOb2RlLCBzaWRlOiAnc3RhcnQnIHwgJ2VuZCcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50ID8gbm9kZSA6IG5vZGUucGFyZW50RWxlbWVudDtcbiAgICAgICAgY29uc3QgZWRpdGFibGU6IEVsZW1lbnQgPSBlbGVtZW50LmNsb3Nlc3QoJ1tjb250ZW50RWRpdGFibGU9dHJ1ZV0nKTtcblxuICAgICAgICAvLyBTdGFydCBmcm9tIHRoZSB0b3AgYW5kIGRvIGEgZGVwdGgtZmlyc3Qgc2VhcmNoIHRyeWluZyB0byBmaW5kIGFcbiAgICAgICAgLy8gdmlzaWJsZSBub2RlIHRoYXQgd291bGQgYmUgaW4gZWRpdGFibGUgYW5kIGJleW9uZCB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgICAgbGV0IGN1cnJlbnROb2RlOiBOb2RlID0gZWRpdGFibGU7XG4gICAgICAgIGNvbnN0IGNoaWxkID0gc2lkZSA9PT0gJ3N0YXJ0JyA/ICdmaXJzdENoaWxkJyA6ICdsYXN0Q2hpbGQnO1xuICAgICAgICBjb25zdCBzaWJsaW5nID0gc2lkZSA9PT0gJ3N0YXJ0JyA/ICduZXh0U2libGluZycgOiAncHJldmlvdXNTaWJsaW5nJztcbiAgICAgICAgbGV0IGNyb3NzVmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICB3aGlsZSAoY3VycmVudE5vZGUpIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50Tm9kZSA9PT0gbm9kZSkge1xuICAgICAgICAgICAgICAgIC8vIFRoZSBlbGVtZW50IHdhcyByZWFjaGVkIHdpdGhvdXQgZmluZGluZyBhbm90aGVyIHZpc2libGUgbm9kZS5cbiAgICAgICAgICAgICAgICByZXR1cm4gIWNyb3NzVmlzaWJsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1RleHR1YWxOb2RlKGN1cnJlbnROb2RlKSAmJiB0aGlzLl9pc1Zpc2libGUoY3VycmVudE5vZGUsIGVkaXRhYmxlKSkge1xuICAgICAgICAgICAgICAgIC8vIFRoZXJlIGlzIGEgdGV4dHVhbCBub2RlIGluIGVkaXRhYmxlIGJleW9uZCB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICAgICAgICAgICAgICBjcm9zc1Zpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gQ29udGludWUgdGhlIGRlcHRoLWZpcnN0IHNlYXJjaC5cbiAgICAgICAgICAgIGlmIChjdXJyZW50Tm9kZVtjaGlsZF0pIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlW2NoaWxkXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY3VycmVudE5vZGVbc2libGluZ10pIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlW3NpYmxpbmddO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50Tm9kZS5wYXJlbnROb2RlID09PSBlZGl0YWJsZSkge1xuICAgICAgICAgICAgICAgIC8vIERlcHRoLWZpcnN0IHNlYXJjaCBoYXMgY2hlY2tlZCBhbGwgZWxlbWVudHMgaW4gZWRpdGFibGUuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUucGFyZW50Tm9kZVtzaWJsaW5nXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERldGVybWluZSBpZiBhIG5vZGUgaXMgY29uc2lkZXJlZCB2aXNpYmxlLlxuICAgICAqL1xuICAgIF9pc1Zpc2libGUoZWw6IE5vZGUsIGVkaXRhYmxlOiBFbGVtZW50KTogYm9vbGVhbiB7XG4gICAgICAgIGlmIChlbCA9PT0gZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZWwgPT09IGVkaXRhYmxlKSB7XG4gICAgICAgICAgICAvLyBUaGUgZWRpdGFibGUgbm9kZSB3YXMgcmVhY2hlZCB3aXRob3V0IGVuY291bnRlcmluZyBhIGhpZGRlblxuICAgICAgICAgICAgLy8gY29udGFpbmVyLiBUaGUgZWRpdGFibGUgbm9kZSBpcyBzdXBwb3NlZCB0byBiZSB2aXNpYmxlLlxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQSA8YnI+IGVsZW1lbnQgd2l0aCBubyBuZXh0IHNpYmxpbmcgaXMgbmV2ZXIgdmlzaWJsZS5cbiAgICAgICAgaWYgKG5vZGVOYW1lKGVsKSA9PT0gJ0JSJyAmJiAhZWwubmV4dFNpYmxpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBlbGVtZW50ID0gZWwubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFID8gZWwucGFyZW50RWxlbWVudCA6IGVsO1xuICAgICAgICBjb25zdCBzdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQgYXMgRWxlbWVudCk7XG4gICAgICAgIGlmIChzdHlsZS5kaXNwbGF5ID09PSAnbm9uZScgfHwgc3R5bGUudmlzaWJpbGl0eSA9PT0gJ2hpZGRlbicpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5faXNWaXNpYmxlKGVsLnBhcmVudE5vZGUsIGVkaXRhYmxlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBub2RlIGFuZCBvZmZzZXQgdGFyZ2V0ZWQgYnkgYSBldmVudCwgaW5jbHVkaW5nIGlmIHRoZSB0YXJnZXRcbiAgICAgKiBpcyBpbnNpZGUgYSBzaGFkb3cgZWxlbWVudFxuICAgICAqXG4gICAgICogQHBhcmFtIGV2XG4gICAgICovXG4gICAgX2dldEV2ZW50Q2FyZXRQb3NpdGlvbihldjogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpOiBDYXJldFBvc2l0aW9uIHtcbiAgICAgICAgY29uc3QgeCA9IGV2IGluc3RhbmNlb2YgTW91c2VFdmVudCA/IGV2LmNsaWVudFggOiBldi50b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICAgIGNvbnN0IHkgPSBldiBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgPyBldi5jbGllbnRZIDogZXYudG91Y2hlc1swXS5jbGllbnRZO1xuICAgICAgICBsZXQgY2FyZXRQb3NpdGlvbiA9IGNhcmV0UG9zaXRpb25Gcm9tUG9pbnQoeCwgeSk7XG4gICAgICAgIGlmICghY2FyZXRQb3NpdGlvbiB8fCAhdGhpcy5faXNJbkVkaXRhYmxlKGNhcmV0UG9zaXRpb24ub2Zmc2V0Tm9kZSkpIHtcbiAgICAgICAgICAgIGNhcmV0UG9zaXRpb24gPSB7IG9mZnNldE5vZGU6IGV2LnRhcmdldCBhcyBOb2RlLCBvZmZzZXQ6IDAgfTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2FyZXRQb3NpdGlvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXNlIHRoZSBwb3NpdGlvbiB0byBnZXQgdGhlIHRhcmdldCBmcm9tIHRoZSBldmVudCAoaW5jbHVkaW5nIHRoZSB0YXJnZXRcbiAgICAgKiBpbiBzaGFkb3cgZWxlbWVudClcbiAgICAgKlxuICAgICAqIEBwYXJhbSBldlxuICAgICAqL1xuICAgIF9nZXRFdmVudFRhcmdldChldjogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpOiBOb2RlIHtcbiAgICAgICAgY29uc3QgeCA9IGV2IGluc3RhbmNlb2YgTW91c2VFdmVudCA/IGV2LmNsaWVudFggOiBldi50b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICAgIGNvbnN0IHkgPSBldiBpbnN0YW5jZW9mIE1vdXNlRXZlbnQgPyBldi5jbGllbnRZIDogZXYudG91Y2hlc1swXS5jbGllbnRZO1xuICAgICAgICByZXR1cm4gZWxlbWVudEZyb21Qb2ludCh4LCB5KSB8fCAoZXYudGFyZ2V0IGFzIE5vZGUpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBIYW5kbGVyc1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIENhdGNoIHNldFNlbGVjdGlvbiBhbmQgc2VsZWN0QWxsIGFjdGlvbnNcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZcbiAgICAgKi9cbiAgICBfb25Db250ZXh0TWVudShldjogTW91c2VFdmVudCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5fcG9pbnRlclNlbGVjdGlvblRpbWVvdXQ/LnBlbmRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX3BvaW50ZXJTZWxlY3Rpb25UaW1lb3V0LmZpcmUoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9wb2ludGVyU2VsZWN0aW9uVGltZW91dCA9IG5ldyBUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fc2VsZWN0aW9uSGFzQ2hhbmdlZCB8fCB0aGlzLl9jdXJyZW50bHlTZWxlY3RpbmdBbGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBhY3Rpb25zOiBbXSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5faW5pdGlhbENhcmV0UG9zaXRpb24gPSB0aGlzLl9nZXRFdmVudENhcmV0UG9zaXRpb24oZXYpO1xuICAgICAgICAgICAgY29uc3Qgc2V0U2VsZWN0aW9uQWN0aW9uOiBTZXRTZWxlY3Rpb25BY3Rpb24gPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3NldFNlbGVjdGlvbicsXG4gICAgICAgICAgICAgICAgZG9tU2VsZWN0aW9uOiB0aGlzLl9nZXRTZWxlY3Rpb24oZXYpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuX3NlbGVjdGlvbkhhc0NoYW5nZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYWN0aW9uczogW3NldFNlbGVjdGlvbkFjdGlvbl0sXG4gICAgICAgICAgICAgICAgbXV0YXRlZEVsZW1lbnRzOiBuZXcgU2V0KFtdKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLl90cmlnZ2VyRXZlbnRCYXRjaCh0aGlzLl9wb2ludGVyU2VsZWN0aW9uVGltZW91dC5wcm9taXNlKTtcbiAgICAgICAgLy8gVGhlIF9jbGlja2VkSW5FZGl0YWJsZSBwcm9wZXJ0eSBpcyB1c2VkIHRvIGFzc2VzcyB3aGV0aGVyIHRoZSB1c2VyIGlzXG4gICAgICAgIC8vIGN1cnJlbnRseSBjaGFuZ2luZyB0aGUgc2VsZWN0aW9uIGJ5IHVzaW5nIHRoZSBtb3VzZS4gSWYgdGhlIGNvbnRleHRcbiAgICAgICAgLy8gbWVudSBlbmRzIHVwIG9wZW5pbmcsIHRoZSB1c2VyIGlzIGRlZmluaXRlbHkgbm90IHNlbGVjdGluZy5cbiAgICAgICAgdGhpcy5fbW91c2Vkb3duSW5FZGl0YWJsZSA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYXRjaCBFbnRlciwgQmFja3NwYWNlLCBEZWxldGUgYW5kIGluc2VydCBhY3Rpb25zXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGV2XG4gICAgICovXG4gICAgX29uS2V5RG93bk9yS2V5UHJlc3MoZXY6IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlTW9kaWZpZXJzS2V5cyhldik7XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyRXZlbnQoZXYpO1xuICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSB0aGlzLl9nZXRTZWxlY3Rpb24oKTtcbiAgICAgICAgY29uc3QgW29mZnNldE5vZGUsIG9mZnNldF0gPSB0YXJnZXREZWVwZXN0KHNlbGVjdGlvbi5hbmNob3JOb2RlLCBzZWxlY3Rpb24uYW5jaG9yT2Zmc2V0KTtcbiAgICAgICAgdGhpcy5faW5pdGlhbENhcmV0UG9zaXRpb24gPSB7IG9mZnNldE5vZGUsIG9mZnNldCB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgaW50ZXJuYWwgcHJvcGVydGllcyBvZiB0aGUgcG9pbnRlciBkb3duIGV2ZW50IHRvIHJldHJpZXZlIHRoZW0gbGF0ZXJcbiAgICAgKiBvbiB3aGVuIHRoZSB1c2VyIHN0b3BzIGRyYWdnaW5nIGl0cyBzZWxlY3Rpb24gYW5kIHRoZSBzZWxlY3Rpb24gaGFzXG4gICAgICogY2hhbmdlZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7TW91c2VFdmVudH0gZXZcbiAgICAgKi9cbiAgICBfb25Qb2ludGVyRG93bihldjogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgLy8gRG9uJ3QgdHJpZ2dlciBldmVudHMgb24gdGhlIGVkaXRhYmxlIGlmIHRoZSBjbGljayB3YXMgZG9uZSBvdXRzaWRlIG9mXG4gICAgICAgIC8vIHRoZSBlZGl0YWJsZSBpdHNlbGYgb3Igb24gc29tZXRoaW5nIGVsc2UgdGhhbiBhbiBlbGVtZW50LlxuICAgICAgICBjb25zdCB0YXJnZXQgPSB0aGlzLl9nZXRFdmVudFRhcmdldChldik7XG4gICAgICAgIGlmICh0YXJnZXQgJiYgdGhpcy5faXNJbkVkaXRhYmxlKHRhcmdldCkpIHtcbiAgICAgICAgICAgIHRoaXMuX21vdXNlZG93bkluRWRpdGFibGUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5faW5pdGlhbENhcmV0UG9zaXRpb24gPSB0aGlzLl9nZXRFdmVudENhcmV0UG9zaXRpb24oZXYpO1xuICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uSGFzQ2hhbmdlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fZm9sbG93c1BvaW50ZXJBY3Rpb24gPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fbW91c2Vkb3duSW5FZGl0YWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5faW5pdGlhbENhcmV0UG9zaXRpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2F0Y2ggc2V0U2VsZWN0aW9uIGFjdGlvbnMgY29taW5nIGZyb20gY2xpY2tzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGV2XG4gICAgICovXG4gICAgX29uUG9pbnRlclVwKGV2OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBEb24ndCB0cmlnZ2VyIGV2ZW50cyBvbiB0aGUgZWRpdGFibGUgaWYgdGhlIGNsaWNrIHdhcyBkb25lIG91dHNpZGUgb2ZcbiAgICAgICAgICAgIC8vIHRoZSBlZGl0YWJsZSBpdHNlbGYgb3Igb24gc29tZXRoaW5nIGVsc2UgdGhhbiBhbiBlbGVtZW50LlxuICAgICAgICAgICAgaWYgKHRoaXMuX21vdXNlZG93bkluRWRpdGFibGUgJiYgZXYudGFyZ2V0IGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIC8vIFdoZW4gdGhlIHVzZXJzIGNsaWNrcyBpbiB0aGUgRE9NLCB0aGUgcmFuZ2UgaXMgc2V0IGluIHRoZSBuZXh0XG4gICAgICAgICAgICAgICAgLy8gdGljay4gVGhlIG9ic2VydmF0aW9uIG9mIHRoZSByZXN1bHRpbmcgcmFuZ2UgbXVzdCB0aHVzIGJlIGRlbGF5ZWRcbiAgICAgICAgICAgICAgICAvLyB0byB0aGUgbmV4dCB0aWNrIGFzIHdlbGwuIFN0b3JlIHRoZSBkYXRhIHdlIGhhdmUgbm93IGJlZm9yZSBpdFxuICAgICAgICAgICAgICAgIC8vIGdldHMgaW52YWxpZGF0ZWQgYnkgdGhlIHJlZHJhd2luZyBvZiB0aGUgRE9NLlxuICAgICAgICAgICAgICAgIHRoaXMuX2luaXRpYWxDYXJldFBvc2l0aW9uID0gdGhpcy5fZ2V0RXZlbnRDYXJldFBvc2l0aW9uKGV2KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wb2ludGVyU2VsZWN0aW9uVGltZW91dCA9IG5ldyBUaW1lb3V0PEV2ZW50QmF0Y2g+KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2FuYWx5emVTZWxlY3Rpb25DaGFuZ2UoZXYpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RyaWdnZXJFdmVudEJhdGNoKHRoaXMuX3BvaW50ZXJTZWxlY3Rpb25UaW1lb3V0LnByb21pc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICB0aGlzLl9tb3VzZWRvd25JbkVkaXRhYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9pbml0aWFsQ2FyZXRQb3NpdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBBbmFseXplIGEgY2hhbmdlIG9mIHNlbGVjdGlvbiB0byB0cmlnZ2VyIGEgcG9pbnRlciBldmVudCBmb3IgaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZXZcbiAgICAgKi9cbiAgICBfYW5hbHl6ZVNlbGVjdGlvbkNoYW5nZShldjogTW91c2VFdmVudCB8IFRvdWNoRXZlbnQpOiBFdmVudEJhdGNoIHtcbiAgICAgICAgY29uc3QgZXZlbnRCYXRjaCA9IHtcbiAgICAgICAgICAgIGFjdGlvbnM6IFtdLFxuICAgICAgICAgICAgbXV0YXRlZEVsZW1lbnRzOiBuZXcgU2V0KFtdKSxcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuX3NlbGVjdGlvbkhhc0NoYW5nZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHNldFNlbGVjdGlvbkFjdGlvbjogU2V0U2VsZWN0aW9uQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdzZXRTZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgIGRvbVNlbGVjdGlvbjogdGhpcy5fZ2V0U2VsZWN0aW9uKGV2KSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBldmVudEJhdGNoLmFjdGlvbnMucHVzaChzZXRTZWxlY3Rpb25BY3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudEJhdGNoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJZiB0aGUgZHJhZyBzdGFydCBldmVudCBpcyBvYnNlcnZlZCBieSB0aGUgbm9ybWFsaXplciwgaXQgbWVhbnMgdGhlXG4gICAgICogZHJhZ2dpbmcgc3RhcnRlZCBpbiB0aGUgZWRpdGFibGUgaXRzZWxmLiBJdCBtZWFucyB0aGUgdXNlciBpcyBkcmFnZ2luZ1xuICAgICAqIGNvbnRlbnQgYXJvdW5kIGluIHRoZSBlZGl0YWJsZSB6b25lLlxuICAgICAqXG4gICAgICovXG4gICAgX29uRHJhZ1N0YXJ0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9kcmFnZ2luZ0Zyb21FZGl0YWJsZSA9IHRydWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnQgdGhlIGRyb3AgZXZlbnQgaW50byBhIGN1c3RvbSBwcmUtcHJvY2Vzc2VkIGZvcm1hdCBpbiBvcmRlciB0b1xuICAgICAqIHN0b3JlIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gdGhhdCBhcmUgc3BlY2lmaWMgdG8gdGhpcyBwb2ludCBpbiB0aW1lLFxuICAgICAqIHN1Y2ggYXMgdGhlIGN1cnJlbnQgcmFuZ2UgYW5kIHRoZSBpbml0aWFsIGNhcmV0IHBvc2l0aW9uLlxuICAgICAqXG4gICAgICogSW4gc29tZSBicm93c2VyIHdlIG5lZWQgdG8gaW5mZXIgdGhlIGRyb3AgZnJvbSBvdGhlciBldmVudHMuXG4gICAgICpcbiAgICAgKiBFeGFtcGxlIG9mIGRyb3BwYWJsZSBvYmplY3QgYXJlIGZpbGUsIHRleHQsIHVybC5cbiAgICAgKlxuICAgICAqIERyb3AgZXZlbnQgY2FuIG9yaWdpbmF0ZSBmcm9tIGFub3RoZXIgc29mdHdhcmUsIG91dHNpZGUgdGhlIGVkaXRvciB6b25lXG4gICAgICogb3IgaW5zaWRlIHRoZSBlZGl0b3Igem9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldlxuICAgICAqL1xuICAgIF9vbkRyb3AoZXY6IERyYWdFdmVudCk6IHZvaWQge1xuICAgICAgICAvLyBQcmV2ZW50IGRlZmF1bHQgYmVoYXZpb3IgKGUuZy4gcHJldmVudCBmaWxlIGZyb20gYmVpbmcgb3BlbmVkIGluIHRoZVxuICAgICAgICAvLyBjdXJyZW50IHRhYikuXG4gICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgdHJhbnNmZXIgPSBldi5kYXRhVHJhbnNmZXI7XG5cbiAgICAgICAgY29uc3QgZmlsZXMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRyYW5zZmVyLml0ZW1zKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5raW5kID09PSAnZmlsZScpIHtcbiAgICAgICAgICAgICAgICBmaWxlcy5wdXNoKGl0ZW0uZ2V0QXNGaWxlKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2FyZXRQb3NpdGlvbiA9IHRoaXMuX2dldEV2ZW50Q2FyZXRQb3NpdGlvbihldik7XG4gICAgICAgIGNvbnN0IGRyb3BFdmVudDogRGF0YVRyYW5zZmVyRGV0YWlscyA9IHtcbiAgICAgICAgICAgIHR5cGU6ICdkcm9wJyxcbiAgICAgICAgICAgICd0ZXh0L3BsYWluJzogdHJhbnNmZXIuZ2V0RGF0YSgndGV4dC9wbGFpbicpLFxuICAgICAgICAgICAgJ3RleHQvaHRtbCc6IHRyYW5zZmVyLmdldERhdGEoJ3RleHQvaHRtbCcpLFxuICAgICAgICAgICAgJ3RleHQvdXJpLWxpc3QnOiB0cmFuc2Zlci5nZXREYXRhKCd0ZXh0L3VyaS1saXN0JyksXG4gICAgICAgICAgICBmaWxlczogZmlsZXMsXG4gICAgICAgICAgICBvcmlnaW5hbEV2ZW50OiBldixcbiAgICAgICAgICAgIHNlbGVjdGlvbjoge1xuICAgICAgICAgICAgICAgIGFuY2hvck5vZGU6IGNhcmV0UG9zaXRpb24ub2Zmc2V0Tm9kZSxcbiAgICAgICAgICAgICAgICBhbmNob3JPZmZzZXQ6IGNhcmV0UG9zaXRpb24ub2Zmc2V0LFxuICAgICAgICAgICAgICAgIGZvY3VzTm9kZTogY2FyZXRQb3NpdGlvbi5vZmZzZXROb2RlLFxuICAgICAgICAgICAgICAgIGZvY3VzT2Zmc2V0OiBjYXJldFBvc2l0aW9uLm9mZnNldCxcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb246IERpcmVjdGlvbi5GT1JXQVJELFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNhcmV0UG9zaXRpb246IGNhcmV0UG9zaXRpb24sXG4gICAgICAgICAgICBkcmFnZ2luZ0Zyb21FZGl0YWJsZTogdGhpcy5fZHJhZ2dpbmdGcm9tRWRpdGFibGUsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX3JlZ2lzdGVyRXZlbnQoZHJvcEV2ZW50KTtcblxuICAgICAgICAvLyBEcmFnZ2luZyBpcyBvdmVyLCByZXNldCB0aGlzIHByb3BlcnR5LlxuICAgICAgICB0aGlzLl9kcmFnZ2luZ0Zyb21FZGl0YWJsZSA9IGZhbHNlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IHRoZSBjbGlwYm9hcmQgZXZlbnQgaW50byBhIGN1c3RvbSBwcmUtcHJvY2Vzc2VkIGZvcm1hdCBpbiBvcmRlclxuICAgICAqIHRvIHN0b3JlIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gdGhhdCBhcmUgc3BlY2lmaWMgdG8gdGhpcyBwb2ludCBpbiB0aW1lLFxuICAgICAqIHN1Y2ggYXMgdGhlIGN1cnJlbnQgcmFuZ2UgYW5kIHRoZSBpbml0aWFsIGNhcmV0IHBvc2l0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIGV2XG4gICAgICovXG4gICAgX29uQ2xpcGJvYXJkKGV2OiBDbGlwYm9hcmRFdmVudCk6IHZvaWQge1xuICAgICAgICBpZiAoZXYudHlwZSA9PT0gJ3Bhc3RlJykge1xuICAgICAgICAgICAgLy8gUHJldmVudCB0aGUgZGVmYXVsdCBicm93c2VyIHdpbGQgcGFzdGluZyBiZWhhdmlvci5cbiAgICAgICAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2xpcGJvYXJkID0gZXYuY2xpcGJvYXJkRGF0YTtcbiAgICAgICAgY29uc3QgcGFzdGVFdmVudDogRGF0YVRyYW5zZmVyRGV0YWlscyA9IHtcbiAgICAgICAgICAgIHR5cGU6IGV2LnR5cGUgYXMgJ2N1dCcgfCAncGFzdGUnLFxuICAgICAgICAgICAgJ3RleHQvcGxhaW4nOiBjbGlwYm9hcmQuZ2V0RGF0YSgndGV4dC9wbGFpbicpLFxuICAgICAgICAgICAgJ3RleHQvaHRtbCc6IGNsaXBib2FyZC5nZXREYXRhKCd0ZXh0L2h0bWwnKSxcbiAgICAgICAgICAgICd0ZXh0L3VyaS1saXN0JzogY2xpcGJvYXJkLmdldERhdGEoJ3RleHQvdXJpLWxpc3QnKSxcbiAgICAgICAgICAgIGZpbGVzOiBbXSxcbiAgICAgICAgICAgIG9yaWdpbmFsRXZlbnQ6IGV2LFxuICAgICAgICAgICAgc2VsZWN0aW9uOiB0aGlzLl9nZXRTZWxlY3Rpb24oKSxcbiAgICAgICAgICAgIGNhcmV0UG9zaXRpb246IHRoaXMuX2luaXRpYWxDYXJldFBvc2l0aW9uLFxuICAgICAgICAgICAgZHJhZ2dpbmdGcm9tRWRpdGFibGU6IGZhbHNlLFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9yZWdpc3RlckV2ZW50KHBhc3RlRXZlbnQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFVwZGF0ZSB0aGUgbW9kaWZpZXJzIGtleXMgdG8ga25vdyB3aGljaCBtb2RpZmllcnMga2V5cyBhcmUgcHVzaGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIGVcbiAgICAgKi9cbiAgICBfdXBkYXRlTW9kaWZpZXJzS2V5cyhlOiBLZXlib2FyZEV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuX21vZGlmaWVyS2V5cyA9IHtcbiAgICAgICAgICAgIGN0cmxLZXk6IGUuY3RybEtleSxcbiAgICAgICAgICAgIGFsdEtleTogZS5hbHRLZXksXG4gICAgICAgICAgICBtZXRhS2V5OiBlLm1ldGFLZXksXG4gICAgICAgICAgICBzaGlmdEtleTogZS5zaGlmdEtleSxcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogT24gZWFjaCBjaGFuZ2Ugb2Ygc2VsZWN0aW9uLCBjaGVjayBpZiBpdCBtaWdodCBiZSBhIFwic2VsZWN0QWxsXCIgYWN0aW9uLlxuICAgICAqXG4gICAgICogQSBcInNlbGVjdEFsbFwiIGFjdGlvbiBjYW4gYmUgdHJpZ2dlcmVkIGJ5OlxuICAgICAqIC0gVGhlIHNob3J0Y3V0ICdDVFJMK0EnXG4gICAgICogLSBBIHVzZXIgbWFwcGluZyBvZiB0aGUgT1Mgb3IgYnJvd3NlclxuICAgICAqIC0gRnJvbSB0aGUgY29udGV4dCBtZW51XG4gICAgICogLSBQcm9ncmFtbWF0aWNhbGx5XG4gICAgICovXG4gICAgX29uU2VsZWN0aW9uQ2hhbmdlKCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuX2luaXRpYWxDYXJldFBvc2l0aW9uKSB7XG4gICAgICAgICAgICAvLyBGaWx0ZXIgdGhlIGV2ZW50cyBiZWNhdXNlIHdlIGNhbiBoYXZlIHNvbWUgU2hhZG93IHJvb3QgYW5kIGVhY2hcbiAgICAgICAgICAgIC8vIG5vcm1hbGlzZXIgYmluZCBldmVudCBvbiBkb2N1bWVudC5cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBrZXlkb3duRXZlbnQgPSB0aGlzLmN1cnJlbnRTdGFja09ic2VydmF0aW9uLl9ldmVudHNNYXAua2V5ZG93bjtcbiAgICAgICAgY29uc3QgaXNOYXZFdmVudCA9XG4gICAgICAgICAgICBrZXlkb3duRXZlbnQgaW5zdGFuY2VvZiBLZXlib2FyZEV2ZW50ICYmXG4gICAgICAgICAgICBrZXlkb3duRXZlbnQudHlwZSA9PT0gJ2tleWRvd24nICYmXG4gICAgICAgICAgICBuYXZpZ2F0aW9uS2V5LmhhcyhrZXlkb3duRXZlbnQua2V5KTtcbiAgICAgICAgaWYgKGlzTmF2RXZlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHNldFNlbGVjdGlvbkFjdGlvbjogU2V0U2VsZWN0aW9uQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdzZXRTZWxlY3Rpb24nLFxuICAgICAgICAgICAgICAgIGRvbVNlbGVjdGlvbjogdGhpcy5fZ2V0U2VsZWN0aW9uKCksXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5pbml0TmV4dE9ic2VydmF0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLl90cmlnZ2VyRXZlbnRCYXRjaChcbiAgICAgICAgICAgICAgICBuZXcgUHJvbWlzZSgocmVzb2x2ZSk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoeyBhY3Rpb25zOiBbc2V0U2VsZWN0aW9uQWN0aW9uXSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fc2VsZWN0aW9uSGFzQ2hhbmdlZCA9IHRydWU7XG4gICAgICAgICAgICAvLyBUaGlzIGhldXJpc3RpYyBwcm90ZWN0cyBhZ2FpbnN0IGEgY29zdGx5IGBfaXNTZWxlY3RBbGxgIGNhbGwuXG4gICAgICAgICAgICBjb25zdCBtb2RpZmllZEtleUV2ZW50ID0gdGhpcy5fbW9kaWZpZXJLZXlzLmN0cmxLZXkgfHwgdGhpcy5fbW9kaWZpZXJLZXlzLm1ldGFLZXk7XG4gICAgICAgICAgICBjb25zdCBoZXVyaXN0aWMgPSBtb2RpZmllZEtleUV2ZW50IHx8IHRoaXMuX2ZvbGxvd3NQb2ludGVyQWN0aW9uO1xuICAgICAgICAgICAgY29uc3QgaXNTZWxlY3RBbGwgPSBoZXVyaXN0aWMgJiYgdGhpcy5faXNTZWxlY3RBbGwodGhpcy5fZ2V0U2VsZWN0aW9uKCkpO1xuICAgICAgICAgICAgaWYgKGlzU2VsZWN0QWxsICYmICF0aGlzLl9jdXJyZW50bHlTZWxlY3RpbmdBbGwpIHtcbiAgICAgICAgICAgICAgICBpZiAobW9kaWZpZWRLZXlFdmVudCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHNlbGVjdCBhbGwgd2FzIHRyaWdnZXJlZCBmcm9tIHRoZSBrZXlib2FyZC4gQWRkIGFcbiAgICAgICAgICAgICAgICAgICAgLy8gZmFrZSBzZWxlY3RBbGwgZXZlbnQgdG8gdGhlIHF1ZXVlIGFzIGEgbWFya2VyIGZvclxuICAgICAgICAgICAgICAgICAgICAvLyBgX3Byb2Nlc3NFdmVudHNgIHRvIHJlZ2lzdGVyIHRoYXQgYSBzZWxlY3QgYWxsIHdhc1xuICAgICAgICAgICAgICAgICAgICAvLyB0cmlnZ2VyZWQgaW4gdGhpcyBzdGFjay5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVnaXN0ZXJFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2tleWJvYXJkU2VsZWN0QWxsJykpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSB0YXJnZXQgb2YgdGhlIHNlbGVjdCBhbGwgc3BlY2lmaWVzIHdoZXJlIHRoZSB1c2VyIGNhcmV0XG4gICAgICAgICAgICAgICAgICAgIC8vIHdhcyB3aGVuIHRoZSBzZWxlY3QgYWxsIHdhcyB0cmlnZ2VyZWQuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdEFsbEFjdGlvbjogU2VsZWN0QWxsQWN0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3NlbGVjdEFsbCcsXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgZGlkIG5vdCBmaW5kIGFueSBjYXNlIHdoZXJlIGEgc2VsZWN0IGFsbCB0cmlnZ2VyZWRcbiAgICAgICAgICAgICAgICAgICAgLy8gZnJvbSB0aGUgbW91c2UgYWN0dWFsbHkgcmVzdWx0ZWQgaW4gYSBtdXRhdGlvbiwgc28gdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIG11dGF0aW9uIG5vcm1hbGl6ZXIgaXMgbm90IGxpc3RuZW5pbmcgaW4gdGhpcyBjYXNlLiBJZiBpdFxuICAgICAgICAgICAgICAgICAgICAvLyBoYXBwZW5zIHRvIGJlIGluc3VmZmljaWVudCBsYXRlciBvbiwgdGhlIG11dGF0ZWQgZWxlbWVudHNcbiAgICAgICAgICAgICAgICAgICAgLy8gd2lsbCBuZWVkIHRvIGJlIHJldHJpZXZlZCBmcm9tIHRoZSBtdXRhdGlvbiBub3JtYWxpemVyLlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl90cmlnZ2VyRXZlbnRCYXRjaChcbiAgICAgICAgICAgICAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uczogW3NlbGVjdEFsbEFjdGlvbl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXV0YXRlZEVsZW1lbnRzOiBuZXcgU2V0KCksXG4gICAgICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBTYWZhcmkgb24gTWFjT1MgdHJpZ2dlcnMgYSBzZWxlY3Rpb24gY2hhbmdlIHdoZW4gcHJlc3NpbmcgQ3RybFxuICAgICAgICAgICAgLy8gZXZlbiB0aG91Z2ggdGhlIHNlbGVjdGlvbiBkaWQgbm90IGFjdHVhbGx5IGNoYW5nZS4gVGhpcyBwcm9wZXJ0eVxuICAgICAgICAgICAgLy8gaXMgdXNlZCB0byBzdG9yZSB3aGV0aGVyIHRoZSBjdXJyZW50IHN0YXRlIGlzIGNvbnNpZGVyZWQgdG8gYmUgYVxuICAgICAgICAgICAgLy8gc2VsZWN0IGFsbC4gVGhlIHBvaW50IGlzIHRvIGF2b2lkIHRyaWdnZXJpbmcgYSBuZXcgZXZlbnQgZm9yIGFcbiAgICAgICAgICAgIC8vIHNlbGVjdGlvbiBjaGFuZ2UgaWYgZXZlcnl0aGluZyB3YXMgYWxyZWFkeSBzZWxlY3RlZCBiZWZvcmVoYW5kLlxuICAgICAgICAgICAgdGhpcy5fY3VycmVudGx5U2VsZWN0aW5nQWxsID0gaXNTZWxlY3RBbGw7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbmludGVyZmFjZSBDaGFyTXV0YXRpb24ge1xuICAgIG9sZD86IHN0cmluZztcbiAgICBjdXJyZW50Pzogc3RyaW5nO1xuICAgIHRhcmdldD86IE5vZGU7XG59XG5pbnRlcmZhY2UgQ2hhcmFjdGVyc01hcHBpbmcge1xuICAgIGNoYXJzOiBzdHJpbmc7IC8vIGNvbmNhdGVuYXRlZCBjaGFyYWN0ZXJzIGFjY3Jvc3MgbXVsdGlwbGUgbm9kZXNcbiAgICBub2RlczogQXJyYXk8Tm9kZT47IC8vIGNvcnJlc3BvbmRpbmcgdGV4dHVhbCBub2Rlc1xuICAgIG9mZnNldHM6IG51bWJlcltdOyAvLyBjaGFyYWN0ZXIgb2Zmc2V0cyBpbiB0aGVpciBjb3JyZXNwb25kaW5nIHRleHR1YWwgbm9kZXNcbn1cblxuZXhwb3J0IGNsYXNzIE11dGF0aW9uTm9ybWFsaXplciB7XG4gICAgLyoqXG4gICAgICogVGhlIE11dGF0aW9uT2JzZXJ2ZXIgdXNlZCBieSB0aGUgbm9ybWFsaXplciB0byB3YXRjaCB0aGUgbm9kZXMgdGhhdCBhcmVcbiAgICAgKiBiZWluZyBtb2RpZmllZCBzaW5jZSB0aGUgbm9ybWFsaXplciBjcmVhdGlvbiB1bnRpbCBpdCBpcyBkcmVzdHJveWVkLlxuICAgICAqL1xuICAgIF9vYnNlcnZlcjogTXV0YXRpb25PYnNlcnZlcjtcblxuICAgIF9saXN0ZW46IGJvb2xlYW47XG4gICAgX211dGF0aW9uczogTXV0YXRpb25SZWNvcmRbXTtcblxuICAgIGNvbnN0cnVjdG9yKGVsOiBFbGVtZW50ID0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgICB0aGlzLl9vYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKHRoaXMuX29uTXV0YXRpb24uYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuX29ic2VydmVyLm9ic2VydmUoZWwsIHtcbiAgICAgICAgICAgIGNoYXJhY3RlckRhdGFPbGRWYWx1ZTogdHJ1ZSwgLy8gYWRkIG9sZCB0ZXh0IHZhbHVlIG9uIGNoYW5nZXNcbiAgICAgICAgICAgIGNoYXJhY3RlckRhdGE6IHRydWUsIC8vIG1vbml0b3IgdGV4dCBjb250ZW50IGNoYW5nZXNcbiAgICAgICAgICAgIGNoaWxkTGlzdDogdHJ1ZSwgLy8gbW9uaXRvciBjaGlsZCBub2RlcyBhZGRpdGlvbiBvciByZW1vdmFsXG4gICAgICAgICAgICBzdWJ0cmVlOiB0cnVlLCAvLyBleHRlbmQgbW9uaXRvcmluZyB0byBhbGwgY2hpbGRyZW4gb2YgdGhlIHRhcmdldFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhcnQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2xpc3RlbiA9IHRydWU7XG4gICAgICAgIHRoaXMuX211dGF0aW9ucyA9IFtdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGEgbWFwcGluZyBvZiB0aGUgc2VwYXJhdGUgY2hhcmFjdGVycywgdGhlaXIgY29ycmVzcG9uZGluZyB0ZXh0XG4gICAgICogbm9kZXMgYW5kIHRoZWlyIG9mZnNldHMgaW4gc2FpZCBub2RlcyBmcm9tIHRoZSBnaXZlbiBub2RlJ3Mgc3VidHJlZS5cbiAgICAgKlxuICAgICAqIEBwcml2YXRlXG4gICAgICogQHBhcmFtIGNoYXJNdXRhdGlvbnNcbiAgICAgKiBAcmV0dXJucyB7IHByZXZpb3VzLCBjdXJyZW50IH1cbiAgICAgKi9cbiAgICBnZXRDaGFyYWN0ZXJzTWFwcGluZygpOiB7XG4gICAgICAgIGluc2VydDogc3RyaW5nO1xuICAgICAgICByZW1vdmU6IHN0cmluZztcbiAgICAgICAgaW5kZXg6IG51bWJlcjtcbiAgICAgICAgcHJldmlvdXM6IENoYXJhY3RlcnNNYXBwaW5nO1xuICAgICAgICBjdXJyZW50OiBDaGFyYWN0ZXJzTWFwcGluZztcbiAgICB9IHtcbiAgICAgICAgY29uc3QgYmVmb3JlOiBTZXQ8Tm9kZT4gPSBuZXcgU2V0KCk7XG4gICAgICAgIGNvbnN0IGFkZDogU2V0PE5vZGU+ID0gbmV3IFNldCgpO1xuICAgICAgICBjb25zdCBjdXJyZW50OiBTZXQ8Tm9kZT4gPSBuZXcgU2V0KCk7XG4gICAgICAgIGNvbnN0IHRleHRNdXRhdGlvbnMgPSBbXTtcbiAgICAgICAgLy8gR2F0aGVyIGFsbCBtb2RpZmllZCBub2RlcyB0byBub3RpZnkgdGhlIGxpc3RlbmVyLlxuICAgICAgICBmdW5jdGlvbiBnZXRTZWxmQW5kQWxsQ2hpbGRyZW4odGFyZ2V0OiBOb2RlKTogTm9kZVtdIHtcbiAgICAgICAgICAgIGNvbnN0IHRleHRzID0gW3RhcmdldF07XG4gICAgICAgICAgICB0YXJnZXQuY2hpbGROb2Rlcy5mb3JFYWNoKHRhcmdldCA9PiB7XG4gICAgICAgICAgICAgICAgdGV4dHMucHVzaCguLi5nZXRTZWxmQW5kQWxsQ2hpbGRyZW4odGFyZ2V0KSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB0ZXh0cztcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBpc1RleHROb2RlKHRhcmdldDogTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICAgICAgcmV0dXJuIHRhcmdldC5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUgfHwgbm9kZU5hbWUodGFyZ2V0KSA9PT0gJ0JSJztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9tdXRhdGlvbnMuZm9yRWFjaChyZWNvcmQgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0TXV0YXRpb24gPSByZWNvcmQudGFyZ2V0O1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0SXNBZGRlZCA9IGFkZC5oYXModGFyZ2V0TXV0YXRpb24pO1xuICAgICAgICAgICAgaWYgKCF0YXJnZXRJc0FkZGVkKSB7XG4gICAgICAgICAgICAgICAgYmVmb3JlLmFkZCh0YXJnZXRNdXRhdGlvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT09ICdjaGFyYWN0ZXJEYXRhJykge1xuICAgICAgICAgICAgICAgIGN1cnJlbnQuYWRkKHRhcmdldE11dGF0aW9uKTtcbiAgICAgICAgICAgICAgICB0ZXh0TXV0YXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHRhcmdldE11dGF0aW9uLFxuICAgICAgICAgICAgICAgICAgICBvbGQ6IHJlY29yZC5vbGRWYWx1ZS5yZXBsYWNlKC9cXHUwMEEwL2csICcgJyksXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IHRhcmdldE11dGF0aW9uLnRleHRDb250ZW50LnJlcGxhY2UoL1xcdTAwQTAvZywgJyAnKSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVjb3JkLmFkZGVkTm9kZXMuZm9yRWFjaChub2RlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZ2V0U2VsZkFuZEFsbENoaWxkcmVuKG5vZGUpLmZvckVhY2goY2hpbGQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFiZWZvcmUuaGFzKGNoaWxkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZC5hZGQoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5hZGQoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc1RleHROb2RlKGNoaWxkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRNdXRhdGlvbnMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0OiBjaGlsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbGQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBjaGlsZC50ZXh0Q29udGVudC5yZXBsYWNlKC9cXHUwMEEwL2csICcgJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogJ1xcbicsXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmVjb3JkLnJlbW92ZWROb2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBnZXRTZWxmQW5kQWxsQ2hpbGRyZW4obm9kZSkuZm9yRWFjaChjaGlsZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5oYXMoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudC5kZWxldGUoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhcmdldElzQWRkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGQuYWRkKGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWRkLmhhcyhjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZWZvcmUuYWRkKGNoaWxkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNUZXh0Tm9kZShjaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0TXV0YXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldDogY2hpbGQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2xkOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gY2hpbGQudGV4dENvbnRlbnQucmVwbGFjZSgvXFx1MDBBMC9nLCAnICcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICdcXG4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6ICcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBhbHJlYWR5ID0gbmV3IE1hcCgpO1xuICAgICAgICBjb25zdCBjaGFyTXV0YXRpb25zID0gW107XG4gICAgICAgIHRleHRNdXRhdGlvbnMuZm9yRWFjaCh0ZXh0TXV0YXRpb24gPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gdGV4dE11dGF0aW9uLnRhcmdldDtcbiAgICAgICAgICAgIGxldCBtdXRhdGlvbiA9IGFscmVhZHkuZ2V0KHRhcmdldCk7XG4gICAgICAgICAgICBpZiAobXV0YXRpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudC5oYXModGFyZ2V0KSAmJiAhbXV0YXRpb24uY3VycmVudC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgbXV0YXRpb24uY3VycmVudCA9IHRleHRNdXRhdGlvbi5jdXJyZW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY3VycmVudC5oYXModGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgIG11dGF0aW9uID0ge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHRhcmdldCxcbiAgICAgICAgICAgICAgICAgICAgb2xkOiBiZWZvcmUuaGFzKHRhcmdldCkgPyB0ZXh0TXV0YXRpb24ub2xkIDogJycsXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6IHRleHRNdXRhdGlvbi5jdXJyZW50LFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY2hhck11dGF0aW9ucy5wdXNoKG11dGF0aW9uKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoYmVmb3JlLmhhcyh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgbXV0YXRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0LFxuICAgICAgICAgICAgICAgICAgICBvbGQ6IHRleHRNdXRhdGlvbi5vbGQsXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnQ6ICcnLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgY2hhck11dGF0aW9ucy5wdXNoKG11dGF0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGFscmVhZHkuc2V0KHRhcmdldCwgbXV0YXRpb24pO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBjdXJyZW50TGlua2VkID0gdGhpcy5fZ2V0Q2hhckxpbmtlZChjaGFyTXV0YXRpb25zLCAnY3VycmVudCcpO1xuICAgICAgICBjb25zdCBwcmV2aW91c0xpbmtlZCA9IHRoaXMuX2dldENoYXJMaW5rZWQoY2hhck11dGF0aW9ucywgJ29sZCcpO1xuXG4gICAgICAgIGNvbnN0IG9sZFRleHQgPSBwcmV2aW91c0xpbmtlZC5jaGFycztcbiAgICAgICAgY29uc3QgY3VycmVudFRleHQgPSBjdXJyZW50TGlua2VkLmNoYXJzO1xuICAgICAgICBpZiAob2xkVGV4dCA9PT0gY3VycmVudFRleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaW5kZXg6IC0xLFxuICAgICAgICAgICAgICAgIGluc2VydDogJycsXG4gICAgICAgICAgICAgICAgcmVtb3ZlOiAnJyxcbiAgICAgICAgICAgICAgICBwcmV2aW91czogcHJldmlvdXNMaW5rZWQsXG4gICAgICAgICAgICAgICAgY3VycmVudDogY3VycmVudExpbmtlZCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjaGFuZ2VQb3NpdGlvbiA9IHRoaXMuX2NoYW5nZWRPZmZzZXQob2xkVGV4dCwgY3VycmVudFRleHQpO1xuICAgICAgICBjb25zdCBtaW5MZW5ndGggPSBNYXRoLm1pbihvbGRUZXh0Lmxlbmd0aCwgY3VycmVudFRleHQubGVuZ3RoKTtcblxuICAgICAgICBsZXQgaW5zZXJ0QnlDaGFuZ2U6IHN0cmluZztcbiAgICAgICAgY29uc3QgdW5rbm93blBvc2l0aW9uID0gY2hhbmdlUG9zaXRpb24ubGVmdCA+IG1pbkxlbmd0aCAtIGNoYW5nZVBvc2l0aW9uLnJpZ2h0O1xuXG4gICAgICAgIGlmICh1bmtub3duUG9zaXRpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IG1heExlbmd0aCA9IE1hdGgubWF4KG9sZFRleHQubGVuZ3RoLCBjdXJyZW50VGV4dC5sZW5ndGgpO1xuICAgICAgICAgICAgY29uc3QgbGVuID0gbWF4TGVuZ3RoIC0gbWluTGVuZ3RoO1xuICAgICAgICAgICAgaW5zZXJ0QnlDaGFuZ2UgPSBjdXJyZW50VGV4dC5zbGljZShjdXJyZW50VGV4dC5sZW5ndGggLSBjaGFuZ2VQb3NpdGlvbi5yaWdodCk7XG4gICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayArIGxlbiA8IG1pbkxlbmd0aDsgaysrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGluc2VydEJ5Q2hhbmdlW2sgLSAxXSA9PT0gJyAnKSB7XG4gICAgICAgICAgICAgICAgICAgIGluc2VydEJ5Q2hhbmdlID0gaW5zZXJ0QnlDaGFuZ2Uuc2xpY2Uoayk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGluc2VydEJ5Q2hhbmdlID0gaW5zZXJ0QnlDaGFuZ2Uuc2xpY2UoMCwgbGVuKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaW5kZXg6IC0xLFxuICAgICAgICAgICAgICAgIGluc2VydDogaW5zZXJ0QnlDaGFuZ2UsXG4gICAgICAgICAgICAgICAgcmVtb3ZlOiAnJyxcbiAgICAgICAgICAgICAgICBwcmV2aW91czogcHJldmlvdXNMaW5rZWQsXG4gICAgICAgICAgICAgICAgY3VycmVudDogY3VycmVudExpbmtlZCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnNlcnRCeUNoYW5nZSA9IGN1cnJlbnRUZXh0LnNsaWNlKFxuICAgICAgICAgICAgICAgIGNoYW5nZVBvc2l0aW9uLmxlZnQsXG4gICAgICAgICAgICAgICAgY3VycmVudFRleHQubGVuZ3RoIC0gY2hhbmdlUG9zaXRpb24ucmlnaHQsXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGZpbmVDaGFuZ2VQb3NpdGlvbjogeyBsZWZ0OiBudW1iZXI7IHJpZ2h0OiBudW1iZXIgfTtcbiAgICAgICAgbGV0IGluc2VydGVkV29yZEFuYWx5c2VkOiBzdHJpbmc7XG4gICAgICAgIGlmICh0ZXh0TXV0YXRpb25zLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGxldCBhbHJlYWR5Rm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAobGV0IGsgPSB0ZXh0TXV0YXRpb25zLmxlbmd0aCAtIDE7IGsgPj0gMDsgay0tKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2hhck11dGF0aW9uID0gdGV4dE11dGF0aW9uc1trXTtcbiAgICAgICAgICAgICAgICBpZiAoY2hhck11dGF0aW9uLm9sZC5sZW5ndGggPj0gY2hhck11dGF0aW9uLmN1cnJlbnQubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudENoYW5nZTogc3RyaW5nO1xuICAgICAgICAgICAgICAgIGlmIChjaGFyTXV0YXRpb24ub2xkICE9PSAnJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWxyZWFkeUZvdW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBvbGRUZXh0TXV0YXRpb24gPSBjaGFyTXV0YXRpb24ub2xkO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50VGV4dE11dGF0aW9uID0gY2hhck11dGF0aW9uLmN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc011dGF0aW9uID0gdGhpcy5fY2hhbmdlZE9mZnNldChvbGRUZXh0TXV0YXRpb24sIGN1cnJlbnRUZXh0TXV0YXRpb24pO1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50Q2hhbmdlID0gY3VycmVudFRleHRNdXRhdGlvbi5zbGljZShcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc011dGF0aW9uLmxlZnQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50VGV4dE11dGF0aW9uLmxlbmd0aCAtIHJlc011dGF0aW9uLnJpZ2h0LFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhck11dGF0aW9uLmN1cnJlbnQgPT09IGN1cnJlbnRUZXh0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDaGFuZ2UgPSBjaGFyTXV0YXRpb24uY3VycmVudDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjaGFuZ2VJbmRleCA9IGN1cnJlbnRDaGFuZ2UuaW5kZXhPZihpbnNlcnRCeUNoYW5nZSk7XG4gICAgICAgICAgICAgICAgaWYgKGNoYW5nZUluZGV4ID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleFN0YXJ0ID0gY3VycmVudFRleHQuaW5kZXhPZihjdXJyZW50Q2hhbmdlKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleEVuZCA9IGluZGV4U3RhcnQgKyBjdXJyZW50Q2hhbmdlLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBjb25zdCByYW5nZUNoYW5nZVN0YXJ0ID0gY2hhbmdlUG9zaXRpb24ubGVmdCAtIGNoYW5nZUluZGV4O1xuICAgICAgICAgICAgICAgIGNvbnN0IHJhbmdlQ2hhbmdlRW5kID0gY3VycmVudFRleHQubGVuZ3RoIC0gY2hhbmdlUG9zaXRpb24ucmlnaHQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgICAgIChyYW5nZUNoYW5nZVN0YXJ0ID49IGluZGV4U3RhcnQgJiYgcmFuZ2VDaGFuZ2VTdGFydCA8IGluZGV4RW5kKSB8fFxuICAgICAgICAgICAgICAgICAgICAocmFuZ2VDaGFuZ2VFbmQgPiBpbmRleFN0YXJ0ICYmIHJhbmdlQ2hhbmdlRW5kIDw9IGluZGV4RW5kKSB8fFxuICAgICAgICAgICAgICAgICAgICAocmFuZ2VDaGFuZ2VFbmQgPj0gaW5kZXhFbmQgJiYgcmFuZ2VDaGFuZ2VTdGFydCA8PSBpbmRleFN0YXJ0KVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBmaW5lQ2hhbmdlUG9zaXRpb24gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZWZ0OiBpbmRleFN0YXJ0LFxuICAgICAgICAgICAgICAgICAgICAgICAgcmlnaHQ6IGN1cnJlbnRUZXh0Lmxlbmd0aCAtIGluZGV4RW5kLFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBpbnNlcnRlZFdvcmRBbmFseXNlZCA9IGN1cnJlbnRDaGFuZ2U7XG4gICAgICAgICAgICAgICAgICAgIGFscmVhZHlGb3VuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFyTXV0YXRpb24ub2xkID09PSAnJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBpbnNlcnRlZFdvcmRBbmFseXNlZCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIGluc2VydGVkV29yZEFuYWx5c2VkID0gaW5zZXJ0QnlDaGFuZ2U7XG5cbiAgICAgICAgICAgIGxldCBiZWZvcmVJbmRleCA9IGluc2VydGVkV29yZEFuYWx5c2VkLmluZGV4T2YoaW5zZXJ0QnlDaGFuZ2UpO1xuICAgICAgICAgICAgaWYgKGluc2VydEJ5Q2hhbmdlID09PSAnJykge1xuICAgICAgICAgICAgICAgIGJlZm9yZUluZGV4ID0gaW5zZXJ0ZWRXb3JkQW5hbHlzZWQubGVuZ3RoO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBiZWZvcmVJbmRleCA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaW5lQ2hhbmdlUG9zaXRpb24gPSB7XG4gICAgICAgICAgICAgICAgbGVmdDogY2hhbmdlUG9zaXRpb24ubGVmdCAtIGJlZm9yZUluZGV4LFxuICAgICAgICAgICAgICAgIHJpZ2h0OiBjaGFuZ2VQb3NpdGlvbi5yaWdodCxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZW1vdmVkV29yZEFuYWx5c2VkID0gb2xkVGV4dC5zbGljZShcbiAgICAgICAgICAgIGZpbmVDaGFuZ2VQb3NpdGlvbi5sZWZ0LFxuICAgICAgICAgICAgb2xkVGV4dC5sZW5ndGggLSBmaW5lQ2hhbmdlUG9zaXRpb24ucmlnaHQsXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGluZGV4OiBmaW5lQ2hhbmdlUG9zaXRpb24ubGVmdCxcbiAgICAgICAgICAgIGluc2VydDogaW5zZXJ0ZWRXb3JkQW5hbHlzZWQsXG4gICAgICAgICAgICByZW1vdmU6IHJlbW92ZWRXb3JkQW5hbHlzZWQsXG4gICAgICAgICAgICBwcmV2aW91czogcHJldmlvdXNMaW5rZWQsXG4gICAgICAgICAgICBjdXJyZW50OiBjdXJyZW50TGlua2VkLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBnZXRNdXRhdGVkRWxlbWVudHMoKTogU2V0PE5vZGU+IHtcbiAgICAgICAgY29uc3QgZWxlbWVudHM6IFNldDxOb2RlPiA9IG5ldyBTZXQoKTtcbiAgICAgICAgdGhpcy5fbXV0YXRpb25zLmZvckVhY2goTXV0YXRpb25SZWNvcmQgPT4ge1xuICAgICAgICAgICAgaWYgKE11dGF0aW9uUmVjb3JkLnR5cGUgPT09ICdjaGFyYWN0ZXJEYXRhJykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnRzLmFkZChNdXRhdGlvblJlY29yZC50YXJnZXQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBNdXRhdGlvblJlY29yZC5hZGRlZE5vZGVzLmZvckVhY2godGFyZ2V0ID0+IGVsZW1lbnRzLmFkZCh0YXJnZXQpKTtcbiAgICAgICAgICAgICAgICBNdXRhdGlvblJlY29yZC5yZW1vdmVkTm9kZXMuZm9yRWFjaCh0YXJnZXQgPT4gZWxlbWVudHMuYWRkKHRhcmdldCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGVsZW1lbnRzO1xuICAgIH1cbiAgICBzdG9wKCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9saXN0ZW4gPSBmYWxzZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIHdoZW4gZGVzdHJveSB0aGUgbXV0YXRpb24gbm9ybWFsaXplci5cbiAgICAgKiBSZW1vdmUgYWxsIGFkZGVkIGhhbmRsZXJzLlxuICAgICAqXG4gICAgICovXG4gICAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fb2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgX2dldENoYXJMaW5rZWQoY2hhck11dGF0aW9uczogQ2hhck11dGF0aW9uW10sIHR5cGU6IHN0cmluZyk6IENoYXJhY3RlcnNNYXBwaW5nIHtcbiAgICAgICAgY29uc3QgbWFwTm9kZVZhbHVlID0gbmV3IFdlYWtNYXAoKTtcbiAgICAgICAgY29uc3Qgb2JqOiBDaGFyYWN0ZXJzTWFwcGluZyA9IHtcbiAgICAgICAgICAgIGNoYXJzOiAnJyxcbiAgICAgICAgICAgIG5vZGVzOiBbXSxcbiAgICAgICAgICAgIG9mZnNldHM6IFtdLFxuICAgICAgICB9O1xuICAgICAgICBjaGFyTXV0YXRpb25zLmZvckVhY2goY2hhck11dGF0aW9uID0+IHtcbiAgICAgICAgICAgIG1hcE5vZGVWYWx1ZS5zZXQoY2hhck11dGF0aW9uLnRhcmdldCwgY2hhck11dGF0aW9uW3R5cGVdKTtcbiAgICAgICAgICAgIGNvbnN0IGxlbiA9IGNoYXJNdXRhdGlvblt0eXBlXS5sZW5ndGg7XG4gICAgICAgICAgICBpZiAob2JqLm5vZGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNoYXJQYXJlbnRlZCA9IG5ldyBTZXQoKTtcbiAgICAgICAgICAgICAgICBsZXQgbm9kZSA9IGNoYXJNdXRhdGlvbi50YXJnZXQ7XG4gICAgICAgICAgICAgICAgd2hpbGUgKFxuICAgICAgICAgICAgICAgICAgICBub2RlICYmXG4gICAgICAgICAgICAgICAgICAgICghKG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50KSB8fCAhbm9kZS5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnRFZGl0YWJsZScpKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBjaGFyUGFyZW50ZWQuYWRkKG5vZGUpO1xuICAgICAgICAgICAgICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsZXQgZmlyc3QgPSBvYmoubm9kZXNbMF07XG4gICAgICAgICAgICAgICAgd2hpbGUgKFxuICAgICAgICAgICAgICAgICAgICBmaXJzdCAmJlxuICAgICAgICAgICAgICAgICAgICAoIShmaXJzdCBpbnN0YW5jZW9mIEVsZW1lbnQpIHx8ICFmaXJzdC5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnRFZGl0YWJsZScpKVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhclBhcmVudGVkLmhhcyhmaXJzdC5wcmV2aW91c1NpYmxpbmcpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmouY2hhcnMgPSBjaGFyTXV0YXRpb25bdHlwZV0gKyBvYmouY2hhcnM7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmoubm9kZXMudW5zaGlmdCguLi5uZXcgQXJyYXkobGVuKS5maWxsKGNoYXJNdXRhdGlvbi50YXJnZXQpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5vZmZzZXRzLnVuc2hpZnQoLi4uQXJyYXkobGVuKS5rZXlzKCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZpcnN0ID0gZmlyc3QucGFyZW50Tm9kZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvYmouY2hhcnMgKz0gY2hhck11dGF0aW9uW3R5cGVdO1xuICAgICAgICAgICAgb2JqLm5vZGVzLnB1c2goLi4ubmV3IEFycmF5KGxlbikuZmlsbChjaGFyTXV0YXRpb24udGFyZ2V0KSk7XG4gICAgICAgICAgICBvYmoub2Zmc2V0cy5wdXNoKC4uLkFycmF5KGxlbikua2V5cygpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIG9iai5jaGFycyA9IG9iai5jaGFycy5yZXBsYWNlKC9cXHUwMEEwL2csICcgJyk7XG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuICAgIF9jaGFuZ2VkT2Zmc2V0KG9sZDogc3RyaW5nLCBjdXJyZW50OiBzdHJpbmcpOiB7IGxlZnQ6IG51bWJlcjsgcmlnaHQ6IG51bWJlciB9IHtcbiAgICAgICAgLy8gSW4gdGhlIG9wdGltYWwgY2FzZSB3aGVyZSBib3RoIHRoZSByYW5nZSBpcyBjb3JyZWN0bHkgcGxhY2VkIGFuZCB0aGVcbiAgICAgICAgLy8gZGF0YSBwcm9wZXJ0eSBvZiB0aGUgY29tcG9zaXRpb24gZXZlbnQgaXMgY29ycmVjdGx5IHNldCwgdGhlIGFib3ZlXG4gICAgICAgIC8vIGFuYWx5c2lzIGlzIGNhcGFibGUgb2YgZmluZGluZyB0aGUgcHJlY2lzZSB0ZXh0IHRoYXQgd2FzIGluc2VydGVkLlxuICAgICAgICAvLyBIb3dldmVyLCBpZiBhbnkgb2YgdGhlc2UgdHdvIGNvbmRpdGlvbnMgYXJlIG5vdCBtZXQsIHRoZSByZXN1bHRzXG4gICAgICAgIC8vIG1pZ2h0IGJlIHNwZWN0YWN1bGFybHkgd3JvbmcuIEZvciBleGFtcGxlLCBzcGVsbCBjaGVja2luZyBzdWdnZXN0aW9uc1xuICAgICAgICAvLyBvbiBNYWNPUyBhcmUgZGlzcGxheWVkIHdoaWxlIGhvdmVyaW5nIHRoZSBtaXNwZWxsZWQgd29yZCwgcmVnYXJkbGVzc1xuICAgICAgICAvLyBvZiB0aGUgY3VycmVudCBwb3NpdGlvbiBvZiB0aGUgcmFuZ2UsIGFuZCB0aGUgY29ycmVjdGlvbiBkb2VzIG5vdFxuICAgICAgICAvLyB0cmlnZ2VyIGFuIHVwZGF0ZSBvZiB0aGUgcmFuZ2UgcG9zaXRpb24gZWl0aGVyIGFmdGVyIGNvcnJlY3RpbmcuXG4gICAgICAgIC8vIEV4YW1wbGUgKGB8YCByZXByZXNlbnRzIHRoZSB0ZXh0IGN1cnNvcik6XG4gICAgICAgIC8vICAgUHJldmlvdXMgY29udGVudDogJ015IGZyaWVuZCBDaHJpc3RvZmUgd2FzIGhlcmUufCdcbiAgICAgICAgLy8gICBDdXJyZW50IGNvbnRlbnQ6ICAnTXkgZnJpZW5kIENocmlzdG9waGUgTWF0dGhpZXUgd2FzIGhlcmUufCdcbiAgICAgICAgLy8gICBBY3R1YWwgdGV4dCBpbnNlcnRlZCBieSB0aGUga2V5Ym9hcmQ6ICdDaHJpc3RvcGhlIE1hdHRoaWV1J1xuICAgICAgICAvLyAgIFJlc3VsdCBpZiBkYXRhIGlzIHNldCB0byAnQ2hyaXN0b3BoZScgKGxlbmd0aDogMTApOiAnZSB3YXMgaGVyZSdcbiAgICAgICAgLy8gICBSZXN1bHQgaWYgZGF0YSBpcyBub3Qgc2V0IChyZWdhcmRsZXNzIG9mIHRoZSByYW5nZSk6ICcnXG4gICAgICAgIC8vXG4gICAgICAgIC8vIEJlY2F1c2UgdGhlIGZpcnN0IGFuYWx5c2lzIG1pZ2h0IG5vdCBiZSBlbm91Z2ggaW4gc29tZSBjYXNlcywgYVxuICAgICAgICAvLyBzZWNvbmQgYW5hbHlzaXMgbXVzdCBiZSBwZXJmb3JtZWQuIFRoaXMgYW5hbHlzaXMgYWltcyBhdCBwcmVjaXNlbHlcbiAgICAgICAgLy8gaWRlbnRpZnlpbmcgdGhlIG9mZnNldCBvZiB0aGUgYWN0dWFsIGNoYW5nZSBpbiB0aGUgdGV4dCBieSBjb21wYXJpbmdcbiAgICAgICAgLy8gdGhlIHByZXZpb3VzIGNvbnRlbnQgd2l0aCB0aGUgY3VycmVudCBvbmUgZnJvbSBsZWZ0IHRvIHJpZ2h0IHRvIGZpbmRcbiAgICAgICAgLy8gdGhlIHN0YXJ0IG9mIHRoZSBjaGFuZ2UgYW5kIGZyb20gcmlnaHQgdG8gbGVmdCB0byBmaW5kIGl0cyBlbmQuXG4gICAgICAgIC8vIEV4YW1wbGUgKGB8YCByZXByZXNlbnRzIHRoZSB0ZXh0IGN1cnNvcik6XG4gICAgICAgIC8vICAgUHJldmlvdXMgY29udGVudDogJ015IGZyaWVuZCBDaHJpc3RvZmV8IHdhcyBoZXJlLidcbiAgICAgICAgLy8gICBDdXJyZW50IGNvbnRlbnQ6ICAnTXkgZnJpZW5kIENocmlzdG9waGUgTWF0dGhpZXV8IHdhcyBoZXJlLidcbiAgICAgICAgLy8gICBPYnNlcnZlZCBjaGFuZ2U6ICAnTXkgZnJpZW5kIENocmlzdG9bZmUgPT4gcGhlIE1hdHRoaWV1XSB3YXMgaGVyZS4nXG4gICAgICAgIC8vICAgQ2hhbmdlIG9mZnNldHMgaW4gdGhlIGN1cnJlbnQgY29udGVudDoge2xlZnQ6IDE3LCByaWdodDogMjl9XG5cbiAgICAgICAgY29uc3Qgb2xkVGV4dCA9IG9sZDtcbiAgICAgICAgY29uc3QgY3VycmVudFRleHQgPSBjdXJyZW50O1xuICAgICAgICBjb25zdCBtYXhMZW5ndGggPSBNYXRoLm1heChvbGRUZXh0Lmxlbmd0aCwgY3VycmVudFRleHQubGVuZ3RoKTtcbiAgICAgICAgbGV0IGxlZnQgPSAwO1xuICAgICAgICBmb3IgKDsgbGVmdCA8IG1heExlbmd0aDsgbGVmdCsrKSB7XG4gICAgICAgICAgICBpZiAob2xkVGV4dFtsZWZ0XSAhPT0gY3VycmVudFRleHRbbGVmdF0pIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsZXQgcmlnaHQgPSAwO1xuICAgICAgICBmb3IgKDsgcmlnaHQgPCBtYXhMZW5ndGg7IHJpZ2h0KyspIHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBvbGRUZXh0W29sZFRleHQubGVuZ3RoIC0gMSAtIHJpZ2h0XSAhPT0gY3VycmVudFRleHRbY3VycmVudFRleHQubGVuZ3RoIC0gMSAtIHJpZ2h0XVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHsgbGVmdCwgcmlnaHQgfTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gSGFuZGxlcnNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBfb25NdXRhdGlvbihtdXRhdGlvbnNMaXN0OiBNdXRhdGlvblJlY29yZFtdKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLl9saXN0ZW4pIHtcbiAgICAgICAgICAgIC8vIHdlIHB1c2ggdGhlIG11dGF0aW9uIGJlY2F1c2Ugc29tZSBicm93c2VyIChlLmcuIHNhZmFyaSkgc2VwYXJhdGUgbXV0YXRpb25zIHdpdGhcbiAgICAgICAgICAgIC8vIG1pY3JvdGFzay5cbiAgICAgICAgICAgIHRoaXMuX211dGF0aW9ucy5wdXNoKC4uLm11dGF0aW9uc0xpc3QpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgSldFZGl0b3IsIHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgTGF5b3V0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvTGF5b3V0JztcbmltcG9ydCB7IERvbUxheW91dExvY2F0aW9uLCBEb21MYXlvdXRFbmdpbmUgfSBmcm9tICcuL3VpL0RvbUxheW91dEVuZ2luZSc7XG5pbXBvcnQge1xuICAgIERvbVpvbmVQb3NpdGlvbixcbiAgICBDb21wb25lbnREZWZpbml0aW9uLFxuICAgIENvbXBvbmVudElkLFxufSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXRFbmdpbmUnO1xuaW1wb3J0IHsgSHRtbCB9IGZyb20gJy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sJztcbmltcG9ydCB7IFpvbmVIdG1sRG9tUmVuZGVyZXIgfSBmcm9tICcuL3VpL1pvbmVIdG1sRG9tUmVuZGVyZXInO1xuaW1wb3J0IHsgWm9uZVhtbERvbVBhcnNlciB9IGZyb20gJy4vdWkvWm9uZVhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBMYXlvdXRDb250YWluZXJIdG1sRG9tUmVuZGVyZXIgfSBmcm9tICcuL3VpL0xheW91dENvbnRhaW5lckh0bWxEb21SZW5kZXJlcic7XG5pbXBvcnQgeyBab25lSWRlbnRpZmllciB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL1pvbmVOb2RlJztcbmltcG9ydCB7IEtleW1hcCB9IGZyb20gJy4uLy4uL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5pbXBvcnQgeyBDb21tYW5kSWRlbnRpZmllciB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIERvbUxheW91dENvbmZpZyBleHRlbmRzIEpXUGx1Z2luQ29uZmlnIHtcbiAgICBsb2NhdGlvbj86IFtOb2RlLCBEb21ab25lUG9zaXRpb25dO1xuICAgIGxvY2F0aW9ucz86IFtDb21wb25lbnRJZCwgRG9tTGF5b3V0TG9jYXRpb25dW107XG4gICAgY29tcG9uZW50cz86IENvbXBvbmVudERlZmluaXRpb25bXTtcbiAgICBjb21wb25lbnRab25lcz86IFtDb21wb25lbnRJZCwgWm9uZUlkZW50aWZpZXJdW107XG4gICAgYWZ0ZXJSZW5kZXI/OiBGdW5jdGlvbjtcbn1cblxuZXhwb3J0IGNsYXNzIERvbUxheW91dDxUIGV4dGVuZHMgRG9tTGF5b3V0Q29uZmlnID0gRG9tTGF5b3V0Q29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW0h0bWwsIFBhcnNlciwgUmVuZGVyZXIsIExheW91dCwgS2V5bWFwXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlciAmIExheW91dD4gPSB7XG4gICAgICAgIHJlbmRlcmVyczogW1pvbmVIdG1sRG9tUmVuZGVyZXIsIExheW91dENvbnRhaW5lckh0bWxEb21SZW5kZXJlcl0sXG4gICAgICAgIHBhcnNlcnM6IFtab25lWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgbGF5b3V0RW5naW5lczogW10sXG4gICAgICAgIGNvbXBvbmVudHM6IFtdLFxuICAgIH07XG4gICAgcmVhZG9ubHkgbG9hZGVycyA9IHtcbiAgICAgICAgZG9tTG9jYXRpb25zOiB0aGlzLl9sb2FkQ29tcG9uZW50TG9jYXRpb25zLFxuICAgIH07XG4gICAgY29tbWFuZEhvb2tzID0ge1xuICAgICAgICAnKic6IHRoaXMuX3JlZHJhdyxcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IoZWRpdG9yOiBKV0VkaXRvciwgY29uZmlndXJhdGlvbjogVCkge1xuICAgICAgICBzdXBlcihlZGl0b3IsIGNvbmZpZ3VyYXRpb24pO1xuICAgICAgICB0aGlzLmxvYWRhYmxlcy5sYXlvdXRFbmdpbmVzLnB1c2goRG9tTGF5b3V0RW5naW5lKTtcbiAgICAgICAgdGhpcy5wcm9jZXNzS2V5ZG93biA9IHRoaXMucHJvY2Vzc0tleWRvd24uYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBhc3luYyBzdGFydCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5kZXBlbmRlbmNpZXMuZ2V0KExheW91dCk7XG4gICAgICAgIGNvbnN0IGRvbUxheW91dEVuZ2luZSA9IGxheW91dC5lbmdpbmVzLmRvbSBhcyBEb21MYXlvdXRFbmdpbmU7XG4gICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIHRoaXMuY29uZmlndXJhdGlvbi5jb21wb25lbnRzIHx8IFtdKSB7XG4gICAgICAgICAgICBkb21MYXlvdXRFbmdpbmUubG9hZENvbXBvbmVudChjb21wb25lbnQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHpvbmVzOiBSZWNvcmQ8Q29tcG9uZW50SWQsIFpvbmVJZGVudGlmaWVyPiA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IFtpZCwgem9uZV0gb2YgdGhpcy5jb25maWd1cmF0aW9uLmNvbXBvbmVudFpvbmVzIHx8IFtdKSB7XG4gICAgICAgICAgICB6b25lc1tpZF0gPSB6b25lO1xuICAgICAgICB9XG4gICAgICAgIGRvbUxheW91dEVuZ2luZS5sb2FkQ29tcG9uZW50Wm9uZXMoem9uZXMpO1xuICAgICAgICB0aGlzLl9sb2FkQ29tcG9uZW50TG9jYXRpb25zKHRoaXMuY29uZmlndXJhdGlvbi5sb2NhdGlvbnMgfHwgW10pO1xuICAgICAgICBkb21MYXlvdXRFbmdpbmUubG9jYXRpb24gPSB0aGlzLmNvbmZpZ3VyYXRpb24ubG9jYXRpb247XG4gICAgICAgIGF3YWl0IGRvbUxheW91dEVuZ2luZS5zdGFydCgpO1xuICAgICAgICBhd2FpdCB0aGlzLmNvbmZpZ3VyYXRpb24uYWZ0ZXJSZW5kZXI/LigpO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMucHJvY2Vzc0tleWRvd24sIHRydWUpO1xuICAgIH1cbiAgICBhc3luYyBzdG9wKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMucHJvY2Vzc0tleWRvd24sIHRydWUpO1xuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmRlcGVuZGVuY2llcy5nZXQoTGF5b3V0KTtcbiAgICAgICAgY29uc3QgZG9tTGF5b3V0RW5naW5lID0gbGF5b3V0LmVuZ2luZXMuZG9tO1xuICAgICAgICBhd2FpdCBkb21MYXlvdXRFbmdpbmUuc3RvcCgpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBLZXlib2FyZEV2ZW50IGxpc3RlbmVyIHRvIGJlIGFkZGVkIHRvIHRoZSBET00gdGhhdCBjYWxscyBgZXhlY0NvbW1hbmRgIGlmXG4gICAgICogdGhlIGtleXMgcHJlc3NlZCBtYXRjaCBvbmUgb2YgdGhlIHNob3J0Y3V0IHJlZ2lzdGVyZWQgaW4gdGhlIGtleW1hcC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudFxuICAgICAqL1xuICAgIGFzeW5jIHByb2Nlc3NLZXlkb3duKGV2ZW50OiBLZXlib2FyZEV2ZW50KTogUHJvbWlzZTxDb21tYW5kSWRlbnRpZmllcj4ge1xuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmRlcGVuZGVuY2llcy5nZXQoTGF5b3V0KTtcbiAgICAgICAgY29uc3QgZG9tTGF5b3V0RW5naW5lID0gbGF5b3V0LmVuZ2luZXMuZG9tIGFzIERvbUxheW91dEVuZ2luZTtcblxuICAgICAgICBpZiAoZXZlbnQudGFyZ2V0ICYmICFkb21MYXlvdXRFbmdpbmUuZ2V0Tm9kZXMoZXZlbnQudGFyZ2V0IGFzIE5vZGUpLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gRG9uJ3QgcHJvY2VzcyBrZXlkb3duIGlmIHRoZSB1c2VyIGlzIG91dHNpZGUgdGhlIGN1cnJlbnQgZWRpdG9yXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBrZXltYXAgPSB0aGlzLmRlcGVuZGVuY2llcy5nZXQoS2V5bWFwKTtcbiAgICAgICAgY29uc3QgY29tbWFuZHMgPSBrZXltYXAubWF0Y2goZXZlbnQpO1xuICAgICAgICBjb25zdCBbY29tbWFuZCwgY29udGV4dF0gPSB0aGlzLmVkaXRvci5jb250ZXh0TWFuYWdlci5tYXRjaChjb21tYW5kcyk7XG5cbiAgICAgICAgaWYgKGNvbW1hbmQgJiYgY29tbWFuZC5jb21tYW5kSWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtcyA9IHsgY29udGV4dCwgLi4uY29tbWFuZC5jb21tYW5kQXJncyB9O1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLmVkaXRvci5uZXh0RXZlbnRNdXRleCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWRpdG9yLmV4ZWNDb21tYW5kKGNvbW1hbmQuY29tbWFuZElkLCBwYXJhbXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gY29tbWFuZC5jb21tYW5kSWQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIHByaXZhdGUgYXN5bmMgX3JlZHJhdygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ2RvbWxheW91dCByZWRyYXdzJyk7XG4gICAgICAgIC8vIFRPRE8gdXBkYXRlIHRoaXMgbWV0aG9kIHRvIHVzZSBKU09OIHJlbmRlcmVyIGZlYXR1cmUgKHVwZGF0ZSBhbHNvIHNob3csIGhpZGUsIGFkZCwgcmVtb3ZlKVxuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmRlcGVuZGVuY2llcy5nZXQoTGF5b3V0KTtcbiAgICAgICAgY29uc3QgZG9tTGF5b3V0RW5naW5lID0gbGF5b3V0LmVuZ2luZXMuZG9tIGFzIERvbUxheW91dEVuZ2luZTtcbiAgICAgICAgY29uc3QgZWRpdGFibGVzID0gZG9tTGF5b3V0RW5naW5lLmNvbXBvbmVudHMuZ2V0KCdlZGl0YWJsZScpO1xuICAgICAgICBpZiAoZWRpdGFibGVzPy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGF3YWl0IGRvbUxheW91dEVuZ2luZS5yZWRyYXcoZWRpdGFibGVzWzBdKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuY29uZmlndXJhdGlvbi5hZnRlclJlbmRlcj8uKCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3RoaXMuY29uZmlndXJhdGlvbi5hZnRlclJlbmRlcjonLCB0aGlzLmNvbmZpZ3VyYXRpb24uYWZ0ZXJSZW5kZXIpO1xuICAgIH1cbiAgICBwcml2YXRlIF9sb2FkQ29tcG9uZW50TG9jYXRpb25zKGxvY2F0aW9uczogW0NvbXBvbmVudElkLCBEb21MYXlvdXRMb2NhdGlvbl1bXSk6IHZvaWQge1xuICAgICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmRlcGVuZGVuY2llcy5nZXQoTGF5b3V0KTtcbiAgICAgICAgY29uc3QgZG9tTGF5b3V0RW5naW5lID0gbGF5b3V0LmVuZ2luZXMuZG9tIGFzIERvbUxheW91dEVuZ2luZTtcbiAgICAgICAgZm9yIChjb25zdCBbaWQsIGxvY2F0aW9uXSBvZiBsb2NhdGlvbnMpIHtcbiAgICAgICAgICAgIGRvbUxheW91dEVuZ2luZS5sb2NhdGlvbnNbaWRdID0gbG9jYXRpb247XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSwgUmVsYXRpdmVQb3NpdGlvbiwgUG9pbnQgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHtcbiAgICBMYXlvdXRFbmdpbmUsXG4gICAgQ29tcG9uZW50SWQsXG4gICAgRG9tWm9uZVBvc2l0aW9uLFxuICAgIENvbXBvbmVudERlZmluaXRpb24sXG59IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dEVuZ2luZSc7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IFpvbmVOb2RlLCBab25lSWRlbnRpZmllciB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL1pvbmVOb2RlJztcbmltcG9ydCB7IG5vZGVMZW5ndGggfSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgRGlyZWN0aW9uLCBWU2VsZWN0aW9uRGVzY3JpcHRpb24gfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9WU2VsZWN0aW9uJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBMYXlvdXRDb250YWluZXIgfSBmcm9tICcuL0xheW91dENvbnRhaW5lck5vZGUnO1xuaW1wb3J0IHsgTWFya2VyTm9kZSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9NYXJrZXJOb2RlJztcbmltcG9ydCB7IERvbU1hcCwgRG9tUG9pbnQgfSBmcm9tICcuL0RvbU1hcCc7XG5pbXBvcnQgeyBEb21TZWxlY3Rpb25EZXNjcmlwdGlvbiB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1kb20tZWRpdGFibGUvc3JjL0V2ZW50Tm9ybWFsaXplcic7XG5pbXBvcnQgSldFZGl0b3IgZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuXG5leHBvcnQgdHlwZSBEb21MYXlvdXRMb2NhdGlvbiA9IFtOb2RlLCBEb21ab25lUG9zaXRpb25dO1xuXG5leHBvcnQgY2xhc3MgRG9tTGF5b3V0RW5naW5lIGV4dGVuZHMgTGF5b3V0RW5naW5lIHtcbiAgICByZWFkb25seSBpZCA9ICdkb20nO1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX2RvbU1hcCA9IG5ldyBEb21NYXAoKTtcbiAgICAvLyB1c2VkIG9ubHkgdG8gZGV2ZWxvcCBhbmQgYXZvaWQgd3JvbmcgcHJvbWlzZSBmcm9tIGNvbW1hbmRzXG4gICAgcHJpdmF0ZSBfY3VycmVudGx5UmVkcmF3aW5nID0gZmFsc2U7XG5cbiAgICBwcml2YXRlIHJlbmRlcmluZ01hcDogUmVjb3JkPENvbXBvbmVudElkLCBOb2RlW10+ID0ge307XG4gICAgbG9jYXRpb246IFtOb2RlLCBEb21ab25lUG9zaXRpb25dO1xuICAgIGxvY2F0aW9uczogUmVjb3JkPENvbXBvbmVudElkLCBEb21MYXlvdXRMb2NhdGlvbj4gPSB7fTtcblxuICAgIGRlZmF1bHRSb290Q29tcG9uZW50OiBDb21wb25lbnREZWZpbml0aW9uID0ge1xuICAgICAgICBpZDogJ2VkaXRvcicsXG4gICAgICAgIHJlbmRlcihlZGl0b3I6IEpXRWRpdG9yKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgICAgICBjb25zdCBsYXlvdXQgPSAnPGp3LWVkaXRvcj48dCB0LXpvbmU9XCJtYWluXCIvPjx0IHQtem9uZT1cImRlZmF1bHRcIi8+PC9qdy1lZGl0b3I+JztcbiAgICAgICAgICAgIHJldHVybiBlZGl0b3IucGx1Z2lucy5nZXQoUGFyc2VyKS5wYXJzZSgndGV4dC9odG1sJywgbGF5b3V0KTtcbiAgICAgICAgfSxcbiAgICB9O1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIExpZmVjeWNsZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIGFzeW5jIHN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBmb3IgKGNvbnN0IGNvbXBvbmVudElkIGluIHRoaXMubG9jYXRpb25zKSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmluZ01hcFtjb21wb25lbnRJZF0gPSBbXTtcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50Wm9uZXNbY29tcG9uZW50SWRdID0gJ3Jvb3QnO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmNvbXBvbmVudERlZmluaXRpb25zW2NvbXBvbmVudElkXSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTGF5b3V0IGNvbXBvbmVudCBcIicgKyBjb21wb25lbnRJZCArICdcIiBub3QgZm91bmQuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFPYmplY3QudmFsdWVzKHRoaXMuY29tcG9uZW50Wm9uZXMpLmluY2x1ZGVzKCdyb290JykpIHtcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50RGVmaW5pdGlvbnMuZWRpdG9yID0gdGhpcy5kZWZhdWx0Um9vdENvbXBvbmVudDtcbiAgICAgICAgICAgIHRoaXMuY29tcG9uZW50Wm9uZXMuZWRpdG9yID0gJ3Jvb3QnO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50SWQgaW4gdGhpcy5jb21wb25lbnREZWZpbml0aW9ucykge1xuICAgICAgICAgICAgdGhpcy5fcHJlcGFyZUxheW91dENvbnRhaW5lckFuZExvY2F0aW9uKHRoaXMuY29tcG9uZW50RGVmaW5pdGlvbnNbY29tcG9uZW50SWRdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHN1cGVyLnN0YXJ0KCk7XG4gICAgICAgIGF3YWl0IHRoaXMucmVkcmF3KCk7XG4gICAgfVxuICAgIGFzeW5jIHN0b3AoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50SWQgaW4gdGhpcy5jb21wb25lbnREZWZpbml0aW9ucykge1xuICAgICAgICAgICAgY29uc3QgbG9jYXRpb24gPSB0aGlzLmxvY2F0aW9uc1tjb21wb25lbnRJZF07XG4gICAgICAgICAgICBpZiAobG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlcyA9IHRoaXMuY29tcG9uZW50cy5nZXQoY29tcG9uZW50SWQpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBkb21Ob2RlcyA9IHRoaXMuZ2V0RG9tTm9kZXMobm9kZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvblsxXSA9PT0gJ3JlcGxhY2UnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVbmRvIHRoZSByZXBsYWNlIHRoYXQgd2FzIGRvbmUgYnkgdGhlIGxheW91dCBlbmdpbmUuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZmlyc3QgPSBkb21Ob2RlcyAmJiBkb21Ob2Rlc1swXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZmlyc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdCA9IHRoaXMucmVuZGVyaW5nTWFwW2NvbXBvbmVudElkXVswXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaXJzdCAmJiBmaXJzdC5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3QucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobG9jYXRpb25bMF0sIGZpcnN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgZG9tTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkb21Ob2RlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZG9tTm9kZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZG9tTWFwLmNsZWFyKCk7XG4gICAgICAgIHRoaXMucmVuZGVyaW5nTWFwID0ge307XG4gICAgICAgIHRoaXMubG9jYXRpb24gPSBudWxsO1xuICAgICAgICB0aGlzLmxvY2F0aW9ucyA9IHt9O1xuICAgICAgICByZXR1cm4gc3VwZXIuc3RvcCgpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIFZOb2RlKHMpIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuIERPTSBOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIE5vZGVcbiAgICAgKi9cbiAgICBnZXROb2Rlcyhkb21Ob2RlOiBOb2RlKTogVk5vZGVbXSB7XG4gICAgICAgIGNvbnN0IG5vZGVzID0gdGhpcy5fZG9tTWFwLmZyb21Eb20oZG9tTm9kZSkgfHwgW107XG4gICAgICAgIHJldHVybiBub2Rlcy5maWx0ZXIobm9kZSA9PiAhKG5vZGUgaW5zdGFuY2VvZiBab25lTm9kZSkpO1xuICAgIH1cbiAgICBnZXREb21Ob2Rlcyhub2RlOiBWTm9kZSk6IE5vZGVbXSB7XG4gICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgTGF5b3V0Q29udGFpbmVyKSB7XG4gICAgICAgICAgICByZXR1cm4gbm9kZS5jaGlsZFZOb2Rlcy5tYXAobm9kZSA9PiB0aGlzLmdldERvbU5vZGVzKG5vZGUpKS5mbGF0KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZG9tTWFwLnRvRG9tKG5vZGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZHJhdyB0aGUgbGF5b3V0IGNvbXBvbmVudCBhZnRlciBpbnNlcnRpb24uXG4gICAgICogSWYgdGhlIHRhcmdldCB6b25lIGlzIHRoZSByb290LCBwcmVwYXJlIGl0cyBsb2NhdGlvbiBiZWZvcmUgcmVkcmF3aW5nLlxuICAgICAqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgYXN5bmMgYWRkKGNvbXBvbmVudElkOiBDb21wb25lbnRJZCwgem9uZUlkOiBab25lSWRlbnRpZmllcik6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBub2RlcyA9IGF3YWl0IHN1cGVyLmFkZChjb21wb25lbnRJZCwgem9uZUlkKTtcbiAgICAgICAgLy8gRmlsdGVyIG91dCBjaGlsZHJlbiBvZiBub2RlcyB0aGF0IHdlIGFyZSBhbHJlYWR5IGdvaW5nIHRvIHJlZHJhdy5cbiAgICAgICAgY29uc3Qgbm9kZVRvUmVkcmF3ID0gbm9kZXMuZmlsdGVyKG5vZGUgPT4gIW5vZGUuYW5jZXN0b3IobiA9PiBub2Rlcy5pbmNsdWRlcyhuKSkpO1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZVRvUmVkcmF3KSB7XG4gICAgICAgICAgICAvLyBvbmx5IHVzZWQgaWYgdGhlIHpvbmUgd2FudCB0byByZXR1cm4gYSBOb2RlIGJ1dCBoaWRlIHRoZSBjb21wb25lbnQgKGVnOiBhIHBhbmVsKVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZWRyYXcobm9kZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5vZGVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWRyYXcgdGhlIGxheW91dCBjb21wb25lbnQgYWZ0ZXIgcmVtb3ZhbC5cbiAgICAgKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIGFzeW5jIHJlbW92ZShjb21wb25lbnRJZDogQ29tcG9uZW50SWQpOiBQcm9taXNlPFpvbmVOb2RlW10+IHtcbiAgICAgICAgY29uc3Qgem9uZXMgPSBhd2FpdCBzdXBlci5yZW1vdmUoY29tcG9uZW50SWQpO1xuICAgICAgICBmb3IgKGNvbnN0IHpvbmUgb2Ygem9uZXMpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucmVkcmF3KHpvbmUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB6b25lcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVkcmF3IHRoZSBsYXlvdXQgY29tcG9uZW50IGFmdGVyIHNob3dpbmcgdGhlIGNvbXBvbmVudC5cbiAgICAgKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIGFzeW5jIHNob3coY29tcG9uZW50SWQ6IENvbXBvbmVudElkKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgc3VwZXIuc2hvdyhjb21wb25lbnRJZCk7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlcykge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZWRyYXcobm9kZS5hbmNlc3Rvcihab25lTm9kZSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVkcmF3IHRoZSBsYXlvdXQgY29tcG9uZW50IGFmdGVyIGhpZGRpbmcgdGhlIGNvbXBvbmVudC5cbiAgICAgKlxuICAgICAqIEBvdmVycmlkZVxuICAgICAqL1xuICAgIGFzeW5jIGhpZGUoY29tcG9uZW50SWQ6IENvbXBvbmVudElkKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgc3VwZXIuaGlkZShjb21wb25lbnRJZCk7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlcykge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5yZWRyYXcobm9kZS5hbmNlc3Rvcihab25lTm9kZSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG4gICAgYXN5bmMgcmVkcmF3KG5vZGU/OiBWTm9kZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvLyBpZiAodGhpcy5fY3VycmVudGx5UmVkcmF3aW5nKSB7XG4gICAgICAgIC8vICAgICB0aHJvdyBuZXcgRXJyb3IoJ0RvdWJsZSByZWRyYXcgZGV0ZWN0ZWQnKTtcbiAgICAgICAgLy8gfVxuICAgICAgICBpZiAodGhpcy5lZGl0b3IucHJldmVudFJlbmRlcnMuc2l6ZSkgcmV0dXJuO1xuICAgICAgICB0aGlzLl9jdXJyZW50bHlSZWRyYXdpbmcgPSB0cnVlO1xuICAgICAgICAvLyBGaW5kIHRoZSBjbG9zZXN0IG5vZGUgdGhhdCBoYXMgYWxyZWFkeSBiZWVuIHJlbmRlcmVkIHByZWNpb3VzbHkuXG4gICAgICAgIGNvbnN0IG5vZGVUb1JlZHJhdyA9IG5vZGU/LmNsb3Nlc3QobiA9PiB7XG4gICAgICAgICAgICBjb25zdCBkb21Ob2RlID0gdGhpcy5fZG9tTWFwLnRvRG9tKG4pLnBvcCgpO1xuICAgICAgICAgICAgcmV0dXJuIGRvbU5vZGU/Lm93bmVyRG9jdW1lbnQuYm9keS5jb250YWlucyhkb21Ob2RlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKG5vZGVUb1JlZHJhdykge1xuICAgICAgICAgICAgLy8gcmVkcmF3IGl0ZW1cbiAgICAgICAgICAgIGNvbnN0IGRvbU5vZGVUb1JlZHJhdyA9IHRoaXMuX2RvbU1hcC50b0RvbShub2RlVG9SZWRyYXcpLnBvcCgpO1xuICAgICAgICAgICAgbGV0IGNvbXBvbmVudElkZW50aWZpZXI6IENvbXBvbmVudElkO1xuICAgICAgICAgICAgZm9yIChjb25zdCBbY29tcG9uZW50SWQsIG5vZGVzXSBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgICAgICBpZiAobm9kZXMuaW5jbHVkZXMobm9kZVRvUmVkcmF3KSkge1xuICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRJZGVudGlmaWVyID0gY29tcG9uZW50SWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmxvY2F0aW9uc1tjb21wb25lbnRJZGVudGlmaWVyXSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuX3JlbmRlck5vZGUobm9kZVRvUmVkcmF3KTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLl9hcHBlbmRDb21wb25lbnRJbkRvbShjb21wb25lbnRJZGVudGlmaWVyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IGRvbU5vZGVUb1JlZHJhdy5wYXJlbnROb2RlO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRvbU5vZGVzID0gYXdhaXQgdGhpcy5fcmVuZGVyTm9kZShub2RlVG9SZWRyYXcpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZG9tTm9kZSBvZiBkb21Ob2Rlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZG9tTm9kZSAhPT0gZG9tTm9kZVRvUmVkcmF3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXBhcmVudE5vZGUpIGRlYnVnZ2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZG9tTm9kZSwgZG9tTm9kZVRvUmVkcmF3KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0ID0gZG9tTm9kZXM/Lmxlbmd0aCAmJiBkb21Ob2Rlc1tkb21Ob2Rlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICBpZiAobGFzdCAhPT0gZG9tTm9kZVRvUmVkcmF3KSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZG9tTm9kZVRvUmVkcmF3KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyByZWRyYXcgYWxsXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNvbXBvbmVudElkIGluIHRoaXMubG9jYXRpb25zKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLmNvbXBvbmVudHMuZ2V0KGNvbXBvbmVudElkKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5fcmVuZGVyTm9kZShub2RlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5fYXBwZW5kQ29tcG9uZW50SW5Eb20oY29tcG9uZW50SWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3JlbmRlclNlbGVjdGlvbigpO1xuICAgICAgICAvLyB0aGlzLl9jdXJyZW50bHlSZWRyYXdpbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgYXN5bmMgcGFyc2VFbGVtZW50KGVsZW1lbnQ6IEhUTUxFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHBhcnNlciA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFBhcnNlcik7XG4gICAgICAgIGNvbnN0IGRvbVBhcnNlckVuZ2luZSA9IHBhcnNlci5lbmdpbmVzWydkb20vaHRtbCddIGFzIFBhcnNpbmdFbmdpbmU8Tm9kZT47XG4gICAgICAgIGNvbnN0IHBhcnNlZFZOb2RlcyA9IGF3YWl0IGRvbVBhcnNlckVuZ2luZS5wYXJzZShlbGVtZW50KTtcblxuICAgICAgICAvLyBDb25zdHJ1Y3QgRE9NIG1hcCBmcm9tIHRoZSBwYXJzaW5nIGluIG9yZGVyIHRvIHBhcnNlIHRoZSBzZWxlY3Rpb24uXG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBwYXJzZWRWTm9kZXMpIHtcbiAgICAgICAgICAgIHRoaXMuX2RvbU1hcC5zZXQobm9kZSwgZWxlbWVudCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBbZG9tTm9kZSwgbm9kZXNdIG9mIGRvbVBhcnNlckVuZ2luZS5wYXJzaW5nTWFwKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kb21NYXAuc2V0KG5vZGUsIGRvbU5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZG9tU2VsZWN0aW9uID0gZWxlbWVudC5vd25lckRvY3VtZW50LmdldFNlbGVjdGlvbigpO1xuICAgICAgICBjb25zdCBhbmNob3JOb2RlID0gZG9tU2VsZWN0aW9uLmFuY2hvck5vZGU7XG4gICAgICAgIGlmIChlbGVtZW50ID09PSBhbmNob3JOb2RlIHx8IGVsZW1lbnQuY29udGFpbnMoYW5jaG9yTm9kZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IHRoaXMucGFyc2VTZWxlY3Rpb24oZG9tU2VsZWN0aW9uKTtcbiAgICAgICAgICAgIHRoaXMuZWRpdG9yLnNlbGVjdGlvbi5zZXQoc2VsZWN0aW9uKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFyc2VkVk5vZGVzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZSB0aGUgZG9tIHNlbGVjdGlvbiBpbnRvIHRoZSBkZXNjcmlwdGlvbiBvZiBhIFZTZWxlY3Rpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2VsZWN0aW9uXG4gICAgICogQHBhcmFtIFtkaXJlY3Rpb25dXG4gICAgICovXG4gICAgcGFyc2VTZWxlY3Rpb24oc2VsZWN0aW9uOiBTZWxlY3Rpb24gfCBEb21TZWxlY3Rpb25EZXNjcmlwdGlvbik6IFZTZWxlY3Rpb25EZXNjcmlwdGlvbiB7XG4gICAgICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy5fbG9jYXRlKHNlbGVjdGlvbi5hbmNob3JOb2RlLCBzZWxlY3Rpb24uYW5jaG9yT2Zmc2V0KTtcbiAgICAgICAgY29uc3QgZW5kID0gdGhpcy5fbG9jYXRlKHNlbGVjdGlvbi5mb2N1c05vZGUsIHNlbGVjdGlvbi5mb2N1c09mZnNldCk7XG4gICAgICAgIGNvbnN0IFtzdGFydFZOb2RlLCBzdGFydFBvc2l0aW9uXSA9IHN0YXJ0O1xuICAgICAgICBjb25zdCBbZW5kVk5vZGUsIGVuZFBvc2l0aW9uXSA9IGVuZDtcblxuICAgICAgICBsZXQgZGlyZWN0aW9uOiBEaXJlY3Rpb247XG4gICAgICAgIGlmIChzZWxlY3Rpb24gaW5zdGFuY2VvZiBTZWxlY3Rpb24pIHtcbiAgICAgICAgICAgIGNvbnN0IGRvbVJhbmdlID0gc2VsZWN0aW9uLnJhbmdlQ291bnQgJiYgc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgZG9tUmFuZ2Uuc3RhcnRDb250YWluZXIgPT09IHNlbGVjdGlvbi5hbmNob3JOb2RlICYmXG4gICAgICAgICAgICAgICAgZG9tUmFuZ2Uuc3RhcnRPZmZzZXQgPT09IHNlbGVjdGlvbi5hbmNob3JPZmZzZXRcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIGRpcmVjdGlvbiA9IERpcmVjdGlvbi5GT1JXQVJEO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkaXJlY3Rpb24gPSBEaXJlY3Rpb24uQkFDS1dBUkQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkaXJlY3Rpb24gPSBzZWxlY3Rpb24uZGlyZWN0aW9uO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFuY2hvck5vZGU6IHN0YXJ0Vk5vZGUsXG4gICAgICAgICAgICBhbmNob3JQb3NpdGlvbjogc3RhcnRQb3NpdGlvbixcbiAgICAgICAgICAgIGZvY3VzTm9kZTogZW5kVk5vZGUsXG4gICAgICAgICAgICBmb2N1c1Bvc2l0aW9uOiBlbmRQb3NpdGlvbixcbiAgICAgICAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBnaXZlbiBWU2VsZWN0aW9uIGFzIGEgRE9NIHNlbGVjdGlvbiBpbiB0aGUgZ2l2ZW4gdGFyZ2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHNlbGVjdGlvblxuICAgICAqIEBwYXJhbSB0YXJnZXRcbiAgICAgKi9cbiAgICBwcml2YXRlIF9yZW5kZXJTZWxlY3Rpb24oKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGlvbiA9IHRoaXMuZWRpdG9yLnNlbGVjdGlvbjtcbiAgICAgICAgY29uc3QgZG9tTm9kZSA9IHRoaXMuX2RvbU1hcC50b0RvbShzZWxlY3Rpb24uYW5jaG9yLnBhcmVudClbMF07XG4gICAgICAgIGlmICghZG9tTm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGRvY3VtZW50ID0gZG9tTm9kZS5vd25lckRvY3VtZW50O1xuICAgICAgICBjb25zdCBhbmNob3IgPSB0aGlzLl9nZXREb21Mb2NhdGlvbihzZWxlY3Rpb24uYW5jaG9yKTtcbiAgICAgICAgY29uc3QgZm9jdXMgPSB0aGlzLl9nZXREb21Mb2NhdGlvbihzZWxlY3Rpb24uZm9jdXMpO1xuICAgICAgICBjb25zdCBkb21TZWxlY3Rpb24gPSBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKTtcblxuICAgICAgICBpZiAoXG4gICAgICAgICAgICBkb21TZWxlY3Rpb24uYW5jaG9yTm9kZSA9PT0gYW5jaG9yWzBdICYmXG4gICAgICAgICAgICBkb21TZWxlY3Rpb24uYW5jaG9yT2Zmc2V0ID09PSBhbmNob3JbMV0gJiZcbiAgICAgICAgICAgIGRvbVNlbGVjdGlvbi5mb2N1c05vZGUgPT09IGZvY3VzWzBdICYmXG4gICAgICAgICAgICBkb21TZWxlY3Rpb24uZm9jdXNPZmZzZXQgPT09IGZvY3VzWzFdXG4gICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZG9tUmFuZ2UgPSBkb21Ob2RlLm93bmVyRG9jdW1lbnQuY3JlYXRlUmFuZ2UoKTtcbiAgICAgICAgaWYgKHNlbGVjdGlvbi5kaXJlY3Rpb24gPT09IERpcmVjdGlvbi5GT1JXQVJEKSB7XG4gICAgICAgICAgICBkb21SYW5nZS5zZXRTdGFydChhbmNob3JbMF0sIGFuY2hvclsxXSk7XG4gICAgICAgICAgICBkb21SYW5nZS5jb2xsYXBzZSh0cnVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRvbVJhbmdlLnNldEVuZChhbmNob3JbMF0sIGFuY2hvclsxXSk7XG4gICAgICAgICAgICBkb21SYW5nZS5jb2xsYXBzZShmYWxzZSk7XG4gICAgICAgIH1cbiAgICAgICAgZG9tU2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuICAgICAgICBkb21TZWxlY3Rpb24uYWRkUmFuZ2UoZG9tUmFuZ2UpO1xuICAgICAgICBkb21TZWxlY3Rpb24uZXh0ZW5kKGZvY3VzWzBdLCBmb2N1c1sxXSk7XG4gICAgfVxuICAgIHByaXZhdGUgYXN5bmMgX2FwcGVuZENvbXBvbmVudEluRG9tKGlkOiBDb21wb25lbnRJZCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBsZXQgW3RhcmdldCwgcG9zaXRpb25dID0gdGhpcy5sb2NhdGlvbnNbaWRdO1xuICAgICAgICBjb25zdCBub2RlcyA9IHRoaXMucmVuZGVyaW5nTWFwW2lkXTtcbiAgICAgICAgY29uc3QgZmlyc3QgPSBub2Rlcy5maW5kKG5vZGUgPT4gbm9kZS5wYXJlbnROb2RlICYmIG5vZGUub3duZXJEb2N1bWVudC5ib2R5LmNvbnRhaW5zKG5vZGUpKTtcblxuICAgICAgICBpZiAoZmlyc3Q/LnByZXZpb3VzU2libGluZykge1xuICAgICAgICAgICAgdGFyZ2V0ID0gZmlyc3QucHJldmlvdXNTaWJsaW5nO1xuICAgICAgICAgICAgcG9zaXRpb24gPSAnYWZ0ZXInO1xuICAgICAgICB9IGVsc2UgaWYgKGZpcnN0Py5wYXJlbnROb2RlPy5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICB0YXJnZXQgPSBmaXJzdC5wYXJlbnROb2RlO1xuICAgICAgICAgICAgcG9zaXRpb24gPSAncHJlcGVuZCc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgcHJldmlvdXMgPSBpZDtcbiAgICAgICAgICAgIHdoaWxlICgocHJldmlvdXMgPSB0aGlzLl9nZXRQcmV2aW91c0NvbXBvbmVudElkKHByZXZpb3VzKSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsYXN0ID0gdGhpcy5yZW5kZXJpbmdNYXBbcHJldmlvdXNdW3RoaXMucmVuZGVyaW5nTWFwW3ByZXZpb3VzXS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICBpZiAobGFzdCAmJiBsYXN0Lm93bmVyRG9jdW1lbnQuYm9keS5jb250YWlucyhsYXN0KSkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnZXQgPSBsYXN0O1xuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbiA9ICdhZnRlcic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSAnYWZ0ZXInICYmICF0YXJnZXQucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbXBvc3NpYmxlIHRvIHJlbmRlciBhIGNvbXBvbmVudCBhZnRlciBhbiBlbGVtZW50IHdpdGggbm8gcGFyZW50LicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ3JlcGxhY2UnICYmICF0YXJnZXQucGFyZW50Tm9kZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbXBvc3NpYmxlIHRvIHJlcGxhY2UgYW4gZWxlbWVudCB3aXRob3V0IGFueSBwYXJlbnQuJyk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkb21Ob2RlcyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgdGhpcy5jb21wb25lbnRzLmdldChpZCkpIHtcbiAgICAgICAgICAgIGRvbU5vZGVzLnB1c2goLi4udGhpcy5nZXREb21Ob2Rlcyhub2RlKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkb21Ob2Rlcy5sZW5ndGggJiYgdGhpcy5sb2NhdGlvbnNbaWRdWzFdID09PSAncmVwbGFjZScpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW1wb3NzaWJsZSB0byByZXBsYWNlIGEgZWxlbWVudCB3aXRoIGFuIGVtcHR5IHRlbXBsYXRlLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHBvc2l0aW9uID09PSAnYWZ0ZXInKSB7XG4gICAgICAgICAgICBpZiAodGFyZ2V0Lm5leHRTaWJsaW5nKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIGRvbU5vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkb21Ob2RlLCB0YXJnZXQubmV4dFNpYmxpbmcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIGRvbU5vZGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5wYXJlbnROb2RlLmFwcGVuZENoaWxkKGRvbU5vZGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ3ByZXBlbmQnKSB7XG4gICAgICAgICAgICBjb25zdCBmaXJzdENoaWxkID0gdGFyZ2V0LmZpcnN0Q2hpbGQ7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbU5vZGUgb2YgZG9tTm9kZXMpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQuaW5zZXJ0QmVmb3JlKGRvbU5vZGUsIGZpcnN0Q2hpbGQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAncmVwbGFjZScpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZG9tTm9kZSBvZiBkb21Ob2Rlcykge1xuICAgICAgICAgICAgICAgIHRhcmdldC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShkb21Ob2RlLCB0YXJnZXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGFyZ2V0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZG9tTm9kZSBvZiBkb21Ob2Rlcykge1xuICAgICAgICAgICAgICAgIHRhcmdldC5hcHBlbmRDaGlsZChkb21Ob2RlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiB0aGlzLnJlbmRlcmluZ01hcFtpZF0pIHtcbiAgICAgICAgICAgIGlmIChub2RlLnBhcmVudE5vZGUpIHtcbiAgICAgICAgICAgICAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQobm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnJlbmRlcmluZ01hcFtpZF0gPSBkb21Ob2RlcztcbiAgICB9XG4gICAgcHJpdmF0ZSBfZ2V0UHJldmlvdXNDb21wb25lbnRJZChpZDogQ29tcG9uZW50SWQpOiBDb21wb25lbnRJZCB7XG4gICAgICAgIGNvbnN0IFt0YXJnZXQsIHBvc2l0aW9uXSA9IHRoaXMubG9jYXRpb25zW2lkXTtcbiAgICAgICAgY29uc3QgbG9jYXRpb25zID0gT2JqZWN0LnZhbHVlcyh0aGlzLmxvY2F0aW9ucyk7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudElkcyA9IE9iamVjdC5rZXlzKHRoaXMubG9jYXRpb25zKTtcbiAgICAgICAgY29uc3QgaW5kZXggPSBjb21wb25lbnRJZHMuaW5kZXhPZihpZCk7XG4gICAgICAgIGlmIChwb3NpdGlvbiA9PT0gJ2FmdGVyJykge1xuICAgICAgICAgICAgZm9yIChsZXQgdSA9IGluZGV4IC0gMTsgdSA+PSAwOyB1LS0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBbb3RoZXJUYXJnZXQsIG90aGVyUG9zaXRpb25dID0gbG9jYXRpb25zW3VdO1xuICAgICAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0ID09PSBvdGhlclRhcmdldCAmJlxuICAgICAgICAgICAgICAgICAgICAob3RoZXJQb3NpdGlvbiA9PT0gJ2FmdGVyJyB8fCBvdGhlclBvc2l0aW9uID09PSAncmVwbGFjZScpXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnRJZHNbdV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChsZXQgdSA9IGxvY2F0aW9ucy5sZW5ndGggLSAxOyB1ID4gaW5kZXg7IHUtLSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtvdGhlclRhcmdldCwgb3RoZXJQb3NpdGlvbl0gPSBsb2NhdGlvbnNbdV07XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldCA9PT0gb3RoZXJUYXJnZXQgJiYgb3RoZXJQb3NpdGlvbiA9PT0gJ3JlcGxhY2UnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb21wb25lbnRJZHNbdV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHBvc2l0aW9uID09PSAncmVwbGFjZScpIHtcbiAgICAgICAgICAgIGZvciAobGV0IHUgPSBpbmRleCAtIDE7IHUgPj0gMDsgdS0tKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgW290aGVyVGFyZ2V0LCBvdGhlclBvc2l0aW9uXSA9IGxvY2F0aW9uc1t1XTtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0ID09PSBvdGhlclRhcmdldCAmJiBvdGhlclBvc2l0aW9uID09PSAncmVwbGFjZScpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbXBvbmVudElkc1t1XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgcG9zaXRpb24gaW4gdGhlIFZOb2RlcyBhcyBhIHR1cGxlIGNvbnRhaW5pbmcgYSByZWZlcmVuY2VcbiAgICAgKiBub2RlIGFuZCBhIHJlbGF0aXZlIHBvc2l0aW9uIHdpdGggcmVzcGVjdCB0byB0aGlzIG5vZGUgKCdCRUZPUkUnIG9yXG4gICAgICogJ0FGVEVSJykuIFRoZSBwb3NpdGlvbiBpcyBhbHdheXMgZ2l2ZW4gb24gdGhlIGxlYWYuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyXG4gICAgICogQHBhcmFtIG9mZnNldFxuICAgICAqL1xuICAgIHByaXZhdGUgX2xvY2F0ZShkb21Ob2RlOiBOb2RlLCBkb21PZmZzZXQ6IG51bWJlcik6IFBvaW50IHtcbiAgICAgICAgbGV0IGZvcmNlQWZ0ZXIgPSBmYWxzZTtcbiAgICAgICAgbGV0IGZvcmNlUHJlcGVuZCA9IGZhbHNlO1xuICAgICAgICBsZXQgY29udGFpbmVyID0gZG9tTm9kZS5jaGlsZE5vZGVzW2RvbU9mZnNldF0gfHwgZG9tTm9kZTtcbiAgICAgICAgbGV0IG9mZnNldCA9IGNvbnRhaW5lciA9PT0gZG9tTm9kZSA/IGRvbU9mZnNldCA6IDA7XG4gICAgICAgIGlmIChjb250YWluZXIgPT09IGRvbU5vZGUgJiYgY29udGFpbmVyLmNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb250YWluZXIgPSBjb250YWluZXIuY2hpbGROb2Rlc1tjb250YWluZXIuY2hpbGROb2Rlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIG9mZnNldCA9IG5vZGVMZW5ndGgoY29udGFpbmVyKTtcbiAgICAgICAgICAgIGZvcmNlQWZ0ZXIgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHdoaWxlICghdGhpcy5nZXROb2Rlcyhjb250YWluZXIpLmxlbmd0aCkge1xuICAgICAgICAgICAgZm9yY2VBZnRlciA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yY2VQcmVwZW5kID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoY29udGFpbmVyLnByZXZpb3VzU2libGluZykge1xuICAgICAgICAgICAgICAgIGZvcmNlQWZ0ZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lci5wcmV2aW91c1NpYmxpbmc7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gbm9kZUxlbmd0aChjb250YWluZXIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmb3JjZVByZXBlbmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIG9mZnNldCA9IFtdLmluZGV4T2YuY2FsbChjb250YWluZXIucGFyZW50Tm9kZS5jaGlsZE5vZGVzLCBjb250YWluZXIpO1xuICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lci5wYXJlbnROb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gV2hlbiB0YXJnZXR0aW5nIHRoZSBlbmQgb2YgYSBub2RlLCB0aGUgRE9NIGdpdmVzIGFuIG9mZnNldCB0aGF0IGlzXG4gICAgICAgIC8vIGVxdWFsIHRvIHRoZSBsZW5ndGggb2YgdGhlIGNvbnRhaW5lci4gSW4gb3JkZXIgdG8gcmV0cmlldmUgdGhlIGxhc3RcbiAgICAgICAgLy8gZGVzY2VuZGVudCwgd2UgbmVlZCB0byBtYWtlIHN1cmUgd2UgdGFyZ2V0IGFuIGV4aXN0aW5nIG5vZGUsIGllLiBhblxuICAgICAgICAvLyBleGlzdGluZyBpbmRleC5cbiAgICAgICAgY29uc3QgaXNBZnRlckVuZCA9IG9mZnNldCA+PSBub2RlTGVuZ3RoKGNvbnRhaW5lcik7XG4gICAgICAgIGxldCBpbmRleCA9IGlzQWZ0ZXJFbmQgPyBub2RlTGVuZ3RoKGNvbnRhaW5lcikgLSAxIDogb2Zmc2V0O1xuICAgICAgICAvLyBNb3ZlIHRvIGRlZXBlc3QgY2hpbGQgb2YgY29udGFpbmVyLlxuICAgICAgICB3aGlsZSAoY29udGFpbmVyLmhhc0NoaWxkTm9kZXMoKSkge1xuICAgICAgICAgICAgY29uc3QgY2hpbGQgPSBjb250YWluZXIuY2hpbGROb2Rlc1tpbmRleF07XG4gICAgICAgICAgICBpZiAoIXRoaXMuZ2V0Tm9kZXMoY2hpbGQpLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGFpbmVyID0gY2hpbGQ7XG4gICAgICAgICAgICBpbmRleCA9IGlzQWZ0ZXJFbmQgPyBub2RlTGVuZ3RoKGNvbnRhaW5lcikgLSAxIDogMDtcbiAgICAgICAgICAgIC8vIEFkYXB0IHRoZSBvZmZzZXQgdG8gYmUgaXRzIGVxdWl2YWxlbnQgd2l0aGluIHRoZSBuZXcgY29udGFpbmVyLlxuICAgICAgICAgICAgb2Zmc2V0ID0gaXNBZnRlckVuZCA/IG5vZGVMZW5ndGgoY29udGFpbmVyKSA6IGluZGV4O1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgbm9kZXMgPSB0aGlzLmdldE5vZGVzKGNvbnRhaW5lcik7XG5cbiAgICAgICAgLy8gR2V0IHRoZSBWTm9kZXMgbWF0Y2hpbmcgdGhlIGNvbnRhaW5lci5cbiAgICAgICAgbGV0IHJlZmVyZW5jZTogVk5vZGU7XG4gICAgICAgIGlmIChjb250YWluZXIubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XG4gICAgICAgICAgICAvLyBUaGUgcmVmZXJlbmNlIGlzIHRoZSBpbmRleC10aCBtYXRjaCAoZWcuOiB0ZXh0IHNwbGl0IGludG8gY2hhcnMpLlxuICAgICAgICAgICAgcmVmZXJlbmNlID0gZm9yY2VBZnRlciA/IG5vZGVzW25vZGVzLmxlbmd0aCAtIDFdIDogbm9kZXNbaW5kZXhdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVmZXJlbmNlID0gbm9kZXNbMF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZvcmNlQWZ0ZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBbcmVmZXJlbmNlLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZm9yY2VQcmVwZW5kICYmIHJlZmVyZW5jZS5pcyhDb250YWluZXJOb2RlKSkge1xuICAgICAgICAgICAgcmV0dXJuIFtyZWZlcmVuY2UsIFJlbGF0aXZlUG9zaXRpb24uSU5TSURFXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZWZlcmVuY2UubG9jYXRlKGNvbnRhaW5lciwgb2Zmc2V0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBsb2NhdGlvbiBpbiB0aGUgRE9NIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGxvY2F0aW9uIGluIHRoZVxuICAgICAqIFZEb2N1bWVudCBvZiB0aGUgZ2l2ZW4gVk5vZGUuIFRoZSBsb2NhdGlvbiBpbiB0aGUgRE9NIGlzIGV4cHJlc3NlZCBhcyBhXG4gICAgICogdHVwbGUgY29udGFpbmluZyBhIHJlZmVyZW5jZSBOb2RlIGFuZCBhIHJlbGF0aXZlIHBvc2l0aW9uIHdpdGggcmVzcGVjdCB0b1xuICAgICAqIHRoZSByZWZlcmVuY2UgTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgcHJpdmF0ZSBfZ2V0RG9tTG9jYXRpb24obm9kZTogTWFya2VyTm9kZSk6IERvbVBvaW50IHtcbiAgICAgICAgbGV0IHJlZmVyZW5jZSA9IG5vZGUucHJldmlvdXNTaWJsaW5nKCk7XG4gICAgICAgIGxldCBwb3NpdGlvbiA9IFJlbGF0aXZlUG9zaXRpb24uQUZURVI7XG4gICAgICAgIGlmIChyZWZlcmVuY2UpIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZSA9IHJlZmVyZW5jZS5sYXN0TGVhZigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVmZXJlbmNlID0gbm9kZS5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRTtcbiAgICAgICAgICAgIGlmIChyZWZlcmVuY2UpIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2UgPSByZWZlcmVuY2UuZmlyc3RMZWFmKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFyZWZlcmVuY2UpIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZSA9IG5vZGUucGFyZW50O1xuICAgICAgICAgICAgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLklOU0lERTtcbiAgICAgICAgfVxuICAgICAgICAvLyBJZiB0aGUgZ2l2ZW4gcG9zaXRpb24gaXMgXCJiZWZvcmVcIiwgdGhlIHJlZmVyZW5jZSBET00gTm9kZSBpcyB0aGUgZmlyc3RcbiAgICAgICAgLy8gRE9NIG5vZGUgbWF0Y2hpbmcgdGhlIGdpdmVuIFZOb2RlLlxuICAgICAgICAvLyBJZiB0aGUgZ2l2ZW4gcG9zaXRpb24gaXMgXCJhZnRlclwiLCB0aGUgcmVmZXJlbmNlIERPTSBOb2RlIGlzIHRoZSBsYXN0IERPTVxuICAgICAgICAvLyBub2RlIG1hdGNoaW5nIHRoZSBnaXZlbiBWTm9kZS5cbiAgICAgICAgY29uc3QgbG9jYXRpb25zID0gdGhpcy5fZG9tTWFwLnRvRG9tUG9pbnQocmVmZXJlbmNlKTtcbiAgICAgICAgY29uc3QgbG9jYXRpb25JbmRleCA9IHBvc2l0aW9uID09PSBSZWxhdGl2ZVBvc2l0aW9uLkJFRk9SRSA/IDAgOiBsb2NhdGlvbnMubGVuZ3RoIC0gMTtcbiAgICAgICAgbGV0IFtkb21Ob2RlLCBvZmZzZXRdID0gbG9jYXRpb25zW2xvY2F0aW9uSW5kZXhdO1xuICAgICAgICBpZiAoZG9tTm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUgJiYgb2Zmc2V0ID09PSAtMSkge1xuICAgICAgICAgICAgLy8gVGhpcyAtMSBpcyBhIGhhY2sgdG8gYWNjb21vZGF0ZSB0aGUgVkRvY3VtZW50TWFwIHRvIHRoZSBuZXdcbiAgICAgICAgICAgIC8vIHJlbmRlcmluZyBwcm9jZXNzIHdpdGhvdXQgYWx0ZXJpbmcgaXQgZm9yIHRoZSBwYXJzZXIuXG4gICAgICAgICAgICBvZmZzZXQgPSB0aGlzLl9kb21NYXAuZnJvbURvbShkb21Ob2RlKS5pbmRleE9mKHJlZmVyZW5jZSk7XG4gICAgICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09IFJlbGF0aXZlUG9zaXRpb24uSU5TSURFICYmIG9mZnNldCA9PT0gLTEpIHtcbiAgICAgICAgICAgIG9mZnNldCA9IDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBDaGFyIG5vZGVzIGhhdmUgdGhlaXIgb2Zmc2V0IGluIHRoZSBjb3JyZXNwb25kaW5nIHRleHQgbm9kZXNcbiAgICAgICAgICAgIC8vIHJlZ2lzdGVyZWQgaW4gdGhlIG1hcCB2aWEgYHNldGAgYnV0IHZvaWQgbm9kZXMgZG9uJ3QuIFRoZWlyXG4gICAgICAgICAgICAvLyBsb2NhdGlvbiBuZWVkIHRvIGJlIGNvbXB1dGVkIHdpdGggcmVzcGVjdCB0byB0aGVpciBwYXJlbnRzLlxuICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9tTm9kZS5wYXJlbnROb2RlO1xuICAgICAgICAgICAgb2Zmc2V0ID0gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChjb250YWluZXIuY2hpbGROb2RlcywgZG9tTm9kZSk7XG4gICAgICAgICAgICBkb21Ob2RlID0gY29udGFpbmVyO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwb3NpdGlvbiA9PT0gUmVsYXRpdmVQb3NpdGlvbi5BRlRFUikge1xuICAgICAgICAgICAgLy8gSW5jcmVtZW50IHRoZSBvZmZzZXQgdG8gYmUgcG9zaXRpb25lZCBhZnRlciB0aGUgcmVmZXJlbmNlIG5vZGUuXG4gICAgICAgICAgICBvZmZzZXQgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW2RvbU5vZGUsIG9mZnNldF07XG4gICAgfVxuICAgIHByaXZhdGUgYXN5bmMgX3JlbmRlck5vZGUobm9kZTogVk5vZGUpOiBQcm9taXNlPE5vZGVbXT4ge1xuICAgICAgICBjb25zdCByZW5kZXJlciA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KFJlbmRlcmVyKTtcbiAgICAgICAgY29uc3QgZG9tUmVuZGVyZXJFbmdpbmUgPSByZW5kZXJlci5lbmdpbmVzWydkb20vaHRtbCddIGFzIFJlbmRlcmluZ0VuZ2luZTxOb2RlW10+O1xuXG4gICAgICAgIC8vIENsZWFyIHRoZSByZW5kZXJpbmcgY2FjaGUgYW5kIHVwZGF0ZSB0aGUgcmVuZGVyaW5nLlxuICAgICAgICBkb21SZW5kZXJlckVuZ2luZS5yZW5kZXJpbmdzLmNsZWFyKCk7XG4gICAgICAgIGNvbnN0IGRvbU5vZGVzID0gYXdhaXQgZG9tUmVuZGVyZXJFbmdpbmUucmVuZGVyKG5vZGUpO1xuXG4gICAgICAgIC8vIFB1dCB0aGUgcmVuZGVyZWQgbm9kZXMgaW50byB0aGUgbWFwLlxuICAgICAgICBsZXQgY2hpbGQgPSBub2RlLmxhc3RMZWFmKCk7XG4gICAgICAgIHdoaWxlIChjaGlsZCkge1xuICAgICAgICAgICAgY29uc3QgcmVuZGVyaW5ncyA9IGRvbVJlbmRlcmVyRW5naW5lLnJlbmRlcmluZ3MuZ2V0KGNoaWxkKTtcbiAgICAgICAgICAgIGlmIChyZW5kZXJpbmdzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVuZGVyaW5nID0gcmVuZGVyaW5nc1tyZW5kZXJpbmdzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkTm9kZXMgPSBhd2FpdCByZW5kZXJpbmdbMV07XG5cbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgZnJvbSBjYWNoZSB0byB1cGRhdGUgd2l0aCB0aGUgbmV3ZXN0IG5vZGVzLlxuICAgICAgICAgICAgICAgIHRoaXMuX2RvbU1hcC5jbGVhcihjaGlsZCk7XG5cbiAgICAgICAgICAgICAgICAvLyBBZGQgaW4gY2FjaGUuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBkb21Ob2RlIG9mIHJlbmRlcmVkTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZG9tTWFwLnNldChjaGlsZCwgZG9tTm9kZSwgLTEsICd1bnNoaWZ0Jyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2hpbGQgPSBjaGlsZC5wcmV2aW91cygpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGRvbU5vZGVzIHx8IFtdO1xuICAgIH1cbiAgICBwcml2YXRlIF9wcmVwYXJlTGF5b3V0Q29udGFpbmVyQW5kTG9jYXRpb24oY29tcG9uZW50RGVmaW5pdGlvbjogQ29tcG9uZW50RGVmaW5pdGlvbik6IHZvaWQge1xuICAgICAgICBjb25zdCB6b25lID0gdGhpcy5jb21wb25lbnRab25lc1tjb21wb25lbnREZWZpbml0aW9uLmlkXTtcbiAgICAgICAgaWYgKHpvbmUgPT09ICdyb290Jykge1xuICAgICAgICAgICAgLy8gYXV0b21hdGljYWxseSB3cmFwIHRoZSBjaGlsZCBpbnRvIGEgbGF5b3V0Q29udGFpbmVyIHRvIGtlZXAgbG9jYXRpb24gb2YgYWxsIG5vZGVzXG4gICAgICAgICAgICAvLyB3aGVuIHVwZGF0ZSB0aGUgdGVtcGxhdGUgYW5kIHJlZHJhd1xuICAgICAgICAgICAgdGhpcy5jb21wb25lbnREZWZpbml0aW9uc1tjb21wb25lbnREZWZpbml0aW9uLmlkXSA9IHtcbiAgICAgICAgICAgICAgICBpZDogY29tcG9uZW50RGVmaW5pdGlvbi5pZCxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoZWRpdG9yOiBKV0VkaXRvcik6IFByb21pc2U8TGF5b3V0Q29udGFpbmVyW10+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBhd2FpdCBjb21wb25lbnREZWZpbml0aW9uLnJlbmRlcihlZGl0b3IpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsYXlvdXRDb250YWluZXIgPSBuZXcgTGF5b3V0Q29udGFpbmVyKCk7XG4gICAgICAgICAgICAgICAgICAgIGxheW91dENvbnRhaW5lci5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gW2xheW91dENvbnRhaW5lcl07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodGhpcy5sb2NhdGlvbikge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5sb2NhdGlvbnNbY29tcG9uZW50RGVmaW5pdGlvbi5pZF0pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2NhdGlvbnNbY29tcG9uZW50RGVmaW5pdGlvbi5pZF0gPSB0aGlzLmxvY2F0aW9uO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmluZ01hcFtjb21wb25lbnREZWZpbml0aW9uLmlkXSA9IFtdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IExheW91dENvbnRhaW5lciB9IGZyb20gJy4vTGF5b3V0Q29udGFpbmVyTm9kZSc7XG5cbmV4cG9ydCB0eXBlIERvbVBvaW50ID0gW05vZGUsIG51bWJlcl07XG5cbmV4cG9ydCBjbGFzcyBEb21NYXAge1xuICAgIHByaXZhdGUgcmVhZG9ubHkgX2Zyb21Eb20gPSBuZXcgTWFwPE5vZGUsIFZOb2RlW10+KCk7XG4gICAgcHJpdmF0ZSByZWFkb25seSBfdG9Eb20gPSBuZXcgTWFwPFZOb2RlLCBEb21Qb2ludFtdPigpO1xuICAgIC8qKlxuICAgICAqIE1hcCB0aGUgZ2l2ZW4gVk5vZGUgdG8gaXRzIGNvcnJlc3BvbmRpbmcgRE9NIE5vZGUgYW5kIGl0cyBvZmZzZXQgaW4gaXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqIEBwYXJhbSBkb21Ob2RlXG4gICAgICogQHBhcmFtIG9mZnNldFxuICAgICAqIEBwYXJhbSBtZXRob2RcbiAgICAgKi9cbiAgICBzZXQobm9kZTogVk5vZGUsIGRvbU5vZGU6IE5vZGUsIG9mZnNldCA9IDAsIG1ldGhvZCA9ICdwdXNoJyk6IHZvaWQge1xuICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIExheW91dENvbnRhaW5lcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLl9mcm9tRG9tLmhhcyhkb21Ob2RlKSkge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2hlcyA9IHRoaXMuX2Zyb21Eb20uZ2V0KGRvbU5vZGUpO1xuICAgICAgICAgICAgaWYgKCFtYXRjaGVzLnNvbWUoKG1hdGNoOiBWTm9kZSkgPT4gbWF0Y2guaWQgPT09IG5vZGUuaWQpKSB7XG4gICAgICAgICAgICAgICAgbWF0Y2hlc1ttZXRob2RdKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fZnJvbURvbS5zZXQoZG9tTm9kZSwgW25vZGVdKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsb2NhdGlvbnMgPSB0aGlzLl90b0RvbS5nZXQobm9kZSkgfHwgW107XG4gICAgICAgIGxvY2F0aW9ucy5wdXNoKFtkb21Ob2RlLCBvZmZzZXRdKTtcbiAgICAgICAgdGhpcy5fdG9Eb20uc2V0KG5vZGUsIGxvY2F0aW9ucyk7XG5cbiAgICAgICAgLy8gU2V0IGNoaWxkcmVuLlxuICAgICAgICBmb3IgKGNvbnN0IHJlbmRlcmVkQ2hpbGQgb2YgZG9tTm9kZS5jaGlsZE5vZGVzKSB7XG4gICAgICAgICAgICBjb25zdCBtYXBwaW5nID0gdGhpcy50b0RvbVBvaW50KG5vZGUpO1xuICAgICAgICAgICAgaWYgKCFtYXBwaW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQobm9kZSwgcmVuZGVyZWRDaGlsZCwgLTEsICd1bnNoaWZ0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBWTm9kZShzKSBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlbiBET00gTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb21Ob2RlXG4gICAgICovXG4gICAgZnJvbURvbShkb21Ob2RlOiBOb2RlKTogVk5vZGVbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9mcm9tRG9tLmdldChkb21Ob2RlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBhcnJheSBvZiB0dXBsZSAobm9kZSwgbnVtYmVyKSBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlbiBWTm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgdG9Eb21Qb2ludChub2RlOiBWTm9kZSk6IERvbVBvaW50W10ge1xuICAgICAgICByZXR1cm4gdGhpcy5fdG9Eb20uZ2V0KG5vZGUpIHx8IFtdO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIERPTSBOb2RlIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuIFZOb2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICB0b0RvbShub2RlOiBWTm9kZSk6IE5vZGVbXSB7XG4gICAgICAgIGNvbnN0IGRvbU5vZGVzOiBOb2RlW10gPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBwb2ludCBvZiB0aGlzLl90b0RvbS5nZXQobm9kZSkgfHwgW10pIHtcbiAgICAgICAgICAgIGRvbU5vZGVzLnB1c2gocG9pbnRbMF0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkb21Ob2RlcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYXIgdGhlIG1hcCBvZiBhbGwgY29ycmVzcG9uZGFuY2VzLlxuICAgICAqXG4gICAgICogQHBhcmFtIFtub2RlXVxuICAgICAqL1xuICAgIGNsZWFyKG5vZGU/OiBWTm9kZSk6IHZvaWQge1xuICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBwb2ludCBvZiB0aGlzLl90b0RvbS5nZXQobm9kZSkgfHwgW10pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBub2RlcyA9IHRoaXMuX2Zyb21Eb20uZ2V0KHBvaW50WzBdKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IG5vZGVzLmluZGV4T2Yobm9kZSk7XG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBub2Rlcy5zcGxpY2UoaW5kZXgsIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobm9kZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2Zyb21Eb20uZGVsZXRlKHBvaW50WzBdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl90b0RvbS5kZWxldGUobm9kZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9mcm9tRG9tLmNsZWFyKCk7XG4gICAgICAgICAgICB0aGlzLl90b0RvbS5jbGVhcigpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL0Fic3RyYWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgTGF5b3V0Q29udGFpbmVyIH0gZnJvbSAnLi9MYXlvdXRDb250YWluZXJOb2RlJztcblxuZXhwb3J0IGNsYXNzIExheW91dENvbnRhaW5lckh0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gTGF5b3V0Q29udGFpbmVyO1xuXG4gICAgYXN5bmMgcmVuZGVyKG5vZGU6IExheW91dENvbnRhaW5lcik6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGlmIChub2RlLmhhc0NoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkQ2hpbGRyZW4gPSBhd2FpdCB0aGlzLnJlbmRlckNoaWxkcmVuKG5vZGUpO1xuICAgICAgICAgICAgcmV0dXJuIHJlbmRlcmVkQ2hpbGRyZW4uZmxhdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBDb250YWluZXJOb2RlIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvVk5vZGVzL0NvbnRhaW5lck5vZGUnO1xuXG5leHBvcnQgY2xhc3MgTGF5b3V0Q29udGFpbmVyIGV4dGVuZHMgQ29udGFpbmVyTm9kZSB7XG4gICAgcmVhZG9ubHkgZWRpdGFibGUgPSBmYWxzZTtcbiAgICByZWFkb25seSBicmVha2FibGUgPSBmYWxzZTtcbn1cbiIsImltcG9ydCB7IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4taHRtbC9zcmMvSHRtbERvbVJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IFpvbmVOb2RlIH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvWm9uZU5vZGUnO1xuXG5leHBvcnQgY2xhc3MgWm9uZUh0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gWm9uZU5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogWm9uZU5vZGUpOiBQcm9taXNlPE5vZGVbXT4ge1xuICAgICAgICBjb25zdCByZW5kZXJlZENoaWxkcmVuOiBOb2RlW10gPSBbXTtcbiAgICAgICAgaWYgKG5vZGUuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBub2RlLmNoaWxkVk5vZGVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFub2RlLmhpZGRlbi5nZXQoY2hpbGQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcmVkQ2hpbGRyZW4ucHVzaCguLi4oYXdhaXQgdGhpcy5lbmdpbmUucmVuZGVyKGNoaWxkKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVuZGVyZWRDaGlsZHJlbjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFpvbmVOb2RlIH0gZnJvbSAnLi4vLi4vLi4vcGx1Z2luLWxheW91dC9zcmMvWm9uZU5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgWm9uZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1QnICYmICEhaXRlbS5nZXRBdHRyaWJ1dGUoJ3Qtem9uZScpO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIHJldHVybiBbbmV3IFpvbmVOb2RlKFtpdGVtLmdldEF0dHJpYnV0ZSgndC16b25lJyldKV07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgSGVhZGluZ1htbERvbVBhcnNlciB9IGZyb20gJy4vSGVhZGluZ1htbERvbVBhcnNlcic7XG5pbXBvcnQgeyBIZWFkaW5nTm9kZSB9IGZyb20gJy4vSGVhZGluZ05vZGUnO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IEtleW1hcCB9IGZyb20gJy4uLy4uL3BsdWdpbi1rZXltYXAvc3JjL0tleW1hcCc7XG5pbXBvcnQgeyBDaGVja2luZ0NvbnRleHQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Db250ZXh0TWFuYWdlcic7XG5pbXBvcnQgeyBJbnNlcnRQYXJhZ3JhcGhCcmVha1BhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0NvcmUnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcblxuZXhwb3J0IGludGVyZmFjZSBIZWFkaW5nUGFyYW1zIGV4dGVuZHMgQ29tbWFuZFBhcmFtcyB7XG4gICAgbGV2ZWw6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIEhlYWRpbmc8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBhcHBseUhlYWRpbmdTdHlsZToge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5hcHBseUhlYWRpbmdTdHlsZSxcbiAgICAgICAgfSxcbiAgICAgICAgaW5zZXJ0UGFyYWdyYXBoQnJlYWs6IHtcbiAgICAgICAgICAgIHNlbGVjdG9yOiBbSGVhZGluZ05vZGVdLFxuICAgICAgICAgICAgY2hlY2s6IChjb250ZXh0OiBDaGVja2luZ0NvbnRleHQpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByYW5nZSA9IGNvbnRleHQucmFuZ2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJhbmdlLmlzQ29sbGFwc2VkKCkgJiYgIXJhbmdlLnN0YXJ0Lm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5pbnNlcnRQYXJhZ3JhcGhCcmVhayxcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIEtleW1hcD4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtIZWFkaW5nWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgc2hvcnRjdXRzOiBbMCwgMSwgMiwgMywgNCwgNSwgNl0ubWFwKGxldmVsID0+IHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrU0hJRlQrPERpZ2l0JyArIGxldmVsICsgJz4nLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2FwcGx5SGVhZGluZ1N0eWxlJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kQXJnczogeyBsZXZlbDogbGV2ZWwgfSxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQ2hhbmdlIHRoZSBmb3JtYXR0aW5nIG9mIHRoZSBub2RlcyBpbiBnaXZlbiByYW5nZSB0byBIZWFkaW5nLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFwcGx5SGVhZGluZ1N0eWxlKHBhcmFtczogSGVhZGluZ1BhcmFtcyk6IHZvaWQge1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgcGFyYW1zLmNvbnRleHQucmFuZ2UudGFyZ2V0ZWROb2RlcyhDb250YWluZXJOb2RlKSkge1xuICAgICAgICAgICAgY29uc3QgaGVhZGluZyA9IHRoaXMuX2NyZWF0ZUhlYWRpbmdDb250YWluZXIocGFyYW1zLmxldmVsKTtcbiAgICAgICAgICAgIGhlYWRpbmcubW9kaWZpZXJzID0gbm9kZS5tb2RpZmllcnMuY2xvbmUoKTtcbiAgICAgICAgICAgIG5vZGUucmVwbGFjZVdpdGgoaGVhZGluZyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbnNlcnRpbmcgYSBwYXJhZ3JhcGggYnJlYWsgYXQgdGhlIGVuZCBvZiBhIGhlYWRpbmcgZXhpdHMgdGhlIGhlYWRpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgaW5zZXJ0UGFyYWdyYXBoQnJlYWsocGFyYW1zOiBJbnNlcnRQYXJhZ3JhcGhCcmVha1BhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBoZWFkaW5nID0gcmFuZ2UudGFyZ2V0ZWROb2RlcyhIZWFkaW5nTm9kZSlbMF07XG4gICAgICAgIGNvbnN0IGR1cGxpY2F0ZSA9IGhlYWRpbmcuc3BsaXRBdChyYW5nZS5zdGFydCk7XG4gICAgICAgIGNvbnN0IG5ld0NvbnRhaW5lciA9IG5ldyB0aGlzLmVkaXRvci5jb25maWd1cmF0aW9uLmRlZmF1bHRzLkNvbnRhaW5lcigpO1xuICAgICAgICBkdXBsaWNhdGUucmVwbGFjZVdpdGgobmV3Q29udGFpbmVyKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIGhlYWRpbmcgbm9kZSBvciBhIGJhc2UgY29udGFpbmVyIGJhc2VkIG9uIHRoZSBnaXZlbiBsZXZlbC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBsZXZlbFxuICAgICAqL1xuICAgIF9jcmVhdGVIZWFkaW5nQ29udGFpbmVyKGxldmVsOiBudW1iZXIpOiBWTm9kZSB7XG4gICAgICAgIGlmIChsZXZlbCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB0aGlzLmVkaXRvci5jb25maWd1cmF0aW9uLmRlZmF1bHRzLkNvbnRhaW5lcigpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBIZWFkaW5nTm9kZSh7IGxldmVsOiBsZXZlbCB9KTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCBKV0VkaXRvciBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBIZWFkaW5nTm9kZSB9IGZyb20gJy4vSGVhZGluZ05vZGUnO1xuaW1wb3J0IHsgSGVhZGluZ1BhcmFtcyB9IGZyb20gJy4vSGVhZGluZyc7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICcuLi8uLi9wbHVnaW4tdG9vbGJhci9zcmMvVG9vbGJhcic7XG5cbmZ1bmN0aW9uIGhlYWRpbmdCdXR0b24obGV2ZWwpOiBCdXR0b24ge1xuICAgIHJldHVybiB7XG4gICAgICAgIHRpdGxlOiAnSGVhZGluZycgKyBsZXZlbCxcbiAgICAgICAgY2xhc3M6ICdoJyArIGxldmVsLFxuICAgICAgICBjb21tYW5kSWQ6ICdhcHBseUhlYWRpbmdTdHlsZScsXG4gICAgICAgIGNvbW1hbmRBcmdzOiB7IGxldmVsOiBsZXZlbCB9IGFzIEhlYWRpbmdQYXJhbXMsXG4gICAgICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgcmV0dXJuIGVkaXRvci5zZWxlY3Rpb24ucmFuZ2UudGFyZ2V0ZWROb2RlcygpLmV2ZXJ5KG5vZGUgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBub2RlLmNsb3Nlc3QoYW5jZXN0b3IgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW5jZXN0b3IuaXMoSGVhZGluZ05vZGUpICYmIGFuY2VzdG9yLmxldmVsID09PSBsZXZlbDtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgIH07XG59XG5cbmV4cG9ydCBjb25zdCBQYXJhZ3JhcGhCdXR0b24gPSB7XG4gICAgdGl0bGU6ICdQYXJhZ3JhcGgnLFxuICAgIGNvbW1hbmRJZDogJ2FwcGx5SGVhZGluZ1N0eWxlJyxcbiAgICBjb21tYW5kQXJnczogeyBsZXZlbDogMCB9IGFzIEhlYWRpbmdQYXJhbXMsXG4gICAgc2VsZWN0ZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBlZGl0b3Iuc2VsZWN0aW9uLnJhbmdlLnRhcmdldGVkTm9kZXMoKS5ldmVyeShub2RlID0+IHtcbiAgICAgICAgICAgIHJldHVybiBub2RlLmNsb3Nlc3QoYW5jZXN0b3IgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBhbmNlc3Rvci5pcyhlZGl0b3IuY29uZmlndXJhdGlvbi5kZWZhdWx0cy5Db250YWluZXIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG59O1xuZXhwb3J0IGNvbnN0IEhlYWRpbmcxQnV0dG9uID0gaGVhZGluZ0J1dHRvbigxKTtcbmV4cG9ydCBjb25zdCBIZWFkaW5nMkJ1dHRvbiA9IGhlYWRpbmdCdXR0b24oMik7XG5leHBvcnQgY29uc3QgSGVhZGluZzNCdXR0b24gPSBoZWFkaW5nQnV0dG9uKDMpO1xuZXhwb3J0IGNvbnN0IEhlYWRpbmc0QnV0dG9uID0gaGVhZGluZ0J1dHRvbig0KTtcbmV4cG9ydCBjb25zdCBIZWFkaW5nNUJ1dHRvbiA9IGhlYWRpbmdCdXR0b24oNSk7XG5leHBvcnQgY29uc3QgSGVhZGluZzZCdXR0b24gPSBoZWFkaW5nQnV0dG9uKDYpO1xuIiwiaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuXG5leHBvcnQgY2xhc3MgSGVhZGluZ05vZGUgZXh0ZW5kcyBWRWxlbWVudCB7XG4gICAgbGV2ZWw6IG51bWJlcjtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IHsgbGV2ZWw6IG51bWJlciB9KSB7XG4gICAgICAgIHN1cGVyKHsgaHRtbFRhZzogJ0gnICsgcGFyYW1zLmxldmVsIH0pO1xuICAgICAgICB0aGlzLmxldmVsID0gcGFyYW1zLmxldmVsO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gc3VwZXIubmFtZSArICc6ICcgKyB0aGlzLmxldmVsO1xuICAgIH1cbiAgICBjbG9uZShkZWVwQ2xvbmU/OiBib29sZWFuLCBwYXJhbXM/OiB7fSk6IHRoaXMge1xuICAgICAgICBjb25zdCBkZWZhdWx0czogQ29uc3RydWN0b3JQYXJhbWV0ZXJzPHR5cGVvZiBIZWFkaW5nTm9kZT5bMF0gPSB7XG4gICAgICAgICAgICBsZXZlbDogdGhpcy5sZXZlbCxcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmNsb25lKGRlZXBDbG9uZSwgeyAuLi5kZWZhdWx0cywgLi4ucGFyYW1zIH0pO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEhlYWRpbmdOb2RlIH0gZnJvbSAnLi9IZWFkaW5nTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuY29uc3QgSGVhZGluZ1RhZ3MgPSBbJ0gxJywgJ0gyJywgJ0gzJywgJ0g0JywgJ0g1JywgJ0g2J107XG5cbmV4cG9ydCBjbGFzcyBIZWFkaW5nWG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIEhlYWRpbmdUYWdzLmluY2x1ZGVzKG5vZGVOYW1lKGl0ZW0pKTtcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8SGVhZGluZ05vZGVbXT4ge1xuICAgICAgICBjb25zdCBoZWFkaW5nID0gbmV3IEhlYWRpbmdOb2RlKHsgbGV2ZWw6IHBhcnNlSW50KG5vZGVOYW1lKGl0ZW0pWzFdLCAxMCkgfSk7XG4gICAgICAgIGhlYWRpbmcubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSkpO1xuICAgICAgICBjb25zdCBub2RlcyA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIGhlYWRpbmcuYXBwZW5kKC4uLm5vZGVzKTtcbiAgICAgICAgcmV0dXJuIFtoZWFkaW5nXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IEZyYWdtZW50Tm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9GcmFnbWVudE5vZGUnO1xuaW1wb3J0IHsgVkVsZW1lbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4vSHRtbERvbVJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBEZWZhdWx0SHRtbERvbVJlbmRlcmVyIGV4dGVuZHMgQWJzdHJhY3RSZW5kZXJlcjxOb2RlW10+IHtcbiAgICBzdGF0aWMgaWQgPSAnZG9tL2h0bWwnO1xuICAgIGVuZ2luZTogSHRtbERvbVJlbmRlcmluZ0VuZ2luZTtcblxuICAgIGFzeW5jIHJlbmRlcihub2RlOiBWTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGxldCBkb21Ob2RlOiBOb2RlO1xuICAgICAgICBpZiAobm9kZS50YW5naWJsZSkge1xuICAgICAgICAgICAgaWYgKG5vZGUudGVzdChGcmFnbWVudE5vZGUpKSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZSA9IGRvY3VtZW50LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGV0IG5vZGVOYW1lOiBzdHJpbmc7XG4gICAgICAgICAgICAgICAgaWYgKG5vZGUuaXMoVkVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lID0gbm9kZS5odG1sVGFnO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5vZGVOYW1lID0gbm9kZS5jb25zdHJ1Y3Rvci5uYW1lLnRvVXBwZXJDYXNlKCkgKyAnLScgKyBub2RlLmlkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChub2RlTmFtZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmdpbmUucmVuZGVyQXR0cmlidXRlcyhBdHRyaWJ1dGVzLCBub2RlLCBlbGVtZW50KTtcbiAgICAgICAgICAgICAgICBkb21Ob2RlID0gZWxlbWVudDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcmVuZGVyZWRDaGlsZHJlbiA9IGF3YWl0IHRoaXMucmVuZGVyQ2hpbGRyZW4obm9kZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHJlbmRlcmVkQ2hpbGQgb2YgcmVuZGVyZWRDaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZG9tQ2hpbGQgb2YgcmVuZGVyZWRDaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLmFwcGVuZENoaWxkKGRvbUNoaWxkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gW2RvbU5vZGVdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgSHRtbFRleHRQYXJzaW5nRW5naW5lIH0gZnJvbSAnLi9IdG1sVGV4dFBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuXG5jb25zdCBhdXRvQ2xvc2VSZWdFeHAgPSAvKDwoYXJlYXxiYXNlfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8a2V5Z2VufGxpbmt8bWV0YXxwYXJhbXxzb3VyY2V8dHJhY2t8d2JyKVteL10qKT4vZ2k7XG5cbmV4cG9ydCBjbGFzcyBEZWZhdWx0SHRtbFRleHRQYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxzdHJpbmc+IHtcbiAgICBzdGF0aWMgaWQgPSAndGV4dC9odG1sJztcbiAgICBlbmdpbmU6IEh0bWxUZXh0UGFyc2luZ0VuZ2luZTtcblxuICAgIGFzeW5jIHBhcnNlKGl0ZW06IHN0cmluZyk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBkb21QYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7XG4gICAgICAgIGNvbnN0IHRlbXBsYXRlID0gaXRlbS5yZXBsYWNlKGF1dG9DbG9zZVJlZ0V4cCwgJyQxLz4nKTtcbiAgICAgICAgY29uc3QgeG1sRG9jID0gZG9tUGFyc2VyLnBhcnNlRnJvbVN0cmluZygnPHQ+JyArIHRlbXBsYXRlICsgJzwvdD4nLCAndGV4dC94bWwnKTtcbiAgICAgICAgY29uc3QgcGFyc2VyID0gdGhpcy5lbmdpbmUuZWRpdG9yLnBsdWdpbnMuZ2V0KFBhcnNlcik7XG4gICAgICAgIHJldHVybiBwYXJzZXIucGFyc2UoJ2RvbS94bWwnLCAuLi54bWxEb2MuZmlyc3RDaGlsZC5jaGlsZE5vZGVzKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IEh0bWxUZXh0UGFyc2luZ0VuZ2luZSB9IGZyb20gJy4vSHRtbFRleHRQYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IEh0bWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi9IdG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBIdG1sRG9tUmVuZGVyaW5nRW5naW5lIH0gZnJvbSAnLi9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IFhtbCB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbCc7XG5pbXBvcnQgeyBIdG1sSHRtbERvbVJlbmRlcmVyIH0gZnJvbSAnLi9IdG1sTm9kZURvbVJlbmRlcmVyJztcblxuZXhwb3J0IGNsYXNzIEh0bWw8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbUGFyc2VyLCBSZW5kZXJlciwgWG1sXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXIgJiBSZW5kZXJlcj4gPSB7XG4gICAgICAgIHBhcnNpbmdFbmdpbmVzOiBbSHRtbERvbVBhcnNpbmdFbmdpbmUsIEh0bWxUZXh0UGFyc2luZ0VuZ2luZV0sXG4gICAgICAgIHJlbmRlcmluZ0VuZ2luZXM6IFtIdG1sRG9tUmVuZGVyaW5nRW5naW5lXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbSHRtbEh0bWxEb21SZW5kZXJlcl0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IFBhcnNpbmdJZGVudGlmaWVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2luZ0VuZ2luZSc7XG5cbmV4cG9ydCB0eXBlIEh0bWxOb2RlID0gSFRNTEVsZW1lbnQgfCBDaGFyYWN0ZXJEYXRhO1xuXG5leHBvcnQgY2xhc3MgSHRtbERvbVBhcnNpbmdFbmdpbmU8VCBleHRlbmRzIEh0bWxOb2RlID0gSHRtbE5vZGU+IGV4dGVuZHMgWG1sRG9tUGFyc2luZ0VuZ2luZTxUPiB7XG4gICAgc3RhdGljIHJlYWRvbmx5IGlkOiBQYXJzaW5nSWRlbnRpZmllciA9ICdkb20vaHRtbCc7XG4gICAgc3RhdGljIGV4dGVuZHMgPSBbJ2RvbS94bWwnXTtcbn1cbiIsImltcG9ydCB7IFJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IERlZmF1bHRIdG1sRG9tUmVuZGVyZXIgfSBmcm9tICcuL0RlZmF1bHRIdG1sRG9tUmVuZGVyZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIEh0bWxEb21SZW5kZXJpbmdFbmdpbmUgZXh0ZW5kcyBSZW5kZXJpbmdFbmdpbmU8Tm9kZVtdPiB7XG4gICAgc3RhdGljIHJlYWRvbmx5IGlkID0gJ2RvbS9odG1sJztcbiAgICBzdGF0aWMgcmVhZG9ubHkgZGVmYXVsdFJlbmRlcmVyID0gRGVmYXVsdEh0bWxEb21SZW5kZXJlcjtcbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIGF0dHJpYnV0ZXMgKG9mIHRoZSBnaXZlbiBDbGFzcyBleHRlbmRpbmcgQXR0cmlidXRlcykgb2YgdGhlXG4gICAgICogZ2l2ZW4gVk5vZGUgb250byB0aGUgZ2l2ZW4gRE9NIEVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gQ2xhc3NcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqIEBwYXJhbSBlbGVtZW50XG4gICAgICovXG4gICAgcmVuZGVyQXR0cmlidXRlczxUIGV4dGVuZHMgdHlwZW9mIEF0dHJpYnV0ZXM+KFxuICAgICAgICBDbGFzczogVCxcbiAgICAgICAgbm9kZTogVk5vZGUsXG4gICAgICAgIGVsZW1lbnQ6IEhUTUxFbGVtZW50LFxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gbm9kZS5tb2RpZmllcnMuZmluZChDbGFzcyk7XG4gICAgICAgIGlmIChhdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgYXR0cmlidXRlcy5rZXlzKCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGF0dHJpYnV0ZXMuZ2V0KG5hbWUpO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKG5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGVzLnN0eWxlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBhdHRyaWJ1dGVzLnN0eWxlLmtleXMoKSkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnNldFByb3BlcnR5KG5hbWUsIGF0dHJpYnV0ZXMuc3R5bGUuZ2V0KG5hbWUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5jbGFzc0xpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgYXR0cmlidXRlcy5jbGFzc0xpc3QuaXRlbXMoKSkge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogSWYgYSBub2RlIGlzIGVtcHR5IGJ1dCBjb3VsZCBhY2NvbW9kYXRlIGNoaWxkcmVuLCBmaWxsIGl0IHRvIG1ha2UgaXRcbiAgICAgKiB2aXNpYmxlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBhc3luYyByZW5kZXJFbXB0eShub2RlOiBWTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIHJldHVybiBub2RlLmlzKEF0b21pY05vZGUpID8gW10gOiBbZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKV07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcblxuZXhwb3J0IGludGVyZmFjZSBIdG1sTm9kZVBhcmFtcyB7XG4gICAgZG9tTm9kZTogTm9kZTtcbn1cblxuZXhwb3J0IGNsYXNzIEh0bWxOb2RlIGV4dGVuZHMgQXRvbWljTm9kZSB7XG4gICAgZG9tTm9kZTogTm9kZTtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IEh0bWxOb2RlUGFyYW1zKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuZG9tTm9kZSA9IHBhcmFtcy5kb21Ob2RlO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL0Fic3RyYWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4vSHRtbERvbVJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBIdG1sTm9kZSB9IGZyb20gJy4vSHRtbE5vZGUnO1xuXG5leHBvcnQgY2xhc3MgSHRtbEh0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gSHRtbE5vZGU7XG5cbiAgICBjb25zdHJ1Y3RvcihlbmdpbmUsIHN1cGVyUmVuZGVyZXIpIHtcbiAgICAgICAgc3VwZXIoZW5naW5lLCBzdXBlclJlbmRlcmVyKTtcbiAgICB9XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogSHRtbE5vZGUpOiBQcm9taXNlPE5vZGVbXT4ge1xuICAgICAgICByZXR1cm4gW25vZGUuZG9tTm9kZV07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgRGVmYXVsdEh0bWxUZXh0UGFyc2VyIH0gZnJvbSAnLi9EZWZhdWx0SHRtbFRleHRQYXJzZXInO1xuXG5leHBvcnQgY2xhc3MgSHRtbFRleHRQYXJzaW5nRW5naW5lIGV4dGVuZHMgUGFyc2luZ0VuZ2luZTxzdHJpbmc+IHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgaWQgPSAndGV4dC9odG1sJztcbiAgICBzdGF0aWMgcmVhZG9ubHkgZGVmYXVsdFBhcnNlciA9IERlZmF1bHRIdG1sVGV4dFBhcnNlcjtcbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IEltYWdlWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9JbWFnZVhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBJbWFnZUh0bWxEb21SZW5kZXJlciB9IGZyb20gJy4vSW1hZ2VIdG1sRG9tUmVuZGVyZXInO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5cbmV4cG9ydCBjbGFzcyBJbWFnZTxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbSW1hZ2VYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtJbWFnZUh0bWxEb21SZW5kZXJlcl0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL0Fic3RyYWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgSW1hZ2VOb2RlIH0gZnJvbSAnLi9JbWFnZU5vZGUnO1xuaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcbmltcG9ydCB7IFlvdXR1YmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teW91dHViZS9zcmMvWW91dHViZSc7XG5cbmV4cG9ydCBjbGFzcyBJbWFnZUh0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gKG5vZGUpOiBib29sZWFuID0+XG4gICAgICAgICEhW0ltYWdlTm9kZSwgWW91dHViZV0uZmluZChOb2RlQ2xhc3MgPT4gbm9kZSBpbnN0YW5jZW9mIE5vZGVDbGFzcyk7XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogSW1hZ2VOb2RlKTogUHJvbWlzZTxOb2RlW10+IHtcbiAgICAgICAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcbiAgICAgICAgY29uc3QgaXNTZWxlY3RlZCA9IHRoaXMuZW5naW5lLmVkaXRvci5zZWxlY3Rpb24ucmFuZ2Uuc2VsZWN0ZWROb2RlcyhcbiAgICAgICAgICAgIHNlbGVjdGVkTm9kZSA9PiBzZWxlY3RlZE5vZGUgPT09IG5vZGUsXG4gICAgICAgICk7XG4gICAgICAgIGlmIChpc1NlbGVjdGVkLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgaW1hZ2UuY2xhc3NMaXN0LmFkZCgnandfc2VsZWN0ZWRfaW1hZ2UnKTtcbiAgICAgICAgfVxuICAgICAgICBpbWFnZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGUgPT4ge1xuICAgICAgICAgICAgdGhpcy5lbmdpbmUuZWRpdG9yLm5leHRFdmVudE11dGV4KCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IuZXhlY0N1c3RvbUNvbW1hbmQoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3Iuc2VsZWN0aW9uLnNlbGVjdChub2RlLCBub2RlKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5lbmdpbmUucmVuZGVyQXR0cmlidXRlcyhBdHRyaWJ1dGVzLCBub2RlLCBpbWFnZSk7XG4gICAgICAgIHJldHVybiBbaW1hZ2VdO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IElubGluZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmVOb2RlJztcblxuZXhwb3J0IGNsYXNzIEltYWdlTm9kZSBleHRlbmRzIElubGluZU5vZGUge1xuICAgIHN0YXRpYyByZWFkb25seSBhdG9taWMgPSB0cnVlO1xufVxuIiwiaW1wb3J0IHsgSW1hZ2VOb2RlIH0gZnJvbSAnLi9JbWFnZU5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBJbWFnZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ0lNRyc7XG4gICAgfTtcblxuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPEltYWdlTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGltYWdlID0gbmV3IEltYWdlTm9kZSgpO1xuICAgICAgICBpbWFnZS5tb2RpZmllcnMuYXBwZW5kKHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKSk7XG4gICAgICAgIHJldHVybiBbaW1hZ2VdO1xuICAgIH1cbn1cbiIsImltcG9ydCBKV0VkaXRvciwgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBWTm9kZSwgUmVsYXRpdmVQb3NpdGlvbiwgUG9pbnQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQ2hhciB9IGZyb20gJy4uLy4uL3BsdWdpbi1jaGFyL3NyYy9DaGFyJztcbmltcG9ydCB7IENoYXJOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWNoYXIvc3JjL0NoYXJOb2RlJztcbmltcG9ydCB7IExpbmVCcmVhayB9IGZyb20gJy4uLy4uL3BsdWdpbi1saW5lYnJlYWsvc3JjL0xpbmVCcmVhayc7XG5pbXBvcnQgeyBMaW5lQnJlYWtOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxpbmVicmVhay9zcmMvTGluZUJyZWFrTm9kZSc7XG5pbXBvcnQgeyB3aXRoUmFuZ2UsIFZSYW5nZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZSYW5nZSc7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcbmltcG9ydCB7IEF0b21pY05vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQXRvbWljTm9kZSc7XG5cbmV4cG9ydCB0eXBlIEluZGVudFBhcmFtcyA9IENvbW1hbmRQYXJhbXM7XG5leHBvcnQgdHlwZSBPdXRkZW50UGFyYW1zID0gQ29tbWFuZFBhcmFtcztcblxuZXhwb3J0IGNsYXNzIEluZGVudDxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtDaGFyLCBMaW5lQnJlYWtdO1xuICAgIGVkaXRvcjogSldFZGl0b3I7XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIGluZGVudDoge1xuICAgICAgICAgICAgdGl0bGU6ICdJbmRlbnQgY2hhcnMnLFxuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5pbmRlbnQsXG4gICAgICAgIH0sXG4gICAgICAgIG91dGRlbnQ6IHtcbiAgICAgICAgICAgIHRpdGxlOiAnT3V0ZGVudCBjaGFycycsXG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLm91dGRlbnQsXG4gICAgICAgIH0sXG4gICAgfTtcbiAgICBsb2FkYWJsZXM6IExvYWRhYmxlczxLZXltYXA+ID0ge1xuICAgICAgICBzaG9ydGN1dHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnVEFCJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdpbmRlbnQnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnU0hJRlQrVEFCJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdvdXRkZW50JyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgfTtcbiAgICB0YWIgPSAnICAgICc7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogSW5kZW50IHRleHQgb3IgbGluZXMuXG4gICAgICpcbiAgICAgKiAtIElmIHRoZXJlIGlzIG1vcmUgdGhhbiBvbmUgbGluZSBzZWxlY3RlZCBpbiByYW5nZSwgaW5kZW50IGVhY2ggbGluZXMuXG4gICAgICogLSBPdGhlcndpc2UsIGluc2VydCA0IHNwYWNlcy5cbiAgICAgKi9cbiAgICBhc3luYyBpbmRlbnQocGFyYW1zOiBJbmRlbnRQYXJhbXMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3Qgc2VnbWVudEJyZWFrcyA9IHJhbmdlLnRyYXZlcnNlZE5vZGVzKHRoaXMuX2lzU2VnbWVudEJyZWFrKTtcbiAgICAgICAgLy8gT25seSBpbmRlbnQgd2hlbiB0aGVyZSBpcyBhdCBsZWF0IHR3byBsaW5lcyBzZWxlY3RlZCwgdGhhdCBpcyB3aGVuXG4gICAgICAgIC8vIGF0IGxlYXN0IG9uZSBzZWdtZW50IGJyZWFrIGNvdWxkIGJlIGlkZW50aWZpZWQgaW4gdGhlIHNlbGVjdGlvbi5cbiAgICAgICAgaWYgKHJhbmdlLmlzQ29sbGFwc2VkKCkgfHwgIXNlZ21lbnRCcmVha3MubGVuZ3RoKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmVkaXRvci5leGVjQ29tbWFuZDxDaGFyPignaW5zZXJ0VGV4dCcsIHtcbiAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRhYixcbiAgICAgICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgICAgIHJhbmdlOiByYW5nZSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBUaGUgZmlyc3QgbGluZSBvZiB0aGUgc2VsZWN0aW9uIGlzIG5laXRoZXIgZnVsbHkgc2VsZWN0ZWQgbm9yXG4gICAgICAgICAgICAvLyB0cmF2ZXJzZWQgc28gaXRzIHNlZ21lbnQgYnJlYWsgd2FzIG5vdCBpbiBgcmFuZ2UudHJhdmVyc2VkTm9kZXNgLlxuICAgICAgICAgICAgY29uc3QgbmV4dFNlZ21lbnRCcmVhayA9IHJhbmdlLnN0YXJ0LnByZXZpb3VzKHRoaXMuX2lzU2VnbWVudEJyZWFrKTtcbiAgICAgICAgICAgIGlmIChuZXh0U2VnbWVudEJyZWFrKSB7XG4gICAgICAgICAgICAgICAgc2VnbWVudEJyZWFrcy51bnNoaWZ0KG5leHRTZWdtZW50QnJlYWspO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChjb25zdCBzZWdtZW50QnJlYWsgb2Ygc2VnbWVudEJyZWFrcykge1xuICAgICAgICAgICAgICAgIC8vIEluc2VydCA0IHNwYWNlcyBhdCB0aGUgc3RhcnQgb2YgbmV4dCBzZWdtZW50LlxuICAgICAgICAgICAgICAgIGNvbnN0IFtub2RlLCBwb3NpdGlvbl0gPSB0aGlzLl9uZXh0U2VnbWVudFN0YXJ0KHNlZ21lbnRCcmVhayk7XG4gICAgICAgICAgICAgICAgYXdhaXQgd2l0aFJhbmdlKFZSYW5nZS5hdChub2RlLCBwb3NpdGlvbiksIGFzeW5jIHJhbmdlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5lZGl0b3IuZXhlY0NvbW1hbmQ8Q2hhcj4oJ2luc2VydFRleHQnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0aGlzLnRhYixcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZTogcmFuZ2UsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE91dGRlbnQgbGluZXMuXG4gICAgICpcbiAgICAgKiBJZiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIGxpbmUgc2VsZWN0ZWQsIGZvciBlYWNoIG9mIHRoZSBsaW5lcywgcmVtb3ZlIHVwXG4gICAgICogdG8gNCBzcGFjZXMgaW4gdGhlIGJlZ2dpbmluZyBvZiB0aGUgbGluZS5cbiAgICAgKi9cbiAgICBvdXRkZW50KHBhcmFtczogT3V0ZGVudFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBzZWdtZW50QnJlYWtzID0gcmFuZ2UudHJhdmVyc2VkTm9kZXModGhpcy5faXNTZWdtZW50QnJlYWspO1xuICAgICAgICAvLyBUaGUgZmlyc3QgbGluZSBvZiB0aGUgc2VsZWN0aW9uIGlzIG5laXRoZXIgZnVsbHkgc2VsZWN0ZWQgbm9yXG4gICAgICAgIC8vIHRyYXZlcnNlZCBzbyBpdHMgc2VnbWVudCBicmVhayB3YXMgbm90IGluIGByYW5nZS50cmF2ZXJzZWROb2Rlc2AuXG4gICAgICAgIGNvbnN0IHByZXZpb3VzU2VnbWVudEJyZWFrID0gcmFuZ2Uuc3RhcnQucHJldmlvdXModGhpcy5faXNTZWdtZW50QnJlYWspO1xuICAgICAgICBpZiAocHJldmlvdXNTZWdtZW50QnJlYWspIHtcbiAgICAgICAgICAgIHNlZ21lbnRCcmVha3MudW5zaGlmdChwcmV2aW91c1NlZ21lbnRCcmVhayk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gT25seSBvdXRkZW50IHdoZW4gdGhlcmUgaXMgYXQgbGVhdCB0d28gbGluZXMgc2VsZWN0ZWQsIHRoYXQgaXMgd2hlblxuICAgICAgICAvLyBhdCBsZWFzdCBvbmUgc2VnbWVudCBicmVhayBjb3VsZCBiZSBpZGVudGlmaWVkIGluIHRoZSBzZWxlY3Rpb24uXG4gICAgICAgIGlmIChzZWdtZW50QnJlYWtzLmxlbmd0aCkge1xuICAgICAgICAgICAgc2VnbWVudEJyZWFrcy5mb3JFYWNoKHNlZ21lbnRCcmVhayA9PiB7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRhYi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzcGFjZSA9IHRoaXMuX25leHRJbmRlbnRhdGlvblNwYWNlKHNlZ21lbnRCcmVhayk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzcGFjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2UucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIFZOb2RlIGNhbiBiZSBjb25zaWRlcmVkIHRvIGJlIGEgc2VnbWVudCBicmVhay5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBfaXNTZWdtZW50QnJlYWsobm9kZTogVk5vZGUpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIG5vZGUuaXMoQ29udGFpbmVyTm9kZSkgfHwgbm9kZS5pcyhMaW5lQnJlYWtOb2RlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBuZXh0IHNlZ21lbnQgc3RhcnQgcG9pbnQgYWZ0ZXIgdGhlIGdpdmVuIHNlZ21lbnQgYnJlYWsuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2VnbWVudEJyZWFrXG4gICAgICovXG4gICAgX25leHRTZWdtZW50U3RhcnQoc2VnbWVudEJyZWFrOiBWTm9kZSk6IFBvaW50IHtcbiAgICAgICAgbGV0IHJlZmVyZW5jZSA9IHNlZ21lbnRCcmVhaztcbiAgICAgICAgbGV0IHBvc2l0aW9uID0gUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkU7XG4gICAgICAgIGlmIChzZWdtZW50QnJlYWsuaXMoQXRvbWljTm9kZSkpIHtcbiAgICAgICAgICAgIHJlZmVyZW5jZSA9IHNlZ21lbnRCcmVhay5uZXh0U2libGluZygpO1xuICAgICAgICB9IGVsc2UgaWYgKHNlZ21lbnRCcmVhay5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICByZWZlcmVuY2UgPSBzZWdtZW50QnJlYWsuZmlyc3RDaGlsZCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcG9zaXRpb24gPSBSZWxhdGl2ZVBvc2l0aW9uLklOU0lERTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW3JlZmVyZW5jZSwgcG9zaXRpb25dO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gVk5vZGUgaXMgYSBDaGFyTm9kZSBjb250YWluaW5nIGEgc3BhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIF9pc1NwYWNlKG5vZGU6IFZOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBub2RlLmlzKENoYXJOb2RlKSAmJiAvXlxccyQvZy50ZXN0KG5vZGUuY2hhcik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBWTm9kZSBjYW4gYmUgY29uc2lkZXJlZCB0byBiZSBhIHNlZ21lbnQgYnJlYWsuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2VnbWVudEJyZWFrXG4gICAgICovXG4gICAgX25leHRJbmRlbnRhdGlvblNwYWNlKHNlZ21lbnRCcmVhazogVk5vZGUpOiBWTm9kZSB7XG4gICAgICAgIGxldCBzcGFjZTogVk5vZGU7XG4gICAgICAgIGlmIChzZWdtZW50QnJlYWsuaXMoQXRvbWljTm9kZSkpIHtcbiAgICAgICAgICAgIHNwYWNlID0gc2VnbWVudEJyZWFrLm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzcGFjZSA9IHNlZ21lbnRCcmVhay5maXJzdENoaWxkKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNwYWNlICYmIHNwYWNlLnRlc3QodGhpcy5faXNTcGFjZSkgJiYgc3BhY2U7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXRvb2xiYXIvc3JjL1Rvb2xiYXInO1xuXG5leHBvcnQgY29uc3QgSW5kZW50QnV0dG9uOiBCdXR0b24gPSB7XG4gICAgdGl0bGU6ICdJbmRlbnQnLFxuICAgIGNsYXNzOiAnZmEtaW5kZW50JyxcbiAgICBjb21tYW5kSWQ6ICdpbmRlbnQnLFxufTtcbmV4cG9ydCBjb25zdCBPdXRkZW50QnV0dG9uOiBCdXR0b24gPSB7XG4gICAgdGl0bGU6ICdPdXRkZW50JyxcbiAgICBjbGFzczogJ2ZhLW91dGRlbnQnLFxuICAgIGNvbW1hbmRJZDogJ291dGRlbnQnLFxufTtcbiIsImltcG9ydCB7IE1vZGlmaWVyIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXInO1xuaW1wb3J0IHsgTW9kaWZpZXJzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXJzJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIEZvcm1hdCBleHRlbmRzIE1vZGlmaWVyIHtcbiAgICBodG1sVGFnOiBzdHJpbmc7IC8vIFRPRE86IHJlbW92ZSB0aGlzIHJlZmVyZW5jZSB0byBET00uXG4gICAgbW9kaWZpZXJzID0gbmV3IE1vZGlmaWVycygpO1xuICAgIGNvbnN0cnVjdG9yKGh0bWxUYWc/OiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5odG1sVGFnID0gaHRtbFRhZztcbiAgICB9XG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaHRtbFRhZy50b0xvd2VyQ2FzZSgpO1xuICAgIH1cbiAgICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBub25FbXB0eUF0dHJpYnV0ZXMgPSB0aGlzLm1vZGlmaWVycy5maWx0ZXIoXG4gICAgICAgICAgICBtb2RpZmllciA9PiAhKG1vZGlmaWVyIGluc3RhbmNlb2YgQXR0cmlidXRlcykgfHwgISFtb2RpZmllci5sZW5ndGgsXG4gICAgICAgICk7XG4gICAgICAgIGlmIChub25FbXB0eUF0dHJpYnV0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBtb2RpZmllcnNSZXByID0gW107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG1vZGlmaWVyIG9mIG5vbkVtcHR5QXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgIG1vZGlmaWVyc1JlcHIucHVzaChtb2RpZmllci50b1N0cmluZygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBgJHt0aGlzLm5hbWV9WyR7bW9kaWZpZXJzUmVwci5qb2luKCcsICcpfV1gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmFtZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICByZW5kZXIoKTogRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IGRvbU5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KHRoaXMuaHRtbFRhZyk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSB0aGlzLm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpO1xuICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBuYW1lIG9mIGF0dHJpYnV0ZXMua2V5cygpKSB7XG4gICAgICAgICAgICAgICAgZG9tTm9kZS5zZXRBdHRyaWJ1dGUobmFtZSwgYXR0cmlidXRlcy5nZXQobmFtZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMuc3R5bGUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuYW1lIG9mIGF0dHJpYnV0ZXMuc3R5bGUua2V5cygpLnNvcnQoKSkge1xuICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLnN0eWxlLnNldFByb3BlcnR5KG5hbWUsIGF0dHJpYnV0ZXMuc3R5bGUuZ2V0KG5hbWUpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5jbGFzc0xpc3QubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgYXR0cmlidXRlcy5jbGFzc0xpc3QuaXRlbXMoKSkge1xuICAgICAgICAgICAgICAgICAgICBkb21Ob2RlLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGRvbU5vZGU7XG4gICAgfVxuICAgIGNsb25lKCk6IHRoaXMge1xuICAgICAgICBjb25zdCBjbG9uZSA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKCk7XG4gICAgICAgIGNsb25lLmh0bWxUYWcgPSB0aGlzLmh0bWxUYWc7XG4gICAgICAgIGNsb25lLm1vZGlmaWVycyA9IHRoaXMubW9kaWZpZXJzLmNsb25lKCk7XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9XG4gICAgaXNTYW1lQXMob3RoZXJGb3JtYXQ6IEZvcm1hdCk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBhTW9kaWZpZXJzID0gdGhpcy5tb2RpZmllcnM7XG4gICAgICAgIGNvbnN0IGJNb2RpZmllcnMgPSBvdGhlckZvcm1hdD8ubW9kaWZpZXJzO1xuICAgICAgICByZXR1cm4gb3RoZXJGb3JtYXQgaW5zdGFuY2VvZiB0aGlzLmNvbnN0cnVjdG9yICYmIGFNb2RpZmllcnMuYXJlU2FtZUFzKGJNb2RpZmllcnMpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL0Fic3RyYWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgSW5saW5lTm9kZSB9IGZyb20gJy4vSW5saW5lTm9kZSc7XG5pbXBvcnQgeyBQcmVkaWNhdGUsIFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4vRm9ybWF0JztcbmltcG9ydCB7IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4taHRtbC9zcmMvSHRtbERvbVJlbmRlcmluZ0VuZ2luZSc7XG5cbmV4cG9ydCBjbGFzcyBGb3JtYXREb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBwcmVkaWNhdGU6IFByZWRpY2F0ZTxib29sZWFuIHwgVk5vZGU+ID0gSW5saW5lTm9kZTtcbiAgICBhc3luYyByZW5kZXIobm9kZTogSW5saW5lTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGlubGluZSA9IGF3YWl0IHRoaXMuc3VwZXIucmVuZGVyKG5vZGUpO1xuICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJGb3JtYXRzKG5vZGUubW9kaWZpZXJzLmZpbHRlcihGb3JtYXQpLCBpbmxpbmUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgYW4gaW5saW5lIG5vZGUncyBmb3JtYXRzIGFuZCByZXR1cm4gdGhlbSBpbiBhIGZyYWdtZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlbmRlcmluZ1xuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlckZvcm1hdHMoZm9ybWF0czogRm9ybWF0W10sIHJlbmRlcmluZzogTm9kZVtdKTogUHJvbWlzZTxOb2RlW10+IHtcbiAgICAgICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgICAgIGxldCBwYXJlbnQ6IE5vZGUgPSBmcmFnbWVudDtcbiAgICAgICAgZm9yIChjb25zdCB2YWx1ZSBvZiBPYmplY3QudmFsdWVzKGZvcm1hdHMpKSB7XG4gICAgICAgICAgICBjb25zdCBmb3JtYXROb2RlID0gdmFsdWUucmVuZGVyKCk7XG4gICAgICAgICAgICBwYXJlbnQuYXBwZW5kQ2hpbGQoZm9ybWF0Tm9kZSk7XG4gICAgICAgICAgICAvLyBVcGRhdGUgdGhlIHBhcmVudCBzbyB0aGUgdGV4dCBpcyBpbnNpZGUgdGhlIGZvcm1hdCBub2RlLlxuICAgICAgICAgICAgcGFyZW50ID0gZm9ybWF0Tm9kZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IGRvbUNoaWxkIG9mIHJlbmRlcmluZykge1xuICAgICAgICAgICAgcGFyZW50LmFwcGVuZENoaWxkKGRvbUNoaWxkKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShmcmFnbWVudC5jaGlsZE5vZGVzKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IElubGluZU5vZGUgfSBmcm9tICcuL0lubGluZU5vZGUnO1xuaW1wb3J0IHsgRm9ybWF0IH0gZnJvbSAnLi9Gb3JtYXQnO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgRm9ybWF0UGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgc3BhbiBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVzXG4gICAgICovXG4gICAgYXBwbHlGb3JtYXQoZm9ybWF0OiBGb3JtYXQsIG5vZGVzOiBWTm9kZVtdKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlcykge1xuICAgICAgICAgICAgaWYgKG5vZGUuaXMoSW5saW5lTm9kZSkpIHtcbiAgICAgICAgICAgICAgICBmb3JtYXQuY2xvbmUoKS5hcHBseVRvKG5vZGUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmxpbmVOb2RlcyA9IG5vZGUuZGVzY2VuZGFudHMoSW5saW5lTm9kZSk7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpbmxpbmUgb2YgaW5saW5lTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0LmNsb25lKCkuYXBwbHlUbyhpbmxpbmUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4vRm9ybWF0JztcbmltcG9ydCB7IE1vZGlmaWVyIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXInO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgSW5saW5lTm9kZSB9IGZyb20gJy4vSW5saW5lTm9kZSc7XG5pbXBvcnQgeyBDb25zdHJ1Y3RvciB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBNb2RpZmllcnMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RpZmllcnMnO1xuaW1wb3J0IHsgQ3NzU3R5bGUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9Dc3NTdHlsZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRm9ybWF0UGFyYW1zIGV4dGVuZHMgQ29tbWFuZFBhcmFtcyB7XG4gICAgRm9ybWF0Q2xhc3M6IENvbnN0cnVjdG9yPEZvcm1hdD47XG59XG5pbnRlcmZhY2UgSW5saW5lQ2FjaGUge1xuICAgIG1vZGlmaWVyczogTW9kaWZpZXJzIHwgbnVsbDtcbiAgICBzdHlsZTogQ3NzU3R5bGUgfCBudWxsO1xufVxuXG5leHBvcnQgY2xhc3MgSW5saW5lPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgdG9nZ2xlRm9ybWF0OiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnRvZ2dsZUZvcm1hdCxcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIGNvbW1hbmRIb29rcyA9IHtcbiAgICAgICAgc2V0U2VsZWN0aW9uOiB0aGlzLnJlc2V0Q2FjaGUsXG4gICAgfTtcbiAgICAvKipcbiAgICAgKiBXaGVuIGFwcGx5aW5nIGEgbW9kaWZpZXIgb24gYSBjb2xsYXBzZWQgcmFuZ2UsIGNhY2hlIHRoZSBjYWxjdWxhdGlvbiBvZlxuICAgICAqIHRoZSBtb2RpZmllciBpbiB0aGUgZm9sbG93aW5nIHByb3BlcnR5LiBUaGlzIHZhbHVlIGlzIHJlc2V0IGVhY2ggdGltZSB0aGVcbiAgICAgKiByYW5nZSBjaGFuZ2VzIGluIGEgZG9jdW1lbnQuXG4gICAgICovXG4gICAgY2FjaGU6IElubGluZUNhY2hlID0ge1xuICAgICAgICBtb2RpZmllcnM6IG51bGwsXG4gICAgICAgIHN0eWxlOiBudWxsLFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQXBwbHkgdGhlIGBmb3JtYXRgIHRvIHRoZSByYW5nZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICB0b2dnbGVGb3JtYXQocGFyYW1zOiBGb3JtYXRQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3QgRm9ybWF0Q2xhc3MgPSBwYXJhbXMuRm9ybWF0Q2xhc3M7XG5cbiAgICAgICAgaWYgKHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5jYWNoZS5tb2RpZmllcnMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlLm1vZGlmaWVycyA9IHRoaXMuZ2V0Q3VycmVudE1vZGlmaWVycyhyYW5nZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBmb3JtYXQgPSB0aGlzLmNhY2hlLm1vZGlmaWVycy5maW5kKEZvcm1hdENsYXNzKTtcbiAgICAgICAgICAgIGlmIChmb3JtYXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhY2hlLm1vZGlmaWVycy5yZW1vdmUoZm9ybWF0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWNoZS5tb2RpZmllcnMuYXBwZW5kKG5ldyBGb3JtYXRDbGFzcygpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkSW5saW5lcyA9IHJhbmdlLnNlbGVjdGVkTm9kZXMoSW5saW5lTm9kZSk7XG5cbiAgICAgICAgICAgIC8vIElmIGV2ZXJ5IGNoYXIgaW4gdGhlIHJhbmdlIGhhcyB0aGUgZm9ybWF0IGBGb3JtYXRDbGFzc2AsIHJlbW92ZVxuICAgICAgICAgICAgLy8gdGhlIGZvcm1hdCBmb3IgYWxsIG9mIHRoZW0uXG4gICAgICAgICAgICBjb25zdCBhbGxIYXZlRm9ybWF0ID0gc2VsZWN0ZWRJbmxpbmVzLmV2ZXJ5KGlubGluZSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICEhaW5saW5lLm1vZGlmaWVycy5maW5kKEZvcm1hdENsYXNzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGFsbEhhdmVGb3JtYXQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGlubGluZSBvZiBzZWxlY3RlZElubGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0gaW5saW5lLm1vZGlmaWVycy5maW5kKEZvcm1hdENsYXNzKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQXBwbHkgdGhlIGF0dHJpYnV0ZXMgb2YgdGhlIGZvcm1hdCB3ZSdyZSBhYm91dCB0byByZW1vdmVcbiAgICAgICAgICAgICAgICAgICAgLy8gdG8gdGhlIGlubGluZSBpdHNlbGYuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBpbmxpbmUubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2hpbmdGb3JtYXRBdHRyaWJ1dGVzID0gZm9ybWF0Lm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2hpbmdGb3JtYXRBdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiBtYXRjaGluZ0Zvcm1hdEF0dHJpYnV0ZXMua2V5cygpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5zZXQoa2V5LCBtYXRjaGluZ0Zvcm1hdEF0dHJpYnV0ZXMuZ2V0KGtleSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgZm9ybWF0LlxuICAgICAgICAgICAgICAgICAgICBpbmxpbmUubW9kaWZpZXJzLnJlbW92ZShmb3JtYXQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgYXQgbGVhc3Qgb25lIGNoYXIgaW4gdGhlIHJhbmdlIHdpdGhvdXQgdGhlIGZvcm1hdFxuICAgICAgICAgICAgICAgIC8vIGBGb3JtYXRDbGFzc2AsIHNldCB0aGUgZm9ybWF0IGZvciBhbGwgbm9kZXMuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBpbmxpbmUgb2Ygc2VsZWN0ZWRJbmxpbmVzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaW5saW5lLm1vZGlmaWVycy5maW5kKEZvcm1hdENsYXNzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3IEZvcm1hdENsYXNzKCkuYXBwbHlUbyhpbmxpbmUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGlzQWxsRm9ybWF0KEZvcm1hdENsYXNzOiBDb25zdHJ1Y3RvcjxNb2RpZmllcj4sIHJhbmdlID0gdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlKTogYm9vbGVhbiB7XG4gICAgICAgIGlmIChyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuY2FjaGUubW9kaWZpZXJzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWNoZS5tb2RpZmllcnMgPSB0aGlzLmdldEN1cnJlbnRNb2RpZmllcnMocmFuZ2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICEhdGhpcy5jYWNoZS5tb2RpZmllcnMuZmluZChGb3JtYXRDbGFzcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZElubGluZXMgPSByYW5nZS5zZWxlY3RlZE5vZGVzKElubGluZU5vZGUpO1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICBzZWxlY3RlZElubGluZXMubGVuZ3RoICYmXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWRJbmxpbmVzLmV2ZXJ5KGNoYXIgPT4gISFjaGFyLm1vZGlmaWVycy5maW5kKEZvcm1hdENsYXNzKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBtb2RpZmllcnMgZm9yIHRoZSBuZXh0IGluc2VydGlvbi5cbiAgICAgKi9cbiAgICBnZXRDdXJyZW50TW9kaWZpZXJzKHJhbmdlID0gdGhpcy5lZGl0b3Iuc2VsZWN0aW9uLnJhbmdlKTogTW9kaWZpZXJzIHtcbiAgICAgICAgaWYgKHRoaXMuY2FjaGUubW9kaWZpZXJzKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYWNoZS5tb2RpZmllcnM7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgaW5saW5lVG9Db3B5TW9kaWZpZXJzOiBWTm9kZTtcbiAgICAgICAgaWYgKHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgICAgIGlubGluZVRvQ29weU1vZGlmaWVycyA9IHJhbmdlLnN0YXJ0LnByZXZpb3VzU2libGluZygpIHx8IHJhbmdlLnN0YXJ0Lm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbmxpbmVUb0NvcHlNb2RpZmllcnMgPSByYW5nZS5zdGFydC5uZXh0U2libGluZygpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpbmxpbmVUb0NvcHlNb2RpZmllcnMgJiYgaW5saW5lVG9Db3B5TW9kaWZpZXJzLmlzKElubGluZU5vZGUpKSB7XG4gICAgICAgICAgICByZXR1cm4gaW5saW5lVG9Db3B5TW9kaWZpZXJzLm1vZGlmaWVycy5jbG9uZSgpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5ldyBNb2RpZmllcnMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBzdHlsZXMgZm9yIHRoZSBuZXh0IGluc2VydGlvbi5cbiAgICAgKi9cbiAgICBnZXRDdXJyZW50U3R5bGUocmFuZ2UgPSB0aGlzLmVkaXRvci5zZWxlY3Rpb24ucmFuZ2UpOiBDc3NTdHlsZSB7XG4gICAgICAgIGlmICh0aGlzLmNhY2hlLnN0eWxlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYWNoZS5zdHlsZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBpbmxpbmVUb0NvcHlTdHlsZTogVk5vZGU7XG4gICAgICAgIGlmIChyYW5nZS5pc0NvbGxhcHNlZCgpKSB7XG4gICAgICAgICAgICBpbmxpbmVUb0NvcHlTdHlsZSA9IHJhbmdlLnN0YXJ0LnByZXZpb3VzU2libGluZygpIHx8IHJhbmdlLnN0YXJ0Lm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbmxpbmVUb0NvcHlTdHlsZSA9IHJhbmdlLnN0YXJ0Lm5leHRTaWJsaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlubGluZVRvQ29weVN0eWxlICYmIGlubGluZVRvQ29weVN0eWxlLmlzKElubGluZU5vZGUpKSB7XG4gICAgICAgICAgICByZXR1cm4gaW5saW5lVG9Db3B5U3R5bGUubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk/LnN0eWxlLmNsb25lKCkgfHwgbmV3IENzc1N0eWxlKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBDc3NTdHlsZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFYWNoIHRpbWUgdGhlIHNlbGVjdGlvbiBjaGFuZ2VzLCB3ZSByZXNldCBpdHMgZm9ybWF0IGFuZCBzdHlsZS5cbiAgICAgKi9cbiAgICByZXNldENhY2hlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNhY2hlID0ge1xuICAgICAgICAgICAgbW9kaWZpZXJzOiBudWxsLFxuICAgICAgICAgICAgc3R5bGU6IG51bGwsXG4gICAgICAgIH07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcblxuZXhwb3J0IGNsYXNzIElubGluZU5vZGUgZXh0ZW5kcyBBdG9taWNOb2RlIHt9XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IElucHV0WG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9JbnB1dFhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBJbnB1dEh0bWxEb21SZW5kZXJlciB9IGZyb20gJy4vSW5wdXRIdG1sRG9tUmVuZGVyZXInO1xuXG5leHBvcnQgY2xhc3MgSW5wdXQ8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW0lucHV0WG1sRG9tUGFyc2VyXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbSW5wdXRIdG1sRG9tUmVuZGVyZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IElucHV0Tm9kZSB9IGZyb20gJy4vSW5wdXROb2RlJztcbmltcG9ydCB7IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4taHRtbC9zcmMvSHRtbERvbVJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBJbnB1dEh0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gSW5wdXROb2RlO1xuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBWTm9kZSB0byB0aGUgZ2l2ZW4gZm9ybWF0LlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihub2RlOiBJbnB1dE5vZGUpOiBQcm9taXNlPE5vZGVbXT4ge1xuICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgICAgIGNvbnN0IGF0dHJpYnV0ZXMgPSBub2RlLm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpO1xuICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgdGhpcy5lbmdpbmUucmVuZGVyQXR0cmlidXRlcyhBdHRyaWJ1dGVzLCBub2RlLCBpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGUuaW5wdXRUeXBlKSB7XG4gICAgICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCBub2RlLmlucHV0VHlwZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5vZGUuaW5wdXROYW1lKSB7XG4gICAgICAgICAgICBpbnB1dC5zZXRBdHRyaWJ1dGUoJ25hbWUnLCBub2RlLmlucHV0TmFtZSk7XG4gICAgICAgIH1cbiAgICAgICAgaW5wdXQudmFsdWUgPSBub2RlLnZhbHVlO1xuICAgICAgICByZXR1cm4gW2lucHV0XTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWRWxlbWVudCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WRWxlbWVudCc7XG5cbmV4cG9ydCBjbGFzcyBJbnB1dE5vZGUgZXh0ZW5kcyBWRWxlbWVudCB7XG4gICAgdmFsdWU6IHN0cmluZztcbiAgICBpbnB1dE5hbWU6IHN0cmluZztcbiAgICBpbnB1dFR5cGU6IHN0cmluZztcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXM6IHsgdHlwZT86IHN0cmluZzsgbmFtZT86IHN0cmluZzsgdmFsdWU/OiBzdHJpbmcgfSA9IHt9KSB7XG4gICAgICAgIHN1cGVyKHsgaHRtbFRhZzogJ0lOUFVUJyB9KTtcbiAgICAgICAgdGhpcy5pbnB1dE5hbWUgPSBwYXJhbXMubmFtZTtcbiAgICAgICAgdGhpcy5pbnB1dFR5cGUgPSBwYXJhbXMudHlwZTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHBhcmFtcy52YWx1ZTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IElucHV0Tm9kZSB9IGZyb20gJy4vSW5wdXROb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIElucHV0WG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIG5vZGVOYW1lKGl0ZW0pID09PSAnSU5QVVQnO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBIVE1MSW5wdXRFbGVtZW50KTogUHJvbWlzZTxJbnB1dE5vZGVbXT4ge1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBJbnB1dE5vZGUoe1xuICAgICAgICAgICAgdHlwZTogaXRlbS5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSxcbiAgICAgICAgICAgIG5hbWU6IGl0ZW0uZ2V0QXR0cmlidXRlKCduYW1lJyksXG4gICAgICAgICAgICB2YWx1ZTogaXRlbS52YWx1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGlucHV0Lm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcbiAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGlucHV0Lm1vZGlmaWVycy5maW5kKEF0dHJpYnV0ZXMpO1xuICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgYXR0cmlidXRlcy5yZW1vdmUoJ3R5cGUnKTsgLy8gdHlwZSBpcyBvbiBpbnB1dC5pbnB1dFR5cGVcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMucmVtb3ZlKCduYW1lJyk7IC8vIHR5cGUgaXMgb24gaW5wdXQuaW5wdXROYW1lXG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgbm9kZXMgPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICBpbnB1dC5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW2lucHV0XTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBJdGFsaWNGb3JtYXQgfSBmcm9tICcuL0l0YWxpY0Zvcm1hdCc7XG5pbXBvcnQgeyBGb3JtYXRQYXJhbXMsIElubGluZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBJdGFsaWNYbWxEb21QYXJzZXIgfSBmcm9tICcuL0l0YWxpY1htbERvbVBhcnNlcic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgS2V5bWFwIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcblxuZXhwb3J0IGNsYXNzIEl0YWxpYzxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtJbmxpbmVdO1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIEtleW1hcD4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtJdGFsaWNYbWxEb21QYXJzZXJdLFxuICAgICAgICBzaG9ydGN1dHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtJJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd0b2dnbGVGb3JtYXQnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7IEZvcm1hdENsYXNzOiBJdGFsaWNGb3JtYXQgfSBhcyBGb3JtYXRQYXJhbXMsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgSldFZGl0b3IgZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgSXRhbGljRm9ybWF0IH0gZnJvbSAnLi9JdGFsaWNGb3JtYXQnO1xuaW1wb3J0IHsgRm9ybWF0UGFyYW1zLCBJbmxpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmUnO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXRvb2xiYXIvc3JjL1Rvb2xiYXInO1xuXG5leHBvcnQgY29uc3QgSXRhbGljQnV0dG9uOiBCdXR0b24gPSB7XG4gICAgdGl0bGU6ICdUb2dnbGUgaXRhbGljJyxcbiAgICBjbGFzczogJ2ZhLWl0YWxpYycsXG4gICAgY29tbWFuZElkOiAndG9nZ2xlRm9ybWF0JyxcbiAgICBjb21tYW5kQXJnczogeyBGb3JtYXRDbGFzczogSXRhbGljRm9ybWF0IH0gYXMgRm9ybWF0UGFyYW1zLFxuICAgIHNlbGVjdGVkOiAoZWRpdG9yOiBKV0VkaXRvcik6IGJvb2xlYW4gPT4gZWRpdG9yLnBsdWdpbnMuZ2V0KElubGluZSkuaXNBbGxGb3JtYXQoSXRhbGljRm9ybWF0KSxcbn07XG4iLCJpbXBvcnQgeyBGb3JtYXQgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9Gb3JtYXQnO1xuXG5leHBvcnQgY2xhc3MgSXRhbGljRm9ybWF0IGV4dGVuZHMgRm9ybWF0IHtcbiAgICBjb25zdHJ1Y3RvcihodG1sVGFnOiAnSScgfCAnRU0nID0gJ0knKSB7XG4gICAgICAgIHN1cGVyKGh0bWxUYWcpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEZvcm1hdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdFBhcnNlcic7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBJdGFsaWNGb3JtYXQgfSBmcm9tICcuL0l0YWxpY0Zvcm1hdCc7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBub2RlTmFtZSB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBJdGFsaWNYbWxEb21QYXJzZXIgZXh0ZW5kcyBGb3JtYXRQYXJzZXIge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIChub2RlTmFtZShpdGVtKSA9PT0gJ0knIHx8IG5vZGVOYW1lKGl0ZW0pID09PSAnRU0nKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYW4gaXRhbGljIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgaXRhbGljID0gbmV3IEl0YWxpY0Zvcm1hdChub2RlTmFtZShpdGVtKSBhcyAnSScgfCAnRU0nKTtcbiAgICAgICAgaXRhbGljLm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KGl0YWxpYywgY2hpbGRyZW4pO1xuXG4gICAgICAgIHJldHVybiBjaGlsZHJlbjtcbiAgICB9XG59XG4iLCJpbXBvcnQgSldFZGl0b3IgZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgQ29tbWFuZElkZW50aWZpZXIgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IENvbnRleHR1YWwgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Db250ZXh0TWFuYWdlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmlndXJlZENvbW1hbmQgZXh0ZW5kcyBDb250ZXh0dWFsIHtcbiAgICAvKipcbiAgICAgKiBBbiB1bmRlZmluZWQgYGNvbW1hbmRJZGAgZWZmZWN0aXZlbHkgdW5iaW5kcyB0aGUgc2hvcnRjdXQuXG4gICAgICovXG4gICAgcmVhZG9ubHkgY29tbWFuZElkOiBDb21tYW5kSWRlbnRpZmllciB8IHVuZGVmaW5lZDtcbiAgICByZWFkb25seSBjb21tYW5kQXJncz86IHt9O1xufVxuXG5pbnRlcmZhY2UgTW9kaWZpZWRTaG9ydGN1dCB7XG4gICAgbW9kaWZpZXJzOiBTZXQ8c3RyaW5nPjtcbn1cblxuaW50ZXJmYWNlIEtleVNob3J0Y3V0UGF0dGVybiBleHRlbmRzIE1vZGlmaWVkU2hvcnRjdXQge1xuICAgIGtleTogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgQ29kZVNob3J0Y3V0UGF0dGVybiBleHRlbmRzIE1vZGlmaWVkU2hvcnRjdXQge1xuICAgIGNvZGU6IHN0cmluZztcbn1cblxudHlwZSBTaG9ydGN1dFBhdHRlcm4gPSBLZXlTaG9ydGN1dFBhdHRlcm4gfCBDb2RlU2hvcnRjdXRQYXR0ZXJuO1xuXG5leHBvcnQgaW50ZXJmYWNlIE1hcHBpbmcge1xuICAgIHBhdHRlcm46IFNob3J0Y3V0UGF0dGVybjtcbiAgICBjb25maWd1cmVkQ29tbWFuZDogQ29uZmlndXJlZENvbW1hbmQ7XG59XG5cbmV4cG9ydCBlbnVtIFBsYXRmb3JtIHtcbiAgICBNQUMgPSAnbWFjJyxcbiAgICBQQyA9ICdwYycsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2hvcnRjdXQgZXh0ZW5kcyBDb25maWd1cmVkQ29tbWFuZCB7XG4gICAgcGxhdGZvcm0/OiBQbGF0Zm9ybTtcbiAgICBwYXR0ZXJuOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBlbnVtIExFVkVMIHtcbiAgICBERUZBVUxULFxuICAgIFVTRVIsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgS2V5bWFwQ29uZmlnIGV4dGVuZHMgSldQbHVnaW5Db25maWcge1xuICAgIHBsYXRmb3JtPzogUGxhdGZvcm07XG59XG5cbi8qKlxuICogS2V5bWFwIGFsbG93IHRvIGFkZCBhbmQgcmVtb3ZlIHNob3J0dWN0cyBhbmQgcHJvdmlkZSBhIGZ1bmN0aW9uIHRvIG1hdGNoIGFcbiAqIGtleWJvYXJkIGV2ZW50IHdpdGggdGhlIHJlZ2lzdGVyZWQgc2hvcnRjdXRzIHBhdHRlcm5zLlxuICpcbiAqICMjIEFkZGluZyBzaG9ydGN1dHNcbiAqIFRoZSBleHByZXNzaW9uIHRvIGRlc2NyaWJlIGEgc2hvcnR1Y3QgaXMgemVybyBvciBtb3JlIGBtb2RpZmllcnNgIGFuZCBvbmVcbiAqIGBob3RrZXlgIGpvaW5lZCB3aXRoIHRoZSBzeW1ib2wgYCtgLlxuICpcbiAqICMjIyBNb2RpZmllcnNcbiAqIC0gU0hJRlRcbiAqIC0gQUxUXG4gKiAtIENUUkxcbiAqIC0gTUVUQVxuICogLSBDTUQgKGFsaWFzIG9mIE1FVEEpXG4gKlxuICogRXhhbXBsZTpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIC8vIHVzaW5nIGEgbW9kaWZpZXIgYW5kIG9uZSBrZXlcbiAqIGtleW1hcC5iaW5kKCdDVFJMK0EnLCAnY29tbWFuZElkZW50aWZpZXInKVxuICogLy8gdXNpbmcgbXVsdGlwbGVzIG1vZGlmaWVycyBhbmQgb25lIGtleVxuICoga2V5bWFwLmJpbmQoJ0NUUkwrQUxUK0EnLCAnY29tbWFuZElkZW50aWZpZXInKVxuICogYGBgXG4gKlxuICogIyMjIEhvdGtleXNcbiAqIEEgaG90a2V5IGNhbiBiZSB3ZXRoZXIgYSBga2V5YCBvciBgY29kZWAuXG4gKlxuICogIyMjIyBLZXlcbiAqIFRoZSBzeW50YXggdG8gZGVzY3JpYmUgYSBga2V5YCBpcyB0byB3cml0ZSB0aGUgYGtleWAgYXMgaXQgaXMuIFRoZSBjb252ZW50aW9uXG4gKiBpcyB0byB3cml0ZSBpdCBpbiB1cHBlcmNhc2UuXG4gKlxuICogRXhhbXBsZTpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGtleW1hcC5iaW5kKCdDVFJMK0EnLCAnY29tbWFuZElkZW50aWZpZXInKVxuICogYGBgXG4gKiBUaGUgbGlzdCBvZiBwb3NzaWJsZSBga2V5YCB2YWx1ZXMgYXJlIGRlZmluZWQgaW4gdGhlIGZvbGxvd2luZyBsaW5rOlxuICogaHR0cHM6Ly93d3cudzMub3JnL1RSL3VpZXZlbnRzLyNkb20ta2V5Ym9hcmRldmVudC1rZXlcbiAqXG4gKiAjIyMjIENvZGVcbiAqIFRoZSBzeW50YXggdG8gZGVzY3JpYmUgYSBgY29kZWAgaXMgdG8gd3JpdGUgYDxjb2RlPmAgKHN1cnJvdW5kZWQgYnkgXCI8XCIgYW5kXG4gKiBcIj5cIikuXG4gKlxuICogRXhhbXBsZTpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGtleW1hcC5iaW5kKCdDVFJMKzxLZXlBPicsICdjb21tYW5kSWRlbnRpZmllcicpXG4gKiBgYGBcbiAqXG4gKiBUaGUgbGlzdCBvZiBwb3NzaWJsZSBgY29kZWAgdmFsdWVzIGFyZSBkZWZpbmVkIGluIHRoZSBmb2xsb3dpbmcgbGluazpcbiAqIGh0dHBzOi8vd3d3LnczLm9yZy9UUi91aWV2ZW50cy8jZG9tLWtleWJvYXJkZXZlbnQta2V5XG4gKlxuICogIyMgUmVtb3Zpbmcgc2hvcnR1Y3RzXG4gKiBUbyByZW1vdmUgYSBzaG9ydHVjdCwgY2FsbCBgYmluZGAgd2l0aG91dCBzcGVjaWZ5aW5nIGEgY29tbWFuZElkZW50aWZpZXIuXG4gKlxuICogRXhhbXBsZTpcbiAqIGBgYHR5cGVzY3JpcHRcbiAqIGtleW1hcC5iaW5kKCdDVFJMKzxLZXlBPicpXG4gKiBgYGBcbiAqL1xuZXhwb3J0IGNsYXNzIEtleW1hcDxUIGV4dGVuZHMgS2V5bWFwQ29uZmlnID0gS2V5bWFwQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICByZWFkb25seSBsb2FkZXJzID0ge1xuICAgICAgICBzaG9ydGN1dHM6IHRoaXMuX2xvYWRTaG9ydGN1dHMsXG4gICAgfTtcbiAgICBtYXBwaW5nczogTWFwcGluZ1tdW10gPSBbLi4ubmV3IEFycmF5KExFVkVMLlVTRVIgKyAxKV0ubWFwKCgpID0+IFtdKTtcbiAgICBkZWZhdWx0TWFwcGluZ3M6IE1hcHBpbmdbXSA9IFtdO1xuICAgIHVzZXJNYXBwaW5nczogTWFwcGluZ1tdID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgZWRpdG9yOiBKV0VkaXRvciwgcHVibGljIGNvbmZpZzogVCkge1xuICAgICAgICBzdXBlcihlZGl0b3IsIGNvbmZpZyk7XG4gICAgICAgIGlmICghY29uZmlnLnBsYXRmb3JtKSB7XG4gICAgICAgICAgICBjb25zdCBpc01hYyA9IG5hdmlnYXRvci5wbGF0Zm9ybS5tYXRjaCgvTWFjLyk7XG4gICAgICAgICAgICBjb25maWcucGxhdGZvcm0gPSBpc01hYyA/IFBsYXRmb3JtLk1BQyA6IFBsYXRmb3JtLlBDO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIEJpbmQgYSBzaG9ydHVjdC5cbiAgICAgKlxuICAgICAqIElmIHRoZXJlIGlzIG5vIGBjb21tYW5kLmNvbW1hbmRJZGAsIGl0IG1lYW5zIHRoYXQgd2Ugd2FudCBub3RoaW5nIHRvXG4gICAgICogZXhlY3V0ZSwgdGh1cyByZXBsYWNpbmcgdGhlIGNvbW1hbmQgb3JpZ2luYWxseSBib3VuZCBvbiB0aGlzIHNob3J0Y3V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdHRlcm5cbiAgICAgKiBAcGFyYW0gY29tbWFuZFxuICAgICAqL1xuICAgIGJpbmQocGF0dGVybjogc3RyaW5nLCBjb21tYW5kOiBDb25maWd1cmVkQ29tbWFuZCwgbGV2ZWwgPSBMRVZFTC5ERUZBVUxUKTogdm9pZCB7XG4gICAgICAgIHRoaXMubWFwcGluZ3NbbGV2ZWxdLnB1c2goe1xuICAgICAgICAgICAgcGF0dGVybjogdGhpcy5wYXJzZVBhdHRlcm4ocGF0dGVybiksXG4gICAgICAgICAgICBjb25maWd1cmVkQ29tbWFuZDogY29tbWFuZCxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFsbCBjb25maWd1cmVkIGNvbW1hbmRzIHdoaWNoIHNob3J0Y3V0IG1hdGNoIHRoZSBnaXZlbiBga2V5RXZlbnRgLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleUV2ZW50XG4gICAgICovXG4gICAgbWF0Y2goa2V5RXZlbnQ6IEtleWJvYXJkRXZlbnQpOiBDb25maWd1cmVkQ29tbWFuZFtdIHtcbiAgICAgICAgY29uc3QgbWF0Y2hpbmdDb21tYW5kczogQ29uZmlndXJlZENvbW1hbmRbXSA9IFtdO1xuICAgICAgICBmb3IgKGxldCBsZXZlbCA9IExFVkVMLlVTRVI7IGxldmVsID49IDA7IGxldmVsLS0pIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qgc2hvcnRjdXQgb2YgdGhpcy5tYXBwaW5nc1tsZXZlbF0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtb2RpZmllcnMgPSBzaG9ydGN1dC5wYXR0ZXJuLm1vZGlmaWVycztcblxuICAgICAgICAgICAgICAgIGxldCBtYXRjaDogYm9vbGVhbjtcbiAgICAgICAgICAgICAgICBpZiAoJ2NvZGUnIGluIHNob3J0Y3V0LnBhdHRlcm4pIHtcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBzaG9ydGN1dC5wYXR0ZXJuLmNvZGUgPT09IGtleUV2ZW50LmNvZGU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSW4gcmFyZSBjYXNlIHRoZSBLZXlib2FyZEV2ZW50IGBrZXlgIGlzIHVuZGVmaW5lZC5cbiAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSBzaG9ydGN1dC5wYXR0ZXJuLmtleSA9PT0ga2V5RXZlbnQua2V5Py50b1VwcGVyQ2FzZSgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1hdGNoID1cbiAgICAgICAgICAgICAgICAgICAgbWF0Y2ggJiZcbiAgICAgICAgICAgICAgICAgICAgbW9kaWZpZXJzLmhhcygnQ1RSTCcpID09PSBrZXlFdmVudC5jdHJsS2V5ICYmXG4gICAgICAgICAgICAgICAgICAgIG1vZGlmaWVycy5oYXMoJ1NISUZUJykgPT09IGtleUV2ZW50LnNoaWZ0S2V5ICYmXG4gICAgICAgICAgICAgICAgICAgIG1vZGlmaWVycy5oYXMoJ01FVEEnKSA9PT0ga2V5RXZlbnQubWV0YUtleSAmJlxuICAgICAgICAgICAgICAgICAgICBtb2RpZmllcnMuaGFzKCdBTFQnKSA9PT0ga2V5RXZlbnQuYWx0S2V5O1xuXG4gICAgICAgICAgICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghc2hvcnRjdXQuY29uZmlndXJlZENvbW1hbmQuY29tbWFuZElkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBbiBgdW5kZWZpbmVkYCBjb21tYW5kIHVuYm91bmRzIHRoZSBvdGhlciBjb21tYW5kc1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJldmlvdXNseSByZWdpc3RlcmVkIG9uIHRoaXMgc2hvcnRjdXQuXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGluZ0NvbW1hbmRzLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hpbmdDb21tYW5kcy5wdXNoKHNob3J0Y3V0LmNvbmZpZ3VyZWRDb21tYW5kKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChtYXRjaGluZ0NvbW1hbmRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIE1hdGNoZXMgd2VyZSBmb3VuZCBhdCB0aGlzIGxldmVsIHNvIGRvIG5vdCBsb29rIGxvd2VyLlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYXRjaGluZ0NvbW1hbmRzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgc3RyaW5nIHRoYXQgcmVwcmVzZW50cyBhIHBhdHRlcm4gYW5kIHJldHVybiBhIGBTaG9ydHVjdFBhdHRlcm5gLlxuICAgICAqIFN1cHBvcnRlZCBwYXR0ZXJuIGlzOiBbbW9kaWZpZXIrXSpbPGNvZGU+fGtleV1cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXR0ZXJuXG4gICAgICovXG4gICAgcGFyc2VQYXR0ZXJuKHBhdHRlcm46IHN0cmluZyk6IFNob3J0Y3V0UGF0dGVybiB7XG4gICAgICAgIGNvbnN0IHRva2VucyA9IHBhdHRlcm5cbiAgICAgICAgICAgIC5yZXBsYWNlKC9jbWQvZ2ksICdNRVRBJylcbiAgICAgICAgICAgIC5zcGxpdCgvWytdLylcbiAgICAgICAgICAgIC5tYXAodG9rZW4gPT4gdG9rZW4udHJpbSgpKTtcbiAgICAgICAgY29uc3Qga2V5Q29kZSA9IHRva2Vucy5wb3AoKTtcbiAgICAgICAgY29uc3QgbW9kaWZpZXJzID0gbmV3IFNldCh0b2tlbnMubWFwKHRva2VuID0+IHRva2VuLnRvVXBwZXJDYXNlKCkpKTtcbiAgICAgICAgaWYgKCFrZXlDb2RlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IGhhdmUgYXQgbGVhc3Qgb25lIGtleSBvciBjb2RlLicpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZXJlIGFyZSB0d28gd2F5cyB0byBzcGVjaWZ5IGEgc2hvcnRjdXQgaG90a2V5IDoga2V5IG9yIGNvZGVcbiAgICAgICAgLy8gLSBcIkNUUkwrMVwiIGlzIHRoZSBtb2RpZmllciBDVFJMIHdpdGggdGhlIGV2ZW50LmtleSBcIjFcIi5cbiAgICAgICAgLy8gLSBcIkNUUkwrPEtleTE+XCIgaXMgdGhlIG1vZGlmaWVyIENUUkwgd2l0aCB0aGUgZXZlbnQuY29kZSBcIktleTFcIlxuICAgICAgICBjb25zdCBjb2RlTWF0Y2ggPSBrZXlDb2RlLm1hdGNoKC9ePChcXHcrKT4kLyk7XG4gICAgICAgIGlmIChjb2RlTWF0Y2ggJiYgY29kZU1hdGNoLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIHJldHVybiB7IGNvZGU6IGNvZGVNYXRjaFsxXSwgbW9kaWZpZXJzIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4geyBrZXk6IGtleUNvZGUudG9VcHBlckNhc2UoKSwgbW9kaWZpZXJzIH07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUYWtlIGEgYFNob3J0dWN0UGF0dGVybmAgYW5kIHJldHVybiBhIHN0cmluZyB0aGF0IHJlcHJlc2VudHMgYSBwYXR0ZXJuLFxuICAgICAqIGluIHRoZSBmb3JtIFttb2RpZmllcitdKls8Y29kZT58a2V5XS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXR0ZXJuXG4gICAgICovXG4gICAgc3RyaW5naWZ5UGF0dGVybihwYXR0ZXJuOiBTaG9ydGN1dFBhdHRlcm4pOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBwYXJ0cyA9IEFycmF5LmZyb20ocGF0dGVybi5tb2RpZmllcnMpO1xuICAgICAgICBpZiAoJ2NvZGUnIGluIHBhdHRlcm4pIHtcbiAgICAgICAgICAgIHBhcnRzLnB1c2gocGF0dGVybi5jb2RlKTtcbiAgICAgICAgfSBlbHNlIGlmICgna2V5JyBpbiBwYXR0ZXJuKSB7XG4gICAgICAgICAgICBwYXJ0cy5wdXNoKHBhdHRlcm4ua2V5KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGFydHMuam9pbignKycpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogTG9hZCBhIHNob3J0Y3V0IGluIHRoZSBrZXltYXAgZGVwZW5kaW5nIG9uIHRoZSBwbGF0Zm9ybS5cbiAgICAgKlxuICAgICAqIC0gSWYgdGhlIHNob3J0dWN0IGhhcyBubyBwbGF0Zm9ybSBwcm9wZXJ0eTsgbG9hZCB0aGUgc2hvcnR1Y3QgaW4gYm90aFxuICAgICAqICAgcGxhdGZvcm0gKCdtYWMnIGFuZCAncGMnKS5cbiAgICAgKiAtIElmIHRoZSBzaG9ydHVjdCBoYXMgbm8gcGxhdGZvcm0gcHJvcGVydHkgYW5kIHRoZSBjdXJyZW50IHBsYXRmb3JtIGlzXG4gICAgICogICBtYWMsIG1vZGlmeSB0aGUgY3RybCBrZXkgdG8gbWV0YSBrZXkuXG4gICAgICogLSBJZiB0aGUgc2hvcnR1Y3QgaGFzIGEgcGxhdGZvcm0gcHJvcGVydHksIG9ubHkgbG9hZCB0aGUgc2hvcnRjdXQgZm9yXG4gICAgICogICB0aGF0IHBsYXRmb3JtLlxuICAgICAqIC0gSWYgbm8gYG1hcHBpbmcuY29tbWFuZElkYCBpcyBkZWNsYXJlZCwgaXQgbWVhbnMgcmVtb3ZpbmcgdGhlIHNob3J0Y3V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHNob3J0Y3V0cyBUaGUgc2hvcnR1Y3QgZGVmaW5pdGlvbnMuXG4gICAgICogQHBhcmFtIHNvdXJjZSBUaGUgc291cmNlIG9mIHRoZSBzaG9ydGN1dHMuXG4gICAgICovXG4gICAgX2xvYWRTaG9ydGN1dHMoc2hvcnRjdXRzOiBTaG9ydGN1dFtdLCBzb3VyY2U/OiBKV1BsdWdpbiB8IHt9KTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3Qgc2hvcnRjdXQgb2YgWy4uLnNob3J0Y3V0c10pIHtcbiAgICAgICAgICAgIC8vIEEgc2hvcnRjdXQgaXMgYSBjb25maWd1cmVkIGNvbW1hbmQgb24gd2hpY2ggdGhlIHByb3BlcnRpZXNcbiAgICAgICAgICAgIC8vIGBwYXR0ZXJuYCwgYW5kIG9wdGlvbmFsbHkgYHBsYXRmb3JtYCwgd2VyZSBzZXQuXG4gICAgICAgICAgICBjb25zdCBwbGF0Zm9ybSA9IHNob3J0Y3V0LnBsYXRmb3JtO1xuICAgICAgICAgICAgaWYgKCFwbGF0Zm9ybSB8fCBwbGF0Zm9ybSA9PT0gdGhpcy5jb25maWcucGxhdGZvcm0pIHtcbiAgICAgICAgICAgICAgICBsZXQgcGF0dGVybiA9IHNob3J0Y3V0LnBhdHRlcm47XG4gICAgICAgICAgICAgICAgY29uc3QgY29tbWFuZDogQ29uZmlndXJlZENvbW1hbmQgPSBzaG9ydGN1dDtcbiAgICAgICAgICAgICAgICAvLyBQYXR0ZXJucyB1c2luZyB0aGUgQ1RSTCBtb2RpZmllciB0YXJnZXQgQ01EIGluc3RlYWQgZm9yIE1hYy5cbiAgICAgICAgICAgICAgICBpZiAoIXBsYXRmb3JtICYmIHRoaXMuY29uZmlnLnBsYXRmb3JtID09PSBQbGF0Zm9ybS5NQUMpIHtcbiAgICAgICAgICAgICAgICAgICAgcGF0dGVybiA9IHNob3J0Y3V0LnBhdHRlcm4ucmVwbGFjZSgvY3RybC9naSwgJ0NNRCcpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoc291cmNlIGluc3RhbmNlb2YgSldQbHVnaW4pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5iaW5kKHBhdHRlcm4sIGNvbW1hbmQsIExFVkVMLkRFRkFVTFQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYmluZChwYXR0ZXJuLCBjb21tYW5kLCBMRVZFTC5VU0VSKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQge1xuICAgIExheW91dEVuZ2luZSxcbiAgICBDb21wb25lbnREZWZpbml0aW9uLFxuICAgIENvbXBvbmVudElkLFxuICAgIExheW91dEVuZ2luZUNvbnN0cnVjdG9yLFxuICAgIExheW91dEVuZ2luZUlkLFxufSBmcm9tICcuL0xheW91dEVuZ2luZSc7XG5pbXBvcnQgeyBab25lSWRlbnRpZmllciB9IGZyb20gJy4vWm9uZU5vZGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIExheW91dENvbmZpZyBleHRlbmRzIEpXUGx1Z2luQ29uZmlnIHtcbiAgICBjb21wb25lbnRzPzogQ29tcG9uZW50RGVmaW5pdGlvbltdO1xuICAgIGNvbXBvbmVudFpvbmVzPzogW0NvbXBvbmVudElkLCBab25lSWRlbnRpZmllcl1bXTtcbn1cblxuZXhwb3J0IGNsYXNzIExheW91dDxUIGV4dGVuZHMgTGF5b3V0Q29uZmlnID0gTGF5b3V0Q29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICByZWFkb25seSBlbmdpbmVzOiBSZWNvcmQ8TGF5b3V0RW5naW5lSWQsIExheW91dEVuZ2luZT4gPSB7fTtcbiAgICByZWFkb25seSBsb2FkZXJzID0ge1xuICAgICAgICBsYXlvdXRFbmdpbmVzOiB0aGlzLmxvYWRFbmdpbmVzLFxuICAgICAgICBjb21wb25lbnRzOiB0aGlzLmxvYWRDb21wb25lbnRzLFxuICAgICAgICBjb21wb25lbnRab25lczogdGhpcy5sb2FkQ29tcG9uZW50c1pvbmVzLFxuICAgIH07XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIHNob3c6IHtcbiAgICAgICAgICAgIHRpdGxlOiAnU2hvdyBhIGxheW91dCBjb21wb25lbnQnLFxuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5zaG93LmJpbmQodGhpcyksXG4gICAgICAgIH0sXG4gICAgICAgIGhpZGU6IHtcbiAgICAgICAgICAgIHRpdGxlOiAnSGlkZSBhIGxheW91dCBjb21wb25lbnQnLFxuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5oaWRlLmJpbmQodGhpcyksXG4gICAgICAgIH0sXG4gICAgfTtcblxuICAgIGFzeW5jIHN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLmxvYWRDb21wb25lbnRzKHRoaXMuY29uZmlndXJhdGlvbi5jb21wb25lbnRzIHx8IFtdKTtcbiAgICAgICAgdGhpcy5sb2FkQ29tcG9uZW50c1pvbmVzKHRoaXMuY29uZmlndXJhdGlvbi5jb21wb25lbnRab25lcyB8fCBbXSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZCBhIENvbXBvbmVudCBpbiBhIHpvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50SWRcbiAgICAgKiBAcGFyYW0gem9uZUlkXG4gICAgICovXG4gICAgYXN5bmMgYWRkKGNvbXBvbmVudElkOiBDb21wb25lbnRJZCwgem9uZUlkOiBab25lSWRlbnRpZmllciA9ICdkZWZhdWx0Jyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBlbmdpbmVzID0gT2JqZWN0LnZhbHVlcyh0aGlzLmVuZ2luZXMpO1xuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChlbmdpbmVzLm1hcChlbmdpbmUgPT4gZW5naW5lLmFkZChjb21wb25lbnRJZCwgem9uZUlkKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgYSBjb21wb25lbnQgKGluc3RhbmNlIG9yIGNsb25zZSkgZnJvbSB0aGUgem9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21wb25lbnRJRFxuICAgICAqL1xuICAgIGFzeW5jIHJlbW92ZShjb21wb25lbnRJRDogQ29tcG9uZW50SWQpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBsYXlvdXRFbmdpbmUgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLmVuZ2luZXMpKSB7XG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKGxheW91dEVuZ2luZS5yZW1vdmUoY29tcG9uZW50SUQpKTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNob3cgY29tcG9uZW50IChpbnN0YW5jZSBvciBjbG9uc2UpIGluc2lkZSB0aGUgem9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBhc3luYyBzaG93KHBhcmFtczogeyBjb21wb25lbnRJRDogQ29tcG9uZW50SWQgfSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBwcm9taXNlcyA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGxheW91dEVuZ2luZSBvZiBPYmplY3QudmFsdWVzKHRoaXMuZW5naW5lcykpIHtcbiAgICAgICAgICAgIHByb21pc2VzLnB1c2gobGF5b3V0RW5naW5lLnNob3cocGFyYW1zLmNvbXBvbmVudElEKSk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIaWRlIGNvbXBvbmVudCAoaW5zdGFuY2Ugb3IgY2xvbnNlKSBpbnNpZGUgdGhlIHpvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgYXN5bmMgaGlkZShwYXJhbXM6IHsgY29tcG9uZW50SUQ6IENvbXBvbmVudElkIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBsYXlvdXRFbmdpbmUgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLmVuZ2luZXMpKSB7XG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKGxheW91dEVuZ2luZS5oaWRlKHBhcmFtcy5jb21wb25lbnRJRCkpO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMb2FkIGxheW91dCBlbmdpbmVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGxheW91dEVuZ2luZXNcbiAgICAgKi9cbiAgICBwcml2YXRlIGxvYWRFbmdpbmVzKGxheW91dEVuZ2luZXM6IExheW91dEVuZ2luZUNvbnN0cnVjdG9yW10pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBFbmdpbmVDbGFzcyBvZiBsYXlvdXRFbmdpbmVzKSB7XG4gICAgICAgICAgICBjb25zdCBlbmdpbmUgPSBuZXcgRW5naW5lQ2xhc3ModGhpcy5lZGl0b3IpO1xuICAgICAgICAgICAgaWYgKHRoaXMuZW5naW5lc1tlbmdpbmUuaWRdKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSZW5kZXJpbmcgZW5naW5lICR7RW5naW5lQ2xhc3MubmFtZX0gYWxyZWFkeSByZWdpc3RlcmVkLmApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5lbmdpbmVzW2VuZ2luZS5pZF0gPSBlbmdpbmU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogTG9hZCBjb21wb25lbnRzIGludG8gYWxsIGxheW91dCBlbmdpbmVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIENvbXBvbmVudHNcbiAgICAgKi9cbiAgICBwcml2YXRlIGxvYWRDb21wb25lbnRzKENvbXBvbmVudHM6IENvbXBvbmVudERlZmluaXRpb25bXSk6IHZvaWQge1xuICAgICAgICBmb3IgKGNvbnN0IENvbXBvbmVudCBvZiBDb21wb25lbnRzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxheW91dEVuZ2luZSBvZiBPYmplY3QudmFsdWVzKHRoaXMuZW5naW5lcykpIHtcbiAgICAgICAgICAgICAgICBsYXlvdXRFbmdpbmUubG9hZENvbXBvbmVudChDb21wb25lbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvYWQgY29tcG9uZW50IHpvbmVzIGludG8gYWxsIGxheW91dCBlbmdpbmVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbXBvbmVudHNab25lc1xuICAgICAqL1xuICAgIHByaXZhdGUgbG9hZENvbXBvbmVudHNab25lcyhjb21wb25lbnRzWm9uZXM6IFtDb21wb25lbnRJZCwgWm9uZUlkZW50aWZpZXJdW10pOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgem9uZXM6IFJlY29yZDxDb21wb25lbnRJZCwgWm9uZUlkZW50aWZpZXI+ID0ge307XG4gICAgICAgIGZvciAoY29uc3QgW2lkLCB6b25lXSBvZiBjb21wb25lbnRzWm9uZXMpIHtcbiAgICAgICAgICAgIHpvbmVzW2lkXSA9IHpvbmU7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBsYXlvdXRFbmdpbmUgb2YgT2JqZWN0LnZhbHVlcyh0aGlzLmVuZ2luZXMpKSB7XG4gICAgICAgICAgICBsYXlvdXRFbmdpbmUubG9hZENvbXBvbmVudFpvbmVzKHpvbmVzKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCBKV0VkaXRvciBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBab25lSWRlbnRpZmllciwgWm9uZU5vZGUgfSBmcm9tICcuL1pvbmVOb2RlJztcblxuZXhwb3J0IHR5cGUgQ29tcG9uZW50SWQgPSBzdHJpbmc7XG5leHBvcnQgdHlwZSBMYXlvdXRFbmdpbmVJZCA9IHN0cmluZztcbmV4cG9ydCB0eXBlIERvbVpvbmVQb3NpdGlvbiA9ICdhZnRlcicgfCAncHJlcGVuZCcgfCAnYXBwZW5kJyB8ICdyZXBsYWNlJztcblxuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnREZWZpbml0aW9uIHtcbiAgICBpZDogQ29tcG9uZW50SWQ7XG4gICAgcmVuZGVyOiAoZWRpdG9yOiBKV0VkaXRvcikgPT4gUHJvbWlzZTxWTm9kZVtdPjtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIExheW91dEVuZ2luZSB7XG4gICAgcmVhZG9ubHkgaWQ6IExheW91dEVuZ2luZUlkO1xuICAgIHByb3RlY3RlZCBjb21wb25lbnREZWZpbml0aW9uczogUmVjb3JkPENvbXBvbmVudElkLCBDb21wb25lbnREZWZpbml0aW9uPiA9IHt9O1xuICAgIHByb3RlY3RlZCBjb21wb25lbnRab25lczogUmVjb3JkPENvbXBvbmVudElkLCBab25lSWRlbnRpZmllcj4gPSB7fTtcbiAgICByZWFkb25seSByb290ID0gbmV3IFpvbmVOb2RlKFsncm9vdCddKTtcblxuICAgIGNvbXBvbmVudHM6IE1hcDxDb21wb25lbnRJZCwgVk5vZGVbXT4gPSBuZXcgTWFwKCk7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgZWRpdG9yOiBKV0VkaXRvcikge31cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBBdXRvbWF0aWNhbGx5IGludGFuY2lhdGUgdGhlIGNvbXBvbmVudHMgaW4gYXZhaWxhYmxlIHpvbmVzLlxuICAgICAqL1xuICAgIGFzeW5jIHN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBsZXQgYWxsWm9uZXMgPSBbdGhpcy5yb290LCAuLi50aGlzLnJvb3QuZGVzY2VuZGFudHMoWm9uZU5vZGUpXTtcbiAgICAgICAgYXdhaXQgdGhpcy5fZmlsbFpvbmVzKGFsbFpvbmVzKTtcbiAgICAgICAgYWxsWm9uZXMgPSBbdGhpcy5yb290LCAuLi50aGlzLnJvb3QuZGVzY2VuZGFudHMoWm9uZU5vZGUpXTtcbiAgICAgICAgaWYgKCFhbGxab25lcy5maW5kKHpvbmUgPT4gem9uZS5tYW5hZ2VkWm9uZXMuaW5jbHVkZXMoJ2RlZmF1bHQnKSkpIHtcbiAgICAgICAgICAgIC8vIEFkZCBpbnRvIHRoZSBkZWZhdWx0IHpvbmUgaWYgbm8gdmFsaWQgem9uZSBjb3VsZCBiZSBmb3VuZC5cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUGxlYXNlIGRlZmluZSBhIFwiZGVmYXVsdFwiIHpvbmUgaW4geW91ciB0ZW1wbGF0ZS4nKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBIaWRlIGFsbCBjb21wb25lbnRzLlxuICAgICAqL1xuICAgIGFzeW5jIHN0b3AoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIHRoaXMuY29tcG9uZW50cy52YWx1ZXMoKSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIGNvbXBvbmVudCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHpvbmUgPSBub2RlLmFuY2VzdG9yKFpvbmVOb2RlKTtcbiAgICAgICAgICAgICAgICBpZiAoem9uZSkge1xuICAgICAgICAgICAgICAgICAgICB6b25lLmhpZGUobm9kZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29tcG9uZW50RGVmaW5pdGlvbnMgPSB7fTtcbiAgICAgICAgdGhpcy5jb21wb25lbnRab25lcyA9IHt9O1xuICAgICAgICB0aGlzLmNvbXBvbmVudHMuY2xlYXIoKTtcbiAgICAgICAgdGhpcy5yb290LmVtcHR5KCk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIExvYWQgdGhlIGdpdmVuIENvbXBvbmVudCBpbiB0aGlzIGxheW91dCBlbmdpbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50RGVmaW5pdGlvblxuICAgICAqL1xuICAgIGxvYWRDb21wb25lbnQoY29tcG9uZW50RGVmaW5pdGlvbjogQ29tcG9uZW50RGVmaW5pdGlvbik6IHZvaWQge1xuICAgICAgICB0aGlzLmNvbXBvbmVudERlZmluaXRpb25zW2NvbXBvbmVudERlZmluaXRpb24uaWRdID0gY29tcG9uZW50RGVmaW5pdGlvbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTG9hZCBjb21wb25lbnQgem9uZXMgaW4gdGhpcyBsYXlvdXQgZW5naW5lLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbXBvbmVudFpvbmVzXG4gICAgICovXG4gICAgbG9hZENvbXBvbmVudFpvbmVzKGNvbXBvbmVudFpvbmVzOiBSZWNvcmQ8Q29tcG9uZW50SWQsIFpvbmVJZGVudGlmaWVyPik6IHZvaWQge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuY29tcG9uZW50Wm9uZXMsIGNvbXBvbmVudFpvbmVzKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgdGhlIGdpdmVuIG5vZGUgaW4gdGhlIGdpdmVuIHpvbmUgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UsIGFkZCBpdCBpblxuICAgICAqIHRoZSBkZWZhdWx0IHpvbmUuXG4gICAgICogUmV0dXJuIGV2ZXJ5IGNyZWF0ZWQgaW5zdGFuY2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21wb25lbnREZWZpbml0aW9uXG4gICAgICogQHBhcmFtIHpvbmVJZFxuICAgICAqL1xuICAgIGFzeW5jIGFkZChjb21wb25lbnRJZDogQ29tcG9uZW50SWQsIHpvbmVJZDogWm9uZUlkZW50aWZpZXIpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgYWxsWm9uZXMgPSBbdGhpcy5yb290LCAuLi50aGlzLnJvb3QuZGVzY2VuZGFudHMoWm9uZU5vZGUpXTtcbiAgICAgICAgbGV0IG1hdGNoaW5nWm9uZXMgPSBhbGxab25lcy5maWx0ZXIobm9kZSA9PiBub2RlLm1hbmFnZWRab25lcy5pbmNsdWRlcyh6b25lSWQpKTtcbiAgICAgICAgaWYgKCFtYXRjaGluZ1pvbmVzLmxlbmd0aCkge1xuICAgICAgICAgICAgbWF0Y2hpbmdab25lcyA9IGFsbFpvbmVzLmZpbHRlcih6b25lID0+IHpvbmUubWFuYWdlZFpvbmVzLmluY2x1ZGVzKCdkZWZhdWx0JykpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudERlZmluaXRpb24gPSB0aGlzLmNvbXBvbmVudERlZmluaXRpb25zW2NvbXBvbmVudElkXTtcbiAgICAgICAgY29uc3QgbmV3Q29tcG9uZW50cyA9IGF3YWl0IHRoaXMuX2luc3RhbnRpYXRlQ29tcG9uZW50KGNvbXBvbmVudERlZmluaXRpb24sIG1hdGNoaW5nWm9uZXMpO1xuICAgICAgICByZXR1cm4gdGhpcy5fZmlsbFpvbmVzKG5ld0NvbXBvbmVudHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKlxuICAgICAqIFJlbW92ZSB0aGUgY29tcG9uZW50IGlkZW50aWZpZWQgYnkgdGhlIGdpdmVuIHJlZmVyZW5jZSBmcm9tIGFsbCB6b25lcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjb21wb25lbnRJZFxuICAgICAqL1xuICAgIGFzeW5jIHJlbW92ZShjb21wb25lbnRJZDogQ29tcG9uZW50SWQpOiBQcm9taXNlPFpvbmVOb2RlW10+IHtcbiAgICAgICAgY29uc3QgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cy5nZXQoY29tcG9uZW50SWQpIHx8IFtdO1xuICAgICAgICBjb25zdCB6b25lczogWm9uZU5vZGVbXSA9IFtdO1xuICAgICAgICBsZXQgY29tcG9uZW50OiBWTm9kZTtcbiAgICAgICAgd2hpbGUgKChjb21wb25lbnQgPSBjb21wb25lbnRzLnBvcCgpKSkge1xuICAgICAgICAgICAgLy8gUmVtb3ZlIGFsbCBpbnN0YW5jZXMgaW4gdGhlIHpvbmUgY2hpbGRyZW4uXG4gICAgICAgICAgICBmb3IgKGNvbnN0IHpvbmUgb2YgY29tcG9uZW50LmRlc2NlbmRhbnRzKFpvbmVOb2RlKSkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2Ygem9uZS5jaGlsZHJlbigpKSB7XG4gICAgICAgICAgICAgICAgICAgIHpvbmUucmVtb3ZlQ2hpbGQoY2hpbGQpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzID0gY29tcG9uZW50WzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGVzLmluY2x1ZGVzKGNoaWxkKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLnNwbGljZShub2Rlcy5pbmRleE9mKGNoaWxkKSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIGluc3RhbmNlLlxuICAgICAgICAgICAgY29uc3Qgem9uZSA9IGNvbXBvbmVudC5hbmNlc3Rvcihab25lTm9kZSk7XG4gICAgICAgICAgICBpZiAoem9uZSAmJiAhem9uZXMuaW5jbHVkZXMoem9uZSkpIHtcbiAgICAgICAgICAgICAgICB6b25lcy5wdXNoKHpvbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29tcG9uZW50LnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB6b25lcztcbiAgICB9XG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBTaG93IHRoZSBjb21wb25lbnRzIGNvcnJlc3BvbmRpbmcgdG8gZ2l2ZW4gcmVmLiBSZXR1cm4gdGhlIHVwZGF0ZWQgem9uZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50SWRcbiAgICAgKi9cbiAgICBhc3luYyBzaG93KGNvbXBvbmVudElkOiBDb21wb25lbnRJZCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCBjb21wb25lbnRzID0gdGhpcy5jb21wb25lbnRzLmdldChjb21wb25lbnRJZCk7XG4gICAgICAgIGlmICghY29tcG9uZW50cz8ubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ05vIGNvbXBvbmVudCB0byBzaG93LiBBZGQgaXQgaW4gYSB6b25lIGZpcnN0LicpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIGNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHpvbmUgPSBjb21wb25lbnQuYW5jZXN0b3IoWm9uZU5vZGUpO1xuICAgICAgICAgICAgem9uZS5zaG93KGNvbXBvbmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvbXBvbmVudHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqXG4gICAgICogSGlkZSB0aGUgY29tcG9uZW50cyBjb3JyZXNwb25kaW5nIHRvIGdpdmVuIHJlZi4gUmV0dXJuIHRoZSB1cGRhdGVkIHpvbmVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNvbXBvbmVudElkXG4gICAgICovXG4gICAgYXN5bmMgaGlkZShjb21wb25lbnRJZDogQ29tcG9uZW50SWQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cy5nZXQoY29tcG9uZW50SWQpIHx8IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGNvbXBvbmVudCBvZiBjb21wb25lbnRzKSB7XG4gICAgICAgICAgICBjb25zdCB6b25lID0gY29tcG9uZW50LmFuY2VzdG9yKFpvbmVOb2RlKTtcbiAgICAgICAgICAgIHpvbmUuaGlkZShjb21wb25lbnQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb21wb25lbnRzO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgcHJpdmF0ZSBhc3luYyBfZmlsbFpvbmVzKG5vZGVzOiBWTm9kZVtdKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IG5ld0NvbXBvbmVudHM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgY29uc3Qgc3RhY2sgPSBbLi4ubm9kZXNdO1xuICAgICAgICB3aGlsZSAoc3RhY2subGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBub2RlID0gc3RhY2sucG9wKCk7XG4gICAgICAgICAgICBjb25zdCB6b25lcyA9IG5vZGUuZGVzY2VuZGFudHMoWm9uZU5vZGUpO1xuICAgICAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBab25lTm9kZSkge1xuICAgICAgICAgICAgICAgIHpvbmVzLnB1c2gobm9kZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoY29uc3QgY29tcG9uZW50SWQgaW4gdGhpcy5jb21wb25lbnREZWZpbml0aW9ucykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHpvbmVJZCA9IHRoaXMuY29tcG9uZW50Wm9uZXNbY29tcG9uZW50SWRdO1xuICAgICAgICAgICAgICAgIGlmICh6b25lSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGF5b3V0Q29tcG9uZW50ID0gdGhpcy5jb21wb25lbnREZWZpbml0aW9uc1tjb21wb25lbnRJZF07XG4gICAgICAgICAgICAgICAgICAgIC8vIEZpbHRlciB0aGUgem9uZXMgY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gaWRlbnRpZmllci5cbiAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoaW5nWm9uZXMgPSB6b25lcy5maWx0ZXIoem9uZSA9PiB6b25lLm1hbmFnZWRab25lcy5pbmNsdWRlcyh6b25lSWQpKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29tcG9uZW50cyA9IHRoaXMuY29tcG9uZW50cy5nZXQoY29tcG9uZW50SWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRXhjbHVkaW5nIHRoZSBvbmVzIHRoYXQgYXJlIGNvbnRhaW5lZCB3aXRoaW4gdGhlIGdpdmVuIG5vZGUuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhdm9pZCBsb29wIHdpdGggY2hpbGQgaW4gaXRzZWxmLlxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hpbmdab25lcyA9IG1hdGNoaW5nWm9uZXMuZmlsdGVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvbmUgPT4gIXpvbmUuY2xvc2VzdChhbmNlc3RvciA9PiBjb21wb25lbnRzLmluY2x1ZGVzKGFuY2VzdG9yKSksXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHN0YWNrLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICAuLi4oYXdhaXQgdGhpcy5faW5zdGFudGlhdGVDb21wb25lbnQobGF5b3V0Q29tcG9uZW50LCBtYXRjaGluZ1pvbmVzKSksXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3Q29tcG9uZW50cy5wdXNoKG5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXdDb21wb25lbnRzO1xuICAgIH1cbiAgICBwcml2YXRlIGFzeW5jIF9pbnN0YW50aWF0ZUNvbXBvbmVudChcbiAgICAgICAgY29tcG9uZW50RGVmaW5pdGlvbjogQ29tcG9uZW50RGVmaW5pdGlvbixcbiAgICAgICAgem9uZXM6IFpvbmVOb2RlW10sXG4gICAgKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGNvbXBvbmVudHMgPSB0aGlzLmNvbXBvbmVudHMuZ2V0KGNvbXBvbmVudERlZmluaXRpb24uaWQpIHx8IFtdO1xuICAgICAgICAvLyBBZGQgaW50byB0aGUgY29udGFpbmVyLlxuICAgICAgICBjb25zdCBuZXdDb21wb25lbnRzOiBWTm9kZVtdID0gW107XG4gICAgICAgIGZvciAoY29uc3Qgem9uZSBvZiB6b25lcykge1xuICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBhd2FpdCBjb21wb25lbnREZWZpbml0aW9uLnJlbmRlcih0aGlzLmVkaXRvcik7XG4gICAgICAgICAgICBjb21wb25lbnRzLnB1c2goLi4ubm9kZXMpO1xuICAgICAgICAgICAgbmV3Q29tcG9uZW50cy5wdXNoKC4uLm5vZGVzKTtcbiAgICAgICAgICAgIHpvbmUuYXBwZW5kKC4uLm5vZGVzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNldCB0aGUgbG9jYWwgcmVmZXJlbmNlLlxuICAgICAgICB0aGlzLmNvbXBvbmVudHMuc2V0KGNvbXBvbmVudERlZmluaXRpb24uaWQsIGNvbXBvbmVudHMpO1xuXG4gICAgICAgIC8vIFJldHVybiB0aGUgY29tcG9uZW50cyB0aGF0IHdlcmUgbmV3bHkgY3JlYXRlZC5cbiAgICAgICAgcmV0dXJuIG5ld0NvbXBvbmVudHM7XG4gICAgfVxufVxuZXhwb3J0IHR5cGUgTGF5b3V0RW5naW5lQ29uc3RydWN0b3IgPSB7XG4gICAgbmV3IChlZGl0b3I6IEpXRWRpdG9yKTogTGF5b3V0RW5naW5lO1xufTtcbiIsImltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5cbmV4cG9ydCB0eXBlIFpvbmVJZGVudGlmaWVyID0gc3RyaW5nO1xuXG5leHBvcnQgY2xhc3MgWm9uZU5vZGUgZXh0ZW5kcyBDb250YWluZXJOb2RlIHtcbiAgICBoaWRkZW46IE1hcDxWTm9kZSwgYm9vbGVhbj4gPSBuZXcgTWFwKCk7XG4gICAgYnJlYWthYmxlID0gZmFsc2U7XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgbWFuYWdlZFpvbmVzOiBab25lSWRlbnRpZmllcltdKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgfVxuXG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLm5hbWUgKyAnOiAnICsgdGhpcy5tYW5hZ2VkWm9uZXMuam9pbigpO1xuICAgIH1cblxuICAgIGhpZGUoY2hpbGQ6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIHRoaXMuaGlkZGVuLnNldChjaGlsZCwgdHJ1ZSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgc2hvdyhjaGlsZDogVk5vZGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5oaWRkZW4uc2V0KGNoaWxkLCBmYWxzZSk7XG4gICAgICAgIGNvbnN0IHBhcmVudFpvbmU6IFpvbmVOb2RlID0gdGhpcy5hbmNlc3Rvcihab25lTm9kZSk7XG4gICAgICAgIGlmIChwYXJlbnRab25lKSB7XG4gICAgICAgICAgICBwYXJlbnRab25lLnNob3codGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgX3JlbW92ZUF0SW5kZXgoaW5kZXg6IG51bWJlcik6IHZvaWQge1xuICAgICAgICBjb25zdCBjaGlsZCA9IHRoaXMuY2hpbGRWTm9kZXNbaW5kZXhdO1xuICAgICAgICBzdXBlci5fcmVtb3ZlQXRJbmRleChpbmRleCk7XG4gICAgICAgIHRoaXMuaGlkZGVuLmRlbGV0ZShjaGlsZCk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgTGluZUJyZWFrTm9kZSB9IGZyb20gJy4vTGluZUJyZWFrTm9kZSc7XG5pbXBvcnQgeyBMaW5lQnJlYWtYbWxEb21QYXJzZXIgfSBmcm9tICcuL0xpbmVCcmVha1htbERvbVBhcnNlcic7XG5pbXBvcnQgeyBMaW5lQnJlYWtIdG1sRG9tUmVuZGVyZXIgfSBmcm9tICcuL0xpbmVCcmVha0h0bWxEb21SZW5kZXJlcic7XG5pbXBvcnQgeyBDb3JlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvQ29yZSc7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcblxuZXhwb3J0IGNsYXNzIExpbmVCcmVhazxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbTGluZUJyZWFrWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbTGluZUJyZWFrSHRtbERvbVJlbmRlcmVyXSxcbiAgICB9O1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBpbnNlcnRMaW5lQnJlYWs6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuaW5zZXJ0TGluZUJyZWFrLFxuICAgICAgICB9LFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0IGEgbGluZSBicmVhayBub2RlIGF0IHJhbmdlLlxuICAgICAqL1xuICAgIGluc2VydExpbmVCcmVhaygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWRpdG9yLmV4ZWNDb21tYW5kPENvcmU+KCdpbnNlcnQnLCB7XG4gICAgICAgICAgICBub2RlOiBuZXcgTGluZUJyZWFrTm9kZSgpLFxuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IExpbmVCcmVha05vZGUgfSBmcm9tICcuL0xpbmVCcmVha05vZGUnO1xuaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIExpbmVCcmVha0h0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gTGluZUJyZWFrTm9kZTtcblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgVk5vZGUgdG8gdGhlIGdpdmVuIGZvcm1hdC5cbiAgICAgKi9cbiAgICBhc3luYyByZW5kZXIobm9kZTogTGluZUJyZWFrTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGJyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnInKTtcbiAgICAgICAgdGhpcy5lbmdpbmUucmVuZGVyQXR0cmlidXRlcyhBdHRyaWJ1dGVzLCBub2RlLCBicik7XG4gICAgICAgIGNvbnN0IHJlbmRlcmluZyA9IFticl07XG4gICAgICAgIGlmICghbm9kZS5uZXh0U2libGluZygpKSB7XG4gICAgICAgICAgICAvLyBJZiBhIExpbmVCcmVha05vZGUgaGFzIG5vIG5leHQgc2libGluZywgaXQgbXVzdCBiZSByZW5kZXJlZFxuICAgICAgICAgICAgLy8gYXMgdHdvIEJScyBpbiBvcmRlciBmb3IgaXQgdG8gYmUgdmlzaWJsZS5cbiAgICAgICAgICAgIHJlbmRlcmluZy5wdXNoKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2JyJykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZW5kZXJpbmc7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUmVsYXRpdmVQb3NpdGlvbiB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBTZXBhcmF0b3JOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1NlcGFyYXRvck5vZGUnO1xuXG5leHBvcnQgY2xhc3MgTGluZUJyZWFrTm9kZSBleHRlbmRzIFNlcGFyYXRvck5vZGUge1xuICAgIGdldCBuYW1lKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiAn4oayJztcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gTGlmZWN5Y2xlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogVHJhbnNmb3JtIHRoZSBnaXZlbiBET00gbG9jYXRpb24gaW50byBpdHMgVkRvY3VtZW50IGNvdW50ZXJwYXJ0LlxuICAgICAqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICogQHBhcmFtIGRvbU5vZGUgRE9NIG5vZGUgY29ycmVzcG9uZGluZyB0byB0aGlzIFZOb2RlXG4gICAgICogQHBhcmFtIG9mZnNldCBUaGUgb2Zmc2V0IG9mIHRoZSBsb2NhdGlvbiBpbiB0aGUgZ2l2ZW4gZG9tTm9kZVxuICAgICAqL1xuICAgIGxvY2F0ZShkb21Ob2RlOiBOb2RlLCBvZmZzZXQ6IG51bWJlcik6IFt0aGlzLCBSZWxhdGl2ZVBvc2l0aW9uXSB7XG4gICAgICAgIGNvbnN0IGxvY2F0aW9uID0gc3VwZXIubG9jYXRlKGRvbU5vZGUsIG9mZnNldCk7XG4gICAgICAgIC8vIFdoZW4gY2xpY2tpbmcgb24gYSB0cmFpbGluZyBsaW5lIGJyZWFrLCB3ZSBuZWVkIHRvIHRhcmdldCBhZnRlciB0aGVcbiAgICAgICAgLy8gbGluZSBicmVhay4gVGhlIERPTSByZXByZXNlbnRzIHRoZXNlIGFzIDIgPGJyPiBzbyB0aGlzIGlzIGEgc3BlY2lhbFxuICAgICAgICAvLyBjYXNlLlxuICAgICAgICBpZiAoIXRoaXMubmV4dFNpYmxpbmcoKSAmJiAhZG9tTm9kZS5uZXh0U2libGluZykge1xuICAgICAgICAgICAgbG9jYXRpb25bMV0gPSBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsb2NhdGlvbjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBMaW5lQnJlYWtOb2RlIH0gZnJvbSAnLi9MaW5lQnJlYWtOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgaXNCbG9jayB9IGZyb20gJy4uLy4uL3V0aWxzL3NyYy9pc0Jsb2NrJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIExpbmVCcmVha1htbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ0JSJztcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8TGluZUJyZWFrTm9kZVtdPiB7XG4gICAgICAgIGlmICh0aGlzLl9pc0ludmlzaWJsZUJSKGl0ZW0pKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbGluZUJyZWFrID0gbmV3IExpbmVCcmVha05vZGUoKTtcbiAgICAgICAgbGluZUJyZWFrLm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcbiAgICAgICAgcmV0dXJuIFtsaW5lQnJlYWtdO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIDxici8+IG5vZGUgaXMgaW52aXNpYmxlLiBBIDxici8+IGF0IHRoZSBlbmQgZWRnZVxuICAgICAqIG9mIGEgYmxvY2sgb3IgYmVmb3JlIGFub3RoZXIgYmxvY2sgaXMgdGhlcmUgb25seSB0byBtYWtlIGl0cyBwYXJlbnRcbiAgICAgKiB2aXNpYmxlLiBDb25zdW1lIGl0IHNpbmNlIGl0IHdhcyBqdXN0IHBhcnNlZCBhcyBpdHMgcGFyZW50IGVsZW1lbnQgbm9kZS5cbiAgICAgKiBUT0RPOiBhY2NvdW50IGZvciBmb3JtYXR0aW5nIHNwYWNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBfaXNJbnZpc2libGVCUihub2RlOiBOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgIC8vIFNlYXJjaCBmb3IgYW5vdGhlciBub24tYmxvY2sgY291c2luIGluIHRoZSBzYW1lIGJsb2NrIHBhcmVudC5cbiAgICAgICAgd2hpbGUgKG5vZGUgJiYgIW5vZGUubmV4dFNpYmxpbmcgJiYgbm9kZS5wYXJlbnROb2RlICYmICFpc0Jsb2NrKG5vZGUucGFyZW50Tm9kZSkpIHtcbiAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICFub2RlIHx8ICFub2RlLm5leHRTaWJsaW5nIHx8IGlzQmxvY2sobm9kZS5uZXh0U2libGluZyk7XG4gICAgfVxufVxuIiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZXM+XFxuICAgIDxkaXYgdC1uYW1lPVxcXCJsaW5rXFxcIj5cXG4gICAgICAgIDxoMj5JbnNlcnQgYSBsaW5rPC9oMj5cXG4gICAgICAgIDx0YWJsZSBjbGFzcz1cXFwiZm9ybS10YWJsZVxcXCI+XFxuICAgICAgICAgICAgPHRyPlxcbiAgICAgICAgICAgICAgICA8dGQ+PGxhYmVsIGZvcj1cXFwibGlua1VybFxcXCI+VVJMIDwvbGFiZWw+PC90ZD5cXG4gICAgICAgICAgICAgICAgPHRkPjxpbnB1dCB0eXBlPVxcXCJ0ZXh0XFxcIiBpZD1cXFwibGlua1VybFxcXCIgbmFtZT1cXFwidXJsXFxcIiB0LW1vZGVsPVxcXCJzdGF0ZS51cmxcXFwiLz48L3RkPlxcbiAgICAgICAgICAgIDwvdHI+XFxuICAgICAgICAgICAgPHRyPlxcbiAgICAgICAgICAgICAgICA8dGQ+PGxhYmVsIGZvcj1cXFwibGlua0xhYmVsXFxcIj5MYWJlbCA8L2xhYmVsPjwvdGQ+XFxuICAgICAgICAgICAgICAgIDx0ZD48aW5wdXQgdHlwZT1cXFwidGV4dFxcXCIgaWQ9XFxcImxpbmtMYWJlbFxcXCIgbmFtZT1cXFwibGFiZWxcXFwiIHQtbW9kZWw9XFxcInN0YXRlLmxhYmVsXFxcIi8+PC90ZD5cXG4gICAgICAgICAgICA8L3RyPlxcbiAgICAgICAgPC90YWJsZT5cXG4gICAgICAgIDxici8+XFxuICAgICAgICA8YnV0dG9uIG5hbWU9XFxcInNhdmVcXFwiIHQtb24tY2xpY2s9XFxcInNhdmVMaW5rKClcXFwiPlNhdmU8L2J1dHRvbj4gPGJ1dHRvbiBuYW1lPVxcXCJzYXZlXFxcIiB0LW9uLWNsaWNrPVxcXCJjYW5jZWwoKVxcXCI+Q2FuY2VsPC9idXR0b24+XFxuICAgIDwvZGl2PlxcbjwvdGVtcGxhdGVzPlxcblwiIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IExpbmtYbWxEb21QYXJzZXIgfSBmcm9tICcuL0xpbmtYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgSW5saW5lTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZU5vZGUnO1xuaW1wb3J0IHsgTGlua0Zvcm1hdCB9IGZyb20gJy4vTGlua0Zvcm1hdCc7XG5pbXBvcnQgeyBDaGFyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWNoYXIvc3JjL0NoYXInO1xuaW1wb3J0IHsgTW9kaWZpZXJzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXJzJztcbmltcG9ydCB7IFZOb2RlLCBUeXBlZ3VhcmQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQWJzdHJhY3ROb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0Fic3RyYWN0Tm9kZSc7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgS2V5bWFwIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgbGlua0Zvcm0gZnJvbSAnLi4vYXNzZXRzL0xpbmtGb3JtLnhtbCc7XG5pbXBvcnQgeyBPd2wgfSBmcm9tICcuLi8uLi9wbHVnaW4tb3dsL3NyYy9Pd2wnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuXG5leHBvcnQgaW50ZXJmYWNlIExpbmtQYXJhbXMgZXh0ZW5kcyBDb21tYW5kUGFyYW1zIHtcbiAgICAvKipcbiAgICAgKiBUaGUgbGFiZWwgb2YgdGhlIGxpbmtcbiAgICAgKi9cbiAgICBsYWJlbD86IHN0cmluZztcbiAgICAvKipcbiAgICAgKiBUaGUgdXJsIG9mIHRoZSBsaW5rXG4gICAgICovXG4gICAgdXJsPzogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIFRoZSB0YXJnZXQgb2YgYW4gaHRtbCBhbmNob3IuXG4gICAgICogQ291bGQgYmUgXCJfYmxhbmtcIiwgXCJfc2VsZlwiICxcIl9wYXJlbnRcIiwgXCJfdG9wXCIgb3IgdGhlIGZyYW1lbmFtZS5cbiAgICAgKi9cbiAgICB0YXJnZXQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBMaW5rPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICAvKipcbiAgICAgKiBDaGVjayB3ZXRoZXIgdGhlIG5vZGUgb3IgdGhlIGZvcm1hdCBpcyBhIGxpbmsuXG4gICAgICovXG4gICAgc3RhdGljIGlzTGluayhub2RlOiBWTm9kZSk6IG5vZGUgaXMgSW5saW5lTm9kZTtcbiAgICBzdGF0aWMgaXNMaW5rKGxpbms6IExpbmtGb3JtYXQsIG5vZGU6IFZOb2RlKTogbm9kZSBpcyBJbmxpbmVOb2RlO1xuICAgIHN0YXRpYyBpc0xpbmsobGluazogTGlua0Zvcm1hdCB8IFZOb2RlLCBub2RlPzogVk5vZGUpOiBub2RlIGlzIElubGluZU5vZGUge1xuICAgICAgICBpZiAobGluayBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSkge1xuICAgICAgICAgICAgbm9kZSA9IGxpbms7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZm9ybWF0ID0gbm9kZS5pcyhJbmxpbmVOb2RlKSAmJiBub2RlLm1vZGlmaWVycy5maW5kKExpbmtGb3JtYXQpO1xuICAgICAgICByZXR1cm4gbGluayBpbnN0YW5jZW9mIEFic3RyYWN0Tm9kZSA/ICEhZm9ybWF0IDogZm9ybWF0ID09PSBsaW5rO1xuICAgIH1cbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW0lubGluZV07XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIGxpbms6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMubGluayxcbiAgICAgICAgfSxcbiAgICAgICAgdW5saW5rOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnVubGluayxcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIEtleW1hcCAmIExheW91dCAmIE93bD4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtMaW5rWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgc2hvcnRjdXRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrSycsXG4gICAgICAgICAgICAgICAgc2VsZWN0b3I6IFsobm9kZTogVk5vZGUpOiBib29sZWFuID0+ICFMaW5rLmlzTGluayhub2RlKV0sXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnbGluaycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK0snLFxuICAgICAgICAgICAgICAgIHNlbGVjdG9yOiBbTGluay5pc0xpbmtdLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3VubGluaycsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICAvLyBjb21wb25lbnRab25lczogW1snbGluaycsICdmbG9hdCddXSxcbiAgICAgICAgb3dsVGVtcGxhdGVzOiBbbGlua0Zvcm1dLFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgYXN5bmMgbGluayhwYXJhbXM6IExpbmtQYXJhbXMpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgLy8gLy8gSWYgdGhlIHVybCBpcyB1bmRlZmluZWQsIGFzayB0aGUgdXNlciB0byBwcm92aWRlIG9uZS5cbiAgICAgICAgLy8gaWYgKCFwYXJhbXMudXJsKSB7XG4gICAgICAgIC8vICAgICBjb25zdCBsYXlvdXQgPSB0aGlzLmVkaXRvci5wbHVnaW5zLmdldChMYXlvdXQpO1xuICAgICAgICAvLyAgICAgYXdhaXQgbGF5b3V0LnJlbW92ZSgnbGluaycpO1xuICAgICAgICAvLyAgICAgYXdhaXQgbGF5b3V0LmFkZCgnbGluaycpO1xuXG4gICAgICAgIC8vICAgICByZXR1cm4gdGhpcy5lZGl0b3IuZXhlY0NvbW1hbmQoJ3Nob3cnLCB7IGNvbXBvbmVudElEOiAnbGluaycgfSk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICBjb25zdCBsaW5rID0gbmV3IExpbmtGb3JtYXQocGFyYW1zLnVybCk7XG4gICAgICAgIGlmIChwYXJhbXMudGFyZ2V0KSB7XG4gICAgICAgICAgICBsaW5rLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc2V0KCd0YXJnZXQnLCBwYXJhbXMudGFyZ2V0KTtcbiAgICAgICAgfVxuICAgICAgICAvLyAvLyBUT0RPOiBtb2RhbCByZS11c2luZyB1cmxcbiAgICAgICAgLy8gaWYgKCFsaW5rKSByZXR1cm47XG5cbiAgICAgICAgLy8gaWYgKHJhbmdlLmlzQ29sbGFwc2VkKCkpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3BhcmFtczonLCBwYXJhbXMpO1xuICAgICAgICBjb25zb2xlLmxvZygnbGluazonLCBsaW5rKTtcbiAgICAgICAgdGhpcy5lZGl0b3IuZXhlY0NvbW1hbmQ8Q2hhcj4oJ2luc2VydFRleHQnLCB7XG4gICAgICAgICAgICB0ZXh0OiBwYXJhbXMubGFiZWwgfHwgbGluay51cmwsXG4gICAgICAgICAgICBmb3JtYXRzOiBuZXcgTW9kaWZpZXJzKGxpbmspLFxuICAgICAgICAgICAgc2VsZWN0OiB0cnVlLFxuICAgICAgICAgICAgY29udGV4dDogcGFyYW1zLmNvbnRleHQsXG4gICAgICAgIH0pO1xuICAgICAgICAvLyB9IGVsc2Uge1xuICAgICAgICAvLyAgICAgZm9yIChjb25zdCBpbmxpbmUgb2Ygc2VsZWN0ZWRJbmxpbmVzKSB7XG4gICAgICAgIC8vICAgICAgICAgaW5saW5lLmZvcm1hdHMucmVwbGFjZShMaW5rRm9ybWF0LCBsaW5rKTtcbiAgICAgICAgLy8gICAgIH1cbiAgICAgICAgLy8gfVxuICAgIH1cbiAgICB1bmxpbmsocGFyYW1zOiBMaW5rUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IG5vZGUgPSByYW5nZS5zdGFydC5wcmV2aW91c1NpYmxpbmcoKSB8fCByYW5nZS5zdGFydC5uZXh0U2libGluZygpO1xuICAgICAgICBpZiAoIW5vZGUuaXMoSW5saW5lTm9kZSkpIHJldHVybjtcblxuICAgICAgICBjb25zdCBsaW5rID0gbm9kZS5tb2RpZmllcnMuZmluZChMaW5rRm9ybWF0KTtcbiAgICAgICAgaWYgKCFsaW5rKSByZXR1cm47XG5cbiAgICAgICAgY29uc3Qgc2FtZUxpbms6IFR5cGVndWFyZDxJbmxpbmVOb2RlPiA9IExpbmsuaXNMaW5rLmJpbmQoTGluaywgbGluayk7XG4gICAgICAgIGZvciAoY29uc3QgaW5saW5lIG9mIFtub2RlLCAuLi5ub2RlLmFkamFjZW50cyhzYW1lTGluayldKSB7XG4gICAgICAgICAgICBpbmxpbmUubW9kaWZpZXJzLnJlbW92ZShsaW5rKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdCc7XG5cbmV4cG9ydCBjbGFzcyBMaW5rRm9ybWF0IGV4dGVuZHMgRm9ybWF0IHtcbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgdXJsID0gJyMnLCBwdWJsaWMgdGFyZ2V0ID0gJycpIHtcbiAgICAgICAgc3VwZXIoJ0EnKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgcmVuZGVyKCk6IEVsZW1lbnQge1xuICAgICAgICBjb25zdCBlbGVtZW50ID0gc3VwZXIucmVuZGVyKCk7XG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdocmVmJywgdGhpcy51cmwpO1xuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBjbG9uZSgpOiB0aGlzIHtcbiAgICAgICAgY29uc3QgY2xvbmUgPSBzdXBlci5jbG9uZSgpO1xuICAgICAgICBjbG9uZS51cmwgPSB0aGlzLnVybDtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEZvcm1hdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBMaW5rRm9ybWF0IH0gZnJvbSAnLi9MaW5rRm9ybWF0JztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIExpbmtYbWxEb21QYXJzZXIgZXh0ZW5kcyBGb3JtYXRQYXJzZXIge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIG5vZGVOYW1lKGl0ZW0pID09PSAnQSc7XG4gICAgfTtcblxuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgbGluayA9IG5ldyBMaW5rRm9ybWF0KGl0ZW0uZ2V0QXR0cmlidXRlKCdocmVmJykpO1xuICAgICAgICBsaW5rLm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcbiAgICAgICAgbGluay5tb2RpZmllcnMuZmluZChBdHRyaWJ1dGVzKT8ucmVtb3ZlKCdocmVmJyk7IC8vIGhyZWYgaXMgb24gbGluay51cmxcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KGxpbmssIGNoaWxkcmVuKTtcblxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgTGlzdE5vZGUsIExpc3RUeXBlIH0gZnJvbSAnLi9MaXN0Tm9kZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBMaXN0SHRtbERvbVJlbmRlcmVyIH0gZnJvbSAnLi9MaXN0SHRtbERvbVJlbmRlcmVyJztcbmltcG9ydCB7IExpc3RJdGVtSHRtbERvbVJlbmRlcmVyIH0gZnJvbSAnLi9MaXN0SXRlbUh0bWxEb21SZW5kZXJlcic7XG5pbXBvcnQgeyBMaXN0WG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9MaXN0WG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IExpc3RJdGVtWG1sRG9tUGFyc2VyLCBMaXN0SXRlbUF0dHJpYnV0ZXMgfSBmcm9tICcuL0xpc3RJdGVtWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IHdpdGhSYW5nZSwgVlJhbmdlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVlJhbmdlJztcbmltcG9ydCB7IEluZGVudFBhcmFtcywgT3V0ZGVudFBhcmFtcyB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmRlbnQvc3JjL0luZGVudCc7XG5pbXBvcnQgeyBDaGVja2luZ0NvbnRleHQgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Db250ZXh0TWFuYWdlcic7XG5pbXBvcnQgeyBJbnNlcnRQYXJhZ3JhcGhCcmVha1BhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0NvcmUnO1xuaW1wb3J0IHsgRGVsZXRlQmFja3dhcmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Db3JlJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgS2V5bWFwIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IGRpc3RpbmN0IH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGludGVyZmFjZSBMaXN0UGFyYW1zIGV4dGVuZHMgQ29tbWFuZFBhcmFtcyB7XG4gICAgdHlwZTogTGlzdFR5cGU7XG59XG5cbmV4cG9ydCBjbGFzcyBMaXN0PFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgaXNMaXN0SXRlbShub2RlOiBWTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gbm9kZS5wYXJlbnQgJiYgbm9kZS5wYXJlbnQuaXMoTGlzdE5vZGUpO1xuICAgIH1cbiAgICBzdGF0aWMgaXNJbkxpc3QodHlwZTogTGlzdFR5cGUsIG5vZGU6IFZOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBub2RlPy5hbmNlc3RvcihMaXN0Tm9kZSk/Lmxpc3RUeXBlID09PSB0eXBlO1xuICAgIH1cbiAgICBjb21tYW5kcyA9IHtcbiAgICAgICAgdG9nZ2xlTGlzdDoge1xuICAgICAgICAgICAgdGl0bGU6ICdUb2dnbGUgbGlzdCcsXG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnRvZ2dsZUxpc3QsXG4gICAgICAgIH0sXG4gICAgICAgIGluZGVudDoge1xuICAgICAgICAgICAgdGl0bGU6ICdJbmRlbnQgbGlzdCBpdGVtcycsXG4gICAgICAgICAgICBzZWxlY3RvcjogW0xpc3ROb2RlXSxcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuaW5kZW50LFxuICAgICAgICB9LFxuICAgICAgICBvdXRkZW50OiB7XG4gICAgICAgICAgICB0aXRsZTogJ091dGRlbnQgbGlzdCBpdGVtcycsXG4gICAgICAgICAgICBzZWxlY3RvcjogW0xpc3ROb2RlXSxcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMub3V0ZGVudCxcbiAgICAgICAgfSxcbiAgICAgICAgaW5zZXJ0UGFyYWdyYXBoQnJlYWs6IHtcbiAgICAgICAgICAgIHNlbGVjdG9yOiBbTGlzdE5vZGUsIExpc3QuaXNMaXN0SXRlbV0sXG4gICAgICAgICAgICBjaGVjazogKGNvbnRleHQ6IENoZWNraW5nQ29udGV4dCk6IGJvb2xlYW4gPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtsaXN0LCBsaXN0SXRlbV0gPSBjb250ZXh0LnNlbGVjdG9yO1xuICAgICAgICAgICAgICAgIHJldHVybiAhbGlzdEl0ZW0uaGFzQ2hpbGRyZW4oKSAmJiBsaXN0SXRlbSA9PT0gbGlzdC5sYXN0Q2hpbGQoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmluc2VydFBhcmFncmFwaEJyZWFrLFxuICAgICAgICB9LFxuICAgIH07XG4gICAgY29tbWFuZEhvb2tzID0ge1xuICAgICAgICAvLyBUT0RPOiByZXBsYWNlIHRoaXMgd2l0aCBgb25TaWJsaW5nc0NoYW5nZWAgd2hlbiB3ZSBpbnRyb2R1Y2UgZXZlbnRzLlxuICAgICAgICBkZWxldGVCYWNrd2FyZDogdGhpcy5yZWpvaW4uYmluZCh0aGlzKSxcbiAgICAgICAgZGVsZXRlRm9yd2FyZDogdGhpcy5yZWpvaW4uYmluZCh0aGlzKSxcbiAgICB9O1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyICYgS2V5bWFwPiA9IHtcbiAgICAgICAgcGFyc2VyczogW0xpc3RYbWxEb21QYXJzZXIsIExpc3RJdGVtWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbTGlzdEl0ZW1IdG1sRG9tUmVuZGVyZXIsIExpc3RIdG1sRG9tUmVuZGVyZXJdLFxuICAgICAgICBzaG9ydGN1dHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtTSElGVCs8RGlnaXQ3PicsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAndG9nZ2xlTGlzdCcsXG4gICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgdHlwZTogTGlzdFR5cGUuT1JERVJFRCB9IGFzIExpc3RQYXJhbXMsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1NISUZUKzxEaWdpdDg+JyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd0b2dnbGVMaXN0JyxcbiAgICAgICAgICAgICAgICBjb21tYW5kQXJnczogeyB0eXBlOiBMaXN0VHlwZS5VTk9SREVSRUQgfSBhcyBMaXN0UGFyYW1zLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQmFja3NwYWNlJyxcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogW0xpc3QuaXNMaXN0SXRlbV0sXG4gICAgICAgICAgICAgICAgY2hlY2s6IChjb250ZXh0OiBDaGVja2luZ0NvbnRleHQpOiBib29sZWFuID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICFjb250ZXh0LnJhbmdlLnN0YXJ0LnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnb3V0ZGVudCcsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0L3JlbW92ZSBhIGxpc3QgYXQgcmFuZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgdG9nZ2xlTGlzdChwYXJhbXM6IExpc3RQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdHlwZSA9IHBhcmFtcy50eXBlO1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuXG4gICAgICAgIHdpdGhSYW5nZShWUmFuZ2UuY2xvbmUocmFuZ2UpLCByYW5nZSA9PiB7XG4gICAgICAgICAgICAvLyBFeHRlbmQgdGhlIHJhbmdlIHRvIGNvdmVyIHRoZSBlbnRpcmV0eSBvZiBpdHMgY29udGFpbmVycy5cbiAgICAgICAgICAgIGlmIChyYW5nZS5zdGFydENvbnRhaW5lci5oYXNDaGlsZHJlbigpKSB7XG4gICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQocmFuZ2Uuc3RhcnRDb250YWluZXIuZmlyc3RDaGlsZCgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyYW5nZS5lbmRDb250YWluZXIuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgICAgIHJhbmdlLnNldEVuZChyYW5nZS5lbmRDb250YWluZXIubGFzdENoaWxkKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gSWYgYWxsIHRhcmdldGVkIG5vZGVzIGFyZSB3aXRoaW4gYSBsaXN0IG9mIGdpdmVuIHR5cGUgdGhlbiB1bmxpc3RcbiAgICAgICAgICAgIC8vIHRoZW0uIE90aGVyd2lzZSwgY29udmVydCB0aGVtIHRvIHRoZSBnaXZlbiBsaXN0IHR5cGUuXG4gICAgICAgICAgICBjb25zdCB0YXJnZXRlZE5vZGVzID0gcmFuZ2UudGFyZ2V0ZWROb2RlcygpO1xuICAgICAgICAgICAgY29uc3QgYW5jZXN0b3JzID0gdGFyZ2V0ZWROb2Rlcy5tYXAobm9kZSA9PiBub2RlLmNsb3Nlc3QoTGlzdE5vZGUpKTtcbiAgICAgICAgICAgIGNvbnN0IHRhcmdldGVkTGlzdHMgPSBhbmNlc3RvcnMuZmlsdGVyKGxpc3QgPT4gISFsaXN0KTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICB0YXJnZXRlZExpc3RzLmxlbmd0aCA9PT0gdGFyZ2V0ZWROb2Rlcy5sZW5ndGggJiZcbiAgICAgICAgICAgICAgICB0YXJnZXRlZExpc3RzLmV2ZXJ5KGxpc3QgPT4gbGlzdC5saXN0VHlwZSA9PT0gdHlwZSlcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgIC8vIFVubGlzdCB0aGUgdGFyZ2V0ZWQgbm9kZXMgZnJvbSBhbGwgaXRzIGxpc3QgYW5jZXN0b3JzLlxuICAgICAgICAgICAgICAgIHdoaWxlIChyYW5nZS5zdGFydC5hbmNlc3RvcihMaXN0Tm9kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm9kZXNUb1VubGlzdCA9IHJhbmdlLnNwbGl0KExpc3ROb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBsaXN0IG9mIG5vZGVzVG9Vbmxpc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbmVzdGVkTGlzdCBvZiBsaXN0LmRlc2NlbmRhbnRzKExpc3ROb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IGF1dG9tYXRpY2FsbHkgaW52YWxpZGF0ZSBgTGlzdEl0ZW1BdHRyaWJ1dGVzYC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIG5lc3RlZExpc3QuY2hpbGRWTm9kZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQubW9kaWZpZXJzLnJlbW92ZShMaXN0SXRlbUF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXN0ZWRMaXN0LnVud3JhcCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbGlzdC51bndyYXAoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0ZWRMaXN0cy5sZW5ndGggPT09IHRhcmdldGVkTm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgYWxsIG5vZGVzIGFyZSBpbiBsaXN0cywgY29udmVydCB0aGUgdGFyZ2V0ZWQgbGlzdFxuICAgICAgICAgICAgICAgIC8vIG5vZGVzIHRvIHRoZSBnaXZlbiBsaXN0IHR5cGUuXG4gICAgICAgICAgICAgICAgY29uc3QgbGlzdHMgPSBkaXN0aW5jdCh0YXJnZXRlZExpc3RzKTtcbiAgICAgICAgICAgICAgICBjb25zdCBsaXN0c1RvQ29udmVydCA9IGxpc3RzLmZpbHRlcihsID0+IGwubGlzdFR5cGUgIT09IHR5cGUpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbGlzdCBvZiBsaXN0c1RvQ29udmVydCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbmV3TGlzdCA9IG5ldyBMaXN0Tm9kZSh7IGxpc3RUeXBlOiB0eXBlIH0pO1xuICAgICAgICAgICAgICAgICAgICBsaXN0LnJlcGxhY2VXaXRoKG5ld0xpc3QpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSBuZXcgbGlzdCBpcyBhZnRlciBvciBiZWZvcmUgYSBsaXN0IG9mIHRoZSBzYW1lXG4gICAgICAgICAgICAgICAgICAgIC8vIHR5cGUsIG1lcmdlIHRoZW0uIEV4YW1wbGU6XG4gICAgICAgICAgICAgICAgICAgIC8vIDxvbD48bGk+YTwvbGk+PC9vbD48b2w+PGxpPmI8L2xpPjwvb2w+XG4gICAgICAgICAgICAgICAgICAgIC8vID0+IDxvbD48bGk+YTwvbGk+PGxpPmI8L2xpPjwvb2w+KS5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJldmlvdXNTaWJsaW5nID0gbmV3TGlzdC5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZpb3VzU2libGluZyAmJiBwcmV2aW91c1NpYmxpbmcuaXMoTGlzdE5vZGVbdHlwZV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdMaXN0Lm1lcmdlV2l0aChwcmV2aW91c1NpYmxpbmcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3TGlzdCA9IHByZXZpb3VzU2libGluZztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5leHRTaWJsaW5nID0gbmV3TGlzdC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dFNpYmxpbmcgJiYgbmV4dFNpYmxpbmcuaXMoTGlzdE5vZGVbdHlwZV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0U2libGluZy5tZXJnZVdpdGgobmV3TGlzdCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIElmIG9ubHkgc29tZSBub2RlcyBhcmUgaW4gbGlzdHMgYW5kIG90aGVyIGFyZW4ndCB0aGVuIG9ubHlcbiAgICAgICAgICAgICAgICAvLyB3cmFwIHRoZSBvbmVzIHRoYXQgd2VyZSBub3QgYWxyZWFkeSBpbiBhIGxpc3QgaW50byBhIGxpc3Qgb2ZcbiAgICAgICAgICAgICAgICAvLyB0aGUgZ2l2ZW4gdHlwZS5cbiAgICAgICAgICAgICAgICBsZXQgbmV3TGlzdCA9IG5ldyBMaXN0Tm9kZSh7IGxpc3RUeXBlOiB0eXBlIH0pO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5vZGVzVG9Db252ZXJ0ID0gcmFuZ2Uuc3BsaXQoTGlzdE5vZGUpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlc1RvQ29udmVydCkge1xuICAgICAgICAgICAgICAgICAgICBub2RlLndyYXAobmV3TGlzdCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIE1lcmdlIHRvcC1sZXZlbCBsaXN0cyBpbnN0ZWFkIG9mIG5lc3RpbmcgdGhlbS5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vZGUuaXMoTGlzdE5vZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBub2RlLm1lcmdlV2l0aChuZXdMaXN0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBuZXcgbGlzdCBpcyBhZnRlciBvciBiZWZvcmUgYSBsaXN0IG9mIHRoZSBzYW1lIHR5cGUsXG4gICAgICAgICAgICAgICAgLy8gbWVyZ2UgdGhlbS4gRXhhbXBsZTpcbiAgICAgICAgICAgICAgICAvLyA8b2w+PGxpPmE8L2xpPjwvb2w+PG9sPjxsaT5iPC9saT48L29sPlxuICAgICAgICAgICAgICAgIC8vID0+IDxvbD48bGk+YTwvbGk+PGxpPmI8L2xpPjwvb2w+KS5cbiAgICAgICAgICAgICAgICBjb25zdCBwcmV2aW91c1NpYmxpbmcgPSBuZXdMaXN0LnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2aW91c1NpYmxpbmcgJiYgcHJldmlvdXNTaWJsaW5nLmlzKExpc3ROb2RlW3R5cGVdKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXdMaXN0Lm1lcmdlV2l0aChwcmV2aW91c1NpYmxpbmcpO1xuICAgICAgICAgICAgICAgICAgICBuZXdMaXN0ID0gcHJldmlvdXNTaWJsaW5nO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRTaWJsaW5nID0gbmV3TGlzdC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgICAgIGlmIChuZXh0U2libGluZyAmJiBuZXh0U2libGluZy5pcyhMaXN0Tm9kZVt0eXBlXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV4dFNpYmxpbmcubWVyZ2VXaXRoKG5ld0xpc3QpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5kZW50IG9uZSBvciBtb3JlIGxpc3QgaXRlbXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgaW5kZW50KHBhcmFtczogSW5kZW50UGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gcmFuZ2UudGFyZ2V0ZWROb2Rlcyhub2RlID0+IG5vZGUucGFyZW50Py50ZXN0KExpc3ROb2RlKSk7XG5cbiAgICAgICAgLy8gRG8gbm90IGluZGVudCBpdGVtcyBvZiBhIHRhcmdldGVkIG5lc3RlZCBsaXN0LCBzaW5jZSB0aGV5XG4gICAgICAgIC8vIHdpbGwgYXV0b21hdGljYWxseSBiZSBpbmRlbnRlZCB3aXRoIHRoZWlyIGxpc3QgYW5jZXN0b3IuXG4gICAgICAgIGNvbnN0IGl0ZW1zVG9JbmRlbnQgPSBpdGVtcy5maWx0ZXIoaXRlbSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gIWl0ZW1zLmluY2x1ZGVzKGl0ZW0uYW5jZXN0b3IoTGlzdE5vZGUpKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFpdGVtc1RvSW5kZW50Lmxlbmd0aCkgcmV0dXJuO1xuXG4gICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtc1RvSW5kZW50KSB7XG4gICAgICAgICAgICBjb25zdCBwcmV2ID0gaXRlbS5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgICAgIGNvbnN0IG5leHQgPSBpdGVtLm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICAvLyBJbmRlbnQgdGhlIGl0ZW0gYnkgcHV0dGluZyBpdCBpbnRvIGEgcHJlLWV4aXN0aW5nIGxpc3Qgc2libGluZy5cbiAgICAgICAgICAgIGlmIChwcmV2ICYmIHByZXYuaXMoTGlzdE5vZGUpKSB7XG4gICAgICAgICAgICAgICAgcHJldi5hcHBlbmQoaXRlbSk7XG4gICAgICAgICAgICAgICAgLy8gVGhlIHR3byBsaXN0IHNpYmxpbmdzIG1pZ2h0IGJlIHJlam9pbmFibGUgbm93IHRoYXQgdGhlIGxvd2VyXG4gICAgICAgICAgICAgICAgLy8gbGV2ZWwgaXRlbSBicmVha2luZyB0aGVtIGludG8gdHdvIGRpZmZlcmVudCBsaXN0cyBpcyBubyBtb3JlLlxuICAgICAgICAgICAgICAgIGNvbnN0IGxpc3RUeXBlID0gcHJldi5saXN0VHlwZTtcbiAgICAgICAgICAgICAgICBpZiAoTGlzdE5vZGVbbGlzdFR5cGVdKG5leHQpICYmICFpdGVtc1RvSW5kZW50LmluY2x1ZGVzKG5leHQpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5leHQubWVyZ2VXaXRoKHByZXYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAobmV4dD8uaXMoTGlzdE5vZGUpICYmICFpdGVtc1RvSW5kZW50LmluY2x1ZGVzKG5leHQpKSB7XG4gICAgICAgICAgICAgICAgbmV4dC5wcmVwZW5kKGl0ZW0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBubyBvdGhlciBjYW5kaWRhdGUgZXhpc3RzIHRoZW4gd3JhcCBpdCBpbiBhIG5ldyBMaXN0Tm9kZS5cbiAgICAgICAgICAgICAgICBjb25zdCBsaXN0VHlwZSA9IGl0ZW0uYW5jZXN0b3IoTGlzdE5vZGUpLmxpc3RUeXBlO1xuICAgICAgICAgICAgICAgIGl0ZW0ud3JhcChuZXcgTGlzdE5vZGUoeyBsaXN0VHlwZTogbGlzdFR5cGUgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogT3V0ZGVudCBvbmUgb3IgbW9yZSBsaXN0IGl0ZW1zLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIG91dGRlbnQocGFyYW1zOiBPdXRkZW50UGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gcmFuZ2UudGFyZ2V0ZWROb2Rlcyhub2RlID0+IG5vZGUucGFyZW50Py5pcyhMaXN0Tm9kZSkpO1xuXG4gICAgICAgIC8vIERvIG5vdCBvdXRkZW50IGl0ZW1zIG9mIGEgdGFyZ2V0ZWQgbmVzdGVkIGxpc3QsIHNpbmNlIHRoZXlcbiAgICAgICAgLy8gd2lsbCBhdXRvbWF0aWNhbGx5IGJlIG91dGRlbnRlZCB3aXRoIHRoZWlyIGxpc3QgYW5jZXN0b3IuXG4gICAgICAgIGNvbnN0IGl0ZW1zVG9PdXRkZW50ID0gaXRlbXMuZmlsdGVyKGl0ZW0gPT4ge1xuICAgICAgICAgICAgcmV0dXJuICFpdGVtcy5pbmNsdWRlcyhpdGVtLmFuY2VzdG9yKExpc3ROb2RlKSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghaXRlbXNUb091dGRlbnQubGVuZ3RoKSByZXR1cm47XG5cbiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zVG9PdXRkZW50KSB7XG4gICAgICAgICAgICBjb25zdCBsaXN0ID0gaXRlbS5hbmNlc3RvcihMaXN0Tm9kZSk7XG4gICAgICAgICAgICBjb25zdCBwcmV2aW91c1NpYmxpbmcgPSBpdGVtLnByZXZpb3VzU2libGluZygpO1xuICAgICAgICAgICAgY29uc3QgbmV4dFNpYmxpbmcgPSBpdGVtLm5leHRTaWJsaW5nKCk7XG4gICAgICAgICAgICBpZiAocHJldmlvdXNTaWJsaW5nICYmIG5leHRTaWJsaW5nKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc3BsaXRMaXN0ID0gaXRlbS5wYXJlbnQuc3BsaXRBdChpdGVtKTtcbiAgICAgICAgICAgICAgICBzcGxpdExpc3QuYmVmb3JlKGl0ZW0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICAgICAgICAgICBsaXN0LmFmdGVyKGl0ZW0pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuZXh0U2libGluZykge1xuICAgICAgICAgICAgICAgIGxpc3QuYmVmb3JlKGl0ZW0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBsaXN0LnVud3JhcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5zZXJ0IGEgcGFyYWdyYXBoIGJyZWFrIGluIHRoZSBsYXN0IGVtcHR5IGl0ZW0gb2YgYSBsaXN0IGJ5IHVud3JhcHBpbmdcbiAgICAgKiB0aGUgbGlzdCBpdGVtIGZyb20gdGhlIGxpc3QsIHRodXMgYmVjb21pbmcgdGhlIG5ldyBwYXJhZ3JhcGguXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgaW5zZXJ0UGFyYWdyYXBoQnJlYWsocGFyYW1zOiBJbnNlcnRQYXJhZ3JhcGhCcmVha1BhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBsaXN0SXRlbSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyO1xuICAgICAgICBjb25zdCBsaXN0Tm9kZSA9IGxpc3RJdGVtLmFuY2VzdG9yKExpc3ROb2RlKTtcbiAgICAgICAgaWYgKGxpc3ROb2RlLmNoaWxkcmVuKCkubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICBsaXN0Tm9kZS51bndyYXAoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxpc3ROb2RlLmFmdGVyKGxpc3RJdGVtKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlam9pbiBzYW1lIHR5cGUgbGlzdHMgdGhhdCBhcmUgbm93IGRpcmVjdCBzaWJsaW5ncyBhZnRlciB0aGUgcmVtb3ZlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIHJlam9pbihwYXJhbXM6IERlbGV0ZUJhY2t3YXJkUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGxpc3RBbmNlc3RvcnMgPSByYW5nZS5zdGFydC5hbmNlc3RvcnMoTGlzdE5vZGUpO1xuICAgICAgICBpZiAobGlzdEFuY2VzdG9ycy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxldCBsaXN0OiBWTm9kZSA9IGxpc3RBbmNlc3RvcnNbbGlzdEFuY2VzdG9ycy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGxldCBuZXh0U2libGluZyA9IGxpc3QgJiYgbGlzdC5uZXh0U2libGluZygpO1xuICAgICAgICAgICAgd2hpbGUgKFxuICAgICAgICAgICAgICAgIGxpc3QgJiZcbiAgICAgICAgICAgICAgICBuZXh0U2libGluZyAmJlxuICAgICAgICAgICAgICAgIGxpc3QuaXMoTGlzdE5vZGUpICYmXG4gICAgICAgICAgICAgICAgbmV4dFNpYmxpbmcuaXMoTGlzdE5vZGVbbGlzdC5saXN0VHlwZV0pXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0TGlzdCA9IGxpc3QubGFzdENoaWxkKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dExpc3RTaWJsaW5nID0gbmV4dFNpYmxpbmcuZmlyc3RDaGlsZCgpO1xuICAgICAgICAgICAgICAgIG5leHRTaWJsaW5nLm1lcmdlV2l0aChsaXN0KTtcbiAgICAgICAgICAgICAgICBsaXN0ID0gbmV4dExpc3Q7XG4gICAgICAgICAgICAgICAgbmV4dFNpYmxpbmcgPSBuZXh0TGlzdFNpYmxpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgSldFZGl0b3IgZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgTGlzdCwgTGlzdFBhcmFtcyB9IGZyb20gJy4vTGlzdCc7XG5pbXBvcnQgeyBMaXN0VHlwZSB9IGZyb20gJy4vTGlzdE5vZGUnO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXRvb2xiYXIvc3JjL1Rvb2xiYXInO1xuXG5leHBvcnQgY29uc3QgT3JkZXJlZExpc3RCdXR0b246IEJ1dHRvbiA9IHtcbiAgICB0aXRsZTogJ1RvZ2dsZSBvcmRlcmVkIGxpc3QnLFxuICAgIGNsYXNzOiAnZmEtbGlzdC1vbCcsXG4gICAgY29tbWFuZElkOiAndG9nZ2xlTGlzdCcsXG4gICAgY29tbWFuZEFyZ3M6IHsgdHlwZTogTGlzdFR5cGUuT1JERVJFRCB9IGFzIExpc3RQYXJhbXMsXG4gICAgc2VsZWN0ZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIGNvbnN0IHRhcmdldGVkTm9kZXMgPSBlZGl0b3Iuc2VsZWN0aW9uLnJhbmdlLnRhcmdldGVkTm9kZXMoKTtcbiAgICAgICAgcmV0dXJuIHRhcmdldGVkTm9kZXMuZXZlcnkoTGlzdC5pc0luTGlzdC5iaW5kKExpc3QsIExpc3RUeXBlLk9SREVSRUQpKTtcbiAgICB9LFxufTtcbmV4cG9ydCBjb25zdCBVbm9yZGVyZWRMaXN0QnV0dG9uOiBCdXR0b24gPSB7XG4gICAgdGl0bGU6ICdUb2dnbGUgdW5vcmRlcmVkIGxpc3QnLFxuICAgIGNsYXNzOiAnZmEtbGlzdC11bCcsXG4gICAgY29tbWFuZElkOiAndG9nZ2xlTGlzdCcsXG4gICAgY29tbWFuZEFyZ3M6IHsgdHlwZTogTGlzdFR5cGUuVU5PUkRFUkVEIH0gYXMgTGlzdFBhcmFtcyxcbiAgICBzZWxlY3RlZDogKGVkaXRvcjogSldFZGl0b3IpOiBib29sZWFuID0+IHtcbiAgICAgICAgY29uc3QgdGFyZ2V0ZWROb2RlcyA9IGVkaXRvci5zZWxlY3Rpb24ucmFuZ2UudGFyZ2V0ZWROb2RlcygpO1xuICAgICAgICByZXR1cm4gdGFyZ2V0ZWROb2Rlcy5ldmVyeShMaXN0LmlzSW5MaXN0LmJpbmQoTGlzdCwgTGlzdFR5cGUuVU5PUkRFUkVEKSk7XG4gICAgfSxcbn07XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IExpc3ROb2RlLCBMaXN0VHlwZSB9IGZyb20gJy4vTGlzdE5vZGUnO1xuaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIExpc3RIdG1sRG9tUmVuZGVyZXIgZXh0ZW5kcyBBYnN0cmFjdFJlbmRlcmVyPE5vZGVbXT4ge1xuICAgIHN0YXRpYyBpZCA9IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBIdG1sRG9tUmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IExpc3ROb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKG5vZGU6IExpc3ROb2RlKTogUHJvbWlzZTxOb2RlW10+IHtcbiAgICAgICAgY29uc3QgdGFnID0gbm9kZS5saXN0VHlwZSA9PT0gTGlzdFR5cGUuT1JERVJFRCA/ICdPTCcgOiAnVUwnO1xuICAgICAgICBjb25zdCBkb21MaXN0Tm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnKTtcbiAgICAgICAgdGhpcy5lbmdpbmUucmVuZGVyQXR0cmlidXRlcyhBdHRyaWJ1dGVzLCBub2RlLCBkb21MaXN0Tm9kZSk7XG4gICAgICAgIGNvbnN0IHJlbmRlcmVkQ2hpbGRyZW4gPSBhd2FpdCB0aGlzLnJlbmRlckNoaWxkcmVuKG5vZGUpO1xuICAgICAgICBkb21MaXN0Tm9kZS5hcHBlbmQoLi4ucmVuZGVyZWRDaGlsZHJlbi5mbGF0KCkpO1xuICAgICAgICByZXR1cm4gW2RvbUxpc3ROb2RlXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IExpc3ROb2RlIH0gZnJvbSAnLi9MaXN0Tm9kZSc7XG5pbXBvcnQgeyBWRWxlbWVudCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WRWxlbWVudCc7XG5pbXBvcnQgeyBMaXN0IH0gZnJvbSAnLi9MaXN0JztcbmltcG9ydCB7IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4taHRtbC9zcmMvSHRtbERvbVJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBMaXN0SXRlbUF0dHJpYnV0ZXMgfSBmcm9tICcuL0xpc3RJdGVtWG1sRG9tUGFyc2VyJztcblxuZXhwb3J0IGNsYXNzIExpc3RJdGVtSHRtbERvbVJlbmRlcmVyIGV4dGVuZHMgQWJzdHJhY3RSZW5kZXJlcjxOb2RlW10+IHtcbiAgICBzdGF0aWMgaWQgPSBIdG1sRG9tUmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogSHRtbERvbVJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSBMaXN0LmlzTGlzdEl0ZW07XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogVk5vZGUpOiBQcm9taXNlPE5vZGVbXT4ge1xuICAgICAgICBjb25zdCBkb21MaXN0SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgICAgIGlmIChub2RlLmlzKExpc3ROb2RlKSkge1xuICAgICAgICAgICAgaWYgKCFkb21MaXN0SXRlbS5zdHlsZS5saXN0U3R5bGUpIHtcbiAgICAgICAgICAgICAgICBkb21MaXN0SXRlbS5zdHlsZS5saXN0U3R5bGUgPSAnbm9uZSc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEaXJlY3QgTGlzdE5vZGUncyBWRWxlbWVudCBjaGlsZHJlbiBcIlBcIiBhcmUgcmVuZGVyZWQgYXMgXCJMSVwiXG4gICAgICAgIC8vIHdoaWxlIG90aGVyIG5vZGVzIHdpbGwgYmUgcmVuZGVyZWQgaW5zaWRlIHRoZSBcIkxJXCIuXG4gICAgICAgIGlmIChub2RlLmlzKFZFbGVtZW50KSAmJiBub2RlLmh0bWxUYWcgPT09ICdQJykge1xuICAgICAgICAgICAgY29uc3QgcmVuZGVyZWRDaGlsZHJlbiA9IGF3YWl0IHRoaXMucmVuZGVyQ2hpbGRyZW4obm9kZSk7XG4gICAgICAgICAgICBkb21MaXN0SXRlbS5hcHBlbmQoLi4ucmVuZGVyZWRDaGlsZHJlbi5mbGF0KCkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gVGhlIG5vZGUgd2FzIHdyYXBwZWQgaW4gYSBcIkxJXCIgYnV0IG5lZWRzIHRvIGJlIHJlbmRlcmVkIGFzIHdlbGwuXG4gICAgICAgICAgICBjb25zdCByZW5kZXJlZE5vZGUgPSBhd2FpdCB0aGlzLnN1cGVyLnJlbmRlcihub2RlKTtcbiAgICAgICAgICAgIGRvbUxpc3RJdGVtLmFwcGVuZCguLi5yZW5kZXJlZE5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJlbmRlciB0aGUgbm9kZSdzIGF0dHJpYnV0ZXMgdGhhdCB3ZXJlIHN0b3JlZCBvbiB0aGUgdGVjaG5pY2FsIGtleVxuICAgICAgICAvLyB0aGF0IHNwZWNpZmllcyB0aG9zZSBhdHRyaWJ1dGVzIGJlbG9uZyBvbiB0aGUgbGlzdCBpdGVtLlxuICAgICAgICB0aGlzLmVuZ2luZS5yZW5kZXJBdHRyaWJ1dGVzKExpc3RJdGVtQXR0cmlidXRlcywgbm9kZSwgZG9tTGlzdEl0ZW0pO1xuICAgICAgICByZXR1cm4gW2RvbUxpc3RJdGVtXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBpc0Jsb2NrIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL2lzQmxvY2snO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgQWJzdHJhY3RQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9BYnN0cmFjdFBhcnNlcic7XG5pbXBvcnQgeyBYbWxEb21QYXJzaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5pbXBvcnQgeyBNb2RpZmllcnMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9Nb2RpZmllcnMnO1xuXG5leHBvcnQgY2xhc3MgTGlzdEl0ZW1BdHRyaWJ1dGVzIGV4dGVuZHMgQXR0cmlidXRlcyB7fVxuXG5leHBvcnQgY2xhc3MgTGlzdEl0ZW1YbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgbm9kZU5hbWUoaXRlbSkgPT09ICdMSSc7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgbGlzdCBlbGVtZW50IChMSSkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBBcnJheS5mcm9tKGl0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIC8vIEEgbGlzdCBpdGVtIHdpdGggbm8gY2hpbGRyZW4gc2hvdWxkIGJlIHNraXBwZWQuXG4gICAgICAgIGlmICghY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgbm9kZXM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgbGV0IGlubGluZXNDb250YWluZXI6IFZOb2RlO1xuICAgICAgICAvLyBQYXJzZSB0aGUgbGlzdCBpdGVtJ3MgYXR0cmlidXRlcyBpbnRvIHRoZSBub2RlJ3MgTGlzdEl0ZW1BdHRyaWJ1dGVzLFxuICAgICAgICAvLyB3aGljaCB3aWxsIGJlIHJlYWQgb25seSBieSBMaXN0SXRlbURvbVJlbmRlcmVyLlxuICAgICAgICBjb25zdCBpdGVtTW9kaWZpZXJzID0gbmV3IE1vZGlmaWVycyh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSkpO1xuICAgICAgICBjb25zdCBDb250YWluZXIgPSB0aGlzLmVuZ2luZS5lZGl0b3IuY29uZmlndXJhdGlvbi5kZWZhdWx0cy5Db250YWluZXI7XG4gICAgICAgIGZvciAobGV0IGNoaWxkSW5kZXggPSAwOyBjaGlsZEluZGV4IDwgY2hpbGRyZW4ubGVuZ3RoOyBjaGlsZEluZGV4KyspIHtcbiAgICAgICAgICAgIGNvbnN0IGRvbUNoaWxkID0gY2hpbGRyZW5bY2hpbGRJbmRleF07XG4gICAgICAgICAgICBjb25zdCBwYXJzZWRDaGlsZCA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKGRvbUNoaWxkKTtcbiAgICAgICAgICAgIGlmIChwYXJzZWRDaGlsZC5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNJbmxpbmVMaXN0SXRlbShkb21DaGlsZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ29udGlndW91cyBpbmxpbmUgZWxlbWVudHMgaW4gYSBsaXN0IGl0ZW0gc2hvdWxkIGJlXG4gICAgICAgICAgICAgICAgICAgIC8vIHdyYXBwZWQgdG9nZXRoZXIgaW4gYSBiYXNlIGNvbnRhaW5lci5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpbmxpbmVzQ29udGFpbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbmxpbmVzQ29udGFpbmVyID0gbmV3IENvbnRhaW5lcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5saW5lc0NvbnRhaW5lci5tb2RpZmllcnMuYXBwZW5kKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBMaXN0SXRlbUF0dHJpYnV0ZXMoaXRlbU1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykpLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5vZGVzLnB1c2goaW5saW5lc0NvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaW5saW5lc0NvbnRhaW5lci5hcHBlbmQoLi4ucGFyc2VkQ2hpbGQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlubGluZXNDb250YWluZXIgPSBudWxsOyAvLyBDbG9zZSB0aGUgaW5saW5lc0NvbnRhaW5lci5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBwYXJzZWRDaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQubW9kaWZpZXJzLnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlzdEl0ZW1BdHRyaWJ1dGVzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBMaXN0SXRlbUF0dHJpYnV0ZXMoaXRlbU1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykpLFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKC4uLnBhcnNlZENoaWxkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gQSBsaXN0IGl0ZW0gd2l0aCBjaGlsZHJlbiBidXQgd2hvc2UgcGFyc2luZyByZXR1cm5lZCBub3RoaW5nIHNob3VsZFxuICAgICAgICAvLyBiZSBwYXJzZWQgYXMgYW4gZW1wdHkgYmFzZSBjb250YWluZXIuIEVnOiA8bGk+PGJyLz48L2xpPjogbGkgaGFzIGFcbiAgICAgICAgLy8gY2hpbGQgc28gaXQgd2lsbCBub3QgcmV0dXJuIFtdIGFib3ZlIChhbmQgdGhlcmVmb3JlIGJlIGlnbm9yZWQpLCBidXRcbiAgICAgICAgLy8gYnIgd2lsbCBwYXJzZSB0byBub3RoaW5nIGJlY2F1c2UgaXQncyBhIHBsYWNlaG9sZGVyIGJyLCBub3QgYSByZWFsXG4gICAgICAgIC8vIGxpbmUgYnJlYWsuIFdlIGNhbm5vdCBpZ25vcmUgdGhhdCBsaSBiZWNhdXNlIGl0IGRvZXMgaW4gZmFjdCBleGlzdCBzb1xuICAgICAgICAvLyB3ZSBwYXJzZSBpdCBhcyBhbiBlbXB0eSBiYXNlIGNvbnRhaW5lci5cbiAgICAgICAgcmV0dXJuIG5vZGVzLmxlbmd0aCA/IG5vZGVzIDogW25ldyBDb250YWluZXIoKV07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIG5vZGUgaXMgYW4gaW5saW5lIGxpc3QgaXRlbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICovXG4gICAgX2lzSW5saW5lTGlzdEl0ZW0oaXRlbTogTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gaXRlbSAmJiAoIWlzQmxvY2soaXRlbSkgfHwgbm9kZU5hbWUoaXRlbSkgPT09ICdCUicpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5cbmV4cG9ydCBlbnVtIExpc3RUeXBlIHtcbiAgICBPUkRFUkVEID0gJ09SREVSRUQnLFxuICAgIFVOT1JERVJFRCA9ICdVTk9SREVSRUQnLFxufVxuXG5leHBvcnQgY2xhc3MgTGlzdE5vZGUgZXh0ZW5kcyBDb250YWluZXJOb2RlIHtcbiAgICAvLyBUeXBlc2NyaXB0IGN1cnJlbnRseSBkb2Vzbid0IHN1cHBvcnQgdXNpbmcgZW51bSBhcyBrZXlzIGluIGludGVyZmFjZXMuXG4gICAgLy8gU291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L1R5cGVTY3JpcHQvaXNzdWVzLzEzMDQyXG4gICAgc3RhdGljIE9SREVSRUQobm9kZTogVk5vZGUpOiBub2RlIGlzIExpc3ROb2RlIHtcbiAgICAgICAgcmV0dXJuIG5vZGUgJiYgbm9kZS5pcyhMaXN0Tm9kZSkgJiYgbm9kZS5saXN0VHlwZSA9PT0gTGlzdFR5cGUuT1JERVJFRDtcbiAgICB9XG4gICAgc3RhdGljIFVOT1JERVJFRChub2RlOiBWTm9kZSk6IG5vZGUgaXMgTGlzdE5vZGUge1xuICAgICAgICByZXR1cm4gbm9kZSAmJiBub2RlLmlzKExpc3ROb2RlKSAmJiBub2RlLmxpc3RUeXBlID09IExpc3RUeXBlLlVOT1JERVJFRDtcbiAgICB9XG4gICAgbGlzdFR5cGU6IExpc3RUeXBlO1xuICAgIGNvbnN0cnVjdG9yKHBhcmFtczogeyBsaXN0VHlwZTogTGlzdFR5cGUgfSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmxpc3RUeXBlID0gcGFyYW1zLmxpc3RUeXBlO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gc3VwZXIubmFtZSArICc6ICcgKyB0aGlzLmxpc3RUeXBlO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBuZXcgVk5vZGUgd2l0aCB0aGUgc2FtZSB0eXBlIGFuZCBhdHRyaWJ1dGVzIGFzIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiAgQG92ZXJyaWRlXG4gICAgICovXG4gICAgY2xvbmUoZGVlcENsb25lPzogYm9vbGVhbiwgcGFyYW1zPzoge30pOiB0aGlzIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdHM6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgTGlzdE5vZGU+WzBdID0ge1xuICAgICAgICAgICAgbGlzdFR5cGU6IHRoaXMubGlzdFR5cGUsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBzdXBlci5jbG9uZShkZWVwQ2xvbmUsIHsgLi4uZGVmYXVsdHMsIC4uLnBhcmFtcyB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBMaXN0Tm9kZSwgTGlzdFR5cGUgfSBmcm9tICcuL0xpc3ROb2RlJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5jb25zdCBsaXN0VGFncyA9IFsnVUwnLCAnT0wnXTtcblxuZXhwb3J0IGNsYXNzIExpc3RYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgbGlzdFRhZ3MuaW5jbHVkZXMobm9kZU5hbWUoaXRlbSkpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIGxpc3QgKFVMLCBPTCkgYW5kIGhpcyBjaGlsZHJlbiBsaXN0IGVsZW1lbnRzIChMSSkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY29udGV4dFxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgaWYgKCFsaXN0VGFncy5pbmNsdWRlcyhub2RlTmFtZShpdGVtKSkpIHJldHVybjtcbiAgICAgICAgY29uc3QgbGlzdFR5cGUgPSBub2RlTmFtZShpdGVtKSA9PT0gJ1VMJyA/IExpc3RUeXBlLlVOT1JERVJFRCA6IExpc3RUeXBlLk9SREVSRUQ7XG4gICAgICAgIGNvbnN0IGxpc3ROb2RlID0gbmV3IExpc3ROb2RlKHsgbGlzdFR5cGUgfSk7XG4gICAgICAgIGxpc3ROb2RlLm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICBsaXN0Tm9kZS5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW2xpc3ROb2RlXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4taHRtbC9zcmMvSHRtbERvbVJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBNZXRhZGF0YU5vZGUgfSBmcm9tICcuL01ldGFkYXRhTm9kZSc7XG5pbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXhtbC9zcmMvQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBNZXRhZGF0YUh0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gTWV0YWRhdGFOb2RlO1xuXG4gICAgYXN5bmMgcmVuZGVyKG5vZGU6IE1ldGFkYXRhTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGRvbU5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG5vZGUuaHRtbFRhZyk7XG4gICAgICAgIHRoaXMuZW5naW5lLnJlbmRlckF0dHJpYnV0ZXMoQXR0cmlidXRlcywgbm9kZSwgZG9tTm9kZSk7XG4gICAgICAgIGRvbU5vZGUuaW5uZXJIVE1MID0gbm9kZS5jb250ZW50cztcbiAgICAgICAgcmV0dXJuIFtkb21Ob2RlXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBNZXRhZGF0YVhtbERvbVBhcnNlciB9IGZyb20gJy4vTWV0YWRhdGFYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgTWV0YWRhdGFIdG1sRG9tUmVuZGVyZXIgfSBmcm9tICcuL01ldGFEYXRhSHRtbERvbVJlbmRlcmVyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuXG5leHBvcnQgY2xhc3MgTWV0YWRhdGE8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW01ldGFkYXRhWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbTWV0YWRhdGFIdG1sRG9tUmVuZGVyZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBNYXJrZXJOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL01hcmtlck5vZGUnO1xuXG5leHBvcnQgY2xhc3MgTWV0YWRhdGFOb2RlIGV4dGVuZHMgTWFya2VyTm9kZSB7XG4gICAgc3RhdGljIHJlYWRvbmx5IGF0b21pYyA9IHRydWU7XG4gICAgaHRtbFRhZzogc3RyaW5nO1xuICAgIGNvbnRlbnRzID0gJyc7XG4gICAgY29uc3RydWN0b3IoaHRtbFRhZzogc3RyaW5nKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuaHRtbFRhZyA9IGh0bWxUYWc7XG4gICAgfVxuICAgIGdldCBuYW1lKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdG9yLm5hbWUgKyAnOiAnICsgdGhpcy5odG1sVGFnO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgTWV0YWRhdGFOb2RlIH0gZnJvbSAnLi9NZXRhZGF0YU5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG4vLyBTZWUgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvR3VpZGUvSFRNTC9Db250ZW50X2NhdGVnb3JpZXMjTWV0YWRhdGFfY29udGVudFxuY29uc3QgTUVUQURBVEFfTk9ERU5BTUVTID0gW1xuICAgICdCQVNFJyxcbiAgICAnQ09NTUFORCcsXG4gICAgJ0xJTksnLFxuICAgICdNRVRBJyxcbiAgICAnTk9TQ1JJUFQnLFxuICAgICdTQ1JJUFQnLFxuICAgICdTVFlMRScsXG4gICAgJ1RJVExFJyxcbl07XG5cbmV4cG9ydCBjbGFzcyBNZXRhZGF0YVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBNRVRBREFUQV9OT0RFTkFNRVMuaW5jbHVkZXMobm9kZU5hbWUoaXRlbSkpO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxNZXRhZGF0YU5vZGVbXT4ge1xuICAgICAgICBjb25zdCB0ZWNobmljYWwgPSBuZXcgTWV0YWRhdGFOb2RlKG5vZGVOYW1lKGl0ZW0pIGFzICdTQ1JJUFQnIHwgJ1NUWUxFJyk7XG4gICAgICAgIHRlY2huaWNhbC5tb2RpZmllcnMuYXBwZW5kKHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKSk7XG4gICAgICAgIHRlY2huaWNhbC5jb250ZW50cyA9IGl0ZW0uaW5uZXJIVE1MO1xuICAgICAgICByZXR1cm4gW3RlY2huaWNhbF07XG4gICAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IExpbmtCdXR0b24gPSB7XG4gICAgdGl0bGU6ICdMaW5rJyxcbiAgICBjb21tYW5kSWQ6ICdvcGVuTGlua0RpYWxvZycsXG4gICAgY2xhc3M6ICdmYS1saW5rJyxcbn07XG4iLCJleHBvcnQgY29uc3QgTWVkaWFCdXR0b24gPSB7XG4gICAgdGl0bGU6ICdNZWRpYScsXG4gICAgY29tbWFuZElkOiAnb3Blbk1lZGlhJyxcbiAgICBjbGFzczogJ2ZhLWZpbGUtaW1hZ2UtbycsXG59O1xuIiwiaW1wb3J0IEpXRWRpdG9yIGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFZFbGVtZW50IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZFbGVtZW50JztcbmltcG9ydCB7IFJlbGF0aXZlUG9zaXRpb24gfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgQ2hhciwgSW5zZXJ0SHRtbFBhcmFtcyB9IGZyb20gJy4uLy4uL3BsdWdpbi1jaGFyL3NyYy9DaGFyJztcbmltcG9ydCB7IEVtcHR5UGFyYW1zLCBXcmFwUGFyYW1zLCBSZXBsYWNlUGFyYW1zIH0gZnJvbSAnLi9PZG9vU25pcHBldCc7XG5pbXBvcnQgeyBDb250YWluZXJOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL0NvbnRhaW5lck5vZGUnO1xuaW1wb3J0IHsgRG9tTGF5b3V0RW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWRvbS1sYXlvdXQvc3JjL3VpL0RvbUxheW91dEVuZ2luZSc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHtcbiAgICBBZGRDbGFzc1BhcmFtcyxcbiAgICBNb3ZlUGFyYW1zLFxuICAgIE9kb29TbmlwcGV0LFxuICAgIFJlbW92ZUNsYXNzUGFyYW1zLFxuICAgIFJlbW92ZVBhcmFtcyxcbiAgICBTZXRBdHRyaWJ1dGVQYXJhbXMsXG4gICAgU2V0U3R5bGVQYXJhbXMsXG4gICAgVG9nZ2xlQ2xhc3NQYXJhbXMsXG59IGZyb20gJy4vT2Rvb1NuaXBwZXQnO1xuXG5pbnRlcmZhY2UgRXhlY3RDb21tYW5kSGVscGVycyB7XG4gICAgW2tleTogc3RyaW5nXTogKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkO1xufVxuXG5leHBvcnQgdHlwZSBIdG1sUG9pbnQgPSBbTm9kZSwgUmVsYXRpdmVQb3NpdGlvbl07XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFeGVjQ29tbWFuZEhlbHBlcnNGb3JPZG9vKGVkaXRvcjogSldFZGl0b3IpOiBFeGVjdENvbW1hbmRIZWxwZXJzIHtcbiAgICBjb25zdCBsYXlvdXQgPSBlZGl0b3IucGx1Z2lucy5nZXQoTGF5b3V0KTtcbiAgICBjb25zdCBkb21FbmdpbmUgPSBsYXlvdXQuZW5naW5lcy5kb20gYXMgRG9tTGF5b3V0RW5naW5lO1xuXG4gICAgZnVuY3Rpb24gX2dldFZFbGVtZW50cyhub2RlOiBOb2RlKTogVkVsZW1lbnRbXSB7XG4gICAgICAgIGNvbnN0IHZub2RlcyA9IGRvbUVuZ2luZS5nZXROb2Rlcyhub2RlKTtcbiAgICAgICAgZm9yIChjb25zdCB2bm9kZSBvZiB2bm9kZXMpIHtcbiAgICAgICAgICAgIGlmICghKHZub2RlIGluc3RhbmNlb2YgVkVsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdWTm9kZSBpcyBub3QgYSBWRWxlbWVudCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2bm9kZXMgYXMgVkVsZW1lbnRbXTtcbiAgICB9XG4gICAgY29uc3Qgb2Rvb0NvbW1hbmRzID0ge1xuICAgICAgICBoYXNWTm9kZShub2RlOiBOb2RlKTogYm9vbGVhbiB7XG4gICAgICAgICAgICBjb25zdCB2bm9kZXMgPSBkb21FbmdpbmUuZ2V0Tm9kZXMobm9kZSk7XG4gICAgICAgICAgICByZXR1cm4gISEodm5vZGVzICYmIHZub2Rlcy5sZW5ndGgpO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBhZGRDbGFzc2VzKG5vZGU6IE5vZGUsIGNsYXNzZXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgICAgICBjb25zdCBwYXJhbXM6IEFkZENsYXNzUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIGVsZW1lbnRzOiBfZ2V0VkVsZW1lbnRzKG5vZGUpLFxuICAgICAgICAgICAgICAgIGNsYXNzZXMsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYXdhaXQgZWRpdG9yLmV4ZWNDb21tYW5kPE9kb29TbmlwcGV0PignYWRkQ2xhc3NlcycsIHBhcmFtcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIHJlbW92ZUNsYXNzZXMobm9kZTogTm9kZSwgY2xhc3Nlczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtczogUmVtb3ZlQ2xhc3NQYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgZWxlbWVudHM6IF9nZXRWRWxlbWVudHMobm9kZSksXG4gICAgICAgICAgICAgICAgY2xhc3NlcyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBhd2FpdCBlZGl0b3IuZXhlY0NvbW1hbmQ8T2Rvb1NuaXBwZXQ+KCdyZW1vdmVDbGFzc2VzJywgcGFyYW1zKTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgdG9nZ2xlQ2xhc3Mobm9kZTogTm9kZSwga2xhc3M6IHN0cmluZywgc2V0PzogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAgICAgY29uc3Qgbm9kZXMgPSBkb21FbmdpbmUuZ2V0Tm9kZXMobm9kZSk7XG4gICAgICAgICAgICBpZiAoIW5vZGVzKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdub2RlcyBhcmUgZW1wdHknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHBhcmFtczogVG9nZ2xlQ2xhc3NQYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgbm9kZXM6IG5vZGVzLFxuICAgICAgICAgICAgICAgIGNsYXNzOiBrbGFzcyxcbiAgICAgICAgICAgICAgICBzZXQsXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYXdhaXQgZWRpdG9yLmV4ZWNDb21tYW5kPE9kb29TbmlwcGV0PigndG9nZ2xlQ2xhc3MnLCBwYXJhbXMpO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBzZXRBdHRyaWJ1dGUoXG4gICAgICAgICAgICBub2RlOiBOb2RlLFxuICAgICAgICAgICAgYXR0cmlidXRlTmFtZTogc3RyaW5nLFxuICAgICAgICAgICAgYXR0cmlidXRlVmFsdWU6IHN0cmluZyxcbiAgICAgICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgICAgICBjb25zdCBwYXJhbXM6IFNldEF0dHJpYnV0ZVBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICBlbGVtZW50czogX2dldFZFbGVtZW50cyhub2RlKSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVOYW1lLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZVZhbHVlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGF3YWl0IGVkaXRvci5leGVjQ29tbWFuZDxPZG9vU25pcHBldD4oJ3NldEF0dHJpYnV0ZScsIHBhcmFtcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIHNldFN0eWxlKFxuICAgICAgICAgICAgbm9kZTogTm9kZSxcbiAgICAgICAgICAgIHByb3BlcnR5OiBzdHJpbmcsXG4gICAgICAgICAgICB2YWx1ZTogc3RyaW5nLFxuICAgICAgICAgICAgaW1wb3J0YW50ID0gZmFsc2UsXG4gICAgICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAgICAgY29uc3QgcGFyYW1zOiBTZXRTdHlsZVBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICBub2RlczogZG9tRW5naW5lLmdldE5vZGVzKG5vZGUpLFxuICAgICAgICAgICAgICAgIHByb3BlcnR5LFxuICAgICAgICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgICAgICAgIGltcG9ydGFudCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBhd2FpdCBlZGl0b3IuZXhlY0NvbW1hbmQ8T2Rvb1NuaXBwZXQ+KCdzZXRTdHlsZScsIHBhcmFtcyk7XG4gICAgICAgIH0sXG4gICAgICAgIC8vIHRvZG86IHNvbWV0aW1lcyBpIG5lZWQgdG8gYXBwZW5kLiBCZWNhdXNlIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgaW5zZXJ0SFRNTCBhcHBlbmRcbiAgICAgICAgLy8gaXQgd2hlbiB0aGUgUmVsYXRpdmVQb3NpdGlvbiBpcyAnaW5zaWRlJywgaXQgd29yay4gQnV0IHRoaXMgaXMgdW5jbGVhciB0aGF0IGl0IHdpbGxcbiAgICAgICAgLy8gYXBwZW5kLlxuICAgICAgICAvLyBDaGFuZ2UgdGhlIEFQSSB0byBoYXZlIGEgY2xlYXJlciBkaXN0aW5jdGlvbiBhbmQgYWxsb3dpbmcgdG8gYXBwZW5kL3ByZXBlbmQ7XG4gICAgICAgIGFzeW5jIGluc2VydEh0bWwocmFuZ2VQb2ludDogSHRtbFBvaW50LCBodG1sOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgICAgIGNvbnN0IHZub2RlID0gZG9tRW5naW5lLmdldE5vZGVzKHJhbmdlUG9pbnRbMF0pWzBdO1xuICAgICAgICAgICAgY29uc3QgcGFyYW1zOiBJbnNlcnRIdG1sUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIHJhbmdlUG9pbnQ6IFt2bm9kZSwgcmFuZ2VQb2ludFsxXV0sXG4gICAgICAgICAgICAgICAgaHRtbCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRpdG9yLmV4ZWNDb21tYW5kPENoYXI+KCdpbnNlcnRIdG1sJywgcGFyYW1zKTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgbW92ZUJlZm9yZShmcm9tTm9kZTogTm9kZSwgdG9Ob2RlOiBOb2RlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgICAgICBjb25zdCBmcm9tVk5vZGUgPSBkb21FbmdpbmUuZ2V0Tm9kZXMoZnJvbU5vZGUpWzBdO1xuICAgICAgICAgICAgY29uc3QgdG9WTm9kZSA9IGRvbUVuZ2luZS5nZXROb2Rlcyh0b05vZGUpWzBdO1xuICAgICAgICAgICAgY29uc3QgcGFyYW1zOiBNb3ZlUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIGZyb206IGZyb21WTm9kZSxcbiAgICAgICAgICAgICAgICB0bzogW3RvVk5vZGUsIFJlbGF0aXZlUG9zaXRpb24uQkVGT1JFXSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRpdG9yLmV4ZWNDb21tYW5kPE9kb29TbmlwcGV0PignbW92ZScsIHBhcmFtcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIG1vdmVBZnRlcihmcm9tTm9kZTogTm9kZSwgdG9Ob2RlOiBOb2RlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgICAgICBjb25zdCBmcm9tVk5vZGUgPSBkb21FbmdpbmUuZ2V0Tm9kZXMoZnJvbU5vZGUpWzBdO1xuICAgICAgICAgICAgY29uc3QgdG9WTm9kZSA9IGRvbUVuZ2luZS5nZXROb2Rlcyh0b05vZGUpWzBdO1xuICAgICAgICAgICAgY29uc3QgcGFyYW1zOiBNb3ZlUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIGZyb206IGZyb21WTm9kZSxcbiAgICAgICAgICAgICAgICB0bzogW3RvVk5vZGUsIFJlbGF0aXZlUG9zaXRpb24uQUZURVJdLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBlZGl0b3IuZXhlY0NvbW1hbmQ8T2Rvb1NuaXBwZXQ+KCdtb3ZlJywgcGFyYW1zKTtcbiAgICAgICAgfSxcbiAgICAgICAgYXN5bmMgcmVtb3ZlKG5vZGU6IE5vZGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgICAgIGNvbnN0IHBhcmFtczogUmVtb3ZlUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIHZub2RlczogZG9tRW5naW5lLmdldE5vZGVzKG5vZGUpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBlZGl0b3IuZXhlY0NvbW1hbmQ8T2Rvb1NuaXBwZXQ+KCdyZW1vdmUnLCBwYXJhbXMpO1xuICAgICAgICB9LFxuICAgICAgICBleGlzdHMobm9kZTogTm9kZSk6IGJvb2xlYW4ge1xuICAgICAgICAgICAgcmV0dXJuICEhZG9tRW5naW5lLmdldE5vZGVzKG5vZGUpO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyBlbXB0eShub2RlOiBOb2RlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgICAgICBjb25zdCBwYXJhbXM6IEVtcHR5UGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIHZub2RlczogZG9tRW5naW5lLmdldE5vZGVzKG5vZGUpLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCBlZGl0b3IuZXhlY0NvbW1hbmQ8T2Rvb1NuaXBwZXQ+KCdlbXB0eScsIHBhcmFtcyk7XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIHdyYXAobm9kZTogTm9kZSwgaHRtbDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb21FbmdpbmUuZ2V0Tm9kZXMobm9kZSlbMF07XG4gICAgICAgICAgICBpZiAoIShjb250YWluZXIgaW5zdGFuY2VvZiBDb250YWluZXJOb2RlKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICAgICAgJ1RoZSBwcm92aWRlZCBub2RlIG11c3QgYmUgYSBDb250YWluZXJOb2RlIGluIHRoZSBqYWJiZXJ3b2NrIHN0cnVjdHVyZScsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHBhcmFtczogV3JhcFBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICBjb250YWluZXIsXG4gICAgICAgICAgICAgICAgaHRtbCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRpdG9yLmV4ZWNDb21tYW5kPE9kb29TbmlwcGV0PignZW1wdHknLCBwYXJhbXMpO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyByZXBsYWNlKG5vZGU6IE5vZGUsIGh0bWw6IHN0cmluZykge1xuICAgICAgICAgICAgY29uc3QgcGFyYW1zOiBSZXBsYWNlUGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIG5vZGVzOiBkb21FbmdpbmUuZ2V0Tm9kZXMobm9kZSksXG4gICAgICAgICAgICAgICAgaHRtbCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgZWRpdG9yLmV4ZWNDb21tYW5kPE9kb29TbmlwcGV0PigncmVwbGFjZScsIHBhcmFtcyk7XG4gICAgICAgIH0sXG4gICAgfTtcbiAgICByZXR1cm4gb2Rvb0NvbW1hbmRzO1xufVxuIiwiaW1wb3J0IHsgQWJzdHJhY3RSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvQWJzdHJhY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBIdG1sRG9tUmVuZGVyaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWh0bWwvc3JjL0h0bWxEb21SZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgSW1hZ2VOb2RlIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWltYWdlL3NyYy9JbWFnZU5vZGUnO1xuaW1wb3J0IHsgT2Rvb1NuaXBwZXQgfSBmcm9tICcuL09kb29TbmlwcGV0JztcblxuZnVuY3Rpb24gaXNFbGVtZW50KG5vZGU6IE5vZGUpOiBub2RlIGlzIEhUTUxFbGVtZW50IHtcbiAgICByZXR1cm4gbm9kZS5ub2RlVHlwZSA9PT0gbm9kZS5FTEVNRU5UX05PREU7XG59XG5cbi8vIGV4cG9ydCBpbnRlcmZhY2UgT3BlbkltYWdlUGFyYW1zIHtcbi8vICAgICBpbWFnZTogSW1hZ2VOb2RlO1xuLy8gfVxuXG5leHBvcnQgY2xhc3MgT2Rvb0ltYWdlSHRtbERvbVJlbmRlcmVyIGV4dGVuZHMgQWJzdHJhY3RSZW5kZXJlcjxOb2RlW10+IHtcbiAgICBzdGF0aWMgaWQgPSBIdG1sRG9tUmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogSHRtbERvbVJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSBJbWFnZU5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogSW1hZ2VOb2RlKTogUHJvbWlzZTxOb2RlW10+IHtcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBhd2FpdCB0aGlzLnN1cGVyLnJlbmRlcihub2RlKTtcbiAgICAgICAgY29uc3QgaW1hZ2UgPVxuICAgICAgICAgICAgbm9kZXMubGVuZ3RoICYmXG4gICAgICAgICAgICBub2Rlcy5maW5kKG5vZGUgPT4gaXNFbGVtZW50KG5vZGUpICYmIG5vZGUubm9kZU5hbWUudG9VcHBlckNhc2UoKSA9PT0gJ0lNRycpO1xuICAgICAgICBpZiAoaW1hZ2UpIHtcbiAgICAgICAgICAgIGltYWdlLmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcGFyYW1zID0geyBpbWFnZTogbm9kZSB9O1xuICAgICAgICAgICAgICAgIHRoaXMuZW5naW5lLmVkaXRvci5leGVjQ29tbWFuZCgnb3Blbk1lZGlhJywgcGFyYW1zKTtcbiAgICAgICAgICAgICAgICAvLyBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgLy8gZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAvLyBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgIC8vIGFsZXJ0KCdkYmxjbGljaycpO1xuICAgICAgICAgICAgICAgIC8vIHRoaXMuZW5naW5lLmVkaXRvci5uZXh0RXZlbnRNdXRleCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gICAgIHRoaXMuZW5naW5lLmVkaXRvci5leGVjQ3VzdG9tQ29tbWFuZChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICBjb25zb2xlLmxvZygnc2VsZWN0aW5nJyk7XG4gICAgICAgICAgICAgICAgLy8gICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3Iuc2VsZWN0aW9uLnNlbGVjdChub2RlLCBub2RlKTtcbiAgICAgICAgICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgICAgICAgICAgLy8gfSk7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ2NsaWNrZWQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBdHRyaWJ1dGVzIH0gZnJvbSAnLi8uLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcbmltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgS2V5bWFwIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcbmltcG9ydCB7IFZFbGVtZW50IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZFbGVtZW50JztcbmltcG9ydCB7IFZOb2RlLCBQb2ludCwgUmVsYXRpdmVQb3NpdGlvbiB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgSldFZGl0b3IgZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcbmltcG9ydCB7IExheW91dCB9IGZyb20gJy4uLy4uL3BsdWdpbi1sYXlvdXQvc3JjL0xheW91dCc7XG5pbXBvcnQgeyBEb21MYXlvdXRFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4tZG9tLWxheW91dC9zcmMvdWkvRG9tTGF5b3V0RW5naW5lJztcbmltcG9ydCB7IE9kb29TdHJ1Y3R1cmVOb2RlIH0gZnJvbSAnLi9PZG9vU3RydWN0dXJlTm9kZSc7XG5pbXBvcnQgeyBPZG9vU3RydWN1dHJlWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9PZG9vU3RydWN1dHJlWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IE9kb29JbWFnZUh0bWxEb21SZW5kZXJlciB9IGZyb20gJy4vT2Rvb0ltYWdlSHRtbERvbVJlbmRlcmVyJztcbmltcG9ydCB7IENvbW1hbmRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9EaXNwYXRjaGVyJztcbmltcG9ydCB7IElubGluZU5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmVOb2RlJztcbmltcG9ydCB7IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4taHRtbC9zcmMvSHRtbERvbVJlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBMaW5rRm9ybWF0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxpbmsvc3JjL0xpbmtGb3JtYXQnO1xuaW1wb3J0IHsgRm9ybWF0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvRm9ybWF0JztcbmltcG9ydCB7IElubGluZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBMaW5rIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWxpbmsvc3JjL0xpbmsnO1xuaW1wb3J0IHsgQ2hhck5vZGUgfSBmcm9tICcuLi8uLi9wbHVnaW4tY2hhci9zcmMvQ2hhck5vZGUnO1xuXG5leHBvcnQgaW50ZXJmYWNlIFJlbW92ZUNsYXNzUGFyYW1zIGV4dGVuZHMgQ29tbWFuZFBhcmFtcyB7XG4gICAgZWxlbWVudHM6IFZFbGVtZW50W107XG4gICAgY2xhc3Nlczogc3RyaW5nW107XG59XG5leHBvcnQgaW50ZXJmYWNlIEFkZENsYXNzUGFyYW1zIGV4dGVuZHMgQ29tbWFuZFBhcmFtcyB7XG4gICAgZWxlbWVudHM/OiBWRWxlbWVudFtdO1xuICAgIGNsYXNzZXM6IHN0cmluZ1tdO1xufVxuZXhwb3J0IGludGVyZmFjZSBBZGRDbGFzc1RvTGlua1BhcmFtcyBleHRlbmRzIENvbW1hbmRQYXJhbXMge1xuICAgIC8qKlxuICAgICAqIFRoZSBjbGFzcyBhdHRyaWJ1dGUgdG8gYXR0YXRjaCB0byB0aGUgbGluay5cbiAgICAgKi9cbiAgICBjbGFzczogc3RyaW5nO1xufVxuZXhwb3J0IGludGVyZmFjZSBUb2dnbGVDbGFzc1BhcmFtcyB7XG4gICAgbm9kZXM6IFZOb2RlW107XG4gICAgY2xhc3M6IHN0cmluZztcbiAgICBzZXQ/OiBib29sZWFuO1xufVxuZXhwb3J0IGludGVyZmFjZSBTZXRBdHRyaWJ1dGVQYXJhbXMge1xuICAgIGVsZW1lbnRzOiBWRWxlbWVudFtdO1xuICAgIGF0dHJpYnV0ZU5hbWU6IHN0cmluZztcbiAgICBhdHRyaWJ1dGVWYWx1ZTogc3RyaW5nO1xufVxuZXhwb3J0IGludGVyZmFjZSBTZXRTdHlsZVBhcmFtcyB7XG4gICAgLyoqXG4gICAgICogVGhlIGBWRWxlbWVudGBzIHRoYXQgd2Ugd2FudCB0byBjaGFuZ2UgdGhlIHN0eWxlXG4gICAgICovXG4gICAgbm9kZXM6IFZOb2RlW107XG4gICAgLyoqXG4gICAgICogVGhlIGNzcyBwcm9wZXJ0eS5cbiAgICAgKi9cbiAgICBwcm9wZXJ0eTogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIFRoZSBjc3MgdmFsdWVcbiAgICAgKi9cbiAgICB2YWx1ZTogc3RyaW5nO1xuICAgIGltcG9ydGFudD86IGJvb2xlYW47XG59XG5leHBvcnQgaW50ZXJmYWNlIE1vdmVQYXJhbXMge1xuICAgIGZyb206IFZOb2RlO1xuICAgIHRvOiBQb2ludDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZW1vdmVQYXJhbXMge1xuICAgIHZub2RlczogVk5vZGVbXTtcbn1cbmV4cG9ydCBpbnRlcmZhY2UgRW1wdHlQYXJhbXMge1xuICAgIHZub2RlczogVk5vZGVbXTtcbn1cbmV4cG9ydCBpbnRlcmZhY2UgV3JhcFBhcmFtcyB7XG4gICAgY29udGFpbmVyOiBDb250YWluZXJOb2RlO1xuICAgIGh0bWw6IHN0cmluZztcbn1cbmV4cG9ydCBpbnRlcmZhY2UgUmVwbGFjZVBhcmFtcyB7XG4gICAgbm9kZXM6IFZOb2RlW107XG4gICAgaHRtbDogc3RyaW5nO1xufVxuaW50ZXJmYWNlIFNlbGVjdGVkTGlua0luZm8ge1xuICAgIC8qKlxuICAgICAqIFRoZSBzZWxlY3RlZCB0ZXh0XG4gICAgICovXG4gICAgdGV4dDogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIFRoZSB1cmwgb2YgdGhlIGxpbmtcbiAgICAgKi9cbiAgICB1cmw6IHN0cmluZztcbiAgICAvKipcbiAgICAgKiBUaGUgY3NzIGNsYXNzIGFzc29jaWF0ZWQgd2l0aCB0aGUgbGlua1xuICAgICAqL1xuICAgIGNsYXNzOiBzdHJpbmc7XG4gICAgLyoqXG4gICAgICogVGhlIHRhcmdldCBvZiBhbiBodG1sIGFuY2hvci5cbiAgICAgKiBDb3VsZCBiZSBcIl9ibGFua1wiLCBcIl9zZWxmXCIgLFwiX3BhcmVudFwiLCBcIl90b3BcIiBvciB0aGUgZnJhbWVuYW1lLlxuICAgICAqL1xuICAgIHRhcmdldDogc3RyaW5nO1xufVxuXG5leHBvcnQgY2xhc3MgT2Rvb1NuaXBwZXQ8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyICYgS2V5bWFwPiA9IHtcbiAgICAgICAgcGFyc2VyczogW09kb29TdHJ1Y3V0cmVYbWxEb21QYXJzZXJdLFxuICAgICAgICByZW5kZXJlcnM6IFtPZG9vSW1hZ2VIdG1sRG9tUmVuZGVyZXJdLFxuICAgICAgICBzaG9ydGN1dHM6IFtdLFxuICAgIH07XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIHJlbW92ZUNsYXNzZXM6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMucmVtb3ZlQ2xhc3Nlcy5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBhZGRDbGFzc2VzOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmFkZENsYXNzZXMuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgYWRkQ2xhc3NUb0xpbms6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuYWRkQ2xhc3NUb0xpbmsuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgdG9nZ2xlQ2xhc3M6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMudG9nZ2xlQ2xhc3MuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgc2V0QXR0cmlidXRlOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnNldEF0dHJpYnV0ZS5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBzZXRTdHlsZToge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5zZXRTdHlsZS5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBtb3ZlOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLm1vdmUuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgcmVtb3ZlOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnJlbW92ZS5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBlbXB0eToge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5lbXB0eS5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICB3cmFwOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLndyYXAuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgcmVwbGFjZToge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5yZXBsYWNlLmJpbmQodGhpcyksXG4gICAgICAgIH0sXG4gICAgICAgIGdldFN0cnVjdHVyZXM6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuZ2V0U3RydWN0dXJlcy5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBnZXRSZWNvcmRDb3Zlcjoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5nZXRSZWNvcmRDb3Zlci5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBnZXRMaW5rSW5mbzoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5nZXRMaW5rSW5mby5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3RvcihwdWJsaWMgZWRpdG9yOiBKV0VkaXRvciwgcHVibGljIGNvbmZpZ3VyYXRpb246IFQpIHtcbiAgICAgICAgc3VwZXIoZWRpdG9yLCBjb25maWd1cmF0aW9uKTtcbiAgICB9XG5cbiAgICByZW1vdmVDbGFzc2VzKHBhcmFtczogUmVtb3ZlQ2xhc3NQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgLy8gdG9kbzogdXNlIHJhbmdlIHJhdGhlciB0aGFuIHBhcmFtcy5lbGVtZW50c1xuICAgICAgICBmb3IgKGNvbnN0IGVsZW1lbnQgb2YgcGFyYW1zLmVsZW1lbnRzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBvZiBwYXJhbXMuY2xhc3Nlcykge1xuICAgICAgICAgICAgICAgIGVsZW1lbnQubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5jbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgYWRkQ2xhc3NlcyhwYXJhbXM6IEFkZENsYXNzUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIC8vIHRvZG86IHJlbWV2ZSBlbGVtZW50cyBhbmQgb25seSB1c2UgYSByYW5nZS5cbiAgICAgICAgbGV0IG5vZGVzOiBWTm9kZVtdO1xuICAgICAgICBpZiAocGFyYW1zLmVsZW1lbnRzKSB7XG4gICAgICAgICAgICBub2RlcyA9IHBhcmFtcy5lbGVtZW50cztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5vZGVzID0gcGFyYW1zLmNvbnRleHQ/LnJhbmdlLnNlbGVjdGVkTm9kZXMoKSB8fCBbXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBub2Rlcykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgcGFyYW1zLmNsYXNzZXMpIHtcbiAgICAgICAgICAgICAgICBlbGVtZW50Lm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGFkZENsYXNzVG9MaW5rKHBhcmFtczogQWRkQ2xhc3NUb0xpbmtQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2FkZGNsYXNzdG9saW5rJyk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdwYXJhbXMuY29udGV4dC5yYW5nZTonLCBwYXJhbXMuY29udGV4dC5yYW5nZSk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdwYXJhbXMuY29udGV4dC5yYW5nZS5zdGFydDonLCBwYXJhbXMuY29udGV4dC5yYW5nZS5zdGFydCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCdwYXJhbXMuY29udGV4dC5yYW5nZS50YXJnZXRlZE5vZGVzKCk6JywgcGFyYW1zLmNvbnRleHQucmFuZ2UudGFyZ2V0ZWROb2RlcygpKTtcbiAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAncGFyYW1zLmNvbnRleHQucmFuZ2UudHJhdmVyc2VkTm9kZXMoKTonLFxuICAgICAgICAgICAgcGFyYW1zLmNvbnRleHQucmFuZ2UudHJhdmVyc2VkTm9kZXMoKSxcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3Qgbm9kZXMgPSBwYXJhbXMuY29udGV4dC5yYW5nZS50YXJnZXRlZE5vZGVzKElubGluZU5vZGUpO1xuICAgICAgICBjb25zb2xlLmxvZygnbm9kZXM6Jywgbm9kZXMpO1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgIG5vZGUubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5zZXQoJ2NsYXNzJywgcGFyYW1zLmNsYXNzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b2dnbGVDbGFzcyhwYXJhbXM6IFRvZ2dsZUNsYXNzUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBwYXJhbXMubm9kZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGNsYXNzTGlzdCA9IG5vZGUubW9kaWZpZXJzLmdldChBdHRyaWJ1dGVzKS5jbGFzc0xpc3Q7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9XG4gICAgICAgICAgICAgICAgdHlwZW9mIHBhcmFtcy5zZXQgIT09ICd1bmRlZmluZWQnID8gcGFyYW1zLnNldCA6ICFjbGFzc0xpc3QuaGFzKHBhcmFtcy5jbGFzcyk7XG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICBjbGFzc0xpc3QuYWRkKHBhcmFtcy5jbGFzcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNsYXNzTGlzdC5yZW1vdmUocGFyYW1zLmNsYXNzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRBdHRyaWJ1dGUocGFyYW1zOiBTZXRBdHRyaWJ1dGVQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIHBhcmFtcy5lbGVtZW50cykge1xuICAgICAgICAgICAgZWxlbWVudC5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnNldChwYXJhbXMuYXR0cmlidXRlTmFtZSwgcGFyYW1zLmF0dHJpYnV0ZVZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXRTdHlsZShwYXJhbXM6IFNldFN0eWxlUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBwYXJhbXMubm9kZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gcGFyYW1zLmltcG9ydGFudCA/IHBhcmFtcy52YWx1ZSArICcgIWltcG9ydGFudCcgOiBwYXJhbXMudmFsdWU7XG4gICAgICAgICAgICBub2RlLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykuc3R5bGUuc2V0KHBhcmFtcy5wcm9wZXJ0eSwgdmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIG1vdmUocGFyYW1zOiBNb3ZlUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIHN3aXRjaCAocGFyYW1zLnRvWzFdKSB7XG4gICAgICAgICAgICBjYXNlIFJlbGF0aXZlUG9zaXRpb24uQUZURVI6XG4gICAgICAgICAgICAgICAgcGFyYW1zLmZyb20uYWZ0ZXIocGFyYW1zLnRvWzBdKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkU6XG4gICAgICAgICAgICAgICAgcGFyYW1zLmZyb20uYmVmb3JlKHBhcmFtcy50b1swXSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFJlbGF0aXZlUG9zaXRpb24uSU5TSURFOlxuICAgICAgICAgICAgICAgIHBhcmFtcy5mcm9tLmFwcGVuZChwYXJhbXMudG9bMF0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbW92ZShwYXJhbXM6IFJlbW92ZVBhcmFtcyk6IHZvaWQge1xuICAgICAgICBmb3IgKGNvbnN0IHZub2RlIG9mIHBhcmFtcy52bm9kZXMpIHtcbiAgICAgICAgICAgIHZub2RlLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVtcHR5KHBhcmFtczogRW1wdHlQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCB2bm9kZSBvZiBwYXJhbXMudm5vZGVzKSB7XG4gICAgICAgICAgICB2bm9kZS5lbXB0eSgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldFN0cnVjdHVyZXMoKTogVk5vZGVbXSB7XG4gICAgICAgIGNvbnN0IGxheW91dCA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCk7XG4gICAgICAgIGNvbnN0IGRvbUxheW91dCA9IGxheW91dC5lbmdpbmVzLmRvbTtcbiAgICAgICAgY29uc3QgZWRpdGFibGUgPSBkb21MYXlvdXQuY29tcG9uZW50cy5nZXQoJ2VkaXRhYmxlJylbMF07XG4gICAgICAgIGNvbnN0IHN0cnVjdHVyZXMgPSBlZGl0YWJsZS5kZXNjZW5kYW50cyhPZG9vU3RydWN0dXJlTm9kZSk7XG4gICAgICAgIHJldHVybiBzdHJ1Y3R1cmVzO1xuICAgIH1cbiAgICBhc3luYyB3cmFwKHBhcmFtczogV3JhcFBhcmFtcyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBwYXJzZWROb2RlcyA9IGF3YWl0IHRoaXMuX3BhcnNlSFRNTFN0cmluZyhwYXJhbXMuaHRtbCk7XG4gICAgICAgIGNvbnN0IHdyYXBOb2RlID0gcGFyc2VkTm9kZXNbMF07XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lclZOb2RlcyA9IFsuLi5wYXJhbXMuY29udGFpbmVyLmNoaWxkVk5vZGVzXTtcbiAgICAgICAgaWYgKCEod3JhcE5vZGUgaW5zdGFuY2VvZiBDb250YWluZXJOb2RlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbXBvc3NpYmxlIHRvIHdyYXAgd2l0aG91dCBhIENvbnRhaW5lck5vZGUuIENoZWNrIFwicGFyYW1zLmh0bWxcIi4nKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgdm5vZGU6IFZOb2RlO1xuICAgICAgICB3aGlsZSAoKHZub2RlID0gY29udGFpbmVyVk5vZGVzLnNoaWZ0KCkpKSB7XG4gICAgICAgICAgICB3cmFwTm9kZS5hcHBlbmQodm5vZGUpO1xuICAgICAgICB9XG4gICAgICAgIHBhcmFtcy5jb250YWluZXIuYXBwZW5kKHdyYXBOb2RlKTtcbiAgICB9XG5cbiAgICBhc3luYyByZXBsYWNlKHBhcmFtczogUmVwbGFjZVBhcmFtcyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBwYXJzZWROb2RlcyA9IGF3YWl0IHRoaXMuX3BhcnNlSFRNTFN0cmluZyhwYXJhbXMuaHRtbCk7XG4gICAgICAgIGNvbnN0IGZpcnN0Tm9kZSA9IHBhcmFtcy5ub2Rlc1swXTtcbiAgICAgICAgcGFyc2VkTm9kZXMuZm9yRWFjaChmaXJzdE5vZGUuYmVmb3JlLmJpbmQoZmlyc3ROb2RlKSk7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBwYXJhbXMubm9kZXMpIHtcbiAgICAgICAgICAgIG5vZGUucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgZ2V0UmVjb3JkQ292ZXIoKTogUHJvbWlzZTxOb2RlPiB7XG4gICAgICAgIGNvbnN0IGxheW91dCA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KExheW91dCk7XG4gICAgICAgIGNvbnN0IGRvbUxheW91dCA9IGxheW91dC5lbmdpbmVzLmRvbSBhcyBEb21MYXlvdXRFbmdpbmU7XG4gICAgICAgIGNvbnN0IGVkaXRhYmxlTm9kZSA9IGRvbUxheW91dC5jb21wb25lbnRzLmdldCgnZWRpdGFibGUnKVswXSBhcyBDb250YWluZXJOb2RlO1xuICAgICAgICBjb25zdCBjb3ZlcnMgPSBlZGl0YWJsZU5vZGUuZGVzY2VuZGFudHMobm9kZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhdHRyaWJ1dGVzID0gbm9kZS5tb2RpZmllcnMuZmluZChBdHRyaWJ1dGVzKTtcblxuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMubGVuZ3RoICYmIHR5cGVvZiBhdHRyaWJ1dGVzLmdldCgnY2xhc3MnKSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXR0cmlidXRlcy5jbGFzc0xpc3QuaGFzKCdvX3JlY29yZF9jb3Zlcl9jb250YWluZXInKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGNvdmVyID0gY292ZXJzICYmIGNvdmVyc1swXTtcbiAgICAgICAgaWYgKGNvdmVyKSByZXR1cm4gZG9tTGF5b3V0LmdldERvbU5vZGVzKGNvdmVyKVswXTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0U2VsZWN0ZWRUZXh0KHBhcmFtczogQ29tbWFuZFBhcmFtcyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHNlbGVjdGVkTm9kZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlLnNlbGVjdGVkTm9kZXMoKS5tYXAobm9kZSA9PiBub2RlLmNsb25lKCkpO1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSBuZXcgQ29udGFpbmVyTm9kZSgpO1xuICAgICAgICBjb250YWluZXIuYXBwZW5kKC4uLnNlbGVjdGVkTm9kZSk7XG4gICAgICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoUmVuZGVyZXIpO1xuICAgICAgICBjb25zdCByZW5kZXJlZE5vZGUgPSBhd2FpdCByZW5kZXJlci5yZW5kZXI8SFRNTEVsZW1lbnRbXT4oXG4gICAgICAgICAgICBIdG1sRG9tUmVuZGVyaW5nRW5naW5lLmlkLFxuICAgICAgICAgICAgY29udGFpbmVyLFxuICAgICAgICApO1xuICAgICAgICAvLyB0b2RvOiB3aGF0IGlmIHRoZXJlIGlzIG1vcmUgcmVuZGVyZWQgbm9kZXM/XG4gICAgICAgIHJldHVybiByZW5kZXJlZE5vZGUgPyByZW5kZXJlZE5vZGVbMF0uaW5uZXJUZXh0IDogJyc7XG4gICAgfVxuICAgIGFzeW5jIGdldFNlbGVjdGVkTGluayhwYXJhbXM6IENvbW1hbmRQYXJhbXMpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBzZWxlY3RlZE5vZGUgPSBwYXJhbXMuY29udGV4dC5yYW5nZS5zZWxlY3RlZE5vZGVzKCkubWFwKG5vZGUgPT4gbm9kZS5jbG9uZSgpKTtcbiAgICAgICAgY29uc3Qgbm9kZVdpdGhGb3JtYXQ6IElubGluZU5vZGUgPSBzZWxlY3RlZE5vZGUuZmluZChcbiAgICAgICAgICAgIG5vZGUgPT5cbiAgICAgICAgICAgICAgICBub2RlIGluc3RhbmNlb2YgSW5saW5lTm9kZSAmJlxuICAgICAgICAgICAgICAgIG5vZGUubW9kaWZpZXJzLmZpbmQobW9kaWZpZXIgPT4gbW9kaWZpZXIgaW5zdGFuY2VvZiBMaW5rRm9ybWF0KSxcbiAgICAgICAgKSBhcyBJbmxpbmVOb2RlO1xuICAgICAgICBjb25zdCBsaW5rRm9ybWF0OiBMaW5rRm9ybWF0ID1cbiAgICAgICAgICAgIG5vZGVXaXRoRm9ybWF0ICYmXG4gICAgICAgICAgICAobm9kZVdpdGhGb3JtYXQubW9kaWZpZXJzLmZpbmQoXG4gICAgICAgICAgICAgICAgbW9kaWZpZXIgPT4gbW9kaWZpZXIgaW5zdGFuY2VvZiBMaW5rRm9ybWF0LFxuICAgICAgICAgICAgKSBhcyBMaW5rRm9ybWF0KTtcbiAgICAgICAgcmV0dXJuIGxpbmtGb3JtYXQgPyBsaW5rRm9ybWF0LnVybCA6ICcnO1xuICAgIH1cbiAgICBnZXRMaW5rSW5mbyhwYXJhbXM6IENvbW1hbmRQYXJhbXMpOiBTZWxlY3RlZExpbmtJbmZvIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0dGVkTm9kZXMgPSBwYXJhbXMuY29udGV4dC5yYW5nZS50YXJnZXRlZE5vZGVzKENoYXJOb2RlKTtcbiAgICAgICAgY29uc3QgdGV4dCA9IHRhcmdldHRlZE5vZGVzLm1hcCh4ID0+IHguY2hhcikuam9pbignJyk7XG4gICAgICAgIC8vXG4gICAgICAgIGNvbnN0IGlubGluZSA9IHRoaXMuZWRpdG9yLnBsdWdpbnMuZ2V0KElubGluZSk7XG4gICAgICAgIGNvbnN0IG1vZGlmaWVycyA9IGlubGluZS5nZXRDdXJyZW50TW9kaWZpZXJzKHBhcmFtcy5jb250ZXh0LnJhbmdlKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRleHQ6IHRleHQsXG4gICAgICAgICAgICB1cmw6IG1vZGlmaWVycy5nZXQoTGlua0Zvcm1hdCk/LnVybCxcbiAgICAgICAgICAgIGNsYXNzOiBtb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpPy5nZXQoJ2NsYXNzJyksXG4gICAgICAgICAgICB0YXJnZXQ6IG1vZGlmaWVyc1xuICAgICAgICAgICAgICAgIC5nZXQoTGlua0Zvcm1hdClcbiAgICAgICAgICAgICAgICA/Lm1vZGlmaWVycz8uZ2V0KEF0dHJpYnV0ZXMpXG4gICAgICAgICAgICAgICAgPy5nZXQoJ3RhcmdldCcpLFxuICAgICAgICB9IGFzIFNlbGVjdGVkTGlua0luZm87XG4gICAgfVxuXG4gICAgYXN5bmMgX3BhcnNlSFRNTFN0cmluZyhjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgcGFyc2VyID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoUGFyc2VyKTtcbiAgICAgICAgY29uc3QgZG9tUGFyc2VyID0gcGFyc2VyICYmIHBhcnNlci5lbmdpbmVzLmRvbTtcbiAgICAgICAgaWYgKCFkb21QYXJzZXIpIHtcbiAgICAgICAgICAgIC8vIFRPRE86IHJlbW92ZSB0aGlzIHdoZW4gdGhlIGVkaXRvciBjYW4gYmUgaW5zdGFudGlhdGVkIG9uXG4gICAgICAgICAgICAvLyBzb21ldGhpbmcgZWxzZSB0aGFuIERPTS5cbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gRE9NIHBhcnNlciBpbnN0YWxsZWQuYCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIGRpdi5pbm5lckhUTUwgPSBjb250ZW50O1xuICAgICAgICByZXR1cm4gKGF3YWl0IGRvbVBhcnNlci5wYXJzZShkaXYpKVswXS5jaGlsZHJlbigpO1xuICAgIH1cbiAgICBfZ2V0Vk5vZGUoZG9tTm9kZTogTm9kZSk6IFZOb2RlIHtcbiAgICAgICAgY29uc3QgbGF5b3V0ID0gdGhpcy5lZGl0b3IucGx1Z2lucy5nZXQoTGF5b3V0KTtcbiAgICAgICAgY29uc3QgZG9tRW5naW5lID0gbGF5b3V0LmVuZ2luZXMuZG9tIGFzIERvbUxheW91dEVuZ2luZTtcbiAgICAgICAgcmV0dXJuIGRvbUVuZ2luZS5nZXROb2Rlcyhkb21Ob2RlKVswXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWRWxlbWVudCwgVkVsZW1lbnRQYXJhbXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVkVsZW1lbnQnO1xuXG5leHBvcnQgaW50ZXJmYWNlIE9kb29TdHJ1Y3R1cmVOb2RlUGFyYW1zIGV4dGVuZHMgVkVsZW1lbnRQYXJhbXMge1xuICAgIHhwYXRoOiBzdHJpbmc7XG4gICAgdmlld0lkOiBzdHJpbmc7XG59XG5leHBvcnQgY2xhc3MgT2Rvb1N0cnVjdHVyZU5vZGUgZXh0ZW5kcyBWRWxlbWVudCB7XG4gICAgeHBhdGg6IHN0cmluZztcbiAgICB2aWV3SWQ6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHBhcmFtczogT2Rvb1N0cnVjdHVyZU5vZGVQYXJhbXMpIHtcbiAgICAgICAgc3VwZXIocGFyYW1zKTtcbiAgICAgICAgdGhpcy54cGF0aCA9IHBhcmFtcy54cGF0aDtcbiAgICAgICAgdGhpcy52aWV3SWQgPSBwYXJhbXMudmlld0lkO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgT2Rvb1N0cnVjdHVyZU5vZGUgfSBmcm9tICcuL09kb29TdHJ1Y3R1cmVOb2RlJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIE9kb29TdHJ1Y3V0cmVYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlciB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiZcbiAgICAgICAgICAgIGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdvZV9zdHJ1Y3R1cmUnKSAmJlxuICAgICAgICAgICAgaXRlbS5hdHRyaWJ1dGVzICYmXG4gICAgICAgICAgICBpdGVtLmF0dHJpYnV0ZXNbJ2RhdGEtb2UteHBhdGgnXSAmJlxuICAgICAgICAgICAgaXRlbS5hdHRyaWJ1dGVzWydkYXRhLW9lLWlkJ11cbiAgICAgICAgKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSBib2xkIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IG5ldyBPZG9vU3RydWN0dXJlTm9kZSh7XG4gICAgICAgICAgICBodG1sVGFnOiBub2RlTmFtZShpdGVtKSxcbiAgICAgICAgICAgIHhwYXRoOiBpdGVtLmF0dHJpYnV0ZXNbJ2RhdGEtb2UteHBhdGgnXS52YWx1ZSxcbiAgICAgICAgICAgIHZpZXdJZDogaXRlbS5hdHRyaWJ1dGVzWydkYXRhLW9lLWlkJ10udmFsdWUsXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVsZW1lbnQubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgZWxlbWVudC5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW2VsZW1lbnRdO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjb25zdCBTYXZlQnV0dG9uID0ge1xuICAgIHRpdGxlOiAnU2F2ZScsXG4gICAgY29tbWFuZElkOiAnc2F2ZU9kb28nLFxuICAgIGNsYXNzOiAnZmEtc2F2ZSBqdy1wcmltYXJ5LWJ1dHRvbicsXG59O1xuIiwiaW1wb3J0IHsgUVdlYiB9IGZyb20gJ0BvZG9vL293bCc7XG5pbXBvcnQgeyBKV1BsdWdpbkNvbmZpZywgSldQbHVnaW4gfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBPd2xIdG1sRG9tUmVuZGVyZXIgfSBmcm9tICcuL3VpL093bEh0bWxEb21SZW5kZXJlcic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgT3dsRW52LCBPd2xDb21wb25lbnQgfSBmcm9tICcuL3VpL093bENvbXBvbmVudCc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBCcm93c2VyIH0gZnJvbSAnQG9kb28vb3dsL2Rpc3QvdHlwZXMvYnJvd3Nlcic7XG5cbi8vIFRlbXBvcmFyeSBmaXggd2FpdGluZyBmb3IgdGhlIGBFbnZgIGludGVyZmFjZSBvZiBPd2wgdG8gbGV0IHRoZSBgYnJvd3NlcmBcbi8vIHByb3BlcnR5IGJlIG9wdGlvbmFsXG5jb25zdCBicm93c2VyOiBCcm93c2VyID0ge1xuICAgIHNldFRpbWVvdXQ6IHdpbmRvdy5zZXRUaW1lb3V0LmJpbmQod2luZG93KSxcbiAgICBjbGVhclRpbWVvdXQ6IHdpbmRvdy5jbGVhclRpbWVvdXQuYmluZCh3aW5kb3cpLFxuICAgIHNldEludGVydmFsOiB3aW5kb3cuc2V0SW50ZXJ2YWwuYmluZCh3aW5kb3cpLFxuICAgIGNsZWFySW50ZXJ2YWw6IHdpbmRvdy5jbGVhckludGVydmFsLmJpbmQod2luZG93KSxcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWU6IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUuYmluZCh3aW5kb3cpLFxuICAgIHJhbmRvbTogTWF0aC5yYW5kb20sXG4gICAgRGF0ZTogd2luZG93LkRhdGUsXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1mdW5jdGlvblxuICAgIGZldGNoOiAod2luZG93LmZldGNoIHx8ICgoKTogdm9pZCA9PiB7fSkpLmJpbmQod2luZG93KSxcbiAgICBsb2NhbFN0b3JhZ2U6IHdpbmRvdy5sb2NhbFN0b3JhZ2UsXG59O1xuXG5leHBvcnQgY2xhc3MgT3dsPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxSZW5kZXJlcj4gPSB7XG4gICAgICAgIHJlbmRlcmVyczogW093bEh0bWxEb21SZW5kZXJlcl0sXG4gICAgfTtcbiAgICByZWFkb25seSBsb2FkZXJzID0ge1xuICAgICAgICBvd2xUZW1wbGF0ZXM6IHRoaXMuX2xvYWRUZW1wbGF0ZXMsXG4gICAgfTtcblxuICAgIGVudjogT3dsRW52ID0ge1xuICAgICAgICBxd2ViOiBuZXcgUVdlYigpLFxuICAgICAgICBlZGl0b3I6IHRoaXMuZWRpdG9yLFxuICAgICAgICBicm93c2VyOiBicm93c2VyLFxuICAgIH07XG5cbiAgICBjb21wb25lbnRzID0gbmV3IE1hcDxWTm9kZSwgT3dsQ29tcG9uZW50PHt9Pj4oKTtcblxuICAgIGFzeW5jIHN0b3AoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGZvciAoY29uc3QgWywgY29tcG9uZW50XSBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jb21wb25lbnRzLmNsZWFyKCk7XG4gICAgfVxuICAgIHByaXZhdGUgX2xvYWRUZW1wbGF0ZXModGVtcGxhdGVzOiBBcnJheTxzdHJpbmcgfCBEb2N1bWVudD4pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCB0ZW1wbGF0ZSBvZiB0ZW1wbGF0ZXMpIHtcbiAgICAgICAgICAgIHRoaXMuZW52LnF3ZWIuYWRkVGVtcGxhdGVzKHRlbXBsYXRlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ0BvZG9vL293bCc7XG5pbXBvcnQgeyB1c2VTdGF0ZSB9IGZyb20gJ0BvZG9vL293bCc7XG5pbXBvcnQgeyBFbnYgfSBmcm9tICdAb2Rvby9vd2wvZGlzdC90eXBlcy9jb21wb25lbnQvY29tcG9uZW50JztcbmltcG9ydCBKV0VkaXRvciBmcm9tICcuLi8uLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgT3dsRW52IGV4dGVuZHMgRW52IHtcbiAgICBlZGl0b3I6IEpXRWRpdG9yO1xufVxuXG5leHBvcnQgY2xhc3MgT3dsQ29tcG9uZW50PFByb3BzPiBleHRlbmRzIENvbXBvbmVudDxQcm9wcywgT3dsRW52PiB7XG4gICAgc3RhdGU6IHt9O1xuXG4gICAgX3N0b3JhZ2VLZXlQcmVmaXggPSAnT3dsVUknICsgdGhpcy5jb25zdHJ1Y3Rvci5uYW1lICsgJzonO1xuICAgIC8vIFN0YXRlIGl0ZW1zIHdoaWNoIG5hbWVzIGFyZSBsaXN0ZWQgaW4gdGhlIGxvY2FsU3RvcmFnZSBwcm9wZXJ0eSB3aWxsIGJlXG4gICAgLy8gcmVhZCBmcm9tIHRoZSBsb2NhbFN0b3JhZ2UgZHVyaW5nIHRoZSB3aWxsU3RhcnQgb2YgdGhlIGNvbXBvbmVudCwgYW5kXG4gICAgLy8gd3JvdGUgYmFjayB0byB0aGUgbG9jYWxTdG9yYWdlIHdoZW5ldmVyIHRoZSBzdGF0ZSBjaGFuZ2VzLlxuICAgIGxvY2FsU3RvcmFnZTogc3RyaW5nW10gPSBbXTtcbiAgICAvKipcbiAgICAgKiBPd2wgaG9vayBjYWxsZWQgZXhhY3RseSBvbmNlIGJlZm9yZSB0aGUgaW5pdGlhbCByZW5kZXJpbmcuXG4gICAgICovXG4gICAgd2lsbFN0YXJ0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZSkge1xuICAgICAgICAgICAgdGhpcy5faW1wb3J0U3RhdGVGcm9tU3RvcmFnZShsb2NhbFN0b3JhZ2UsIHRoaXMubG9jYWxTdG9yYWdlKTtcbiAgICAgICAgICAgIHRoaXMuc3RhdGUgPSB1c2VTdGF0ZSh0aGlzLnN0YXRlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VwZXIud2lsbFN0YXJ0KCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGJ5IHRoZSBPd2wgc3RhdGUgb2JzZXJ2ZXIgZXZlcnkgdGltZSB0aGUgc3RhdGUgY2hhbmdlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmb3JjZSBzZWUgT3dsIENvbXBvbmVudFxuICAgICAqL1xuICAgIHJlbmRlcihmb3JjZSA9IGZhbHNlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLl9leHBvcnRTdGF0ZVRvU3RvcmFnZShsb2NhbFN0b3JhZ2UsIHRoaXMubG9jYWxTdG9yYWdlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VwZXIucmVuZGVyKGZvcmNlKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJlYWQgdGhlIGdpdmVuIHN0b3JhYmxlIHN0YXRlIGl0ZW1zIGZyb20gdGhlIGdpdmVuIGBzdG9yYWdlYCBhbmQgd3JpdGVcbiAgICAgKiB0aGUgaXRlbXMgYXMgdGhlIGtleSBvZiB0aGUgYHN0YXRlYCBwcm9wZXJ0eS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBzdG9yYWdlIGZyb20gd2hpY2ggdG8gcmVhZCB0aGUgc3RhdGUgaXRlbXNcbiAgICAgKiBAcGFyYW0gc3RvcmFibGVJdGVtcyBuYW1lcyBvZiB0aGUgc3RhdGUgaXRlbXMgdG8gcmVhZCBmcm9tIHN0b3JhZ2VcbiAgICAgKi9cbiAgICBfaW1wb3J0U3RhdGVGcm9tU3RvcmFnZShzdG9yYWdlOiBTdG9yYWdlLCBzdG9yYWJsZUl0ZW1zOiBzdHJpbmdbXSk6IHZvaWQge1xuICAgICAgICBzdG9yYWJsZUl0ZW1zLmZvckVhY2goaXRlbU5hbWUgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3RvcmFnZUtleSA9IHRoaXMuX3N0b3JhZ2VLZXlQcmVmaXggKyBpdGVtTmFtZTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gc3RvcmFnZS5nZXRJdGVtKHN0b3JhZ2VLZXkpO1xuXG4gICAgICAgICAgICAvLyBUaGUgdmFsdWUgb2YgaXRlbXMgdGhhdCB3ZXJlIG5vdCB5ZXQgc2V0IGluIHN0b3JhZ2UgaXMgbnVsbC5cbiAgICAgICAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSwgdGhlIHZhbHVlIHdhcyBzdG9yZWQgYXMgYSBzdHJpbmcgaW4gdGhlIHN0b3JhZ2UuXG4gICAgICAgICAgICAgICAgLy8gQ29udmVydCBpdCB0byB0aGUgdHlwZSBvZiB0aGUgZGVmYXVsdCB2YWx1ZSBmb3IgdGhlIHN0YXRlLlxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVbaXRlbU5hbWVdID0gSlNPTi5wYXJzZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBTdG9yZWQgaXRlbSBpcyBub3QgcGFyc2VhYmxlLiBLZWVwIHRoZSBkZWZhdWx0IHZhbHVlLlxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICAgICAgICAgICAgICBgU3RvcmFnZTogSWdub3Jpbmcgc3RhdGUuJHtpdGVtTmFtZX0gc3RvcmVkIHZhbHVlLlxcbmAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAke2UubmFtZX06ICR7ZS5tZXNzYWdlfVxcbmAgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBTdG9yZWQgdmFsdWU6ICR7dmFsdWV9YCxcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZvciBldmVyeSBrZXkgaW4gdGhlIHByb3BlcnR5IGBzdGF0ZWAsIHdyaXRlIGl0IGJhY2sgdG8gYHN0b3JhZ2VgXG4gICAgICogV3JpdGUgdGhlIGdpdmVuIHN0b3JhYmxlIHN0YXRlIGl0ZW1zIHRvIHRoZSBnaXZlbiBzdG9yYWdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHN0b3JhZ2UgdG8gd3JpdGUgdGhlIHN0YXRlIGl0ZW1zIHRvXG4gICAgICogQHBhcmFtIHN0b3JhYmxlSXRlbXMgbmFtZXMgb2YgdGhlIHN0YXRlIGl0ZW1zIHRvIHdyaXRlIHRvIHN0b3JhZ2VcbiAgICAgKi9cbiAgICBfZXhwb3J0U3RhdGVUb1N0b3JhZ2Uoc3RvcmFnZTogU3RvcmFnZSwgc3RvcmFibGVJdGVtczogc3RyaW5nW10pOiB2b2lkIHtcbiAgICAgICAgc3RvcmFibGVJdGVtcy5mb3JFYWNoKGl0ZW1OYW1lID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSB0aGlzLl9zdG9yYWdlS2V5UHJlZml4ICsgaXRlbU5hbWU7XG4gICAgICAgICAgICAvLyBTdG9yYWdlIHJlcXVpcmUgaXRlbXMgdG8gYmUgc3RvcmVkIGFzIHN0cmluZ3MuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlcmlhbGl6ZWRWYWx1ZSA9IEpTT04uc3RyaW5naWZ5KHRoaXMuc3RhdGVbaXRlbU5hbWVdKTtcbiAgICAgICAgICAgICAgICBzdG9yYWdlLnNldEl0ZW0oc3RvcmFnZUtleSwgc2VyaWFsaXplZFZhbHVlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBTdGF0ZSBpdGVtIGlzIG5vdCBzZXJpYWxpemFibGUuIFNraXAgc3RvcmluZyBpdC5cbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICAgICAgICAgIGBTdG9yYWdlOiBVbnNlcmlhbGl6YWJsZSBzdGF0ZS4ke2l0ZW1OYW1lfSB2YWx1ZS5cXG5gICtcbiAgICAgICAgICAgICAgICAgICAgICAgIGAke2UubmFtZX06ICR7ZS5tZXNzYWdlfWAsXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL0Fic3RyYWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBPd2xOb2RlIH0gZnJvbSAnLi9Pd2xOb2RlJztcbmltcG9ydCB7IE93bCB9IGZyb20gJy4uL093bCc7XG5pbXBvcnQgeyBPd2xFbnYgfSBmcm9tICcuL093bENvbXBvbmVudCc7XG5cbmV4cG9ydCBjbGFzcyBPd2xIdG1sRG9tUmVuZGVyZXIgZXh0ZW5kcyBBYnN0cmFjdFJlbmRlcmVyPE5vZGVbXT4ge1xuICAgIHN0YXRpYyBpZCA9IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBIdG1sRG9tUmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IE93bE5vZGU7XG4gICAgZW52OiBPd2xFbnY7XG5cbiAgICBjb25zdHJ1Y3RvcihlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUsIHN1cGVyUmVuZGVyZXI6IFJlbmRlcmVyPE5vZGVbXT4pIHtcbiAgICAgICAgc3VwZXIoZW5naW5lLCBzdXBlclJlbmRlcmVyKTtcbiAgICAgICAgdGhpcy5lbnYgPSB0aGlzLmVuZ2luZS5lZGl0b3IucGx1Z2lucy5nZXQoT3dsKS5lbnY7XG4gICAgfVxuXG4gICAgYXN5bmMgcmVuZGVyKG5vZGU6IE93bE5vZGUpOiBQcm9taXNlPE5vZGVbXT4ge1xuICAgICAgICBjb25zdCBjb21wb25lbnRzID0gdGhpcy5lbmdpbmUuZWRpdG9yLnBsdWdpbnMuZ2V0KE93bCkuY29tcG9uZW50cztcbiAgICAgICAgaWYgKGNvbXBvbmVudHMuZ2V0KG5vZGUpKSB7XG4gICAgICAgICAgICBjb21wb25lbnRzLmdldChub2RlKS5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdqdy1wbGFjZWhvbGVyJyk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocGxhY2Vob2xkZXIpO1xuICAgICAgICBub2RlLkNvbXBvbmVudC5lbnYgPSB0aGlzLmVudjtcbiAgICAgICAgY29uc3QgY29tcG9uZW50ID0gbmV3IG5vZGUuQ29tcG9uZW50KG51bGwsIG5vZGUucHJvcHMpO1xuICAgICAgICBjb21wb25lbnRzLnNldChub2RlLCBjb21wb25lbnQpO1xuICAgICAgICBhd2FpdCBjb21wb25lbnQubW91bnQocGxhY2Vob2xkZXIpO1xuICAgICAgICBwbGFjZWhvbGRlci5yZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuIFsuLi5wbGFjZWhvbGRlci5jaGlsZE5vZGVzXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBPd2xDb21wb25lbnQgfSBmcm9tICcuL093bENvbXBvbmVudCc7XG5pbXBvcnQgeyBBdG9taWNOb2RlIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvVk5vZGVzL0F0b21pY05vZGUnO1xuXG5leHBvcnQgY2xhc3MgT3dsTm9kZSBleHRlbmRzIEF0b21pY05vZGUge1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBDb21wb25lbnQ6IHR5cGVvZiBPd2xDb21wb25lbnQsIHB1YmxpYyBwcm9wcz86IFJlY29yZDxzdHJpbmcsIHt9Pikge1xuICAgICAgICBzdXBlcigpO1xuICAgIH1cbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gc3VwZXIubmFtZSArICc6ICcgKyB0aGlzLkNvbXBvbmVudC5uYW1lO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFBhcmFncmFwaFhtbERvbVBhcnNlciB9IGZyb20gJy4vUGFyYWdyYXBoWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5cbmV4cG9ydCBjbGFzcyBQYXJhZ3JhcGg8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlcj4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtQYXJhZ3JhcGhYbWxEb21QYXJzZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBWRWxlbWVudCB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WRWxlbWVudCc7XG5cbmV4cG9ydCBjbGFzcyBQYXJhZ3JhcGhOb2RlIGV4dGVuZHMgVkVsZW1lbnQge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcih7IGh0bWxUYWc6ICdQJyB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBQYXJhZ3JhcGhOb2RlIH0gZnJvbSAnLi9QYXJhZ3JhcGhOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgUGFyYWdyYXBoWG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuIGl0ZW0gaW5zdGFuY2VvZiBFbGVtZW50ICYmIG5vZGVOYW1lKGl0ZW0pID09PSAnUCc7XG4gICAgfTtcblxuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFBhcmFncmFwaE5vZGVbXT4ge1xuICAgICAgICBjb25zdCBwYXJhZ3JhcGggPSBuZXcgUGFyYWdyYXBoTm9kZSgpO1xuICAgICAgICBwYXJhZ3JhcGgubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSkpO1xuICAgICAgICBjb25zdCBub2RlcyA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIHBhcmFncmFwaC5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW3BhcmFncmFwaF07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgUGFyc2luZ0VuZ2luZSwgUGFyc2luZ0lkZW50aWZpZXIsIFBhcnNlciwgUGFyc2VyQ29uc3RydWN0b3IgfSBmcm9tICcuL1BhcnNpbmdFbmdpbmUnO1xuXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RQYXJzZXI8VCA9IHt9PiBpbXBsZW1lbnRzIFBhcnNlcjxUPiB7XG4gICAgc3RhdGljIGlkOiBQYXJzaW5nSWRlbnRpZmllcjtcbiAgICByZWFkb25seSBlbmdpbmU6IFBhcnNpbmdFbmdpbmU8VD47XG4gICAgY29uc3RydWN0b3IoZW5naW5lOiBQYXJzaW5nRW5naW5lPFQ+KSB7XG4gICAgICAgIHRoaXMuZW5naW5lID0gZW5naW5lO1xuICAgIH1cbiAgICBwcmVkaWNhdGU/OiAoaXRlbTogVCkgPT4gYm9vbGVhbjtcbiAgICBhYnN0cmFjdCBhc3luYyBwYXJzZShpdGVtOiBUKTogUHJvbWlzZTxWTm9kZVtdPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBYnN0cmFjdFBhcnNlcjxUID0ge30+IHtcbiAgICBjb25zdHJ1Y3RvcjogUGFyc2VyQ29uc3RydWN0b3I8VD47XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBQYXJzaW5nRW5naW5lLCBQYXJzZXJDb25zdHJ1Y3RvciwgUGFyc2luZ0VuZ2luZUNvbnN0cnVjdG9yIH0gZnJvbSAnLi9QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcblxuZXhwb3J0IGNsYXNzIFBhcnNlcjxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgcmVhZG9ubHkgZW5naW5lczogUmVjb3JkPHN0cmluZywgUGFyc2luZ0VuZ2luZT4gPSB7fTtcbiAgICByZWFkb25seSBsb2FkZXJzID0ge1xuICAgICAgICBwYXJzaW5nRW5naW5lczogdGhpcy5sb2FkUGFyc2luZ0VuZ2luZXMsXG4gICAgICAgIHBhcnNlcnM6IHRoaXMubG9hZFBhcnNlcnMsXG4gICAgfTtcblxuICAgIGFzeW5jIHBhcnNlKGVuZ2luZUlkOiBzdHJpbmcsIC4uLml0ZW1zKTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmVuZ2luZXNbZW5naW5lSWRdLnBhcnNlKC4uLml0ZW1zKTtcbiAgICB9XG5cbiAgICBsb2FkUGFyc2luZ0VuZ2luZXMocGFyc2luZ0VuZ2luZXM6IFBhcnNpbmdFbmdpbmVDb25zdHJ1Y3RvcltdKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgRW5naW5lQ2xhc3Mgb2YgcGFyc2luZ0VuZ2luZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gRW5naW5lQ2xhc3MuaWQ7XG4gICAgICAgICAgICBpZiAodGhpcy5lbmdpbmVzW2lkXSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgUmVuZGVyaW5nIGVuZ2luZSAke2lkfSBhbHJlYWR5IHJlZ2lzdGVyZWQuYCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBlbmdpbmUgPSBuZXcgRW5naW5lQ2xhc3ModGhpcy5lZGl0b3IpO1xuICAgICAgICAgICAgdGhpcy5lbmdpbmVzW2lkXSA9IGVuZ2luZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxvYWRQYXJzZXJzKHBhcnNlcnM6IFBhcnNlckNvbnN0cnVjdG9yW10pOiB2b2lkIHtcbiAgICAgICAgcGFyc2VycyA9IFsuLi5wYXJzZXJzXS5yZXZlcnNlKCk7XG4gICAgICAgIGZvciAoY29uc3QgUGFyc2VyQ2xhc3Mgb2YgcGFyc2Vycykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBpZCBpbiB0aGlzLmVuZ2luZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJzaW5nRW5naW5lID0gdGhpcy5lbmdpbmVzW2lkXTtcbiAgICAgICAgICAgICAgICBjb25zdCBzdXBwb3J0ZWRUeXBlcyA9IFtpZCwgLi4ucGFyc2luZ0VuZ2luZS5jb25zdHJ1Y3Rvci5leHRlbmRzXTtcbiAgICAgICAgICAgICAgICBpZiAoc3VwcG9ydGVkVHlwZXMuaW5jbHVkZXMoUGFyc2VyQ2xhc3MuaWQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcnNpbmdFbmdpbmUucmVnaXN0ZXIoUGFyc2VyQ2xhc3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cbiIsImltcG9ydCBKV0VkaXRvciBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5cbmV4cG9ydCB0eXBlIFBhcnNpbmdJZGVudGlmaWVyID0gc3RyaW5nO1xuXG5leHBvcnQgaW50ZXJmYWNlIFBhcnNlcjxUID0ge30+IHtcbiAgICBwcmVkaWNhdGU/OiAoaXRlbTogVCkgPT4gYm9vbGVhbjtcbiAgICBwYXJzZTogKGl0ZW06IFQpID0+IFByb21pc2U8Vk5vZGVbXT47XG4gICAgY29uc3RydWN0b3I6IFBhcnNlckNvbnN0cnVjdG9yPFQ+O1xufVxuZXhwb3J0IHR5cGUgUGFyc2VyQ29uc3RydWN0b3I8VCA9IHt9PiA9IHtcbiAgICBuZXcgKC4uLmFyZ3MpOiBQYXJzZXI8VD47XG4gICAgaWQ6IFBhcnNpbmdJZGVudGlmaWVyO1xufTtcblxuZXhwb3J0IGNsYXNzIFBhcnNpbmdFbmdpbmU8VCA9IHt9PiB7XG4gICAgc3RhdGljIHJlYWRvbmx5IGlkOiBQYXJzaW5nSWRlbnRpZmllcjtcbiAgICBzdGF0aWMgcmVhZG9ubHkgZXh0ZW5kczogUGFyc2luZ0lkZW50aWZpZXJbXSA9IFtdO1xuICAgIHN0YXRpYyByZWFkb25seSBkZWZhdWx0UGFyc2VyOiBQYXJzZXJDb25zdHJ1Y3RvcjtcbiAgICByZWFkb25seSBlZGl0b3I6IEpXRWRpdG9yO1xuICAgIHJlYWRvbmx5IHBhcnNlcnM6IFBhcnNlcjxUPltdID0gW107XG4gICAgcmVhZG9ubHkgcGFyc2luZ01hcCA9IG5ldyBNYXA8VCwgVk5vZGVbXT4oKTtcblxuICAgIGNvbnN0cnVjdG9yKGVkaXRvcjogSldFZGl0b3IpIHtcbiAgICAgICAgdGhpcy5lZGl0b3IgPSBlZGl0b3I7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRQYXJzZXIgPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvci5kZWZhdWx0UGFyc2VyKHRoaXMpO1xuICAgICAgICBpZiAoZGVmYXVsdFBhcnNlci5wcmVkaWNhdGUpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRGVmYXVsdCByZW5kZXJlciBjYW5ub3QgaGF2ZSBhIHByZWRpY2F0ZS5gKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2Vycy5wdXNoKGRlZmF1bHRQYXJzZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVyIHRoZSBnaXZlbiBwYXJzZXIgYnkgaW5zdGFudGlhdGluZyBpdCB3aXRoIHRoaXMgcGFyc2VyIGVuZ2luZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBQYXJzZXJDbGFzc1xuICAgICAqL1xuICAgIHJlZ2lzdGVyKFBhcnNlckNsYXNzOiBQYXJzZXJDb25zdHJ1Y3RvcjxUPik6IHZvaWQge1xuICAgICAgICBpZiAoUGFyc2VyQ2xhc3MuaWQgPT09IHRoaXMuY29uc3RydWN0b3IuaWQpIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2Vycy51bnNoaWZ0KG5ldyBQYXJzZXJDbGFzcyh0aGlzKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBzdXBwb3J0ZWRUeXBlcyA9IFt0aGlzLmNvbnN0cnVjdG9yLmlkLCAuLi50aGlzLmNvbnN0cnVjdG9yLmV4dGVuZHNdO1xuICAgICAgICAgICAgY29uc3QgcHJpb3JQYXJzZXJJZHMgPSBzdXBwb3J0ZWRUeXBlcy5zbGljZSgwLCBzdXBwb3J0ZWRUeXBlcy5pbmRleE9mKFBhcnNlckNsYXNzLmlkKSk7XG4gICAgICAgICAgICBjb25zdCBwb3N0UGFyc2VySW5kZXggPSB0aGlzLnBhcnNlcnMuZmluZEluZGV4KFxuICAgICAgICAgICAgICAgIHBhcnNlciA9PiAhcHJpb3JQYXJzZXJJZHMuaW5jbHVkZXMocGFyc2VyLmNvbnN0cnVjdG9yLmlkKSxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB0aGlzLnBhcnNlcnMuc3BsaWNlKHBvc3RQYXJzZXJJbmRleCwgMCwgbmV3IFBhcnNlckNsYXNzKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZSBpdGVtcyBpbnRvIHRoZSBlZGl0b3IncyB2aXJ0dWFsIGBWTm9kZWAgcmVwcmVzZW50YXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbXMgdGhlIGl0ZW1zIHRvIHBhcnNlXG4gICAgICogQHJldHVybnMgUHJvbWlzZSByZXNvbHZlZCBieSB0aGUgZWxlbWVudCBwYXJzZWQgaW50byB0aGUgZWRpdG9yIHZpcnR1YWxcbiAgICAgKiBWTm9kZSByZXByZXNlbnRhdGlvblxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKC4uLml0ZW1zOiBUW10pOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgY29uc3Qgbm9kZXM6IFZOb2RlW10gPSBbXTtcbiAgICAgICAgY29uc3QgY2hpbGRQcm9taXNlcyA9IGl0ZW1zLm1hcChub2RlID0+IHRoaXMuX3BhcnNlSXRlbShub2RlKSk7XG4gICAgICAgIGNvbnN0IHJlc0xpc3QgPSBhd2FpdCBQcm9taXNlLmFsbChjaGlsZFByb21pc2VzKTtcbiAgICAgICAgZm9yIChjb25zdCByZXMgb2YgcmVzTGlzdCkge1xuICAgICAgICAgICAgbm9kZXMucHVzaCguLi5yZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHJpdmF0ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFBhcnNlIGFuIGl0ZW0gaW50byB0aGUgZWRpdG9yJ3MgdmlydHVhbCByZXByZXNlbnRhdGlvbi5cbiAgICAgKlxuICAgICAqL1xuICAgIGFzeW5jIF9wYXJzZUl0ZW0oaXRlbTogVCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBsZXQgbm9kZXM6IFZOb2RlW107XG4gICAgICAgIGZvciAoY29uc3QgcGFyc2VyIG9mIHRoaXMucGFyc2Vycykge1xuICAgICAgICAgICAgaWYgKCFwYXJzZXIucHJlZGljYXRlIHx8IHBhcnNlci5wcmVkaWNhdGUoaXRlbSkpIHtcbiAgICAgICAgICAgICAgICBub2RlcyA9IGF3YWl0IHBhcnNlci5wYXJzZShpdGVtKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZXMubGVuZ3RoID49IDEpIHtcbiAgICAgICAgICAgIHRoaXMucGFyc2luZ01hcC5zZXQoaXRlbSwgbm9kZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9XG59XG5leHBvcnQgdHlwZSBQYXJzaW5nRW5naW5lQ29uc3RydWN0b3I8VCA9IHt9PiA9IHtcbiAgICBuZXcgKC4uLmFyZ3M6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgUGFyc2luZ0VuZ2luZT4pOiBQYXJzaW5nRW5naW5lO1xuICAgIGlkOiBQYXJzaW5nSWRlbnRpZmllcjtcbiAgICBleHRlbmRzOiBQYXJzaW5nSWRlbnRpZmllcltdO1xuICAgIGRlZmF1bHRQYXJzZXI6IFBhcnNlckNvbnN0cnVjdG9yPFQ+O1xufTtcbmV4cG9ydCBpbnRlcmZhY2UgUGFyc2luZ0VuZ2luZTxUID0ge30+IHtcbiAgICBjb25zdHJ1Y3RvcjogUGFyc2luZ0VuZ2luZUNvbnN0cnVjdG9yO1xufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5pbXBvcnQgeyBQcmVYbWxEb21QYXJzZXIgfSBmcm9tICcuL1ByZVhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBQcmVIdG1sRG9tUmVuZGVyZXIgfSBmcm9tICcuL1ByZUh0bWxEb21SZW5kZXJlcic7XG5pbXBvcnQgeyBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBQcmVOb2RlIH0gZnJvbSAnLi9QcmVOb2RlJztcbmltcG9ydCB7IENvbnRhaW5lck5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvQ29udGFpbmVyTm9kZSc7XG5pbXBvcnQgeyBQcmVDaGFySHRtbERvbVJlbmRlcmVyIH0gZnJvbSAnLi9QcmVDaGFySHRtbERvbVJlbmRlcmVyJztcbmltcG9ydCB7IFByZVNlcGFyYXRvckh0bWxEb21SZW5kZXJlciB9IGZyb20gJy4vUHJlU2VwYXJhdG9ySHRtbERvbVJlbmRlcmVyJztcblxuZXhwb3J0IGNsYXNzIFByZTxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgY29tbWFuZHMgPSB7XG4gICAgICAgIGFwcGx5UHJlU3R5bGU6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuYXBwbHlQcmVTdHlsZSxcbiAgICAgICAgfSxcbiAgICB9O1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW1ByZVhtbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW1ByZUh0bWxEb21SZW5kZXJlciwgUHJlU2VwYXJhdG9ySHRtbERvbVJlbmRlcmVyLCBQcmVDaGFySHRtbERvbVJlbmRlcmVyXSxcbiAgICB9O1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIENoYW5nZSB0aGUgZm9ybWF0dGluZyBvZiB0aGUgbm9kZXMgaW4gZ2l2ZW4gcmFuZ2UgdG8gUHJlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFwcGx5UHJlU3R5bGUocGFyYW1zOiBDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiBwYXJhbXMuY29udGV4dC5yYW5nZS50YXJnZXRlZE5vZGVzKENvbnRhaW5lck5vZGUpKSB7XG4gICAgICAgICAgICBjb25zdCBwcmUgPSBuZXcgUHJlTm9kZSgpO1xuICAgICAgICAgICAgcHJlLm1vZGlmaWVycyA9IG5vZGUubW9kaWZpZXJzLmNsb25lKCk7XG4gICAgICAgICAgICBub2RlLnJlcGxhY2VXaXRoKHByZSk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgSldFZGl0b3IgZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUHJlTm9kZSB9IGZyb20gJy4vUHJlTm9kZSc7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICcuLi8uLi9wbHVnaW4tdG9vbGJhci9zcmMvVG9vbGJhcic7XG5cbmV4cG9ydCBjb25zdCBQcmVCdXR0b246IEJ1dHRvbiA9IHtcbiAgICB0aXRsZTogJ1ByZScsXG4gICAgY29tbWFuZElkOiAnYXBwbHlQcmVTdHlsZScsXG4gICAgc2VsZWN0ZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBlZGl0b3Iuc2VsZWN0aW9uLnJhbmdlLnRhcmdldGVkTm9kZXMoKS5ldmVyeShub2RlID0+IHtcbiAgICAgICAgICAgIHJldHVybiBub2RlLmNsb3Nlc3QoUHJlTm9kZSk7XG4gICAgICAgIH0pO1xuICAgIH0sXG59O1xuIiwiaW1wb3J0IHsgUHJlTm9kZSB9IGZyb20gJy4vUHJlTm9kZSc7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBDaGFyTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1jaGFyL3NyYy9DaGFyTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4taHRtbC9zcmMvSHRtbERvbVJlbmRlcmluZ0VuZ2luZSc7XG5cbmV4cG9ydCBjbGFzcyBQcmVDaGFySHRtbERvbVJlbmRlcmVyIGV4dGVuZHMgQWJzdHJhY3RSZW5kZXJlcjxOb2RlW10+IHtcbiAgICBzdGF0aWMgaWQgPSBIdG1sRG9tUmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogSHRtbERvbVJlbmRlcmluZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBWTm9kZSk6IGJvb2xlYW4gPT4gaXRlbS5pcyhDaGFyTm9kZSkgJiYgISFpdGVtLmFuY2VzdG9yKFByZU5vZGUpO1xuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBWTm9kZSB0byB0aGUgZ2l2ZW4gZm9ybWF0LlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihub2RlOiBDaGFyTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHJlbmRlcmluZyA9IGF3YWl0IHRoaXMuc3VwZXIucmVuZGVyKG5vZGUpO1xuICAgICAgICByZW5kZXJpbmdbMF0udGV4dENvbnRlbnQgPSByZW5kZXJpbmdbMF0udGV4dENvbnRlbnQucmVwbGFjZSgvXFx1MDBBMC9nLCAnICcpO1xuICAgICAgICByZXR1cm4gcmVuZGVyaW5nO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL0Fic3RyYWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IFByZU5vZGUgfSBmcm9tICcuL1ByZU5vZGUnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuXG5leHBvcnQgY2xhc3MgUHJlSHRtbERvbVJlbmRlcmVyIGV4dGVuZHMgQWJzdHJhY3RSZW5kZXJlcjxOb2RlW10+IHtcbiAgICBzdGF0aWMgaWQgPSBIdG1sRG9tUmVuZGVyaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogSHRtbERvbVJlbmRlcmluZ0VuZ2luZTtcbiAgICBwcmVkaWNhdGUgPSBQcmVOb2RlO1xuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBWTm9kZSB0byB0aGUgZ2l2ZW4gZm9ybWF0LlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihub2RlOiBQcmVOb2RlKTogUHJvbWlzZTxOb2RlW10+IHtcbiAgICAgICAgY29uc3QgcHJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncHJlJyk7XG4gICAgICAgIHRoaXMuZW5naW5lLnJlbmRlckF0dHJpYnV0ZXMoQXR0cmlidXRlcywgbm9kZSwgcHJlKTtcbiAgICAgICAgY29uc3QgcmVuZGVyZWRDaGlsZHJlbiA9IGF3YWl0IHRoaXMucmVuZGVyQ2hpbGRyZW4obm9kZSk7XG4gICAgICAgIHByZS5hcHBlbmQoLi4ucmVuZGVyZWRDaGlsZHJlbi5mbGF0KCkpO1xuICAgICAgICByZXR1cm4gW3ByZV07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcblxuZXhwb3J0IGNsYXNzIFByZU5vZGUgZXh0ZW5kcyBDb250YWluZXJOb2RlIHt9XG4iLCJpbXBvcnQgeyBQcmVOb2RlIH0gZnJvbSAnLi9QcmVOb2RlJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL0Fic3RyYWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcblxuZXhwb3J0IGNsYXNzIFByZVNlcGFyYXRvckh0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogVk5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgY29uc3QgRGVmYXVsdFNlcGFyYXRvciA9IHRoaXMuZW5naW5lLmVkaXRvci5jb25maWd1cmF0aW9uLmRlZmF1bHRzLlNlcGFyYXRvcjtcbiAgICAgICAgcmV0dXJuIGl0ZW0uaXMoRGVmYXVsdFNlcGFyYXRvcikgJiYgISFpdGVtLmFuY2VzdG9yKFByZU5vZGUpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGhlIFZOb2RlLlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihub2RlOiBWTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHNlcGFyYXRvcnMgPSBhd2FpdCB0aGlzLnN1cGVyLnJlbmRlcihub2RlKTtcbiAgICAgICAgY29uc3QgcmVuZGVyaW5nID0gc2VwYXJhdG9ycy5tYXAoKCkgPT4gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJ1xcbicpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZW5naW5lLnJlbmRlcmVkKFtub2RlXSwgW3RoaXMsIFByb21pc2UucmVzb2x2ZShyZW5kZXJpbmcpXSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUHJlTm9kZSB9IGZyb20gJy4vUHJlTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFByZVhtbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1BSRSc7XG4gICAgfTtcblxuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFByZU5vZGVbXT4ge1xuICAgICAgICBjb25zdCBwcmUgPSBuZXcgUHJlTm9kZSgpO1xuICAgICAgICBwcmUubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSkpO1xuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgIHByZS5hcHBlbmQoLi4uY2hpbGRyZW4pO1xuICAgICAgICByZXR1cm4gW3ByZV07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUmVuZGVyZXIsIFJlbmRlcmluZ0lkZW50aWZpZXIgfSBmcm9tICcuL1JlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBSZW5kZXJpbmdFbmdpbmUgfSBmcm9tICcuL1JlbmRlcmluZ0VuZ2luZSc7XG5pbXBvcnQgeyBWTm9kZSwgUHJlZGljYXRlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0UmVuZGVyZXI8VD4gaW1wbGVtZW50cyBSZW5kZXJlcjxUPiB7XG4gICAgc3RhdGljIGlkOiBSZW5kZXJpbmdJZGVudGlmaWVyO1xuICAgIHByZWRpY2F0ZT86IFByZWRpY2F0ZTtcbiAgICBlbmdpbmU6IFJlbmRlcmluZ0VuZ2luZTxUPjtcbiAgICBzdXBlcjogUmVuZGVyZXI8VD47XG4gICAgX3JlbmRlckNoaWxkTXV0ZXg6IE1hcDxWTm9kZSwgUHJvbWlzZTxUPj4gPSBuZXcgTWFwKCk7XG4gICAgY29uc3RydWN0b3IoZW5naW5lOiBSZW5kZXJpbmdFbmdpbmU8VD4sIHN1cGVyUmVuZGVyZXI6IFJlbmRlcmVyPFQ+KSB7XG4gICAgICAgIHRoaXMuZW5naW5lID0gZW5naW5lO1xuICAgICAgICB0aGlzLnN1cGVyID0gc3VwZXJSZW5kZXJlcjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBnaXZlbiBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBhYnN0cmFjdCByZW5kZXIobm9kZTogVk5vZGUpOiBQcm9taXNlPFQ+O1xuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgZ2l2ZW4gY2hpbGQgbm9kZS4gVGhpcyBmdW5jdGlvbiBlbnN1cmVzIHRoYXQgdGhlIHByb21pc2VcbiAgICAgKiBjb3JyZXNwb25kaW5nIHRvIHRoZSByZW5kZXJpbmcgb2YgZWFjaCBjaGlsZCBvZiB0aGUgc2FtZSBwYXJlbnQgd2lsbCBiZVxuICAgICAqIHJlc29sdmVkIGluIHRoZSBvcmRlciBpbiB3aGljaCBgcmVuZGVyQ2hpbGRgIHdhcyBjYWxsZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2hpbGRcbiAgICAgKi9cbiAgICBhc3luYyByZW5kZXJDaGlsZChjaGlsZDogVk5vZGUpOiBQcm9taXNlPFQ+IHtcbiAgICAgICAgY29uc3QgcGFyZW50ID0gY2hpbGQucGFyZW50O1xuICAgICAgICBhd2FpdCB0aGlzLl9yZW5kZXJDaGlsZE11dGV4LmdldChwYXJlbnQpO1xuICAgICAgICBjb25zdCByZW5kZXJlZENoaWxkID0gdGhpcy5lbmdpbmUucmVuZGVyKGNoaWxkKTtcbiAgICAgICAgdGhpcy5fcmVuZGVyQ2hpbGRNdXRleC5zZXQocGFyZW50LCByZW5kZXJlZENoaWxkKTtcbiAgICAgICAgcmV0dXJuIHJlbmRlcmVkQ2hpbGQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgY2hpbGRyZW4gb2YgZ2l2ZW4gbm9kZS4gUmV0dXJuIGEgcHJvbWlzZSByZXNvbHZlZCB3aXRoIHRoZVxuICAgICAqIHJlc3VsdCBvZiB0aGUgcmVuZGVyaW5nIG9mIGVhY2ggY2hpbGQgY29uY2F0ZW5hdGVkIGludG8gYSBzaW5nbGUgYXJyYXlcbiAgICAgKiBjb25zZXJ2aW5nIHRoZSBvcmRlciBvZiB0aGUgY2hpbGRyZW4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlckNoaWxkcmVuKG5vZGU6IFZOb2RlKTogUHJvbWlzZTxUW10+IHtcbiAgICAgICAgY29uc3QgcmVuZGVyZWRDaGlsZHJlbjogQXJyYXk8UHJvbWlzZTxUPj4gPSBbXTtcbiAgICAgICAgaWYgKG5vZGUuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBjaGlsZCBvZiBub2RlLmNoaWxkVk5vZGVzKSB7XG4gICAgICAgICAgICAgICAgcmVuZGVyZWRDaGlsZHJlbi5wdXNoKHRoaXMuZW5naW5lLnJlbmRlcihjaGlsZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZW5naW5lLnJlbmRlckVtcHR5KSB7XG4gICAgICAgICAgICByZW5kZXJlZENoaWxkcmVuLnB1c2godGhpcy5lbmdpbmUucmVuZGVyRW1wdHkobm9kZSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChyZW5kZXJlZENoaWxkcmVuKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbkNvbmZpZywgSldQbHVnaW4gfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQge1xuICAgIFJlbmRlcmVyQ29uc3RydWN0b3IsXG4gICAgUmVuZGVyaW5nSWRlbnRpZmllcixcbiAgICBSZW5kZXJpbmdFbmdpbmUsXG4gICAgUmVuZGVyaW5nRW5naW5lQ29uc3RydWN0b3IsXG59IGZyb20gJy4vUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcblxuZXhwb3J0IGNsYXNzIFJlbmRlcmVyPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBsb2FkZXJzID0ge1xuICAgICAgICByZW5kZXJpbmdFbmdpbmVzOiB0aGlzLmxvYWRSZW5kZXJpbmdFbmdpbmVzLFxuICAgICAgICByZW5kZXJlcnM6IHRoaXMubG9hZFJlbmRlcmVycyxcbiAgICB9O1xuICAgIGVuZ2luZXM6IFJlY29yZDxSZW5kZXJpbmdJZGVudGlmaWVyLCBSZW5kZXJpbmdFbmdpbmU+ID0ge307XG5cbiAgICBhc3luYyByZW5kZXI8VD4ocmVuZGVyaW5nSWQ6IHN0cmluZywgbm9kZTogVk5vZGUpOiBQcm9taXNlPFQgfCB2b2lkPiB7XG4gICAgICAgIGNvbnN0IGVuZ2luZSA9IHRoaXMuZW5naW5lc1tyZW5kZXJpbmdJZF07XG4gICAgICAgIGlmICghZW5naW5lKSB7XG4gICAgICAgICAgICAvLyBUaGUgY2FsbGVyIG1pZ2h0IHdhbnQgdG8gZmFsbGJhY2sgb24gYW5vdGhlciByZW5kZXJpbmcuXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZW5naW5lLnJlbmRlcmluZ3MuY2xlYXIoKTtcbiAgICAgICAgcmV0dXJuIGVuZ2luZS5yZW5kZXIobm9kZSkgYXMgUHJvbWlzZTxUPjtcbiAgICB9XG5cbiAgICBsb2FkUmVuZGVyaW5nRW5naW5lcyhyZW5kZXJpbmdFbmdpbmVzOiBSZW5kZXJpbmdFbmdpbmVDb25zdHJ1Y3RvcltdKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgRW5naW5lQ2xhc3Mgb2YgcmVuZGVyaW5nRW5naW5lcykge1xuICAgICAgICAgICAgY29uc3QgaWQgPSBFbmdpbmVDbGFzcy5pZDtcbiAgICAgICAgICAgIGlmICh0aGlzLmVuZ2luZXNbaWRdKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBSZW5kZXJpbmcgZW5naW5lICR7aWR9IGFscmVhZHkgcmVnaXN0ZXJlZC5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGVuZ2luZSA9IG5ldyBFbmdpbmVDbGFzcyh0aGlzLmVkaXRvcik7XG4gICAgICAgICAgICB0aGlzLmVuZ2luZXNbaWRdID0gZW5naW5lO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgbG9hZFJlbmRlcmVycyhyZW5kZXJlcnM6IFJlbmRlcmVyQ29uc3RydWN0b3JbXSk6IHZvaWQge1xuICAgICAgICByZW5kZXJlcnMgPSBbLi4ucmVuZGVyZXJzXS5yZXZlcnNlKCk7XG4gICAgICAgIGZvciAoY29uc3QgUmVuZGVyZXJDbGFzcyBvZiByZW5kZXJlcnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlcmluZ0VuZ2luZSA9IHRoaXMuZW5naW5lc1tSZW5kZXJlckNsYXNzLmlkXTtcbiAgICAgICAgICAgIGlmIChyZW5kZXJpbmdFbmdpbmUpIHtcbiAgICAgICAgICAgICAgICByZW5kZXJpbmdFbmdpbmUucmVnaXN0ZXIoUmVuZGVyZXJDbGFzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBWTm9kZSwgUHJlZGljYXRlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IENvbnN0cnVjdG9yIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcbmltcG9ydCBKV0VkaXRvciBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5cbmV4cG9ydCB0eXBlIFJlbmRlcmluZ0lkZW50aWZpZXIgPSBzdHJpbmc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVuZGVyZXI8VCA9IHt9PiB7XG4gICAgcHJlZGljYXRlPzogUHJlZGljYXRlO1xuICAgIHJlbmRlcjogKG5vZGU6IFZOb2RlKSA9PiBQcm9taXNlPFQ+O1xufVxuXG5leHBvcnQgdHlwZSBSZW5kZXJlckNvbnN0cnVjdG9yPFQgPSB7fT4gPSBDb25zdHJ1Y3RvcjxSZW5kZXJlcjxUPj4gJiB7XG4gICAgaWQ6IFJlbmRlcmluZ0lkZW50aWZpZXI7XG59O1xuXG5leHBvcnQgdHlwZSBSZW5kZXJpbmdFbmdpbmVDb25zdHJ1Y3RvcjxUID0ge30+ID0gQ29uc3RydWN0b3I8UmVuZGVyaW5nRW5naW5lPiAmIHtcbiAgICBpZDogUmVuZGVyaW5nSWRlbnRpZmllcjtcbiAgICBkZWZhdWx0UmVuZGVyZXI6IENvbnN0cnVjdG9yPFJlbmRlcmVyPFQ+Pjtcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVuZGVyaW5nRW5naW5lPFQgPSB7fT4ge1xuICAgIGNvbnN0cnVjdG9yOiBSZW5kZXJpbmdFbmdpbmVDb25zdHJ1Y3RvcjxUPjtcbn1cbmV4cG9ydCBjbGFzcyBSZW5kZXJpbmdFbmdpbmU8VCA9IHt9PiB7XG4gICAgc3RhdGljIHJlYWRvbmx5IGlkOiBSZW5kZXJpbmdJZGVudGlmaWVyO1xuICAgIHN0YXRpYyByZWFkb25seSBkZWZhdWx0UmVuZGVyZXI6IENvbnN0cnVjdG9yPFJlbmRlcmVyPjtcbiAgICByZWFkb25seSBlZGl0b3I6IEpXRWRpdG9yO1xuICAgIHJlYWRvbmx5IHJlbmRlcmVyczogUmVuZGVyZXI8VD5bXSA9IFtdO1xuICAgIHJlYWRvbmx5IHJlbmRlcmluZ3M6IE1hcDxWTm9kZSwgW1JlbmRlcmVyPFQ+LCBQcm9taXNlPFQ+XVtdPiA9IG5ldyBNYXAoKTtcblxuICAgIGNvbnN0cnVjdG9yKGVkaXRvcjogSldFZGl0b3IpIHtcbiAgICAgICAgdGhpcy5lZGl0b3IgPSBlZGl0b3I7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRSZW5kZXJlciA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yLmRlZmF1bHRSZW5kZXJlcih0aGlzKTtcbiAgICAgICAgaWYgKGRlZmF1bHRSZW5kZXJlci5wcmVkaWNhdGUpIHtcbiAgICAgICAgICAgIHRocm93IGBEZWZhdWx0IHJlbmRlcmVyIGNhbm5vdCBoYXZlIGEgcHJlZGljYXRlLmA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVycy5wdXNoKGRlZmF1bHRSZW5kZXJlcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlciB0aGUgZ2l2ZW4gcmVuZGVyZXIgYnkgaW5zdGFudGlhdGluZyBpdCB3aXRoIHRoaXMgcmVuZGVyaW5nXG4gICAgICogZW5naW5lLiBUaGUgcmVuZGVyZXIgY29uc3RydWN0b3Igd2lsbCByZWNlaXZlIGEgc3BlY2lhbCBzZWNvbmQgcGFyYW1ldGVyXG4gICAgICogd2hpY2ggaXMgYSBtYWdpYyByZW5kZXJlciB3aG9zZSBgcmVuZGVyYCBtZXRob2Qgd2lsbCBjYWxsIHRoZSBuZXh0XG4gICAgICogY29tcGF0aWJsZSByZW5kZXJlciBpbiBsaW5lIGZvciB0aGUgZ2l2ZW4gbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBSZW5kZXJlckNsYXNzXG4gICAgICovXG4gICAgcmVnaXN0ZXIoUmVuZGVyZXJDbGFzczogQ29uc3RydWN0b3I8UmVuZGVyZXI8VD4+KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHN1cGVyUmVuZGVyZXI6IFJlbmRlcmVyPFQ+ID0ge1xuICAgICAgICAgICAgcmVuZGVyOiB0aGlzLl9yZW5kZXIuYmluZCh0aGlzKSxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSBuZXcgUmVuZGVyZXJDbGFzcyh0aGlzLCBzdXBlclJlbmRlcmVyKTtcbiAgICAgICAgdGhpcy5yZW5kZXJlcnMudW5zaGlmdChyZW5kZXJlcik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBnaXZlbiBub2RlLiBJZiBhIHByaW9yIHJlbmRlcmluZyBhbHJlYWR5IGV4aXN0cyBmb3IgdGhpcyBub2RlXG4gICAgICogaW4gdGhpcyBydW4sIHJldHVybiBpdCBkaXJlY3RseS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgYXN5bmMgcmVuZGVyKG5vZGU6IFZOb2RlKTogUHJvbWlzZTxUPiB7XG4gICAgICAgIGNvbnN0IHJlbmRlcmluZ3MgPSB0aGlzLnJlbmRlcmluZ3MuZ2V0KG5vZGUpO1xuICAgICAgICBpZiAocmVuZGVyaW5ncyAmJiByZW5kZXJpbmdzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlbmRlcmluZ3NbMF1bMV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVuZGVyKG5vZGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVuZGVyIHRoZSBjb250ZW50cyBvZiBhIG5vZGUgdGhhdCBoYXMgbm8gY2hpbGRyZW4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZVxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlckVtcHR5Pyhub2RlOiBWTm9kZSk6IFByb21pc2U8VD47XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHJlbmRlcmluZyBvZiBzZXZlcmFsIG5vZGVzLCBzbyBhcyB0byBza2lwIHJlbmRlcmluZyB0aGVtIGFnYWluXG4gICAgICogbGF0ZXIgaW4gdGhlIHByb2Nlc3MuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbm9kZXNcbiAgICAgKiBAcGFyYW0gcmVuZGVyaW5nXG4gICAgICovXG4gICAgYXN5bmMgcmVuZGVyZWQobm9kZXM6IFZOb2RlW10sIHJlbmRlcmluZzogW1JlbmRlcmVyPFQ+LCBQcm9taXNlPFQ+XSk6IFByb21pc2U8VD4ge1xuICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygbm9kZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlcmluZ3MgPSB0aGlzLnJlbmRlcmluZ3MuZ2V0KG5vZGUpIHx8IFtdO1xuICAgICAgICAgICAgcmVuZGVyaW5ncy5wdXNoKHJlbmRlcmluZyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlbmRlcmluZ1sxXTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyIHRoZSByZW5kZXJpbmcgb2YgdGhlIGdpdmVuIG5vZGUgYnkgdGhlIG5leHQgY29tcGF0aWJsZSByZW5kZXJlclxuICAgICAqIHRoYXQgaGFzIG5vdCB5ZXQgcHJvZHVjZWQgYSByZW5kZXJpbmcgZm9yIHRoaXMgcnVuLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5vZGVcbiAgICAgKi9cbiAgICBhc3luYyBfcmVuZGVyKG5vZGU6IFZOb2RlKTogUHJvbWlzZTxUPiB7XG4gICAgICAgIGNvbnN0IHJlbmRlcmluZ3MgPSB0aGlzLnJlbmRlcmluZ3MuZ2V0KG5vZGUpIHx8IFtdO1xuICAgICAgICAvLyBUT0RPOiB0ZXN0IGFsbCByZW5kZXJzIHdpdGggcHJlZGljYXRlcyBiZWZvcmUgbm8gcHJlZGljYXRlc1xuICAgICAgICBjb25zdCBsYXN0UmVuZGVyaW5nID0gcmVuZGVyaW5nc1tyZW5kZXJpbmdzLmxlbmd0aCAtIDFdO1xuICAgICAgICBjb25zdCBsYXN0UmVuZGVyZXIgPSBsYXN0UmVuZGVyaW5nICYmIGxhc3RSZW5kZXJpbmdbMF07XG4gICAgICAgIGxldCBuZXh0UmVuZGVyZXJJbmRleCA9IHRoaXMucmVuZGVyZXJzLmluZGV4T2YobGFzdFJlbmRlcmVyKSArIDE7XG4gICAgICAgIGxldCBuZXh0UmVuZGVyZXI6IFJlbmRlcmVyPFQ+O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICBuZXh0UmVuZGVyZXIgPSB0aGlzLnJlbmRlcmVyc1tuZXh0UmVuZGVyZXJJbmRleF07XG4gICAgICAgICAgICBuZXh0UmVuZGVyZXJJbmRleCsrO1xuICAgICAgICB9IHdoaWxlIChuZXh0UmVuZGVyZXIgJiYgIW5vZGUudGVzdChuZXh0UmVuZGVyZXIucHJlZGljYXRlKSk7XG4gICAgICAgIGlmICghbmV4dFJlbmRlcmVyKSByZXR1cm47XG5cbiAgICAgICAgLy8gVGhpcyBwcm9taXNlIHdpbGwgYmUgcmV0dXJuZWQgc3luY2hyb25vdXNseSBhbmQgd2lsbCBiZSByZXNvbHZlZFxuICAgICAgICAvLyBsYXRlciB3aXRoIHRoZSBzYW1lIHJldHVybiB2YWx1ZSBhcyB0aGUgYXN5bmNocm9ub3VzIHJlbmRlciBjYWxsLlxuICAgICAgICBjb25zdCByZW5kZXJlclByb20gPSBuZXcgUHJvbWlzZTxUPigocmVzb2x2ZSk6IHZvaWQgPT4ge1xuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgICAgbmV4dFJlbmRlcmVyLnJlbmRlcihub2RlKS50aGVuKHJlc29sdmUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZW5kZXJpbmdzLnB1c2goW25leHRSZW5kZXJlciwgcmVuZGVyZXJQcm9tXSk7XG4gICAgICAgIHRoaXMucmVuZGVyaW5ncy5zZXQobm9kZSwgcmVuZGVyaW5ncyk7XG4gICAgICAgIHJldHVybiByZW5kZXJlclByb207XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgU3BhblhtbERvbVBhcnNlciB9IGZyb20gJy4vU3BhblhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBJbmxpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9JbmxpbmUnO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcblxuZXhwb3J0IGNsYXNzIFNwYW48VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbSW5saW5lXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbU3BhblhtbERvbVBhcnNlcl0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdCc7XG5cbmV4cG9ydCBjbGFzcyBTcGFuRm9ybWF0IGV4dGVuZHMgRm9ybWF0IHtcbiAgICBjb25zdHJ1Y3RvcihodG1sVGFnOiAnU1BBTicgfCAnRk9OVCcgPSAnU1BBTicpIHtcbiAgICAgICAgc3VwZXIoaHRtbFRhZyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgRm9ybWF0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvRm9ybWF0UGFyc2VyJztcbmltcG9ydCB7IFZOb2RlIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZOb2RlJztcbmltcG9ydCB7IFNwYW5Gb3JtYXQgfSBmcm9tICcuL1NwYW5Gb3JtYXQnO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgU3BhblhtbERvbVBhcnNlciBleHRlbmRzIEZvcm1hdFBhcnNlciB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgKG5vZGVOYW1lKGl0ZW0pID09PSAnU1BBTicgfHwgbm9kZU5hbWUoaXRlbSkgPT09ICdGT05UJyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgc3BhbiBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW1cbiAgICAgKi9cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHNwYW4gPSBuZXcgU3BhbkZvcm1hdChub2RlTmFtZShpdGVtKSBhcyAnU1BBTicgfCAnRk9OVCcpO1xuICAgICAgICBzcGFuLm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KHNwYW4sIGNoaWxkcmVuKTtcblxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgU3Vic2NyaXB0WG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9TdWJzY3JpcHRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5cbmV4cG9ydCBjbGFzcyBTdWJzY3JpcHQ8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbSW5saW5lXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxQYXJzZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbU3Vic2NyaXB0WG1sRG9tUGFyc2VyXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgRm9ybWF0IH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvRm9ybWF0JztcblxuZXhwb3J0IGNsYXNzIFN1YnNjcmlwdEZvcm1hdCBleHRlbmRzIEZvcm1hdCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdTVUInKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBGb3JtYXRQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9Gb3JtYXRQYXJzZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgU3Vic2NyaXB0Rm9ybWF0IH0gZnJvbSAnLi9TdWJzY3JpcHRGb3JtYXQnO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgU3Vic2NyaXB0WG1sRG9tUGFyc2VyIGV4dGVuZHMgRm9ybWF0UGFyc2VyIHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1NVQic7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgc3BhbiBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW1cbiAgICAgKi9cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHN1YnNjcmlwdCA9IG5ldyBTdWJzY3JpcHRGb3JtYXQoKTtcbiAgICAgICAgc3Vic2NyaXB0Lm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KHN1YnNjcmlwdCwgY2hpbGRyZW4pO1xuXG4gICAgICAgIHJldHVybiBjaGlsZHJlbjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBTdXBlcnNjcmlwdFhtbERvbVBhcnNlciB9IGZyb20gJy4vU3VwZXJzY3JpcHRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5cbmV4cG9ydCBjbGFzcyBTdXBlcnNjcmlwdDxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgc3RhdGljIGRlcGVuZGVuY2llcyA9IFtJbmxpbmVdO1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlcj4gPSB7XG4gICAgICAgIHBhcnNlcnM6IFtTdXBlcnNjcmlwdFhtbERvbVBhcnNlcl0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdCc7XG5cbmV4cG9ydCBjbGFzcyBTdXBlcnNjcmlwdEZvcm1hdCBleHRlbmRzIEZvcm1hdCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKCdTVVAnKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBGb3JtYXRQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9Gb3JtYXRQYXJzZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgU3VwZXJzY3JpcHRGb3JtYXQgfSBmcm9tICcuL1N1cGVyc2NyaXB0Rm9ybWF0JztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFN1cGVyc2NyaXB0WG1sRG9tUGFyc2VyIGV4dGVuZHMgRm9ybWF0UGFyc2VyIHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1NVUCc7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgc3BhbiBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW1cbiAgICAgKi9cbiAgICBhc3luYyBwYXJzZShpdGVtOiBFbGVtZW50KTogUHJvbWlzZTxWTm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHN1cGVyc2NyaXB0ID0gbmV3IFN1cGVyc2NyaXB0Rm9ybWF0KCk7XG4gICAgICAgIHN1cGVyc2NyaXB0Lm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICB0aGlzLmFwcGx5Rm9ybWF0KHN1cGVyc2NyaXB0LCBjaGlsZHJlbik7XG5cbiAgICAgICAgcmV0dXJuIGNoaWxkcmVuO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFRhYmxlWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9UYWJsZVhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzZXInO1xuaW1wb3J0IHsgVGFibGVSb3dYbWxEb21QYXJzZXIgfSBmcm9tICcuL1RhYmxlUm93WG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IFRhYmxlQ2VsbFhtbERvbVBhcnNlciB9IGZyb20gJy4vVGFibGVDZWxsWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IFRhYmxlSHRtbERvbVJlbmRlcmVyIH0gZnJvbSAnLi9UYWJsZUh0bWxEb21SZW5kZXJlcic7XG5pbXBvcnQgeyBUYWJsZVJvd0h0bWxEb21SZW5kZXJlciB9IGZyb20gJy4vVGFibGVSb3dIdG1sRG9tUmVuZGVyZXInO1xuaW1wb3J0IHsgVGFibGVDZWxsSHRtbERvbVJlbmRlcmVyIH0gZnJvbSAnLi9UYWJsZUNlbGxIdG1sRG9tUmVuZGVyZXInO1xuaW1wb3J0IHsgUmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL1JlbmRlcmVyJztcbmltcG9ydCB7IFRhYmxlQ2VsbE5vZGUgfSBmcm9tICcuL1RhYmxlQ2VsbE5vZGUnO1xuaW1wb3J0IHsgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgVGFibGVOb2RlIH0gZnJvbSAnLi9UYWJsZU5vZGUnO1xuaW1wb3J0IHsgZGlzdGluY3QgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgVGFibGVSb3dOb2RlIH0gZnJvbSAnLi9UYWJsZVJvd05vZGUnO1xuaW1wb3J0IHsgUmVsYXRpdmVQb3NpdGlvbiB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuXG5leHBvcnQgY2xhc3MgVGFibGU8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyICYgS2V5bWFwPiA9IHtcbiAgICAgICAgcGFyc2VyczogW1RhYmxlWG1sRG9tUGFyc2VyLCBUYWJsZVJvd1htbERvbVBhcnNlciwgVGFibGVDZWxsWG1sRG9tUGFyc2VyXSxcbiAgICAgICAgcmVuZGVyZXJzOiBbVGFibGVIdG1sRG9tUmVuZGVyZXIsIFRhYmxlUm93SHRtbERvbVJlbmRlcmVyLCBUYWJsZUNlbGxIdG1sRG9tUmVuZGVyZXJdLFxuICAgICAgICBzaG9ydGN1dHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCs8U2xhc2g+JyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdhZGRSb3dCZWxvdycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1NISUZUKzxTbGFzaD4nLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2FkZFJvd0Fib3ZlJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrPEVxdWFsPicsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnYWRkQ29sdW1uQWZ0ZXInLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtTSElGVCs8RXF1YWw+JyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdhZGRDb2x1bW5CZWZvcmUnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtTSElGVCtERUxFVEUnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ2RlbGV0ZVJvdycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1NISUZUK0JBQ0tTUEFDRScsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnZGVsZXRlQ29sdW1uJyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcGF0dGVybjogJ0NUUkwrQUxUK1NISUZUK0RFTEVURScsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnZGVsZXRlVGFibGUnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCs8UGVyaW9kPicsXG4gICAgICAgICAgICAgICAgY29tbWFuZElkOiAnbWVyZ2VDZWxscycsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1NISUZUKzxQZXJpb2Q+JyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd1bm1lcmdlQ2VsbHMnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICB9O1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBhZGRSb3dBYm92ZToge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5hZGRSb3dBYm92ZS5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBhZGRSb3dCZWxvdzoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5hZGRSb3dCZWxvdy5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBhZGRDb2x1bW5CZWZvcmU6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuYWRkQ29sdW1uQmVmb3JlLmJpbmQodGhpcyksXG4gICAgICAgIH0sXG4gICAgICAgIGFkZENvbHVtbkFmdGVyOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmFkZENvbHVtbkFmdGVyLmJpbmQodGhpcyksXG4gICAgICAgIH0sXG4gICAgICAgIGRlbGV0ZVJvdzoge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5kZWxldGVSb3cuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgZGVsZXRlQ29sdW1uOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLmRlbGV0ZUNvbHVtbi5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBkZWxldGVUYWJsZToge1xuICAgICAgICAgICAgaGFuZGxlcjogdGhpcy5kZWxldGVUYWJsZS5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgICAgICBtZXJnZUNlbGxzOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLm1lcmdlQ2VsbHMuYmluZCh0aGlzKSxcbiAgICAgICAgfSxcbiAgICAgICAgdW5tZXJnZUNlbGxzOiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnVubWVyZ2VDZWxscy5iaW5kKHRoaXMpLFxuICAgICAgICB9LFxuICAgIH07XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQWRkIGEgcm93IGFib3ZlIHRoZSBjZWxsIGF0IGdpdmVuIHJhbmdlIHN0YXJ0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFkZFJvd0Fib3ZlKHBhcmFtczogQ29tbWFuZFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBjZWxsID0gcmFuZ2Uuc3RhcnQuYW5jZXN0b3IoVGFibGVDZWxsTm9kZSk7XG4gICAgICAgIGlmICghY2VsbCkgcmV0dXJuO1xuXG4gICAgICAgIGNlbGwuYW5jZXN0b3IoVGFibGVOb2RlKS5hZGRSb3dBYm92ZShjZWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgcm93IGJlbG93IHRoZSBjZWxsIGF0IGdpdmVuIHJhbmdlIHN0YXJ0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFkZFJvd0JlbG93KHBhcmFtczogQ29tbWFuZFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCByb3cgPSByYW5nZS5zdGFydC5hbmNlc3RvcihUYWJsZUNlbGxOb2RlKTtcbiAgICAgICAgaWYgKCFyb3cpIHJldHVybjtcblxuICAgICAgICByb3cuYW5jZXN0b3IoVGFibGVOb2RlKS5hZGRSb3dCZWxvdyhyb3cpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgYSBjb2x1bW4gYmVmb3JlIHRoZSBjZWxsIGF0IGdpdmVuIHJhbmdlIHN0YXJ0LlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIGFkZENvbHVtbkJlZm9yZShwYXJhbXM6IENvbW1hbmRQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3QgY2VsbCA9IHJhbmdlLnN0YXJ0LmFuY2VzdG9yKFRhYmxlQ2VsbE5vZGUpO1xuICAgICAgICBpZiAoIWNlbGwpIHJldHVybjtcblxuICAgICAgICBjZWxsLmFuY2VzdG9yKFRhYmxlTm9kZSkuYWRkQ29sdW1uQmVmb3JlKGNlbGwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgYSBjb2x1bW4gYWZ0ZXIgdGhlIGNlbGwgYXQgZ2l2ZW4gcmFuZ2Ugc3RhcnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgYWRkQ29sdW1uQWZ0ZXIocGFyYW1zOiBDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGNlbGwgPSByYW5nZS5zdGFydC5hbmNlc3RvcihUYWJsZUNlbGxOb2RlKTtcbiAgICAgICAgaWYgKCFjZWxsKSByZXR1cm47XG5cbiAgICAgICAgY2VsbC5hbmNlc3RvcihUYWJsZU5vZGUpLmFkZENvbHVtbkFmdGVyKGNlbGwpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgdGhlIHJvdyBhdCBnaXZlbiByYW5nZSBzdGFydC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBkZWxldGVSb3cocGFyYW1zOiBDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGNlbGwgPSByYW5nZS5zdGFydC5hbmNlc3RvcihUYWJsZUNlbGxOb2RlKTtcbiAgICAgICAgaWYgKCFjZWxsKSByZXR1cm47XG5cbiAgICAgICAgY29uc3Qgcm93ID0gY2VsbC5hbmNlc3RvcihUYWJsZVJvd05vZGUpO1xuICAgICAgICBjb25zdCBuZXh0Um93ID0gcm93Lm5leHRTaWJsaW5nKFRhYmxlUm93Tm9kZSkgfHwgcm93LnByZXZpb3VzU2libGluZyhUYWJsZVJvd05vZGUpO1xuICAgICAgICBjb25zdCBuZXh0Q2VsbCA9IG5leHRSb3cgJiYgbmV4dFJvdy5jaGlsZHJlbihUYWJsZUNlbGxOb2RlKVtjZWxsLmNvbHVtbkluZGV4XTtcblxuICAgICAgICBpZiAobmV4dENlbGwpIHtcbiAgICAgICAgICAgIGNvbnN0IG5leHRSb3dJbmRleCA9IG5leHRDZWxsLnJvd0luZGV4O1xuXG4gICAgICAgICAgICAvLyBIYW5kbGUgcm93c3BhbnMuXG4gICAgICAgICAgICBjb25zdCBjZWxscyA9IHJvdy5jaGlsZHJlbihUYWJsZUNlbGxOb2RlKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgY2VsbCBvZiBjZWxscykge1xuICAgICAgICAgICAgICAgIGlmIChjZWxsLnJvd3NwYW4gPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENlbGxzIG1hbmFnZWQgYnkgdGhpcyBjZWxsIHdpbGwgbm93IGJlIG1hbmFnZWQgYnkgdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIGNlbGwgYmVsb3cgKG9yIGFib3ZlIGlmIHRoZXJlIGlzIG5vbmUgYmVsb3cpIGluc3RlYWQuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGJlbG93Q2VsbCA9IEFycmF5LmZyb20oY2VsbC5tYW5hZ2VkQ2VsbHMpLmZpbmQoXG4gICAgICAgICAgICAgICAgICAgICAgICBtYW5hZ2VkQ2VsbCA9PiBtYW5hZ2VkQ2VsbC5yb3dJbmRleCA9PT0gbmV4dFJvd0luZGV4LFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYmVsb3dDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiZWxvd0NlbGwudW5tZXJnZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBtYW5hZ2VkQ2VsbCBvZiBjZWxsLm1hbmFnZWRDZWxscykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYW5hZ2VkQ2VsbCAhPT0gYmVsb3dDZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZWRDZWxsLm1lcmdlV2l0aChiZWxvd0NlbGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWNlbGwuaXNBY3RpdmUoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGlzIGNlbGwgaXMgaW5hY3RpdmUsIHVubWVyZ2UgaXQgc28gaXRzIG1hbmFnZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gZG9lc24ndCBiZWxpZXZlIGl0IHN0aWxsIG1hbmFnZXMgaXQuXG4gICAgICAgICAgICAgICAgICAgIGNlbGwudW5tZXJnZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgcm93LlxuICAgICAgICAgICAgcm93LnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAvLyBUaGUgcGxhY2Ugd2hlcmUgdGhlIHJhbmdlIHVzZWQgdG8gbGl2ZSB3YXMganVzdCBkZW1vbGlzaGVkLiBHaXZlXG4gICAgICAgICAgICAvLyBpdCBzaGVsdGVyIHdpdGhpbiB0aGUgbmV4dCBhY3RpdmUgY2VsbC5cbiAgICAgICAgICAgIGNvbnN0IG5leHRBY3RpdmVDZWxsID0gbmV4dENlbGwubWFuYWdlckNlbGwgfHwgbmV4dENlbGw7XG4gICAgICAgICAgICByYW5nZS5zZXRTdGFydChuZXh0QWN0aXZlQ2VsbC5maXJzdExlYWYoKSwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpO1xuICAgICAgICAgICAgcmFuZ2UuY29sbGFwc2UoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIElmIHRoZXJlIGlzIG5vIGBuZXh0Q2VsbGAsIHdlJ3JlIHRyeWluZyB0byBkZWxldGUgdGhlIG9ubHkgcm93IGluXG4gICAgICAgICAgICAvLyB0aGlzIHRhYmxlIHNvIGp1c3QgcmVtb3ZlIHRoZSB0YWJsZS5cbiAgICAgICAgICAgIHRoaXMuZGVsZXRlVGFibGUocGFyYW1zKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgdGhlIGNvbHVtbiBhdCBnaXZlbiByYW5nZSBzdGFydC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBkZWxldGVDb2x1bW4ocGFyYW1zOiBDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGNlbGwgPSByYW5nZS5zdGFydC5hbmNlc3RvcihUYWJsZUNlbGxOb2RlKTtcbiAgICAgICAgaWYgKCFjZWxsKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgY29sdW1uID0gY2VsbC5jb2x1bW47XG4gICAgICAgIGNvbnN0IG5leHRDZWxsID0gY2VsbC5uZXh0U2libGluZyhUYWJsZUNlbGxOb2RlKSB8fCBjZWxsLnByZXZpb3VzU2libGluZyhUYWJsZUNlbGxOb2RlKTtcblxuICAgICAgICBpZiAobmV4dENlbGwpIHtcbiAgICAgICAgICAgIGNvbnN0IG5leHRDb2x1bW5JbmRleCA9IG5leHRDZWxsLmNvbHVtbkluZGV4O1xuXG4gICAgICAgICAgICAvLyBIYW5kbGUgY29sc3BhbnMgYW5kIGNlbGwgcmVtb3ZhbC5cbiAgICAgICAgICAgIGZvciAoY29uc3QgY2VsbCBvZiBjb2x1bW4pIHtcbiAgICAgICAgICAgICAgICBpZiAoY2VsbC5jb2xzcGFuID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDZWxscyBtYW5hZ2VkIGJ5IHRoaXMgY2VsbCB3aWxsIG5vdyBiZSBtYW5hZ2VkIGJ5IHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBjZWxsIGFmdGVyIChvciBiZWZvcmUgaWYgdGhlcmUgaXMgbm9uZSBhZnRlcikgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYWZ0ZXJDZWxsID0gQXJyYXkuZnJvbShjZWxsLm1hbmFnZWRDZWxscykuZmluZChcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hbmFnZWRDZWxsID0+IG1hbmFnZWRDZWxsLmNvbHVtbkluZGV4ID09PSBuZXh0Q29sdW1uSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhZnRlckNlbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFmdGVyQ2VsbC51bm1lcmdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1hbmFnZWRDZWxsIG9mIGNlbGwubWFuYWdlZENlbGxzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hbmFnZWRDZWxsICE9PSBhZnRlckNlbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFuYWdlZENlbGwubWVyZ2VXaXRoKGFmdGVyQ2VsbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghY2VsbC5pc0FjdGl2ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgY2VsbCBpcyBpbmFjdGl2ZSwgdW5tZXJnZSBpdCBzbyBpdHMgbWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAvLyBkb2Vzbid0IGJlbGlldmUgaXQgc3RpbGwgbWFuYWdlcyBpdC5cbiAgICAgICAgICAgICAgICAgICAgY2VsbC51bm1lcmdlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgY2VsbC5cbiAgICAgICAgICAgICAgICBjZWxsLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgLy8gVGhlIHBsYWNlIHdoZXJlIHRoZSByYW5nZSB1c2VkIHRvIGxpdmUgd2FzIGp1c3QgZGVtb2xpc2hlZC5cbiAgICAgICAgICAgICAgICAvLyBHaXZlIGl0IHNoZWx0ZXIgd2l0aGluIHRoZSBuZXh0IGFjdGl2ZSBjZWxsLlxuICAgICAgICAgICAgICAgIGNvbnN0IG5leHRNYW5hZ2VyQ2VsbCA9IG5leHRDZWxsLm1hbmFnZXJDZWxsIHx8IG5leHRDZWxsO1xuICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KG5leHRNYW5hZ2VyQ2VsbC5maXJzdExlYWYoKSwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpO1xuICAgICAgICAgICAgICAgIHJhbmdlLmNvbGxhcHNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBJZiB0aGVyZSBpcyBubyBgbmV4dENlbGxgLCB3ZSdyZSB0cnlpbmcgdG8gZGVsZXRlIHRoZSBvbmx5IGNvbHVtblxuICAgICAgICAgICAgLy8gaW4gdGhpcyB0YWJsZSBzbyBqdXN0IHJlbW92ZSB0aGUgdGFibGUuXG4gICAgICAgICAgICB0aGlzLmRlbGV0ZVRhYmxlKHBhcmFtcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlIHRoZSB0YWJsZSBhdCBnaXZlbiByYW5nZSBzdGFydC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBkZWxldGVUYWJsZShwYXJhbXM6IENvbW1hbmRQYXJhbXMpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmFuZ2UgPSBwYXJhbXMuY29udGV4dC5yYW5nZTtcbiAgICAgICAgY29uc3QgdGFibGUgPSByYW5nZS5zdGFydC5hbmNlc3RvcihUYWJsZU5vZGUpO1xuICAgICAgICBpZiAoIXRhYmxlKSByZXR1cm47XG5cbiAgICAgICAgY29uc3QgbmV4dFNpYmxpbmcgPSB0YWJsZS5uZXh0U2libGluZygpO1xuICAgICAgICBjb25zdCBwcmV2aW91c1NpYmxpbmcgPSB0YWJsZS5wcmV2aW91c1NpYmxpbmcoKTtcbiAgICAgICAgaWYgKG5leHRTaWJsaW5nKSB7XG4gICAgICAgICAgICByYW5nZS5zZXRTdGFydChuZXh0U2libGluZy5maXJzdExlYWYoKSwgUmVsYXRpdmVQb3NpdGlvbi5CRUZPUkUpO1xuICAgICAgICAgICAgcmFuZ2UuY29sbGFwc2UoKTtcbiAgICAgICAgfSBlbHNlIGlmIChwcmV2aW91c1NpYmxpbmcpIHtcbiAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHByZXZpb3VzU2libGluZy5sYXN0TGVhZigpLCBSZWxhdGl2ZVBvc2l0aW9uLkFGVEVSKTtcbiAgICAgICAgICAgIHJhbmdlLmNvbGxhcHNlKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGFibGUucmVtb3ZlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE1lcmdlIHRoZSBjZWxscyBhdCBnaXZlbiByYW5nZSBpbnRvIHRoZSBmaXJzdCBjZWxsIGF0IGdpdmVuIHJhbmdlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIG1lcmdlQ2VsbHMocGFyYW1zOiBDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJhbmdlID0gcGFyYW1zLmNvbnRleHQucmFuZ2U7XG4gICAgICAgIGNvbnN0IGNlbGxzID0gcmFuZ2UudGFyZ2V0ZWROb2RlcyhUYWJsZUNlbGxOb2RlKTtcbiAgICAgICAgaWYgKHRoaXMuX2lzUmVjdGFuZ2xlKGNlbGxzKSkge1xuICAgICAgICAgICAgLy8gT25seSBtZXJnZSB0aGUgY2VsbHMgaWYgdGhleSB3b3VsZCBub3QgaW1wbHkgdG8gbWVyZ2VcbiAgICAgICAgICAgIC8vIHVucmVsYXRlZCBjZWxscywgaWUuIHRoZSBzZWxlY3RlZCBjZWxscyBmb3JtIGEgcmVjdGFuZ2xlLlxuICAgICAgICAgICAgY29uc3QgbWFuYWdlckNlbGwgPSBjZWxscy5zaGlmdCgpO1xuICAgICAgICAgICAgY29uc3QgU2VwYXJhdG9yID0gdGhpcy5lZGl0b3IuY29uZmlndXJhdGlvbi5kZWZhdWx0cy5TZXBhcmF0b3I7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNlbGwgb2YgY2VsbHMpIHtcbiAgICAgICAgICAgICAgICBpZiAobWFuYWdlckNlbGwuaGFzQ2hpbGRyZW4oKSkge1xuICAgICAgICAgICAgICAgICAgICBtYW5hZ2VyQ2VsbC5hcHBlbmQobmV3IFNlcGFyYXRvcigpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2VsbC5tZXJnZVdpdGgobWFuYWdlckNlbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVubWVyZ2UgcHJldmlvdXNseSBtZXJnZWQgY2VsbHMgYXQgZ2l2ZW4gcmFuZ2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgdW5tZXJnZUNlbGxzKHBhcmFtczogQ29tbWFuZFBhcmFtcyk6IHZvaWQge1xuICAgICAgICBjb25zdCByYW5nZSA9IHBhcmFtcy5jb250ZXh0LnJhbmdlO1xuICAgICAgICBjb25zdCBjZWxscyA9IHJhbmdlLnRhcmdldGVkTm9kZXMoVGFibGVDZWxsTm9kZSk7XG4gICAgICAgIGZvciAoY29uc3QgY2VsbCBvZiBjZWxscykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBtYW5hZ2VkQ2VsbCBvZiBjZWxsLm1hbmFnZWRDZWxscykge1xuICAgICAgICAgICAgICAgIG1hbmFnZWRDZWxsLnVubWVyZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIGFycmF5IG9mIGNlbGxzIGZvcm1zIGEgcmVjdGFuZ2xlIGluIHRoZSB0YWJsZVxuICAgICAqIGdyaWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2VsbHNcbiAgICAgKi9cbiAgICBfaXNSZWN0YW5nbGUoY2VsbHM6IFRhYmxlQ2VsbE5vZGVbXSk6IGJvb2xlYW4ge1xuICAgICAgICBjZWxscyA9IFsuLi5jZWxsc107XG5cbiAgICAgICAgLy8gQWRkIG1hbmFnZWQgY2VsbHMgdG8gdGhlIGxpc3QuXG4gICAgICAgIGZvciAoY29uc3QgY2VsbCBvZiBbLi4uY2VsbHNdKSB7XG4gICAgICAgICAgICBpZiAoY2VsbC5tYW5hZ2VkQ2VsbHMuc2l6ZSkge1xuICAgICAgICAgICAgICAgIGNlbGxzLnB1c2goLi4uY2VsbC5tYW5hZ2VkQ2VsbHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNlbGxzID0gZGlzdGluY3QoY2VsbHMpO1xuXG4gICAgICAgIC8vIENvbXB1dGUgdGhlIHJvdy9jb2x1bW4gaW5kZXggZXh0cmVtYS5cbiAgICAgICAgY29uc3Qgcm93SW5kaWNlcyA9IGNlbGxzLm1hcChjZWxsID0+IGNlbGwucm93SW5kZXgpO1xuICAgICAgICBjb25zdCBjb2x1bW5JbmRpY2VzID0gY2VsbHMubWFwKGNlbGwgPT4gY2VsbC5jb2x1bW5JbmRleCk7XG4gICAgICAgIGNvbnN0IG1pblJvd0luZGV4ID0gTWF0aC5taW4oLi4ucm93SW5kaWNlcyk7XG4gICAgICAgIGNvbnN0IG1pbkNvbHVtbkluZGV4ID0gTWF0aC5taW4oLi4uY29sdW1uSW5kaWNlcyk7XG4gICAgICAgIGNvbnN0IG1heFJvd0luZGV4ID0gTWF0aC5tYXgoLi4ucm93SW5kaWNlcyk7XG4gICAgICAgIGNvbnN0IG1heENvbHVtbkluZGV4ID0gTWF0aC5tYXgoLi4uY29sdW1uSW5kaWNlcyk7XG5cbiAgICAgICAgLy8gSWYgYSBjZWxsIGJldHdlZW4gdGhlIGV4dHJlbWEgY2Fubm90IGJlIGZvdW5kIGluIHRoZSBsaXN0LCB0aGVcbiAgICAgICAgLy8gc2VsZWN0ZWQgY2VsbHMgZG8gbm90IGZvcm0gYSByZWN0YW5nbGUuXG4gICAgICAgIGZvciAobGV0IHJvd0luZGV4ID0gbWluUm93SW5kZXg7IHJvd0luZGV4IDw9IG1heFJvd0luZGV4OyByb3dJbmRleCsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBjb2x1bW5JbmRleCA9IG1pbkNvbHVtbkluZGV4OyBjb2x1bW5JbmRleCA8PSBtYXhDb2x1bW5JbmRleDsgY29sdW1uSW5kZXgrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBjZWxscy5maW5kKGNlbGwgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2VsbC5yb3dJbmRleCA9PT0gcm93SW5kZXggJiYgY2VsbC5jb2x1bW5JbmRleCA9PT0gY29sdW1uSW5kZXg7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgaWYgKCFjZWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IFRhYmxlQ2VsbE5vZGUgfSBmcm9tICcuL1RhYmxlQ2VsbE5vZGUnO1xuaW1wb3J0IHsgSHRtbERvbVJlbmRlcmluZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1odG1sL3NyYy9IdG1sRG9tUmVuZGVyaW5nRW5naW5lJztcbmltcG9ydCB7IEF0dHJpYnV0ZXMgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9BdHRyaWJ1dGVzJztcblxuZXhwb3J0IGNsYXNzIFRhYmxlQ2VsbEh0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gVGFibGVDZWxsTm9kZTtcblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgVGFibGVDZWxsTm9kZSBhbG9uZyB3aXRoIGl0cyBjb250ZW50cy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjZWxsXG4gICAgICovXG4gICAgYXN5bmMgcmVuZGVyKGNlbGw6IFRhYmxlQ2VsbE5vZGUpOiBQcm9taXNlPE5vZGVbXT4ge1xuICAgICAgICAvLyBJZiB0aGUgY2VsbCBpcyBub3QgYWN0aXZlLCBkbyBub3QgcmVuZGVyIGl0IChpdCBtZWFucyBpdCBpc1xuICAgICAgICAvLyByZXByZXNlbnRlZCBieSBpdHMgbWFuYWdlciBjZWxsJ3MgY29sc3BhbiBvciByb3dzcGFuOiBpdCB3YXMgbWVyZ2VkKS5cbiAgICAgICAgaWYgKCFjZWxsLmlzQWN0aXZlKCkpIHJldHVybiBbXTtcblxuICAgICAgICAvLyBSZW5kZXIgdGhlIGNlbGwgYW5kIGl0cyBjb250ZW50cy5cbiAgICAgICAgY29uc3QgdGQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KGNlbGwuaGVhZGVyID8gJ3RoJyA6ICd0ZCcpO1xuICAgICAgICBjb25zdCByZW5kZXJlZENoaWxkcmVuID0gYXdhaXQgdGhpcy5yZW5kZXJDaGlsZHJlbihjZWxsKTtcbiAgICAgICAgdGQuYXBwZW5kKC4uLnJlbmRlcmVkQ2hpbGRyZW4uZmxhdCgpKTtcblxuICAgICAgICAvLyBSZW5kZXIgYXR0cmlidXRlcy5cbiAgICAgICAgLy8gQ29sc3BhbiBhbmQgcm93c3BhbiBhcmUgaGFuZGxlZCBkaWZmZXJlbnRseSBmcm9tIG90aGVyIGF0dHJpYnV0ZXM6XG4gICAgICAgIC8vIHRoZXkgYXJlIGF1dG9tYXRpY2FsbHkgY2FsY3VsYXRlZCBpbiBmdW5jdGlvbiBvZiB0aGUgY2VsbCdzIG1hbmFnZWRcbiAgICAgICAgLy8gY2VsbHMuIFJlbmRlciB0aGVtIGhlcmUuIElmIHRoZWlyIHZhbHVlIGlzIDEgb3IgbGVzcywgdGhleSBhcmVcbiAgICAgICAgLy8gaW5zaWduaWZpY2FudCBzbyBubyBuZWVkIHRvIHJlbmRlciB0aGVtLlxuICAgICAgICBpZiAoY2VsbC5jb2xzcGFuID4gMSkge1xuICAgICAgICAgICAgY2VsbC5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnNldCgnY29sc3BhbicsICcnICsgY2VsbC5jb2xzcGFuKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2VsbC5yb3dzcGFuID4gMSkge1xuICAgICAgICAgICAgY2VsbC5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnNldCgncm93c3BhbicsICcnICsgY2VsbC5yb3dzcGFuKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVuZ2luZS5yZW5kZXJBdHRyaWJ1dGVzKEF0dHJpYnV0ZXMsIGNlbGwsIHRkKTtcbiAgICAgICAgY2VsbC5tb2RpZmllcnMuZ2V0KEF0dHJpYnV0ZXMpLnJlbW92ZSgnY29sc3BhbicpO1xuICAgICAgICBjZWxsLm1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykucmVtb3ZlKCdyb3dzcGFuJyk7XG5cbiAgICAgICAgcmV0dXJuIFt0ZF07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgVGFibGVOb2RlIH0gZnJvbSAnLi9UYWJsZU5vZGUnO1xuaW1wb3J0IHsgVGFibGVSb3dOb2RlIH0gZnJvbSAnLi9UYWJsZVJvd05vZGUnO1xuaW1wb3J0IHsgQ29udGFpbmVyTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9Db250YWluZXJOb2RlJztcblxuZXhwb3J0IGNsYXNzIFRhYmxlQ2VsbE5vZGUgZXh0ZW5kcyBDb250YWluZXJOb2RlIHtcbiAgICBicmVha2FibGUgPSBmYWxzZTtcbiAgICBoZWFkZXI6IGJvb2xlYW47XG4gICAgLy8gT25seSB0aGUgYG1hbmFnZXJDZWxsYCBzZXR0ZXIgc2hvdWxkIG1vZGlmeSB0aGUgZm9sbG93aW5nIHByaXZhdGUga2V5cy5cbiAgICBfX21hbmFnZXJDZWxsOiBUYWJsZUNlbGxOb2RlO1xuICAgIF9fbWFuYWdlZENlbGxzID0gbmV3IFNldDxUYWJsZUNlbGxOb2RlPigpO1xuXG4gICAgY29uc3RydWN0b3IocGFyYW1zPzogeyBoZWFkZXI6IGJvb2xlYW4gfSkge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICB0aGlzLmhlYWRlciA9IHBhcmFtcz8uaGVhZGVyIHx8IGZhbHNlO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBuZXcgVk5vZGUgd2l0aCB0aGUgc2FtZSB0eXBlIGFuZCBhdHRyaWJ1dGVzIGFzIHRoaXMgVk5vZGUuXG4gICAgICpcbiAgICAgKiAgQG92ZXJyaWRlXG4gICAgICovXG4gICAgY2xvbmUoZGVlcENsb25lPzogYm9vbGVhbiwgcGFyYW1zPzoge30pOiB0aGlzIHtcbiAgICAgICAgY29uc3QgZGVmYXVsdHM6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgVGFibGVDZWxsTm9kZT5bMF0gPSB7XG4gICAgICAgICAgICBoZWFkZXI6IHRoaXMuaGVhZGVyLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gc3VwZXIuY2xvbmUoZGVlcENsb25lLCB7IC4uLmRlZmF1bHRzLCAuLi5wYXJhbXMgfSk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEdldHRlcnNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICBsZXQgY29vcmRpbmF0ZXNSZXByID0gJyA8KCcgKyB0aGlzLnJvd0luZGV4ICsgJywgJyArIHRoaXMuY29sdW1uSW5kZXggKyAnKSc7XG4gICAgICAgIGlmICh0aGlzLmNvbHNwYW4gPiAxIHx8IHRoaXMucm93c3BhbiA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVuZFJvdyA9IHRoaXMucm93SW5kZXggKyB0aGlzLnJvd3NwYW4gLSAxO1xuICAgICAgICAgICAgY29uc3QgZW5kQ29sdW1uID0gdGhpcy5jb2x1bW5JbmRleCArIHRoaXMuY29sc3BhbiAtIDE7XG4gICAgICAgICAgICBjb29yZGluYXRlc1JlcHIgKz0gJzooJyArIGVuZFJvdyArICcsICcgKyBlbmRDb2x1bW4gKyAnKSc7XG4gICAgICAgIH1cbiAgICAgICAgY29vcmRpbmF0ZXNSZXByICs9ICc+JztcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHN1cGVyLm5hbWUgK1xuICAgICAgICAgICAgY29vcmRpbmF0ZXNSZXByICtcbiAgICAgICAgICAgICh0aGlzLmhlYWRlciA/ICc6IGhlYWRlcicgOiAnJykgK1xuICAgICAgICAgICAgKHRoaXMuaXNBY3RpdmUoKSA/ICcnIDogJyAoaW5hY3RpdmUpJylcbiAgICAgICAgKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBjZWxsIHRoYXQgbWFuYWdlcyB0aGlzIGNlbGwsIGlmIGFueS5cbiAgICAgKi9cbiAgICBnZXQgbWFuYWdlckNlbGwoKTogVGFibGVDZWxsTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9fbWFuYWdlckNlbGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgc2V0IG9mIGNlbGxzIHRoYXQgdGhpcyBjZWxsIG1hbmFnZXMuXG4gICAgICovXG4gICAgZ2V0IG1hbmFnZWRDZWxscygpOiBTZXQ8VGFibGVDZWxsTm9kZT4ge1xuICAgICAgICByZXR1cm4gbmV3IFNldCh0aGlzLl9fbWFuYWdlZENlbGxzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBjb21wdXRlZCBjb2x1bW4gc3BhbiBvZiB0aGlzIGNlbGwsIGluIGZ1bmN0aW9uIG9mIGl0cyBtYW5hZ2VkXG4gICAgICogY2VsbHMuXG4gICAgICovXG4gICAgZ2V0IGNvbHNwYW4oKTogbnVtYmVyIHtcbiAgICAgICAgY29uc3QgY2VsbHNBcnJheSA9IEFycmF5LmZyb20odGhpcy5tYW5hZ2VkQ2VsbHMpO1xuICAgICAgICBjb25zdCBzYW1lUm93Q2VsbHMgPSBjZWxsc0FycmF5LmZpbHRlcihjZWxsID0+IGNlbGwucm93SW5kZXggPT09IHRoaXMucm93SW5kZXgpO1xuICAgICAgICByZXR1cm4gMSArIHNhbWVSb3dDZWxscy5sZW5ndGg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgY29tcHV0ZWQgcm93IHNwYW4gb2YgdGhpcyBjZWxsLCBpbiBmdW5jdGlvbiBvZiBpdHMgbWFuYWdlZFxuICAgICAqIGNlbGxzLlxuICAgICAqL1xuICAgIGdldCByb3dzcGFuKCk6IG51bWJlciB7XG4gICAgICAgIGNvbnN0IGNlbGxzQXJyYXkgPSBBcnJheS5mcm9tKHRoaXMubWFuYWdlZENlbGxzKTtcbiAgICAgICAgY29uc3Qgc2FtZUNvbHVtbkNlbGxzID0gY2VsbHNBcnJheS5maWx0ZXIoY2VsbCA9PiBjZWxsLmNvbHVtbkluZGV4ID09PSB0aGlzLmNvbHVtbkluZGV4KTtcbiAgICAgICAgcmV0dXJuIDEgKyBzYW1lQ29sdW1uQ2VsbHMubGVuZ3RoO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIHJvdyB0byB3aGljaCB0aGlzIGNlbGwgYmVsb25ncy5cbiAgICAgKi9cbiAgICBnZXQgcm93KCk6IFRhYmxlQ2VsbE5vZGVbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFuY2VzdG9yKFRhYmxlUm93Tm9kZSkuY2hpbGRyZW4oVGFibGVDZWxsTm9kZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgY29sdW1uIHRvIHdoaWNoIHRoaXMgY2VsbCBiZWxvbmdzLCBhcyBhbiBhcnJheSBvZiBjZWxscy5cbiAgICAgKi9cbiAgICBnZXQgY29sdW1uKCk6IFRhYmxlQ2VsbE5vZGVbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFuY2VzdG9yKFRhYmxlTm9kZSkuY29sdW1uc1t0aGlzLmNvbHVtbkluZGV4XTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBpbmRleCBvZiB0aGUgcm93IHRvIHdoaWNoIHRoaXMgY2VsbCBiZWxvbmdzLlxuICAgICAqL1xuICAgIGdldCByb3dJbmRleCgpOiBudW1iZXIge1xuICAgICAgICByZXR1cm4gdGhpcy5hbmNlc3RvcihUYWJsZVJvd05vZGUpLnJvd0luZGV4O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGluZGV4IG9mIHRoZSBjb2x1bW4gdG8gd2hpY2ggdGhpcyBjZWxsIGJlbG9uZ3MuXG4gICAgICovXG4gICAgZ2V0IGNvbHVtbkluZGV4KCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhcmVudC5jaGlsZHJlbihUYWJsZUNlbGxOb2RlKS5pbmRleE9mKHRoaXMpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQdWJsaWNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGlzIGNlbGwgaXMgYWN0aXZlIChpZSBub3QgbWFuYWdlZCBieSBhbm90aGVyIGNlbGwpLlxuICAgICAqL1xuICAgIGlzQWN0aXZlKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gIXRoaXMubWFuYWdlckNlbGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgZ2l2ZW4gY2VsbCBhcyBtYW5hZ2VyIG9mIHRoaXMgY2VsbC5cbiAgICAgKiBOb3RlOiBBIGNlbGwgbWFuYWdlZCBieSBhbm90aGVyIGNlbGwgYWxzbyBjb3BpZXMgaXRzIG1hbmFnZXIncyBhdHRyaWJ1dGVzXG4gICAgICogYW5kIHByb3BlcnRpZXMgYW5kIGhhbmRzIG92ZXIgaXRzIGNoaWxkcmVuIHRvIGl0cyBtYW5hZ2VyLlxuICAgICAqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgbWVyZ2VXaXRoKG5ld01hbmFnZXI6IFZOb2RlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRoaXNUYWJsZSA9IHRoaXMuYW5jZXN0b3IoVGFibGVOb2RlKTtcbiAgICAgICAgY29uc3Qgb3RoZXJUYWJsZSA9IG5ld01hbmFnZXIuYW5jZXN0b3IoVGFibGVOb2RlKTtcbiAgICAgICAgaWYgKCFuZXdNYW5hZ2VyLmlzKFRhYmxlQ2VsbE5vZGUpIHx8IHRoaXNUYWJsZSAhPT0gb3RoZXJUYWJsZSkgcmV0dXJuO1xuXG4gICAgICAgIHRoaXMuX19tYW5hZ2VyQ2VsbCA9IG5ld01hbmFnZXI7XG4gICAgICAgIG5ld01hbmFnZXIubWFuYWdlKHRoaXMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVbm1lcmdlIHRoaXMgY2VsbCBmcm9tIGl0cyBtYW5hZ2VyLlxuICAgICAqL1xuICAgIHVubWVyZ2UoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1hbmFnZXIgPSB0aGlzLl9fbWFuYWdlckNlbGw7XG4gICAgICAgIGlmIChtYW5hZ2VyKSB7XG4gICAgICAgICAgICB0aGlzLl9fbWFuYWdlckNlbGwgPSBudWxsO1xuICAgICAgICAgICAgLy8gSWYgd2UganVzdCByZW1vdmVkIHRoaXMgY2VsbCdzIG1hbmFnZXIsIGFsc28gcmVtb3ZlIHRoaXMgY2VsbFxuICAgICAgICAgICAgLy8gZnJvbSB0aGUgb2xkIG1hbmFnZXIncyBtYW5hZ2VkIGNlbGxzLlxuICAgICAgICAgICAgbWFuYWdlci51bm1hbmFnZSh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBTZXQgdGhlIGdpdmVuIGNlbGwgYXMgbWFuYWdlZCBieSB0aGlzIGNlbGwuXG4gICAgICogTm90ZTogQSBjZWxsIG1hbmFnZWQgYnkgYW5vdGhlciBjZWxsIGFsc28gY29waWVzIGl0cyBtYW5hZ2VyJ3MgbW9kaWZpZXJzXG4gICAgICogYW5kIHByb3BlcnRpZXMgYW5kIGhhbmRzIG92ZXIgaXRzIGNoaWxkcmVuIHRvIGl0cyBtYW5hZ2VyLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNlbGxcbiAgICAgKi9cbiAgICBtYW5hZ2UoY2VsbDogVGFibGVDZWxsTm9kZSk6IHZvaWQge1xuICAgICAgICB0aGlzLl9fbWFuYWdlZENlbGxzLmFkZChjZWxsKTtcblxuICAgICAgICAvLyBDb3B5IHRoZSBtYW5hZ2VyJ3MgbW9kaWZpZXJzIGFuZCBwcm9wZXJ0aWVzLlxuICAgICAgICBjZWxsLm1vZGlmaWVycyA9IHRoaXMubW9kaWZpZXJzLmNsb25lKCk7XG4gICAgICAgIGNlbGwuaGVhZGVyID0gdGhpcy5oZWFkZXI7XG5cbiAgICAgICAgLy8gTW92ZSB0aGUgY2hpbGRyZW4gdG8gdGhlIG1hbmFnZXIuXG4gICAgICAgIHRoaXMuYXBwZW5kKC4uLmNlbGwuY2hpbGRWTm9kZXMpO1xuXG4gICAgICAgIC8vIEhhbmQgdGhlIG1hbmFnZWQgY2VsbHMgb3ZlciB0byB0aGUgbWFuYWdlci5cbiAgICAgICAgZm9yIChjb25zdCBtYW5hZ2VkQ2VsbCBvZiBjZWxsLm1hbmFnZWRDZWxscykge1xuICAgICAgICAgICAgbWFuYWdlZENlbGwubWVyZ2VXaXRoKHRoaXMpO1xuICAgICAgICAgICAgY2VsbC51bm1hbmFnZShtYW5hZ2VkQ2VsbCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDb3B5IHRoZSBtYW5hZ2VyJ3Mgcm93IGlmIGFuIGVudGlyZSByb3cgd2FzIG1lcmdlZFxuICAgICAgICBjb25zdCByb3cgPSBjZWxsLmFuY2VzdG9yKFRhYmxlUm93Tm9kZSk7XG4gICAgICAgIGlmIChyb3cpIHtcbiAgICAgICAgICAgIGNvbnN0IGNlbGxzID0gcm93LmNoaWxkcmVuKFRhYmxlQ2VsbE5vZGUpO1xuICAgICAgICAgICAgY29uc3Qgcm93SXNNZXJnZWQgPSBjZWxscy5ldmVyeShyb3dDZWxsID0+IHJvd0NlbGwubWFuYWdlckNlbGwgPT09IHRoaXMpO1xuICAgICAgICAgICAgaWYgKHJvd0lzTWVyZ2VkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFuYWdlclJvdyA9IGNlbGwubWFuYWdlckNlbGwuYW5jZXN0b3IoVGFibGVSb3dOb2RlKTtcbiAgICAgICAgICAgICAgICByb3cuaGVhZGVyID0gbWFuYWdlclJvdy5oZWFkZXI7XG4gICAgICAgICAgICAgICAgcm93Lm1vZGlmaWVycyA9IG1hbmFnZXJSb3cubW9kaWZpZXJzLmNsb25lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBFbnN1cmUgcmVjaXByb2NpdHkuXG4gICAgICAgIGlmIChjZWxsLm1hbmFnZXJDZWxsICE9PSB0aGlzKSB7XG4gICAgICAgICAgICBjZWxsLm1lcmdlV2l0aCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXN0b3JlIHRoZSBpbmRlcGVuZGVuY2Ugb2YgdGhlIGdpdmVuIGNlbGwuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2VsbFxuICAgICAqL1xuICAgIHVubWFuYWdlKGNlbGw6IFRhYmxlQ2VsbE5vZGUpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fX21hbmFnZWRDZWxscy5kZWxldGUoY2VsbCk7XG5cbiAgICAgICAgLy8gRW5zdXJlIHJlY2lwcm9jaXR5LlxuICAgICAgICBpZiAoY2VsbC5tYW5hZ2VyQ2VsbCA9PT0gdGhpcykge1xuICAgICAgICAgICAgY2VsbC51bm1lcmdlKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IFRhYmxlQ2VsbE5vZGUgfSBmcm9tICcuL1RhYmxlQ2VsbE5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVGFibGVDZWxsWG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKGl0ZW06IE5vZGUpOiBpdGVtIGlzIEhUTUxUYWJsZUNlbGxFbGVtZW50ID0+IHtcbiAgICAgICAgY29uc3QgbmFtZSA9IG5vZGVOYW1lKGl0ZW0pO1xuICAgICAgICByZXR1cm4gbmFtZSA9PT0gJ1REJyB8fCBuYW1lID09PSAnVEgnO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIHRhYmxlIGNlbGwgbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICovXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogSFRNTFRhYmxlQ2VsbEVsZW1lbnQpOiBQcm9taXNlPFRhYmxlQ2VsbE5vZGVbXT4ge1xuICAgICAgICBjb25zdCBjZWxsID0gbmV3IFRhYmxlQ2VsbE5vZGUoeyBoZWFkZXI6IG5vZGVOYW1lKGl0ZW0pID09PSAnVEgnIH0pO1xuICAgICAgICBjZWxsLm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcbiAgICAgICAgY29uc3QgY2hpbGRyZW4gPSBhd2FpdCB0aGlzLmVuZ2luZS5wYXJzZSguLi5pdGVtLmNoaWxkTm9kZXMpO1xuICAgICAgICBjZWxsLmFwcGVuZCguLi5jaGlsZHJlbik7XG4gICAgICAgIHJldHVybiBbY2VsbF07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQWJzdHJhY3RSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvQWJzdHJhY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBUYWJsZU5vZGUgfSBmcm9tICcuL1RhYmxlTm9kZSc7XG5pbXBvcnQgeyBUYWJsZVJvd05vZGUgfSBmcm9tICcuL1RhYmxlUm93Tm9kZSc7XG5pbXBvcnQgeyBIdG1sRG9tUmVuZGVyaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWh0bWwvc3JjL0h0bWxEb21SZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgVGFibGVTZWN0aW9uQXR0cmlidXRlcyB9IGZyb20gJy4vVGFibGVSb3dYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuXG5leHBvcnQgY2xhc3MgVGFibGVIdG1sRG9tUmVuZGVyZXIgZXh0ZW5kcyBBYnN0cmFjdFJlbmRlcmVyPE5vZGVbXT4ge1xuICAgIHN0YXRpYyBpZCA9IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBIdG1sRG9tUmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IFRhYmxlTm9kZTtcblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgVGFibGVOb2RlIGFsb25nIHdpdGggaXRzIGNvbnRlbnRzIChUYWJsZVJvd05vZGVzKS5cbiAgICAgKi9cbiAgICBhc3luYyByZW5kZXIodGFibGU6IFRhYmxlTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGRvbVRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGFibGUnKTtcbiAgICAgICAgY29uc3QgZG9tSGVhZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RoZWFkJyk7XG4gICAgICAgIGxldCBkb21Cb2R5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGJvZHknKTtcblxuICAgICAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIHRhYmxlLmNoaWxkcmVuKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGRvbUNoaWxkID0gYXdhaXQgdGhpcy5yZW5kZXJDaGlsZChjaGlsZCk7XG4gICAgICAgICAgICBpZiAoY2hpbGQuaXMoVGFibGVSb3dOb2RlKSkge1xuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBjaGlsZCBpcyBhIHJvdywgYXBwZW5kIGl0IHRvIGl0cyBjb250YWluaW5nIHNlY3Rpb24uXG4gICAgICAgICAgICAgICAgY29uc3QgdGFibGVTZWN0aW9uID0gY2hpbGQuaGVhZGVyID8gZG9tSGVhZCA6IGRvbUJvZHk7XG4gICAgICAgICAgICAgICAgdGFibGVTZWN0aW9uLmFwcGVuZCguLi5kb21DaGlsZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmdpbmUucmVuZGVyQXR0cmlidXRlcyhUYWJsZVNlY3Rpb25BdHRyaWJ1dGVzLCBjaGlsZCwgdGFibGVTZWN0aW9uKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRhYmxlU2VjdGlvbi5wYXJlbnROb2RlKSB7XG4gICAgICAgICAgICAgICAgICAgIGRvbVRhYmxlLmFwcGVuZCh0YWJsZVNlY3Rpb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZG9tVGFibGUuYXBwZW5kKC4uLmRvbUNoaWxkKTtcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBuZXcgPHRib2R5PiBzbyB0aGUgcmVzdCBvZiB0aGUgcm93cywgaWYgYW55LCBnZXRcbiAgICAgICAgICAgICAgICAvLyBhcHBlbmRlZCB0byBpdCwgYWZ0ZXIgdGhpcyBlbGVtZW50LlxuICAgICAgICAgICAgICAgIGRvbUJvZHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0Ym9keScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuZW5naW5lLnJlbmRlckF0dHJpYnV0ZXMoQXR0cmlidXRlcywgdGFibGUsIGRvbVRhYmxlKTtcbiAgICAgICAgcmV0dXJuIFtkb21UYWJsZV07XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gaXRlbSBpcyBhIHRhYmxlIHNlY3Rpb24gZWxlbWVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICovXG4gICAgX2lzVGFibGVTZWN0aW9uKGl0ZW06IE5vZGUpOiBpdGVtIGlzIEhUTUxUYWJsZVNlY3Rpb25FbGVtZW50IHtcbiAgICAgICAgY29uc3QgbmFtZSA9IG5vZGVOYW1lKGl0ZW0pO1xuICAgICAgICByZXR1cm4gbmFtZSA9PT0gJ1RIRUFEJyB8fCBuYW1lID09PSAnVEJPRFknO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFZFbGVtZW50IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZFbGVtZW50JztcbmltcG9ydCB7IFRhYmxlUm93Tm9kZSB9IGZyb20gJy4vVGFibGVSb3dOb2RlJztcbmltcG9ydCB7IFRhYmxlQ2VsbE5vZGUgfSBmcm9tICcuL1RhYmxlQ2VsbE5vZGUnO1xuXG5leHBvcnQgY2xhc3MgVGFibGVOb2RlIGV4dGVuZHMgVkVsZW1lbnQge1xuICAgIGJyZWFrYWJsZSA9IGZhbHNlO1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcih7IGh0bWxUYWc6ICdUQUJMRScgfSk7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEdldHRlcnNcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBnZXQgbmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gc3VwZXIubmFtZSArICc6ICcgKyB0aGlzLnJvd0NvdW50ICsgJ3gnICsgdGhpcy5jb2x1bW5Db3VudDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFuIGFycmF5IG9mIHJvd3MgaW4gdGhpcyB0YWJsZSwgYXMgYXJyYXlzIG9mIGNlbGxzLlxuICAgICAqL1xuICAgIGdldCByb3dzKCk6IFRhYmxlQ2VsbE5vZGVbXVtdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4oVGFibGVSb3dOb2RlKS5tYXAocm93ID0+IHJvdy5jaGlsZHJlbihUYWJsZUNlbGxOb2RlKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhbiBhcnJheSBvZiBjb2x1bW5zIGluIHRoaXMgdGFibGUsIGFzIGFycmF5cyBvZiBjZWxscy5cbiAgICAgKi9cbiAgICBnZXQgY29sdW1ucygpOiBUYWJsZUNlbGxOb2RlW11bXSB7XG4gICAgICAgIGNvbnN0IGNvbHVtbnMgPSBuZXcgQXJyYXkodGhpcy5jb2x1bW5Db3VudCkuZmlsbCh1bmRlZmluZWQpO1xuICAgICAgICByZXR1cm4gY29sdW1ucy5tYXAoKF8sIGNvbHVtbkluZGV4KSA9PlxuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbihUYWJsZVJvd05vZGUpLm1hcChyb3cgPT4gcm93LmNoaWxkcmVuKFRhYmxlQ2VsbE5vZGUpW2NvbHVtbkluZGV4XSksXG4gICAgICAgICk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbnVtYmVyIG9mIHJvd3MgaW4gdGhpcyB0YWJsZS5cbiAgICAgKi9cbiAgICBnZXQgcm93Q291bnQoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4oVGFibGVSb3dOb2RlKS5sZW5ndGg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbnVtYmVyIG9mIGNvbHVtbnMgaW4gdGhpcyB0YWJsZS5cbiAgICAgKi9cbiAgICBnZXQgY29sdW1uQ291bnQoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmlyc3RDaGlsZChUYWJsZVJvd05vZGUpLmNoaWxkcmVuKFRhYmxlQ2VsbE5vZGUpLmxlbmd0aDtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSBjZWxsIG9mIHRoaXMgdGFibGUgdGhhdCBjYW4gYmUgZm91bmQgYXQgdGhlIGdpdmVuIGNvb3JkaW5hdGVzLFxuICAgICAqIGlmIGFueS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSByb3dJbmRleFxuICAgICAqIEBwYXJhbSBjb2x1bW5JbmRleFxuICAgICAqL1xuICAgIGdldENlbGxBdChyb3dJbmRleDogbnVtYmVyLCBjb2x1bW5JbmRleDogbnVtYmVyKTogVGFibGVDZWxsTm9kZSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuKFRhYmxlUm93Tm9kZSlbcm93SW5kZXhdLmNoaWxkcmVuKFRhYmxlQ2VsbE5vZGUpW2NvbHVtbkluZGV4XTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgbmV3IHJvdyBhYm92ZSB0aGUgcmVmZXJlbmNlIHJvdyAodGhlIHJvdyBvZiB0aGUgZ2l2ZW4gcmVmZXJlbmNlXG4gICAgICogY2VsbCkuIENvcHkgdGhlIHN0eWxlcyBhbmQgY29sc3BhbnMgb2YgdGhlIGNlbGxzIG9mIHRoZSByZWZlcmVuY2Ugcm93LiBJZlxuICAgICAqIHRoZSByZWZlcmVuY2Ugcm93IHRyYXZlcnNlcyBhIHJvd3NwYW4sIGV4dGVuZCB0aGF0IHJvd3NwYW4uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcmVmZXJlbmNlQ2VsbFxuICAgICAqL1xuICAgIGFkZFJvd0Fib3ZlKHJlZmVyZW5jZUNlbGw6IFRhYmxlQ2VsbE5vZGUpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgcmVmZXJlbmNlUm93ID0gcmVmZXJlbmNlQ2VsbC5hbmNlc3RvcihUYWJsZVJvd05vZGUpO1xuICAgICAgICBjb25zdCBuZXdSb3cgPSByZWZlcmVuY2VSb3cuY2xvbmUoKTtcbiAgICAgICAgcmVmZXJlbmNlUm93LmJlZm9yZShuZXdSb3cpO1xuICAgICAgICBmb3IgKGNvbnN0IGNlbGwgb2YgcmVmZXJlbmNlUm93LmNoaWxkcmVuKFRhYmxlQ2VsbE5vZGUpKSB7XG4gICAgICAgICAgICBjb25zdCBjbG9uZSA9IGNlbGwuY2xvbmUoKTtcbiAgICAgICAgICAgIG5ld1Jvdy5hcHBlbmQoY2xvbmUpO1xuXG4gICAgICAgICAgICAvLyBIYW5kbGUgbWFuYWdlcnMuXG4gICAgICAgICAgICBjb25zdCBtYW5hZ2VyID0gY2VsbC5tYW5hZ2VyQ2VsbDtcbiAgICAgICAgICAgIGlmIChtYW5hZ2VyKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1hbmFnZXIucm93SW5kZXggPT09IHJlZmVyZW5jZVJvdy5yb3dJbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgY3VycmVudCBjZWxsJ3MgbWFuYWdlciBpcyBpbiB0aGUgcmVmZXJlbmNlIHJvdyxcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNsb25lJ3MgbWFuYWdlciBzaG91bGQgYmUgdGhhdCBtYW5hZ2VyJ3MgY2xvbmUuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hbmFnZXJDbG9uZSA9IHRoaXMuZ2V0Q2VsbEF0KG5ld1Jvdy5yb3dJbmRleCwgbWFuYWdlci5jb2x1bW5JbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aChtYW5hZ2VyQ2xvbmUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aChtYW5hZ2VyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIGEgbmV3IHJvdyBiZWxvdyB0aGUgcmVmZXJlbmNlIHJvdyAodGhlIHJvdyBvZiB0aGUgZ2l2ZW4gcmVmZXJlbmNlXG4gICAgICogY2VsbCkuIENvcHkgdGhlIHN0eWxlcyBhbmQgY29sc3BhbnMgb2YgdGhlIGNlbGxzIG9mIHRoZSByZWZlcmVuY2Ugcm93LiBJZlxuICAgICAqIHRoZSByZWZlcmVuY2Ugcm93IHRyYXZlcnNlcyBhIHJvd3NwYW4sIGV4dGVuZCB0aGF0IHJvd3NwYW4uXG4gICAgICogTm90ZTogYSByb3dzcGFuIGVuZGluZyBhdCB0aGUgcmVmZXJlbmNlIGNlbGwgaXMgbm90IGV4dGVuZGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlZmVyZW5jZUNlbGxcbiAgICAgKi9cbiAgICBhZGRSb3dCZWxvdyhyZWZlcmVuY2VDZWxsOiBUYWJsZUNlbGxOb2RlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHJvd0luZGV4ID0gcmVmZXJlbmNlQ2VsbC5yb3dJbmRleCArIHJlZmVyZW5jZUNlbGwucm93c3BhbiAtIDE7XG4gICAgICAgIGNvbnN0IHJlZmVyZW5jZVJvdyA9IHRoaXMuY2hpbGRyZW4oVGFibGVSb3dOb2RlKVtyb3dJbmRleF07XG4gICAgICAgIGNvbnN0IG5ld1JvdyA9IHJlZmVyZW5jZVJvdy5jbG9uZSgpO1xuICAgICAgICByZWZlcmVuY2VSb3cuYWZ0ZXIobmV3Um93KTtcbiAgICAgICAgZm9yIChjb25zdCBjZWxsIG9mIHJlZmVyZW5jZVJvdy5jaGlsZHJlbihUYWJsZUNlbGxOb2RlKSkge1xuICAgICAgICAgICAgY29uc3QgY2xvbmUgPSBjZWxsLmNsb25lKCk7XG4gICAgICAgICAgICBuZXdSb3cuYXBwZW5kKGNsb25lKTtcblxuICAgICAgICAgICAgLy8gSGFuZGxlIG1hbmFnZXJzLlxuICAgICAgICAgICAgaWYgKGNlbGwubWFuYWdlckNlbGwpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBtYW5hZ2VyID0gY2VsbC5tYW5hZ2VyQ2VsbDtcbiAgICAgICAgICAgICAgICBjb25zdCBtYW5hZ2VyRW5kUm93ID0gbWFuYWdlci5yb3dJbmRleCArIG1hbmFnZXIucm93c3BhbiAtIDE7XG4gICAgICAgICAgICAgICAgaWYgKG1hbmFnZXJFbmRSb3cgPT09IHJvd0luZGV4ICYmIG1hbmFnZXIuY29sdW1uSW5kZXggIT09IGNlbGwuY29sdW1uSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGFrZSB0aGUgbmV3IHJvdyBlcXVpdmFsZW50IG9mIHRoZSBhYm92ZSBjZWxsJ3MgbWFuYWdlclxuICAgICAgICAgICAgICAgICAgICAvLyAoY29weSBjb2xzcGFuKS5cbiAgICAgICAgICAgICAgICAgICAgY2xvbmUubWVyZ2VXaXRoKHRoaXMuZ2V0Q2VsbEF0KG5ld1Jvdy5yb3dJbmRleCwgbWFuYWdlci5jb2x1bW5JbmRleCkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFuYWdlckVuZFJvdyAhPT0gcm93SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGFrZSB0aGUgbWFuYWdlciBjZWxsIG9mIHRoZSBhYm92ZSBjZWxsIChleHRlbmQgcm93c3BhbiksXG4gICAgICAgICAgICAgICAgICAgIC8vIG9ubHkgaWYgc2FpZCBtYW5hZ2VyJ3Mgcm93c3BhbiBpcyBub3QgZW5kaW5nIHdpdGggdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIGFib3ZlIGNlbGwuXG4gICAgICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aChtYW5hZ2VyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNlbGwucm93c3BhbiA+IDEpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgY2VsbCBoYXMgYSByb3dzcGFuLCBleHRlbmQgaXQuXG4gICAgICAgICAgICAgICAgY2xvbmUubWVyZ2VXaXRoKGNlbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZCBhIG5ldyBjb2x1bW4gYmVmb3JlIHRoZSByZWZlcmVuY2UgY29sdW1uICh0aGUgY29sdW1uIG9mIHRoZSBnaXZlblxuICAgICAqIHJlZmVyZW5jZSBjZWxsKS4gQ29weSB0aGUgc3R5bGVzIGFuZCByb3dzcGFucyBvZiB0aGUgY2VsbHMgb2YgdGhlXG4gICAgICogcmVmZXJlbmNlIGNvbHVtbi4gSWYgdGhlIHJlZmVyZW5jZSBjb2x1bW4gdHJhdmVyc2VzIGEgY29sc3BhbiwgZXh0ZW5kXG4gICAgICogdGhhdCBjb2xzcGFuLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlZmVyZW5jZUNlbGxcbiAgICAgKi9cbiAgICBhZGRDb2x1bW5CZWZvcmUocmVmZXJlbmNlQ2VsbDogVGFibGVDZWxsTm9kZSk6IHZvaWQge1xuICAgICAgICBjb25zdCByZWZlcmVuY2VDb2x1bW4gPSByZWZlcmVuY2VDZWxsLmNvbHVtbjtcbiAgICAgICAgZm9yIChjb25zdCBjZWxsIG9mIHJlZmVyZW5jZUNvbHVtbikge1xuICAgICAgICAgICAgY29uc3QgY2xvbmUgPSBjZWxsLmNsb25lKCk7XG4gICAgICAgICAgICBjZWxsLmJlZm9yZShjbG9uZSk7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBtYW5hZ2Vycy5cbiAgICAgICAgICAgIGNvbnN0IG1hbmFnZXIgPSBjZWxsLm1hbmFnZXJDZWxsO1xuICAgICAgICAgICAgaWYgKG1hbmFnZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAobWFuYWdlci5jb2x1bW5JbmRleCA9PT0gcmVmZXJlbmNlQ2VsbC5jb2x1bW5JbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgY3VycmVudCBjZWxsJ3MgbWFuYWdlciBpcyBpbiB0aGUgcmVmZXJlbmNlIGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNsb25lJ3MgbWFuYWdlciBzaG91bGQgYmUgdGhhdCBtYW5hZ2VyJ3MgY2xvbmUuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hbmFnZXJDbG9uZSA9IHRoaXMuZ2V0Q2VsbEF0KG1hbmFnZXIucm93SW5kZXgsIGNsb25lLmNvbHVtbkluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgY2xvbmUubWVyZ2VXaXRoKG1hbmFnZXJDbG9uZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY2xvbmUubWVyZ2VXaXRoKG1hbmFnZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGQgYSBuZXcgY29sdW1uIGFmdGVyIHRoZSByZWZlcmVuY2UgY29sdW1uICh0aGUgY29sdW1uIG9mIHRoZSBnaXZlblxuICAgICAqIHJlZmVyZW5jZSBjZWxsKS4gQ29weSB0aGUgc3R5bGVzIGFuZCByb3dzcGFucyBvZiB0aGUgY2VsbHMgb2YgdGhlXG4gICAgICogcmVmZXJlbmNlIGNvbHVtbi4gSWYgdGhlIHJlZmVyZW5jZSBjb2x1bW4gdHJhdmVyc2VzIGEgY29scGFuLCBleHRlbmQgdGhhdFxuICAgICAqIGNvbHNwYW4uXG4gICAgICogTm90ZTogYSBjb2xzcGFuIGVuZGluZyBhdCB0aGUgcmVmZXJlbmNlIGNlbGwgaXMgbm90IGV4dGVuZGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHJlZmVyZW5jZUNlbGxcbiAgICAgKi9cbiAgICBhZGRDb2x1bW5BZnRlcihyZWZlcmVuY2VDZWxsOiBUYWJsZUNlbGxOb2RlKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNvbHVtbkluZGV4ID0gcmVmZXJlbmNlQ2VsbC5jb2x1bW5JbmRleCArIHJlZmVyZW5jZUNlbGwuY29sc3BhbiAtIDE7XG4gICAgICAgIGNvbnN0IHJlZmVyZW5jZUNvbHVtbiA9IHRoaXMuY29sdW1uc1tjb2x1bW5JbmRleF07XG4gICAgICAgIGZvciAoY29uc3QgY2VsbCBvZiByZWZlcmVuY2VDb2x1bW4pIHtcbiAgICAgICAgICAgIGNvbnN0IGNsb25lID0gY2VsbC5jbG9uZSgpO1xuICAgICAgICAgICAgY2VsbC5hZnRlcihjbG9uZSk7XG5cbiAgICAgICAgICAgIC8vIEhhbmRsZSBtYW5hZ2Vycy5cbiAgICAgICAgICAgIGlmIChjZWxsLm1hbmFnZXJDZWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFuYWdlciA9IGNlbGwubWFuYWdlckNlbGw7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFuYWdlckVuZENvbHVtbiA9IG1hbmFnZXIuY29sdW1uSW5kZXggKyBtYW5hZ2VyLmNvbHNwYW4gLSAxO1xuICAgICAgICAgICAgICAgIGlmIChtYW5hZ2VyRW5kQ29sdW1uID09PSBjb2x1bW5JbmRleCAmJiBtYW5hZ2VyLnJvd0luZGV4ICE9PSBjZWxsLnJvd0luZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRha2UgdGhlIG5ldyBjb2x1bW4gZXF1aXZhbGVudCBvZiB0aGUgcHJldmlvdXMgY2VsbCdzXG4gICAgICAgICAgICAgICAgICAgIC8vIG1hbmFnZXIgKGNvcHkgcm93c3BhbikuXG4gICAgICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aCh0aGlzLmdldENlbGxBdChtYW5hZ2VyLnJvd0luZGV4LCBjbG9uZS5jb2x1bW5JbmRleCkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWFuYWdlckVuZENvbHVtbiAhPT0gY29sdW1uSW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGFrZSB0aGUgbWFuYWdlciBjZWxsIG9mIHRoZSBwcmV2aW91cyBjZWxsIChleHRlbmRcbiAgICAgICAgICAgICAgICAgICAgLy8gY29sc3BhbiksIG9ubHkgaWYgc2FpZCBtYW5hZ2VyJ3MgY29sc3BhbiBpcyBub3QgZW5kaW5nXG4gICAgICAgICAgICAgICAgICAgIC8vIHdpdGggdGhlIHByZXZpb3VzIGNlbGwuXG4gICAgICAgICAgICAgICAgICAgIGNsb25lLm1lcmdlV2l0aChtYW5hZ2VyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNlbGwuY29sc3BhbiA+IDEpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgY2VsbCBoYXMgYSBjb2xzcGFuLCBleHRlbmQgaXQuXG4gICAgICAgICAgICAgICAgY2xvbmUubWVyZ2VXaXRoKGNlbGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQWJzdHJhY3RSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvQWJzdHJhY3RSZW5kZXJlcic7XG5pbXBvcnQgeyBUYWJsZVJvd05vZGUgfSBmcm9tICcuL1RhYmxlUm93Tm9kZSc7XG5pbXBvcnQgeyBIdG1sRG9tUmVuZGVyaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWh0bWwvc3JjL0h0bWxEb21SZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuXG5leHBvcnQgY2xhc3MgVGFibGVSb3dIdG1sRG9tUmVuZGVyZXIgZXh0ZW5kcyBBYnN0cmFjdFJlbmRlcmVyPE5vZGVbXT4ge1xuICAgIHN0YXRpYyBpZCA9IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBIdG1sRG9tUmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IFRhYmxlUm93Tm9kZTtcblxuICAgIC8qKlxuICAgICAqIFJlbmRlciB0aGUgVGFibGVSb3dOb2RlIGFsb25nIHdpdGggaXRzIGNvbnRlbnRzLlxuICAgICAqL1xuICAgIGFzeW5jIHJlbmRlcihyb3c6IFRhYmxlUm93Tm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IGRvbVJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG4gICAgICAgIHRoaXMuZW5naW5lLnJlbmRlckF0dHJpYnV0ZXMoQXR0cmlidXRlcywgcm93LCBkb21Sb3cpO1xuICAgICAgICBjb25zdCByZW5kZXJlZENoaWxkcmVuID0gYXdhaXQgdGhpcy5yZW5kZXJDaGlsZHJlbihyb3cpO1xuICAgICAgICBkb21Sb3cuYXBwZW5kKC4uLnJlbmRlcmVkQ2hpbGRyZW4uZmxhdCgpKTtcbiAgICAgICAgcmV0dXJuIFtkb21Sb3ddO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFZFbGVtZW50IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZFbGVtZW50JztcbmltcG9ydCB7IFRhYmxlTm9kZSB9IGZyb20gJy4vVGFibGVOb2RlJztcblxuZXhwb3J0IGNsYXNzIFRhYmxlUm93Tm9kZSBleHRlbmRzIFZFbGVtZW50IHtcbiAgICBicmVha2FibGUgPSBmYWxzZTtcbiAgICBoZWFkZXI6IGJvb2xlYW47XG4gICAgY29uc3RydWN0b3IocGFyYW1zPzogeyBoZWFkZXI6IGJvb2xlYW4gfSkge1xuICAgICAgICBzdXBlcih7IGh0bWxUYWc6ICdUUicgfSk7XG4gICAgICAgIHRoaXMuaGVhZGVyID0gcGFyYW1zPy5oZWFkZXIgfHwgZmFsc2U7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIExpZmVjeWNsZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIG5ldyBWTm9kZSB3aXRoIHRoZSBzYW1lIHR5cGUgYW5kIGF0dHJpYnV0ZXMgYXMgdGhpcyBWTm9kZS5cbiAgICAgKlxuICAgICAqICBAb3ZlcnJpZGVcbiAgICAgKi9cbiAgICBjbG9uZShkZWVwQ2xvbmU/OiBib29sZWFuLCBwYXJhbXM/OiB7fSk6IHRoaXMge1xuICAgICAgICBjb25zdCBkZWZhdWx0czogQ29uc3RydWN0b3JQYXJhbWV0ZXJzPHR5cGVvZiBUYWJsZVJvd05vZGU+WzBdID0ge1xuICAgICAgICAgICAgaGVhZGVyOiB0aGlzLmhlYWRlcixcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmNsb25lKGRlZXBDbG9uZSwgeyAuLi5kZWZhdWx0cywgLi4ucGFyYW1zIH0pO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBHZXR0ZXJzXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICovXG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLm5hbWUgKyAodGhpcy5oZWFkZXIgPyAnOiBoZWFkZXInIDogJycpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdGhlIGluZGV4IG9mIHRoaXMgcm93IGluIHRoZSB0YWJsZS5cbiAgICAgKi9cbiAgICBnZXQgcm93SW5kZXgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYW5jZXN0b3IoVGFibGVOb2RlKVxuICAgICAgICAgICAgLmNoaWxkcmVuKFRhYmxlUm93Tm9kZSlcbiAgICAgICAgICAgIC5pbmRleE9mKHRoaXMpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgVGFibGVSb3dOb2RlIH0gZnJvbSAnLi9UYWJsZVJvd05vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuaW1wb3J0IHsgTW9kaWZpZXJzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvTW9kaWZpZXJzJztcblxuZXhwb3J0IGNsYXNzIFRhYmxlU2VjdGlvbkF0dHJpYnV0ZXMgZXh0ZW5kcyBBdHRyaWJ1dGVzIHt9XG5cbmV4cG9ydCBjbGFzcyBUYWJsZVJvd1htbERvbVBhcnNlciBleHRlbmRzIEFic3RyYWN0UGFyc2VyPE5vZGU+IHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogaXRlbSBpcyBFbGVtZW50ID0+IHtcbiAgICAgICAgY29uc3QgbmFtZSA9IG5vZGVOYW1lKGl0ZW0pO1xuICAgICAgICByZXR1cm4gbmFtZSA9PT0gJ1RIRUFEJyB8fCBuYW1lID09PSAnVEJPRFknIHx8IG5hbWUgPT09ICdUUic7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFBhcnNlIGEgcm93IG5vZGUgb3IgYSB0YWJsZSBzZWN0aW9uIG5vZGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIGFzeW5jIHBhcnNlKGl0ZW06IEVsZW1lbnQpOiBQcm9taXNlPFRhYmxlUm93Tm9kZVtdPiB7XG4gICAgICAgIGlmICh0aGlzLl9pc1RhYmxlU2VjdGlvbihpdGVtKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VUYWJsZVNlY3Rpb24oaXRlbSk7XG4gICAgICAgIH0gZWxzZSBpZiAobm9kZU5hbWUoaXRlbSkgPT09ICdUUicpIHtcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IG5ldyBUYWJsZVJvd05vZGUoKTtcbiAgICAgICAgICAgIHJvdy5tb2RpZmllcnMuYXBwZW5kKHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKSk7XG4gICAgICAgICAgICBjb25zdCBjZWxscyA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG4gICAgICAgICAgICByb3cuYXBwZW5kKC4uLmNlbGxzKTtcbiAgICAgICAgICAgIHJldHVybiBbcm93XTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIDx0Ym9keT4gb3IgYSA8dGhlYWQ+IGludG8gYW4gYXJyYXkgb2YgdGFibGUgcm93cyB3aXRoIHRoZWlyXG4gICAgICogYGhlYWRlcmAgcHJvcGVydHkgc2V0IGluIGZ1bmN0aW9uIG9mIHdoZXRoZXIgdGhleSBhcmUgY29udGFpbmVkIGluIGFcbiAgICAgKiA8dGJvZHk+IG9yIGEgPHRoZWFkPi5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0YWJsZVNlY3Rpb25cbiAgICAgKi9cbiAgICBhc3luYyBwYXJzZVRhYmxlU2VjdGlvbih0YWJsZVNlY3Rpb246IEhUTUxUYWJsZVNlY3Rpb25FbGVtZW50KTogUHJvbWlzZTxUYWJsZVJvd05vZGVbXT4ge1xuICAgICAgICBjb25zdCBwYXJzZWROb2RlcyA9IFtdO1xuXG4gICAgICAgIC8vIFBhcnNlIHRoZSBzZWN0aW9uJ3MgY2hpbGRyZW4uXG4gICAgICAgIGZvciAoY29uc3QgY2hpbGQgb2YgdGFibGVTZWN0aW9uLmNoaWxkTm9kZXMpIHtcbiAgICAgICAgICAgIHBhcnNlZE5vZGVzLnB1c2goLi4uKGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKGNoaWxkKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUGFyc2UgdGhlIDx0Ym9keT4gb3IgPHRoZWFkPidzIG1vZGlmaWVycy5cbiAgICAgICAgY29uc3QgY29udGFpbmVyTW9kaWZpZXJzID0gbmV3IE1vZGlmaWVycyh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXModGFibGVTZWN0aW9uKSk7XG5cbiAgICAgICAgLy8gQXBwbHkgdGhlIGF0dHJpYnV0ZXMsIHN0eWxlIGFuZCBgaGVhZGVyYCBwcm9wZXJ0eSBvZiB0aGUgY29udGFpbmVyIHRvXG4gICAgICAgIC8vIGVhY2ggcm93LlxuICAgICAgICBjb25zdCBuYW1lID0gbm9kZU5hbWUodGFibGVTZWN0aW9uKTtcbiAgICAgICAgZm9yIChjb25zdCBwYXJzZWROb2RlIG9mIHBhcnNlZE5vZGVzKSB7XG4gICAgICAgICAgICBpZiAocGFyc2VkTm9kZS5pcyhUYWJsZVJvd05vZGUpKSB7XG4gICAgICAgICAgICAgICAgcGFyc2VkTm9kZS5oZWFkZXIgPSBuYW1lID09PSAnVEhFQUQnO1xuICAgICAgICAgICAgICAgIHBhcnNlZE5vZGUubW9kaWZpZXJzLnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgICAgIFRhYmxlU2VjdGlvbkF0dHJpYnV0ZXMsXG4gICAgICAgICAgICAgICAgICAgIG5ldyBUYWJsZVNlY3Rpb25BdHRyaWJ1dGVzKGNvbnRhaW5lck1vZGlmaWVycy5nZXQoQXR0cmlidXRlcykpLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBhcnNlZE5vZGVzO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBQcml2YXRlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIGl0ZW0gaXMgYSB0YWJsZSBzZWN0aW9uIGVsZW1lbnQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gaXRlbVxuICAgICAqL1xuICAgIF9pc1RhYmxlU2VjdGlvbihpdGVtOiBOb2RlKTogaXRlbSBpcyBIVE1MVGFibGVTZWN0aW9uRWxlbWVudCB7XG4gICAgICAgIGNvbnN0IG5hbWUgPSBub2RlTmFtZShpdGVtKTtcbiAgICAgICAgcmV0dXJuIG5hbWUgPT09ICdUSEVBRCcgfHwgbmFtZSA9PT0gJ1RCT0RZJztcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IFRhYmxlTm9kZSB9IGZyb20gJy4vVGFibGVOb2RlJztcbmltcG9ydCB7IFRhYmxlUm93Tm9kZSB9IGZyb20gJy4vVGFibGVSb3dOb2RlJztcbmltcG9ydCB7IFRhYmxlQ2VsbE5vZGUgfSBmcm9tICcuL1RhYmxlQ2VsbE5vZGUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuXG5leHBvcnQgY2xhc3MgVGFibGVYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGl0ZW0gaXMgSFRNTFRhYmxlRWxlbWVudCA9PiB7XG4gICAgICAgIHJldHVybiBub2RlTmFtZShpdGVtKSA9PT0gJ1RBQkxFJztcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogUGFyc2UgYSB0YWJsZSBub2RlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGl0ZW1cbiAgICAgKi9cbiAgICBhc3luYyBwYXJzZShpdGVtOiBIVE1MVGFibGVFbGVtZW50KTogUHJvbWlzZTxUYWJsZU5vZGVbXT4ge1xuICAgICAgICAvLyBQYXJzZSB0aGUgdGFibGUgaXRzZWxmIGFuZCBpdHMgYXR0cmlidXRlcy5cbiAgICAgICAgY29uc3QgdGFibGUgPSBuZXcgVGFibGVOb2RlKCk7XG4gICAgICAgIHRhYmxlLm1vZGlmaWVycy5hcHBlbmQodGhpcy5lbmdpbmUucGFyc2VBdHRyaWJ1dGVzKGl0ZW0pKTtcblxuICAgICAgICAvLyBQYXJzZSB0aGUgY29udGVudHMgb2YgdGhlIHRhYmxlLlxuICAgICAgICBjb25zdCBjaGlsZHJlbiA9IGF3YWl0IHRoaXMuZW5naW5lLnBhcnNlKC4uLml0ZW0uY2hpbGROb2Rlcyk7XG5cbiAgICAgICAgLy8gQnVpbGQgdGhlIGdyaWQuXG4gICAgICAgIGNvbnN0IGRpbWVuc2lvbnMgPSB0aGlzLl9nZXRUYWJsZURpbWVuc2lvbnMoaXRlbSk7XG4gICAgICAgIGNvbnN0IHBhcnNlZFJvd3MgPSBjaGlsZHJlbi5maWx0ZXIocm93ID0+IHJvdy5pcyhUYWJsZVJvd05vZGUpKSBhcyBUYWJsZVJvd05vZGVbXTtcbiAgICAgICAgY29uc3QgZ3JpZCA9IHRoaXMuX2NyZWF0ZVRhYmxlR3JpZChkaW1lbnNpb25zLCBwYXJzZWRSb3dzKTtcblxuICAgICAgICAvLyBBcHBlbmQgdGhlIGNlbGxzIHRvIHRoZSByb3dzLlxuICAgICAgICBjb25zdCByb3dzID0gbmV3IEFycmF5PFRhYmxlUm93Tm9kZT4oZGltZW5zaW9uc1swXSk7XG4gICAgICAgIGZvciAobGV0IHJvd0luZGV4ID0gMDsgcm93SW5kZXggPCBncmlkLmxlbmd0aDsgcm93SW5kZXggKz0gMSkge1xuICAgICAgICAgICAgcm93c1tyb3dJbmRleF0gPSBwYXJzZWRSb3dzW3Jvd0luZGV4XTtcbiAgICAgICAgICAgIGNvbnN0IGNlbGxzID0gZ3JpZFtyb3dJbmRleF07XG4gICAgICAgICAgICBsZXQgcm93ID0gcm93c1tyb3dJbmRleF07XG4gICAgICAgICAgICBpZiAoIXJvdykge1xuICAgICAgICAgICAgICAgIHJvdyA9IG5ldyBUYWJsZVJvd05vZGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJvdy5hcHBlbmQoLi4uY2VsbHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQXBwZW5kIHRoZSByb3dzIGFuZCBvdGhlciBjaGlsZHJlbiB0byB0aGUgdGFibGUuXG4gICAgICAgIGxldCByb3dJbmRleCA9IDA7XG4gICAgICAgIGZvciAobGV0IGNoaWxkSW5kZXggPSAwOyBjaGlsZEluZGV4IDwgY2hpbGRyZW4ubGVuZ3RoOyBjaGlsZEluZGV4ICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGNoaWxkID0gY2hpbGRyZW5bY2hpbGRJbmRleF07XG4gICAgICAgICAgICBpZiAoY2hpbGQuaXMoVGFibGVSb3dOb2RlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJvdyA9IHJvd3Nbcm93SW5kZXhdO1xuICAgICAgICAgICAgICAgIHRhYmxlLmFwcGVuZChyb3cpO1xuICAgICAgICAgICAgICAgIHJvd0luZGV4ICs9IDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRhYmxlLmFwcGVuZChjaGlsZHJlbltjaGlsZEluZGV4XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFt0YWJsZV07XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFByaXZhdGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSB0dXBsZSB3aXRoIHRoZSByb3cgbGVuZ3RoIGFuZCB0aGUgY29sdW1uIGxlbmd0aCBvZiB0aGUgZ2l2ZW4gRE9NXG4gICAgICogdGFibGUgZWxlbWVudC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb21UYWJsZVxuICAgICAqL1xuICAgIF9nZXRUYWJsZURpbWVuc2lvbnMoZG9tVGFibGU6IEhUTUxUYWJsZUVsZW1lbnQpOiBbbnVtYmVyLCBudW1iZXJdIHtcbiAgICAgICAgY29uc3QgZG9tUm93cyA9IEFycmF5LmZyb20oZG9tVGFibGUucXVlcnlTZWxlY3RvckFsbCgndHInKSk7XG4gICAgICAgIGNvbnN0IGRvbVRhYmxlUm93cyA9IGRvbVJvd3MuZmlsdGVyKHJvdyA9PiByb3cuY2xvc2VzdCgndGFibGUnKSA9PT0gZG9tVGFibGUpO1xuICAgICAgICBsZXQgY29sdW1uQ291bnQgPSAwO1xuICAgICAgICBpZiAoZG9tVGFibGVSb3dzLmxlbmd0aCkge1xuICAgICAgICAgICAgY29uc3QgZG9tQ2VsbHMgPSBBcnJheS5mcm9tKGRvbVRhYmxlUm93c1swXS5xdWVyeVNlbGVjdG9yQWxsKCd0ZCwgdGgnKSk7XG4gICAgICAgICAgICBjb25zdCBkb21UYWJsZUNlbGxzID0gZG9tQ2VsbHMuZmlsdGVyKGNlbGwgPT4gY2VsbC5jbG9zZXN0KCd0YWJsZScpID09PSBkb21UYWJsZSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGRvbUNoaWxkIG9mIGRvbVRhYmxlQ2VsbHMpIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5Db3VudCArPSBwYXJzZUludChkb21DaGlsZC5nZXRBdHRyaWJ1dGUoJ2NvbFNwYW4nKSB8fCAnMScsIDEwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gW2RvbVRhYmxlUm93cy5sZW5ndGgsIGNvbHVtbkNvdW50XTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQnVpbGQgYW5kIHJldHVybiB0aGUgZ3JpZCAoMkQgYXJyYXk6IHJvd3Mgb2YgY2VsbHMpIHRoYXQgd2lsbCBiZSB1c2VkIHRvXG4gICAgICogY3JlYXRlIHRoZSB0YWJsZS4gV2Ugd2FudCBhbGwgdGhlIHJvd3MgdG8gaGF2ZSB0aGUgc2FtZSBudW1iZXIgb2YgY2VsbHMsXG4gICAgICogYW5kIGFsbCB0aGUgY29sdW1ucyB0byBoYXZlIHRoZSBzYW1lIG51bWJlciBvZiBjZWxscy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkaW1lbnNpb25zXG4gICAgICogQHBhcmFtIHJvd3NcbiAgICAgKi9cbiAgICBfY3JlYXRlVGFibGVHcmlkKGRpbWVuc2lvbnM6IFtudW1iZXIsIG51bWJlcl0sIHJvd3M6IFRhYmxlUm93Tm9kZVtdKTogVGFibGVDZWxsTm9kZVtdW10ge1xuICAgICAgICBjb25zdCBbcm93Q291bnQsIGNvbHVtbkNvdW50XSA9IGRpbWVuc2lvbnM7XG5cbiAgICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgZ3JpZCAoMkQgYXJyYXk6IHJvd3Mgb2YgY2VsbHMpLlxuICAgICAgICBjb25zdCBncmlkOiBUYWJsZUNlbGxOb2RlW11bXSA9IEFycmF5LmZyb20oQXJyYXkocm93Q291bnQpLCAoKSA9PiBuZXcgQXJyYXkoY29sdW1uQ291bnQpKTtcblxuICAgICAgICAvLyBNb3ZlIGV2ZXJ5IHBhcnNlZCBjaGlsZCByb3cgdG8gaXRzIHBsYWNlIGluIHRoZSBncmlkLCBhbmQgY3JlYXRlXG4gICAgICAgIC8vIHBsYWNlaG9sZGVyIGNlbGxzIHdoZXJlIHRoZXJlIGFyZW4ndCBhbnksIGFjY291bnRpbmcgZm9yIGNvbHVtbiBzcGFuc1xuICAgICAgICAvLyBhbmQgcm93IHNwYW5zLlxuICAgICAgICBmb3IgKGxldCByb3dJbmRleCA9IDA7IHJvd0luZGV4IDwgcm93Q291bnQ7IHJvd0luZGV4ICs9IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IHJvdyA9IHJvd3Nbcm93SW5kZXhdO1xuICAgICAgICAgICAgY29uc3QgY2VsbHMgPSByb3cuY2hpbGRyZW4oVGFibGVDZWxsTm9kZSkuc2xpY2UoKTtcbiAgICAgICAgICAgIGZvciAobGV0IGRvbUNlbGxJbmRleCA9IDA7IGRvbUNlbGxJbmRleCA8IGNlbGxzLmxlbmd0aDsgZG9tQ2VsbEluZGV4ICs9IDEpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjZWxsID0gY2VsbHNbZG9tQ2VsbEluZGV4XTtcblxuICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGlzIGEgY2VsbCBhdCB0aGlzIGdyaWQgcG9zaXRpb24gYWxyZWFkeSwgaXQgbWVhbnMgd2VcbiAgICAgICAgICAgICAgICAvLyBhZGRlZCBpdCB0aGVyZSB3aGVuIGhhbmRsaW5nIGFub3RoZXIgY2VsbCwgaWUuIGl0J3MgYVxuICAgICAgICAgICAgICAgIC8vIHBsYWNlaG9sZGVyIGNlbGwsIG1hbmFnZWQgYnkgYSBwcmV2aW91c2x5IGhhbmRsZWQgY2VsbC5cbiAgICAgICAgICAgICAgICAvLyBUaGUgY3VycmVudCBjZWxsIG5lZWRzIHRvIGJlIGFkZGVkIGF0IHRoZSBuZXh0IGF2YWlsYWJsZSBzbG90XG4gICAgICAgICAgICAgICAgLy8gaW5zdGVhZC5cbiAgICAgICAgICAgICAgICBsZXQgY29sdW1uSW5kZXggPSBkb21DZWxsSW5kZXg7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGdyaWRbcm93SW5kZXhdW2NvbHVtbkluZGV4XSkge1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW5JbmRleCArPSAxO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIENoZWNrIHRyYXZlcnNpbmcgY29sc3BhbiBhbmQgcm93c3BhbiB0byBpbnNlcnQgcGxhY2Vob2xkZXJcbiAgICAgICAgICAgICAgICAvLyBjZWxscyB3aGVyZSBuZWNlc3NhcnkuIENvbnN1bWUgdGhlc2UgYXR0cmlidXRlcyBhcyB0aGV5IHdpbGxcbiAgICAgICAgICAgICAgICAvLyBiZSByZXBsYWNlZCB3aXRoIGdldHRlcnMuXG4gICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9IGNlbGwubW9kaWZpZXJzLmZpbmQoQXR0cmlidXRlcyk7XG4gICAgICAgICAgICAgICAgbGV0IGNvbHNwYW4gPSAxO1xuICAgICAgICAgICAgICAgIGxldCByb3dzcGFuID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICBjb2xzcGFuID0gcGFyc2VJbnQoYXR0cmlidXRlcy5nZXQoJ2NvbHNwYW4nKSwgMTApIHx8IDE7XG4gICAgICAgICAgICAgICAgICAgIHJvd3NwYW4gPSBwYXJzZUludChhdHRyaWJ1dGVzLmdldCgncm93c3BhbicpLCAxMCkgfHwgMTtcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5yZW1vdmUoJ2NvbHNwYW4nKTtcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5yZW1vdmUoJ3Jvd3NwYW4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IHJvd0luZGV4OyBpIDwgcm93SW5kZXggKyByb3dzcGFuOyBpICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IGNvbHVtbkluZGV4OyBqIDwgY29sdW1uSW5kZXggKyBjb2xzcGFuOyBqICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID09PSByb3dJbmRleCAmJiBqID09PSBjb2x1bW5JbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgY3VycmVudCBjZWxsIHRvIHRoZSBncmlkLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyaWRbaV1bal0gPSBjZWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGQgYSBwbGFjZWhvbGRlciBjZWxsIHRvIHRoZSBncmlkLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyQ2VsbCA9IG5ldyBUYWJsZUNlbGxOb2RlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXJDZWxsLm1lcmdlV2l0aChjZWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBncmlkW2ldW2pdID0gcGxhY2Vob2xkZXJDZWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBncmlkO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENvbG9yLCBDb2xvckNvbmZpZyB9IGZyb20gJy4uLy4uL3BsdWdpbi1jb2xvci9zcmMvQ29sb3InO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgS2V5bWFwIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWtleW1hcC9zcmMvS2V5bWFwJztcblxuZXhwb3J0IGNsYXNzIFRleHRDb2xvcjxUIGV4dGVuZHMgQ29sb3JDb25maWcgPSBDb2xvckNvbmZpZz4gZXh0ZW5kcyBDb2xvcjxUPiB7XG4gICAgc3R5bGVOYW1lID0gJ2NvbG9yJztcbiAgICBjb25maWd1cmF0aW9uID0geyBkZWZhdWx0Q29sb3I6ICdibGFjaycsIC4uLnRoaXMuY29uZmlndXJhdGlvbiB9O1xuICAgIGNvbW1hbmRzID0ge1xuICAgICAgICBjb2xvclRleHQ6IHtcbiAgICAgICAgICAgIGhhbmRsZXI6IHRoaXMuY29sb3IsXG4gICAgICAgIH0sXG4gICAgICAgIHVuY29sb3JUZXh0OiB7XG4gICAgICAgICAgICBoYW5kbGVyOiB0aGlzLnVuY29sb3IsXG4gICAgICAgIH0sXG4gICAgfTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxLZXltYXA+ID0ge1xuICAgICAgICBzaG9ydGN1dHM6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtHJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICdjb2xvclRleHQnLFxuICAgICAgICAgICAgICAgIC8vIFRPRE86IHVzZSBkaWFsb2cgdG8gZ2V0IHBhcmFtc1xuICAgICAgICAgICAgICAgIGNvbW1hbmRBcmdzOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiAncmVkJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwYXR0ZXJuOiAnQ1RSTCtTSElGVCtHJyxcbiAgICAgICAgICAgICAgICBjb21tYW5kSWQ6ICd1bmNvbG9yVGV4dCcsXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgIH07XG59XG4iLCJ2YXIgYXBpID0gcmVxdWlyZShcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIik7XG4gICAgICAgICAgICB2YXIgY29udGVudCA9IHJlcXVpcmUoXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vVG9vbGJhci5jc3NcIik7XG5cbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50Ll9fZXNNb2R1bGUgPyBjb250ZW50LmRlZmF1bHQgOiBjb250ZW50O1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIGNvbnRlbnQgPSBbW21vZHVsZS5pZCwgY29udGVudCwgJyddXTtcbiAgICAgICAgICAgIH1cblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5pbnNlcnQgPSBcImhlYWRcIjtcbm9wdGlvbnMuc2luZ2xldG9uID0gZmFsc2U7XG5cbnZhciB1cGRhdGUgPSBhcGkoY29udGVudCwgb3B0aW9ucyk7XG5cbnZhciBleHBvcnRlZCA9IGNvbnRlbnQubG9jYWxzID8gY29udGVudC5sb2NhbHMgOiB7fTtcblxuXG5cbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0ZWQ7IiwibW9kdWxlLmV4cG9ydHMgPSBcIjx0ZW1wbGF0ZXM+XFxuICAgIDwhLS0gTUFJTiAtLT5cXG4gICAgPGp3LXRvb2xiYXIgdC1uYW1lPVxcXCJ0b29sYmFyXFxcIj5cXG4gICAgICAgIDx0IHQtZm9yZWFjaD1cXFwiY29uZmlnXFxcIiB0LWFzPVxcXCJncm91cFxcXCJcXG4gICAgICAgICAgICB0LWtleT1cXFwiZ3JvdXBfaW5kZXhcXFwiPlxcbiAgICAgICAgICAgIDx0IHQtaWY9XFxcImdyb3VwID09PSAnfCdcXFwiPlxcbiAgICAgICAgICAgICAgICA8anctc2VwYXJhdG9yIHJvbGU9XFxcInNlcGFyYXRvclxcXCIvPlxcbiAgICAgICAgICAgIDwvdD5cXG4gICAgICAgICAgICA8dCB0LWVsaWY9XFxcImlzU3RyaW5nKGdyb3VwKVxcXCI+XFxuICAgICAgICAgICAgICAgIDxzcGFuPjx0IHQtZXNjPVxcXCJncm91cFxcXCIvPjwvc3Bhbj5cXG4gICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgPHQgdC1lbHNlPVxcXCJcXFwiPlxcbiAgICAgICAgICAgICAgICA8dG9vbGJhci1ncm91cD5cXG4gICAgICAgICAgICAgICAgICAgIDx0IHQtZm9yZWFjaD1cXFwiZ3JvdXBcXFwiIHQtYXM9XFxcInRvb2xiYXJJdGVtXFxcIiB0LWtleT1cXFwidG9vbGJhckl0ZW1faW5kZXhcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDx0IHQtaWY9XFxcInRvb2xiYXJJdGVtID09PSAnfCdcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8anctc2VwYXJhdG9yIHJvbGU9XFxcInNlcGFyYXRvclxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWVsaWY9XFxcImlzU3RyaW5nKHRvb2xiYXJJdGVtKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuPjx0IHQtZXNjPVxcXCJ0b29sYmFySXRlbVxcXCIvPjwvc3Bhbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1lbGlmPVxcXCJpc0FycmF5KHRvb2xiYXJJdGVtKVxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzZWxlY3QgdC1vbi1jaGFuZ2U9XFxcIm9uRHJvcGRvd25DaGFuZ2UodG9vbGJhckl0ZW0pXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24vPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1mb3JlYWNoPVxcXCJ0b29sYmFySXRlbVxcXCIgdC1hcz1cXFwiZHJvcERvd25JdGVtXFxcIiB0LWtleT1cXFwiZHJvcGRvd25JdGVtX2luZGV4XFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWlmPVxcXCJpc1N0cmluZyhkcm9wRG93bkl0ZW0pXFxcIj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiBkaXNhYmxlZD1cXFwidHJ1ZVxcXCI+PHQgdC1lc2M9XFxcImRyb3BEb3duSXRlbVxcXCIvPjwvb3B0aW9uPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdD5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWVsc2U9XFxcIlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdC1pZj1cXFwiaXNFbmFibGVkKHRvb2xiYXJJdGVtKVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtYXR0Zi1jbGFzcz1cXFwie3tkcm9wRG93bkl0ZW0uY2xhc3N9fVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtYXR0Zi12YWx1ZT1cXFwie3tkcm9wRG93bkl0ZW0udGl0bGV9fVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtYXR0LXNlbGVjdGVkPVxcXCJpc1NlbGVjdGVkKGRyb3BEb3duSXRlbSlcXFwiPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHQgdC1lc2M9XFxcImRyb3BEb3duSXRlbS50aXRsZVxcXCIvPlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L29wdGlvbj5cXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvc2VsZWN0PlxcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvdD5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8dCB0LWVsc2U9XFxcIlxcXCI+XFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gdC1hdHRmLWNsYXNzPVxcXCJmYSB7e3Rvb2xiYXJJdGVtLmNsYXNzfX0gZmEtZndcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LWF0dC1jbGFzcz1cXFwie1xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZXNzZWQ6IGlzU2VsZWN0ZWQodG9vbGJhckl0ZW0pLFxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtYXR0Zi10aXRsZT1cXFwie3t0b29sYmFySXRlbS50aXRsZX19XFxcIlxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC1hdHQtYXJpYS1wcmVzc2VkPVxcXCJpc1NlbGVjdGVkKHRvb2xiYXJJdGVtKVxcXCJcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQtb24tY2xpY2s9XFxcImV4ZWNDb21tYW5kKHRvb2xiYXJJdGVtLmNvbW1hbmRJZCxcXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b29sYmFySXRlbS5jb21tYW5kQXJncylcXFwiXFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LWF0dC1kaXNhYmxlZD1cXFwiIWlzRW5hYmxlZCh0b29sYmFySXRlbSlcXFwiLz5cXG4gICAgICAgICAgICAgICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgICAgICAgICA8L3Q+XFxuICAgICAgICAgICAgICAgIDwvdG9vbGJhci1ncm91cD5cXG4gICAgICAgICAgICA8L3Q+XFxuICAgICAgICA8L3Q+XFxuICAgIDwvanctdG9vbGJhcj5cXG48L3RlbXBsYXRlcz5cXG5cIiIsImltcG9ydCBKV0VkaXRvciwgeyBMb2FkYWJsZXMgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBKV1BsdWdpbiwgSldQbHVnaW5Db25maWcgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV1BsdWdpbic7XG5pbXBvcnQgeyBDb21tYW5kSWRlbnRpZmllciwgQ29tbWFuZFBhcmFtcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0Rpc3BhdGNoZXInO1xuaW1wb3J0IHsgT3dsIH0gZnJvbSAnLi4vLi4vcGx1Z2luLW93bC9zcmMvT3dsJztcbmltcG9ydCB7IFRvb2xiYXJDb21wb25lbnQgfSBmcm9tICcuL2NvbXBvbmVudHMvVG9vbGJhckNvbXBvbmVudCc7XG5pbXBvcnQgeyBMYXlvdXQgfSBmcm9tICcuLi8uLi9wbHVnaW4tbGF5b3V0L3NyYy9MYXlvdXQnO1xuaW1wb3J0IHsgT3dsTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1vd2wvc3JjL3VpL093bE5vZGUnO1xuXG5pbXBvcnQgdG9vbGJhclRlbXBsYXRlcyBmcm9tICcuLi9hc3NldHMvVG9vbGJhci54bWwnO1xuaW1wb3J0ICcuLi9hc3NldHMvVG9vbGJhci5jc3MnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEJ1dHRvbiB7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBjbGFzcz86IHN0cmluZztcbiAgICBjb21tYW5kSWQ6IENvbW1hbmRJZGVudGlmaWVyO1xuICAgIGNvbW1hbmRBcmdzPzogQ29tbWFuZFBhcmFtcztcbiAgICBzZWxlY3RlZD86IChlZGl0b3I6IEpXRWRpdG9yKSA9PiBib29sZWFuO1xuICAgIGVuYWJsZWQ/OiAoZWRpdG9yOiBKV0VkaXRvcikgPT4gYm9vbGVhbjtcbn1cbmV4cG9ydCB0eXBlIFRvb2xiYXJJdGVtID0gQnV0dG9uIHwgc3RyaW5nIHwgQXJyYXk8QnV0dG9uIHwgc3RyaW5nPjtcbmV4cG9ydCB0eXBlIFRvb2xiYXJHcm91cCA9IFRvb2xiYXJJdGVtW107XG5leHBvcnQgdHlwZSBUb29sYmFyTGF5b3V0ID0gQXJyYXk8VG9vbGJhckdyb3VwIHwgc3RyaW5nPjtcblxuZXhwb3J0IGludGVyZmFjZSBUb29sYmFyQ29uZmlnIGV4dGVuZHMgSldQbHVnaW5Db25maWcge1xuICAgIGxheW91dD86IFRvb2xiYXJMYXlvdXQ7XG59XG5cbmV4cG9ydCBjbGFzcyBUb29sYmFyPFQgZXh0ZW5kcyBUb29sYmFyQ29uZmlnID0ge30+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbT3dsXTtcbiAgICByZWFkb25seSBsb2FkYWJsZXM6IExvYWRhYmxlczxMYXlvdXQgJiBPd2w+ID0ge1xuICAgICAgICBjb21wb25lbnRzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWQ6ICd0b29sYmFyJyxcbiAgICAgICAgICAgICAgICBhc3luYyByZW5kZXIoKTogUHJvbWlzZTxPd2xOb2RlW10+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFtuZXcgT3dsTm9kZShUb29sYmFyQ29tcG9uZW50LCB7fSldO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICBdLFxuICAgICAgICBjb21wb25lbnRab25lczogW1sndG9vbGJhcicsICd0b29scyddXSxcbiAgICAgICAgb3dsVGVtcGxhdGVzOiBbdG9vbGJhclRlbXBsYXRlc10sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IENvbW1hbmRJZGVudGlmaWVyLCBDb21tYW5kUGFyYW1zIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9zcmMvRGlzcGF0Y2hlcic7XG5pbXBvcnQgeyBUb29sYmFyLCBUb29sYmFyTGF5b3V0LCBCdXR0b24sIFRvb2xiYXJJdGVtIH0gZnJvbSAnLi4vVG9vbGJhcic7XG5pbXBvcnQgeyBPd2xDb21wb25lbnQgfSBmcm9tICcuLi8uLi8uLi9wbHVnaW4tb3dsL3NyYy91aS9Pd2xDb21wb25lbnQnO1xuXG5leHBvcnQgY2xhc3MgVG9vbGJhckNvbXBvbmVudDxUID0ge30+IGV4dGVuZHMgT3dsQ29tcG9uZW50PFQ+IHtcbiAgICBzdGF0aWMgY29tcG9uZW50cyA9IHt9O1xuICAgIHN0YXRpYyB0ZW1wbGF0ZSA9ICd0b29sYmFyJztcbiAgICBjb25maWc6IFRvb2xiYXJMYXlvdXQgPSB0aGlzLmVudi5lZGl0b3IucGx1Z2lucy5nZXQoVG9vbGJhcikuY29uZmlndXJhdGlvbi5sYXlvdXQgfHwgW107XG5cbiAgICBhc3luYyB3aWxsU3RhcnQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRoaXMuZW52LmVkaXRvci5kaXNwYXRjaGVyLnJlZ2lzdGVyQ29tbWFuZEhvb2soJyonLCB0aGlzLnJlZnJlc2guYmluZCh0aGlzKSk7XG4gICAgICAgIHJldHVybiBzdXBlci53aWxsU3RhcnQoKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgZXhlY0NvbW1hbmQoY29tbWFuZElkOiBDb21tYW5kSWRlbnRpZmllciwgY29tbWFuZEFyZ3M/OiBDb21tYW5kUGFyYW1zKTogdm9pZCB7XG4gICAgICAgIHRoaXMuZW52LmVkaXRvci5leGVjQ29tbWFuZChjb21tYW5kSWQsIGNvbW1hbmRBcmdzKTtcbiAgICB9XG4gICAgaXNFbmFibGVkKGl0ZW06IEJ1dHRvbik6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gIWl0ZW0uZW5hYmxlZCB8fCBpdGVtLmVuYWJsZWQodGhpcy5lbnYuZWRpdG9yKTtcbiAgICB9XG4gICAgaXNTZWxlY3RlZChpdGVtOiBCdXR0b24pOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uc2VsZWN0ZWQgJiYgaXRlbS5zZWxlY3RlZCh0aGlzLmVudi5lZGl0b3IpO1xuICAgIH1cbiAgICBpc0FycmF5KGl0ZW06IFRvb2xiYXJJdGVtKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KGl0ZW0pO1xuICAgIH1cbiAgICBpc1N0cmluZyhpdGVtOiBUb29sYmFySXRlbSk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHlwZW9mIGl0ZW0gPT09ICdzdHJpbmcnO1xuICAgIH1cbiAgICBvbkRyb3Bkb3duQ2hhbmdlKGRyb3Bkb3duOiBCdXR0b24sIGV2ZW50OiBFdmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBzZWxlY3RlZEluZGV4ID0gKGV2ZW50LnRhcmdldCBhcyBIVE1MU2VsZWN0RWxlbWVudCkuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgLy8gLTEgdG8gYWNjb3VudCBmb3IgdGhlIG1hbmRhdG9yeSBlbXB0eSBvcHRpb24gb24gdG9wOlxuICAgICAgICBjb25zdCBkcm9wZG93bkl0ZW0gPSBkcm9wZG93bltzZWxlY3RlZEluZGV4IC0gMV07XG4gICAgICAgIGlmIChkcm9wZG93bkl0ZW0pIHtcbiAgICAgICAgICAgIHRoaXMuZXhlY0NvbW1hbmQoZHJvcGRvd25JdGVtLmNvbW1hbmRJZCwgZHJvcGRvd25JdGVtLmNvbW1hbmRBcmdzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyByZWZyZXNoKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IFVuZGVybGluZUZvcm1hdCB9IGZyb20gJy4vVW5kZXJsaW5lRm9ybWF0JztcbmltcG9ydCB7IEZvcm1hdFBhcmFtcywgSW5saW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWlubGluZS9zcmMvSW5saW5lJztcbmltcG9ydCB7IFVuZGVybGluZVhtbERvbVBhcnNlciB9IGZyb20gJy4vVW5kZXJsaW5lWG1sRG9tUGFyc2VyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBLZXltYXAgfSBmcm9tICcuLi8uLi9wbHVnaW4ta2V5bWFwL3NyYy9LZXltYXAnO1xuXG5leHBvcnQgY2xhc3MgVW5kZXJsaW5lPFQgZXh0ZW5kcyBKV1BsdWdpbkNvbmZpZyA9IEpXUGx1Z2luQ29uZmlnPiBleHRlbmRzIEpXUGx1Z2luPFQ+IHtcbiAgICBzdGF0aWMgZGVwZW5kZW5jaWVzID0gW0lubGluZV07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgS2V5bWFwPiA9IHtcbiAgICAgICAgcGFyc2VyczogW1VuZGVybGluZVhtbERvbVBhcnNlcl0sXG4gICAgICAgIHNob3J0Y3V0czogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHBhdHRlcm46ICdDVFJMK1UnLFxuICAgICAgICAgICAgICAgIGNvbW1hbmRJZDogJ3RvZ2dsZUZvcm1hdCcsXG4gICAgICAgICAgICAgICAgY29tbWFuZEFyZ3M6IHsgRm9ybWF0Q2xhc3M6IFVuZGVybGluZUZvcm1hdCB9IGFzIEZvcm1hdFBhcmFtcyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIF0sXG4gICAgfTtcbn1cbiIsImltcG9ydCBKV0VkaXRvciBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBVbmRlcmxpbmVGb3JtYXQgfSBmcm9tICcuL1VuZGVybGluZUZvcm1hdCc7XG5pbXBvcnQgeyBGb3JtYXRQYXJhbXMsIElubGluZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZSc7XG5pbXBvcnQgeyBCdXR0b24gfSBmcm9tICcuLi8uLi9wbHVnaW4tdG9vbGJhci9zcmMvVG9vbGJhcic7XG5cbmV4cG9ydCBjb25zdCBVbmRlcmxpbmVCdXR0b246IEJ1dHRvbiA9IHtcbiAgICB0aXRsZTogJ1RvZ2dsZSB1bmRlcmxpbmUnLFxuICAgIGNsYXNzOiAnZmEtdW5kZXJsaW5lJyxcbiAgICBjb21tYW5kSWQ6ICd0b2dnbGVGb3JtYXQnLFxuICAgIGNvbW1hbmRBcmdzOiB7IEZvcm1hdENsYXNzOiBVbmRlcmxpbmVGb3JtYXQgfSBhcyBGb3JtYXRQYXJhbXMsXG4gICAgc2VsZWN0ZWQ6IChlZGl0b3I6IEpXRWRpdG9yKTogYm9vbGVhbiA9PlxuICAgICAgICBlZGl0b3IucGx1Z2lucy5nZXQoSW5saW5lKS5pc0FsbEZvcm1hdChVbmRlcmxpbmVGb3JtYXQpLFxufTtcbiIsImltcG9ydCB7IEZvcm1hdCB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0Zvcm1hdCc7XG5cbmV4cG9ydCBjbGFzcyBVbmRlcmxpbmVGb3JtYXQgZXh0ZW5kcyBGb3JtYXQge1xuICAgIGh0bWxUYWcgPSAnVSc7XG59XG4iLCJpbXBvcnQgeyBGb3JtYXRQYXJzZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4taW5saW5lL3NyYy9Gb3JtYXRQYXJzZXInO1xuaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgVW5kZXJsaW5lRm9ybWF0IH0gZnJvbSAnLi9VbmRlcmxpbmVGb3JtYXQnO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVW5kZXJsaW5lWG1sRG9tUGFyc2VyIGV4dGVuZHMgRm9ybWF0UGFyc2VyIHtcbiAgICBzdGF0aWMgaWQgPSBYbWxEb21QYXJzaW5nRW5naW5lLmlkO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIHByZWRpY2F0ZSA9IChpdGVtOiBOb2RlKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJiBub2RlTmFtZShpdGVtKSA9PT0gJ1UnO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBQYXJzZSBhbiB1bmRlcmxpbmUgbm9kZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpdGVtXG4gICAgICovXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8Vk5vZGVbXT4ge1xuICAgICAgICBjb25zdCB1bmRlcmxpbmUgPSBuZXcgVW5kZXJsaW5lRm9ybWF0KCk7XG4gICAgICAgIHVuZGVybGluZS5tb2RpZmllcnMuYXBwZW5kKHRoaXMuZW5naW5lLnBhcnNlQXR0cmlidXRlcyhpdGVtKSk7XG4gICAgICAgIGNvbnN0IGNoaWxkcmVuID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgdGhpcy5hcHBseUZvcm1hdCh1bmRlcmxpbmUsIGNoaWxkcmVuKTtcblxuICAgICAgICByZXR1cm4gY2hpbGRyZW47XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgT2Rvb1ZpZGVvWG1sRG9tUGFyc2VyIH0gZnJvbSAnLi9PZG9vVmlkZW9YbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgT2Rvb1ZpZGVvSHRtbERvbVJlbmRlcmVyIH0gZnJvbSAnLi9PZG9vVmlkZW9IdG1sRG9tUmVuZGVyZXInO1xuaW1wb3J0IHsgTG9hZGFibGVzIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldFZGl0b3InO1xuaW1wb3J0IHsgUGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvUGFyc2VyJztcbmltcG9ydCB7IFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9SZW5kZXJlcic7XG5cbmV4cG9ydCBjbGFzcyBPZG9vVmlkZW88VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHJlYWRvbmx5IGxvYWRhYmxlczogTG9hZGFibGVzPFBhcnNlciAmIFJlbmRlcmVyPiA9IHtcbiAgICAgICAgcGFyc2VyczogW09kb29WaWRlb1htbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW09kb29WaWRlb0h0bWxEb21SZW5kZXJlcl0sXG4gICAgfTtcbn1cbiIsImltcG9ydCB7IEFic3RyYWN0UmVuZGVyZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcmVuZGVyZXIvc3JjL0Fic3RyYWN0UmVuZGVyZXInO1xuaW1wb3J0IHsgT2Rvb1ZpZGVvTm9kZSB9IGZyb20gJy4vT2Rvb1ZpZGVvTm9kZSc7XG5pbXBvcnQgeyBIdG1sRG9tUmVuZGVyaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWh0bWwvc3JjL0h0bWxEb21SZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQ29yZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0NvcmUnO1xuaW1wb3J0IHsgRGlyZWN0aW9uIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVlNlbGVjdGlvbic7XG5cbmV4cG9ydCBjbGFzcyBPZG9vVmlkZW9IdG1sRG9tUmVuZGVyZXIgZXh0ZW5kcyBBYnN0cmFjdFJlbmRlcmVyPE5vZGVbXT4ge1xuICAgIHN0YXRpYyBpZCA9IEh0bWxEb21SZW5kZXJpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBIdG1sRG9tUmVuZGVyaW5nRW5naW5lO1xuICAgIHByZWRpY2F0ZSA9IE9kb29WaWRlb05vZGU7XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogT2Rvb1ZpZGVvTm9kZSk6IFByb21pc2U8Tm9kZVtdPiB7XG4gICAgICAgIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdtZWRpYV9pZnJhbWVfdmlkZW8nKTtcbiAgICAgICAgd3JhcHBlci5zZXRBdHRyaWJ1dGUoJ2RhdGEtb2UtZXhwcmVzc2lvbicsIG5vZGUuc3JjKTtcbiAgICAgICAgd3JhcHBlci5pbm5lckhUTUwgPSBbXG4gICAgICAgICAgICBgPGRpdiBjbGFzcz1cImNzc19lZGl0YWJsZV9tb2RlX2Rpc3BsYXlcIj4mbmJzcDs8L2Rpdj5gLFxuICAgICAgICAgICAgYDxkaXYgY2xhc3M9XCJtZWRpYV9pZnJhbWVfdmlkZW9fc2l6ZVwiPiZuYnNwOzwvZGl2PmAsXG4gICAgICAgICAgICBgPGlmcmFtZSBzcmM9XCIke25vZGUuc3JjfVwiIGZyYW1lYm9yZGVyPVwiMFwiIGFsbG93ZnVsbHNjcmVlbj1cImFsbG93ZnVsbHNjcmVlblwiPjwvaWZyYW1lPmAsXG4gICAgICAgIF0uam9pbignJyk7XG4gICAgICAgIHdyYXBwZXIucXVlcnlTZWxlY3RvcignLmNzc19lZGl0YWJsZV9tb2RlX2Rpc3BsYXknKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZW5naW5lLmVkaXRvci5uZXh0RXZlbnRNdXRleCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmdpbmUuZWRpdG9yLmV4ZWNDb21tYW5kPENvcmU+KCdzZXRTZWxlY3Rpb24nLCB7XG4gICAgICAgICAgICAgICAgICAgIHZTZWxlY3Rpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFuY2hvck5vZGU6IG5vZGUsXG4gICAgICAgICAgICAgICAgICAgICAgICBkaXJlY3Rpb246IERpcmVjdGlvbi5GT1JXQVJELFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICB3cmFwcGVyLnF1ZXJ5U2VsZWN0b3IoJy5jc3NfZWRpdGFibGVfbW9kZV9kaXNwbGF5JykuYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmVuZ2luZS5lZGl0b3IubmV4dEV2ZW50TXV0ZXgoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZW5naW5lLmVkaXRvci5leGVjQ29tbWFuZCgnb3Blbk1lZGlhJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBbd3JhcHBlcl07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQXRvbWljTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9BdG9taWNOb2RlJztcblxuZXhwb3J0IGludGVyZmFjZSBPZG9vVmlkZW9Ob2RlUGFyYW1zIHtcbiAgICBzcmM6IHN0cmluZztcbn1cbmV4cG9ydCBjbGFzcyBPZG9vVmlkZW9Ob2RlIGV4dGVuZHMgQXRvbWljTm9kZSB7XG4gICAgc3JjOiBzdHJpbmc7XG4gICAgY29uc3RydWN0b3IocGFyYW1zOiBPZG9vVmlkZW9Ob2RlUGFyYW1zKSB7XG4gICAgICAgIHN1cGVyKCk7XG4gICAgICAgIHRoaXMuc3JjID0gcGFyYW1zLnNyYztcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBPZG9vVmlkZW9Ob2RlIH0gZnJvbSAnLi9PZG9vVmlkZW9Ob2RlJztcbmltcG9ydCB7IEFic3RyYWN0UGFyc2VyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXBhcnNlci9zcmMvQWJzdHJhY3RQYXJzZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL1htbERvbVBhcnNpbmdFbmdpbmUnO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9zcmMvdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgT2Rvb1ZpZGVvWG1sRG9tUGFyc2VyIGV4dGVuZHMgQWJzdHJhY3RQYXJzZXI8Tm9kZT4ge1xuICAgIHN0YXRpYyBpZCA9IFhtbERvbVBhcnNpbmdFbmdpbmUuaWQ7XG4gICAgZW5naW5lOiBYbWxEb21QYXJzaW5nRW5naW5lO1xuXG4gICAgcHJlZGljYXRlID0gKG5vZGU6IE5vZGUpOiBib29sZWFuID0+IHtcbiAgICAgICAgY29uc3QgaXNWaWRlbyA9XG4gICAgICAgICAgICBub2RlIGluc3RhbmNlb2YgRWxlbWVudCAmJlxuICAgICAgICAgICAgbm9kZU5hbWUobm9kZSkgPT09ICdESVYnICYmXG4gICAgICAgICAgICBub2RlLmNsYXNzTGlzdC5jb250YWlucygnbWVkaWFfaWZyYW1lX3ZpZGVvJykgJiZcbiAgICAgICAgICAgIG5vZGUuYXR0cmlidXRlc1snZGF0YS1vZS1leHByZXNzaW9uJ10gJiZcbiAgICAgICAgICAgIG5vZGUuYXR0cmlidXRlc1snZGF0YS1vZS1leHByZXNzaW9uJ10udmFsdWU7XG4gICAgICAgIHJldHVybiBpc1ZpZGVvO1xuICAgIH07XG5cbiAgICBhc3luYyBwYXJzZShlbGVtZW50OiBFbGVtZW50KTogUHJvbWlzZTxPZG9vVmlkZW9Ob2RlW10+IHtcbiAgICAgICAgY29uc3QgdmlkZW8gPSBuZXcgT2Rvb1ZpZGVvTm9kZSh7IHNyYzogZWxlbWVudC5hdHRyaWJ1dGVzWydkYXRhLW9lLWV4cHJlc3Npb24nXS52YWx1ZSB9KTtcbiAgICAgICAgdmlkZW8ubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoZWxlbWVudCkpO1xuICAgICAgICByZXR1cm4gW3ZpZGVvXTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBNb2RpZmllciB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL01vZGlmaWVyJztcbmltcG9ydCB7IENzc1N0eWxlIH0gZnJvbSAnLi9Dc3NTdHlsZSc7XG5pbXBvcnQgeyBDbGFzc0xpc3QgfSBmcm9tICcuL0NsYXNzTGlzdCc7XG5cbmV4cG9ydCBjbGFzcyBBdHRyaWJ1dGVzIGV4dGVuZHMgTW9kaWZpZXIge1xuICAgIHByaXZhdGUgX3JlY29yZDogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICAgIHN0eWxlID0gbmV3IENzc1N0eWxlKCk7XG4gICAgY2xhc3NMaXN0ID0gbmV3IENsYXNzTGlzdCgpO1xuICAgIGNvbnN0cnVjdG9yKGF0dHJpYnV0ZXM/OiBBdHRyaWJ1dGVzIHwgTmFtZWROb2RlTWFwIHwgUmVjb3JkPHN0cmluZywgc3RyaW5nPikge1xuICAgICAgICBzdXBlcigpO1xuICAgICAgICBpZiAoYXR0cmlidXRlcyBpbnN0YW5jZW9mIEF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGF0dHJpYnV0ZXMua2V5cygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoa2V5LCBhdHRyaWJ1dGVzLmdldChrZXkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChhdHRyaWJ1dGVzIGluc3RhbmNlb2YgTmFtZWROb2RlTWFwKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZSBvZiBBcnJheS5mcm9tKGF0dHJpYnV0ZXMpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXQoYXR0cmlidXRlLm5hbWUsIGF0dHJpYnV0ZS52YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoYXR0cmlidXRlcykge1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoYXR0cmlidXRlcykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldChrZXksIGF0dHJpYnV0ZXNba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gR2V0dGVyc1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5cygpLmxlbmd0aDtcbiAgICB9XG4gICAgZ2V0IG5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGF0dHJpYnV0ZU5hbWUgb2YgdGhpcy5rZXlzKCkpIHtcbiAgICAgICAgICAgIG5hbWUucHVzaChgJHthdHRyaWJ1dGVOYW1lfTogXCIke3RoaXMuZ2V0KGF0dHJpYnV0ZU5hbWUpfVwiYCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGB7JHtuYW1lLmpvaW4oJywgJyl9fWA7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIExpZmVjeWNsZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIGNsb25lIG9mIHRoaXMgcmVjb3JkLlxuICAgICAqL1xuICAgIGNsb25lKCk6IHRoaXMge1xuICAgICAgICBjb25zdCBjbG9uZSA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKCk7XG4gICAgICAgIGNsb25lLl9yZWNvcmQgPSB7IC4uLnRoaXMuX3JlY29yZCB9O1xuICAgICAgICBjbG9uZS5zdHlsZSA9IHRoaXMuc3R5bGUuY2xvbmUoKTtcbiAgICAgICAgY2xvbmUuY2xhc3NMaXN0ID0gdGhpcy5jbGFzc0xpc3QuY2xvbmUoKTtcbiAgICAgICAgcmV0dXJuIGNsb25lO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBzdHJpbmcgcmVwcmVzZW50aW5nIHRoZSBhdHRyaWJ1dGVzLlxuICAgICAqL1xuICAgIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgICAgIGlmICghdGhpcy5sZW5ndGgpIHJldHVybiBgJHt0aGlzLmNvbnN0cnVjdG9yLm5hbWV9OiB7fWA7XG4gICAgICAgIGNvbnN0IHZhbHVlUmVwciA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiB0aGlzLmtleXMoKSkge1xuICAgICAgICAgICAgdmFsdWVSZXByLnB1c2goYCR7a2V5fTogXCIke3RoaXMuZ2V0KGtleSl9XCJgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7dGhpcy5jb25zdHJ1Y3Rvci5uYW1lfTogeyAke3ZhbHVlUmVwci5qb2luKCcsICcpfSB9YDtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIHJlY29yZCBoYXMgdGhlIGdpdmVuIGtleSwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGtleVxuICAgICAqL1xuICAgIGhhcyhrZXk6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5rZXlzKCkuaW5jbHVkZXMoa2V5KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGFuIGFycmF5IGNvbnRhaW5pbmcgYWxsIHRoZSBrZXlzIGluIHRoZSByZWNvcmQuXG4gICAgICovXG4gICAga2V5cygpOiBzdHJpbmdbXSB7XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLl9yZWNvcmQpLmZpbHRlcihrZXkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAoa2V5ICE9PSAnc3R5bGUnIHx8ICEhdGhpcy5zdHlsZS5sZW5ndGgpICYmXG4gICAgICAgICAgICAgICAgKGtleSAhPT0gJ2NsYXNzJyB8fCAhIXRoaXMuY2xhc3NMaXN0Lmxlbmd0aClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodGhpcy5jbGFzc0xpc3QubGVuZ3RoICYmICFrZXlzLmluY2x1ZGVzKCdjbGFzcycpKSB7XG4gICAgICAgICAgICAvLyBUaGUgbm9kZSB3YXMgbm90IHBhcnNlZCB3aXRoIGEgY2xhc3MgYXR0cmlidXRlLCBhZGQgaXQgaW4gcGxhY2UuXG4gICAgICAgICAgICAvLyBVc2UgYGdldGAgZm9yIGl0cyB2YWx1ZSBidXQgcmVjb3JkIGl0cyBwb3NpdGlvbiBpbiB0aGUgcmVjb3JkLlxuICAgICAgICAgICAgdGhpcy5fcmVjb3JkLmNsYXNzID0gbnVsbDtcbiAgICAgICAgICAgIGtleXMucHVzaCgnY2xhc3MnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zdHlsZS5sZW5ndGggJiYgIWtleXMuaW5jbHVkZXMoJ3N0eWxlJykpIHtcbiAgICAgICAgICAgIC8vIFRoZSBub2RlIHdhcyBub3QgcGFyc2VkIHdpdGggYSBzdHlsZSBhdHRyaWJ1dGUsIGtlZXAgaXQgYWx3YXlzIGF0XG4gICAgICAgICAgICAvLyB0aGUgZW5kIG9mIHRoZSBhdHRyaWJ1dGVzIGxpc3QuXG4gICAgICAgICAgICBrZXlzLnB1c2goJ3N0eWxlJyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGtleXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhbiBhcnJheSBjb250YWluaW5nIGFsbCB0aGUgdmFsdWVzIGluIHRoZSByZWNvcmQuXG4gICAgICovXG4gICAgdmFsdWVzKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIHRoaXMua2V5cygpLm1hcChrZXkgPT4gdGhpcy5nZXQoa2V5KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgcmVjb3JkIG1hdGNoaW5nIHRoZSBnaXZlbiBuYW1lLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKi9cbiAgICBnZXQobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKG5hbWUgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN0eWxlLmNzc1RleHQ7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xhc3NMaXN0LmNsYXNzTmFtZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWNvcmRbbmFtZV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0IHRoZSByZWNvcmQgd2l0aCB0aGUgZ2l2ZW4gbmFtZSB0byB0aGUgZ2l2ZW4gdmFsdWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmFtZVxuICAgICAqIEBwYXJhbSB2YWx1ZVxuICAgICAqL1xuICAgIHNldChuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgaWYgKG5hbWUgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUucmVzZXQodmFsdWUpO1xuICAgICAgICAgICAgLy8gVXNlIGBnZXRgIGZvciBpdHMgdmFsdWUgYnV0IHJlY29yZCBpdHMgcG9zaXRpb24gaW4gdGhlIHJlY29yZC5cbiAgICAgICAgICAgIHRoaXMuX3JlY29yZC5zdHlsZSA9IG51bGw7XG4gICAgICAgIH0gZWxzZSBpZiAobmFtZSA9PT0gJ2NsYXNzJykge1xuICAgICAgICAgICAgdGhpcy5jbGFzc0xpc3QucmVzZXQodmFsdWUpO1xuICAgICAgICAgICAgLy8gVXNlIGBnZXRgIGZvciBpdHMgdmFsdWUgYnV0IHJlY29yZCBpdHMgcG9zaXRpb24gaW4gdGhlIHJlY29yZC5cbiAgICAgICAgICAgIHRoaXMuX3JlY29yZC5jbGFzcyA9IG51bGw7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9yZWNvcmRbbmFtZV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIHJlY29yZHMgd2l0aCB0aGUgZ2l2ZW4gbmFtZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmFtZXNcbiAgICAgKi9cbiAgICByZW1vdmUoLi4ubmFtZXM6IHN0cmluZ1tdKTogdm9pZCB7XG4gICAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBuYW1lcykge1xuICAgICAgICAgICAgaWYgKG5hbWUgPT09ICdzdHlsZScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN0eWxlLmNsZWFyKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdjbGFzcycpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsYXNzTGlzdC5jbGVhcigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5fcmVjb3JkW25hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNsZWFyKCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9yZWNvcmQgPSB7fTtcbiAgICAgICAgdGhpcy5zdHlsZS5jbGVhcigpO1xuICAgICAgICB0aGlzLmNsYXNzTGlzdC5jbGVhcigpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgZ2l2ZW4gYXR0cmlidXRlcyBhcmUgdGhlIHNhbWUgYXMgdGhlIG9uZXMgaW4gdGhpc1xuICAgICAqIHJlY29yZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlckF0dHJpYnV0ZXNcbiAgICAgKi9cbiAgICBpc1NhbWVBcyhvdGhlckF0dHJpYnV0ZXM6IEF0dHJpYnV0ZXMpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKG90aGVyQXR0cmlidXRlcykge1xuICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICB0aGlzLmxlbmd0aCA9PT0gb3RoZXJBdHRyaWJ1dGVzLmxlbmd0aCAmJlxuICAgICAgICAgICAgICAgIHRoaXMua2V5cygpLmV2ZXJ5KGtleSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldChrZXkpID09PSBvdGhlckF0dHJpYnV0ZXMuZ2V0KGtleSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gIXRoaXMubGVuZ3RoO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIENsYXNzTGlzdCB7XG4gICAgcHJpdmF0ZSBfY2xhc3NMaXN0ID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgY29uc3RydWN0b3IoLi4uY2xhc3NMaXN0OiBzdHJpbmdbXSkge1xuICAgICAgICBmb3IgKGNvbnN0IGNsYXNzTmFtZSBvZiBjbGFzc0xpc3QpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkKGNsYXNzTmFtZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gR2V0dGVyc1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbnVtYmVyIG9mIGNsYXNzZXMgaW4gdGhlIHNldC5cbiAgICAgKi9cbiAgICBnZXQgbGVuZ3RoKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbGFzc0xpc3Quc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgdGV4dHVhbCByZXByZXNlbnRhdGlvbiBvZiB0aGUgc2V0LlxuICAgICAqL1xuICAgIGdldCBjbGFzc05hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jbGFzc0xpc3Quc2l6ZSkgcmV0dXJuO1xuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLl9jbGFzc0xpc3QpLmpvaW4oJyAnKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVpbml0aWFsaXplIHRoZSBzZXQgd2l0aCBhIG5ldyBzZXQgb2YgY2xhc3NlcywgZnJvbSBhIHN0cmluZyB0byBwYXJzZS5cbiAgICAgKi9cbiAgICBzZXQgY2xhc3NOYW1lKGNsYXNzTmFtZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMucmVzZXQoY2xhc3NOYW1lKTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gTGlmZWN5Y2xlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgbmV3IHNldCBvZiBjbGFzc2VzLCBwYXJzZWQgZnJvbSBhIGNsYXNzTmFtZSBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2xhc3NOYW1lXG4gICAgICovXG4gICAgcGFyc2VDbGFzc05hbWUoY2xhc3NOYW1lOiBzdHJpbmcpOiBTZXQ8c3RyaW5nPiB7XG4gICAgICAgIHJldHVybiBuZXcgU2V0KFxuICAgICAgICAgICAgY2xhc3NOYW1lXG4gICAgICAgICAgICAgICAgLnRyaW0oKVxuICAgICAgICAgICAgICAgIC5zcGxpdCgvXFxzKy8pXG4gICAgICAgICAgICAgICAgLmZpbHRlcihjID0+IGMubGVuZ3RoKSxcbiAgICAgICAgKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgY2xvbmUgb2YgdGhpcyBsaXN0LlxuICAgICAqL1xuICAgIGNsb25lKCk6IENsYXNzTGlzdCB7XG4gICAgICAgIGNvbnN0IGNsb25lID0gbmV3IENsYXNzTGlzdCgpO1xuICAgICAgICBjbG9uZS5fY2xhc3NMaXN0ID0gbmV3IFNldCh0aGlzLl9jbGFzc0xpc3QpO1xuICAgICAgICByZXR1cm4gY2xvbmU7XG4gICAgfVxuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIFB1YmxpY1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0cnVlIGlmIHRoZSBzZXQgaGFzIHRoZSBnaXZlbiBjbGFzcywgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKi9cbiAgICBoYXMobmFtZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jbGFzc0xpc3QuaGFzKG5hbWUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgY29udGFpbmluZyBhbGwgdGhlIGl0ZW1zIGluIHRoZSBsaXN0LlxuICAgICAqL1xuICAgIGl0ZW1zKCk6IHN0cmluZ1tdIHtcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5fY2xhc3NMaXN0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkIHRoZSBnaXZlbiBjbGFzcyhzKSB0byB0aGUgc2V0LlxuICAgICAqXG4gICAgICogQHBhcmFtIGNsYXNzTmFtZVxuICAgICAqL1xuICAgIGFkZChjbGFzc05hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBjbGFzc2VzID0gdGhpcy5wYXJzZUNsYXNzTmFtZShjbGFzc05hbWUpO1xuICAgICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgY2xhc3Nlcykge1xuICAgICAgICAgICAgdGhpcy5fY2xhc3NMaXN0LmFkZChuYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmUgdGhlIGdpdmVuIGNsYXNzKGVzKSBmcm9tIHRoZSBzZXQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2xhc3NOYW1lXG4gICAgICovXG4gICAgcmVtb3ZlKGNsYXNzTmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGNsYXNzZXMgPSB0aGlzLnBhcnNlQ2xhc3NOYW1lKGNsYXNzTmFtZSk7XG4gICAgICAgIGZvciAoY29uc3QgbmFtZSBvZiBjbGFzc2VzKSB7XG4gICAgICAgICAgICB0aGlzLl9jbGFzc0xpc3QuZGVsZXRlKG5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFyIHRoZSBzZXQgb2YgYWxsIGl0cyBjbGFzc2VzLlxuICAgICAqL1xuICAgIGNsZWFyKCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9jbGFzc0xpc3QgPSBuZXcgU2V0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlaW5pdGlhbGl6ZSB0aGUgc2V0IHdpdGggYSBuZXcgc2V0IG9mIGNsYXNzZXMgKGVtcHR5IGlmIG5vIGFyZ3VtZW50IGlzXG4gICAgICogcGFzc2VkKS4gVGhlIGFyZ3VtZW50IGNhbiBiZSBhIHNldCBvZiBjbGFzc2VzIG9yIGEgc3RyaW5nIHRvIHBhcnNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNsYXNzTGlzdFxuICAgICAqL1xuICAgIHJlc2V0KC4uLmNsYXNzTGlzdDogc3RyaW5nW10pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fY2xhc3NMaXN0LmNsZWFyKCk7XG4gICAgICAgIGZvciAoY29uc3QgY2xhc3NOYW1lIG9mIGNsYXNzTGlzdCkge1xuICAgICAgICAgICAgdGhpcy5hZGQoY2xhc3NOYW1lKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBGb3IgZWFjaCBnaXZlbiBjbGFzcywgYWRkIGl0IHRvIHRoZSBzZXQgaWYgaXQgZG9lc24ndCBoYXZlIGl0IHlldCxcbiAgICAgKiBvdGhlcndpc2UgcmVtb3ZlIGl0LlxuICAgICAqXG4gICAgICogQHBhcmFtIGNsYXNzZXNcbiAgICAgKi9cbiAgICB0b2dnbGUoLi4uY2xhc3Nlczogc3RyaW5nW10pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBjbGFzc05hbWUgb2YgY2xhc3Nlcykge1xuICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gdGhpcy5wYXJzZUNsYXNzTmFtZShjbGFzc05hbWUpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuYW1lIG9mIHBhcnNlZCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jbGFzc0xpc3QuaGFzKG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NsYXNzTGlzdC5kZWxldGUobmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2xhc3NMaXN0LmFkZChuYW1lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCJleHBvcnQgY2xhc3MgQ3NzU3R5bGUge1xuICAgIHByaXZhdGUgX3N0eWxlOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgY29uc3RydWN0b3Ioc3R5bGU/OiBzdHJpbmcgfCBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KSB7XG4gICAgICAgIGlmIChzdHlsZSkge1xuICAgICAgICAgICAgdGhpcy5yZXNldChzdHlsZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gR2V0dGVyc1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIC8qKlxuICAgICAqIFJldHVybiB0aGUgbnVtYmVyIG9mIHN0eWxlcyBpbiB0aGUgc2V0LlxuICAgICAqL1xuICAgIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX3N0eWxlKS5sZW5ndGg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhIHRleHR1YWwgcmVwcmVzZW50YXRpb24gb2YgdGhlIENTUyBkZWNsYXJhdGlvbiBibG9jay5cbiAgICAgKi9cbiAgICBnZXQgY3NzVGV4dCgpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBrZXlzID0gT2JqZWN0LmtleXModGhpcy5fc3R5bGUpO1xuICAgICAgICBpZiAoIU9iamVjdC5rZXlzKHRoaXMuX3N0eWxlKS5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgY29uc3QgdmFsdWVSZXByID0gW107XG4gICAgICAgIGZvciAoY29uc3Qga2V5IG9mIGtleXMpIHtcbiAgICAgICAgICAgIHZhbHVlUmVwci5wdXNoKGAke2tleX06ICR7dGhpcy5fc3R5bGVba2V5XX1gKTtcbiAgICAgICAgfVxuICAgICAgICBsZXQgcmVzdWx0ID0gdmFsdWVSZXByLmpvaW4oJzsgJyk7XG4gICAgICAgIGlmICh2YWx1ZVJlcHIubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gJzsnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlaW5pdGlhbGl6ZSB0aGUgcmVjb3JkIHdpdGggYSBuZXcgcmVjb3JkIG9mIHN0eWxlcywgZnJvbSBhIHN0cmluZyB0b1xuICAgICAqIHBhcnNlLlxuICAgICAqL1xuICAgIHNldCBjc3NUZXh0KGNzc1RleHQ6IHN0cmluZykge1xuICAgICAgICB0aGlzLnJlc2V0KGNzc1RleHQpO1xuICAgIH1cblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBMaWZlY3ljbGVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYSBuZXcgcmVjb3JkIG9mIHN0eWxlcywgcGFyc2VkIGZyb20gYSBjc3NUZXh0IHN0cmluZy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBjbGFzc05hbWVcbiAgICAgKi9cbiAgICBwYXJzZUNzc1RleHQoY3NzVGV4dDogc3RyaW5nKTogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IHN0eWxlOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgICAgIHJldHVybiBjc3NUZXh0XG4gICAgICAgICAgICAuc3BsaXQoJzsnKVxuICAgICAgICAgICAgLm1hcChzdHlsZSA9PiBzdHlsZS50cmltKCkpXG4gICAgICAgICAgICAuZmlsdGVyKHN0eWxlID0+IHN0eWxlLmxlbmd0aClcbiAgICAgICAgICAgIC5yZWR1Y2UoKGFjY3VtdWxhdG9yLCB2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtrZXksIHZdID0gdmFsdWUuc3BsaXQoJzonKTtcbiAgICAgICAgICAgICAgICBzdHlsZVtrZXkudHJpbSgpXSA9IHYudHJpbSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgICAgICAgICAgIH0sIHN0eWxlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIGEgY2xvbmUgb2YgdGhpcyByZWNvcmQuXG4gICAgICovXG4gICAgY2xvbmUoKTogQ3NzU3R5bGUge1xuICAgICAgICBjb25zdCBjbG9uZSA9IG5ldyBDc3NTdHlsZSgpO1xuICAgICAgICBjbG9uZS5fc3R5bGUgPSB7IC4uLnRoaXMuX3N0eWxlIH07XG4gICAgICAgIHJldHVybiBjbG9uZTtcbiAgICB9XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gUHVibGljXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRydWUgaWYgdGhlIHJlY29yZCBoYXMgdGhlIGdpdmVuIHN0eWxlLCBmYWxzZSBvdGhlcndpc2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ga2V5XG4gICAgICovXG4gICAgaGFzKGtleTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuX3N0eWxlW2tleV07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybiBhbiBhcnJheSBjb250YWluaW5nIGFsbCB0aGUga2V5cyBpbiB0aGUgcmVjb3JkLlxuICAgICAqL1xuICAgIGtleXMoKTogc3RyaW5nW10ge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fc3R5bGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm4gYW4gYXJyYXkgY29udGFpbmluZyBhbGwgdGhlIHZhbHVlcyBpbiB0aGUgcmVjb3JkLlxuICAgICAqL1xuICAgIHZhbHVlcygpOiBzdHJpbmdbXSB7XG4gICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHRoaXMuX3N0eWxlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJuIHRoZSByZWNvcmQgbWF0Y2hpbmcgdGhlIGdpdmVuIG5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmFtZVxuICAgICAqL1xuICAgIGdldChuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3R5bGVbbmFtZV07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNldCB0aGUgcmVjb3JkIHdpdGggdGhlIGdpdmVuIG5hbWUgdG8gdGhlIGdpdmVuIHZhbHVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKiBAcGFyYW0gdmFsdWVcbiAgICAgKi9cbiAgICBzZXQobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX3N0eWxlW25hbWVdID0gdmFsdWU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGUgcmVjb3JkKHMpIHdpdGggdGhlIGdpdmVuIG5hbWUocykuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbmFtZVxuICAgICAqL1xuICAgIHJlbW92ZSguLi5uYW1lczogc3RyaW5nW10pOiB2b2lkIHtcbiAgICAgICAgZm9yIChjb25zdCBuYW1lIG9mIG5hbWVzKSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5fc3R5bGVbbmFtZV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xlYXIgdGhlIHJlY29yZCBvZiBhbGwgaXRzIHN0eWxlcy5cbiAgICAgKi9cbiAgICBjbGVhcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5fc3R5bGUgPSB7fTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVpbml0aWFsaXplIHRoZSByZWNvcmQgd2l0aCBhIG5ldyByZWNvcmQgb2Ygc3R5bGVzIChlbXB0eSBpZiBubyBhcmd1bWVudFxuICAgICAqIGlzIHBhc3NlZCkuIFRoZSBhcmd1bWVudCBjYW4gYmUgYSByZWNvcmQgb2Ygc3R5bGVzIG9yIGEgc3RyaW5nIHRvIHBhcnNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHN0eWxlXG4gICAgICovXG4gICAgcmVzZXQoc3R5bGU6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCBzdHJpbmcgPSB7fSk6IHZvaWQge1xuICAgICAgICBpZiAodHlwZW9mIHN0eWxlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgdGhpcy5fc3R5bGUgPSBzdHlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX3N0eWxlID0gdGhpcy5wYXJzZUNzc1RleHQoc3R5bGUpO1xuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgVk5vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9WTm9kZXMvVk5vZGUnO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4vWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFZFbGVtZW50IH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvVk5vZGVzL1ZFbGVtZW50JztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIERlZmF1bHRYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gJ2RvbS94bWwnO1xuICAgIGVuZ2luZTogWG1sRG9tUGFyc2luZ0VuZ2luZTtcblxuICAgIGFzeW5jIHBhcnNlKGl0ZW06IE5vZGUpOiBQcm9taXNlPFZOb2RlW10+IHtcbiAgICAgICAgLy8gSWYgdGhlIG5vZGUgY291bGQgbm90IGJlIHBhcnNlZCwgY3JlYXRlIGEgZ2VuZXJpYyBlbGVtZW50IG5vZGUgd2l0aFxuICAgICAgICAvLyB0aGUgSFRNTCB0YWcgb2YgdGhlIERPTSBOb2RlLiBUaGlzIHdheSB3ZSBtYXkgbm90IHN1cHBvcnQgdGhlIG5vZGVcbiAgICAgICAgLy8gYnV0IHdlIGRvbid0IGJyZWFrIGl0IGVpdGhlci5cbiAgICAgICAgY29uc3QgZWxlbWVudCA9IG5ldyBWRWxlbWVudCh7IGh0bWxUYWc6IG5vZGVOYW1lKGl0ZW0pIH0pO1xuICAgICAgICBpZiAoaXRlbSBpbnN0YW5jZW9mIEVsZW1lbnQpIHtcbiAgICAgICAgICAgIGVsZW1lbnQubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG5vZGVzID0gYXdhaXQgdGhpcy5lbmdpbmUucGFyc2UoLi4uaXRlbS5jaGlsZE5vZGVzKTtcbiAgICAgICAgZWxlbWVudC5hcHBlbmQoLi4ubm9kZXMpO1xuICAgICAgICByZXR1cm4gW2VsZW1lbnRdO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IEpXUGx1Z2luLCBKV1BsdWdpbkNvbmZpZyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXUGx1Z2luJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuaW1wb3J0IHsgWG1sRG9tUGFyc2luZ0VuZ2luZSB9IGZyb20gJy4vWG1sRG9tUGFyc2luZ0VuZ2luZSc7XG5cbmV4cG9ydCBjbGFzcyBYbWw8VCBleHRlbmRzIEpXUGx1Z2luQ29uZmlnID0gSldQbHVnaW5Db25maWc+IGV4dGVuZHMgSldQbHVnaW48VD4ge1xuICAgIHN0YXRpYyBkZXBlbmRlbmNpZXMgPSBbUGFyc2VyLCBSZW5kZXJlcl07XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyPiA9IHtcbiAgICAgICAgcGFyc2luZ0VuZ2luZXM6IFtYbWxEb21QYXJzaW5nRW5naW5lXSxcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgUGFyc2luZ0VuZ2luZSwgUGFyc2luZ0lkZW50aWZpZXIgfSBmcm9tICcuLi8uLi9wbHVnaW4tcGFyc2VyL3NyYy9QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IERlZmF1bHRYbWxEb21QYXJzZXIgfSBmcm9tICcuL0RlZmF1bHRYbWxEb21QYXJzZXInO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4vQXR0cmlidXRlcyc7XG5cbmV4cG9ydCBjbGFzcyBYbWxEb21QYXJzaW5nRW5naW5lPFQgZXh0ZW5kcyBOb2RlID0gTm9kZT4gZXh0ZW5kcyBQYXJzaW5nRW5naW5lPFQ+IHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgaWQ6IFBhcnNpbmdJZGVudGlmaWVyID0gJ2RvbS94bWwnO1xuICAgIHN0YXRpYyByZWFkb25seSBkZWZhdWx0UGFyc2VyID0gRGVmYXVsdFhtbERvbVBhcnNlcjtcbiAgICAvKipcbiAgICAgKiBQYXJzZSBhIG5vZGUncyBhdHRyaWJ1dGVzIGFuZCByZXR1cm4gdGhlbS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBub2RlXG4gICAgICovXG4gICAgcGFyc2VBdHRyaWJ1dGVzKG5vZGU6IEVsZW1lbnQpOiBBdHRyaWJ1dGVzIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBdHRyaWJ1dGVzKG5vZGUuYXR0cmlidXRlcyk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSldQbHVnaW4sIEpXUGx1Z2luQ29uZmlnIH0gZnJvbSAnLi4vLi4vY29yZS9zcmMvSldQbHVnaW4nO1xuaW1wb3J0IHsgWW91dHViZVhtbERvbVBhcnNlciB9IGZyb20gJy4vWW91dHViZVhtbERvbVBhcnNlcic7XG5pbXBvcnQgeyBZb3V0dWJlSHRtbERvbVJlbmRlcmVyIH0gZnJvbSAnLi9Zb3V0dWJlSHRtbERvbVJlbmRlcmVyJztcbmltcG9ydCB7IExvYWRhYmxlcyB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL0pXRWRpdG9yJztcbmltcG9ydCB7IFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL1BhcnNlcic7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1yZW5kZXJlci9zcmMvUmVuZGVyZXInO1xuXG5leHBvcnQgY2xhc3MgWW91dHViZTxUIGV4dGVuZHMgSldQbHVnaW5Db25maWcgPSBKV1BsdWdpbkNvbmZpZz4gZXh0ZW5kcyBKV1BsdWdpbjxUPiB7XG4gICAgcmVhZG9ubHkgbG9hZGFibGVzOiBMb2FkYWJsZXM8UGFyc2VyICYgUmVuZGVyZXI+ID0ge1xuICAgICAgICBwYXJzZXJzOiBbWW91dHViZVhtbERvbVBhcnNlcl0sXG4gICAgICAgIHJlbmRlcmVyczogW1lvdXR1YmVIdG1sRG9tUmVuZGVyZXJdLFxuICAgIH07XG59XG4iLCJpbXBvcnQgeyBBYnN0cmFjdFJlbmRlcmVyIH0gZnJvbSAnLi4vLi4vcGx1Z2luLXJlbmRlcmVyL3NyYy9BYnN0cmFjdFJlbmRlcmVyJztcbmltcG9ydCB7IFlvdXR1YmVOb2RlIH0gZnJvbSAnLi9Zb3V0dWJlTm9kZSc7XG5pbXBvcnQgeyBIdG1sRG9tUmVuZGVyaW5nRW5naW5lIH0gZnJvbSAnLi4vLi4vcGx1Z2luLWh0bWwvc3JjL0h0bWxEb21SZW5kZXJpbmdFbmdpbmUnO1xuaW1wb3J0IHsgQXR0cmlidXRlcyB9IGZyb20gJy4uLy4uL3BsdWdpbi14bWwvc3JjL0F0dHJpYnV0ZXMnO1xuXG5leHBvcnQgY2xhc3MgWW91dHViZUh0bWxEb21SZW5kZXJlciBleHRlbmRzIEFic3RyYWN0UmVuZGVyZXI8Tm9kZVtdPiB7XG4gICAgc3RhdGljIGlkID0gSHRtbERvbVJlbmRlcmluZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IEh0bWxEb21SZW5kZXJpbmdFbmdpbmU7XG4gICAgcHJlZGljYXRlID0gWW91dHViZU5vZGU7XG5cbiAgICBhc3luYyByZW5kZXIobm9kZTogWW91dHViZU5vZGUpOiBQcm9taXNlPE5vZGVbXT4ge1xuICAgICAgICBjb25zdCB5b3V0dWJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7XG4gICAgICAgIHRoaXMuZW5naW5lLnJlbmRlckF0dHJpYnV0ZXMoQXR0cmlidXRlcywgbm9kZSwgeW91dHViZSk7XG4gICAgICAgIHJldHVybiBbeW91dHViZV07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgSW5saW5lTm9kZSB9IGZyb20gJy4uLy4uL3BsdWdpbi1pbmxpbmUvc3JjL0lubGluZU5vZGUnO1xuXG5leHBvcnQgY2xhc3MgWW91dHViZU5vZGUgZXh0ZW5kcyBJbmxpbmVOb2RlIHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgYXRvbWljID0gdHJ1ZTtcbn1cbiIsImltcG9ydCB7IFlvdXR1YmVOb2RlIH0gZnJvbSAnLi9Zb3V0dWJlTm9kZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFBhcnNlciB9IGZyb20gJy4uLy4uL3BsdWdpbi1wYXJzZXIvc3JjL0Fic3RyYWN0UGFyc2VyJztcbmltcG9ydCB7IFhtbERvbVBhcnNpbmdFbmdpbmUgfSBmcm9tICcuLi8uLi9wbHVnaW4teG1sL3NyYy9YbWxEb21QYXJzaW5nRW5naW5lJztcbmltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3JjL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFlvdXR1YmVYbWxEb21QYXJzZXIgZXh0ZW5kcyBBYnN0cmFjdFBhcnNlcjxOb2RlPiB7XG4gICAgc3RhdGljIGlkID0gWG1sRG9tUGFyc2luZ0VuZ2luZS5pZDtcbiAgICBlbmdpbmU6IFhtbERvbVBhcnNpbmdFbmdpbmU7XG5cbiAgICBwcmVkaWNhdGUgPSAoaXRlbTogTm9kZSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICBjb25zdCBpc1lvdXR1YmVWaWRlbyA9XG4gICAgICAgICAgICBpdGVtIGluc3RhbmNlb2YgRWxlbWVudCAmJlxuICAgICAgICAgICAgbm9kZU5hbWUoaXRlbSkgPT09ICdJRlJBTUUnICYmXG4gICAgICAgICAgICBpdGVtLmdldEF0dHJpYnV0ZSgnc3JjJykuaW5jbHVkZXMoJ3lvdXR1Jyk7XG4gICAgICAgIHJldHVybiBpc1lvdXR1YmVWaWRlbztcbiAgICB9O1xuXG4gICAgYXN5bmMgcGFyc2UoaXRlbTogRWxlbWVudCk6IFByb21pc2U8WW91dHViZU5vZGVbXT4ge1xuICAgICAgICBjb25zdCB5b3V0dWJlID0gbmV3IFlvdXR1YmVOb2RlKCk7XG4gICAgICAgIHlvdXR1YmUubW9kaWZpZXJzLmFwcGVuZCh0aGlzLmVuZ2luZS5wYXJzZUF0dHJpYnV0ZXMoaXRlbSkpO1xuICAgICAgICByZXR1cm4gW3lvdXR1YmVdO1xuICAgIH1cbn1cbiIsIi8qKlxuICogUmV0dXJuIHRoZSBkZWVwZXN0IGNoaWxkIG9mIGEgZ2l2ZW4gY29udGFpbmVyIGF0IGEgZ2l2ZW4gb2Zmc2V0LCBhbmQgaXRzXG4gKiBhZGFwdGVkIG9mZnNldC5cbiAqXG4gKiBAcGFyYW0gY29udGFpbmVyXG4gKiBAcGFyYW0gb2Zmc2V0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB0YXJnZXREZWVwZXN0KGNvbnRhaW5lcjogTm9kZSwgb2Zmc2V0OiBudW1iZXIpOiBbTm9kZSwgbnVtYmVyXSB7XG4gICAgd2hpbGUgKGNvbnRhaW5lci5oYXNDaGlsZE5vZGVzKCkpIHtcbiAgICAgICAgbGV0IGNoaWxkTm9kZXM6IE5vZGVMaXN0T2Y8Q2hpbGROb2RlPjtcbiAgICAgICAgaWYgKGNvbnRhaW5lciBpbnN0YW5jZW9mIEVsZW1lbnQgJiYgY29udGFpbmVyLnNoYWRvd1Jvb3QpIHtcbiAgICAgICAgICAgIGNoaWxkTm9kZXMgPSBjb250YWluZXIuc2hhZG93Um9vdC5jaGlsZE5vZGVzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hpbGROb2RlcyA9IGNvbnRhaW5lci5jaGlsZE5vZGVzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvZmZzZXQgPj0gY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGNvbnRhaW5lciA9IGNvbnRhaW5lci5sYXN0Q2hpbGQ7XG4gICAgICAgICAgICAvLyBUaGUgbmV3IGNvbnRhaW5lciBtaWdodCBiZSBhIHRleHQgbm9kZSwgc28gY29uc2lkZXJpbmcgb25seVxuICAgICAgICAgICAgLy8gdGhlIGBjaGlsZE5vZGVzYCBwcm9wZXJ0eSB3b3VsZCBiZSB3cm9uZy5cbiAgICAgICAgICAgIG9mZnNldCA9IG5vZGVMZW5ndGgoY29udGFpbmVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRhaW5lciA9IGNoaWxkTm9kZXNbb2Zmc2V0XTtcbiAgICAgICAgICAgIG9mZnNldCA9IDA7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFtjb250YWluZXIsIG9mZnNldF07XG59XG5cbi8qKlxuICogUmV0dXJuIHRoZSBsZW5ndGggb2YgYSBET00gTm9kZS5cbiAqXG4gKiBAcGFyYW0gbm9kZVxuICovXG5leHBvcnQgZnVuY3Rpb24gbm9kZUxlbmd0aChub2RlOiBOb2RlKTogbnVtYmVyIHtcbiAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUubm9kZVZhbHVlLmxlbmd0aDtcbiAgICB9IGVsc2UgaWYgKG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50ICYmIG5vZGUuc2hhZG93Um9vdCkge1xuICAgICAgICByZXR1cm4gbm9kZS5zaGFkb3dSb290LmNoaWxkTm9kZXMubGVuZ3RoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBub2RlLmNoaWxkTm9kZXMubGVuZ3RoO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE1vZGUgfSBmcm9tICcuLi8uLi9jb3JlL3NyYy9KV0VkaXRvcic7XG5pbXBvcnQgeyBWTm9kZSB9IGZyb20gJy4uLy4uL2NvcmUvc3JjL1ZOb2Rlcy9WTm9kZSc7XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBpbnN0YW5jZSByZXByZXNlbnRpbmcgYSBjdXN0b20gZXJyb3IgYWRhcHRpbmcgdG8gdGhlIGNvbnN0cnVjdG9yXG4gKiBuYW1lIG9mIHRoZSBjdXN0b20gZXJyb3IgYW5kIHRha2luZyBhZHZhbnRhZ2Ugb2YgYGNhcHR1cmVTdGFja1RyYWNlYCBvZiBWOC5cbiAqXG4gKiBTb3VyY2U6XG4gKiBodHRwOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2RvY3MvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvRXJyb3JcbiAqL1xuZXhwb3J0IGNsYXNzIEN1c3RvbUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKC4uLnBhcmFtcykge1xuICAgICAgICBzdXBlciguLi5wYXJhbXMpO1xuICAgICAgICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG5cbiAgICAgICAgLy8gTWFpbnRhaW5zIHByb3BlciBzdGFjayB0cmFjZSBmb3Igd2hlcmUgb3VyIGVycm9yIHdhcyB0aHJvd24uXG4gICAgICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xuICAgICAgICAgICAgLy8gVGhpcyBpcyBvbmx5IGF2YWlsYWJsZSBvbiBWOC5cbiAgICAgICAgICAgIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2UgcmVwcmVzZW50aW5nIGFuIGVycm9yIHRoYXQgb2NjdXJzIHdoZW4gYSBmdW5jdGlvbiBvbmx5XG4gKiBhbGxvd2VkIHRvIGJlIGNhbGxlZCBpbiBhIHNwZWNpZmljIG1vZGUgaXMgY2FsbGVkIGluIGEgZGlmZmVyZW50IG1vZGUuXG4gKi9cbmV4cG9ydCBjbGFzcyBNb2RlRXJyb3IgZXh0ZW5kcyBDdXN0b21FcnJvciB7XG4gICAgY29uc3RydWN0b3IobW9kZTogTW9kZSwgLi4ucGFyYW1zKSB7XG4gICAgICAgIHN1cGVyKC4uLnBhcmFtcyk7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IGBUaGlzIG9wZXJhdGlvbiBpcyBvbmx5IGFsbG93ZWQgaW4gJHttb2RlfSBtb2RlLmA7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2UgcmVwcmVzZW50aW5nIGFuIGVycm9yIHRoYXQgb2NjdXJzIHdoZW4gYSBWTm9kZSBnaXZlbiBhc1xuICogY2hpbGQgZnVuY3Rpb24gcGFyYW1ldGVyIGlzIGFjdHVhbGx5IG5vdCBhIGNoaWxkIG9mIHRoZSBjdXJyZW50IFZOb2RlLlxuICovXG5leHBvcnQgY2xhc3MgQ2hpbGRFcnJvciBleHRlbmRzIEN1c3RvbUVycm9yIHtcbiAgICBjb25zdHJ1Y3Rvcih0aGlzTm9kZTogVk5vZGUsIG5vZGU6IFZOb2RlLCAuLi5wYXJhbXMpIHtcbiAgICAgICAgc3VwZXIoLi4ucGFyYW1zKTtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gYCR7bm9kZS5uYW1lfSBpcyBub3QgYSBjaGlsZCBvZiAke3RoaXNOb2RlLm5hbWV9YDtcbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBpbnN0YW5jZSByZXByZXNlbnRpbmcgYW4gZXJyb3IgdGhhdCBvY2N1cnMgd2hlbiBhbiBhY3Rpb24gd291bGRcbiAqIHZpb2xhdGUgdGhlIGF0b21pY2l0eSBvZiBhIFZOb2RlLlxuICovXG5leHBvcnQgY2xhc3MgQXRvbWljaXR5RXJyb3IgZXh0ZW5kcyBDdXN0b21FcnJvciB7XG4gICAgY29uc3RydWN0b3Iobm9kZTogVk5vZGUsIC4uLnBhcmFtcykge1xuICAgICAgICBzdXBlciguLi5wYXJhbXMpO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBgJHtub2RlLm5hbWV9IGlzIGF0b21pYy5gO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IGlzQmxvY2sgfSBmcm9tICcuL2lzQmxvY2snO1xuaW1wb3J0IHsgbm9kZU5hbWUgfSBmcm9tICcuL3V0aWxzJztcblxuLyoqXG4gKiBSZXR1cm4gYSBzdHJpbmcgd2l0aCB0aGUgdmFsdWUgb2YgYSB0ZXh0IG5vZGUgc3RyaXBwZWQgb2YgaXRzIGZvcm1hdHRpbmdcbiAqIHNwYWNlLCBhcHBseWluZyB0aGUgdzMgcnVsZXMgZm9yIHdoaXRlIHNwYWNlIHByb2Nlc3NpbmdcbiAqIFRPRE86IGRlY2lkZSB3aGF0IGV4YWN0bHkgdG8gZG8gd2l0aCBmb3JtYXR0aW5nIHNwYWNlczpcbiAqIHJlbW92ZSwga2VlcCwgcmVjb21wdXRlP1xuICpcbiAqIEBzZWUgaHR0cHM6Ly93d3cudzMub3JnL1RSL2Nzcy10ZXh0LTMvI3doaXRlLXNwYWNlLXByb2Nlc3NpbmdcbiAqIEByZXR1cm5zIHtzdHJpbmd9XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVGb3JtYXR0aW5nU3BhY2Uobm9kZTogTm9kZSk6IHN0cmluZyB7XG4gICAgLy8gVE9ETzogY2hlY2sgdGhlIHZhbHVlIG9mIHRoZSBgd2hpdGUtc3BhY2VgIHByb3BlcnR5XG4gICAgY29uc3QgdGV4dDogc3RyaW5nID0gbm9kZS50ZXh0Q29udGVudDtcbiAgICBpZiAobm9kZS5wYXJlbnRFbGVtZW50Py5jbG9zZXN0KCdQUkUnKSkge1xuICAgICAgICByZXR1cm4gdGV4dDtcbiAgICB9XG4gICAgY29uc3Qgc3BhY2VCZWZvcmVOZXdsaW5lID0gLyhbIFxcdF0pKihcXG4pL2c7XG4gICAgY29uc3Qgc3BhY2VBZnRlck5ld2xpbmUgPSAvKFxcbikoWyBcXHRdKSovZztcbiAgICBjb25zdCB0YWJzID0gL1xcdC9nO1xuICAgIGNvbnN0IG5ld2xpbmVzID0gL1xcbi9nO1xuICAgIGNvbnN0IGNvbnNlY3V0aXZlU3BhY2UgPSAvICAqL2c7XG5cbiAgICAvLyAoQ29tbWVudHMgcmVmZXIgdG8gdGhlIHczIGxpbmsgcHJvdmlkZWQgYWJvdmUuKVxuICAgIC8vIFBoYXNlIEk6IENvbGxhcHNpbmcgYW5kIFRyYW5zZm9ybWF0aW9uXG4gICAgbGV0IG5ld1RleHQgPSB0ZXh0XG4gICAgICAgIC8vIDEuIEFsbCBzcGFjZXMgYW5kIHRhYnMgaW1tZWRpYXRlbHkgcHJlY2VkaW5nIG9yIGZvbGxvd2luZyBhXG4gICAgICAgIC8vICAgIHNlZ21lbnQgYnJlYWsgYXJlIHJlbW92ZWQuXG4gICAgICAgIC5yZXBsYWNlKHNwYWNlQmVmb3JlTmV3bGluZSwgJyQyJylcbiAgICAgICAgLnJlcGxhY2Uoc3BhY2VBZnRlck5ld2xpbmUsICckMScpXG4gICAgICAgIC8vIDIuIFNlZ21lbnQgYnJlYWtzIGFyZSB0cmFuc2Zvcm1lZCBmb3IgcmVuZGVyaW5nIGFjY29yZGluZyB0byB0aGVcbiAgICAgICAgLy8gICAgc2VnbWVudCBicmVhayB0cmFuc2Zvcm1hdGlvbiBydWxlcy5cbiAgICAgICAgLnJlcGxhY2UobmV3bGluZXMsICcgJylcbiAgICAgICAgLy8gMy4gRXZlcnkgdGFiIGlzIGNvbnZlcnRlZCB0byBhIHNwYWNlIChVKzAwMjApLlxuICAgICAgICAucmVwbGFjZSh0YWJzLCAnICcpXG4gICAgICAgIC8vIDQuIEFueSBzcGFjZSBpbW1lZGlhdGVseSBmb2xsb3dpbmcgYW5vdGhlciBjb2xsYXBzaWJsZSBzcGFjZSDigJRcbiAgICAgICAgLy8gICAgZXZlbiBvbmUgb3V0c2lkZSB0aGUgYm91bmRhcnkgb2YgdGhlIGlubGluZSBjb250YWluaW5nIHRoYXRcbiAgICAgICAgLy8gICAgc3BhY2UsIHByb3ZpZGVkIGJvdGggc3BhY2VzIGFyZSB3aXRoaW4gdGhlIHNhbWUgaW5saW5lXG4gICAgICAgIC8vICAgIGZvcm1hdHRpbmcgY29udGV4dOKAlGlzIGNvbGxhcHNlZCB0byBoYXZlIHplcm8gYWR2YW5jZSB3aWR0aC5cbiAgICAgICAgLy8gICAgKEl0IGlzIGludmlzaWJsZSwgYnV0IHJldGFpbnMgaXRzIHNvZnQgd3JhcCBvcHBvcnR1bml0eSwgaWZcbiAgICAgICAgLy8gICAgYW55LilcbiAgICAgICAgLnJlcGxhY2UoY29uc2VjdXRpdmVTcGFjZSwgJyAnKTtcblxuICAgIC8vIFBoYXNlIElJOiBUcmltbWluZyBhbmQgUG9zaXRpb25pbmdcbiAgICAvLyAxLiBBIHNlcXVlbmNlIG9mIGNvbGxhcHNpYmxlIHNwYWNlcyBhdCB0aGUgYmVnaW5uaW5nIG9mIGEgbGluZVxuICAgIC8vICAgIChpZ25vcmluZyBhbnkgaW50ZXJ2ZW5pbmcgaW5saW5lIGJveCBib3VuZGFyaWVzKSBpcyByZW1vdmVkLlxuICAgIGlmIChfaXNBdFNlZ21lbnRCcmVhayhub2RlLCAnc3RhcnQnKSkge1xuICAgICAgICBjb25zdCBzdGFydFNwYWNlID0gL14gKi9nO1xuICAgICAgICBuZXdUZXh0ID0gbmV3VGV4dC5yZXBsYWNlKHN0YXJ0U3BhY2UsICcnKTtcbiAgICB9XG4gICAgLy8gMi4gSWYgdGhlIHRhYiBzaXplIGlzIHplcm8sIHRhYnMgYXJlIG5vdCByZW5kZXJlZC4gT3RoZXJ3aXNlLCBlYWNoXG4gICAgLy8gICAgdGFiIGlzIHJlbmRlcmVkIGFzIGEgaG9yaXpvbnRhbCBzaGlmdCB0aGF0IGxpbmVzIHVwIHRoZSBzdGFydCBlZGdlXG4gICAgLy8gICAgb2YgdGhlIG5leHQgZ2x5cGggd2l0aCB0aGUgbmV4dCB0YWIgc3RvcC4gSWYgdGhpcyBkaXN0YW5jZSBpcyBsZXNzXG4gICAgLy8gICAgdGhhbiAwLjVjaCwgdGhlbiB0aGUgc3Vic2VxdWVudCB0YWIgc3RvcCBpcyB1c2VkIGluc3RlYWQuIFRhYlxuICAgIC8vICAgIHN0b3BzIG9jY3VyIGF0IHBvaW50cyB0aGF0IGFyZSBtdWx0aXBsZXMgb2YgdGhlIHRhYiBzaXplIGZyb20gdGhlXG4gICAgLy8gICAgYmxvY2vigJlzIHN0YXJ0aW5nIGNvbnRlbnQgZWRnZS4gVGhlIHRhYiBzaXplIGlzIGdpdmVuIGJ5IHRoZVxuICAgIC8vICAgIHRhYi1zaXplIHByb3BlcnR5LlxuICAgIC8vIFRPRE9cbiAgICAvLyAzLiBBIHNlcXVlbmNlIGF0IHRoZSBlbmQgb2YgYSBsaW5lIChpZ25vcmluZyBhbnkgaW50ZXJ2ZW5pbmcgaW5saW5lXG4gICAgLy8gICAgYm94IGJvdW5kYXJpZXMpIG9mIGNvbGxhcHNpYmxlIHNwYWNlcyAoVSswMDIwKSBhbmQvb3IgaWRlb2dyYXBoaWNcbiAgICAvLyAgICBzcGFjZXMgKFUrMzAwMCkgd2hvc2Ugd2hpdGUtc3BhY2UgdmFsdWUgY29sbGFwc2VzIHNwYWNlcyBpc1xuICAgIC8vICAgIHJlbW92ZWQuXG4gICAgaWYgKF9pc0F0U2VnbWVudEJyZWFrKG5vZGUsICdlbmQnKSkge1xuICAgICAgICBjb25zdCBlbmRTcGFjZSA9IC9bIFxcdTMwMDBdKiQvZztcbiAgICAgICAgbmV3VGV4dCA9IG5ld1RleHQucmVwbGFjZShlbmRTcGFjZSwgJycpO1xuICAgIH1cbiAgICByZXR1cm4gbmV3VGV4dDtcbn1cbi8qKlxuICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIG5vZGUgaXMgaW1tZWRpYXRlbHkgcHJlY2VkaW5nIChgc2lkZWAgPT09ICdlbmQnKVxuICogb3IgZm9sbG93aW5nIChgc2lkZWAgPT09ICdzdGFydCcpIGEgc2VnbWVudCBicmVhaywgdG8gc2VlIGlmIGl0cyBlZGdlXG4gKiBzcGFjZSBtdXN0IGJlIHJlbW92ZWQuXG4gKiBBIHNlZ21lbnQgYnJlYWsgaXMgYSBzb3J0IG9mIGxpbmUgYnJlYWssIG5vdCBjb25zaWRlcmluZyBhdXRvbWF0aWMgYnJlYWtzXG4gKiB0aGF0IGFyZSBmdW5jdGlvbiBvZiB0aGUgc2NyZWVuIHNpemUuIEluIHRoaXMgY29udGV4dCwgYSBzZWdtZW50IGlzIHdoYXRcbiAqIHlvdSBzZWUgd2hlbiB5b3UgdHJpcGxlIGNsaWNrIGluIHRleHQgaW4gdGhlIGJyb3dzZXIuXG4gKiBFZzogYDxkaXY+PHA+4peGb25l4peGPC9wPuKXhnR3b+KXhjxicj7il4Z0aHJlZeKXhjwvZGl2PmAgd2hlcmUg4peGID0gc2VnbWVudCBicmVha3MuXG4gKlxuICogQHBhcmFtIHtFbGVtZW50fSBub2RlXG4gKiBAcGFyYW0geydzdGFydCd8J2VuZCd9IHNpZGVcbiAqIEByZXR1cm5zIHtib29sZWFufVxuICovXG5mdW5jdGlvbiBfaXNBdFNlZ21lbnRCcmVhayhub2RlOiBOb2RlLCBzaWRlOiAnc3RhcnQnIHwgJ2VuZCcpOiBib29sZWFuIHtcbiAgICBjb25zdCBzaWJsaW5nU2lkZSA9IHNpZGUgPT09ICdzdGFydCcgPyAncHJldmlvdXNTaWJsaW5nJyA6ICduZXh0U2libGluZyc7XG4gICAgY29uc3Qgc2libGluZyA9IG5vZGUgJiYgbm9kZVtzaWJsaW5nU2lkZV07XG4gICAgY29uc3QgaXNBZ2FpbnN0QW5vdGhlclNlZ21lbnQgPSBzaWJsaW5nICYmIF9pc1NlZ21lbnQoc2libGluZyk7XG4gICAgY29uc3QgaXNBdEVkZ2VPZk93blNlZ21lbnQgPSBfaXNCbG9ja0VkZ2Uobm9kZSwgc2lkZSk7XG4gICAgLy8gSW4gdGhlIERPTSwgYSBzcGFjZSBiZWZvcmUgYSBCUiBpcyByZW5kZXJlZCBidXQgYSBzcGFjZSBhZnRlciBhIEJSIGlzbid0LlxuICAgIGNvbnN0IGlzQmVmb3JlQlIgPSBzaWRlID09PSAnZW5kJyAmJiBzaWJsaW5nICYmIG5vZGVOYW1lKHNpYmxpbmcpID09PSAnQlInO1xuICAgIHJldHVybiAoaXNBZ2FpbnN0QW5vdGhlclNlZ21lbnQgJiYgIWlzQmVmb3JlQlIpIHx8IGlzQXRFZGdlT2ZPd25TZWdtZW50O1xufVxuLyoqXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgbm9kZSBpcyBhIHNlZ21lbnQgYWNjb3JkaW5nIHRvIFczIGZvcm1hdHRpbmcgbW9kZWwuXG4gKlxuICogQHBhcmFtIG5vZGUgdG8gY2hlY2tcbiAqL1xuZnVuY3Rpb24gX2lzU2VnbWVudChub2RlOiBOb2RlKTogYm9vbGVhbiB7XG4gICAgaWYgKG5vZGUubm9kZVR5cGUgIT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7XG4gICAgICAgIC8vIE9ubHkgcHJvcGVyIGVsZW1lbnRzIGNhbiBiZSBhIHNlZ21lbnQuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IGVsc2UgaWYgKG5vZGVOYW1lKG5vZGUpID09PSAnQlInKSB7XG4gICAgICAgIC8vIEJyZWFrIChCUikgdGFncyBlbmQgYSBzZWdtZW50LlxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBUaGUgVzMgc3BlY2lmaWNhdGlvbiBoYXMgbWFueSBzcGVjaWZpYyBjYXNlcyB0aGF0IGRlZmluZXMgd2hhdCBpc1xuICAgICAgICAvLyBvciBpcyBub3QgYSBzZWdtZW50LiBGb3IgdGhlIG1vbWVudCwgd2Ugb25seSBoYW5kbGUgZGlzcGxheTogYmxvY2suXG4gICAgICAgIHJldHVybiBpc0Jsb2NrKG5vZGUpO1xuICAgIH1cbn1cbi8qKlxuICogUmV0dXJuIHRydWUgaWYgdGhlIG5vZGUgaXMgYXQgdGhlIGdpdmVuIGVkZ2Ugb2YgYSBibG9jay5cbiAqXG4gKiBAcGFyYW0gbm9kZSB0byBjaGVja1xuICogQHBhcmFtIHNpZGUgb2YgdGhlIGJsb2NrIHRvIGNoZWNrICgnc3RhcnQnIG9yICdlbmQnKVxuICovXG5mdW5jdGlvbiBfaXNCbG9ja0VkZ2Uobm9kZTogTm9kZSB8IE5vZGUsIHNpZGU6ICdzdGFydCcgfCAnZW5kJyk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGFuY2VzdG9yc1VwVG9CbG9jazogTm9kZVtdID0gW107XG5cbiAgICAvLyBNb3ZlIHVwIHRvIHRoZSBmaXJzdCBibG9jayBhbmNlc3RvclxuICAgIGxldCBhbmNlc3RvciA9IG5vZGU7XG4gICAgd2hpbGUgKGFuY2VzdG9yICYmIChfaXNUZXh0Tm9kZShhbmNlc3RvcikgfHwgIV9pc1NlZ21lbnQoYW5jZXN0b3IpKSkge1xuICAgICAgICBhbmNlc3RvcnNVcFRvQmxvY2sucHVzaChhbmNlc3Rvcik7XG4gICAgICAgIGFuY2VzdG9yID0gYW5jZXN0b3IucGFyZW50RWxlbWVudDtcbiAgICB9XG5cbiAgICAvLyBSZXR1cm4gdHJ1ZSBpZiBubyBhbmNlc3RvciB1cCB0byB0aGUgZmlyc3QgYmxvY2sgYW5jZXN0b3IgaGFzIGFcbiAgICAvLyBzaWJsaW5nIG9uIHRoZSBzcGVjaWZpZWQgc2lkZVxuICAgIGNvbnN0IHNpYmxpbmdTaWRlID0gc2lkZSA9PT0gJ3N0YXJ0JyA/ICdwcmV2aW91c1NpYmxpbmcnIDogJ25leHRTaWJsaW5nJztcbiAgICByZXR1cm4gYW5jZXN0b3JzVXBUb0Jsb2NrLmV2ZXJ5KGFuY2VzdG9yID0+IHtcbiAgICAgICAgcmV0dXJuICFhbmNlc3RvcltzaWJsaW5nU2lkZV07XG4gICAgfSk7XG59XG4vKipcbiAqIFJldHVybiB0cnVlIGlmIHRoZSBnaXZlbiBub2RlIGlzIGEgdGV4dCBub2RlLCBmYWxzZSBvdGhlcndpc2UuXG4gKlxuICogQHBhcmFtIG5vZGUgdG8gY2hlY2tcbiAqL1xuZnVuY3Rpb24gX2lzVGV4dE5vZGUobm9kZTogTm9kZSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERTtcbn1cbiIsImltcG9ydCB7IG5vZGVOYW1lIH0gZnJvbSAnLi91dGlscyc7XG5cbi8qKlxuICogVGhlIGZvbGxvd2luZyBpcyBhIGNvbXBsZXRlIGxpc3Qgb2YgYWxsIEhUTUwgXCJibG9jay1sZXZlbFwiIGVsZW1lbnRzLlxuICpcbiAqIFNvdXJjZTpcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUTUwvQmxvY2stbGV2ZWxfZWxlbWVudHNcbiAqXG4gKiAqL1xuY29uc3QgYmxvY2tUYWdOYW1lcyA9IFtcbiAgICAnQUREUkVTUycsXG4gICAgJ0FSVElDTEUnLFxuICAgICdBU0lERScsXG4gICAgJ0JMT0NLUVVPVEUnLFxuICAgICdERVRBSUxTJyxcbiAgICAnRElBTE9HJyxcbiAgICAnREQnLFxuICAgICdESVYnLFxuICAgICdETCcsXG4gICAgJ0RUJyxcbiAgICAnRklFTERTRVQnLFxuICAgICdGSUdDQVBUSU9OJyxcbiAgICAnRklHVVJFJyxcbiAgICAnRk9PVEVSJyxcbiAgICAnRk9STScsXG4gICAgJ0gxJyxcbiAgICAnSDInLFxuICAgICdIMycsXG4gICAgJ0g0JyxcbiAgICAnSDUnLFxuICAgICdINicsXG4gICAgJ0hFQURFUicsXG4gICAgJ0hHUk9VUCcsXG4gICAgJ0hSJyxcbiAgICAnTEknLFxuICAgICdNQUlOJyxcbiAgICAnTkFWJyxcbiAgICAnT0wnLFxuICAgICdQJyxcbiAgICAnUFJFJyxcbiAgICAnU0VDVElPTicsXG4gICAgJ1RBQkxFJyxcbiAgICAnVUwnLFxuICAgIC8vIFRoZSBmb2xsb3dpbmcgZWxlbWVudHMgYXJlIG5vdCBpbiB0aGUgVzNDIGxpc3QsIGZvciBzb21lIHJlYXNvbi5cbiAgICAnVFInLFxuICAgICdURCcsXG4gICAgJ1RCT0RZJyxcbiAgICAnVEhFQUQnLFxuICAgICdUSCcsXG5dO1xuXG5jb25zdCBjb21wdXRlZFN0eWxlcyA9IG5ldyBXZWFrTWFwPE5vZGUsIENTU1N0eWxlRGVjbGFyYXRpb24+KCk7XG5cbi8qKlxuICogUmV0dXJuIHRydWUgaWYgdGhlIGdpdmVuIG5vZGUgaXMgYSBibG9jay1sZXZlbCBlbGVtZW50LCBmYWxzZSBvdGhlcndpc2UuXG4gKlxuICogQHBhcmFtIG5vZGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGlzQmxvY2sobm9kZTogTm9kZSk6IGJvb2xlYW4ge1xuICAgIGxldCByZXN1bHQ6IGJvb2xlYW47XG4gICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHRhZ05hbWUgPSBub2RlTmFtZShub2RlKTtcbiAgICAgICAgLy8gZXZlcnkgY3VzdG9tIGp3LSogbm9kZSB3aWxsIGJlIGNvbnNpZGVyZWQgYXMgYmxvY2tzXG4gICAgICAgIGlmICh0YWdOYW1lLnN0YXJ0c1dpdGgoJ0pXLScpIHx8IHRhZ05hbWUgPT09ICdUJykge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gV2Ugd29uJ3QgY2FsbCBgZ2V0Q29tcHV0ZWRTdHlsZWAgbW9yZSB0aGFuIG9uY2UgcGVyIG5vZGUuXG4gICAgICAgIGxldCBzdHlsZSA9IGNvbXB1dGVkU3R5bGVzLmdldChub2RlKTtcbiAgICAgICAgaWYgKCFzdHlsZSkge1xuICAgICAgICAgICAgc3R5bGUgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShub2RlKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBUaGUgbm9kZSBtaWdodCBub3QgYmUgaW4gdGhlIERPTSwgaW4gd2hpY2ggY2FzZSBpdCBoYXMgbm8gQ1NTIHZhbHVlcy5cbiAgICAgICAgaWYgKHN0eWxlLmRpc3BsYXkpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9ICFzdHlsZS5kaXNwbGF5LmluY2x1ZGVzKCdpbmxpbmUnKSAmJiBzdHlsZS5kaXNwbGF5ICE9PSAnY29udGVudHMnO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gYmxvY2tUYWdOYW1lcy5pbmNsdWRlcyh0YWdOYW1lKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIiwiaW1wb3J0IHsgQ2FyZXRQb3NpdGlvbiB9IGZyb20gJy4uLy4uL3BsdWdpbi1kb20tZWRpdGFibGUvc3JjL0V2ZW50Tm9ybWFsaXplcic7XG5pbXBvcnQgeyB0YXJnZXREZWVwZXN0IH0gZnJvbSAnLi9Eb20nO1xuaW1wb3J0IHsgZ2V0RG9jdW1lbnQgfSBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGVsZW1lbnRGcm9tUG9pbnQoeDogbnVtYmVyLCB5OiBudW1iZXIpOiBOb2RlIHtcbiAgICBsZXQgZWxlbWVudCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQoeCwgeSk7XG4gICAgaWYgKGVsZW1lbnQpIHtcbiAgICAgICAgbGV0IHJvb3Q6IERvY3VtZW50IHwgU2hhZG93Um9vdDtcbiAgICAgICAgcm9vdCA9IGVsZW1lbnQub3duZXJEb2N1bWVudDtcbiAgICAgICAgd2hpbGUgKGVsZW1lbnQuc2hhZG93Um9vdCkge1xuICAgICAgICAgICAgcm9vdCA9IGVsZW1lbnQuc2hhZG93Um9vdDtcbiAgICAgICAgICAgIGVsZW1lbnQgPSByb290LmVsZW1lbnRGcm9tUG9pbnQoeCwgeSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2FyZXRQb3NpdGlvbkZyb21Qb2ludCh4OiBudW1iZXIsIHk6IG51bWJlcik6IENhcmV0UG9zaXRpb24ge1xuICAgIGlmICgoIXggJiYgeCAhPT0gMCkgfHwgKCF5ICYmIHkgIT09IDApKSByZXR1cm47XG5cbiAgICAvLyBUaGVyZSBpcyBubyBjcm9zcy1icm93c2VyIGZ1bmN0aW9uIGZvciB0aGlzLCBidXQgdGhlIHRocmVlIGZ1bmN0aW9ucyBiZWxvd1xuICAgIC8vIGNvdmVyIGFsbCBtb2Rlcm4gYnJvd3NlcnMgYXMgd2VsbCBhcyB0aGUgc2hhZG93IERPTS5cbiAgICBsZXQgY2FyZXRQb3NpdGlvbjogQ2FyZXRQb3NpdGlvbjtcblxuICAgIGNvbnN0IGVsZW1lbnQgPSBlbGVtZW50RnJvbVBvaW50KHgsIHkpO1xuXG4gICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCByb290ID0gZ2V0RG9jdW1lbnQoZWxlbWVudCk7XG4gICAgaWYgKHJvb3QuY2FyZXRQb3NpdGlvbkZyb21Qb2ludCkge1xuICAgICAgICBjYXJldFBvc2l0aW9uID0gcm9vdC5jYXJldFBvc2l0aW9uRnJvbVBvaW50KHgsIHkpO1xuICAgIH0gZWxzZSBpZiAocm9vdCBpbnN0YW5jZW9mIFNoYWRvd1Jvb3QpIHtcbiAgICAgICAgLy8gRmluZCB0aGUgbmVhcmVzdCBub2RlIGxlYWYgb3IgY2hhciBpbiBsZWFmLlxuICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGNhcmV0UG9zaXRpb25Gcm9tUG9pbnRJblNoYWRvd0RvbSh4LCB5LCBlbGVtZW50KTtcbiAgICAgICAgY2FyZXRQb3NpdGlvbiA9IHtcbiAgICAgICAgICAgIG9mZnNldE5vZGU6IHBvc2l0aW9uLm5vZGUsXG4gICAgICAgICAgICBvZmZzZXQ6IHBvc2l0aW9uLm9mZnNldCxcbiAgICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBjYXJyZXRSYW5nZSA9IHJvb3QuY2FyZXRSYW5nZUZyb21Qb2ludCh4LCB5KTtcbiAgICAgICAgY2FyZXRQb3NpdGlvbiA9IHtcbiAgICAgICAgICAgIG9mZnNldE5vZGU6IGNhcnJldFJhbmdlLnN0YXJ0Q29udGFpbmVyLFxuICAgICAgICAgICAgb2Zmc2V0OiBjYXJyZXRSYW5nZS5zdGFydE9mZnNldCxcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBpZiAoY2FyZXRQb3NpdGlvbikge1xuICAgICAgICBjb25zdCBbb2Zmc2V0Tm9kZSwgb2Zmc2V0XSA9IHRhcmdldERlZXBlc3QoY2FyZXRQb3NpdGlvbi5vZmZzZXROb2RlLCBjYXJldFBvc2l0aW9uLm9mZnNldCk7XG4gICAgICAgIHJldHVybiB7IG9mZnNldE5vZGUsIG9mZnNldCB9O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2FyZXRQb3NpdGlvbkZyb21Qb2ludEluU2hhZG93RG9tKFxuICAgIHg6IG51bWJlcixcbiAgICB5OiBudW1iZXIsXG4gICAgZWxlbWVudDogTm9kZSxcbik6IHsgbm9kZTogTm9kZTsgb2Zmc2V0OiBudW1iZXIgfSB7XG4gICAgY29uc3QgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xuICAgIGxldCBkaXN0WCA9IEluZmluaXR5O1xuICAgIGxldCBkaXN0WSA9IEluZmluaXR5O1xuICAgIGxldCBub2RlOiBOb2RlO1xuICAgIGxldCBvZmZzZXQ6IG51bWJlcjtcblxuICAgIGNvbnN0IGxlYWZzOiBOb2RlW10gPSBbXTtcbiAgICBjb25zdCBlbGVtZW50czogTm9kZVtdID0gW2VsZW1lbnRdO1xuICAgIHdoaWxlIChlbGVtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGVsZW1lbnRzLnNoaWZ0KCk7XG4gICAgICAgIGlmIChlbGVtZW50LmNoaWxkTm9kZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBlbGVtZW50cy5wdXNoKC4uLmVsZW1lbnQuY2hpbGROb2Rlcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZWFmcy5wdXNoKGVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmluZCB0aGUgbmVhcmVzdCBub2RlIGxlYWYuXG4gICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYWZzKSB7XG4gICAgICAgIGxldCBib3g6IERPTVJlY3Q7XG4gICAgICAgIGlmIChsZWFmIGluc3RhbmNlb2YgRWxlbWVudCkge1xuICAgICAgICAgICAgYm94ID0gbGVhZi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KGxlYWYsIDApO1xuICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kKGxlYWYsIGxlYWYudGV4dENvbnRlbnQubGVuZ3RoKTtcbiAgICAgICAgICAgIGJveCA9IHJhbmdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChib3gueSArIGJveC5oZWlnaHQgPCB5KSB7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBjdXJyZW50T2Zmc2V0ID0gMDtcbiAgICAgICAgbGV0IG5ld0Rpc3RZOiBudW1iZXI7XG4gICAgICAgIGlmIChib3gueSA8PSB5ICYmIGJveC55ICsgYm94LmhlaWdodCA+PSB5KSB7XG4gICAgICAgICAgICBuZXdEaXN0WSA9IDA7XG4gICAgICAgICAgICBpZiAobGVhZi5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50T2Zmc2V0ID0gZ2V0TmVhcmVzdENoYXJPZmZzZXQoeCwgeSwgbGVhZik7XG4gICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQobGVhZiwgY3VycmVudE9mZnNldCk7XG4gICAgICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kKGxlYWYsIGN1cnJlbnRPZmZzZXQpO1xuICAgICAgICAgICAgICAgIGJveCA9IHJhbmdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3RGlzdFkgPSBNYXRoLmFicyhib3gueSArIGJveC5oZWlnaHQgLyAyIC0geSk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgbmV3RGlzdFg6IG51bWJlcjtcbiAgICAgICAgaWYgKGJveC54IDw9IHggJiYgYm94LnggKyBib3gud2lkdGggPj0geCkge1xuICAgICAgICAgICAgbmV3RGlzdFggPSAwO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3RGlzdFggPSBNYXRoLmFicyhib3gueCArIGJveC53aWR0aCAvIDIgLSB4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChuZXdEaXN0WSA8IGRpc3RZKSB7XG4gICAgICAgICAgICBkaXN0WSA9IG5ld0Rpc3RZO1xuICAgICAgICAgICAgZGlzdFggPSBuZXdEaXN0WDtcbiAgICAgICAgICAgIG5vZGUgPSBsZWFmO1xuICAgICAgICAgICAgb2Zmc2V0ID0gY3VycmVudE9mZnNldDtcbiAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICAgIG5ld0Rpc3RZID09PSBkaXN0WSAmJlxuICAgICAgICAgICAgKChuZXdEaXN0WSA9PT0gMCAmJiBuZXdEaXN0WCA8PSBkaXN0WCkgfHwgKG5ld0Rpc3RZICE9PSAwICYmIG5ld0Rpc3RYID4gZGlzdFgpKVxuICAgICAgICApIHtcbiAgICAgICAgICAgIGRpc3RZID0gbmV3RGlzdFk7XG4gICAgICAgICAgICBkaXN0WCA9IG5ld0Rpc3RYO1xuICAgICAgICAgICAgbm9kZSA9IGxlYWY7XG4gICAgICAgICAgICBvZmZzZXQgPSBjdXJyZW50T2Zmc2V0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChkaXN0WCA9PT0gMCAmJiBkaXN0WSA9PT0gMCkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbm9kZSAmJiB7IG5vZGUsIG9mZnNldCB9O1xufVxuXG5mdW5jdGlvbiBnZXROZWFyZXN0Q2hhck9mZnNldCh4OiBudW1iZXIsIHk6IG51bWJlciwgdGV4dDogTm9kZSk6IG51bWJlciB7XG4gICAgLy8gU2VhcmNoIHdpdGggYSBwc2V1ZG8gZGljaG90b21pYyBmb3IgcGVyZm9ybWFuY2UuXG4gICAgY29uc3QgcmFuZ2UgPSBkb2N1bWVudC5jcmVhdGVSYW5nZSgpO1xuICAgIGNvbnN0IHBvc1RvVGVzdCA9IFtbMCwgdGV4dC50ZXh0Q29udGVudC5sZW5ndGhdXTtcbiAgICBjb25zdCB2ZXJ0aWNhbE1hdGNoZXM6IG51bWJlcltdW10gPSBbXTtcbiAgICB3aGlsZSAocG9zVG9UZXN0Lmxlbmd0aCkge1xuICAgICAgICBjb25zdCBwb3MgPSBwb3NUb1Rlc3QucG9wKCk7XG4gICAgICAgIHJhbmdlLnNldFN0YXJ0KHRleHQsIHBvc1swXSk7XG4gICAgICAgIHJhbmdlLnNldEVuZCh0ZXh0LCBwb3NbMV0pO1xuICAgICAgICBjb25zdCBib3ggPSByYW5nZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICBpZiAoYm94LnkgPD0geSAmJiBib3gueSArIGJveC5oZWlnaHQgPj0geSkge1xuICAgICAgICAgICAgaWYgKGJveC54IDw9IHggJiYgYm94LnggKyBib3gud2lkdGggPj0geCkge1xuICAgICAgICAgICAgICAgIGlmIChwb3NbMV0gLSBwb3NbMF0gPD0gMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYm94LnggKyBib3gud2lkdGggLyAyIDw9IHggPyBwb3NbMV0gOiBwb3NbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IGFsZiA9IE1hdGguZmxvb3IoKHBvc1swXSArIHBvc1sxXSkgLyAyKTtcbiAgICAgICAgICAgICAgICBwb3NUb1Rlc3QucHVzaChbcG9zWzBdLCBhbGZdLCBbYWxmLCBwb3NbMV1dKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmVydGljYWxNYXRjaGVzLnB1c2gocG9zKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIERpZCBub3QgZm91bmQgdGhlIGNoYXIsIGVnOiB1c2VyIGNsaWNrIG9uIGxlZnQgYWJvdmUgdGhlIGNvbnRhaW5lciBsaWtlXG4gICAgLy8gdGhlIGJyb3dzZXIgd2UgZ2V0IHRoZSBuZWFyZXN0IGNoYXIgYXQgdGhlIHNhbWUgY3Vyc29yIG9mIHRoZSBwb2ludGVyLlxuICAgIGxldCBkaXN0ID0gSW5maW5pdHk7XG4gICAgbGV0IG9mZnNldCA9IDA7XG4gICAgZm9yIChjb25zdCBwb3Mgb2YgdmVydGljYWxNYXRjaGVzLnJldmVyc2UoKSkge1xuICAgICAgICBmb3IgKGxldCBpID0gcG9zWzBdOyBpIDwgcG9zWzFdOyBpKyspIHtcbiAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHRleHQsIGkpO1xuICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kKHRleHQsIGkgKyAxKTtcbiAgICAgICAgICAgIGNvbnN0IGJveCA9IHJhbmdlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICAgICAgY29uc3QgZHggPSBib3gueCArIGJveC53aWR0aCAvIDI7XG4gICAgICAgICAgICBjb25zdCBkeSA9IGJveC55ICsgYm94LmhlaWdodCAvIDI7XG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IE1hdGgucG93KGR4IC0geCwgMikgKyBNYXRoLnBvdyhkeSAtIHksIDQpO1xuICAgICAgICAgICAgaWYgKGRlbHRhIDw9IGRpc3QpIHtcbiAgICAgICAgICAgICAgICBkaXN0ID0gZGVsdGE7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gaSArIChkeCA8IHggPyAxIDogMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG9mZnNldDtcbn1cbiIsImV4cG9ydCB0eXBlIENvbnN0cnVjdG9yPFQ+ID0gbmV3ICguLi5hcmdzKSA9PiBUO1xuXG4vKipcbiAqIFJldHVybiB3aGV0aGVyIHRoZSBnaXZlbiBjb25zdHJ1Y3RvciBpcyBhIGNvbnN0cnVjdG9yIG9mIGdpdmVuIHN1cGVyQ2xhc3MuXG4gKlxuICogQHBhcmFtIGNvbnN0cnVjdG9yXG4gKiBAcGFyYW0gc3VwZXJDbGFzc1xuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDb25zdHJ1Y3RvcjxUIGV4dGVuZHMgRnVuY3Rpb24+KGNvbnN0cnVjdG9yLCBzdXBlckNsYXNzOiBUKTogY29uc3RydWN0b3IgaXMgVCB7XG4gICAgcmV0dXJuIGNvbnN0cnVjdG9yLnByb3RvdHlwZSBpbnN0YW5jZW9mIHN1cGVyQ2xhc3MgfHwgY29uc3RydWN0b3IgPT09IHN1cGVyQ2xhc3M7XG59XG4vKipcbiAqIFJldHVybiB0cnVlIGlmIG9iamVjdCBhIGlzIGRlZXAgZXF1YWwgdG8gb2JqZWN0IGIsIGZhbHNlIG90aGVyd2lzZS5cbiAqXG4gKiBAcGFyYW0gYVxuICogQHBhcmFtIGJcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlZXBFcXVhbE9iamVjdHMoYTogb2JqZWN0LCBiOiBvYmplY3QpOiBib29sZWFuIHtcbiAgICBjb25zdCBhS2V5cyA9IE9iamVjdC5rZXlzKGEpO1xuICAgIGlmIChhS2V5cy5sZW5ndGggIT09IE9iamVjdC5rZXlzKGIpLmxlbmd0aCkgcmV0dXJuIGZhbHNlO1xuICAgIGZvciAoY29uc3Qga2V5IG9mIGFLZXlzKSB7XG4gICAgICAgIGNvbnN0IGFWYWx1ZSA9IGFba2V5XTtcbiAgICAgICAgY29uc3QgYlZhbHVlID0gYltrZXldO1xuICAgICAgICBpZiAodHlwZW9mIGFWYWx1ZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIGlmICghZGVlcEVxdWFsT2JqZWN0cyhhVmFsdWUsIGJWYWx1ZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoYVZhbHVlICE9PSBiVmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59XG5cbi8qKlxuICogQ29udmVydCBjZXJ0YWluIHNwZWNpYWwgY2hhcmFjdGVycyB0byB1bmljb2RlLlxuICovXG5leHBvcnQgZnVuY3Rpb24gdG9Vbmljb2RlKHN0cmluZzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoc3RyaW5nID09PSAnICcpIHtcbiAgICAgICAgcmV0dXJuICdcXHUwMEEwJztcbiAgICB9XG4gICAgaWYgKHN0cmluZyA9PT0gJ1xcbicpIHtcbiAgICAgICAgcmV0dXJuICdcXHUwMDBkJztcbiAgICB9XG4gICAgaWYgKHN0cmluZyA9PT0gJ1xcdCcpIHtcbiAgICAgICAgcmV0dXJuICdcXHUwMDA5JztcbiAgICB9XG4gICAgcmV0dXJuIHN0cmluZztcbn1cblxuLyoqXG4gKiBSZXR1cm4gdGhlIGxlbmd0aCBvZiBhIERPTSBOb2RlLlxuICpcbiAqIEBwYXJhbSBub2RlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBub2RlTGVuZ3RoKG5vZGU6IE5vZGUpOiBudW1iZXIge1xuICAgIGNvbnN0IGlzVGV4dE5vZGUgPSBub2RlLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERTtcbiAgICBjb25zdCBjb250ZW50ID0gaXNUZXh0Tm9kZSA/IG5vZGUubm9kZVZhbHVlIDogbm9kZS5jaGlsZE5vZGVzO1xuICAgIHJldHVybiBjb250ZW50Lmxlbmd0aDtcbn1cblxuLyoqXG4gKiBSZXR1cm4gYSBkdXBsaWNhdGUtZnJlZSB2ZXJzaW9uIG9mIGFuIGFycmF5LlxuICpcbiAqIEBwYXJhbSBhcnJheVxuICovXG5leHBvcnQgZnVuY3Rpb24gZGlzdGluY3Q8VD4oYXJyYXk6IEFycmF5PFQ+KTogQXJyYXk8VD4ge1xuICAgIHJldHVybiBBcnJheS5mcm9tKG5ldyBTZXQoYXJyYXkpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm4gdGhlIHVwcGVyY2FzZSBuYW1lIG9mIHRoZSBnaXZlbiBET00gbm9kZS5cbiAqXG4gKiBAcGFyYW0gbm9kZVxuICovXG5leHBvcnQgZnVuY3Rpb24gbm9kZU5hbWUobm9kZTogTm9kZSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIG5vZGUubm9kZU5hbWUudG9VcHBlckNhc2UoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldERvY3VtZW50KG5vZGU6IE5vZGUpOiBEb2N1bWVudCB8IFNoYWRvd1Jvb3Qge1xuICAgIGxldCByb290OiBEb2N1bWVudCB8IFNoYWRvd1Jvb3Q7XG4gICAgd2hpbGUgKG5vZGUgJiYgIXJvb3QpIHtcbiAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBEb2N1bWVudCB8fCBub2RlIGluc3RhbmNlb2YgU2hhZG93Um9vdCkge1xuICAgICAgICAgICAgcm9vdCA9IG5vZGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiByb290IHx8IGRvY3VtZW50O1xufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==
return JWEditor
});