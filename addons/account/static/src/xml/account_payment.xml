<?xml version="1.0" encoding="UTF-8"?>

<templates xml:space="preserve">

    <t t-name="ShowPaymentInfo" owl="1">
        <div t-if="info">
            <t t-if="info.outstanding">
                <div>
                    <strong class="float-left" id="outstanding">
                        <t t-esc="info.title"></t>
                    </strong>
                </div>
            </t>
            <table class="w-100" t-if="info.content.length">
                <t t-foreach="info.content" t-as="line" t-key="line.index">
                    <tr>
                        <t t-if="info.outstanding">
                            <td>
                                <a title="assign to invoice"
                                    role="button"
                                    class="oe_form_field btn btn-link outstanding_credit_assign"
                                    t-on-click.stop.prevent="_onOutstandingCreditAssign"
                                    t-att-data-id="line.id"
                                    href="#"
                                    data-toggle="tooltip">Add</a>
                            </td>
                            <td class="o_journal_name">
                                <div class="oe_form_field"
                                    t-att-title="line.date"
                                    data-toggle="tooltip">
                                    <t t-esc="line.journal_name"></t>
                                </div>
                            </td>
                        </t>
                        <t t-if="!info.outstanding">
                            <td>
                                <Popover
                                    position="popoverPosition"
                                    title="'Payment Information'">
                                    <t t-set-slot="opened">
                                        <t t-call="PaymentPopOver"/>
                                    </t>
                                    <a role="button"
                                        tabindex="0"
                                        class="js_payment_info fa fa-info-circle"
                                        t-att-index="line.index"
                                        aria-label="Info"
                                        title="Payment Info"></a>
                                </Popover>
                            </td>
                            <td>
                                <i class="o_field_widget text-right o_payment_label">Paid on <t t-esc="line.date"></t></i>
                            </td>
                        </t>
                        <td class="text-right">
                            <span class="oe_form_field oe_form_field_float oe_form_field_monetary">
                                <t t-raw="line.amount"></t>
                            </span>
                        </td>
                    </tr>
                </t>
            </table>
        </div>
        <div t-else=""></div>
    </t>

    <div t-name="PaymentPopOver" owl="1">
        <div>
            <table>
                <tr>
                    <td><strong>Amount: </strong></td>
                    <td>
                        <t t-raw="line.amount"></t>
                    </td>
                </tr>
                <tr>
                    <td><strong>Memo: </strong></td>
                    <td>
                        <div class="o_ref">
                            <t t-esc="line.ref"/>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td><strong>Date: </strong></td>
                    <td><t t-esc="line.date"/></td>
                </tr>
                <tr>
                    <td><strong>Payment Journal: </strong></td>
                    <td>
                        <t t-esc="line.journal_name"/>
                        <span t-if="line.payment_method_name"> (<t t-esc="line.payment_method_name"/>)</span>
                    </td>
                </tr>
            </table>
        </div>
        <button class="btn btn-sm btn-primary js_unreconcile_payment float-left"
            t-att-partial-id="line.partial_id"
            t-att-payment-id="line.payment_id"
            t-att-move-id="line.move_id"
            groups="account.group_account_invoice"
            t-on-click="_onRemoveMoveReconcile">Unreconcile
        </button>
        <button class="btn btn-sm btn-secondary js_open_payment float-right"
            t-att-payment-id="line.account_payment_id"
            t-att-move-id="line.move_id"
            t-on-click="_onOpenPayment">View
        </button>
    </div>

</templates>
