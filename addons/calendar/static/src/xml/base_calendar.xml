<?xml version="1.0" encoding="UTF-8"?>
<template>
    <t t-name="Many2ManyAttendeeTag" t-extend="FieldMany2ManyTagAvatar">
        <t t-jquery="span:first" t-operation="prepend">
            <span t-if="attendeesData[el_index] and attendeesData[el_index].status and attendeesData[el_index].status !== 'needsAction'"
                t-attf-class="o_calendar_invitation #{attendeesData[el_index].status}"/>
        </t>
    </t>

    <div t-name="calendar.RecurrentEventUpdate">
        <div class="form-check o_radio_item">
            <input name="recurrence-update" type="radio" class="form-check-input o_radio_input" checked="true" value="self_only" id="self_only"/>
            <label class="form-check-label o_form_label" for="self_only">This event</label>
        </div>

        <div class="form-check o_radio_item">
            <input name="recurrence-update" type="radio" class="form-check-input o_radio_input" value="future_events" id="future_events"/>
            <label class="form-check-label o_form_label" for="future_events">This and following events</label>
        </div>
    </div>

    <t t-extend="mail.systray.ActivityMenu.Previews">
        <t t-jquery="div.o_preview_title" t-operation="after">
            <div t-if="activity and activity.type == 'meeting'">
                <t t-set="is_next_meeting" t-value="true"/>
                <t t-foreach="activity.meetings" t-as="meeting">
                    <div>
                        <span t-att-class="!meeting.allday and is_next_meeting ? 'o_meeting_filter o_meeting_bold' : 'o_meeting_filter'" t-att-data-res_model="activity.model" t-att-data-res_id="meeting.id" t-att-data-model_name="activity.name" t-att-title="meeting.name">
                            <span><t t-esc="meeting.name"/></span>
                        </span>
                        <span t-if="meeting.start" class="float-right">
                            <t t-if="meeting.allday">All Day</t>
                            <t t-else=''>
                                <t t-set="is_next_meeting" t-value="false"/>
                                <t t-esc="moment(meeting.start).local().format('hh:mm A')"/>
                            </t>
                        </span>
                    </div>
                </t>
            </div>
        </t>
    </t>

    <t t-name="calendar.CalendarPopover" t-inherit="web.CalendarPopover" t-inherit-mode="primary" owl="1">
        <xpath expr="//*[@t-call='web.CalendarPopover.body']" position="attributes">
            <attribute name="t-call">calendar.CalendarPopover.body</attribute>
        </xpath>
    </t>

    <t t-name="calendar.CalendarPopover.body" t-inherit="web.CalendarPopover.body" t-inherit-mode="primary" owl="1">
        <xpath expr="//a[hasclass('o_cw_popover_delete')]" position="after">
            <div t-if="isCurrentPartnerAttendee" class="btn-group o-calendar-attendee-status ml-2">
                <a href="#"
                    class="btn btn-secondary dropdown-toggle"
                    data-toggle="dropdown"
                    aria-haspopup="true"
                    aria-expanded="false"
                >
                    <i t-attf-class="fa fa-circle o-calendar-attendee-status-icon {{ statusInfo.color }}"
                    /> <span class="o-calendar-attendee-status-text" t-esc="statusInfo.label"/>
                </a>
                <div class="dropdown-menu overflow-hidden">
                    <t t-foreach="allStatus" t-as="status_" t-key="status_[0]">
                        <a class="dropdown-item" href="#" t-on-click.prevent="_onClickAttendeeStatus(status_[0])">
                            <i t-attf-class="fa fa-circle {{ getStatusColor(status_[0]) }}"/> <t t-esc="status_[1]"/>
                        </a>
                    </t>
                </div>
            </div>
        </xpath>
    </t>
</template>
