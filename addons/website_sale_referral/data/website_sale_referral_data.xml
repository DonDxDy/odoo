<?xml version="1.0" encoding="utf-8"?>
<odoo>
     <data noupdate="1">
         <!-- Controllers -->
         <record id="menu_referral_controller" model="website.menu">
            <field name="name">Referrals</field>
            <field name="url">/referral</field>
            <field name="parent_id" ref="website.main_menu"/>
            <field name="sequence">55</field>
        </record>

        <!-- Email Templates -->
        <record id="referral_tracker_email_template" model="mail.template">
            <field name="name">Referral tracker email</field>
            <field name="model_id" ref="base.model_res_partner" />        
            <field name="auto_delete" eval="True"/>
            <field name="email_to">${object.email}</field>
            <field name="subject">Referral created !</field>
            <field name="body_html"><![CDATA[
         <p>Dear ${(object.name)},<br/><br/>
         Your referral has been created successfully, you can track its status here : ${(ctx.get('link'))}<br/></p>
              Regards.<br/> ]]></field>
              <field name="user_signature" eval="False"/>
        </record>

        <record id="referral_state_changed_email_template" model="mail.template">
            <field name="name">Referral tracker email</field>
            <field name="model_id" ref="base.model_res_partner" />        
            <field name="auto_delete" eval="True"/>
            <field name="email_to">${object.email}</field>
            <field name="subject">Referral progressed !</field>
            <field name="body_html"><![CDATA[
         <p>Dear ${(object.name)},<br/><br/>
         Your referral for ${(ctx.get('referred').name)} has reached a new state (${(ctx.get('state'))})<br/></p>
              Regards.<br/> ]]></field>
              <field name="user_signature" eval="False"/>
        </record>

        <record id="referral_cancelled_email_template" model="mail.template">
            <field name="name">Referral tracker email</field>
            <field name="model_id" ref="base.model_res_partner" />        
            <field name="auto_delete" eval="True"/>
            <field name="email_to">${object.email}</field>
            <field name="subject">Referral lost...</field>
            <field name="body_html"><![CDATA[
         <p>Dear ${(object.name)},<br/><br/>
         Your referral for ${(ctx.get('referred').name)} did not succeed. Don't hesitate to invite more people to have a chance to get more rewards.<br/></p>
              Regards.<br/> ]]></field>
              <field name="user_signature" eval="False"/>
        </record>

        <record id="referral_won_email_template" model="mail.template">
            <field name="name">Referral tracker email</field>
            <field name="model_id" ref="base.model_res_partner" />        
            <field name="auto_delete" eval="True"/>
            <field name="email_to">${object.email}</field>
            <field name="subject">Referral won...</field>
            <field name="body_html"><![CDATA[
         <p>Dear ${(object.name)},<br/><br/>
         Your referral for ${(ctx.get('referred').name)} has succeeded. Thanks a lot ! A salesperson will soon contact you to send you your reward !<br/></p>
              Regards.<br/> ]]></field>
              <field name="user_signature" eval="False"/>
        </record>

        <!-- UTM -->
        <record model="utm.tag" id="utm_campaign_tag_referral">
            <field name="name">Referral</field>
            <field name="color" eval="3"/>
        </record>

        <record model="utm.campaign" id="utm_campaign_referral">
            <field name="name">Referral</field>
            <field name="stage_id" ref="utm.default_utm_stage"/>
            <field name="tag_ids" eval="[(6, 0, [ref('utm_campaign_tag_referral')])]" />
        </record>
     </data>

</odoo>
