<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="l10n_co_pos_report.report_saledetails">
        <t t-set="company" t-value="env.company"/>
        <t t-call="web.html_container">
        <t t-foreach="sale_details" t-as="sale_detail">
            <t t-call="web.internal_layout">
                <div class="page">

                    <div class="text-center">
                        <h2><t t-esc="sale_detail.get('pos_config').name"/></h2>
                        <h2>Sales Details</h2>

                        <strong><t t-esc="date_start" t-options="{'widget': 'datetime'}"/> - <t t-esc="date_stop" t-options="{'widget': 'datetime'}"/></strong>
                    </div>

                    <!-- Orderlines -->
                    <t t-if="include_products">
                        <h3>Products</h3>
                        <table  class="table table-sm">
                            <thead><tr>
                                <th>Product</th>
                                <th>Quantity</th>
                                <th>Price Unit</th>
                            </tr></thead>
                            <tbody>
                            <tr t-foreach='sale_detail.get("products")' t-as='line'>
                                <t t-set="internal_reference" t-value="line['code'] and '[%s] ' % line['code'] or ''" />
                                <td><t t-esc="internal_reference" /><t t-esc="line['product_name']" /></td>
                                <td>
                                    <t t-esc="line['quantity']" />
                                    <t t-if='line["uom"] != "Units"'>
                                        <t t-esc='line["uom"]' />
                                    </t>
                                </td>
                                <td>
                                    <t t-esc='line["price_unit"]' />
                                <t t-if='line["discount"] != 0'>
                                    Disc: <t t-esc='line["discount"]' />%
                                </t>
                                </td>
                            </tr>
                            </tbody>
                        </table>

                        <br/>
                    </t>

                    <h3>Payments</h3>
                    <table  class="table table-sm">
                        <thead><tr>
                            <th>Name</th>
                            <th>No. Transaction</th>
                            <th>Total</th>
                        </tr></thead>
                        <tbody>
                        <tr t-foreach='sale_detail.get("payments")' t-as='payment'>
                            <td><t t-esc="payment['name']" /></td>
                            <td><t t-esc="payment['count']" /></td>
                            <td><t t-esc="payment['total']" t-options="{'widget': 'float', 'precision': sale_detail.get('currency_precision')}"/></td>
                        </tr>
                        </tbody>
                    </table>

                    <br/>

                    <h3>Taxes</h3>
                    <table  class="table table-sm">
                        <thead><tr>
                            <th>Name</th>
                            <th>Tax Amount</th>
                            <th>Base Amount</th>
                        </tr></thead>
                        <tbody>
                        <tr t-foreach='sale_detail.get("taxes")' t-as='tax'>
                            <td><t t-esc="tax['name']" /></td>
                            <td><t t-esc="tax['tax_amount']" t-options="{'widget': 'float', 'precision': sale_detail.get('currency_precision')}"/></td>
                            <td><t t-esc="tax['base_amount']" t-options="{'widget': 'float', 'precision': sale_detail.get('currency_precision')}"/></td>
                        </tr>
                        </tbody>
                    </table>

                    <br/>
                    <br/>

                    <strong>Total: <t t-esc='sale_detail.get("total_paid")' t-options="{'widget': 'float', 'precision': sale_detail.get('currency_precision')}"/></strong><br/>
                    <strong>Total number of Transactions: <t t-esc='sale_detail.get("total_payment_count")'/></strong><br/>
                    <strong t-if='sale_detail.get("first_ref")'>From: <t t-esc='sale_detail.get("first_ref")'/> to <t t-esc='sale_detail.get("last_ref")'/><br/></strong>
                    <strong>POS Serial Number: <t t-esc='sale_detail.get("pos_config").pos_serial_number'/></strong>

                </div>
            </t>
        </t>
        </t>
    </template>
</odoo>
