<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="mail.Activity" owl="1">
        <div class="o-Activity" t-on-click="_onClick">
            <t t-if="activity">
                <div class="o-Activity-sidebar">
                    <div class="o-Activity-user">
                        <t t-if="activity.$$$assignee(mself)">
                            <img class="o-Activity-userAvatar" t-attf-src="/web/image/res.users/{{ activity.$$$assignee(mself).$$$id(mself) }}/image_128" t-att-alt="activity.$$$assignee(mself).$$$nameOrDisplayName(mself)"/>
                        </t>
                        <div class="o-Activity-iconContainer"
                            t-att-class="{
                                'bg-success-full': activity.$$$state(mself) === 'planned',
                                'bg-warning-full': activity.$$$state(mself) === 'today',
                                'bg-danger-full': activity.$$$state(mself) === 'overdue',
                            }"
                        >
                            <i class="o-Activity-icon fa" t-attf-class="{{ activity.$$$icon(mself) }}"/>
                        </div>
                    </div>
                </div>
                <div class="o-Activity-core">
                    <div class="o-Activity-info">
                        <div class="o-Activity-dueDateText"
                            t-att-class="{
                                'o-isDefault': activity.$$$state(mself) === 'default',
                                'o-isOverdue': activity.$$$state(mself) === 'overdue',
                                'o-isPlanned': activity.$$$state(mself) === 'planned',
                                'o-isToday': activity.$$$state(mself) === 'today',
                            }"
                        >
                            <t t-esc="delayLabel"/>
                        </div>
                        <t t-if="activity.$$$summary(mself)">
                            <div class="o-Activity-summary">
                                <t t-esc="summary"/>
                            </div>
                        </t>
                        <t t-elif="activity.$$$type(mself)">
                            <div class="o-Activity-summary o-Activity-type">
                                <t t-esc="activity.$$$type(mself).$$$displayName(mself)"/>
                            </div>
                        </t>
                        <t t-if="activity.$$$assignee(mself)">
                            <div class="o-Activity-userName">
                                <t t-esc="assignedUserText"/>
                            </div>
                        </t>
                        <a class="o-Activity-detailsButton btn btn-link" t-on-click="_onClickDetailsButton" role="button">
                            <i class="fa fa-info-circle" role="img" title="Info"/>
                        </a>
                    </div>

                    <t t-if="state.areDetailsVisible">
                        <div class="o-Activity-details">
                            <dl class="dl-horizontal">
                                <t t-if="activity.$$$type(mself)">
                                    <dt>Activity type</dt>
                                    <dd class="o-Activity-type">
                                        <t t-esc="activity.$$$type(mself).$$$displayName(mself)"/>
                                    </dd>
                                </t>
                                <t t-if="activity.$$$creator(mself)">
                                    <dt>Created</dt>
                                    <dd class="o-Activity-detailsCreation">
                                        <t t-esc="formattedCreateDatetime"/>
                                        <img class="o-Activity-detailsUserAvatar o-Activity-detailsCreatorAvatar" t-attf-src="/web/image/res.users/{{ activity.$$$creator(mself).$$$id(mself) }}/image_128" t-att-title="activity.$$$creator(mself).$$$nameOrDisplayName(mself)" t-att-alt="activity.$$$creator(mself).$$$nameOrDisplayName(mself)"/>
                                        <span class="o-Activity-detailsCreator">
                                            <t t-esc="activity.$$$creator(mself).$$$nameOrDisplayName(mself)"/>
                                        </span>
                                    </dd>
                                </t>
                                <t t-if="activity.$$$assignee(mself)">
                                    <dt>Assigned to</dt>
                                    <dd class="o-Activity-detailsAssignation">
                                        <img class="o-Activity-detailsUserAvatar o-Activity-detailsAssignationUserAvatar" t-attf-src="/web/image/res.users/{{ activity.$$$assignee(mself).$$$id(mself) }}/image_128" t-att-title="activity.$$$assignee(mself).$$$nameOrDisplayName(mself)" t-att-alt="activity.$$$assignee(mself).$$$nameOrDisplayName(mself)"/>
                                        <t t-esc="activity.$$$assignee(mself).$$$nameOrDisplayName(mself)"/>
                                    </dd>
                                </t>
                                <dt>Due on</dt>
                                <dd class="o-Activity-detailsDueDate">
                                    <span class="o-Activity-deadlineDateText"
                                        t-att-class="{
                                            'o-isDefault': activity.$$$state(mself) === 'default',
                                            'o-isOverdue': activity.$$$state(mself) === 'overdue',
                                            'o-isPlanned': activity.$$$state(mself) === 'planned',
                                            'o-isToday': activity.$$$state(mself) === 'today',
                                        }"
                                    >
                                        <t t-esc="formattedDeadlineDate"/>
                                    </span>
                                </dd>
                            </dl>
                        </div>
                    </t>

                    <t t-if="activity.$$$note(mself)">
                        <div class="o-Activity-note">
                            <t t-raw="activity.$$$note(mself)"/>
                        </div>
                    </t>

                    <t t-if="activity.$$$mailTemplates(mself).length > 0">
                        <div class="o-Activity-mailTemplates">
                            <t t-foreach="activity.$$$mailTemplates(mself)" t-as="mailTemplate" t-key="mailTemplate.localId">
                                <MailTemplate
                                    class="o-Activity-mailTemplate"
                                    activity="activity"
                                    mailTemplate="mailTemplate"
                                />
                            </t>
                        </div>
                    </t>

                    <t t-if="activity.$$$canWrite(mself)">
                        <div name="tools" class="o-Activity-tools">
                            <t t-if="activity.$$$category(mself) !== 'upload_file'">
                                <Popover position="'right'" title="MARK_DONE">
                                    <button class="o-Activity-toolButton o-Activity-markDoneButton btn btn-link" t-att-title="MARK_DONE">
                                        <i class="fa fa-check"/> Mark Done
                                    </button>
                                    <t t-set="opened">
                                        <ActivityMarkDonePopover activity="activity"/>
                                    </t>
                                </Popover>
                            </t>
                            <t t-else="">
                                <button class="o-Activity-toolButton o-Activity-uploadButton btn btn-link" t-on-click="_onClickUploadDocument">
                                    <i class="fa fa-upload"/> Upload Document
                                </button>
                                <FileUploader
                                    attachments="activity.$$$attachments(mself)"
                                    uploadId="activity.$$$thread(mself).$$$id(mself)"
                                    uploadModel="activity.$$$thread(mself).$$$model(mself)"
                                    t-on-o-attachment-created="_onAttachmentCreated"
                                    t-ref="fileUploader"
                                />
                            </t>
                            <button class="o-Activity-toolButton o-Activity-editButton btn btn-link" t-on-click="_onClickEdit">
                                <i class="fa fa-pencil"/> Edit
                            </button>
                            <button class="o-Activity-toolButton o-Activity-cancelButton btn btn-link" t-on-click="_onClickCancel" >
                                <i class="fa fa-times"/> Cancel
                            </button>
                        </div>
                    </t>
                </div>
            </t>
        </div>
    </t>

</templates>
