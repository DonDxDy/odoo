<?xml version="1.0" encoding="UTF-8"?>
<template>

    <t t-inherit="web.CalendarView" t-inherit-mode="extension" owl="1">
        <xpath expr="//*[@t-ref='calendarMini']" position="after">
            <MicrosoftCalendarButton t-props="props" t-if="props.model === 'calendar.event'"/>
        </xpath>
    </t>

    <t t-name="microsoft_calendar.CalendarButton" owl="1">
        <t t-if="props.microsoft_is_sync">
            <span class="w-100 badge badge-pill badge-success border-0">
                <i class="fa mr-2 fa-check"/> Synched with Outlook
            </span>
        </t>
        <t t-else="">
            <button class="o_microsoft_sync_button w-100 m-auto btn btn-secondary"
                t-att-disabled="state.disabled"
                t-on-click="_onSyncMicrosoftCalendar"
            >
                <img src="/microsoft_calendar/static/src/img/calendar_outlook_32.png"/>
                Sync with <b>Outlook</b>
            </button>
        </t>
    </t>

</template>
